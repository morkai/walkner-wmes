!function(){"use strict";function e(){require(["domReady","jquery","backbone","backbone.layout","moment","app/monkeyPatch","app/broker","app/i18n","app/socket","app/router","app/viewport","app/updater/index","app/data/loadedModules","app/core/layouts/PageLayout","app/core/layouts/BlankLayout","app/time","app/wmes-wh-kitter-routes","bootstrap","moment-lang/"+window.appLocale,"select2-lang/"+window.appLocale,"i18n!app/nls/core"],o)}function o(e,o,n,t,a,i,r,p,s,c,u,d,l,w,g){var b=r.sandbox();function y(){b.destroy(),b=r.sandbox(),r.subscribe("i18n.reloaded",function(e){localStorage.setItem("LOCALE",e.newLocale),window.location.reload()}),"function"==typeof window.onPageShown&&r.subscribe("viewport.page.shown",window.onPageShown).setLimit(1),e(function(){b.subscribe("viewport.page.shown",f).setLimit(1),window.ENV&&document.body.classList.add("is-"+window.ENV+"-env"),n.history.start({root:"/",hashChange:!0,pushState:!1})})}function f(){null!==b&&(b.destroy(),b=null),o("#app-loading").remove(),o("body").removeClass("is-loading")}s.connect(),a.locale(window.appLocale),o.ajaxSetup({dataType:"json",accepts:{json:"application/json",text:"text/plain"},contentType:"application/json"}),t.configure({manage:!0,el:!1,keep:!0}),u.registerLayout("page",function(){return new w({version:d.getCurrentVersionString(),changelogUrl:"#changelog",hdHidden:!1})}),u.registerLayout("blank",function(){return new g}),r.subscribe("page.titleChanged",function(e){e.unshift(p("core","TITLE")),document.title=e.reverse().join(" < ")}),navigator.onLine?(b.subscribe("socket.connected",function(){b.subscribe("user.reloaded",y)}),b.subscribe("socket.connectFailed",y)):y()}window.WMES_APP_ID="wh-kitter",window.requireApp=function(){window.parent!==window?require(["app/data/localStorage"],function(o){o.start(e)}):e()}}();