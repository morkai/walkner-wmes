/*!
 * jQuery JavaScript Library v2.0.3
 * http://jquery.com/
 *
 * Includes Sizzle.js
 * http://sizzlejs.com/
 *
 * Copyright 2005, 2013 jQuery Foundation, Inc. and other contributors
 * Released under the MIT license
 * http://jquery.org/license
 *
 * Date: 2013-07-03T13:30Z
 */

/*!
 * Sizzle CSS Selector Engine v1.9.4-pre
 * http://sizzlejs.com/
 *
 * Copyright 2013 jQuery Foundation, Inc. and other contributors
 * Released under the MIT license
 * http://jquery.org/license
 *
 * Date: 2013-06-03
 */

//     Underscore.js 1.5.2
//     http://underscorejs.org
//     (c) 2009-2013 Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
//     Underscore may be freely distributed under the MIT license.

//! moment.js
//! version : 2.5.1
//! authors : Tim Wood, Iskren Chernev, Moment.js contributors
//! license : MIT
//! momentjs.com

/*
Copyright 2012 Igor Vaynberg

Version: 3.4.6 Timestamp: Sat Mar 22 22:30:15 EDT 2014

This software is licensed under the Apache License, Version 2.0 (the "Apache License") or the GNU
General Public License version 2 (the "GPL License"). You may choose either license to govern your
use of this software only upon the condition that you accept all of the terms of either the Apache
License or the GPL License.

You may obtain a copy of the Apache License and the GPL License at:

    http://www.apache.org/licenses/LICENSE-2.0
    http://www.gnu.org/licenses/gpl-2.0.html

Unless required by applicable law or agreed to in writing, software distributed under the
Apache License or the GPL License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR
CONDITIONS OF ANY KIND, either express or implied. See the Apache License and the GPL License for
the specific language governing permissions and limitations under the Apache License and the GPL License.
*/

// Copyright (c) 2014, Łukasz Walukiewicz <lukasz@walukiewicz.eu>. Some Rights Reserved.
// Licensed under CC BY-NC-SA 4.0 <http://creativecommons.org/licenses/by-nc-sa/4.0/>.
// Part of the walkner-wmes project <http://lukasz.walukiewicz.eu/p/walkner-wmes>

/*! Socket.IO.js build:0.9.16, development. Copyright(c) 2011 LearnBoost <dev@learnboost.com> MIT Licensed */

/**
 * socket.io
 * Copyright(c) 2011 LearnBoost <dev@learnboost.com>
 * MIT Licensed
 */

/**
   * Parses an URI
   *
   * @author Steven Levithan <stevenlevithan.com> (MIT license)
   * @api public
   */

/*!self.reconnecting &&*/

//     (c) 2010-2013 Jeremy Ashkenas, DocumentCloud Inc.

//     Backbone may be freely distributed under the MIT license.

/*!
 * backbone.layoutmanager.js v0.9.4
 * Copyright 2013, Tim Branyen (@tbranyen)
 * backbone.layoutmanager.js may be freely distributed under the MIT license.
 */

// moment-timezone.js
// version : 0.0.3
// author : Tim Wood
// license : MIT
// github.com/timrwood/moment-timezone

/**
 * @license RequireJS i18n 2.0.4 Copyright (c) 2010-2012, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/requirejs/i18n for details
 */

/**
 * Copyright (c) 2010 Maxim Vasiliev
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 *
 * @author Maxim Vasiliev
 * Date: 09.09.2010
 * Time: 19:02:33
 */

/**
 * Copyright (c) 2010 Maxim Vasiliev
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 *
 * @author Maxim Vasiliev
 * Date: 19.09.11
 * Time: 23:40
 */

/**
 * @license RequireJS domReady 2.0.1 Copyright (c) 2010-2012, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/requirejs/domReady for details
 */

/*! Copyright (c) 2011 by Jonas Mosbech - https://github.com/jmosbech/StickyTableHeaders
	MIT license info: https://github.com/jmosbech/StickyTableHeaders/blob/master/license.txt */

//
// reltime.js - a light weight library for parsing relative time
// based on days, hours, minutes and seconds using a simple
// a simple time notaion (e.g. 1d 2h 3m 5s would be one day, two
// hours, three minutes  and five seconds to some relative date.)
//
// @author: R. S. Doiel, <rsdoiel@gmail.com>
// copyright (c) 2011 all rights reserved
//
// Released under the Simplified BSD License.
// See: http://opensource.org/licenses/bsd-license.php
//

// Copyright (c) 2014, Łukasz Walukiewicz <lukasz@walukiewicz.eu>. Some Rights Reserved.

// Licensed under CC BY-NC-SA 4.0 <http://creativecommons.org/licenses/by-nc-sa/4.0/>.

/*!
 * visibly - v0.6 Aug 2011 - Page Visibility API Polyfill
 * http://github.com/addyosmani
 * Copyright (c) 2011 Addy Osmani
 * Dual licensed under the MIT and GPL licenses.
 *
 * Methods supported:
 * visibly.onVisible(callback)
 * visibly.onHidden(callback)
 * visibly.hidden()
 * visibly.visibilityState()
 * visibly.visibilitychange(callback(state));
 */

/* ========================================================================
 * Bootstrap: button.js v3.0.2
 * http://getbootstrap.com/javascript/#buttons
 * ========================================================================
 * Copyright 2013 Twitter, Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * ======================================================================== */

/* ========================================================================
 * Bootstrap: dropdown.js v3.0.2
 * http://getbootstrap.com/javascript/#dropdowns
 * ========================================================================
 * Copyright 2013 Twitter, Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * ======================================================================== */

/* ========================================================================
 * Bootstrap: modal.js v3.0.2
 * http://getbootstrap.com/javascript/#modals
 * ========================================================================
 * Copyright 2013 Twitter, Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * ======================================================================== */

/* ========================================================================
 * Bootstrap: tooltip.js v3.0.2
 * http://getbootstrap.com/javascript/#tooltip
 * Inspired by the original jQuery.tipsy by Jason Frame
 * ========================================================================
 * Copyright 2013 Twitter, Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * ======================================================================== */

/* ========================================================================
 * Bootstrap: popover.js v3.0.2
 * http://getbootstrap.com/javascript/#popovers
 * ========================================================================
 * Copyright 2013 Twitter, Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * ======================================================================== */

/* ========================================================================
 * Bootstrap: tab.js v3.0.2
 * http://getbootstrap.com/javascript/#tabs
 * ========================================================================
 * Copyright 2013 Twitter, Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * ======================================================================== */

/* ========================================================================
 * Bootstrap: affix.js v3.0.2
 * http://getbootstrap.com/javascript/#affix
 * ========================================================================
 * Copyright 2013 Twitter, Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * ======================================================================== */

/* ========================================================================
 * Bootstrap: collapse.js v3.0.2
 * http://getbootstrap.com/javascript/#collapse
 * ========================================================================
 * Copyright 2013 Twitter, Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * ======================================================================== */

/* ========================================================================
 * Bootstrap: transition.js v3.0.2
 * http://getbootstrap.com/javascript/#transitions
 * ========================================================================
 * Copyright 2013 Twitter, Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * ======================================================================== */

!function(e,t){function n(e){var t=e.length,n=ot.type(e);return ot.isWindow(e)?!1:1===e.nodeType&&t?!0:"array"===n||"function"!==n&&(0===t||"number"==typeof t&&t>0&&t-1 in e)}function r(e){var t=ht[e]={};return ot.each(e.match(st)||[],function(e,n){t[n]=!0}),t}function i(){Object.defineProperty(this.cache={},0,{get:function(){return{}}}),this.expando=ot.expando+Math.random()}function o(e,n,r){var i;if(r===t&&1===e.nodeType)if(i="data-"+n.replace(vt,"-$1").toLowerCase(),r=e.getAttribute(i),"string"==typeof r){try{r="true"===r?!0:"false"===r?!1:"null"===r?null:+r+""===r?+r:yt.test(r)?JSON.parse(r):r}catch(o){}mt.set(e,n,r)}else r=t;return r}function a(){return!0}function s(){return!1}function u(){try{return B.activeElement}catch(e){}}function l(e,t){for(;(e=e[t])&&1!==e.nodeType;);return e}function c(e,t,n){if(ot.isFunction(t))return ot.grep(e,function(e,r){return!!t.call(e,r,e)!==n});if(t.nodeType)return ot.grep(e,function(e){return e===t!==n});if("string"==typeof t){if(It.test(t))return ot.filter(t,e,n);t=ot.filter(t,e)}return ot.grep(e,function(e){return tt.call(t,e)>=0!==n})}function d(e,t){return ot.nodeName(e,"table")&&ot.nodeName(1===t.nodeType?t:t.firstChild,"tr")?e.getElementsByTagName("tbody")[0]||e.appendChild(e.ownerDocument.createElement("tbody")):e}function p(e){return e.type=(null!==e.getAttribute("type"))+"/"+e.type,e}function f(e){var t=Ut.exec(e.type);return t?e.type=t[1]:e.removeAttribute("type"),e}function h(e,t){for(var n=e.length,r=0;n>r;r++)gt.set(e[r],"globalEval",!t||gt.get(t[r],"globalEval"))}function m(e,t){var n,r,i,o,a,s,u,l;if(1===t.nodeType){if(gt.hasData(e)&&(o=gt.access(e),a=gt.set(t,o),l=o.events)){delete a.handle,a.events={};for(i in l)for(n=0,r=l[i].length;r>n;n++)ot.event.add(t,i,l[i][n])}mt.hasData(e)&&(s=mt.access(e),u=ot.extend({},s),mt.set(t,u))}}function g(e,n){var r=e.getElementsByTagName?e.getElementsByTagName(n||"*"):e.querySelectorAll?e.querySelectorAll(n||"*"):[];return n===t||n&&ot.nodeName(e,n)?ot.merge([e],r):r}function y(e,t){var n=t.nodeName.toLowerCase();"input"===n&&_t.test(e.type)?t.checked=e.checked:("input"===n||"textarea"===n)&&(t.defaultValue=e.defaultValue)}function v(e,t){if(t in e)return t;for(var n=t.charAt(0).toUpperCase()+t.slice(1),r=t,i=Jt.length;i--;)if(t=Jt[i]+n,t in e)return t;return r}function w(e,t){return e=t||e,"none"===ot.css(e,"display")||!ot.contains(e.ownerDocument,e)}function E(t){return e.getComputedStyle(t,null)}function b(e,t){for(var n,r,i,o=[],a=0,s=e.length;s>a;a++)r=e[a],r.style&&(o[a]=gt.get(r,"olddisplay"),n=r.style.display,t?(o[a]||"none"!==n||(r.style.display=""),""===r.style.display&&w(r)&&(o[a]=gt.access(r,"olddisplay",P(r.nodeName)))):o[a]||(i=w(r),(n&&"none"!==n||!i)&&gt.set(r,"olddisplay",i?n:ot.css(r,"display"))));for(a=0;s>a;a++)r=e[a],r.style&&(t&&"none"!==r.style.display&&""!==r.style.display||(r.style.display=t?o[a]||"":"none"));return e}function R(e,t,n){var r=qt.exec(t);return r?Math.max(0,r[1]-(n||0))+(r[2]||"px"):t}function T(e,t,n,r,i){for(var o=n===(r?"border":"content")?4:"width"===t?1:0,a=0;4>o;o+=2)"margin"===n&&(a+=ot.css(e,n+Kt[o],!0,i)),r?("content"===n&&(a-=ot.css(e,"padding"+Kt[o],!0,i)),"margin"!==n&&(a-=ot.css(e,"border"+Kt[o]+"Width",!0,i))):(a+=ot.css(e,"padding"+Kt[o],!0,i),"padding"!==n&&(a+=ot.css(e,"border"+Kt[o]+"Width",!0,i)));return a}function O(e,t,n){var r=!0,i="width"===t?e.offsetWidth:e.offsetHeight,o=E(e),a=ot.support.boxSizing&&"border-box"===ot.css(e,"boxSizing",!1,o);if(0>=i||null==i){if(i=Gt(e,t,o),(0>i||null==i)&&(i=e.style[t]),$t.test(i))return i;r=a&&(ot.support.boxSizingReliable||i===e.style[t]),i=parseFloat(i)||0}return i+T(e,t,n||(a?"border":"content"),r,o)+"px"}function P(e){var t=B,n=Qt[e];return n||(n=A(e,t),"none"!==n&&n||(Vt=(Vt||ot("<iframe frameborder='0' width='0' height='0'/>").css("cssText","display:block !important")).appendTo(t.documentElement),t=(Vt[0].contentWindow||Vt[0].contentDocument).document,t.write("<!doctype html><html><body>"),t.close(),n=A(e,t),Vt.detach()),Qt[e]=n),n}function A(e,t){var n=ot(t.createElement(e)).appendTo(t.body),r=ot.css(n[0],"display");return n.remove(),r}function k(e,t,n,r){var i;if(ot.isArray(t))ot.each(t,function(t,i){n||tn.test(e)?r(e,i):k(e+"["+("object"==typeof i?t:"")+"]",i,n,r)});else if(n||"object"!==ot.type(t))r(e,t);else for(i in t)k(e+"["+i+"]",t[i],n,r)}function I(e){return function(t,n){"string"!=typeof t&&(n=t,t="*");var r,i=0,o=t.toLowerCase().match(st)||[];if(ot.isFunction(n))for(;r=o[i++];)"+"===r[0]?(r=r.slice(1)||"*",(e[r]=e[r]||[]).unshift(n)):(e[r]=e[r]||[]).push(n)}}function C(e,t,n,r){function i(s){var u;return o[s]=!0,ot.each(e[s]||[],function(e,s){var l=s(t,n,r);return"string"!=typeof l||a||o[l]?a?!(u=l):void 0:(t.dataTypes.unshift(l),i(l),!1)}),u}var o={},a=e===wn;return i(t.dataTypes[0])||!o["*"]&&i("*")}function S(e,n){var r,i,o=ot.ajaxSettings.flatOptions||{};for(r in n)n[r]!==t&&((o[r]?e:i||(i={}))[r]=n[r]);return i&&ot.extend(!0,e,i),e}function D(e,n,r){for(var i,o,a,s,u=e.contents,l=e.dataTypes;"*"===l[0];)l.shift(),i===t&&(i=e.mimeType||n.getResponseHeader("Content-Type"));if(i)for(o in u)if(u[o]&&u[o].test(i)){l.unshift(o);break}if(l[0]in r)a=l[0];else{for(o in r){if(!l[0]||e.converters[o+" "+l[0]]){a=o;break}s||(s=o)}a=a||s}return a?(a!==l[0]&&l.unshift(a),r[a]):void 0}function F(e,t,n,r){var i,o,a,s,u,l={},c=e.dataTypes.slice();if(c[1])for(a in e.converters)l[a.toLowerCase()]=e.converters[a];for(o=c.shift();o;)if(e.responseFields[o]&&(n[e.responseFields[o]]=t),!u&&r&&e.dataFilter&&(t=e.dataFilter(t,e.dataType)),u=o,o=c.shift())if("*"===o)o=u;else if("*"!==u&&u!==o){if(a=l[u+" "+o]||l["* "+o],!a)for(i in l)if(s=i.split(" "),s[1]===o&&(a=l[u+" "+s[0]]||l["* "+s[0]])){a===!0?a=l[i]:l[i]!==!0&&(o=s[0],c.unshift(s[1]));break}if(a!==!0)if(a&&e["throws"])t=a(t);else try{t=a(t)}catch(d){return{state:"parsererror",error:a?d:"No conversion from "+u+" to "+o}}}return{state:"success",data:t}}function L(){return setTimeout(function(){In=t}),In=ot.now()}function N(e,t,n){for(var r,i=(Nn[t]||[]).concat(Nn["*"]),o=0,a=i.length;a>o;o++)if(r=i[o].call(n,t,e))return r}function M(e,t,n){var r,i,o=0,a=Ln.length,s=ot.Deferred().always(function(){delete u.elem}),u=function(){if(i)return!1;for(var t=In||L(),n=Math.max(0,l.startTime+l.duration-t),r=n/l.duration||0,o=1-r,a=0,u=l.tweens.length;u>a;a++)l.tweens[a].run(o);return s.notifyWith(e,[l,o,n]),1>o&&u?n:(s.resolveWith(e,[l]),!1)},l=s.promise({elem:e,props:ot.extend({},t),opts:ot.extend(!0,{specialEasing:{}},n),originalProperties:t,originalOptions:n,startTime:In||L(),duration:n.duration,tweens:[],createTween:function(t,n){var r=ot.Tween(e,l.opts,t,n,l.opts.specialEasing[t]||l.opts.easing);return l.tweens.push(r),r},stop:function(t){var n=0,r=t?l.tweens.length:0;if(i)return this;for(i=!0;r>n;n++)l.tweens[n].run(1);return t?s.resolveWith(e,[l,t]):s.rejectWith(e,[l,t]),this}}),c=l.props;for(_(c,l.opts.specialEasing);a>o;o++)if(r=Ln[o].call(l,e,c,l.opts))return r;return ot.map(c,N,l),ot.isFunction(l.opts.start)&&l.opts.start.call(e,l),ot.fx.timer(ot.extend(u,{elem:e,anim:l,queue:l.opts.queue})),l.progress(l.opts.progress).done(l.opts.done,l.opts.complete).fail(l.opts.fail).always(l.opts.always)}function _(e,t){var n,r,i,o,a;for(n in e)if(r=ot.camelCase(n),i=t[r],o=e[n],ot.isArray(o)&&(i=o[1],o=e[n]=o[0]),n!==r&&(e[r]=o,delete e[n]),a=ot.cssHooks[r],a&&"expand"in a){o=a.expand(o),delete e[r];for(n in o)n in e||(e[n]=o[n],t[n]=i)}else t[r]=i}function z(e,n,r){var i,o,a,s,u,l,c=this,d={},p=e.style,f=e.nodeType&&w(e),h=gt.get(e,"fxshow");r.queue||(u=ot._queueHooks(e,"fx"),null==u.unqueued&&(u.unqueued=0,l=u.empty.fire,u.empty.fire=function(){u.unqueued||l()}),u.unqueued++,c.always(function(){c.always(function(){u.unqueued--,ot.queue(e,"fx").length||u.empty.fire()})})),1===e.nodeType&&("height"in n||"width"in n)&&(r.overflow=[p.overflow,p.overflowX,p.overflowY],"inline"===ot.css(e,"display")&&"none"===ot.css(e,"float")&&(p.display="inline-block")),r.overflow&&(p.overflow="hidden",c.always(function(){p.overflow=r.overflow[0],p.overflowX=r.overflow[1],p.overflowY=r.overflow[2]}));for(i in n)if(o=n[i],Sn.exec(o)){if(delete n[i],a=a||"toggle"===o,o===(f?"hide":"show")){if("show"!==o||!h||h[i]===t)continue;f=!0}d[i]=h&&h[i]||ot.style(e,i)}if(!ot.isEmptyObject(d)){h?"hidden"in h&&(f=h.hidden):h=gt.access(e,"fxshow",{}),a&&(h.hidden=!f),f?ot(e).show():c.done(function(){ot(e).hide()}),c.done(function(){var t;gt.remove(e,"fxshow");for(t in d)ot.style(e,t,d[t])});for(i in d)s=N(f?h[i]:0,i,c),i in h||(h[i]=s.start,f&&(s.end=s.start,s.start="width"===i||"height"===i?1:0))}}function x(e,t,n,r,i){return new x.prototype.init(e,t,n,r,i)}function U(e,t){var n,r={height:e},i=0;for(t=t?1:0;4>i;i+=2-t)n=Kt[i],r["margin"+n]=r["padding"+n]=e;return t&&(r.opacity=r.width=e),r}function j(e){return ot.isWindow(e)?e:9===e.nodeType&&e.defaultView}var Y,G,V=typeof t,W=e.location,B=e.document,q=B.documentElement,$=e.jQuery,H=e.$,Q={},X=[],Z="2.0.3",K=X.concat,J=X.push,et=X.slice,tt=X.indexOf,nt=Q.toString,rt=Q.hasOwnProperty,it=Z.trim,ot=function(e,t){return new ot.fn.init(e,t,Y)},at=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,st=/\S+/g,ut=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/,lt=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,ct=/^-ms-/,dt=/-([\da-z])/gi,pt=function(e,t){return t.toUpperCase()},ft=function(){B.removeEventListener("DOMContentLoaded",ft,!1),e.removeEventListener("load",ft,!1),ot.ready()};ot.fn=ot.prototype={jquery:Z,constructor:ot,init:function(e,n,r){var i,o;if(!e)return this;if("string"==typeof e){if(i="<"===e.charAt(0)&&">"===e.charAt(e.length-1)&&e.length>=3?[null,e,null]:ut.exec(e),!i||!i[1]&&n)return!n||n.jquery?(n||r).find(e):this.constructor(n).find(e);if(i[1]){if(n=n instanceof ot?n[0]:n,ot.merge(this,ot.parseHTML(i[1],n&&n.nodeType?n.ownerDocument||n:B,!0)),lt.test(i[1])&&ot.isPlainObject(n))for(i in n)ot.isFunction(this[i])?this[i](n[i]):this.attr(i,n[i]);return this}return o=B.getElementById(i[2]),o&&o.parentNode&&(this.length=1,this[0]=o),this.context=B,this.selector=e,this}return e.nodeType?(this.context=this[0]=e,this.length=1,this):ot.isFunction(e)?r.ready(e):(e.selector!==t&&(this.selector=e.selector,this.context=e.context),ot.makeArray(e,this))},selector:"",length:0,toArray:function(){return et.call(this)},get:function(e){return null==e?this.toArray():0>e?this[this.length+e]:this[e]},pushStack:function(e){var t=ot.merge(this.constructor(),e);return t.prevObject=this,t.context=this.context,t},each:function(e,t){return ot.each(this,e,t)},ready:function(e){return ot.ready.promise().done(e),this},slice:function(){return this.pushStack(et.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(e){var t=this.length,n=+e+(0>e?t:0);return this.pushStack(n>=0&&t>n?[this[n]]:[])},map:function(e){return this.pushStack(ot.map(this,function(t,n){return e.call(t,n,t)}))},end:function(){return this.prevObject||this.constructor(null)},push:J,sort:[].sort,splice:[].splice},ot.fn.init.prototype=ot.fn,ot.extend=ot.fn.extend=function(){var e,n,r,i,o,a,s=arguments[0]||{},u=1,l=arguments.length,c=!1;for("boolean"==typeof s&&(c=s,s=arguments[1]||{},u=2),"object"==typeof s||ot.isFunction(s)||(s={}),l===u&&(s=this,--u);l>u;u++)if(null!=(e=arguments[u]))for(n in e)r=s[n],i=e[n],s!==i&&(c&&i&&(ot.isPlainObject(i)||(o=ot.isArray(i)))?(o?(o=!1,a=r&&ot.isArray(r)?r:[]):a=r&&ot.isPlainObject(r)?r:{},s[n]=ot.extend(c,a,i)):i!==t&&(s[n]=i));return s},ot.extend({expando:"jQuery"+(Z+Math.random()).replace(/\D/g,""),noConflict:function(t){return e.$===ot&&(e.$=H),t&&e.jQuery===ot&&(e.jQuery=$),ot},isReady:!1,readyWait:1,holdReady:function(e){e?ot.readyWait++:ot.ready(!0)},ready:function(e){(e===!0?--ot.readyWait:ot.isReady)||(ot.isReady=!0,e!==!0&&--ot.readyWait>0||(G.resolveWith(B,[ot]),ot.fn.trigger&&ot(B).trigger("ready").off("ready")))},isFunction:function(e){return"function"===ot.type(e)},isArray:Array.isArray,isWindow:function(e){return null!=e&&e===e.window},isNumeric:function(e){return!isNaN(parseFloat(e))&&isFinite(e)},type:function(e){return null==e?String(e):"object"==typeof e||"function"==typeof e?Q[nt.call(e)]||"object":typeof e},isPlainObject:function(e){if("object"!==ot.type(e)||e.nodeType||ot.isWindow(e))return!1;try{if(e.constructor&&!rt.call(e.constructor.prototype,"isPrototypeOf"))return!1}catch(t){return!1}return!0},isEmptyObject:function(e){var t;for(t in e)return!1;return!0},error:function(e){throw new Error(e)},parseHTML:function(e,t,n){if(!e||"string"!=typeof e)return null;"boolean"==typeof t&&(n=t,t=!1),t=t||B;var r=lt.exec(e),i=!n&&[];return r?[t.createElement(r[1])]:(r=ot.buildFragment([e],t,i),i&&ot(i).remove(),ot.merge([],r.childNodes))},parseJSON:JSON.parse,parseXML:function(e){var n,r;if(!e||"string"!=typeof e)return null;try{r=new DOMParser,n=r.parseFromString(e,"text/xml")}catch(i){n=t}return(!n||n.getElementsByTagName("parsererror").length)&&ot.error("Invalid XML: "+e),n},noop:function(){},globalEval:function(e){var t,n=eval;e=ot.trim(e),e&&(1===e.indexOf("use strict")?(t=B.createElement("script"),t.text=e,B.head.appendChild(t).parentNode.removeChild(t)):n(e))},camelCase:function(e){return e.replace(ct,"ms-").replace(dt,pt)},nodeName:function(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()},each:function(e,t,r){var i,o=0,a=e.length,s=n(e);if(r){if(s)for(;a>o&&(i=t.apply(e[o],r),i!==!1);o++);else for(o in e)if(i=t.apply(e[o],r),i===!1)break}else if(s)for(;a>o&&(i=t.call(e[o],o,e[o]),i!==!1);o++);else for(o in e)if(i=t.call(e[o],o,e[o]),i===!1)break;return e},trim:function(e){return null==e?"":it.call(e)},makeArray:function(e,t){var r=t||[];return null!=e&&(n(Object(e))?ot.merge(r,"string"==typeof e?[e]:e):J.call(r,e)),r},inArray:function(e,t,n){return null==t?-1:tt.call(t,e,n)},merge:function(e,n){var r=n.length,i=e.length,o=0;if("number"==typeof r)for(;r>o;o++)e[i++]=n[o];else for(;n[o]!==t;)e[i++]=n[o++];return e.length=i,e},grep:function(e,t,n){var r,i=[],o=0,a=e.length;for(n=!!n;a>o;o++)r=!!t(e[o],o),n!==r&&i.push(e[o]);return i},map:function(e,t,r){var i,o=0,a=e.length,s=n(e),u=[];if(s)for(;a>o;o++)i=t(e[o],o,r),null!=i&&(u[u.length]=i);else for(o in e)i=t(e[o],o,r),null!=i&&(u[u.length]=i);return K.apply([],u)},guid:1,proxy:function(e,n){var r,i,o;return"string"==typeof n&&(r=e[n],n=e,e=r),ot.isFunction(e)?(i=et.call(arguments,2),o=function(){return e.apply(n||this,i.concat(et.call(arguments)))},o.guid=e.guid=e.guid||ot.guid++,o):t},access:function(e,n,r,i,o,a,s){var u=0,l=e.length,c=null==r;if("object"===ot.type(r)){o=!0;for(u in r)ot.access(e,n,u,r[u],!0,a,s)}else if(i!==t&&(o=!0,ot.isFunction(i)||(s=!0),c&&(s?(n.call(e,i),n=null):(c=n,n=function(e,t,n){return c.call(ot(e),n)})),n))for(;l>u;u++)n(e[u],r,s?i:i.call(e[u],u,n(e[u],r)));return o?e:c?n.call(e):l?n(e[0],r):a},now:Date.now,swap:function(e,t,n,r){var i,o,a={};for(o in t)a[o]=e.style[o],e.style[o]=t[o];i=n.apply(e,r||[]);for(o in t)e.style[o]=a[o];return i}}),ot.ready.promise=function(t){return G||(G=ot.Deferred(),"complete"===B.readyState?setTimeout(ot.ready):(B.addEventListener("DOMContentLoaded",ft,!1),e.addEventListener("load",ft,!1))),G.promise(t)},ot.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(e,t){Q["[object "+t+"]"]=t.toLowerCase()}),Y=ot(B),function(e,t){function n(e,t,n,r){var i,o,a,s,u,l,c,d,h,m;if((t?t.ownerDocument||t:j)!==F&&D(t),t=t||F,n=n||[],!e||"string"!=typeof e)return n;if(1!==(s=t.nodeType)&&9!==s)return[];if(N&&!r){if(i=wt.exec(e))if(a=i[1]){if(9===s){if(o=t.getElementById(a),!o||!o.parentNode)return n;if(o.id===a)return n.push(o),n}else if(t.ownerDocument&&(o=t.ownerDocument.getElementById(a))&&x(t,o)&&o.id===a)return n.push(o),n}else{if(i[2])return et.apply(n,t.getElementsByTagName(e)),n;if((a=i[3])&&T.getElementsByClassName&&t.getElementsByClassName)return et.apply(n,t.getElementsByClassName(a)),n}if(T.qsa&&(!M||!M.test(e))){if(d=c=U,h=t,m=9===s&&e,1===s&&"object"!==t.nodeName.toLowerCase()){for(l=p(e),(c=t.getAttribute("id"))?d=c.replace(Rt,"\\$&"):t.setAttribute("id",d),d="[id='"+d+"'] ",u=l.length;u--;)l[u]=d+f(l[u]);h=ft.test(e)&&t.parentNode||t,m=l.join(",")}if(m)try{return et.apply(n,h.querySelectorAll(m)),n}catch(g){}finally{c||t.removeAttribute("id")}}}return b(e.replace(ct,"$1"),t,n,r)}function r(){function e(n,r){return t.push(n+=" ")>P.cacheLength&&delete e[t.shift()],e[n]=r}var t=[];return e}function i(e){return e[U]=!0,e}function o(e){var t=F.createElement("div");try{return!!e(t)}catch(n){return!1}finally{t.parentNode&&t.parentNode.removeChild(t),t=null}}function a(e,t){for(var n=e.split("|"),r=e.length;r--;)P.attrHandle[n[r]]=t}function s(e,t){var n=t&&e,r=n&&1===e.nodeType&&1===t.nodeType&&(~t.sourceIndex||Q)-(~e.sourceIndex||Q);if(r)return r;if(n)for(;n=n.nextSibling;)if(n===t)return-1;return e?1:-1}function u(e){return function(t){var n=t.nodeName.toLowerCase();return"input"===n&&t.type===e}}function l(e){return function(t){var n=t.nodeName.toLowerCase();return("input"===n||"button"===n)&&t.type===e}}function c(e){return i(function(t){return t=+t,i(function(n,r){for(var i,o=e([],n.length,t),a=o.length;a--;)n[i=o[a]]&&(n[i]=!(r[i]=n[i]))})})}function d(){}function p(e,t){var r,i,o,a,s,u,l,c=W[e+" "];if(c)return t?0:c.slice(0);for(s=e,u=[],l=P.preFilter;s;){(!r||(i=dt.exec(s)))&&(i&&(s=s.slice(i[0].length)||s),u.push(o=[])),r=!1,(i=pt.exec(s))&&(r=i.shift(),o.push({value:r,type:i[0].replace(ct," ")}),s=s.slice(r.length));for(a in P.filter)!(i=yt[a].exec(s))||l[a]&&!(i=l[a](i))||(r=i.shift(),o.push({value:r,type:a,matches:i}),s=s.slice(r.length));if(!r)break}return t?s.length:s?n.error(e):W(e,u).slice(0)}function f(e){for(var t=0,n=e.length,r="";n>t;t++)r+=e[t].value;return r}function h(e,t,n){var r=t.dir,i=n&&"parentNode"===r,o=G++;return t.first?function(t,n,o){for(;t=t[r];)if(1===t.nodeType||i)return e(t,n,o)}:function(t,n,a){var s,u,l,c=Y+" "+o;if(a){for(;t=t[r];)if((1===t.nodeType||i)&&e(t,n,a))return!0}else for(;t=t[r];)if(1===t.nodeType||i)if(l=t[U]||(t[U]={}),(u=l[r])&&u[0]===c){if((s=u[1])===!0||s===O)return s===!0}else if(u=l[r]=[c],u[1]=e(t,n,a)||O,u[1]===!0)return!0}}function m(e){return e.length>1?function(t,n,r){for(var i=e.length;i--;)if(!e[i](t,n,r))return!1;return!0}:e[0]}function g(e,t,n,r,i){for(var o,a=[],s=0,u=e.length,l=null!=t;u>s;s++)(o=e[s])&&(!n||n(o,r,i))&&(a.push(o),l&&t.push(s));return a}function y(e,t,n,r,o,a){return r&&!r[U]&&(r=y(r)),o&&!o[U]&&(o=y(o,a)),i(function(i,a,s,u){var l,c,d,p=[],f=[],h=a.length,m=i||E(t||"*",s.nodeType?[s]:s,[]),y=!e||!i&&t?m:g(m,p,e,s,u),v=n?o||(i?e:h||r)?[]:a:y;if(n&&n(y,v,s,u),r)for(l=g(v,f),r(l,[],s,u),c=l.length;c--;)(d=l[c])&&(v[f[c]]=!(y[f[c]]=d));if(i){if(o||e){if(o){for(l=[],c=v.length;c--;)(d=v[c])&&l.push(y[c]=d);o(null,v=[],l,u)}for(c=v.length;c--;)(d=v[c])&&(l=o?nt.call(i,d):p[c])>-1&&(i[l]=!(a[l]=d))}}else v=g(v===a?v.splice(h,v.length):v),o?o(null,a,v,u):et.apply(a,v)})}function v(e){for(var t,n,r,i=e.length,o=P.relative[e[0].type],a=o||P.relative[" "],s=o?1:0,u=h(function(e){return e===t},a,!0),l=h(function(e){return nt.call(t,e)>-1},a,!0),c=[function(e,n,r){return!o&&(r||n!==C)||((t=n).nodeType?u(e,n,r):l(e,n,r))}];i>s;s++)if(n=P.relative[e[s].type])c=[h(m(c),n)];else{if(n=P.filter[e[s].type].apply(null,e[s].matches),n[U]){for(r=++s;i>r&&!P.relative[e[r].type];r++);return y(s>1&&m(c),s>1&&f(e.slice(0,s-1).concat({value:" "===e[s-2].type?"*":""})).replace(ct,"$1"),n,r>s&&v(e.slice(s,r)),i>r&&v(e=e.slice(r)),i>r&&f(e))}c.push(n)}return m(c)}function w(e,t){var r=0,o=t.length>0,a=e.length>0,s=function(i,s,u,l,c){var d,p,f,h=[],m=0,y="0",v=i&&[],w=null!=c,E=C,b=i||a&&P.find.TAG("*",c&&s.parentNode||s),R=Y+=null==E?1:Math.random()||.1;for(w&&(C=s!==F&&s,O=r);null!=(d=b[y]);y++){if(a&&d){for(p=0;f=e[p++];)if(f(d,s,u)){l.push(d);break}w&&(Y=R,O=++r)}o&&((d=!f&&d)&&m--,i&&v.push(d))}if(m+=y,o&&y!==m){for(p=0;f=t[p++];)f(v,h,s,u);if(i){if(m>0)for(;y--;)v[y]||h[y]||(h[y]=K.call(l));h=g(h)}et.apply(l,h),w&&!i&&h.length>0&&m+t.length>1&&n.uniqueSort(l)}return w&&(Y=R,C=E),v};return o?i(s):s}function E(e,t,r){for(var i=0,o=t.length;o>i;i++)n(e,t[i],r);return r}function b(e,t,n,r){var i,o,a,s,u,l=p(e);if(!r&&1===l.length){if(o=l[0]=l[0].slice(0),o.length>2&&"ID"===(a=o[0]).type&&T.getById&&9===t.nodeType&&N&&P.relative[o[1].type]){if(t=(P.find.ID(a.matches[0].replace(Tt,Ot),t)||[])[0],!t)return n;e=e.slice(o.shift().value.length)}for(i=yt.needsContext.test(e)?0:o.length;i--&&(a=o[i],!P.relative[s=a.type]);)if((u=P.find[s])&&(r=u(a.matches[0].replace(Tt,Ot),ft.test(o[0].type)&&t.parentNode||t))){if(o.splice(i,1),e=r.length&&f(o),!e)return et.apply(n,r),n;break}}return I(e,l)(r,t,!N,n,ft.test(e)),n}var R,T,O,P,A,k,I,C,S,D,F,L,N,M,_,z,x,U="sizzle"+-new Date,j=e.document,Y=0,G=0,V=r(),W=r(),B=r(),q=!1,$=function(e,t){return e===t?(q=!0,0):0},H=typeof t,Q=1<<31,X={}.hasOwnProperty,Z=[],K=Z.pop,J=Z.push,et=Z.push,tt=Z.slice,nt=Z.indexOf||function(e){for(var t=0,n=this.length;n>t;t++)if(this[t]===e)return t;return-1},rt="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",it="[\\x20\\t\\r\\n\\f]",at="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",st=at.replace("w","w#"),ut="\\["+it+"*("+at+")"+it+"*(?:([*^$|!~]?=)"+it+"*(?:(['\"])((?:\\\\.|[^\\\\])*?)\\3|("+st+")|)|)"+it+"*\\]",lt=":("+at+")(?:\\(((['\"])((?:\\\\.|[^\\\\])*?)\\3|((?:\\\\.|[^\\\\()[\\]]|"+ut.replace(3,8)+")*)|.*)\\)|)",ct=new RegExp("^"+it+"+|((?:^|[^\\\\])(?:\\\\.)*)"+it+"+$","g"),dt=new RegExp("^"+it+"*,"+it+"*"),pt=new RegExp("^"+it+"*([>+~]|"+it+")"+it+"*"),ft=new RegExp(it+"*[+~]"),ht=new RegExp("="+it+"*([^\\]'\"]*)"+it+"*\\]","g"),mt=new RegExp(lt),gt=new RegExp("^"+st+"$"),yt={ID:new RegExp("^#("+at+")"),CLASS:new RegExp("^\\.("+at+")"),TAG:new RegExp("^("+at.replace("w","w*")+")"),ATTR:new RegExp("^"+ut),PSEUDO:new RegExp("^"+lt),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+it+"*(even|odd|(([+-]|)(\\d*)n|)"+it+"*(?:([+-]|)"+it+"*(\\d+)|))"+it+"*\\)|)","i"),bool:new RegExp("^(?:"+rt+")$","i"),needsContext:new RegExp("^"+it+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+it+"*((?:-\\d)?\\d*)"+it+"*\\)|)(?=[^-]|$)","i")},vt=/^[^{]+\{\s*\[native \w/,wt=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,Et=/^(?:input|select|textarea|button)$/i,bt=/^h\d$/i,Rt=/'|\\/g,Tt=new RegExp("\\\\([\\da-f]{1,6}"+it+"?|("+it+")|.)","ig"),Ot=function(e,t,n){var r="0x"+t-65536;return r!==r||n?t:0>r?String.fromCharCode(r+65536):String.fromCharCode(r>>10|55296,1023&r|56320)};try{et.apply(Z=tt.call(j.childNodes),j.childNodes),Z[j.childNodes.length].nodeType}catch(Pt){et={apply:Z.length?function(e,t){J.apply(e,tt.call(t))}:function(e,t){for(var n=e.length,r=0;e[n++]=t[r++];);e.length=n-1}}}k=n.isXML=function(e){var t=e&&(e.ownerDocument||e).documentElement;return t?"HTML"!==t.nodeName:!1},T=n.support={},D=n.setDocument=function(e){var t=e?e.ownerDocument||e:j,n=t.defaultView;return t!==F&&9===t.nodeType&&t.documentElement?(F=t,L=t.documentElement,N=!k(t),n&&n.attachEvent&&n!==n.top&&n.attachEvent("onbeforeunload",function(){D()}),T.attributes=o(function(e){return e.className="i",!e.getAttribute("className")}),T.getElementsByTagName=o(function(e){return e.appendChild(t.createComment("")),!e.getElementsByTagName("*").length}),T.getElementsByClassName=o(function(e){return e.innerHTML="<div class='a'></div><div class='a i'></div>",e.firstChild.className="i",2===e.getElementsByClassName("i").length}),T.getById=o(function(e){return L.appendChild(e).id=U,!t.getElementsByName||!t.getElementsByName(U).length}),T.getById?(P.find.ID=function(e,t){if(typeof t.getElementById!==H&&N){var n=t.getElementById(e);return n&&n.parentNode?[n]:[]}},P.filter.ID=function(e){var t=e.replace(Tt,Ot);return function(e){return e.getAttribute("id")===t}}):(delete P.find.ID,P.filter.ID=function(e){var t=e.replace(Tt,Ot);return function(e){var n=typeof e.getAttributeNode!==H&&e.getAttributeNode("id");return n&&n.value===t}}),P.find.TAG=T.getElementsByTagName?function(e,t){return typeof t.getElementsByTagName!==H?t.getElementsByTagName(e):void 0}:function(e,t){var n,r=[],i=0,o=t.getElementsByTagName(e);if("*"===e){for(;n=o[i++];)1===n.nodeType&&r.push(n);return r}return o},P.find.CLASS=T.getElementsByClassName&&function(e,t){return typeof t.getElementsByClassName!==H&&N?t.getElementsByClassName(e):void 0},_=[],M=[],(T.qsa=vt.test(t.querySelectorAll))&&(o(function(e){e.innerHTML="<select><option selected=''></option></select>",e.querySelectorAll("[selected]").length||M.push("\\["+it+"*(?:value|"+rt+")"),e.querySelectorAll(":checked").length||M.push(":checked")}),o(function(e){var n=t.createElement("input");n.setAttribute("type","hidden"),e.appendChild(n).setAttribute("t",""),e.querySelectorAll("[t^='']").length&&M.push("[*^$]="+it+"*(?:''|\"\")"),e.querySelectorAll(":enabled").length||M.push(":enabled",":disabled"),e.querySelectorAll("*,:x"),M.push(",.*:")})),(T.matchesSelector=vt.test(z=L.webkitMatchesSelector||L.mozMatchesSelector||L.oMatchesSelector||L.msMatchesSelector))&&o(function(e){T.disconnectedMatch=z.call(e,"div"),z.call(e,"[s!='']:x"),_.push("!=",lt)}),M=M.length&&new RegExp(M.join("|")),_=_.length&&new RegExp(_.join("|")),x=vt.test(L.contains)||L.compareDocumentPosition?function(e,t){var n=9===e.nodeType?e.documentElement:e,r=t&&t.parentNode;return e===r||!(!r||1!==r.nodeType||!(n.contains?n.contains(r):e.compareDocumentPosition&&16&e.compareDocumentPosition(r)))}:function(e,t){if(t)for(;t=t.parentNode;)if(t===e)return!0;return!1},$=L.compareDocumentPosition?function(e,n){if(e===n)return q=!0,0;var r=n.compareDocumentPosition&&e.compareDocumentPosition&&e.compareDocumentPosition(n);return r?1&r||!T.sortDetached&&n.compareDocumentPosition(e)===r?e===t||x(j,e)?-1:n===t||x(j,n)?1:S?nt.call(S,e)-nt.call(S,n):0:4&r?-1:1:e.compareDocumentPosition?-1:1}:function(e,n){var r,i=0,o=e.parentNode,a=n.parentNode,u=[e],l=[n];if(e===n)return q=!0,0;if(!o||!a)return e===t?-1:n===t?1:o?-1:a?1:S?nt.call(S,e)-nt.call(S,n):0;if(o===a)return s(e,n);for(r=e;r=r.parentNode;)u.unshift(r);for(r=n;r=r.parentNode;)l.unshift(r);for(;u[i]===l[i];)i++;return i?s(u[i],l[i]):u[i]===j?-1:l[i]===j?1:0},t):F},n.matches=function(e,t){return n(e,null,null,t)},n.matchesSelector=function(e,t){if((e.ownerDocument||e)!==F&&D(e),t=t.replace(ht,"='$1']"),!(!T.matchesSelector||!N||_&&_.test(t)||M&&M.test(t)))try{var r=z.call(e,t);if(r||T.disconnectedMatch||e.document&&11!==e.document.nodeType)return r}catch(i){}return n(t,F,null,[e]).length>0},n.contains=function(e,t){return(e.ownerDocument||e)!==F&&D(e),x(e,t)},n.attr=function(e,n){(e.ownerDocument||e)!==F&&D(e);var r=P.attrHandle[n.toLowerCase()],i=r&&X.call(P.attrHandle,n.toLowerCase())?r(e,n,!N):t;return i===t?T.attributes||!N?e.getAttribute(n):(i=e.getAttributeNode(n))&&i.specified?i.value:null:i},n.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e)},n.uniqueSort=function(e){var t,n=[],r=0,i=0;if(q=!T.detectDuplicates,S=!T.sortStable&&e.slice(0),e.sort($),q){for(;t=e[i++];)t===e[i]&&(r=n.push(i));for(;r--;)e.splice(n[r],1)}return e},A=n.getText=function(e){var t,n="",r=0,i=e.nodeType;if(i){if(1===i||9===i||11===i){if("string"==typeof e.textContent)return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)n+=A(e)}else if(3===i||4===i)return e.nodeValue}else for(;t=e[r];r++)n+=A(t);return n},P=n.selectors={cacheLength:50,createPseudo:i,match:yt,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(Tt,Ot),e[3]=(e[4]||e[5]||"").replace(Tt,Ot),"~="===e[2]&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),"nth"===e[1].slice(0,3)?(e[3]||n.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*("even"===e[3]||"odd"===e[3])),e[5]=+(e[7]+e[8]||"odd"===e[3])):e[3]&&n.error(e[0]),e},PSEUDO:function(e){var n,r=!e[5]&&e[2];return yt.CHILD.test(e[0])?null:(e[3]&&e[4]!==t?e[2]=e[4]:r&&mt.test(r)&&(n=p(r,!0))&&(n=r.indexOf(")",r.length-n)-r.length)&&(e[0]=e[0].slice(0,n),e[2]=r.slice(0,n)),e.slice(0,3))}},filter:{TAG:function(e){var t=e.replace(Tt,Ot).toLowerCase();return"*"===e?function(){return!0}:function(e){return e.nodeName&&e.nodeName.toLowerCase()===t}},CLASS:function(e){var t=V[e+" "];return t||(t=new RegExp("(^|"+it+")"+e+"("+it+"|$)"))&&V(e,function(e){return t.test("string"==typeof e.className&&e.className||typeof e.getAttribute!==H&&e.getAttribute("class")||"")})},ATTR:function(e,t,r){return function(i){var o=n.attr(i,e);return null==o?"!="===t:t?(o+="","="===t?o===r:"!="===t?o!==r:"^="===t?r&&0===o.indexOf(r):"*="===t?r&&o.indexOf(r)>-1:"$="===t?r&&o.slice(-r.length)===r:"~="===t?(" "+o+" ").indexOf(r)>-1:"|="===t?o===r||o.slice(0,r.length+1)===r+"-":!1):!0}},CHILD:function(e,t,n,r,i){var o="nth"!==e.slice(0,3),a="last"!==e.slice(-4),s="of-type"===t;return 1===r&&0===i?function(e){return!!e.parentNode}:function(t,n,u){var l,c,d,p,f,h,m=o!==a?"nextSibling":"previousSibling",g=t.parentNode,y=s&&t.nodeName.toLowerCase(),v=!u&&!s;if(g){if(o){for(;m;){for(d=t;d=d[m];)if(s?d.nodeName.toLowerCase()===y:1===d.nodeType)return!1;h=m="only"===e&&!h&&"nextSibling"}return!0}if(h=[a?g.firstChild:g.lastChild],a&&v){for(c=g[U]||(g[U]={}),l=c[e]||[],f=l[0]===Y&&l[1],p=l[0]===Y&&l[2],d=f&&g.childNodes[f];d=++f&&d&&d[m]||(p=f=0)||h.pop();)if(1===d.nodeType&&++p&&d===t){c[e]=[Y,f,p];break}}else if(v&&(l=(t[U]||(t[U]={}))[e])&&l[0]===Y)p=l[1];else for(;(d=++f&&d&&d[m]||(p=f=0)||h.pop())&&((s?d.nodeName.toLowerCase()!==y:1!==d.nodeType)||!++p||(v&&((d[U]||(d[U]={}))[e]=[Y,p]),d!==t)););return p-=i,p===r||p%r===0&&p/r>=0}}},PSEUDO:function(e,t){var r,o=P.pseudos[e]||P.setFilters[e.toLowerCase()]||n.error("unsupported pseudo: "+e);return o[U]?o(t):o.length>1?(r=[e,e,"",t],P.setFilters.hasOwnProperty(e.toLowerCase())?i(function(e,n){for(var r,i=o(e,t),a=i.length;a--;)r=nt.call(e,i[a]),e[r]=!(n[r]=i[a])}):function(e){return o(e,0,r)}):o}},pseudos:{not:i(function(e){var t=[],n=[],r=I(e.replace(ct,"$1"));return r[U]?i(function(e,t,n,i){for(var o,a=r(e,null,i,[]),s=e.length;s--;)(o=a[s])&&(e[s]=!(t[s]=o))}):function(e,i,o){return t[0]=e,r(t,null,o,n),!n.pop()}}),has:i(function(e){return function(t){return n(e,t).length>0}}),contains:i(function(e){return function(t){return(t.textContent||t.innerText||A(t)).indexOf(e)>-1}}),lang:i(function(e){return gt.test(e||"")||n.error("unsupported lang: "+e),e=e.replace(Tt,Ot).toLowerCase(),function(t){var n;do if(n=N?t.lang:t.getAttribute("xml:lang")||t.getAttribute("lang"))return n=n.toLowerCase(),n===e||0===n.indexOf(e+"-");while((t=t.parentNode)&&1===t.nodeType);return!1}}),target:function(t){var n=e.location&&e.location.hash;return n&&n.slice(1)===t.id},root:function(e){return e===L},focus:function(e){return e===F.activeElement&&(!F.hasFocus||F.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},enabled:function(e){return e.disabled===!1},disabled:function(e){return e.disabled===!0},checked:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&!!e.checked||"option"===t&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,e.selected===!0},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeName>"@"||3===e.nodeType||4===e.nodeType)return!1;return!0},parent:function(e){return!P.pseudos.empty(e)},header:function(e){return bt.test(e.nodeName)},input:function(e){return Et.test(e.nodeName)},button:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&"button"===e.type||"button"===t},text:function(e){var t;return"input"===e.nodeName.toLowerCase()&&"text"===e.type&&(null==(t=e.getAttribute("type"))||t.toLowerCase()===e.type)},first:c(function(){return[0]}),last:c(function(e,t){return[t-1]}),eq:c(function(e,t,n){return[0>n?n+t:n]}),even:c(function(e,t){for(var n=0;t>n;n+=2)e.push(n);return e}),odd:c(function(e,t){for(var n=1;t>n;n+=2)e.push(n);return e}),lt:c(function(e,t,n){for(var r=0>n?n+t:n;--r>=0;)e.push(r);return e}),gt:c(function(e,t,n){for(var r=0>n?n+t:n;++r<t;)e.push(r);return e})}},P.pseudos.nth=P.pseudos.eq;for(R in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})P.pseudos[R]=u(R);
for(R in{submit:!0,reset:!0})P.pseudos[R]=l(R);d.prototype=P.filters=P.pseudos,P.setFilters=new d,I=n.compile=function(e,t){var n,r=[],i=[],o=B[e+" "];if(!o){for(t||(t=p(e)),n=t.length;n--;)o=v(t[n]),o[U]?r.push(o):i.push(o);o=B(e,w(i,r))}return o},T.sortStable=U.split("").sort($).join("")===U,T.detectDuplicates=q,D(),T.sortDetached=o(function(e){return 1&e.compareDocumentPosition(F.createElement("div"))}),o(function(e){return e.innerHTML="<a href='#'></a>","#"===e.firstChild.getAttribute("href")})||a("type|href|height|width",function(e,t,n){return n?void 0:e.getAttribute(t,"type"===t.toLowerCase()?1:2)}),T.attributes&&o(function(e){return e.innerHTML="<input/>",e.firstChild.setAttribute("value",""),""===e.firstChild.getAttribute("value")})||a("value",function(e,t,n){return n||"input"!==e.nodeName.toLowerCase()?void 0:e.defaultValue}),o(function(e){return null==e.getAttribute("disabled")})||a(rt,function(e,t,n){var r;return n?void 0:(r=e.getAttributeNode(t))&&r.specified?r.value:e[t]===!0?t.toLowerCase():null}),ot.find=n,ot.expr=n.selectors,ot.expr[":"]=ot.expr.pseudos,ot.unique=n.uniqueSort,ot.text=n.getText,ot.isXMLDoc=n.isXML,ot.contains=n.contains}(e);var ht={};ot.Callbacks=function(e){e="string"==typeof e?ht[e]||r(e):ot.extend({},e);var n,i,o,a,s,u,l=[],c=!e.once&&[],d=function(t){for(n=e.memory&&t,i=!0,u=a||0,a=0,s=l.length,o=!0;l&&s>u;u++)if(l[u].apply(t[0],t[1])===!1&&e.stopOnFalse){n=!1;break}o=!1,l&&(c?c.length&&d(c.shift()):n?l=[]:p.disable())},p={add:function(){if(l){var t=l.length;!function r(t){ot.each(t,function(t,n){var i=ot.type(n);"function"===i?e.unique&&p.has(n)||l.push(n):n&&n.length&&"string"!==i&&r(n)})}(arguments),o?s=l.length:n&&(a=t,d(n))}return this},remove:function(){return l&&ot.each(arguments,function(e,t){for(var n;(n=ot.inArray(t,l,n))>-1;)l.splice(n,1),o&&(s>=n&&s--,u>=n&&u--)}),this},has:function(e){return e?ot.inArray(e,l)>-1:!(!l||!l.length)},empty:function(){return l=[],s=0,this},disable:function(){return l=c=n=t,this},disabled:function(){return!l},lock:function(){return c=t,n||p.disable(),this},locked:function(){return!c},fireWith:function(e,t){return!l||i&&!c||(t=t||[],t=[e,t.slice?t.slice():t],o?c.push(t):d(t)),this},fire:function(){return p.fireWith(this,arguments),this},fired:function(){return!!i}};return p},ot.extend({Deferred:function(e){var t=[["resolve","done",ot.Callbacks("once memory"),"resolved"],["reject","fail",ot.Callbacks("once memory"),"rejected"],["notify","progress",ot.Callbacks("memory")]],n="pending",r={state:function(){return n},always:function(){return i.done(arguments).fail(arguments),this},then:function(){var e=arguments;return ot.Deferred(function(n){ot.each(t,function(t,o){var a=o[0],s=ot.isFunction(e[t])&&e[t];i[o[1]](function(){var e=s&&s.apply(this,arguments);e&&ot.isFunction(e.promise)?e.promise().done(n.resolve).fail(n.reject).progress(n.notify):n[a+"With"](this===r?n.promise():this,s?[e]:arguments)})}),e=null}).promise()},promise:function(e){return null!=e?ot.extend(e,r):r}},i={};return r.pipe=r.then,ot.each(t,function(e,o){var a=o[2],s=o[3];r[o[1]]=a.add,s&&a.add(function(){n=s},t[1^e][2].disable,t[2][2].lock),i[o[0]]=function(){return i[o[0]+"With"](this===i?r:this,arguments),this},i[o[0]+"With"]=a.fireWith}),r.promise(i),e&&e.call(i,i),i},when:function(e){var t,n,r,i=0,o=et.call(arguments),a=o.length,s=1!==a||e&&ot.isFunction(e.promise)?a:0,u=1===s?e:ot.Deferred(),l=function(e,n,r){return function(i){n[e]=this,r[e]=arguments.length>1?et.call(arguments):i,r===t?u.notifyWith(n,r):--s||u.resolveWith(n,r)}};if(a>1)for(t=new Array(a),n=new Array(a),r=new Array(a);a>i;i++)o[i]&&ot.isFunction(o[i].promise)?o[i].promise().done(l(i,r,o)).fail(u.reject).progress(l(i,n,t)):--s;return s||u.resolveWith(r,o),u.promise()}}),ot.support=function(t){var n=B.createElement("input"),r=B.createDocumentFragment(),i=B.createElement("div"),o=B.createElement("select"),a=o.appendChild(B.createElement("option"));return n.type?(n.type="checkbox",t.checkOn=""!==n.value,t.optSelected=a.selected,t.reliableMarginRight=!0,t.boxSizingReliable=!0,t.pixelPosition=!1,n.checked=!0,t.noCloneChecked=n.cloneNode(!0).checked,o.disabled=!0,t.optDisabled=!a.disabled,n=B.createElement("input"),n.value="t",n.type="radio",t.radioValue="t"===n.value,n.setAttribute("checked","t"),n.setAttribute("name","t"),r.appendChild(n),t.checkClone=r.cloneNode(!0).cloneNode(!0).lastChild.checked,t.focusinBubbles="onfocusin"in e,i.style.backgroundClip="content-box",i.cloneNode(!0).style.backgroundClip="",t.clearCloneStyle="content-box"===i.style.backgroundClip,ot(function(){var n,r,o="padding:0;margin:0;border:0;display:block;-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box",a=B.getElementsByTagName("body")[0];a&&(n=B.createElement("div"),n.style.cssText="border:0;width:0;height:0;position:absolute;top:0;left:-9999px;margin-top:1px",a.appendChild(n).appendChild(i),i.innerHTML="",i.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;padding:1px;border:1px;display:block;width:4px;margin-top:1%;position:absolute;top:1%",ot.swap(a,null!=a.style.zoom?{zoom:1}:{},function(){t.boxSizing=4===i.offsetWidth}),e.getComputedStyle&&(t.pixelPosition="1%"!==(e.getComputedStyle(i,null)||{}).top,t.boxSizingReliable="4px"===(e.getComputedStyle(i,null)||{width:"4px"}).width,r=i.appendChild(B.createElement("div")),r.style.cssText=i.style.cssText=o,r.style.marginRight=r.style.width="0",i.style.width="1px",t.reliableMarginRight=!parseFloat((e.getComputedStyle(r,null)||{}).marginRight)),a.removeChild(n))}),t):t}({});var mt,gt,yt=/(?:\{[\s\S]*\}|\[[\s\S]*\])$/,vt=/([A-Z])/g;i.uid=1,i.accepts=function(e){return e.nodeType?1===e.nodeType||9===e.nodeType:!0},i.prototype={key:function(e){if(!i.accepts(e))return 0;var t={},n=e[this.expando];if(!n){n=i.uid++;try{t[this.expando]={value:n},Object.defineProperties(e,t)}catch(r){t[this.expando]=n,ot.extend(e,t)}}return this.cache[n]||(this.cache[n]={}),n},set:function(e,t,n){var r,i=this.key(e),o=this.cache[i];if("string"==typeof t)o[t]=n;else if(ot.isEmptyObject(o))ot.extend(this.cache[i],t);else for(r in t)o[r]=t[r];return o},get:function(e,n){var r=this.cache[this.key(e)];return n===t?r:r[n]},access:function(e,n,r){var i;return n===t||n&&"string"==typeof n&&r===t?(i=this.get(e,n),i!==t?i:this.get(e,ot.camelCase(n))):(this.set(e,n,r),r!==t?r:n)},remove:function(e,n){var r,i,o,a=this.key(e),s=this.cache[a];if(n===t)this.cache[a]={};else{ot.isArray(n)?i=n.concat(n.map(ot.camelCase)):(o=ot.camelCase(n),n in s?i=[n,o]:(i=o,i=i in s?[i]:i.match(st)||[])),r=i.length;for(;r--;)delete s[i[r]]}},hasData:function(e){return!ot.isEmptyObject(this.cache[e[this.expando]]||{})},discard:function(e){e[this.expando]&&delete this.cache[e[this.expando]]}},mt=new i,gt=new i,ot.extend({acceptData:i.accepts,hasData:function(e){return mt.hasData(e)||gt.hasData(e)},data:function(e,t,n){return mt.access(e,t,n)},removeData:function(e,t){mt.remove(e,t)},_data:function(e,t,n){return gt.access(e,t,n)},_removeData:function(e,t){gt.remove(e,t)}}),ot.fn.extend({data:function(e,n){var r,i,a=this[0],s=0,u=null;if(e===t){if(this.length&&(u=mt.get(a),1===a.nodeType&&!gt.get(a,"hasDataAttrs"))){for(r=a.attributes;s<r.length;s++)i=r[s].name,0===i.indexOf("data-")&&(i=ot.camelCase(i.slice(5)),o(a,i,u[i]));gt.set(a,"hasDataAttrs",!0)}return u}return"object"==typeof e?this.each(function(){mt.set(this,e)}):ot.access(this,function(n){var r,i=ot.camelCase(e);if(a&&n===t){if(r=mt.get(a,e),r!==t)return r;if(r=mt.get(a,i),r!==t)return r;if(r=o(a,i,t),r!==t)return r}else this.each(function(){var r=mt.get(this,i);mt.set(this,i,n),-1!==e.indexOf("-")&&r!==t&&mt.set(this,e,n)})},null,n,arguments.length>1,null,!0)},removeData:function(e){return this.each(function(){mt.remove(this,e)})}}),ot.extend({queue:function(e,t,n){var r;return e?(t=(t||"fx")+"queue",r=gt.get(e,t),n&&(!r||ot.isArray(n)?r=gt.access(e,t,ot.makeArray(n)):r.push(n)),r||[]):void 0},dequeue:function(e,t){t=t||"fx";var n=ot.queue(e,t),r=n.length,i=n.shift(),o=ot._queueHooks(e,t),a=function(){ot.dequeue(e,t)};"inprogress"===i&&(i=n.shift(),r--),i&&("fx"===t&&n.unshift("inprogress"),delete o.stop,i.call(e,a,o)),!r&&o&&o.empty.fire()},_queueHooks:function(e,t){var n=t+"queueHooks";return gt.get(e,n)||gt.access(e,n,{empty:ot.Callbacks("once memory").add(function(){gt.remove(e,[t+"queue",n])})})}}),ot.fn.extend({queue:function(e,n){var r=2;return"string"!=typeof e&&(n=e,e="fx",r--),arguments.length<r?ot.queue(this[0],e):n===t?this:this.each(function(){var t=ot.queue(this,e,n);ot._queueHooks(this,e),"fx"===e&&"inprogress"!==t[0]&&ot.dequeue(this,e)})},dequeue:function(e){return this.each(function(){ot.dequeue(this,e)})},delay:function(e,t){return e=ot.fx?ot.fx.speeds[e]||e:e,t=t||"fx",this.queue(t,function(t,n){var r=setTimeout(t,e);n.stop=function(){clearTimeout(r)}})},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,n){var r,i=1,o=ot.Deferred(),a=this,s=this.length,u=function(){--i||o.resolveWith(a,[a])};for("string"!=typeof e&&(n=e,e=t),e=e||"fx";s--;)r=gt.get(a[s],e+"queueHooks"),r&&r.empty&&(i++,r.empty.add(u));return u(),o.promise(n)}});var wt,Et,bt=/[\t\r\n\f]/g,Rt=/\r/g,Tt=/^(?:input|select|textarea|button)$/i;ot.fn.extend({attr:function(e,t){return ot.access(this,ot.attr,e,t,arguments.length>1)},removeAttr:function(e){return this.each(function(){ot.removeAttr(this,e)})},prop:function(e,t){return ot.access(this,ot.prop,e,t,arguments.length>1)},removeProp:function(e){return this.each(function(){delete this[ot.propFix[e]||e]})},addClass:function(e){var t,n,r,i,o,a=0,s=this.length,u="string"==typeof e&&e;if(ot.isFunction(e))return this.each(function(t){ot(this).addClass(e.call(this,t,this.className))});if(u)for(t=(e||"").match(st)||[];s>a;a++)if(n=this[a],r=1===n.nodeType&&(n.className?(" "+n.className+" ").replace(bt," "):" ")){for(o=0;i=t[o++];)r.indexOf(" "+i+" ")<0&&(r+=i+" ");n.className=ot.trim(r)}return this},removeClass:function(e){var t,n,r,i,o,a=0,s=this.length,u=0===arguments.length||"string"==typeof e&&e;if(ot.isFunction(e))return this.each(function(t){ot(this).removeClass(e.call(this,t,this.className))});if(u)for(t=(e||"").match(st)||[];s>a;a++)if(n=this[a],r=1===n.nodeType&&(n.className?(" "+n.className+" ").replace(bt," "):"")){for(o=0;i=t[o++];)for(;r.indexOf(" "+i+" ")>=0;)r=r.replace(" "+i+" "," ");n.className=e?ot.trim(r):""}return this},toggleClass:function(e,t){var n=typeof e;return"boolean"==typeof t&&"string"===n?t?this.addClass(e):this.removeClass(e):this.each(ot.isFunction(e)?function(n){ot(this).toggleClass(e.call(this,n,this.className,t),t)}:function(){if("string"===n)for(var t,r=0,i=ot(this),o=e.match(st)||[];t=o[r++];)i.hasClass(t)?i.removeClass(t):i.addClass(t);else(n===V||"boolean"===n)&&(this.className&&gt.set(this,"__className__",this.className),this.className=this.className||e===!1?"":gt.get(this,"__className__")||"")})},hasClass:function(e){for(var t=" "+e+" ",n=0,r=this.length;r>n;n++)if(1===this[n].nodeType&&(" "+this[n].className+" ").replace(bt," ").indexOf(t)>=0)return!0;return!1},val:function(e){var n,r,i,o=this[0];{if(arguments.length)return i=ot.isFunction(e),this.each(function(r){var o;1===this.nodeType&&(o=i?e.call(this,r,ot(this).val()):e,null==o?o="":"number"==typeof o?o+="":ot.isArray(o)&&(o=ot.map(o,function(e){return null==e?"":e+""})),n=ot.valHooks[this.type]||ot.valHooks[this.nodeName.toLowerCase()],n&&"set"in n&&n.set(this,o,"value")!==t||(this.value=o))});if(o)return n=ot.valHooks[o.type]||ot.valHooks[o.nodeName.toLowerCase()],n&&"get"in n&&(r=n.get(o,"value"))!==t?r:(r=o.value,"string"==typeof r?r.replace(Rt,""):null==r?"":r)}}}),ot.extend({valHooks:{option:{get:function(e){var t=e.attributes.value;return!t||t.specified?e.value:e.text}},select:{get:function(e){for(var t,n,r=e.options,i=e.selectedIndex,o="select-one"===e.type||0>i,a=o?null:[],s=o?i+1:r.length,u=0>i?s:o?i:0;s>u;u++)if(n=r[u],!(!n.selected&&u!==i||(ot.support.optDisabled?n.disabled:null!==n.getAttribute("disabled"))||n.parentNode.disabled&&ot.nodeName(n.parentNode,"optgroup"))){if(t=ot(n).val(),o)return t;a.push(t)}return a},set:function(e,t){for(var n,r,i=e.options,o=ot.makeArray(t),a=i.length;a--;)r=i[a],(r.selected=ot.inArray(ot(r).val(),o)>=0)&&(n=!0);return n||(e.selectedIndex=-1),o}}},attr:function(e,n,r){var i,o,a=e.nodeType;if(e&&3!==a&&8!==a&&2!==a)return typeof e.getAttribute===V?ot.prop(e,n,r):(1===a&&ot.isXMLDoc(e)||(n=n.toLowerCase(),i=ot.attrHooks[n]||(ot.expr.match.bool.test(n)?Et:wt)),r===t?i&&"get"in i&&null!==(o=i.get(e,n))?o:(o=ot.find.attr(e,n),null==o?t:o):null!==r?i&&"set"in i&&(o=i.set(e,r,n))!==t?o:(e.setAttribute(n,r+""),r):void ot.removeAttr(e,n))},removeAttr:function(e,t){var n,r,i=0,o=t&&t.match(st);if(o&&1===e.nodeType)for(;n=o[i++];)r=ot.propFix[n]||n,ot.expr.match.bool.test(n)&&(e[r]=!1),e.removeAttribute(n)},attrHooks:{type:{set:function(e,t){if(!ot.support.radioValue&&"radio"===t&&ot.nodeName(e,"input")){var n=e.value;return e.setAttribute("type",t),n&&(e.value=n),t}}}},propFix:{"for":"htmlFor","class":"className"},prop:function(e,n,r){var i,o,a,s=e.nodeType;if(e&&3!==s&&8!==s&&2!==s)return a=1!==s||!ot.isXMLDoc(e),a&&(n=ot.propFix[n]||n,o=ot.propHooks[n]),r!==t?o&&"set"in o&&(i=o.set(e,r,n))!==t?i:e[n]=r:o&&"get"in o&&null!==(i=o.get(e,n))?i:e[n]},propHooks:{tabIndex:{get:function(e){return e.hasAttribute("tabindex")||Tt.test(e.nodeName)||e.href?e.tabIndex:-1}}}}),Et={set:function(e,t,n){return t===!1?ot.removeAttr(e,n):e.setAttribute(n,n),n}},ot.each(ot.expr.match.bool.source.match(/\w+/g),function(e,n){var r=ot.expr.attrHandle[n]||ot.find.attr;ot.expr.attrHandle[n]=function(e,n,i){var o=ot.expr.attrHandle[n],a=i?t:(ot.expr.attrHandle[n]=t)!=r(e,n,i)?n.toLowerCase():null;return ot.expr.attrHandle[n]=o,a}}),ot.support.optSelected||(ot.propHooks.selected={get:function(e){var t=e.parentNode;return t&&t.parentNode&&t.parentNode.selectedIndex,null}}),ot.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){ot.propFix[this.toLowerCase()]=this}),ot.each(["radio","checkbox"],function(){ot.valHooks[this]={set:function(e,t){return ot.isArray(t)?e.checked=ot.inArray(ot(e).val(),t)>=0:void 0}},ot.support.checkOn||(ot.valHooks[this].get=function(e){return null===e.getAttribute("value")?"on":e.value})});var Ot=/^key/,Pt=/^(?:mouse|contextmenu)|click/,At=/^(?:focusinfocus|focusoutblur)$/,kt=/^([^.]*)(?:\.(.+)|)$/;ot.event={global:{},add:function(e,n,r,i,o){var a,s,u,l,c,d,p,f,h,m,g,y=gt.get(e);if(y){for(r.handler&&(a=r,r=a.handler,o=a.selector),r.guid||(r.guid=ot.guid++),(l=y.events)||(l=y.events={}),(s=y.handle)||(s=y.handle=function(e){return typeof ot===V||e&&ot.event.triggered===e.type?t:ot.event.dispatch.apply(s.elem,arguments)},s.elem=e),n=(n||"").match(st)||[""],c=n.length;c--;)u=kt.exec(n[c])||[],h=g=u[1],m=(u[2]||"").split(".").sort(),h&&(p=ot.event.special[h]||{},h=(o?p.delegateType:p.bindType)||h,p=ot.event.special[h]||{},d=ot.extend({type:h,origType:g,data:i,handler:r,guid:r.guid,selector:o,needsContext:o&&ot.expr.match.needsContext.test(o),namespace:m.join(".")},a),(f=l[h])||(f=l[h]=[],f.delegateCount=0,p.setup&&p.setup.call(e,i,m,s)!==!1||e.addEventListener&&e.addEventListener(h,s,!1)),p.add&&(p.add.call(e,d),d.handler.guid||(d.handler.guid=r.guid)),o?f.splice(f.delegateCount++,0,d):f.push(d),ot.event.global[h]=!0);e=null}},remove:function(e,t,n,r,i){var o,a,s,u,l,c,d,p,f,h,m,g=gt.hasData(e)&&gt.get(e);if(g&&(u=g.events)){for(t=(t||"").match(st)||[""],l=t.length;l--;)if(s=kt.exec(t[l])||[],f=m=s[1],h=(s[2]||"").split(".").sort(),f){for(d=ot.event.special[f]||{},f=(r?d.delegateType:d.bindType)||f,p=u[f]||[],s=s[2]&&new RegExp("(^|\\.)"+h.join("\\.(?:.*\\.|)")+"(\\.|$)"),a=o=p.length;o--;)c=p[o],!i&&m!==c.origType||n&&n.guid!==c.guid||s&&!s.test(c.namespace)||r&&r!==c.selector&&("**"!==r||!c.selector)||(p.splice(o,1),c.selector&&p.delegateCount--,d.remove&&d.remove.call(e,c));a&&!p.length&&(d.teardown&&d.teardown.call(e,h,g.handle)!==!1||ot.removeEvent(e,f,g.handle),delete u[f])}else for(f in u)ot.event.remove(e,f+t[l],n,r,!0);ot.isEmptyObject(u)&&(delete g.handle,gt.remove(e,"events"))}},trigger:function(n,r,i,o){var a,s,u,l,c,d,p,f=[i||B],h=rt.call(n,"type")?n.type:n,m=rt.call(n,"namespace")?n.namespace.split("."):[];if(s=u=i=i||B,3!==i.nodeType&&8!==i.nodeType&&!At.test(h+ot.event.triggered)&&(h.indexOf(".")>=0&&(m=h.split("."),h=m.shift(),m.sort()),c=h.indexOf(":")<0&&"on"+h,n=n[ot.expando]?n:new ot.Event(h,"object"==typeof n&&n),n.isTrigger=o?2:3,n.namespace=m.join("."),n.namespace_re=n.namespace?new RegExp("(^|\\.)"+m.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,n.result=t,n.target||(n.target=i),r=null==r?[n]:ot.makeArray(r,[n]),p=ot.event.special[h]||{},o||!p.trigger||p.trigger.apply(i,r)!==!1)){if(!o&&!p.noBubble&&!ot.isWindow(i)){for(l=p.delegateType||h,At.test(l+h)||(s=s.parentNode);s;s=s.parentNode)f.push(s),u=s;u===(i.ownerDocument||B)&&f.push(u.defaultView||u.parentWindow||e)}for(a=0;(s=f[a++])&&!n.isPropagationStopped();)n.type=a>1?l:p.bindType||h,d=(gt.get(s,"events")||{})[n.type]&&gt.get(s,"handle"),d&&d.apply(s,r),d=c&&s[c],d&&ot.acceptData(s)&&d.apply&&d.apply(s,r)===!1&&n.preventDefault();return n.type=h,o||n.isDefaultPrevented()||p._default&&p._default.apply(f.pop(),r)!==!1||!ot.acceptData(i)||c&&ot.isFunction(i[h])&&!ot.isWindow(i)&&(u=i[c],u&&(i[c]=null),ot.event.triggered=h,i[h](),ot.event.triggered=t,u&&(i[c]=u)),n.result}},dispatch:function(e){e=ot.event.fix(e);var n,r,i,o,a,s=[],u=et.call(arguments),l=(gt.get(this,"events")||{})[e.type]||[],c=ot.event.special[e.type]||{};if(u[0]=e,e.delegateTarget=this,!c.preDispatch||c.preDispatch.call(this,e)!==!1){for(s=ot.event.handlers.call(this,e,l),n=0;(o=s[n++])&&!e.isPropagationStopped();)for(e.currentTarget=o.elem,r=0;(a=o.handlers[r++])&&!e.isImmediatePropagationStopped();)(!e.namespace_re||e.namespace_re.test(a.namespace))&&(e.handleObj=a,e.data=a.data,i=((ot.event.special[a.origType]||{}).handle||a.handler).apply(o.elem,u),i!==t&&(e.result=i)===!1&&(e.preventDefault(),e.stopPropagation()));return c.postDispatch&&c.postDispatch.call(this,e),e.result}},handlers:function(e,n){var r,i,o,a,s=[],u=n.delegateCount,l=e.target;if(u&&l.nodeType&&(!e.button||"click"!==e.type))for(;l!==this;l=l.parentNode||this)if(l.disabled!==!0||"click"!==e.type){for(i=[],r=0;u>r;r++)a=n[r],o=a.selector+" ",i[o]===t&&(i[o]=a.needsContext?ot(o,this).index(l)>=0:ot.find(o,this,null,[l]).length),i[o]&&i.push(a);i.length&&s.push({elem:l,handlers:i})}return u<n.length&&s.push({elem:this,handlers:n.slice(u)}),s},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(e,t){return null==e.which&&(e.which=null!=t.charCode?t.charCode:t.keyCode),e}},mouseHooks:{props:"button buttons clientX clientY offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(e,n){var r,i,o,a=n.button;return null==e.pageX&&null!=n.clientX&&(r=e.target.ownerDocument||B,i=r.documentElement,o=r.body,e.pageX=n.clientX+(i&&i.scrollLeft||o&&o.scrollLeft||0)-(i&&i.clientLeft||o&&o.clientLeft||0),e.pageY=n.clientY+(i&&i.scrollTop||o&&o.scrollTop||0)-(i&&i.clientTop||o&&o.clientTop||0)),e.which||a===t||(e.which=1&a?1:2&a?3:4&a?2:0),e}},fix:function(e){if(e[ot.expando])return e;var t,n,r,i=e.type,o=e,a=this.fixHooks[i];for(a||(this.fixHooks[i]=a=Pt.test(i)?this.mouseHooks:Ot.test(i)?this.keyHooks:{}),r=a.props?this.props.concat(a.props):this.props,e=new ot.Event(o),t=r.length;t--;)n=r[t],e[n]=o[n];return e.target||(e.target=B),3===e.target.nodeType&&(e.target=e.target.parentNode),a.filter?a.filter(e,o):e},special:{load:{noBubble:!0},focus:{trigger:function(){return this!==u()&&this.focus?(this.focus(),!1):void 0},delegateType:"focusin"},blur:{trigger:function(){return this===u()&&this.blur?(this.blur(),!1):void 0},delegateType:"focusout"},click:{trigger:function(){return"checkbox"===this.type&&this.click&&ot.nodeName(this,"input")?(this.click(),!1):void 0},_default:function(e){return ot.nodeName(e.target,"a")}},beforeunload:{postDispatch:function(e){e.result!==t&&(e.originalEvent.returnValue=e.result)}}},simulate:function(e,t,n,r){var i=ot.extend(new ot.Event,n,{type:e,isSimulated:!0,originalEvent:{}});r?ot.event.trigger(i,null,t):ot.event.dispatch.call(t,i),i.isDefaultPrevented()&&n.preventDefault()}},ot.removeEvent=function(e,t,n){e.removeEventListener&&e.removeEventListener(t,n,!1)},ot.Event=function(e,t){return this instanceof ot.Event?(e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||e.getPreventDefault&&e.getPreventDefault()?a:s):this.type=e,t&&ot.extend(this,t),this.timeStamp=e&&e.timeStamp||ot.now(),void(this[ot.expando]=!0)):new ot.Event(e,t)},ot.Event.prototype={isDefaultPrevented:s,isPropagationStopped:s,isImmediatePropagationStopped:s,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=a,e&&e.preventDefault&&e.preventDefault()},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=a,e&&e.stopPropagation&&e.stopPropagation()},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=a,this.stopPropagation()}},ot.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(e,t){ot.event.special[e]={delegateType:t,bindType:t,handle:function(e){var n,r=this,i=e.relatedTarget,o=e.handleObj;return(!i||i!==r&&!ot.contains(r,i))&&(e.type=o.origType,n=o.handler.apply(this,arguments),e.type=t),n}}}),ot.support.focusinBubbles||ot.each({focus:"focusin",blur:"focusout"},function(e,t){var n=0,r=function(e){ot.event.simulate(t,e.target,ot.event.fix(e),!0)};ot.event.special[t]={setup:function(){0===n++&&B.addEventListener(e,r,!0)},teardown:function(){0===--n&&B.removeEventListener(e,r,!0)}}}),ot.fn.extend({on:function(e,n,r,i,o){var a,u;if("object"==typeof e){"string"!=typeof n&&(r=r||n,n=t);for(u in e)this.on(u,n,r,e[u],o);return this}if(null==r&&null==i?(i=n,r=n=t):null==i&&("string"==typeof n?(i=r,r=t):(i=r,r=n,n=t)),i===!1)i=s;else if(!i)return this;return 1===o&&(a=i,i=function(e){return ot().off(e),a.apply(this,arguments)},i.guid=a.guid||(a.guid=ot.guid++)),this.each(function(){ot.event.add(this,e,i,r,n)})},one:function(e,t,n,r){return this.on(e,t,n,r,1)},off:function(e,n,r){var i,o;if(e&&e.preventDefault&&e.handleObj)return i=e.handleObj,ot(e.delegateTarget).off(i.namespace?i.origType+"."+i.namespace:i.origType,i.selector,i.handler),this;if("object"==typeof e){for(o in e)this.off(o,n,e[o]);return this}return(n===!1||"function"==typeof n)&&(r=n,n=t),r===!1&&(r=s),this.each(function(){ot.event.remove(this,e,r,n)})},trigger:function(e,t){return this.each(function(){ot.event.trigger(e,t,this)})},triggerHandler:function(e,t){var n=this[0];return n?ot.event.trigger(e,t,n,!0):void 0}});var It=/^.[^:#\[\.,]*$/,Ct=/^(?:parents|prev(?:Until|All))/,St=ot.expr.match.needsContext,Dt={children:!0,contents:!0,next:!0,prev:!0};ot.fn.extend({find:function(e){var t,n=[],r=this,i=r.length;if("string"!=typeof e)return this.pushStack(ot(e).filter(function(){for(t=0;i>t;t++)if(ot.contains(r[t],this))return!0}));for(t=0;i>t;t++)ot.find(e,r[t],n);return n=this.pushStack(i>1?ot.unique(n):n),n.selector=this.selector?this.selector+" "+e:e,n},has:function(e){var t=ot(e,this),n=t.length;return this.filter(function(){for(var e=0;n>e;e++)if(ot.contains(this,t[e]))return!0})},not:function(e){return this.pushStack(c(this,e||[],!0))},filter:function(e){return this.pushStack(c(this,e||[],!1))},is:function(e){return!!c(this,"string"==typeof e&&St.test(e)?ot(e):e||[],!1).length},closest:function(e,t){for(var n,r=0,i=this.length,o=[],a=St.test(e)||"string"!=typeof e?ot(e,t||this.context):0;i>r;r++)for(n=this[r];n&&n!==t;n=n.parentNode)if(n.nodeType<11&&(a?a.index(n)>-1:1===n.nodeType&&ot.find.matchesSelector(n,e))){n=o.push(n);break}return this.pushStack(o.length>1?ot.unique(o):o)},index:function(e){return e?"string"==typeof e?tt.call(ot(e),this[0]):tt.call(this,e.jquery?e[0]:e):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(e,t){var n="string"==typeof e?ot(e,t):ot.makeArray(e&&e.nodeType?[e]:e),r=ot.merge(this.get(),n);return this.pushStack(ot.unique(r))},addBack:function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}}),ot.each({parent:function(e){var t=e.parentNode;return t&&11!==t.nodeType?t:null},parents:function(e){return ot.dir(e,"parentNode")},parentsUntil:function(e,t,n){return ot.dir(e,"parentNode",n)},next:function(e){return l(e,"nextSibling")},prev:function(e){return l(e,"previousSibling")},nextAll:function(e){return ot.dir(e,"nextSibling")},prevAll:function(e){return ot.dir(e,"previousSibling")},nextUntil:function(e,t,n){return ot.dir(e,"nextSibling",n)},prevUntil:function(e,t,n){return ot.dir(e,"previousSibling",n)},siblings:function(e){return ot.sibling((e.parentNode||{}).firstChild,e)},children:function(e){return ot.sibling(e.firstChild)},contents:function(e){return e.contentDocument||ot.merge([],e.childNodes)}},function(e,t){ot.fn[e]=function(n,r){var i=ot.map(this,t,n);return"Until"!==e.slice(-5)&&(r=n),r&&"string"==typeof r&&(i=ot.filter(r,i)),this.length>1&&(Dt[e]||ot.unique(i),Ct.test(e)&&i.reverse()),this.pushStack(i)}}),ot.extend({filter:function(e,t,n){var r=t[0];return n&&(e=":not("+e+")"),1===t.length&&1===r.nodeType?ot.find.matchesSelector(r,e)?[r]:[]:ot.find.matches(e,ot.grep(t,function(e){return 1===e.nodeType}))},dir:function(e,n,r){for(var i=[],o=r!==t;(e=e[n])&&9!==e.nodeType;)if(1===e.nodeType){if(o&&ot(e).is(r))break;i.push(e)}return i},sibling:function(e,t){for(var n=[];e;e=e.nextSibling)1===e.nodeType&&e!==t&&n.push(e);return n}});var Ft=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,Lt=/<([\w:]+)/,Nt=/<|&#?\w+;/,Mt=/<(?:script|style|link)/i,_t=/^(?:checkbox|radio)$/i,zt=/checked\s*(?:[^=]|=\s*.checked.)/i,xt=/^$|\/(?:java|ecma)script/i,Ut=/^true\/(.*)/,jt=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,Yt={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};Yt.optgroup=Yt.option,Yt.tbody=Yt.tfoot=Yt.colgroup=Yt.caption=Yt.thead,Yt.th=Yt.td,ot.fn.extend({text:function(e){return ot.access(this,function(e){return e===t?ot.text(this):this.empty().append((this[0]&&this[0].ownerDocument||B).createTextNode(e))},null,e,arguments.length)},append:function(){return this.domManip(arguments,function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=d(this,e);t.appendChild(e)}})},prepend:function(){return this.domManip(arguments,function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=d(this,e);t.insertBefore(e,t.firstChild)}})},before:function(){return this.domManip(arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this)})},after:function(){return this.domManip(arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this.nextSibling)})},remove:function(e,t){for(var n,r=e?ot.filter(e,this):this,i=0;null!=(n=r[i]);i++)t||1!==n.nodeType||ot.cleanData(g(n)),n.parentNode&&(t&&ot.contains(n.ownerDocument,n)&&h(g(n,"script")),n.parentNode.removeChild(n));return this},empty:function(){for(var e,t=0;null!=(e=this[t]);t++)1===e.nodeType&&(ot.cleanData(g(e,!1)),e.textContent="");return this},clone:function(e,t){return e=null==e?!1:e,t=null==t?e:t,this.map(function(){return ot.clone(this,e,t)})},html:function(e){return ot.access(this,function(e){var n=this[0]||{},r=0,i=this.length;if(e===t&&1===n.nodeType)return n.innerHTML;if("string"==typeof e&&!Mt.test(e)&&!Yt[(Lt.exec(e)||["",""])[1].toLowerCase()]){e=e.replace(Ft,"<$1></$2>");try{for(;i>r;r++)n=this[r]||{},1===n.nodeType&&(ot.cleanData(g(n,!1)),n.innerHTML=e);n=0}catch(o){}}n&&this.empty().append(e)},null,e,arguments.length)},replaceWith:function(){var e=ot.map(this,function(e){return[e.nextSibling,e.parentNode]}),t=0;return this.domManip(arguments,function(n){var r=e[t++],i=e[t++];i&&(r&&r.parentNode!==i&&(r=this.nextSibling),ot(this).remove(),i.insertBefore(n,r))},!0),t?this:this.remove()},detach:function(e){return this.remove(e,!0)},domManip:function(e,t,n){e=K.apply([],e);var r,i,o,a,s,u,l=0,c=this.length,d=this,h=c-1,m=e[0],y=ot.isFunction(m);if(y||!(1>=c||"string"!=typeof m||ot.support.checkClone)&&zt.test(m))return this.each(function(r){var i=d.eq(r);y&&(e[0]=m.call(this,r,i.html())),i.domManip(e,t,n)});if(c&&(r=ot.buildFragment(e,this[0].ownerDocument,!1,!n&&this),i=r.firstChild,1===r.childNodes.length&&(r=i),i)){for(o=ot.map(g(r,"script"),p),a=o.length;c>l;l++)s=r,l!==h&&(s=ot.clone(s,!0,!0),a&&ot.merge(o,g(s,"script"))),t.call(this[l],s,l);if(a)for(u=o[o.length-1].ownerDocument,ot.map(o,f),l=0;a>l;l++)s=o[l],xt.test(s.type||"")&&!gt.access(s,"globalEval")&&ot.contains(u,s)&&(s.src?ot._evalUrl(s.src):ot.globalEval(s.textContent.replace(jt,"")))}return this}}),ot.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,t){ot.fn[e]=function(e){for(var n,r=[],i=ot(e),o=i.length-1,a=0;o>=a;a++)n=a===o?this:this.clone(!0),ot(i[a])[t](n),J.apply(r,n.get());return this.pushStack(r)}}),ot.extend({clone:function(e,t,n){var r,i,o,a,s=e.cloneNode(!0),u=ot.contains(e.ownerDocument,e);if(!(ot.support.noCloneChecked||1!==e.nodeType&&11!==e.nodeType||ot.isXMLDoc(e)))for(a=g(s),o=g(e),r=0,i=o.length;i>r;r++)y(o[r],a[r]);if(t)if(n)for(o=o||g(e),a=a||g(s),r=0,i=o.length;i>r;r++)m(o[r],a[r]);else m(e,s);return a=g(s,"script"),a.length>0&&h(a,!u&&g(e,"script")),s},buildFragment:function(e,t,n,r){for(var i,o,a,s,u,l,c=0,d=e.length,p=t.createDocumentFragment(),f=[];d>c;c++)if(i=e[c],i||0===i)if("object"===ot.type(i))ot.merge(f,i.nodeType?[i]:i);else if(Nt.test(i)){for(o=o||p.appendChild(t.createElement("div")),a=(Lt.exec(i)||["",""])[1].toLowerCase(),s=Yt[a]||Yt._default,o.innerHTML=s[1]+i.replace(Ft,"<$1></$2>")+s[2],l=s[0];l--;)o=o.lastChild;ot.merge(f,o.childNodes),o=p.firstChild,o.textContent=""}else f.push(t.createTextNode(i));for(p.textContent="",c=0;i=f[c++];)if((!r||-1===ot.inArray(i,r))&&(u=ot.contains(i.ownerDocument,i),o=g(p.appendChild(i),"script"),u&&h(o),n))for(l=0;i=o[l++];)xt.test(i.type||"")&&n.push(i);return p},cleanData:function(e){for(var n,r,o,a,s,u,l=ot.event.special,c=0;(r=e[c])!==t;c++){if(i.accepts(r)&&(s=r[gt.expando],s&&(n=gt.cache[s]))){if(o=Object.keys(n.events||{}),o.length)for(u=0;(a=o[u])!==t;u++)l[a]?ot.event.remove(r,a):ot.removeEvent(r,a,n.handle);gt.cache[s]&&delete gt.cache[s]}delete mt.cache[r[mt.expando]]}},_evalUrl:function(e){return ot.ajax({url:e,type:"GET",dataType:"script",async:!1,global:!1,"throws":!0})}}),ot.fn.extend({wrapAll:function(e){var t;return ot.isFunction(e)?this.each(function(t){ot(this).wrapAll(e.call(this,t))}):(this[0]&&(t=ot(e,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&t.insertBefore(this[0]),t.map(function(){for(var e=this;e.firstElementChild;)e=e.firstElementChild;return e}).append(this)),this)},wrapInner:function(e){return this.each(ot.isFunction(e)?function(t){ot(this).wrapInner(e.call(this,t))}:function(){var t=ot(this),n=t.contents();n.length?n.wrapAll(e):t.append(e)})},wrap:function(e){var t=ot.isFunction(e);return this.each(function(n){ot(this).wrapAll(t?e.call(this,n):e)})},unwrap:function(){return this.parent().each(function(){ot.nodeName(this,"body")||ot(this).replaceWith(this.childNodes)}).end()}});var Gt,Vt,Wt=/^(none|table(?!-c[ea]).+)/,Bt=/^margin/,qt=new RegExp("^("+at+")(.*)$","i"),$t=new RegExp("^("+at+")(?!px)[a-z%]+$","i"),Ht=new RegExp("^([+-])=("+at+")","i"),Qt={BODY:"block"},Xt={position:"absolute",visibility:"hidden",display:"block"},Zt={letterSpacing:0,fontWeight:400},Kt=["Top","Right","Bottom","Left"],Jt=["Webkit","O","Moz","ms"];ot.fn.extend({css:function(e,n){return ot.access(this,function(e,n,r){var i,o,a={},s=0;
if(ot.isArray(n)){for(i=E(e),o=n.length;o>s;s++)a[n[s]]=ot.css(e,n[s],!1,i);return a}return r!==t?ot.style(e,n,r):ot.css(e,n)},e,n,arguments.length>1)},show:function(){return b(this,!0)},hide:function(){return b(this)},toggle:function(e){return"boolean"==typeof e?e?this.show():this.hide():this.each(function(){w(this)?ot(this).show():ot(this).hide()})}}),ot.extend({cssHooks:{opacity:{get:function(e,t){if(t){var n=Gt(e,"opacity");return""===n?"1":n}}}},cssNumber:{columnCount:!0,fillOpacity:!0,fontWeight:!0,lineHeight:!0,opacity:!0,model:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":"cssFloat"},style:function(e,n,r,i){if(e&&3!==e.nodeType&&8!==e.nodeType&&e.style){var o,a,s,u=ot.camelCase(n),l=e.style;return n=ot.cssProps[u]||(ot.cssProps[u]=v(l,u)),s=ot.cssHooks[n]||ot.cssHooks[u],r===t?s&&"get"in s&&(o=s.get(e,!1,i))!==t?o:l[n]:(a=typeof r,"string"===a&&(o=Ht.exec(r))&&(r=(o[1]+1)*o[2]+parseFloat(ot.css(e,n)),a="number"),null==r||"number"===a&&isNaN(r)||("number"!==a||ot.cssNumber[u]||(r+="px"),ot.support.clearCloneStyle||""!==r||0!==n.indexOf("background")||(l[n]="inherit"),s&&"set"in s&&(r=s.set(e,r,i))===t||(l[n]=r)),void 0)}},css:function(e,n,r,i){var o,a,s,u=ot.camelCase(n);return n=ot.cssProps[u]||(ot.cssProps[u]=v(e.style,u)),s=ot.cssHooks[n]||ot.cssHooks[u],s&&"get"in s&&(o=s.get(e,!0,r)),o===t&&(o=Gt(e,n,i)),"normal"===o&&n in Zt&&(o=Zt[n]),""===r||r?(a=parseFloat(o),r===!0||ot.isNumeric(a)?a||0:o):o}}),Gt=function(e,n,r){var i,o,a,s=r||E(e),u=s?s.getPropertyValue(n)||s[n]:t,l=e.style;return s&&(""!==u||ot.contains(e.ownerDocument,e)||(u=ot.style(e,n)),$t.test(u)&&Bt.test(n)&&(i=l.width,o=l.minWidth,a=l.maxWidth,l.minWidth=l.maxWidth=l.width=u,u=s.width,l.width=i,l.minWidth=o,l.maxWidth=a)),u},ot.each(["height","width"],function(e,t){ot.cssHooks[t]={get:function(e,n,r){return n?0===e.offsetWidth&&Wt.test(ot.css(e,"display"))?ot.swap(e,Xt,function(){return O(e,t,r)}):O(e,t,r):void 0},set:function(e,n,r){var i=r&&E(e);return R(e,n,r?T(e,t,r,ot.support.boxSizing&&"border-box"===ot.css(e,"boxSizing",!1,i),i):0)}}}),ot(function(){ot.support.reliableMarginRight||(ot.cssHooks.marginRight={get:function(e,t){return t?ot.swap(e,{display:"inline-block"},Gt,[e,"marginRight"]):void 0}}),!ot.support.pixelPosition&&ot.fn.position&&ot.each(["top","left"],function(e,t){ot.cssHooks[t]={get:function(e,n){return n?(n=Gt(e,t),$t.test(n)?ot(e).position()[t]+"px":n):void 0}}})}),ot.expr&&ot.expr.filters&&(ot.expr.filters.hidden=function(e){return e.offsetWidth<=0&&e.offsetHeight<=0},ot.expr.filters.visible=function(e){return!ot.expr.filters.hidden(e)}),ot.each({margin:"",padding:"",border:"Width"},function(e,t){ot.cssHooks[e+t]={expand:function(n){for(var r=0,i={},o="string"==typeof n?n.split(" "):[n];4>r;r++)i[e+Kt[r]+t]=o[r]||o[r-2]||o[0];return i}},Bt.test(e)||(ot.cssHooks[e+t].set=R)});var en=/%20/g,tn=/\[\]$/,nn=/\r?\n/g,rn=/^(?:submit|button|image|reset|file)$/i,on=/^(?:input|select|textarea|keygen)/i;ot.fn.extend({serialize:function(){return ot.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var e=ot.prop(this,"elements");return e?ot.makeArray(e):this}).filter(function(){var e=this.type;return this.name&&!ot(this).is(":disabled")&&on.test(this.nodeName)&&!rn.test(e)&&(this.checked||!_t.test(e))}).map(function(e,t){var n=ot(this).val();return null==n?null:ot.isArray(n)?ot.map(n,function(e){return{name:t.name,value:e.replace(nn,"\r\n")}}):{name:t.name,value:n.replace(nn,"\r\n")}}).get()}}),ot.param=function(e,n){var r,i=[],o=function(e,t){t=ot.isFunction(t)?t():null==t?"":t,i[i.length]=encodeURIComponent(e)+"="+encodeURIComponent(t)};if(n===t&&(n=ot.ajaxSettings&&ot.ajaxSettings.traditional),ot.isArray(e)||e.jquery&&!ot.isPlainObject(e))ot.each(e,function(){o(this.name,this.value)});else for(r in e)k(r,e[r],n,o);return i.join("&").replace(en,"+")},ot.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(e,t){ot.fn[t]=function(e,n){return arguments.length>0?this.on(t,null,e,n):this.trigger(t)}}),ot.fn.extend({hover:function(e,t){return this.mouseenter(e).mouseleave(t||e)},bind:function(e,t,n){return this.on(e,null,t,n)},unbind:function(e,t){return this.off(e,null,t)},delegate:function(e,t,n,r){return this.on(t,e,n,r)},undelegate:function(e,t,n){return 1===arguments.length?this.off(e,"**"):this.off(t,e||"**",n)}});var an,sn,un=ot.now(),ln=/\?/,cn=/#.*$/,dn=/([?&])_=[^&]*/,pn=/^(.*?):[ \t]*([^\r\n]*)$/gm,fn=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,hn=/^(?:GET|HEAD)$/,mn=/^\/\//,gn=/^([\w.+-]+:)(?:\/\/([^\/?#:]*)(?::(\d+)|)|)/,yn=ot.fn.load,vn={},wn={},En="*/".concat("*");try{sn=W.href}catch(bn){sn=B.createElement("a"),sn.href="",sn=sn.href}an=gn.exec(sn.toLowerCase())||[],ot.fn.load=function(e,n,r){if("string"!=typeof e&&yn)return yn.apply(this,arguments);var i,o,a,s=this,u=e.indexOf(" ");return u>=0&&(i=e.slice(u),e=e.slice(0,u)),ot.isFunction(n)?(r=n,n=t):n&&"object"==typeof n&&(o="POST"),s.length>0&&ot.ajax({url:e,type:o,dataType:"html",data:n}).done(function(e){a=arguments,s.html(i?ot("<div>").append(ot.parseHTML(e)).find(i):e)}).complete(r&&function(e,t){s.each(r,a||[e.responseText,t,e])}),this},ot.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(e,t){ot.fn[t]=function(e){return this.on(t,e)}}),ot.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:sn,type:"GET",isLocal:fn.test(an[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":En,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":ot.parseJSON,"text xml":ot.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(e,t){return t?S(S(e,ot.ajaxSettings),t):S(ot.ajaxSettings,e)},ajaxPrefilter:I(vn),ajaxTransport:I(wn),ajax:function(e,n){function r(e,n,r,s){var l,d,v,w,b,T=n;2!==E&&(E=2,u&&clearTimeout(u),i=t,a=s||"",R.readyState=e>0?4:0,l=e>=200&&300>e||304===e,r&&(w=D(p,R,r)),w=F(p,w,R,l),l?(p.ifModified&&(b=R.getResponseHeader("Last-Modified"),b&&(ot.lastModified[o]=b),b=R.getResponseHeader("etag"),b&&(ot.etag[o]=b)),204===e||"HEAD"===p.type?T="nocontent":304===e?T="notmodified":(T=w.state,d=w.data,v=w.error,l=!v)):(v=T,(e||!T)&&(T="error",0>e&&(e=0))),R.status=e,R.statusText=(n||T)+"",l?m.resolveWith(f,[d,T,R]):m.rejectWith(f,[R,T,v]),R.statusCode(y),y=t,c&&h.trigger(l?"ajaxSuccess":"ajaxError",[R,p,l?d:v]),g.fireWith(f,[R,T]),c&&(h.trigger("ajaxComplete",[R,p]),--ot.active||ot.event.trigger("ajaxStop")))}"object"==typeof e&&(n=e,e=t),n=n||{};var i,o,a,s,u,l,c,d,p=ot.ajaxSetup({},n),f=p.context||p,h=p.context&&(f.nodeType||f.jquery)?ot(f):ot.event,m=ot.Deferred(),g=ot.Callbacks("once memory"),y=p.statusCode||{},v={},w={},E=0,b="canceled",R={readyState:0,getResponseHeader:function(e){var t;if(2===E){if(!s)for(s={};t=pn.exec(a);)s[t[1].toLowerCase()]=t[2];t=s[e.toLowerCase()]}return null==t?null:t},getAllResponseHeaders:function(){return 2===E?a:null},setRequestHeader:function(e,t){var n=e.toLowerCase();return E||(e=w[n]=w[n]||e,v[e]=t),this},overrideMimeType:function(e){return E||(p.mimeType=e),this},statusCode:function(e){var t;if(e)if(2>E)for(t in e)y[t]=[y[t],e[t]];else R.always(e[R.status]);return this},abort:function(e){var t=e||b;return i&&i.abort(t),r(0,t),this}};if(m.promise(R).complete=g.add,R.success=R.done,R.error=R.fail,p.url=((e||p.url||sn)+"").replace(cn,"").replace(mn,an[1]+"//"),p.type=n.method||n.type||p.method||p.type,p.dataTypes=ot.trim(p.dataType||"*").toLowerCase().match(st)||[""],null==p.crossDomain&&(l=gn.exec(p.url.toLowerCase()),p.crossDomain=!(!l||l[1]===an[1]&&l[2]===an[2]&&(l[3]||("http:"===l[1]?"80":"443"))===(an[3]||("http:"===an[1]?"80":"443")))),p.data&&p.processData&&"string"!=typeof p.data&&(p.data=ot.param(p.data,p.traditional)),C(vn,p,n,R),2===E)return R;c=p.global,c&&0===ot.active++&&ot.event.trigger("ajaxStart"),p.type=p.type.toUpperCase(),p.hasContent=!hn.test(p.type),o=p.url,p.hasContent||(p.data&&(o=p.url+=(ln.test(o)?"&":"?")+p.data,delete p.data),p.cache===!1&&(p.url=dn.test(o)?o.replace(dn,"$1_="+un++):o+(ln.test(o)?"&":"?")+"_="+un++)),p.ifModified&&(ot.lastModified[o]&&R.setRequestHeader("If-Modified-Since",ot.lastModified[o]),ot.etag[o]&&R.setRequestHeader("If-None-Match",ot.etag[o])),(p.data&&p.hasContent&&p.contentType!==!1||n.contentType)&&R.setRequestHeader("Content-Type",p.contentType),R.setRequestHeader("Accept",p.dataTypes[0]&&p.accepts[p.dataTypes[0]]?p.accepts[p.dataTypes[0]]+("*"!==p.dataTypes[0]?", "+En+"; q=0.01":""):p.accepts["*"]);for(d in p.headers)R.setRequestHeader(d,p.headers[d]);if(p.beforeSend&&(p.beforeSend.call(f,R,p)===!1||2===E))return R.abort();b="abort";for(d in{success:1,error:1,complete:1})R[d](p[d]);if(i=C(wn,p,n,R)){R.readyState=1,c&&h.trigger("ajaxSend",[R,p]),p.async&&p.timeout>0&&(u=setTimeout(function(){R.abort("timeout")},p.timeout));try{E=1,i.send(v,r)}catch(T){if(!(2>E))throw T;r(-1,T)}}else r(-1,"No Transport");return R},getJSON:function(e,t,n){return ot.get(e,t,n,"json")},getScript:function(e,n){return ot.get(e,t,n,"script")}}),ot.each(["get","post"],function(e,n){ot[n]=function(e,r,i,o){return ot.isFunction(r)&&(o=o||i,i=r,r=t),ot.ajax({url:e,type:n,dataType:o,data:r,success:i})}}),ot.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(e){return ot.globalEval(e),e}}}),ot.ajaxPrefilter("script",function(e){e.cache===t&&(e.cache=!1),e.crossDomain&&(e.type="GET")}),ot.ajaxTransport("script",function(e){if(e.crossDomain){var t,n;return{send:function(r,i){t=ot("<script>").prop({async:!0,charset:e.scriptCharset,src:e.url}).on("load error",n=function(e){t.remove(),n=null,e&&i("error"===e.type?404:200,e.type)}),B.head.appendChild(t[0])},abort:function(){n&&n()}}}});var Rn=[],Tn=/(=)\?(?=&|$)|\?\?/;ot.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=Rn.pop()||ot.expando+"_"+un++;return this[e]=!0,e}}),ot.ajaxPrefilter("json jsonp",function(n,r,i){var o,a,s,u=n.jsonp!==!1&&(Tn.test(n.url)?"url":"string"==typeof n.data&&!(n.contentType||"").indexOf("application/x-www-form-urlencoded")&&Tn.test(n.data)&&"data");return u||"jsonp"===n.dataTypes[0]?(o=n.jsonpCallback=ot.isFunction(n.jsonpCallback)?n.jsonpCallback():n.jsonpCallback,u?n[u]=n[u].replace(Tn,"$1"+o):n.jsonp!==!1&&(n.url+=(ln.test(n.url)?"&":"?")+n.jsonp+"="+o),n.converters["script json"]=function(){return s||ot.error(o+" was not called"),s[0]},n.dataTypes[0]="json",a=e[o],e[o]=function(){s=arguments},i.always(function(){e[o]=a,n[o]&&(n.jsonpCallback=r.jsonpCallback,Rn.push(o)),s&&ot.isFunction(a)&&a(s[0]),s=a=t}),"script"):void 0}),ot.ajaxSettings.xhr=function(){try{return new XMLHttpRequest}catch(e){}};var On=ot.ajaxSettings.xhr(),Pn={0:200,1223:204},An=0,kn={};e.ActiveXObject&&ot(e).on("unload",function(){for(var e in kn)kn[e]();kn=t}),ot.support.cors=!!On&&"withCredentials"in On,ot.support.ajax=On=!!On,ot.ajaxTransport(function(e){var n;return ot.support.cors||On&&!e.crossDomain?{send:function(r,i){var o,a,s=e.xhr();if(s.open(e.type,e.url,e.async,e.username,e.password),e.xhrFields)for(o in e.xhrFields)s[o]=e.xhrFields[o];e.mimeType&&s.overrideMimeType&&s.overrideMimeType(e.mimeType),e.crossDomain||r["X-Requested-With"]||(r["X-Requested-With"]="XMLHttpRequest");for(o in r)s.setRequestHeader(o,r[o]);n=function(e){return function(){n&&(delete kn[a],n=s.onload=s.onerror=null,"abort"===e?s.abort():"error"===e?i(s.status||404,s.statusText):i(Pn[s.status]||s.status,s.statusText,"string"==typeof s.responseText?{text:s.responseText}:t,s.getAllResponseHeaders()))}},s.onload=n(),s.onerror=n("error"),n=kn[a=An++]=n("abort"),s.send(e.hasContent&&e.data||null)},abort:function(){n&&n()}}:void 0});var In,Cn,Sn=/^(?:toggle|show|hide)$/,Dn=new RegExp("^(?:([+-])=|)("+at+")([a-z%]*)$","i"),Fn=/queueHooks$/,Ln=[z],Nn={"*":[function(e,t){var n=this.createTween(e,t),r=n.cur(),i=Dn.exec(t),o=i&&i[3]||(ot.cssNumber[e]?"":"px"),a=(ot.cssNumber[e]||"px"!==o&&+r)&&Dn.exec(ot.css(n.elem,e)),s=1,u=20;if(a&&a[3]!==o){o=o||a[3],i=i||[],a=+r||1;do s=s||".5",a/=s,ot.style(n.elem,e,a+o);while(s!==(s=n.cur()/r)&&1!==s&&--u)}return i&&(a=n.start=+a||+r||0,n.unit=o,n.end=i[1]?a+(i[1]+1)*i[2]:+i[2]),n}]};ot.Animation=ot.extend(M,{tweener:function(e,t){ot.isFunction(e)?(t=e,e=["*"]):e=e.split(" ");for(var n,r=0,i=e.length;i>r;r++)n=e[r],Nn[n]=Nn[n]||[],Nn[n].unshift(t)},prefilter:function(e,t){t?Ln.unshift(e):Ln.push(e)}}),ot.Tween=x,x.prototype={constructor:x,init:function(e,t,n,r,i,o){this.elem=e,this.prop=n,this.easing=i||"swing",this.options=t,this.start=this.now=this.cur(),this.end=r,this.unit=o||(ot.cssNumber[n]?"":"px")},cur:function(){var e=x.propHooks[this.prop];return e&&e.get?e.get(this):x.propHooks._default.get(this)},run:function(e){var t,n=x.propHooks[this.prop];return this.pos=t=this.options.duration?ot.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),n&&n.set?n.set(this):x.propHooks._default.set(this),this}},x.prototype.init.prototype=x.prototype,x.propHooks={_default:{get:function(e){var t;return null==e.elem[e.prop]||e.elem.style&&null!=e.elem.style[e.prop]?(t=ot.css(e.elem,e.prop,""),t&&"auto"!==t?t:0):e.elem[e.prop]},set:function(e){ot.fx.step[e.prop]?ot.fx.step[e.prop](e):e.elem.style&&(null!=e.elem.style[ot.cssProps[e.prop]]||ot.cssHooks[e.prop])?ot.style(e.elem,e.prop,e.now+e.unit):e.elem[e.prop]=e.now}}},x.propHooks.scrollTop=x.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},ot.each(["toggle","show","hide"],function(e,t){var n=ot.fn[t];ot.fn[t]=function(e,r,i){return null==e||"boolean"==typeof e?n.apply(this,arguments):this.animate(U(t,!0),e,r,i)}}),ot.fn.extend({fadeTo:function(e,t,n,r){return this.filter(w).css("opacity",0).show().end().animate({opacity:t},e,n,r)},animate:function(e,t,n,r){var i=ot.isEmptyObject(e),o=ot.speed(t,n,r),a=function(){var t=M(this,ot.extend({},e),o);(i||gt.get(this,"finish"))&&t.stop(!0)};return a.finish=a,i||o.queue===!1?this.each(a):this.queue(o.queue,a)},stop:function(e,n,r){var i=function(e){var t=e.stop;delete e.stop,t(r)};return"string"!=typeof e&&(r=n,n=e,e=t),n&&e!==!1&&this.queue(e||"fx",[]),this.each(function(){var t=!0,n=null!=e&&e+"queueHooks",o=ot.timers,a=gt.get(this);if(n)a[n]&&a[n].stop&&i(a[n]);else for(n in a)a[n]&&a[n].stop&&Fn.test(n)&&i(a[n]);for(n=o.length;n--;)o[n].elem!==this||null!=e&&o[n].queue!==e||(o[n].anim.stop(r),t=!1,o.splice(n,1));(t||!r)&&ot.dequeue(this,e)})},finish:function(e){return e!==!1&&(e=e||"fx"),this.each(function(){var t,n=gt.get(this),r=n[e+"queue"],i=n[e+"queueHooks"],o=ot.timers,a=r?r.length:0;for(n.finish=!0,ot.queue(this,e,[]),i&&i.stop&&i.stop.call(this,!0),t=o.length;t--;)o[t].elem===this&&o[t].queue===e&&(o[t].anim.stop(!0),o.splice(t,1));for(t=0;a>t;t++)r[t]&&r[t].finish&&r[t].finish.call(this);delete n.finish})}}),ot.each({slideDown:U("show"),slideUp:U("hide"),slideToggle:U("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(e,t){ot.fn[e]=function(e,n,r){return this.animate(t,e,n,r)}}),ot.speed=function(e,t,n){var r=e&&"object"==typeof e?ot.extend({},e):{complete:n||!n&&t||ot.isFunction(e)&&e,duration:e,easing:n&&t||t&&!ot.isFunction(t)&&t};return r.duration=ot.fx.off?0:"number"==typeof r.duration?r.duration:r.duration in ot.fx.speeds?ot.fx.speeds[r.duration]:ot.fx.speeds._default,(null==r.queue||r.queue===!0)&&(r.queue="fx"),r.old=r.complete,r.complete=function(){ot.isFunction(r.old)&&r.old.call(this),r.queue&&ot.dequeue(this,r.queue)},r},ot.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2}},ot.timers=[],ot.fx=x.prototype.init,ot.fx.tick=function(){var e,n=ot.timers,r=0;for(In=ot.now();r<n.length;r++)e=n[r],e()||n[r]!==e||n.splice(r--,1);n.length||ot.fx.stop(),In=t},ot.fx.timer=function(e){e()&&ot.timers.push(e)&&ot.fx.start()},ot.fx.interval=13,ot.fx.start=function(){Cn||(Cn=setInterval(ot.fx.tick,ot.fx.interval))},ot.fx.stop=function(){clearInterval(Cn),Cn=null},ot.fx.speeds={slow:600,fast:200,_default:400},ot.fx.step={},ot.expr&&ot.expr.filters&&(ot.expr.filters.animated=function(e){return ot.grep(ot.timers,function(t){return e===t.elem}).length}),ot.fn.offset=function(e){if(arguments.length)return e===t?this:this.each(function(t){ot.offset.setOffset(this,e,t)});var n,r,i=this[0],o={top:0,left:0},a=i&&i.ownerDocument;if(a)return n=a.documentElement,ot.contains(n,i)?(typeof i.getBoundingClientRect!==V&&(o=i.getBoundingClientRect()),r=j(a),{top:o.top+r.pageYOffset-n.clientTop,left:o.left+r.pageXOffset-n.clientLeft}):o},ot.offset={setOffset:function(e,t,n){var r,i,o,a,s,u,l,c=ot.css(e,"position"),d=ot(e),p={};"static"===c&&(e.style.position="relative"),s=d.offset(),o=ot.css(e,"top"),u=ot.css(e,"left"),l=("absolute"===c||"fixed"===c)&&(o+u).indexOf("auto")>-1,l?(r=d.position(),a=r.top,i=r.left):(a=parseFloat(o)||0,i=parseFloat(u)||0),ot.isFunction(t)&&(t=t.call(e,n,s)),null!=t.top&&(p.top=t.top-s.top+a),null!=t.left&&(p.left=t.left-s.left+i),"using"in t?t.using.call(e,p):d.css(p)}},ot.fn.extend({position:function(){if(this[0]){var e,t,n=this[0],r={top:0,left:0};return"fixed"===ot.css(n,"position")?t=n.getBoundingClientRect():(e=this.offsetParent(),t=this.offset(),ot.nodeName(e[0],"html")||(r=e.offset()),r.top+=ot.css(e[0],"borderTopWidth",!0),r.left+=ot.css(e[0],"borderLeftWidth",!0)),{top:t.top-r.top-ot.css(n,"marginTop",!0),left:t.left-r.left-ot.css(n,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var e=this.offsetParent||q;e&&!ot.nodeName(e,"html")&&"static"===ot.css(e,"position");)e=e.offsetParent;return e||q})}}),ot.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(n,r){var i="pageYOffset"===r;ot.fn[n]=function(o){return ot.access(this,function(n,o,a){var s=j(n);return a===t?s?s[r]:n[o]:void(s?s.scrollTo(i?e.pageXOffset:a,i?a:e.pageYOffset):n[o]=a)},n,o,arguments.length,null)}}),ot.each({Height:"height",Width:"width"},function(e,n){ot.each({padding:"inner"+e,content:n,"":"outer"+e},function(r,i){ot.fn[i]=function(i,o){var a=arguments.length&&(r||"boolean"!=typeof i),s=r||(i===!0||o===!0?"margin":"border");return ot.access(this,function(n,r,i){var o;return ot.isWindow(n)?n.document.documentElement["client"+e]:9===n.nodeType?(o=n.documentElement,Math.max(n.body["scroll"+e],o["scroll"+e],n.body["offset"+e],o["offset"+e],o["client"+e])):i===t?ot.css(n,r,s):ot.style(n,r,i,s)},n,a?i:t,a,null)}})}),ot.fn.size=function(){return this.length},ot.fn.andSelf=ot.fn.addBack,"object"==typeof module&&module&&"object"==typeof module.exports?module.exports=ot:"function"==typeof define&&define.amd&&define("jquery",[],function(){return ot}),"object"==typeof e&&"object"==typeof e.document&&(e.jQuery=e.$=ot)}(window),function(){var e=this,t=e._,n={},r=Array.prototype,i=Object.prototype,o=Function.prototype,a=r.push,s=r.slice,u=r.concat,l=i.toString,c=i.hasOwnProperty,d=r.forEach,p=r.map,f=r.reduce,h=r.reduceRight,m=r.filter,g=r.every,y=r.some,v=r.indexOf,w=r.lastIndexOf,E=Array.isArray,b=Object.keys,R=o.bind,T=function(e){return e instanceof T?e:this instanceof T?void(this._wrapped=e):new T(e)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=T),exports._=T):e._=T,T.VERSION="1.5.2";var O=T.each=T.forEach=function(e,t,r){if(null!=e)if(d&&e.forEach===d)e.forEach(t,r);else if(e.length===+e.length){for(var i=0,o=e.length;o>i;i++)if(t.call(r,e[i],i,e)===n)return}else for(var a=T.keys(e),i=0,o=a.length;o>i;i++)if(t.call(r,e[a[i]],a[i],e)===n)return};T.map=T.collect=function(e,t,n){var r=[];return null==e?r:p&&e.map===p?e.map(t,n):(O(e,function(e,i,o){r.push(t.call(n,e,i,o))}),r)};var P="Reduce of empty array with no initial value";T.reduce=T.foldl=T.inject=function(e,t,n,r){var i=arguments.length>2;if(null==e&&(e=[]),f&&e.reduce===f)return r&&(t=T.bind(t,r)),i?e.reduce(t,n):e.reduce(t);if(O(e,function(e,o,a){i?n=t.call(r,n,e,o,a):(n=e,i=!0)}),!i)throw new TypeError(P);return n},T.reduceRight=T.foldr=function(e,t,n,r){var i=arguments.length>2;if(null==e&&(e=[]),h&&e.reduceRight===h)return r&&(t=T.bind(t,r)),i?e.reduceRight(t,n):e.reduceRight(t);var o=e.length;if(o!==+o){var a=T.keys(e);o=a.length}if(O(e,function(s,u,l){u=a?a[--o]:--o,i?n=t.call(r,n,e[u],u,l):(n=e[u],i=!0)}),!i)throw new TypeError(P);return n},T.find=T.detect=function(e,t,n){var r;return A(e,function(e,i,o){return t.call(n,e,i,o)?(r=e,!0):void 0}),r},T.filter=T.select=function(e,t,n){var r=[];return null==e?r:m&&e.filter===m?e.filter(t,n):(O(e,function(e,i,o){t.call(n,e,i,o)&&r.push(e)}),r)},T.reject=function(e,t,n){return T.filter(e,function(e,r,i){return!t.call(n,e,r,i)},n)},T.every=T.all=function(e,t,r){t||(t=T.identity);var i=!0;return null==e?i:g&&e.every===g?e.every(t,r):(O(e,function(e,o,a){return(i=i&&t.call(r,e,o,a))?void 0:n}),!!i)};var A=T.some=T.any=function(e,t,r){t||(t=T.identity);var i=!1;return null==e?i:y&&e.some===y?e.some(t,r):(O(e,function(e,o,a){return i||(i=t.call(r,e,o,a))?n:void 0}),!!i)};T.contains=T.include=function(e,t){return null==e?!1:v&&e.indexOf===v?-1!=e.indexOf(t):A(e,function(e){return e===t})},T.invoke=function(e,t){var n=s.call(arguments,2),r=T.isFunction(t);return T.map(e,function(e){return(r?t:e[t]).apply(e,n)})},T.pluck=function(e,t){return T.map(e,function(e){return e[t]})},T.where=function(e,t,n){return T.isEmpty(t)?n?void 0:[]:T[n?"find":"filter"](e,function(e){for(var n in t)if(t[n]!==e[n])return!1;return!0})},T.findWhere=function(e,t){return T.where(e,t,!0)},T.max=function(e,t,n){if(!t&&T.isArray(e)&&e[0]===+e[0]&&e.length<65535)return Math.max.apply(Math,e);if(!t&&T.isEmpty(e))return-1/0;var r={computed:-1/0,value:-1/0};return O(e,function(e,i,o){var a=t?t.call(n,e,i,o):e;a>r.computed&&(r={value:e,computed:a})}),r.value},T.min=function(e,t,n){if(!t&&T.isArray(e)&&e[0]===+e[0]&&e.length<65535)return Math.min.apply(Math,e);if(!t&&T.isEmpty(e))return 1/0;var r={computed:1/0,value:1/0};return O(e,function(e,i,o){var a=t?t.call(n,e,i,o):e;a<r.computed&&(r={value:e,computed:a})}),r.value},T.shuffle=function(e){var t,n=0,r=[];return O(e,function(e){t=T.random(n++),r[n-1]=r[t],r[t]=e}),r},T.sample=function(e,t,n){return arguments.length<2||n?e[T.random(e.length-1)]:T.shuffle(e).slice(0,Math.max(0,t))};var k=function(e){return T.isFunction(e)?e:function(t){return t[e]}};T.sortBy=function(e,t,n){var r=k(t);return T.pluck(T.map(e,function(e,t,i){return{value:e,index:t,criteria:r.call(n,e,t,i)}}).sort(function(e,t){var n=e.criteria,r=t.criteria;if(n!==r){if(n>r||void 0===n)return 1;if(r>n||void 0===r)return-1}return e.index-t.index}),"value")};var I=function(e){return function(t,n,r){var i={},o=null==n?T.identity:k(n);return O(t,function(n,a){var s=o.call(r,n,a,t);e(i,s,n)}),i}};T.groupBy=I(function(e,t,n){(T.has(e,t)?e[t]:e[t]=[]).push(n)}),T.indexBy=I(function(e,t,n){e[t]=n}),T.countBy=I(function(e,t){T.has(e,t)?e[t]++:e[t]=1}),T.sortedIndex=function(e,t,n,r){n=null==n?T.identity:k(n);for(var i=n.call(r,t),o=0,a=e.length;a>o;){var s=o+a>>>1;n.call(r,e[s])<i?o=s+1:a=s}return o},T.toArray=function(e){return e?T.isArray(e)?s.call(e):e.length===+e.length?T.map(e,T.identity):T.values(e):[]},T.size=function(e){return null==e?0:e.length===+e.length?e.length:T.keys(e).length},T.first=T.head=T.take=function(e,t,n){return null==e?void 0:null==t||n?e[0]:s.call(e,0,t)},T.initial=function(e,t,n){return s.call(e,0,e.length-(null==t||n?1:t))},T.last=function(e,t,n){return null==e?void 0:null==t||n?e[e.length-1]:s.call(e,Math.max(e.length-t,0))},T.rest=T.tail=T.drop=function(e,t,n){return s.call(e,null==t||n?1:t)},T.compact=function(e){return T.filter(e,T.identity)};var C=function(e,t,n){return t&&T.every(e,T.isArray)?u.apply(n,e):(O(e,function(e){T.isArray(e)||T.isArguments(e)?t?a.apply(n,e):C(e,t,n):n.push(e)}),n)};T.flatten=function(e,t){return C(e,t,[])},T.without=function(e){return T.difference(e,s.call(arguments,1))},T.uniq=T.unique=function(e,t,n,r){T.isFunction(t)&&(r=n,n=t,t=!1);var i=n?T.map(e,n,r):e,o=[],a=[];return O(i,function(n,r){(t?r&&a[a.length-1]===n:T.contains(a,n))||(a.push(n),o.push(e[r]))}),o},T.union=function(){return T.uniq(T.flatten(arguments,!0))},T.intersection=function(e){var t=s.call(arguments,1);return T.filter(T.uniq(e),function(e){return T.every(t,function(t){return T.indexOf(t,e)>=0})})},T.difference=function(e){var t=u.apply(r,s.call(arguments,1));return T.filter(e,function(e){return!T.contains(t,e)})},T.zip=function(){for(var e=T.max(T.pluck(arguments,"length").concat(0)),t=new Array(e),n=0;e>n;n++)t[n]=T.pluck(arguments,""+n);return t},T.object=function(e,t){if(null==e)return{};for(var n={},r=0,i=e.length;i>r;r++)t?n[e[r]]=t[r]:n[e[r][0]]=e[r][1];return n},T.indexOf=function(e,t,n){if(null==e)return-1;var r=0,i=e.length;if(n){if("number"!=typeof n)return r=T.sortedIndex(e,t),e[r]===t?r:-1;r=0>n?Math.max(0,i+n):n}if(v&&e.indexOf===v)return e.indexOf(t,n);for(;i>r;r++)if(e[r]===t)return r;return-1},T.lastIndexOf=function(e,t,n){if(null==e)return-1;var r=null!=n;if(w&&e.lastIndexOf===w)return r?e.lastIndexOf(t,n):e.lastIndexOf(t);for(var i=r?n:e.length;i--;)if(e[i]===t)return i;return-1},T.range=function(e,t,n){arguments.length<=1&&(t=e||0,e=0),n=arguments[2]||1;for(var r=Math.max(Math.ceil((t-e)/n),0),i=0,o=new Array(r);r>i;)o[i++]=e,e+=n;return o};var S=function(){};T.bind=function(e,t){var n,r;if(R&&e.bind===R)return R.apply(e,s.call(arguments,1));if(!T.isFunction(e))throw new TypeError;return n=s.call(arguments,2),r=function(){if(!(this instanceof r))return e.apply(t,n.concat(s.call(arguments)));S.prototype=e.prototype;var i=new S;S.prototype=null;var o=e.apply(i,n.concat(s.call(arguments)));return Object(o)===o?o:i}},T.partial=function(e){var t=s.call(arguments,1);return function(){return e.apply(this,t.concat(s.call(arguments)))}},T.bindAll=function(e){var t=s.call(arguments,1);if(0===t.length)throw new Error("bindAll must be passed function names");return O(t,function(t){e[t]=T.bind(e[t],e)}),e},T.memoize=function(e,t){var n={};return t||(t=T.identity),function(){var r=t.apply(this,arguments);return T.has(n,r)?n[r]:n[r]=e.apply(this,arguments)}},T.delay=function(e,t){var n=s.call(arguments,2);return setTimeout(function(){return e.apply(null,n)},t)},T.defer=function(e){return T.delay.apply(T,[e,1].concat(s.call(arguments,1)))},T.throttle=function(e,t,n){var r,i,o,a=null,s=0;n||(n={});var u=function(){s=n.leading===!1?0:new Date,a=null,o=e.apply(r,i)};return function(){var l=new Date;s||n.leading!==!1||(s=l);var c=t-(l-s);return r=this,i=arguments,0>=c?(clearTimeout(a),a=null,s=l,o=e.apply(r,i)):a||n.trailing===!1||(a=setTimeout(u,c)),o}},T.debounce=function(e,t,n){var r,i,o,a,s;return function(){o=this,i=arguments,a=new Date;var u=function(){var l=new Date-a;t>l?r=setTimeout(u,t-l):(r=null,n||(s=e.apply(o,i)))},l=n&&!r;return r||(r=setTimeout(u,t)),l&&(s=e.apply(o,i)),s}},T.once=function(e){var t,n=!1;return function(){return n?t:(n=!0,t=e.apply(this,arguments),e=null,t)}},T.wrap=function(e,t){return function(){var n=[e];return a.apply(n,arguments),t.apply(this,n)}},T.compose=function(){var e=arguments;return function(){for(var t=arguments,n=e.length-1;n>=0;n--)t=[e[n].apply(this,t)];return t[0]}},T.after=function(e,t){return function(){return--e<1?t.apply(this,arguments):void 0}},T.keys=b||function(e){if(e!==Object(e))throw new TypeError("Invalid object");var t=[];for(var n in e)T.has(e,n)&&t.push(n);return t},T.values=function(e){for(var t=T.keys(e),n=t.length,r=new Array(n),i=0;n>i;i++)r[i]=e[t[i]];return r},T.pairs=function(e){for(var t=T.keys(e),n=t.length,r=new Array(n),i=0;n>i;i++)r[i]=[t[i],e[t[i]]];return r},T.invert=function(e){for(var t={},n=T.keys(e),r=0,i=n.length;i>r;r++)t[e[n[r]]]=n[r];return t},T.functions=T.methods=function(e){var t=[];for(var n in e)T.isFunction(e[n])&&t.push(n);return t.sort()},T.extend=function(e){return O(s.call(arguments,1),function(t){if(t)for(var n in t)e[n]=t[n]}),e},T.pick=function(e){var t={},n=u.apply(r,s.call(arguments,1));return O(n,function(n){n in e&&(t[n]=e[n])}),t},T.omit=function(e){var t={},n=u.apply(r,s.call(arguments,1));for(var i in e)T.contains(n,i)||(t[i]=e[i]);return t},T.defaults=function(e){return O(s.call(arguments,1),function(t){if(t)for(var n in t)void 0===e[n]&&(e[n]=t[n])}),e},T.clone=function(e){return T.isObject(e)?T.isArray(e)?e.slice():T.extend({},e):e},T.tap=function(e,t){return t(e),e};var D=function(e,t,n,r){if(e===t)return 0!==e||1/e==1/t;if(null==e||null==t)return e===t;e instanceof T&&(e=e._wrapped),t instanceof T&&(t=t._wrapped);var i=l.call(e);if(i!=l.call(t))return!1;switch(i){case"[object String]":return e==String(t);case"[object Number]":return e!=+e?t!=+t:0==e?1/e==1/t:e==+t;case"[object Date]":case"[object Boolean]":return+e==+t;case"[object RegExp]":return e.source==t.source&&e.global==t.global&&e.multiline==t.multiline&&e.ignoreCase==t.ignoreCase}if("object"!=typeof e||"object"!=typeof t)return!1;for(var o=n.length;o--;)if(n[o]==e)return r[o]==t;var a=e.constructor,s=t.constructor;if(a!==s&&!(T.isFunction(a)&&a instanceof a&&T.isFunction(s)&&s instanceof s))return!1;n.push(e),r.push(t);var u=0,c=!0;if("[object Array]"==i){if(u=e.length,c=u==t.length)for(;u--&&(c=D(e[u],t[u],n,r)););}else{for(var d in e)if(T.has(e,d)&&(u++,!(c=T.has(t,d)&&D(e[d],t[d],n,r))))break;if(c){for(d in t)if(T.has(t,d)&&!u--)break;c=!u}}return n.pop(),r.pop(),c};T.isEqual=function(e,t){return D(e,t,[],[])},T.isEmpty=function(e){if(null==e)return!0;if(T.isArray(e)||T.isString(e))return 0===e.length;for(var t in e)if(T.has(e,t))return!1;return!0},T.isElement=function(e){return!(!e||1!==e.nodeType)},T.isArray=E||function(e){return"[object Array]"==l.call(e)},T.isObject=function(e){return e===Object(e)},O(["Arguments","Function","String","Number","Date","RegExp"],function(e){T["is"+e]=function(t){return l.call(t)=="[object "+e+"]"}}),T.isArguments(arguments)||(T.isArguments=function(e){return!(!e||!T.has(e,"callee"))}),"function"!=typeof/./&&(T.isFunction=function(e){return"function"==typeof e}),T.isFinite=function(e){return isFinite(e)&&!isNaN(parseFloat(e))},T.isNaN=function(e){return T.isNumber(e)&&e!=+e},T.isBoolean=function(e){return e===!0||e===!1||"[object Boolean]"==l.call(e)},T.isNull=function(e){return null===e},T.isUndefined=function(e){return void 0===e},T.has=function(e,t){return c.call(e,t)},T.noConflict=function(){return e._=t,this},T.identity=function(e){return e},T.times=function(e,t,n){for(var r=Array(Math.max(0,e)),i=0;e>i;i++)r[i]=t.call(n,i);return r},T.random=function(e,t){return null==t&&(t=e,e=0),e+Math.floor(Math.random()*(t-e+1))};var F={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;"}};F.unescape=T.invert(F.escape);var L={escape:new RegExp("["+T.keys(F.escape).join("")+"]","g"),unescape:new RegExp("("+T.keys(F.unescape).join("|")+")","g")};T.each(["escape","unescape"],function(e){T[e]=function(t){return null==t?"":(""+t).replace(L[e],function(t){return F[e][t]})}}),T.result=function(e,t){if(null==e)return void 0;var n=e[t];return T.isFunction(n)?n.call(e):n},T.mixin=function(e){O(T.functions(e),function(t){var n=T[t]=e[t];T.prototype[t]=function(){var e=[this._wrapped];return a.apply(e,arguments),x.call(this,n.apply(T,e))}})};var N=0;T.uniqueId=function(e){var t=++N+"";return e?e+t:t},T.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var M=/(.)^/,_={"'":"'","\\":"\\","\r":"r","\n":"n","	":"t","\u2028":"u2028","\u2029":"u2029"},z=/\\|'|\r|\n|\t|\u2028|\u2029/g;T.template=function(e,t,n){var r;n=T.defaults({},n,T.templateSettings);
var i=new RegExp([(n.escape||M).source,(n.interpolate||M).source,(n.evaluate||M).source].join("|")+"|$","g"),o=0,a="__p+='";e.replace(i,function(t,n,r,i,s){return a+=e.slice(o,s).replace(z,function(e){return"\\"+_[e]}),n&&(a+="'+\n((__t=("+n+"))==null?'':_.escape(__t))+\n'"),r&&(a+="'+\n((__t=("+r+"))==null?'':__t)+\n'"),i&&(a+="';\n"+i+"\n__p+='"),o=s+t.length,t}),a+="';\n",n.variable||(a="with(obj||{}){\n"+a+"}\n"),a="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+a+"return __p;\n";try{r=new Function(n.variable||"obj","_",a)}catch(s){throw s.source=a,s}if(t)return r(t,T);var u=function(e){return r.call(this,e,T)};return u.source="function("+(n.variable||"obj")+"){\n"+a+"}",u},T.chain=function(e){return T(e).chain()};var x=function(e){return this._chain?T(e).chain():e};T.mixin(T),O(["pop","push","reverse","shift","sort","splice","unshift"],function(e){var t=r[e];T.prototype[e]=function(){var n=this._wrapped;return t.apply(n,arguments),"shift"!=e&&"splice"!=e||0!==n.length||delete n[0],x.call(this,n)}}),O(["concat","join","slice"],function(e){var t=r[e];T.prototype[e]=function(){return x.call(this,t.apply(this._wrapped,arguments))}}),T.extend(T.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}})}.call(this),define("underscore",function(e){return function(){var t;return t||e._}}(this)),function(e){function t(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1}}function n(e,t){return function(n){return c(e.call(this,n),t)}}function r(e,t){return function(n){return this.lang().ordinal(e.call(this,n),t)}}function i(){}function o(e){R(e),s(this,e)}function a(e){var t=g(e),n=t.year||0,r=t.month||0,i=t.week||0,o=t.day||0,a=t.hour||0,s=t.minute||0,u=t.second||0,l=t.millisecond||0;this._milliseconds=+l+1e3*u+6e4*s+36e5*a,this._days=+o+7*i,this._months=+r+12*n,this._data={},this._bubble()}function s(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return t.hasOwnProperty("toString")&&(e.toString=t.toString),t.hasOwnProperty("valueOf")&&(e.valueOf=t.valueOf),e}function u(e){var t,n={};for(t in e)e.hasOwnProperty(t)&&gt.hasOwnProperty(t)&&(n[t]=e[t]);return n}function l(e){return 0>e?Math.ceil(e):Math.floor(e)}function c(e,t,n){for(var r=""+Math.abs(e),i=e>=0;r.length<t;)r="0"+r;return(i?n?"+":"":"-")+r}function d(e,t,n,r){var i,o,a=t._milliseconds,s=t._days,u=t._months;a&&e._d.setTime(+e._d+a*n),(s||u)&&(i=e.minute(),o=e.hour()),s&&e.date(e.date()+s*n),u&&e.month(e.month()+u*n),a&&!r&&rt.updateOffset(e),(s||u)&&(e.minute(i),e.hour(o))}function p(e){return"[object Array]"===Object.prototype.toString.call(e)}function f(e){return"[object Date]"===Object.prototype.toString.call(e)||e instanceof Date}function h(e,t,n){var r,i=Math.min(e.length,t.length),o=Math.abs(e.length-t.length),a=0;for(r=0;i>r;r++)(n&&e[r]!==t[r]||!n&&v(e[r])!==v(t[r]))&&a++;return a+o}function m(e){if(e){var t=e.toLowerCase().replace(/(.)s$/,"$1");e=Bt[e]||qt[t]||t}return e}function g(e){var t,n,r={};for(n in e)e.hasOwnProperty(n)&&(t=m(n),t&&(r[t]=e[n]));return r}function y(t){var n,r;if(0===t.indexOf("week"))n=7,r="day";else{if(0!==t.indexOf("month"))return;n=12,r="month"}rt[t]=function(i,o){var a,s,u=rt.fn._lang[t],l=[];if("number"==typeof i&&(o=i,i=e),s=function(e){var t=rt().utc().set(r,e);return u.call(rt.fn._lang,t,i||"")},null!=o)return s(o);for(a=0;n>a;a++)l.push(s(a));return l}}function v(e){var t=+e,n=0;return 0!==t&&isFinite(t)&&(n=t>=0?Math.floor(t):Math.ceil(t)),n}function w(e,t){return new Date(Date.UTC(e,t+1,0)).getUTCDate()}function E(e){return b(e)?366:365}function b(e){return e%4===0&&e%100!==0||e%400===0}function R(e){var t;e._a&&-2===e._pf.overflow&&(t=e._a[lt]<0||e._a[lt]>11?lt:e._a[ct]<1||e._a[ct]>w(e._a[ut],e._a[lt])?ct:e._a[dt]<0||e._a[dt]>23?dt:e._a[pt]<0||e._a[pt]>59?pt:e._a[ft]<0||e._a[ft]>59?ft:e._a[ht]<0||e._a[ht]>999?ht:-1,e._pf._overflowDayOfYear&&(ut>t||t>ct)&&(t=ct),e._pf.overflow=t)}function T(e){return null==e._isValid&&(e._isValid=!isNaN(e._d.getTime())&&e._pf.overflow<0&&!e._pf.empty&&!e._pf.invalidMonth&&!e._pf.nullInput&&!e._pf.invalidFormat&&!e._pf.userInvalidated,e._strict&&(e._isValid=e._isValid&&0===e._pf.charsLeftOver&&0===e._pf.unusedTokens.length)),e._isValid}function O(e){return e?e.toLowerCase().replace("_","-"):e}function P(e,t){return t._isUTC?rt(e).zone(t._offset||0):rt(e).local()}function A(e,t){return t.abbr=e,mt[e]||(mt[e]=new i),mt[e].set(t),mt[e]}function k(e){delete mt[e]}function I(e){var t,n,r,i,o=0,a=function(e){if(!mt[e]&&yt)try{require("./lang/"+e)}catch(t){}return mt[e]};if(!e)return rt.fn._lang;if(!p(e)){if(n=a(e))return n;e=[e]}for(;o<e.length;){for(i=O(e[o]).split("-"),t=i.length,r=O(e[o+1]),r=r?r.split("-"):null;t>0;){if(n=a(i.slice(0,t).join("-")))return n;if(r&&r.length>=t&&h(i,r,!0)>=t-1)break;t--}o++}return rt.fn._lang}function C(e){return e.match(/\[[\s\S]/)?e.replace(/^\[|\]$/g,""):e.replace(/\\/g,"")}function S(e){var t,n,r=e.match(bt);for(t=0,n=r.length;n>t;t++)r[t]=Xt[r[t]]?Xt[r[t]]:C(r[t]);return function(i){var o="";for(t=0;n>t;t++)o+=r[t]instanceof Function?r[t].call(i,e):r[t];return o}}function D(e,t){return e.isValid()?(t=F(t,e.lang()),$t[t]||($t[t]=S(t)),$t[t](e)):e.lang().invalidDate()}function F(e,t){function n(e){return t.longDateFormat(e)||e}var r=5;for(Rt.lastIndex=0;r>=0&&Rt.test(e);)e=e.replace(Rt,n),Rt.lastIndex=0,r-=1;return e}function L(e,t){var n,r=t._strict;switch(e){case"DDDD":return Nt;case"YYYY":case"GGGG":case"gggg":return r?Mt:Pt;case"Y":case"G":case"g":return zt;case"YYYYYY":case"YYYYY":case"GGGGG":case"ggggg":return r?_t:At;case"S":if(r)return Ft;case"SS":if(r)return Lt;case"SSS":if(r)return Nt;case"DDD":return Ot;case"MMM":case"MMMM":case"dd":case"ddd":case"dddd":return It;case"a":case"A":return I(t._l)._meridiemParse;case"X":return Dt;case"Z":case"ZZ":return Ct;case"T":return St;case"SSSS":return kt;case"MM":case"DD":case"YY":case"GG":case"gg":case"HH":case"hh":case"mm":case"ss":case"ww":case"WW":return r?Lt:Tt;case"M":case"D":case"d":case"H":case"h":case"m":case"s":case"w":case"W":case"e":case"E":return Tt;default:return n=new RegExp(Y(j(e.replace("\\","")),"i"))}}function N(e){e=e||"";var t=e.match(Ct)||[],n=t[t.length-1]||[],r=(n+"").match(Gt)||["-",0,0],i=+(60*r[1])+v(r[2]);return"+"===r[0]?-i:i}function M(e,t,n){var r,i=n._a;switch(e){case"M":case"MM":null!=t&&(i[lt]=v(t)-1);break;case"MMM":case"MMMM":r=I(n._l).monthsParse(t),null!=r?i[lt]=r:n._pf.invalidMonth=t;break;case"D":case"DD":null!=t&&(i[ct]=v(t));break;case"DDD":case"DDDD":null!=t&&(n._dayOfYear=v(t));break;case"YY":i[ut]=v(t)+(v(t)>68?1900:2e3);break;case"YYYY":case"YYYYY":case"YYYYYY":i[ut]=v(t);break;case"a":case"A":n._isPm=I(n._l).isPM(t);break;case"H":case"HH":case"h":case"hh":i[dt]=v(t);break;case"m":case"mm":i[pt]=v(t);break;case"s":case"ss":i[ft]=v(t);break;case"S":case"SS":case"SSS":case"SSSS":i[ht]=v(1e3*("0."+t));break;case"X":n._d=new Date(1e3*parseFloat(t));break;case"Z":case"ZZ":n._useUTC=!0,n._tzm=N(t);break;case"w":case"ww":case"W":case"WW":case"d":case"dd":case"ddd":case"dddd":case"e":case"E":e=e.substr(0,1);case"gg":case"gggg":case"GG":case"GGGG":case"GGGGG":e=e.substr(0,2),t&&(n._w=n._w||{},n._w[e]=t)}}function _(e){var t,n,r,i,o,a,s,u,l,c,d=[];if(!e._d){for(r=x(e),e._w&&null==e._a[ct]&&null==e._a[lt]&&(o=function(t){var n=parseInt(t,10);return t?t.length<3?n>68?1900+n:2e3+n:n:null==e._a[ut]?rt().weekYear():e._a[ut]},a=e._w,null!=a.GG||null!=a.W||null!=a.E?s=Z(o(a.GG),a.W||1,a.E,4,1):(u=I(e._l),l=null!=a.d?$(a.d,u):null!=a.e?parseInt(a.e,10)+u._week.dow:0,c=parseInt(a.w,10)||1,null!=a.d&&l<u._week.dow&&c++,s=Z(o(a.gg),c,l,u._week.doy,u._week.dow)),e._a[ut]=s.year,e._dayOfYear=s.dayOfYear),e._dayOfYear&&(i=null==e._a[ut]?r[ut]:e._a[ut],e._dayOfYear>E(i)&&(e._pf._overflowDayOfYear=!0),n=q(i,0,e._dayOfYear),e._a[lt]=n.getUTCMonth(),e._a[ct]=n.getUTCDate()),t=0;3>t&&null==e._a[t];++t)e._a[t]=d[t]=r[t];for(;7>t;t++)e._a[t]=d[t]=null==e._a[t]?2===t?1:0:e._a[t];d[dt]+=v((e._tzm||0)/60),d[pt]+=v((e._tzm||0)%60),e._d=(e._useUTC?q:B).apply(null,d)}}function z(e){var t;e._d||(t=g(e._i),e._a=[t.year,t.month,t.day,t.hour,t.minute,t.second,t.millisecond],_(e))}function x(e){var t=new Date;return e._useUTC?[t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate()]:[t.getFullYear(),t.getMonth(),t.getDate()]}function U(e){e._a=[],e._pf.empty=!0;var t,n,r,i,o,a=I(e._l),s=""+e._i,u=s.length,l=0;for(r=F(e._f,a).match(bt)||[],t=0;t<r.length;t++)i=r[t],n=(s.match(L(i,e))||[])[0],n&&(o=s.substr(0,s.indexOf(n)),o.length>0&&e._pf.unusedInput.push(o),s=s.slice(s.indexOf(n)+n.length),l+=n.length),Xt[i]?(n?e._pf.empty=!1:e._pf.unusedTokens.push(i),M(i,n,e)):e._strict&&!n&&e._pf.unusedTokens.push(i);e._pf.charsLeftOver=u-l,s.length>0&&e._pf.unusedInput.push(s),e._isPm&&e._a[dt]<12&&(e._a[dt]+=12),e._isPm===!1&&12===e._a[dt]&&(e._a[dt]=0),_(e),R(e)}function j(e){return e.replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(e,t,n,r,i){return t||n||r||i})}function Y(e){return e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function G(e){var n,r,i,o,a;if(0===e._f.length)return e._pf.invalidFormat=!0,void(e._d=new Date(0/0));for(o=0;o<e._f.length;o++)a=0,n=s({},e),n._pf=t(),n._f=e._f[o],U(n),T(n)&&(a+=n._pf.charsLeftOver,a+=10*n._pf.unusedTokens.length,n._pf.score=a,(null==i||i>a)&&(i=a,r=n));s(e,r||n)}function V(e){var t,n,r=e._i,i=xt.exec(r);if(i){for(e._pf.iso=!0,t=0,n=jt.length;n>t;t++)if(jt[t][1].exec(r)){e._f=jt[t][0]+(i[6]||" ");break}for(t=0,n=Yt.length;n>t;t++)if(Yt[t][1].exec(r)){e._f+=Yt[t][0];break}r.match(Ct)&&(e._f+="Z"),U(e)}else e._d=new Date(r)}function W(t){var n=t._i,r=vt.exec(n);n===e?t._d=new Date:r?t._d=new Date(+r[1]):"string"==typeof n?V(t):p(n)?(t._a=n.slice(0),_(t)):f(n)?t._d=new Date(+n):"object"==typeof n?z(t):t._d=new Date(n)}function B(e,t,n,r,i,o,a){var s=new Date(e,t,n,r,i,o,a);return 1970>e&&s.setFullYear(e),s}function q(e){var t=new Date(Date.UTC.apply(null,arguments));return 1970>e&&t.setUTCFullYear(e),t}function $(e,t){if("string"==typeof e)if(isNaN(e)){if(e=t.weekdaysParse(e),"number"!=typeof e)return null}else e=parseInt(e,10);return e}function H(e,t,n,r,i){return i.relativeTime(t||1,!!n,e,r)}function Q(e,t,n){var r=st(Math.abs(e)/1e3),i=st(r/60),o=st(i/60),a=st(o/24),s=st(a/365),u=45>r&&["s",r]||1===i&&["m"]||45>i&&["mm",i]||1===o&&["h"]||22>o&&["hh",o]||1===a&&["d"]||25>=a&&["dd",a]||45>=a&&["M"]||345>a&&["MM",st(a/30)]||1===s&&["y"]||["yy",s];return u[2]=t,u[3]=e>0,u[4]=n,H.apply({},u)}function X(e,t,n){var r,i=n-t,o=n-e.day();return o>i&&(o-=7),i-7>o&&(o+=7),r=rt(e).add("d",o),{week:Math.ceil(r.dayOfYear()/7),year:r.year()}}function Z(e,t,n,r,i){var o,a,s=q(e,0,1).getUTCDay();return n=null!=n?n:i,o=i-s+(s>r?7:0)-(i>s?7:0),a=7*(t-1)+(n-i)+o+1,{year:a>0?e:e-1,dayOfYear:a>0?a:E(e-1)+a}}function K(e){var t=e._i,n=e._f;return null===t?rt.invalid({nullInput:!0}):("string"==typeof t&&(e._i=t=I().preparse(t)),rt.isMoment(t)?(e=u(t),e._d=new Date(+t._d)):n?p(n)?G(e):U(e):W(e),new o(e))}function J(e,t){rt.fn[e]=rt.fn[e+"s"]=function(e){var n=this._isUTC?"UTC":"";return null!=e?(this._d["set"+n+t](e),rt.updateOffset(this),this):this._d["get"+n+t]()}}function et(e){rt.duration.fn[e]=function(){return this._data[e]}}function tt(e,t){rt.duration.fn["as"+e]=function(){return+this/t}}function nt(e){var t=!1,n=rt;"undefined"==typeof ender&&(e?(at.moment=function(){return!t&&console&&console.warn&&(t=!0),n.apply(null,arguments)},s(at.moment,n)):at.moment=rt)}for(var rt,it,ot="2.5.1",at=this,st=Math.round,ut=0,lt=1,ct=2,dt=3,pt=4,ft=5,ht=6,mt={},gt={_isAMomentObject:null,_i:null,_f:null,_l:null,_strict:null,_isUTC:null,_offset:null,_pf:null,_lang:null},yt="undefined"!=typeof module&&module.exports&&"undefined"!=typeof require,vt=/^\/?Date\((\-?\d+)/i,wt=/(\-)?(?:(\d*)\.)?(\d+)\:(\d+)(?:\:(\d+)\.?(\d{3})?)?/,Et=/^(-)?P(?:(?:([0-9,.]*)Y)?(?:([0-9,.]*)M)?(?:([0-9,.]*)D)?(?:T(?:([0-9,.]*)H)?(?:([0-9,.]*)M)?(?:([0-9,.]*)S)?)?|([0-9,.]*)W)$/,bt=/(\[[^\[]*\])|(\\)?(Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|YYYYYY|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|mm?|ss?|S{1,4}|X|zz?|ZZ?|.)/g,Rt=/(\[[^\[]*\])|(\\)?(LT|LL?L?L?|l{1,4})/g,Tt=/\d\d?/,Ot=/\d{1,3}/,Pt=/\d{1,4}/,At=/[+\-]?\d{1,6}/,kt=/\d+/,It=/[0-9]*['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+|[\u0600-\u06FF\/]+(\s*?[\u0600-\u06FF]+){1,2}/i,Ct=/Z|[\+\-]\d\d:?\d\d/gi,St=/T/i,Dt=/[\+\-]?\d+(\.\d{1,3})?/,Ft=/\d/,Lt=/\d\d/,Nt=/\d{3}/,Mt=/\d{4}/,_t=/[+-]?\d{6}/,zt=/[+-]?\d+/,xt=/^\s*(?:[+-]\d{6}|\d{4})-(?:(\d\d-\d\d)|(W\d\d$)|(W\d\d-\d)|(\d\d\d))((T| )(\d\d(:\d\d(:\d\d(\.\d+)?)?)?)?([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,Ut="YYYY-MM-DDTHH:mm:ssZ",jt=[["YYYYYY-MM-DD",/[+-]\d{6}-\d{2}-\d{2}/],["YYYY-MM-DD",/\d{4}-\d{2}-\d{2}/],["GGGG-[W]WW-E",/\d{4}-W\d{2}-\d/],["GGGG-[W]WW",/\d{4}-W\d{2}/],["YYYY-DDD",/\d{4}-\d{3}/]],Yt=[["HH:mm:ss.SSSS",/(T| )\d\d:\d\d:\d\d\.\d{1,3}/],["HH:mm:ss",/(T| )\d\d:\d\d:\d\d/],["HH:mm",/(T| )\d\d:\d\d/],["HH",/(T| )\d\d/]],Gt=/([\+\-]|\d\d)/gi,Vt="Date|Hours|Minutes|Seconds|Milliseconds".split("|"),Wt={Milliseconds:1,Seconds:1e3,Minutes:6e4,Hours:36e5,Days:864e5,Months:2592e6,Years:31536e6},Bt={ms:"millisecond",s:"second",m:"minute",h:"hour",d:"day",D:"date",w:"week",W:"isoWeek",M:"month",y:"year",DDD:"dayOfYear",e:"weekday",E:"isoWeekday",gg:"weekYear",GG:"isoWeekYear"},qt={dayofyear:"dayOfYear",isoweekday:"isoWeekday",isoweek:"isoWeek",weekyear:"weekYear",isoweekyear:"isoWeekYear"},$t={},Ht="DDD w W M D d".split(" "),Qt="M D H h m s w W".split(" "),Xt={M:function(){return this.month()+1},MMM:function(e){return this.lang().monthsShort(this,e)},MMMM:function(e){return this.lang().months(this,e)},D:function(){return this.date()},DDD:function(){return this.dayOfYear()},d:function(){return this.day()},dd:function(e){return this.lang().weekdaysMin(this,e)},ddd:function(e){return this.lang().weekdaysShort(this,e)},dddd:function(e){return this.lang().weekdays(this,e)},w:function(){return this.week()},W:function(){return this.isoWeek()},YY:function(){return c(this.year()%100,2)},YYYY:function(){return c(this.year(),4)},YYYYY:function(){return c(this.year(),5)},YYYYYY:function(){var e=this.year(),t=e>=0?"+":"-";return t+c(Math.abs(e),6)},gg:function(){return c(this.weekYear()%100,2)},gggg:function(){return c(this.weekYear(),4)},ggggg:function(){return c(this.weekYear(),5)},GG:function(){return c(this.isoWeekYear()%100,2)},GGGG:function(){return c(this.isoWeekYear(),4)},GGGGG:function(){return c(this.isoWeekYear(),5)},e:function(){return this.weekday()},E:function(){return this.isoWeekday()},a:function(){return this.lang().meridiem(this.hours(),this.minutes(),!0)},A:function(){return this.lang().meridiem(this.hours(),this.minutes(),!1)},H:function(){return this.hours()},h:function(){return this.hours()%12||12},m:function(){return this.minutes()},s:function(){return this.seconds()},S:function(){return v(this.milliseconds()/100)},SS:function(){return c(v(this.milliseconds()/10),2)},SSS:function(){return c(this.milliseconds(),3)},SSSS:function(){return c(this.milliseconds(),3)},Z:function(){var e=-this.zone(),t="+";return 0>e&&(e=-e,t="-"),t+c(v(e/60),2)+":"+c(v(e)%60,2)},ZZ:function(){var e=-this.zone(),t="+";return 0>e&&(e=-e,t="-"),t+c(v(e/60),2)+c(v(e)%60,2)},z:function(){return this.zoneAbbr()},zz:function(){return this.zoneName()},X:function(){return this.unix()},Q:function(){return this.quarter()}},Zt=["months","monthsShort","weekdays","weekdaysShort","weekdaysMin"];Ht.length;)it=Ht.pop(),Xt[it+"o"]=r(Xt[it],it);for(;Qt.length;)it=Qt.pop(),Xt[it+it]=n(Xt[it],2);for(Xt.DDDD=n(Xt.DDD,3),s(i.prototype,{set:function(e){var t,n;for(n in e)t=e[n],"function"==typeof t?this[n]=t:this["_"+n]=t},_months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),months:function(e){return this._months[e.month()]},_monthsShort:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),monthsShort:function(e){return this._monthsShort[e.month()]},monthsParse:function(e){var t,n,r;for(this._monthsParse||(this._monthsParse=[]),t=0;12>t;t++)if(this._monthsParse[t]||(n=rt.utc([2e3,t]),r="^"+this.months(n,"")+"|^"+this.monthsShort(n,""),this._monthsParse[t]=new RegExp(r.replace(".",""),"i")),this._monthsParse[t].test(e))return t},_weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),weekdays:function(e){return this._weekdays[e.day()]},_weekdaysShort:"Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),weekdaysShort:function(e){return this._weekdaysShort[e.day()]},_weekdaysMin:"Su_Mo_Tu_We_Th_Fr_Sa".split("_"),weekdaysMin:function(e){return this._weekdaysMin[e.day()]},weekdaysParse:function(e){var t,n,r;for(this._weekdaysParse||(this._weekdaysParse=[]),t=0;7>t;t++)if(this._weekdaysParse[t]||(n=rt([2e3,1]).day(t),r="^"+this.weekdays(n,"")+"|^"+this.weekdaysShort(n,"")+"|^"+this.weekdaysMin(n,""),this._weekdaysParse[t]=new RegExp(r.replace(".",""),"i")),this._weekdaysParse[t].test(e))return t},_longDateFormat:{LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D YYYY",LLL:"MMMM D YYYY LT",LLLL:"dddd, MMMM D YYYY LT"},longDateFormat:function(e){var t=this._longDateFormat[e];return!t&&this._longDateFormat[e.toUpperCase()]&&(t=this._longDateFormat[e.toUpperCase()].replace(/MMMM|MM|DD|dddd/g,function(e){return e.slice(1)}),this._longDateFormat[e]=t),t},isPM:function(e){return"p"===(e+"").toLowerCase().charAt(0)},_meridiemParse:/[ap]\.?m?\.?/i,meridiem:function(e,t,n){return e>11?n?"pm":"PM":n?"am":"AM"},_calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},calendar:function(e,t){var n=this._calendar[e];return"function"==typeof n?n.apply(t):n},_relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},relativeTime:function(e,t,n,r){var i=this._relativeTime[n];return"function"==typeof i?i(e,t,n,r):i.replace(/%d/i,e)},pastFuture:function(e,t){var n=this._relativeTime[e>0?"future":"past"];return"function"==typeof n?n(t):n.replace(/%s/i,t)},ordinal:function(e){return this._ordinal.replace("%d",e)},_ordinal:"%d",preparse:function(e){return e},postformat:function(e){return e},week:function(e){return X(e,this._week.dow,this._week.doy).week},_week:{dow:0,doy:6},_invalidDate:"Invalid date",invalidDate:function(){return this._invalidDate}}),rt=function(n,r,i,o){var a;return"boolean"==typeof i&&(o=i,i=e),a={},a._isAMomentObject=!0,a._i=n,a._f=r,a._l=i,a._strict=o,a._isUTC=!1,a._pf=t(),K(a)},rt.utc=function(n,r,i,o){var a;return"boolean"==typeof i&&(o=i,i=e),a={},a._isAMomentObject=!0,a._useUTC=!0,a._isUTC=!0,a._l=i,a._i=n,a._f=r,a._strict=o,a._pf=t(),K(a).utc()},rt.unix=function(e){return rt(1e3*e)},rt.duration=function(e,t){var n,r,i,o=e,s=null;return rt.isDuration(e)?o={ms:e._milliseconds,d:e._days,M:e._months}:"number"==typeof e?(o={},t?o[t]=e:o.milliseconds=e):(s=wt.exec(e))?(n="-"===s[1]?-1:1,o={y:0,d:v(s[ct])*n,h:v(s[dt])*n,m:v(s[pt])*n,s:v(s[ft])*n,ms:v(s[ht])*n}):(s=Et.exec(e))&&(n="-"===s[1]?-1:1,i=function(e){var t=e&&parseFloat(e.replace(",","."));return(isNaN(t)?0:t)*n},o={y:i(s[2]),M:i(s[3]),d:i(s[4]),h:i(s[5]),m:i(s[6]),s:i(s[7]),w:i(s[8])}),r=new a(o),rt.isDuration(e)&&e.hasOwnProperty("_lang")&&(r._lang=e._lang),r},rt.version=ot,rt.defaultFormat=Ut,rt.updateOffset=function(){},rt.lang=function(e,t){var n;return e?(t?A(O(e),t):null===t?(k(e),e="en"):mt[e]||I(e),n=rt.duration.fn._lang=rt.fn._lang=I(e),n._abbr):rt.fn._lang._abbr},rt.langData=function(e){return e&&e._lang&&e._lang._abbr&&(e=e._lang._abbr),I(e)},rt.isMoment=function(e){return e instanceof o||null!=e&&e.hasOwnProperty("_isAMomentObject")},rt.isDuration=function(e){return e instanceof a},it=Zt.length-1;it>=0;--it)y(Zt[it]);for(rt.normalizeUnits=function(e){return m(e)},rt.invalid=function(e){var t=rt.utc(0/0);return null!=e?s(t._pf,e):t._pf.userInvalidated=!0,t},rt.parseZone=function(e){return rt(e).parseZone()},s(rt.fn=o.prototype,{clone:function(){return rt(this)},valueOf:function(){return+this._d+6e4*(this._offset||0)},unix:function(){return Math.floor(+this/1e3)},toString:function(){return this.clone().lang("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")},toDate:function(){return this._offset?new Date(+this):this._d},toISOString:function(){var e=rt(this).utc();return 0<e.year()&&e.year()<=9999?D(e,"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]"):D(e,"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]")},toArray:function(){var e=this;return[e.year(),e.month(),e.date(),e.hours(),e.minutes(),e.seconds(),e.milliseconds()]},isValid:function(){return T(this)},isDSTShifted:function(){return this._a?this.isValid()&&h(this._a,(this._isUTC?rt.utc(this._a):rt(this._a)).toArray())>0:!1},parsingFlags:function(){return s({},this._pf)},invalidAt:function(){return this._pf.overflow},utc:function(){return this.zone(0)},local:function(){return this.zone(0),this._isUTC=!1,this},format:function(e){var t=D(this,e||rt.defaultFormat);return this.lang().postformat(t)},add:function(e,t){var n;return n="string"==typeof e?rt.duration(+t,e):rt.duration(e,t),d(this,n,1),this},subtract:function(e,t){var n;return n="string"==typeof e?rt.duration(+t,e):rt.duration(e,t),d(this,n,-1),this},diff:function(e,t,n){var r,i,o=P(e,this),a=6e4*(this.zone()-o.zone());return t=m(t),"year"===t||"month"===t?(r=432e5*(this.daysInMonth()+o.daysInMonth()),i=12*(this.year()-o.year())+(this.month()-o.month()),i+=(this-rt(this).startOf("month")-(o-rt(o).startOf("month")))/r,i-=6e4*(this.zone()-rt(this).startOf("month").zone()-(o.zone()-rt(o).startOf("month").zone()))/r,"year"===t&&(i/=12)):(r=this-o,i="second"===t?r/1e3:"minute"===t?r/6e4:"hour"===t?r/36e5:"day"===t?(r-a)/864e5:"week"===t?(r-a)/6048e5:r),n?i:l(i)},from:function(e,t){return rt.duration(this.diff(e)).lang(this.lang()._abbr).humanize(!t)},fromNow:function(e){return this.from(rt(),e)},calendar:function(){var e=P(rt(),this).startOf("day"),t=this.diff(e,"days",!0),n=-6>t?"sameElse":-1>t?"lastWeek":0>t?"lastDay":1>t?"sameDay":2>t?"nextDay":7>t?"nextWeek":"sameElse";return this.format(this.lang().calendar(n,this))},isLeapYear:function(){return b(this.year())},isDST:function(){return this.zone()<this.clone().month(0).zone()||this.zone()<this.clone().month(5).zone()},day:function(e){var t=this._isUTC?this._d.getUTCDay():this._d.getDay();return null!=e?(e=$(e,this.lang()),this.add({d:e-t})):t},month:function(e){var t,n=this._isUTC?"UTC":"";return null!=e?"string"==typeof e&&(e=this.lang().monthsParse(e),"number"!=typeof e)?this:(t=this.date(),this.date(1),this._d["set"+n+"Month"](e),this.date(Math.min(t,this.daysInMonth())),rt.updateOffset(this),this):this._d["get"+n+"Month"]()},startOf:function(e){switch(e=m(e)){case"year":this.month(0);case"month":this.date(1);case"week":case"isoWeek":case"day":this.hours(0);case"hour":this.minutes(0);case"minute":this.seconds(0);case"second":this.milliseconds(0)}return"week"===e?this.weekday(0):"isoWeek"===e&&this.isoWeekday(1),this},endOf:function(e){return e=m(e),this.startOf(e).add("isoWeek"===e?"week":e,1).subtract("ms",1)},isAfter:function(e,t){return t="undefined"!=typeof t?t:"millisecond",+this.clone().startOf(t)>+rt(e).startOf(t)},isBefore:function(e,t){return t="undefined"!=typeof t?t:"millisecond",+this.clone().startOf(t)<+rt(e).startOf(t)},isSame:function(e,t){return t=t||"ms",+this.clone().startOf(t)===+P(e,this).startOf(t)},min:function(e){return e=rt.apply(null,arguments),this>e?this:e},max:function(e){return e=rt.apply(null,arguments),e>this?this:e},zone:function(e){var t=this._offset||0;return null==e?this._isUTC?t:this._d.getTimezoneOffset():("string"==typeof e&&(e=N(e)),Math.abs(e)<16&&(e=60*e),this._offset=e,this._isUTC=!0,t!==e&&d(this,rt.duration(t-e,"m"),1,!0),this)},zoneAbbr:function(){return this._isUTC?"UTC":""},zoneName:function(){return this._isUTC?"Coordinated Universal Time":""},parseZone:function(){return this._tzm?this.zone(this._tzm):"string"==typeof this._i&&this.zone(this._i),this},hasAlignedHourOffset:function(e){return e=e?rt(e).zone():0,(this.zone()-e)%60===0},daysInMonth:function(){return w(this.year(),this.month())},dayOfYear:function(e){var t=st((rt(this).startOf("day")-rt(this).startOf("year"))/864e5)+1;return null==e?t:this.add("d",e-t)},quarter:function(){return Math.ceil((this.month()+1)/3)},weekYear:function(e){var t=X(this,this.lang()._week.dow,this.lang()._week.doy).year;return null==e?t:this.add("y",e-t)},isoWeekYear:function(e){var t=X(this,1,4).year;return null==e?t:this.add("y",e-t)},week:function(e){var t=this.lang().week(this);return null==e?t:this.add("d",7*(e-t))},isoWeek:function(e){var t=X(this,1,4).week;return null==e?t:this.add("d",7*(e-t))},weekday:function(e){var t=(this.day()+7-this.lang()._week.dow)%7;return null==e?t:this.add("d",e-t)},isoWeekday:function(e){return null==e?this.day()||7:this.day(this.day()%7?e:e-7)},get:function(e){return e=m(e),this[e]()},set:function(e,t){return e=m(e),"function"==typeof this[e]&&this[e](t),this},lang:function(t){return t===e?this._lang:(this._lang=I(t),this)}}),it=0;it<Vt.length;it++)J(Vt[it].toLowerCase().replace(/s$/,""),Vt[it]);J("year","FullYear"),rt.fn.days=rt.fn.day,rt.fn.months=rt.fn.month,rt.fn.weeks=rt.fn.week,rt.fn.isoWeeks=rt.fn.isoWeek,rt.fn.toJSON=rt.fn.toISOString,s(rt.duration.fn=a.prototype,{_bubble:function(){var e,t,n,r,i=this._milliseconds,o=this._days,a=this._months,s=this._data;s.milliseconds=i%1e3,e=l(i/1e3),s.seconds=e%60,t=l(e/60),s.minutes=t%60,n=l(t/60),s.hours=n%24,o+=l(n/24),s.days=o%30,a+=l(o/30),s.months=a%12,r=l(a/12),s.years=r},weeks:function(){return l(this.days()/7)},valueOf:function(){return this._milliseconds+864e5*this._days+this._months%12*2592e6+31536e6*v(this._months/12)},humanize:function(e){var t=+this,n=Q(t,!e,this.lang());return e&&(n=this.lang().pastFuture(t,n)),this.lang().postformat(n)},add:function(e,t){var n=rt.duration(e,t);return this._milliseconds+=n._milliseconds,this._days+=n._days,this._months+=n._months,this._bubble(),this},subtract:function(e,t){var n=rt.duration(e,t);return this._milliseconds-=n._milliseconds,this._days-=n._days,this._months-=n._months,this._bubble(),this},get:function(e){return e=m(e),this[e.toLowerCase()+"s"]()},as:function(e){return e=m(e),this["as"+e.charAt(0).toUpperCase()+e.slice(1)+"s"]()},lang:rt.fn.lang,toIsoString:function(){var e=Math.abs(this.years()),t=Math.abs(this.months()),n=Math.abs(this.days()),r=Math.abs(this.hours()),i=Math.abs(this.minutes()),o=Math.abs(this.seconds()+this.milliseconds()/1e3);return this.asSeconds()?(this.asSeconds()<0?"-":"")+"P"+(e?e+"Y":"")+(t?t+"M":"")+(n?n+"D":"")+(r||i||o?"T":"")+(r?r+"H":"")+(i?i+"M":"")+(o?o+"S":""):"P0D"}});for(it in Wt)Wt.hasOwnProperty(it)&&(tt(it,Wt[it]),et(it.toLowerCase()));tt("Weeks",6048e5),rt.duration.fn.asMonths=function(){return(+this-31536e6*this.years())/2592e6+12*this.years()},rt.lang("en",{ordinal:function(e){var t=e%10,n=1===v(e%100/10)?"th":1===t?"st":2===t?"nd":3===t?"rd":"th";return e+n}}),yt?(module.exports=rt,nt(!0)):"function"==typeof define&&define.amd?define("moment",["require","exports","module"],function(t,n,r){return r.config&&r.config()&&r.config().noGlobal!==!0&&nt(r.config().noGlobal===e),rt}):nt()}.call(this),function(e){"undefined"==typeof e.fn.each2&&e.extend(e.fn,{each2:function(t){for(var n=e([0]),r=-1,i=this.length;++r<i&&(n.context=n[0]=this[r])&&t.call(n[0],r,n)!==!1;);return this}})}(jQuery),function(e,t){function n(t){var n=e(document.createTextNode(""));t.before(n),n.before(t),n.remove()}function r(e){var t,n,r,i;if(!e||e.length<1)return e;for(t="",n=0,r=e.length;r>n;n++)i=e.charAt(n),t+=j[i]||i;return t}function i(e,t){for(var n=0,r=t.length;r>n;n+=1)if(a(e,t[n]))return n;return-1}function o(){var t=e(U);t.appendTo("body");var n={width:t.width()-t[0].clientWidth,height:t.height()-t[0].clientHeight};return t.remove(),n}function a(e,n){return e===n?!0:e===t||n===t?!1:null===e||null===n?!1:e.constructor===String?e+""==n+"":n.constructor===String?n+""==e+"":!1}function s(t,n){var r,i,o;if(null===t||t.length<1)return[];for(r=t.split(n),i=0,o=r.length;o>i;i+=1)r[i]=e.trim(r[i]);return r}function u(e){return e.outerWidth(!1)-e.width()}function l(n){var r="keyup-change-value";n.on("keydown",function(){e.data(n,r)===t&&e.data(n,r,n.val())}),n.on("keyup",function(){var i=e.data(n,r);i!==t&&n.val()!==i&&(e.removeData(n,r),n.trigger("keyup-change"))})}function c(n){n.on("mousemove",function(n){var r=x;(r===t||r.x!==n.pageX||r.y!==n.pageY)&&e(n.target).trigger("mousemove-filtered",n)})}function d(e,n,r){r=r||t;var i;return function(){var t=arguments;window.clearTimeout(i),i=window.setTimeout(function(){n.apply(r,t)},e)}}function p(e){var t,n=!1;return function(){return n===!1&&(t=e(),n=!0),t}}function f(e,t){var n=d(e,function(e){t.trigger("scroll-debounced",e)});t.on("scroll",function(e){i(e.target,t.get())>=0&&n(e)})}function h(e){e[0]!==document.activeElement&&window.setTimeout(function(){var t,n=e[0],r=e.val().length;e.focus();var i=n.offsetWidth>0||n.offsetHeight>0;i&&n===document.activeElement&&(n.setSelectionRange?n.setSelectionRange(r,r):n.createTextRange&&(t=n.createTextRange(),t.collapse(!1),t.select()))},0)}function m(t){t=e(t)[0];var n=0,r=0;if("selectionStart"in t)n=t.selectionStart,r=t.selectionEnd-n;else if("selection"in document){t.focus();var i=document.selection.createRange();r=document.selection.createRange().text.length,i.moveStart("character",-t.value.length),n=i.text.length-r}return{offset:n,length:r}}function g(e){e.preventDefault(),e.stopPropagation()}function y(e){e.preventDefault(),e.stopImmediatePropagation()}function v(t){if(!M){var n=t[0].currentStyle||window.getComputedStyle(t[0],null);M=e(document.createElement("div")).css({position:"absolute",left:"-10000px",top:"-10000px",display:"none",fontSize:n.fontSize,fontFamily:n.fontFamily,fontStyle:n.fontStyle,fontWeight:n.fontWeight,letterSpacing:n.letterSpacing,textTransform:n.textTransform,whiteSpace:"nowrap"}),M.attr("class","select2-sizer"),e("body").append(M)}return M.text(t.val()),M.width()}function w(t,n,r){var i,o,a=[];i=t.attr("class"),i&&(i=""+i,e(i.split(" ")).each2(function(){0===this.indexOf("select2-")&&a.push(this)})),i=n.attr("class"),i&&(i=""+i,e(i.split(" ")).each2(function(){0!==this.indexOf("select2-")&&(o=r(this),o&&a.push(o))})),t.attr("class",a.join(" "))}function E(e,t,n,i){var o=r(e.toUpperCase()).indexOf(r(t.toUpperCase())),a=t.length;return 0>o?void n.push(i(e)):(n.push(i(e.substring(0,o))),n.push("<span class='select2-match'>"),n.push(i(e.substring(o,o+a))),n.push("</span>"),void n.push(i(e.substring(o+a,e.length))))}function b(e){var t={"\\":"&#92;","&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#47;"};return String(e).replace(/[&<>"'\/\\]/g,function(e){return t[e]})}function R(n){var r,i=null,o=n.quietMillis||100,a=n.url,s=this;return function(u){window.clearTimeout(r),r=window.setTimeout(function(){var r=n.data,o=a,l=n.transport||e.fn.select2.ajaxDefaults.transport,c={type:n.type||"GET",cache:n.cache||!1,jsonpCallback:n.jsonpCallback||t,dataType:n.dataType||"json"},d=e.extend({},e.fn.select2.ajaxDefaults.params,c);r=r?r.call(s,u.term,u.page,u.context):null,o="function"==typeof o?o.call(s,u.term,u.page,u.context):o,i&&"function"==typeof i.abort&&i.abort(),n.params&&(e.isFunction(n.params)?e.extend(d,n.params.call(s)):e.extend(d,n.params)),e.extend(d,{url:o,dataType:n.dataType,data:r,success:function(e){var t=n.results(e,u);u.callback(t)}}),i=l.call(s,d)},o)}}function T(t){var n,r,i=t,o=function(e){return""+e.text};e.isArray(i)&&(r=i,i={results:r}),e.isFunction(i)===!1&&(r=i,i=function(){return r});var a=i();return a.text&&(o=a.text,e.isFunction(o)||(n=a.text,o=function(e){return e[n]})),function(t){var n,r=t.term,a={results:[]};return""===r?void t.callback(i()):(n=function(i,a){var s,u;if(i=i[0],i.children){s={};for(u in i)i.hasOwnProperty(u)&&(s[u]=i[u]);s.children=[],e(i.children).each2(function(e,t){n(t,s.children)}),(s.children.length||t.matcher(r,o(s),i))&&a.push(s)}else t.matcher(r,o(i),i)&&a.push(i)
},e(i().results).each2(function(e,t){n(t,a.results)}),void t.callback(a))}}function O(n){var r=e.isFunction(n);return function(i){var o=i.term,a={results:[]};e(r?n():n).each(function(){var e=this.text!==t,n=e?this.text:this;(""===o||i.matcher(o,n))&&a.results.push(e?this:{id:this,text:this})}),i.callback(a)}}function P(t,n){if(e.isFunction(t))return!0;if(!t)return!1;if("string"==typeof t)return!0;throw new Error(n+" must be a string, function, or falsy value")}function A(t){if(e.isFunction(t)){var n=Array.prototype.slice.call(arguments,1);return t.apply(null,n)}return t}function k(t){var n=0;return e.each(t,function(e,t){t.children?n+=k(t.children):n++}),n}function I(e,n,r,i){var o,s,u,l,c,d=e,p=!1;if(!i.createSearchChoice||!i.tokenSeparators||i.tokenSeparators.length<1)return t;for(;;){for(s=-1,u=0,l=i.tokenSeparators.length;l>u&&(c=i.tokenSeparators[u],s=e.indexOf(c),!(s>=0));u++);if(0>s)break;if(o=e.substring(0,s),e=e.substring(s+c.length),o.length>0&&(o=i.createSearchChoice.call(this,o,n),o!==t&&null!==o&&i.id(o)!==t&&null!==i.id(o))){for(p=!1,u=0,l=n.length;l>u;u++)if(a(i.id(o),i.id(n[u]))){p=!0;break}p||r(o)}}return d!==e?e:void 0}function C(t,n){var r=function(){};return r.prototype=new t,r.prototype.constructor=r,r.prototype.parent=t.prototype,r.prototype=e.extend(r.prototype,n),r}if(window.Select2===t){var S,D,F,L,N,M,_,z,x={x:0,y:0},S={TAB:9,ENTER:13,ESC:27,SPACE:32,LEFT:37,UP:38,RIGHT:39,DOWN:40,SHIFT:16,CTRL:17,ALT:18,PAGE_UP:33,PAGE_DOWN:34,HOME:36,END:35,BACKSPACE:8,DELETE:46,isArrow:function(e){switch(e=e.which?e.which:e){case S.LEFT:case S.RIGHT:case S.UP:case S.DOWN:return!0}return!1},isControl:function(e){var t=e.which;switch(t){case S.SHIFT:case S.CTRL:case S.ALT:return!0}return e.metaKey?!0:!1},isFunctionKey:function(e){return e=e.which?e.which:e,e>=112&&123>=e}},U="<div class='select2-measure-scrollbar'></div>",j={"Ⓐ":"A",Ａ:"A",À:"A",Á:"A",Â:"A",Ầ:"A",Ấ:"A",Ẫ:"A",Ẩ:"A",Ã:"A",Ā:"A",Ă:"A",Ằ:"A",Ắ:"A",Ẵ:"A",Ẳ:"A",Ȧ:"A",Ǡ:"A",Ä:"A",Ǟ:"A",Ả:"A",Å:"A",Ǻ:"A",Ǎ:"A",Ȁ:"A",Ȃ:"A",Ạ:"A",Ậ:"A",Ặ:"A",Ḁ:"A",Ą:"A",Ⱥ:"A",Ɐ:"A",Ꜳ:"AA",Æ:"AE",Ǽ:"AE",Ǣ:"AE",Ꜵ:"AO",Ꜷ:"AU",Ꜹ:"AV",Ꜻ:"AV",Ꜽ:"AY","Ⓑ":"B",Ｂ:"B",Ḃ:"B",Ḅ:"B",Ḇ:"B",Ƀ:"B",Ƃ:"B",Ɓ:"B","Ⓒ":"C",Ｃ:"C",Ć:"C",Ĉ:"C",Ċ:"C",Č:"C",Ç:"C",Ḉ:"C",Ƈ:"C",Ȼ:"C",Ꜿ:"C","Ⓓ":"D",Ｄ:"D",Ḋ:"D",Ď:"D",Ḍ:"D",Ḑ:"D",Ḓ:"D",Ḏ:"D",Đ:"D",Ƌ:"D",Ɗ:"D",Ɖ:"D",Ꝺ:"D",Ǳ:"DZ",Ǆ:"DZ",ǲ:"Dz",ǅ:"Dz","Ⓔ":"E",Ｅ:"E",È:"E",É:"E",Ê:"E",Ề:"E",Ế:"E",Ễ:"E",Ể:"E",Ẽ:"E",Ē:"E",Ḕ:"E",Ḗ:"E",Ĕ:"E",Ė:"E",Ë:"E",Ẻ:"E",Ě:"E",Ȅ:"E",Ȇ:"E",Ẹ:"E",Ệ:"E",Ȩ:"E",Ḝ:"E",Ę:"E",Ḙ:"E",Ḛ:"E",Ɛ:"E",Ǝ:"E","Ⓕ":"F",Ｆ:"F",Ḟ:"F",Ƒ:"F",Ꝼ:"F","Ⓖ":"G",Ｇ:"G",Ǵ:"G",Ĝ:"G",Ḡ:"G",Ğ:"G",Ġ:"G",Ǧ:"G",Ģ:"G",Ǥ:"G",Ɠ:"G","Ꞡ":"G",Ᵹ:"G",Ꝿ:"G","Ⓗ":"H",Ｈ:"H",Ĥ:"H",Ḣ:"H",Ḧ:"H",Ȟ:"H",Ḥ:"H",Ḩ:"H",Ḫ:"H",Ħ:"H",Ⱨ:"H",Ⱶ:"H","Ɥ":"H","Ⓘ":"I",Ｉ:"I",Ì:"I",Í:"I",Î:"I",Ĩ:"I",Ī:"I",Ĭ:"I",İ:"I",Ï:"I",Ḯ:"I",Ỉ:"I",Ǐ:"I",Ȉ:"I",Ȋ:"I",Ị:"I",Į:"I",Ḭ:"I",Ɨ:"I","Ⓙ":"J",Ｊ:"J",Ĵ:"J",Ɉ:"J","Ⓚ":"K",Ｋ:"K",Ḱ:"K",Ǩ:"K",Ḳ:"K",Ķ:"K",Ḵ:"K",Ƙ:"K",Ⱪ:"K",Ꝁ:"K",Ꝃ:"K",Ꝅ:"K","Ꞣ":"K","Ⓛ":"L",Ｌ:"L",Ŀ:"L",Ĺ:"L",Ľ:"L",Ḷ:"L",Ḹ:"L",Ļ:"L",Ḽ:"L",Ḻ:"L",Ł:"L",Ƚ:"L",Ɫ:"L",Ⱡ:"L",Ꝉ:"L",Ꝇ:"L",Ꞁ:"L",Ǉ:"LJ",ǈ:"Lj","Ⓜ":"M",Ｍ:"M",Ḿ:"M",Ṁ:"M",Ṃ:"M",Ɱ:"M",Ɯ:"M","Ⓝ":"N",Ｎ:"N",Ǹ:"N",Ń:"N",Ñ:"N",Ṅ:"N",Ň:"N",Ṇ:"N",Ņ:"N",Ṋ:"N",Ṉ:"N",Ƞ:"N",Ɲ:"N","Ꞑ":"N","Ꞥ":"N",Ǌ:"NJ",ǋ:"Nj","Ⓞ":"O",Ｏ:"O",Ò:"O",Ó:"O",Ô:"O",Ồ:"O",Ố:"O",Ỗ:"O",Ổ:"O",Õ:"O",Ṍ:"O",Ȭ:"O",Ṏ:"O",Ō:"O",Ṑ:"O",Ṓ:"O",Ŏ:"O",Ȯ:"O",Ȱ:"O",Ö:"O",Ȫ:"O",Ỏ:"O",Ő:"O",Ǒ:"O",Ȍ:"O",Ȏ:"O",Ơ:"O",Ờ:"O",Ớ:"O",Ỡ:"O",Ở:"O",Ợ:"O",Ọ:"O",Ộ:"O",Ǫ:"O",Ǭ:"O",Ø:"O",Ǿ:"O",Ɔ:"O",Ɵ:"O",Ꝋ:"O",Ꝍ:"O",Ƣ:"OI",Ꝏ:"OO",Ȣ:"OU","Ⓟ":"P",Ｐ:"P",Ṕ:"P",Ṗ:"P",Ƥ:"P",Ᵽ:"P",Ꝑ:"P",Ꝓ:"P",Ꝕ:"P","Ⓠ":"Q",Ｑ:"Q",Ꝗ:"Q",Ꝙ:"Q",Ɋ:"Q","Ⓡ":"R",Ｒ:"R",Ŕ:"R",Ṙ:"R",Ř:"R",Ȑ:"R",Ȓ:"R",Ṛ:"R",Ṝ:"R",Ŗ:"R",Ṟ:"R",Ɍ:"R",Ɽ:"R",Ꝛ:"R","Ꞧ":"R",Ꞃ:"R","Ⓢ":"S",Ｓ:"S",ẞ:"S",Ś:"S",Ṥ:"S",Ŝ:"S",Ṡ:"S",Š:"S",Ṧ:"S",Ṣ:"S",Ṩ:"S",Ș:"S",Ş:"S","Ȿ":"S","Ꞩ":"S",Ꞅ:"S","Ⓣ":"T",Ｔ:"T",Ṫ:"T",Ť:"T",Ṭ:"T",Ț:"T",Ţ:"T",Ṱ:"T",Ṯ:"T",Ŧ:"T",Ƭ:"T",Ʈ:"T",Ⱦ:"T",Ꞇ:"T",Ꜩ:"TZ","Ⓤ":"U",Ｕ:"U",Ù:"U",Ú:"U",Û:"U",Ũ:"U",Ṹ:"U",Ū:"U",Ṻ:"U",Ŭ:"U",Ü:"U",Ǜ:"U",Ǘ:"U",Ǖ:"U",Ǚ:"U",Ủ:"U",Ů:"U",Ű:"U",Ǔ:"U",Ȕ:"U",Ȗ:"U",Ư:"U",Ừ:"U",Ứ:"U",Ữ:"U",Ử:"U",Ự:"U",Ụ:"U",Ṳ:"U",Ų:"U",Ṷ:"U",Ṵ:"U",Ʉ:"U","Ⓥ":"V",Ｖ:"V",Ṽ:"V",Ṿ:"V",Ʋ:"V",Ꝟ:"V",Ʌ:"V",Ꝡ:"VY","Ⓦ":"W",Ｗ:"W",Ẁ:"W",Ẃ:"W",Ŵ:"W",Ẇ:"W",Ẅ:"W",Ẉ:"W",Ⱳ:"W","Ⓧ":"X",Ｘ:"X",Ẋ:"X",Ẍ:"X","Ⓨ":"Y",Ｙ:"Y",Ỳ:"Y",Ý:"Y",Ŷ:"Y",Ỹ:"Y",Ȳ:"Y",Ẏ:"Y",Ÿ:"Y",Ỷ:"Y",Ỵ:"Y",Ƴ:"Y",Ɏ:"Y",Ỿ:"Y","Ⓩ":"Z",Ｚ:"Z",Ź:"Z",Ẑ:"Z",Ż:"Z",Ž:"Z",Ẓ:"Z",Ẕ:"Z",Ƶ:"Z",Ȥ:"Z","Ɀ":"Z",Ⱬ:"Z",Ꝣ:"Z","ⓐ":"a",ａ:"a",ẚ:"a",à:"a",á:"a",â:"a",ầ:"a",ấ:"a",ẫ:"a",ẩ:"a",ã:"a",ā:"a",ă:"a",ằ:"a",ắ:"a",ẵ:"a",ẳ:"a",ȧ:"a",ǡ:"a",ä:"a",ǟ:"a",ả:"a",å:"a",ǻ:"a",ǎ:"a",ȁ:"a",ȃ:"a",ạ:"a",ậ:"a",ặ:"a",ḁ:"a",ą:"a",ⱥ:"a",ɐ:"a",ꜳ:"aa",æ:"ae",ǽ:"ae",ǣ:"ae",ꜵ:"ao",ꜷ:"au",ꜹ:"av",ꜻ:"av",ꜽ:"ay","ⓑ":"b",ｂ:"b",ḃ:"b",ḅ:"b",ḇ:"b",ƀ:"b",ƃ:"b",ɓ:"b","ⓒ":"c",ｃ:"c",ć:"c",ĉ:"c",ċ:"c",č:"c",ç:"c",ḉ:"c",ƈ:"c",ȼ:"c",ꜿ:"c",ↄ:"c","ⓓ":"d",ｄ:"d",ḋ:"d",ď:"d",ḍ:"d",ḑ:"d",ḓ:"d",ḏ:"d",đ:"d",ƌ:"d",ɖ:"d",ɗ:"d",ꝺ:"d",ǳ:"dz",ǆ:"dz","ⓔ":"e",ｅ:"e",è:"e",é:"e",ê:"e",ề:"e",ế:"e",ễ:"e",ể:"e",ẽ:"e",ē:"e",ḕ:"e",ḗ:"e",ĕ:"e",ė:"e",ë:"e",ẻ:"e",ě:"e",ȅ:"e",ȇ:"e",ẹ:"e",ệ:"e",ȩ:"e",ḝ:"e",ę:"e",ḙ:"e",ḛ:"e",ɇ:"e",ɛ:"e",ǝ:"e","ⓕ":"f",ｆ:"f",ḟ:"f",ƒ:"f",ꝼ:"f","ⓖ":"g",ｇ:"g",ǵ:"g",ĝ:"g",ḡ:"g",ğ:"g",ġ:"g",ǧ:"g",ģ:"g",ǥ:"g",ɠ:"g","ꞡ":"g",ᵹ:"g",ꝿ:"g","ⓗ":"h",ｈ:"h",ĥ:"h",ḣ:"h",ḧ:"h",ȟ:"h",ḥ:"h",ḩ:"h",ḫ:"h",ẖ:"h",ħ:"h",ⱨ:"h",ⱶ:"h",ɥ:"h",ƕ:"hv","ⓘ":"i",ｉ:"i",ì:"i",í:"i",î:"i",ĩ:"i",ī:"i",ĭ:"i",ï:"i",ḯ:"i",ỉ:"i",ǐ:"i",ȉ:"i",ȋ:"i",ị:"i",į:"i",ḭ:"i",ɨ:"i",ı:"i","ⓙ":"j",ｊ:"j",ĵ:"j",ǰ:"j",ɉ:"j","ⓚ":"k",ｋ:"k",ḱ:"k",ǩ:"k",ḳ:"k",ķ:"k",ḵ:"k",ƙ:"k",ⱪ:"k",ꝁ:"k",ꝃ:"k",ꝅ:"k","ꞣ":"k","ⓛ":"l",ｌ:"l",ŀ:"l",ĺ:"l",ľ:"l",ḷ:"l",ḹ:"l",ļ:"l",ḽ:"l",ḻ:"l",ſ:"l",ł:"l",ƚ:"l",ɫ:"l",ⱡ:"l",ꝉ:"l",ꞁ:"l",ꝇ:"l",ǉ:"lj","ⓜ":"m",ｍ:"m",ḿ:"m",ṁ:"m",ṃ:"m",ɱ:"m",ɯ:"m","ⓝ":"n",ｎ:"n",ǹ:"n",ń:"n",ñ:"n",ṅ:"n",ň:"n",ṇ:"n",ņ:"n",ṋ:"n",ṉ:"n",ƞ:"n",ɲ:"n",ŉ:"n","ꞑ":"n","ꞥ":"n",ǌ:"nj","ⓞ":"o",ｏ:"o",ò:"o",ó:"o",ô:"o",ồ:"o",ố:"o",ỗ:"o",ổ:"o",õ:"o",ṍ:"o",ȭ:"o",ṏ:"o",ō:"o",ṑ:"o",ṓ:"o",ŏ:"o",ȯ:"o",ȱ:"o",ö:"o",ȫ:"o",ỏ:"o",ő:"o",ǒ:"o",ȍ:"o",ȏ:"o",ơ:"o",ờ:"o",ớ:"o",ỡ:"o",ở:"o",ợ:"o",ọ:"o",ộ:"o",ǫ:"o",ǭ:"o",ø:"o",ǿ:"o",ɔ:"o",ꝋ:"o",ꝍ:"o",ɵ:"o",ƣ:"oi",ȣ:"ou",ꝏ:"oo","ⓟ":"p",ｐ:"p",ṕ:"p",ṗ:"p",ƥ:"p",ᵽ:"p",ꝑ:"p",ꝓ:"p",ꝕ:"p","ⓠ":"q",ｑ:"q",ɋ:"q",ꝗ:"q",ꝙ:"q","ⓡ":"r",ｒ:"r",ŕ:"r",ṙ:"r",ř:"r",ȑ:"r",ȓ:"r",ṛ:"r",ṝ:"r",ŗ:"r",ṟ:"r",ɍ:"r",ɽ:"r",ꝛ:"r","ꞧ":"r",ꞃ:"r","ⓢ":"s",ｓ:"s",ß:"s",ś:"s",ṥ:"s",ŝ:"s",ṡ:"s",š:"s",ṧ:"s",ṣ:"s",ṩ:"s",ș:"s",ş:"s",ȿ:"s","ꞩ":"s",ꞅ:"s",ẛ:"s","ⓣ":"t",ｔ:"t",ṫ:"t",ẗ:"t",ť:"t",ṭ:"t",ț:"t",ţ:"t",ṱ:"t",ṯ:"t",ŧ:"t",ƭ:"t",ʈ:"t",ⱦ:"t",ꞇ:"t",ꜩ:"tz","ⓤ":"u",ｕ:"u",ù:"u",ú:"u",û:"u",ũ:"u",ṹ:"u",ū:"u",ṻ:"u",ŭ:"u",ü:"u",ǜ:"u",ǘ:"u",ǖ:"u",ǚ:"u",ủ:"u",ů:"u",ű:"u",ǔ:"u",ȕ:"u",ȗ:"u",ư:"u",ừ:"u",ứ:"u",ữ:"u",ử:"u",ự:"u",ụ:"u",ṳ:"u",ų:"u",ṷ:"u",ṵ:"u",ʉ:"u","ⓥ":"v",ｖ:"v",ṽ:"v",ṿ:"v",ʋ:"v",ꝟ:"v",ʌ:"v",ꝡ:"vy","ⓦ":"w",ｗ:"w",ẁ:"w",ẃ:"w",ŵ:"w",ẇ:"w",ẅ:"w",ẘ:"w",ẉ:"w",ⱳ:"w","ⓧ":"x",ｘ:"x",ẋ:"x",ẍ:"x","ⓨ":"y",ｙ:"y",ỳ:"y",ý:"y",ŷ:"y",ỹ:"y",ȳ:"y",ẏ:"y",ÿ:"y",ỷ:"y",ẙ:"y",ỵ:"y",ƴ:"y",ɏ:"y",ỿ:"y","ⓩ":"z",ｚ:"z",ź:"z",ẑ:"z",ż:"z",ž:"z",ẓ:"z",ẕ:"z",ƶ:"z",ȥ:"z",ɀ:"z",ⱬ:"z",ꝣ:"z"};_=e(document),N=function(){var e=1;return function(){return e++}}(),_.on("mousemove",function(e){x.x=e.pageX,x.y=e.pageY}),D=C(Object,{bind:function(e){var t=this;return function(){e.apply(t,arguments)}},init:function(n){var r,i,a=".select2-results";this.opts=n=this.prepareOpts(n),this.id=n.id,n.element.data("select2")!==t&&null!==n.element.data("select2")&&n.element.data("select2").destroy(),this.container=this.createContainer(),this.liveRegion=e("<span>",{role:"status","aria-live":"polite"}).addClass("select2-hidden-accessible").appendTo(document.body),this.containerId="s2id_"+(n.element.attr("id")||"autogen"+N()).replace(/([;&,\-\.\+\*\~':"\!\^#$%@\[\]\(\)=>\|])/g,"\\$1"),this.containerSelector="#"+this.containerId,this.container.attr("id",this.containerId);var s=this;this.body=p(function(){return"function"==typeof n.dropdownContainer?n.dropdownContainer(s):n.dropdownContainer?n.dropdownContainer:n.element.closest("body")}),w(this.container,this.opts.element,this.opts.adaptContainerCssClass),this.container.attr("style",n.element.attr("style")),this.container.css(A(n.containerCss)),this.container.addClass(A(n.containerCssClass)),this.elementTabIndex=this.opts.element.attr("tabindex"),this.opts.element.data("select2",this).attr("tabindex","-1").before(this.container).on("click.select2",g),this.container.data("select2",this),this.dropdown=this.container.find(".select2-drop"),w(this.dropdown,this.opts.element,this.opts.adaptDropdownCssClass),this.dropdown.addClass(A(n.dropdownCssClass)),this.dropdown.data("select2",this),this.dropdown.on("click",g),this.results=r=this.container.find(a),this.search=i=this.container.find("input.select2-input"),this.queryCount=0,this.resultsPage=0,this.context=null,this.initContainer(),this.container.on("click",g),c(this.results),this.dropdown.on("mousemove-filtered touchstart touchmove touchend",a,this.bind(this.highlightUnderEvent)),this.dropdown.on("touchend",a,this.bind(this.selectHighlighted)),this.dropdown.on("touchmove",a,this.bind(this.touchMoved)),this.dropdown.on("touchstart touchend",a,this.bind(this.clearTouchMoved)),f(80,this.results),this.dropdown.on("scroll-debounced",a,this.bind(this.loadMoreIfNeeded)),e(this.container).on("change",".select2-input",function(e){e.stopPropagation()}),e(this.dropdown).on("change",".select2-input",function(e){e.stopPropagation()}),e.fn.mousewheel&&r.mousewheel(function(e,t,n,i){var o=r.scrollTop();i>0&&0>=o-i?(r.scrollTop(0),g(e)):0>i&&r.get(0).scrollHeight-r.scrollTop()+i<=r.height()&&(r.scrollTop(r.get(0).scrollHeight-r.height()),g(e))}),l(i),i.on("keyup-change input paste",this.bind(this.updateResults)),i.on("focus",function(){i.addClass("select2-focused")}),i.on("blur",function(){i.removeClass("select2-focused")}),this.dropdown.on("mouseup",a,this.bind(function(t){e(t.target).closest(".select2-result-selectable").length>0&&(this.highlightUnderEvent(t),this.selectHighlighted(t))})),this.dropdown.on("click mouseup mousedown focusin",function(e){e.stopPropagation()}),this.nextSearchTerm=t,e.isFunction(this.opts.initSelection)&&(this.initSelection(),this.monitorSource()),null!==n.maximumInputLength&&this.search.attr("maxlength",n.maximumInputLength);var u=n.element.prop("disabled");u===t&&(u=!1),this.enable(!u);var d=n.element.prop("readonly");d===t&&(d=!1),this.readonly(d),z=z||o(),this.autofocus=n.element.prop("autofocus"),n.element.prop("autofocus",!1),this.autofocus&&this.focus(),this.search.attr("placeholder",n.searchInputPlaceholder)},destroy:function(){var e=this.opts.element,n=e.data("select2");this.close(),this.propertyObserver&&(delete this.propertyObserver,this.propertyObserver=null),n!==t&&(n.container.remove(),n.liveRegion.remove(),n.dropdown.remove(),e.removeClass("select2-offscreen").removeData("select2").off(".select2").prop("autofocus",this.autofocus||!1),this.elementTabIndex?e.attr({tabindex:this.elementTabIndex}):e.removeAttr("tabindex"),e.show())},optionToData:function(e){return e.is("option")?{id:e.prop("value"),text:e.text(),element:e.get(),css:e.attr("class"),disabled:e.prop("disabled"),locked:a(e.attr("locked"),"locked")||a(e.data("locked"),!0)}:e.is("optgroup")?{text:e.attr("label"),children:[],element:e.get(),css:e.attr("class")}:void 0},prepareOpts:function(n){var r,i,o,u,l=this;if(r=n.element,"select"===r.get(0).tagName.toLowerCase()&&(this.select=i=n.element),i&&e.each(["id","multiple","ajax","query","createSearchChoice","initSelection","data","tags"],function(){if(this in n)throw new Error("Option '"+this+"' is not allowed for Select2 when attached to a <select> element.")}),n=e.extend({},{populateResults:function(r,i,o){var a,s=this.opts.id,u=this.liveRegion;(a=function(r,i,c){var d,p,f,h,m,g,y,v,w,E;for(r=n.sortResults(r,i,o),d=0,p=r.length;p>d;d+=1)f=r[d],m=f.disabled===!0,h=!m&&s(f)!==t,g=f.children&&f.children.length>0,y=e("<li></li>"),y.addClass("select2-results-dept-"+c),y.addClass("select2-result"),y.addClass(h?"select2-result-selectable":"select2-result-unselectable"),m&&y.addClass("select2-disabled"),g&&y.addClass("select2-result-with-children"),y.addClass(l.opts.formatResultCssClass(f)),y.attr("role","presentation"),v=e(document.createElement("div")),v.addClass("select2-result-label"),v.attr("id","select2-result-label-"+N()),v.attr("role","option"),E=n.formatResult(f,v,o,l.opts.escapeMarkup),E!==t&&(v.html(E),y.append(v)),g&&(w=e("<ul></ul>"),w.addClass("select2-result-sub"),a(f.children,w,c+1),y.append(w)),y.data("select2-data",f),i.append(y);u.text(n.formatMatches(r.length))})(i,r,0)}},e.fn.select2.defaults,n),"function"!=typeof n.id&&(o=n.id,n.id=function(e){return e[o]}),e.isArray(n.element.data("select2Tags"))){if("tags"in n)throw"tags specified as both an attribute 'data-select2-tags' and in options of Select2 "+n.element.attr("id");n.tags=n.element.data("select2Tags")}if(i?(n.query=this.bind(function(e){var n,i,o,a={results:[],more:!1},s=e.term;o=function(t,n){var r;t.is("option")?e.matcher(s,t.text(),t)&&n.push(l.optionToData(t)):t.is("optgroup")&&(r=l.optionToData(t),t.children().each2(function(e,t){o(t,r.children)}),r.children.length>0&&n.push(r))},n=r.children(),this.getPlaceholder()!==t&&n.length>0&&(i=this.getPlaceholderOption(),i&&(n=n.not(i))),n.each2(function(e,t){o(t,a.results)}),e.callback(a)}),n.id=function(e){return e.id}):"query"in n||("ajax"in n?(u=n.element.data("ajax-url"),u&&u.length>0&&(n.ajax.url=u),n.query=R.call(n.element,n.ajax)):"data"in n?n.query=T(n.data):"tags"in n&&(n.query=O(n.tags),n.createSearchChoice===t&&(n.createSearchChoice=function(t){return{id:e.trim(t),text:e.trim(t)}}),n.initSelection===t&&(n.initSelection=function(t,r){var i=[];e(s(t.val(),n.separator)).each(function(){var t={id:this,text:this},r=n.tags;e.isFunction(r)&&(r=r()),e(r).each(function(){return a(this.id,t.id)?(t=this,!1):void 0}),i.push(t)}),r(i)}))),"function"!=typeof n.query)throw"query function not defined for Select2 "+n.element.attr("id");if("top"===n.createSearchChoicePosition)n.createSearchChoicePosition=function(e,t){e.unshift(t)};else if("bottom"===n.createSearchChoicePosition)n.createSearchChoicePosition=function(e,t){e.push(t)};else if("function"!=typeof n.createSearchChoicePosition)throw"invalid createSearchChoicePosition option must be 'top', 'bottom' or a custom function";return n},monitorSource:function(){var e,n,r=this.opts.element;r.on("change.select2",this.bind(function(){this.opts.element.data("select2-change-triggered")!==!0&&this.initSelection()})),e=this.bind(function(){var e=r.prop("disabled");e===t&&(e=!1),this.enable(!e);var n=r.prop("readonly");n===t&&(n=!1),this.readonly(n),w(this.container,this.opts.element,this.opts.adaptContainerCssClass),this.container.addClass(A(this.opts.containerCssClass)),w(this.dropdown,this.opts.element,this.opts.adaptDropdownCssClass),this.dropdown.addClass(A(this.opts.dropdownCssClass))}),r.on("propertychange.select2",e),this.mutationCallback===t&&(this.mutationCallback=function(t){t.forEach(e)}),n=window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver,n!==t&&(this.propertyObserver&&(delete this.propertyObserver,this.propertyObserver=null),this.propertyObserver=new n(this.mutationCallback),this.propertyObserver.observe(r.get(0),{attributes:!0,subtree:!1}))},triggerSelect:function(t){var n=e.Event("select2-selecting",{val:this.id(t),object:t});return this.opts.element.trigger(n),!n.isDefaultPrevented()},triggerChange:function(t){t=t||{},t=e.extend({},t,{type:"change",val:this.val()}),this.opts.element.data("select2-change-triggered",!0),this.opts.element.trigger(t),this.opts.element.data("select2-change-triggered",!1),this.opts.element.click(),this.opts.blurOnChange&&this.opts.element.blur()},isInterfaceEnabled:function(){return this.enabledInterface===!0},enableInterface:function(){var e=this._enabled&&!this._readonly,t=!e;return e===this.enabledInterface?!1:(this.container.toggleClass("select2-container-disabled",t),this.close(),this.enabledInterface=e,!0)},enable:function(e){e===t&&(e=!0),this._enabled!==e&&(this._enabled=e,this.opts.element.prop("disabled",!e),this.enableInterface())},disable:function(){this.enable(!1)},readonly:function(e){e===t&&(e=!1),this._readonly!==e&&(this._readonly=e,this.opts.element.prop("readonly",e),this.enableInterface())},opened:function(){return this.container.hasClass("select2-dropdown-open")},positionDropdown:function(){var t,n,r,i,o,a=this.dropdown,s=this.container.offset(),u=this.container.outerHeight(!1),l=this.container.outerWidth(!1),c=a.outerHeight(!1),d=e(window),p=d.width(),f=d.height(),h=d.scrollLeft()+p,m=d.scrollTop()+f,g=s.top+u,y=s.left,v=m>=g+c,w=s.top-c>=d.scrollTop(),E=a.outerWidth(!1),b=h>=y+E,R=a.hasClass("select2-drop-above");R?(n=!0,!w&&v&&(r=!0,n=!1)):(n=!1,!v&&w&&(r=!0,n=!0)),r&&(a.hide(),s=this.container.offset(),u=this.container.outerHeight(!1),l=this.container.outerWidth(!1),c=a.outerHeight(!1),h=d.scrollLeft()+p,m=d.scrollTop()+f,g=s.top+u,y=s.left,E=a.outerWidth(!1),b=h>=y+E,a.show()),this.opts.dropdownAutoWidth?(o=e(".select2-results",a)[0],a.addClass("select2-drop-auto-width"),a.css("width",""),E=a.outerWidth(!1)+(o.scrollHeight===o.clientHeight?0:z.width),E>l?l=E:E=l,b=h>=y+E):this.container.removeClass("select2-drop-auto-width"),"static"!==this.body().css("position")&&(t=this.body().offset(),g-=t.top,y-=t.left),b||(y=s.left+this.container.outerWidth(!1)-E),i={left:y,width:l},n?(i.top=s.top-c,i.bottom="auto",this.container.addClass("select2-drop-above"),a.addClass("select2-drop-above")):(i.top=g,i.bottom="auto",this.container.removeClass("select2-drop-above"),a.removeClass("select2-drop-above")),i=e.extend(i,A(this.opts.dropdownCss)),a.css(i)},shouldOpen:function(){var t;return this.opened()?!1:this._enabled===!1||this._readonly===!0?!1:(t=e.Event("select2-opening"),this.opts.element.trigger(t),!t.isDefaultPrevented())},clearDropdownAlignmentPreference:function(){this.container.removeClass("select2-drop-above"),this.dropdown.removeClass("select2-drop-above")},open:function(){return this.shouldOpen()?(this.opening(),!0):!1},opening:function(){var t,r=this.containerId,i="scroll."+r,o="resize."+r,a="orientationchange."+r;this.container.addClass("select2-dropdown-open").addClass("select2-container-active"),this.clearDropdownAlignmentPreference(),this.dropdown[0]!==this.body().children().last()[0]&&this.dropdown.detach().appendTo(this.body()),t=e("#select2-drop-mask"),0==t.length&&(t=e(document.createElement("div")),t.attr("id","select2-drop-mask").attr("class","select2-drop-mask"),t.hide(),t.appendTo(this.body()),t.on("mousedown touchstart click",function(r){n(t);var i,o=e("#select2-drop");o.length>0&&(i=o.data("select2"),i.opts.selectOnBlur&&i.selectHighlighted({noFocus:!0}),i.close(),r.preventDefault(),r.stopPropagation())})),this.dropdown.prev()[0]!==t[0]&&this.dropdown.before(t),e("#select2-drop").removeAttr("id"),this.dropdown.attr("id","select2-drop"),t.show(),this.positionDropdown(),this.dropdown.show(),this.positionDropdown(),this.dropdown.addClass("select2-drop-active");var s=this;this.container.parents().add(window).each(function(){e(this).on(o+" "+i+" "+a,function(){s.positionDropdown()})})},close:function(){if(this.opened()){var t=this.containerId,n="scroll."+t,r="resize."+t,i="orientationchange."+t;this.container.parents().add(window).each(function(){e(this).off(n).off(r).off(i)}),this.clearDropdownAlignmentPreference(),e("#select2-drop-mask").hide(),this.dropdown.removeAttr("id"),this.dropdown.hide(),this.container.removeClass("select2-dropdown-open").removeClass("select2-container-active"),this.results.empty(),this.clearSearch(),this.search.removeClass("select2-active"),this.opts.element.trigger(e.Event("select2-close"))}},externalSearch:function(e){this.open(),this.search.val(e),this.updateResults(!1)},clearSearch:function(){},getMaximumSelectionSize:function(){return A(this.opts.maximumSelectionSize)},ensureHighlightVisible:function(){var t,n,r,i,o,a,s,u=this.results;if(n=this.highlight(),!(0>n)){if(0==n)return void u.scrollTop(0);t=this.findHighlightableChoices().find(".select2-result-label"),r=e(t[n]),i=r.offset().top+r.outerHeight(!0),n===t.length-1&&(s=u.find("li.select2-more-results"),s.length>0&&(i=s.offset().top+s.outerHeight(!0))),o=u.offset().top+u.outerHeight(!0),i>o&&u.scrollTop(u.scrollTop()+(i-o)),a=r.offset().top-u.offset().top,0>a&&"none"!=r.css("display")&&u.scrollTop(u.scrollTop()+a)}},findHighlightableChoices:function(){return this.results.find(".select2-result-selectable:not(.select2-disabled):not(.select2-selected)")},moveHighlight:function(t){for(var n=this.findHighlightableChoices(),r=this.highlight();r>-1&&r<n.length;){r+=t;var i=e(n[r]);if(i.hasClass("select2-result-selectable")&&!i.hasClass("select2-disabled")&&!i.hasClass("select2-selected")){this.highlight(r);break}}},highlight:function(t){var n,r,o=this.findHighlightableChoices();return 0===arguments.length?i(o.filter(".select2-highlighted")[0],o.get()):(t>=o.length&&(t=o.length-1),0>t&&(t=0),this.removeHighlight(),n=e(o[t]),n.addClass("select2-highlighted"),this.search.attr("aria-activedescendant",n.find(".select2-result-label").attr("id")),this.ensureHighlightVisible(),this.liveRegion.text(n.text()),r=n.data("select2-data"),void(r&&this.opts.element.trigger({type:"select2-highlight",val:this.id(r),choice:r})))},removeHighlight:function(){this.results.find(".select2-highlighted").removeClass("select2-highlighted")},touchMoved:function(){this._touchMoved=!0},clearTouchMoved:function(){this._touchMoved=!1},countSelectableResults:function(){return this.findHighlightableChoices().length},highlightUnderEvent:function(t){var n=e(t.target).closest(".select2-result-selectable");if(n.length>0&&!n.is(".select2-highlighted")){var r=this.findHighlightableChoices();this.highlight(r.index(n))}else 0==n.length&&this.removeHighlight()},loadMoreIfNeeded:function(){var e,t=this.results,n=t.find("li.select2-more-results"),r=this.resultsPage+1,i=this,o=this.search.val(),a=this.context;0!==n.length&&(e=n.offset().top-t.offset().top-t.height(),e<=this.opts.loadMorePadding&&(n.addClass("select2-active"),this.opts.query({element:this.opts.element,term:o,page:r,context:a,matcher:this.opts.matcher,callback:this.bind(function(e){i.opened()&&(i.opts.populateResults.call(this,t,e.results,{term:o,page:r,context:a}),i.postprocessResults(e,!1,!1),e.more===!0?(n.detach().appendTo(t).text(A(i.opts.formatLoadMore,r+1)),window.setTimeout(function(){i.loadMoreIfNeeded()},10)):n.remove(),i.positionDropdown(),i.resultsPage=r,i.context=e.context,this.opts.element.trigger({type:"select2-loaded",items:e}))})})))},tokenize:function(){},updateResults:function(n){function r(){l.removeClass("select2-active"),p.positionDropdown(),p.liveRegion.text(c.find(".select2-no-results,.select2-selection-limit,.select2-searching").length?c.text():p.opts.formatMatches(c.find(".select2-result-selectable").length))}function i(e){c.html(e),r()}var o,s,u,l=this.search,c=this.results,d=this.opts,p=this,f=l.val(),h=e.data(this.container,"select2-last-term");if((n===!0||!h||!a(f,h))&&(e.data(this.container,"select2-last-term",f),n===!0||this.showSearchInput!==!1&&this.opened())){u=++this.queryCount;var m=this.getMaximumSelectionSize();if(m>=1&&(o=this.data(),e.isArray(o)&&o.length>=m&&P(d.formatSelectionTooBig,"formatSelectionTooBig")))return void i("<li class='select2-selection-limit'>"+A(d.formatSelectionTooBig,m)+"</li>");if(l.val().length<d.minimumInputLength)return i(P(d.formatInputTooShort,"formatInputTooShort")?"<li class='select2-no-results'>"+A(d.formatInputTooShort,l.val(),d.minimumInputLength)+"</li>":""),void(n&&this.showSearch&&this.showSearch(!0));if(d.maximumInputLength&&l.val().length>d.maximumInputLength)return void i(P(d.formatInputTooLong,"formatInputTooLong")?"<li class='select2-no-results'>"+A(d.formatInputTooLong,l.val(),d.maximumInputLength)+"</li>":"");d.formatSearching&&0===this.findHighlightableChoices().length&&i("<li class='select2-searching'>"+A(d.formatSearching)+"</li>"),l.addClass("select2-active"),this.removeHighlight(),s=this.tokenize(),s!=t&&null!=s&&l.val(s),this.resultsPage=1,d.query({element:d.element,term:l.val(),page:this.resultsPage,context:null,matcher:d.matcher,callback:this.bind(function(o){var s;if(u==this.queryCount){if(!this.opened())return void this.search.removeClass("select2-active");if(this.context=o.context===t?null:o.context,this.opts.createSearchChoice&&""!==l.val()&&(s=this.opts.createSearchChoice.call(p,l.val(),o.results),s!==t&&null!==s&&p.id(s)!==t&&null!==p.id(s)&&0===e(o.results).filter(function(){return a(p.id(this),p.id(s))}).length&&this.opts.createSearchChoicePosition(o.results,s)),0===o.results.length&&P(d.formatNoMatches,"formatNoMatches"))return void i("<li class='select2-no-results'>"+A(d.formatNoMatches,l.val())+"</li>");c.empty(),p.opts.populateResults.call(this,c,o.results,{term:l.val(),page:this.resultsPage,context:null}),o.more===!0&&P(d.formatLoadMore,"formatLoadMore")&&(c.append("<li class='select2-more-results'>"+p.opts.escapeMarkup(A(d.formatLoadMore,this.resultsPage))+"</li>"),window.setTimeout(function(){p.loadMoreIfNeeded()},10)),this.postprocessResults(o,n),r(),this.opts.element.trigger({type:"select2-loaded",items:o})}})})}},cancel:function(){this.close()},blur:function(){this.opts.selectOnBlur&&this.selectHighlighted({noFocus:!0}),this.close(),this.container.removeClass("select2-container-active"),this.search[0]===document.activeElement&&this.search.blur(),this.clearSearch(),this.selection.find(".select2-search-choice-focus").removeClass("select2-search-choice-focus")},focusSearch:function(){h(this.search)},selectHighlighted:function(e){if(this._touchMoved)return void this.clearTouchMoved();var t=this.highlight(),n=this.results.find(".select2-highlighted"),r=n.closest(".select2-result").data("select2-data");r?(this.highlight(t),this.onSelect(r,e)):e&&e.noFocus&&this.close()},getPlaceholder:function(){var e;return this.opts.element.attr("placeholder")||this.opts.element.attr("data-placeholder")||this.opts.element.data("placeholder")||this.opts.placeholder||((e=this.getPlaceholderOption())!==t?e.text():t)},getPlaceholderOption:function(){if(this.select){var e=this.select.children("option").first();if(this.opts.placeholderOption!==t)return"first"===this.opts.placeholderOption&&e||"function"==typeof this.opts.placeholderOption&&this.opts.placeholderOption(this.select);if(""===e.text()&&""===e.val())return e}},initContainerWidth:function(){function n(){var n,r,i,o,a,s;if("off"===this.opts.width)return null;if("element"===this.opts.width)return 0===this.opts.element.outerWidth(!1)?"auto":this.opts.element.outerWidth(!1)+"px";if("copy"===this.opts.width||"resolve"===this.opts.width){if(n=this.opts.element.attr("style"),n!==t)for(r=n.split(";"),o=0,a=r.length;a>o;o+=1)if(s=r[o].replace(/\s/g,""),i=s.match(/^width:(([-+]?([0-9]*\.)?[0-9]+)(px|em|ex|%|in|cm|mm|pt|pc))/i),null!==i&&i.length>=1)return i[1];return"resolve"===this.opts.width?(n=this.opts.element.css("width"),n.indexOf("%")>0?n:0===this.opts.element.outerWidth(!1)?"auto":this.opts.element.outerWidth(!1)+"px"):null}return e.isFunction(this.opts.width)?this.opts.width():this.opts.width}var r=n.call(this);null!==r&&this.container.css("width",r)}}),F=C(D,{createContainer:function(){var t=e(document.createElement("div")).attr({"class":"select2-container"}).html(["<a href='javascript:void(0)' class='select2-choice' tabindex='-1'>","   <span class='select2-chosen'>&nbsp;</span><abbr class='select2-search-choice-close'></abbr>","   <span class='select2-arrow' role='presentation'><b role='presentation'></b></span>","</a>","<label for='' class='select2-offscreen'></label>","<input class='select2-focusser select2-offscreen' type='text' aria-haspopup='true' role='button' />","<div class='select2-drop select2-display-none'>","   <div class='select2-search'>","       <label for='' class='select2-offscreen'></label>","       <input type='text' autocomplete='off' autocorrect='off' autocapitalize='off' spellcheck='false' class='select2-input' role='combobox' aria-expanded='true'","       aria-autocomplete='list' />","   </div>","   <ul class='select2-results' role='listbox'>","   </ul>","</div>"].join(""));return t},enableInterface:function(){this.parent.enableInterface.apply(this,arguments)&&this.focusser.prop("disabled",!this.isInterfaceEnabled())},opening:function(){var n,r,i;this.opts.minimumResultsForSearch>=0&&this.showSearch(!0),this.parent.opening.apply(this,arguments),this.showSearchInput!==!1&&this.search.val(this.focusser.val()),this.search.focus(),n=this.search.get(0),n.createTextRange?(r=n.createTextRange(),r.collapse(!1),r.select()):n.setSelectionRange&&(i=this.search.val().length,n.setSelectionRange(i,i)),""===this.search.val()&&this.nextSearchTerm!=t&&(this.search.val(this.nextSearchTerm),this.search.select()),this.focusser.prop("disabled",!0).val(""),this.updateResults(!0),this.opts.element.trigger(e.Event("select2-open"))},close:function(){this.opened()&&(this.parent.close.apply(this,arguments),this.focusser.prop("disabled",!1),this.opts.shouldFocusInput(this)&&this.focusser.focus())},focus:function(){this.opened()?this.close():(this.focusser.prop("disabled",!1),this.opts.shouldFocusInput(this)&&this.focusser.focus())},isFocused:function(){return this.container.hasClass("select2-container-active")},cancel:function(){this.parent.cancel.apply(this,arguments),this.focusser.prop("disabled",!1),this.opts.shouldFocusInput(this)&&this.focusser.focus()},destroy:function(){e("label[for='"+this.focusser.attr("id")+"']").attr("for",this.opts.element.attr("id")),this.parent.destroy.apply(this,arguments)},initContainer:function(){var t,r,i=this.container,o=this.dropdown,a=N();this.showSearch(this.opts.minimumResultsForSearch<0?!1:!0),this.selection=t=i.find(".select2-choice"),this.focusser=i.find(".select2-focusser"),t.find(".select2-chosen").attr("id","select2-chosen-"+a),this.focusser.attr("aria-labelledby","select2-chosen-"+a),this.results.attr("id","select2-results-"+a),this.search.attr("aria-owns","select2-results-"+a),this.focusser.attr("id","s2id_autogen"+a),r=e("label[for='"+this.opts.element.attr("id")+"']"),this.focusser.prev().text(r.text()).attr("for",this.focusser.attr("id"));var s=this.opts.element.attr("title");this.opts.element.attr("title",s||r.text()),this.focusser.attr("tabindex",this.elementTabIndex),this.search.attr("id",this.focusser.attr("id")+"_search"),this.search.prev().text(e("label[for='"+this.focusser.attr("id")+"']").text()).attr("for",this.search.attr("id")),this.search.on("keydown",this.bind(function(e){if(this.isInterfaceEnabled()){if(e.which===S.PAGE_UP||e.which===S.PAGE_DOWN)return void g(e);switch(e.which){case S.UP:case S.DOWN:return this.moveHighlight(e.which===S.UP?-1:1),void g(e);case S.ENTER:return this.selectHighlighted(),void g(e);case S.TAB:return void this.selectHighlighted({noFocus:!0});case S.ESC:return this.cancel(e),void g(e)}}})),this.search.on("blur",this.bind(function(){document.activeElement===this.body().get(0)&&window.setTimeout(this.bind(function(){this.opened()&&this.search.focus()}),0)})),this.focusser.on("keydown",this.bind(function(e){if(this.isInterfaceEnabled()&&e.which!==S.TAB&&!S.isControl(e)&&!S.isFunctionKey(e)&&e.which!==S.ESC){if(this.opts.openOnEnter===!1&&e.which===S.ENTER)return void g(e);if(e.which==S.DOWN||e.which==S.UP||e.which==S.ENTER&&this.opts.openOnEnter){if(e.altKey||e.ctrlKey||e.shiftKey||e.metaKey)return;return this.open(),void g(e)}return e.which==S.DELETE||e.which==S.BACKSPACE?(this.opts.allowClear&&this.clear(),void g(e)):void 0}})),l(this.focusser),this.focusser.on("keyup-change input",this.bind(function(e){if(this.opts.minimumResultsForSearch>=0){if(e.stopPropagation(),this.opened())return;this.open()}})),t.on("mousedown touchstart","abbr",this.bind(function(e){this.isInterfaceEnabled()&&(this.clear(),y(e),this.close(),this.selection.focus())})),t.on("mousedown touchstart",this.bind(function(r){n(t),this.container.hasClass("select2-container-active")||this.opts.element.trigger(e.Event("select2-focus")),this.opened()?this.close():this.isInterfaceEnabled()&&this.open(),g(r)
})),o.on("mousedown touchstart",this.bind(function(){this.search.focus()})),t.on("focus",this.bind(function(e){g(e)})),this.focusser.on("focus",this.bind(function(){this.container.hasClass("select2-container-active")||this.opts.element.trigger(e.Event("select2-focus")),this.container.addClass("select2-container-active")})).on("blur",this.bind(function(){this.opened()||(this.container.removeClass("select2-container-active"),this.opts.element.trigger(e.Event("select2-blur")))})),this.search.on("focus",this.bind(function(){this.container.hasClass("select2-container-active")||this.opts.element.trigger(e.Event("select2-focus")),this.container.addClass("select2-container-active")})),this.initContainerWidth(),this.opts.element.addClass("select2-offscreen"),this.setPlaceholder()},clear:function(t){var n=this.selection.data("select2-data");if(n){var r=e.Event("select2-clearing");if(this.opts.element.trigger(r),r.isDefaultPrevented())return;var i=this.getPlaceholderOption();this.opts.element.val(i?i.val():""),this.selection.find(".select2-chosen").empty(),this.selection.removeData("select2-data"),this.setPlaceholder(),t!==!1&&(this.opts.element.trigger({type:"select2-removed",val:this.id(n),choice:n}),this.triggerChange({removed:n}))}},initSelection:function(){if(this.isPlaceholderOptionSelected())this.updateSelection(null),this.close(),this.setPlaceholder();else{var e=this;this.opts.initSelection.call(null,this.opts.element,function(n){n!==t&&null!==n&&(e.updateSelection(n),e.close(),e.setPlaceholder(),e.nextSearchTerm=e.opts.nextSearchTerm(n,e.search.val()))})}},isPlaceholderOptionSelected:function(){var e;return this.getPlaceholder()?(e=this.getPlaceholderOption())!==t&&e.prop("selected")||""===this.opts.element.val()||this.opts.element.val()===t||null===this.opts.element.val():!1},prepareOpts:function(){var t=this.parent.prepareOpts.apply(this,arguments),n=this;return"select"===t.element.get(0).tagName.toLowerCase()?t.initSelection=function(e,t){var r=e.find("option").filter(function(){return this.selected&&!this.disabled});t(n.optionToData(r))}:"data"in t&&(t.initSelection=t.initSelection||function(n,r){var i=n.val(),o=null;t.query({matcher:function(e,n,r){var s=a(i,t.id(r));return s&&(o=r),s},callback:e.isFunction(r)?function(){r(o)}:e.noop})}),t},getPlaceholder:function(){return this.select&&this.getPlaceholderOption()===t?t:this.parent.getPlaceholder.apply(this,arguments)},setPlaceholder:function(){var e=this.getPlaceholder();if(this.isPlaceholderOptionSelected()&&e!==t){if(this.select&&this.getPlaceholderOption()===t)return;this.selection.find(".select2-chosen").html(this.opts.escapeMarkup(e)),this.selection.addClass("select2-default"),this.container.removeClass("select2-allowclear")}},postprocessResults:function(e,t,n){var r=0,i=this;if(this.findHighlightableChoices().each2(function(e,t){return a(i.id(t.data("select2-data")),i.opts.element.val())?(r=e,!1):void 0}),n!==!1&&this.highlight(t===!0&&r>=0?r:0),t===!0){var o=this.opts.minimumResultsForSearch;o>=0&&this.showSearch(k(e.results)>=o)}},showSearch:function(t){this.showSearchInput!==t&&(this.showSearchInput=t,this.dropdown.find(".select2-search").toggleClass("select2-search-hidden",!t),this.dropdown.find(".select2-search").toggleClass("select2-offscreen",!t),e(this.dropdown,this.container).toggleClass("select2-with-searchbox",t))},onSelect:function(e,t){if(this.triggerSelect(e)){var n=this.opts.element.val(),r=this.data();this.opts.element.val(this.id(e)),this.updateSelection(e),this.opts.element.trigger({type:"select2-selected",val:this.id(e),choice:e}),this.nextSearchTerm=this.opts.nextSearchTerm(e,this.search.val()),this.close(),t&&t.noFocus||!this.opts.shouldFocusInput(this)||this.focusser.focus(),a(n,this.id(e))||this.triggerChange({added:e,removed:r})}},updateSelection:function(e){var n,r,i=this.selection.find(".select2-chosen");this.selection.data("select2-data",e),i.empty(),null!==e&&(n=this.opts.formatSelection(e,i,this.opts.escapeMarkup)),n!==t&&i.append(n),r=this.opts.formatSelectionCssClass(e,i),r!==t&&i.addClass(r),this.selection.removeClass("select2-default"),this.opts.allowClear&&this.getPlaceholder()!==t&&this.container.addClass("select2-allowclear")},val:function(){var e,n=!1,r=null,i=this,o=this.data();if(0===arguments.length)return this.opts.element.val();if(e=arguments[0],arguments.length>1&&(n=arguments[1]),this.select)this.select.val(e).find("option").filter(function(){return this.selected}).each2(function(e,t){return r=i.optionToData(t),!1}),this.updateSelection(r),this.setPlaceholder(),n&&this.triggerChange({added:r,removed:o});else{if(!e&&0!==e)return void this.clear(n);if(this.opts.initSelection===t)throw new Error("cannot call val() if initSelection() is not defined");this.opts.element.val(e),this.opts.initSelection(this.opts.element,function(e){i.opts.element.val(e?i.id(e):""),i.updateSelection(e),i.setPlaceholder(),n&&i.triggerChange({added:e,removed:o})})}},clearSearch:function(){this.search.val(""),this.focusser.val("")},data:function(e){var n,r=!1;return 0===arguments.length?(n=this.selection.data("select2-data"),n==t&&(n=null),n):(arguments.length>1&&(r=arguments[1]),void(e?(n=this.data(),this.opts.element.val(e?this.id(e):""),this.updateSelection(e),r&&this.triggerChange({added:e,removed:n})):this.clear(r)))}}),L=C(D,{createContainer:function(){var t=e(document.createElement("div")).attr({"class":"select2-container select2-container-multi"}).html(["<ul class='select2-choices'>","  <li class='select2-search-field'>","    <label for='' class='select2-offscreen'></label>","    <input type='text' autocomplete='off' autocorrect='off' autocapitalize='off' spellcheck='false' class='select2-input'>","  </li>","</ul>","<div class='select2-drop select2-drop-multi select2-display-none'>","   <ul class='select2-results'>","   </ul>","</div>"].join(""));return t},prepareOpts:function(){var t=this.parent.prepareOpts.apply(this,arguments),n=this;return"select"===t.element.get(0).tagName.toLowerCase()?t.initSelection=function(e,t){var r=[];e.find("option").filter(function(){return this.selected&&!this.disabled}).each2(function(e,t){r.push(n.optionToData(t))}),t(r)}:"data"in t&&(t.initSelection=t.initSelection||function(n,r){var i=s(n.val(),t.separator),o=[];t.query({matcher:function(n,r,s){var u=e.grep(i,function(e){return a(e,t.id(s))}).length;return u&&o.push(s),u},callback:e.isFunction(r)?function(){for(var e=[],n=0;n<i.length;n++)for(var s=i[n],u=0;u<o.length;u++){var l=o[u];if(a(s,t.id(l))){e.push(l),o.splice(u,1);break}}r(e)}:e.noop})}),t},selectChoice:function(e){var t=this.container.find(".select2-search-choice-focus");t.length&&e&&e[0]==t[0]||(t.length&&this.opts.element.trigger("choice-deselected",t),t.removeClass("select2-search-choice-focus"),e&&e.length&&(this.close(),e.addClass("select2-search-choice-focus"),this.opts.element.trigger("choice-selected",e)))},destroy:function(){e("label[for='"+this.search.attr("id")+"']").attr("for",this.opts.element.attr("id")),this.parent.destroy.apply(this,arguments)},initContainer:function(){var t,n=".select2-choices";this.searchContainer=this.container.find(".select2-search-field"),this.selection=t=this.container.find(n);var r=this;this.selection.on("click",".select2-search-choice:not(.select2-locked)",function(){r.search[0].focus(),r.selectChoice(e(this))}),this.search.attr("id","s2id_autogen"+N()),this.search.prev().text(e("label[for='"+this.opts.element.attr("id")+"']").text()).attr("for",this.search.attr("id")),this.search.on("input paste",this.bind(function(){this.isInterfaceEnabled()&&(this.opened()||this.open())})),this.search.attr("tabindex",this.elementTabIndex),this.keydowns=0,this.search.on("keydown",this.bind(function(e){if(this.isInterfaceEnabled()){++this.keydowns;var n=t.find(".select2-search-choice-focus"),r=n.prev(".select2-search-choice:not(.select2-locked)"),i=n.next(".select2-search-choice:not(.select2-locked)"),o=m(this.search);if(n.length&&(e.which==S.LEFT||e.which==S.RIGHT||e.which==S.BACKSPACE||e.which==S.DELETE||e.which==S.ENTER)){var a=n;return e.which==S.LEFT&&r.length?a=r:e.which==S.RIGHT?a=i.length?i:null:e.which===S.BACKSPACE?this.unselect(n.first())&&(this.search.width(10),a=r.length?r:i):e.which==S.DELETE?this.unselect(n.first())&&(this.search.width(10),a=i.length?i:null):e.which==S.ENTER&&(a=null),this.selectChoice(a),g(e),void(a&&a.length||this.open())}if((e.which===S.BACKSPACE&&1==this.keydowns||e.which==S.LEFT)&&0==o.offset&&!o.length)return this.selectChoice(t.find(".select2-search-choice:not(.select2-locked)").last()),void g(e);if(this.selectChoice(null),this.opened())switch(e.which){case S.UP:case S.DOWN:return this.moveHighlight(e.which===S.UP?-1:1),void g(e);case S.ENTER:return this.selectHighlighted(),void g(e);case S.TAB:return this.selectHighlighted({noFocus:!0}),void this.close();case S.ESC:return this.cancel(e),void g(e)}if(e.which!==S.TAB&&!S.isControl(e)&&!S.isFunctionKey(e)&&e.which!==S.BACKSPACE&&e.which!==S.ESC){if(e.which===S.ENTER){if(this.opts.openOnEnter===!1)return;if(e.altKey||e.ctrlKey||e.shiftKey||e.metaKey)return}this.open(),(e.which===S.PAGE_UP||e.which===S.PAGE_DOWN)&&g(e),e.which===S.ENTER&&g(e)}}})),this.search.on("keyup",this.bind(function(){this.keydowns=0,this.resizeSearch()})),this.search.on("blur",this.bind(function(t){this.container.removeClass("select2-container-active"),this.search.removeClass("select2-focused"),this.selectChoice(null),this.opened()||this.clearSearch(),t.stopImmediatePropagation(),this.opts.element.trigger(e.Event("select2-blur"))})),this.container.on("click",n,this.bind(function(t){this.isInterfaceEnabled()&&(e(t.target).closest(".select2-search-choice").length>0||(this.selectChoice(null),this.clearPlaceholder(),this.container.hasClass("select2-container-active")||this.opts.element.trigger(e.Event("select2-focus")),this.open(),this.focusSearch(),t.preventDefault()))})),this.container.on("focus",n,this.bind(function(){this.isInterfaceEnabled()&&(this.container.hasClass("select2-container-active")||this.opts.element.trigger(e.Event("select2-focus")),this.container.addClass("select2-container-active"),this.dropdown.addClass("select2-drop-active"),this.clearPlaceholder())})),this.initContainerWidth(),this.opts.element.addClass("select2-offscreen"),this.clearSearch()},enableInterface:function(){this.parent.enableInterface.apply(this,arguments)&&this.search.prop("disabled",!this.isInterfaceEnabled())},initSelection:function(){if(""===this.opts.element.val()&&""===this.opts.element.text()&&(this.updateSelection([]),this.close(),this.clearSearch()),this.select||""!==this.opts.element.val()){var e=this;this.opts.initSelection.call(null,this.opts.element,function(n){n!==t&&null!==n&&(e.updateSelection(n),e.close(),e.clearSearch())})}},clearSearch:function(){var e=this.getPlaceholder(),n=this.getMaxSearchWidth();e!==t&&0===this.getVal().length&&this.search.hasClass("select2-focused")===!1?(this.search.val(e).addClass("select2-default"),this.search.width(n>0?n:this.container.css("width"))):this.search.val("").width(10)},clearPlaceholder:function(){this.search.hasClass("select2-default")&&this.search.val("").removeClass("select2-default")},opening:function(){this.clearPlaceholder(),this.resizeSearch(),this.parent.opening.apply(this,arguments),this.focusSearch(),""===this.search.val()&&this.nextSearchTerm!=t&&(this.search.val(this.nextSearchTerm),this.search.select()),this.updateResults(!0),this.search.focus(),this.opts.element.trigger(e.Event("select2-open"))},close:function(){this.opened()&&this.parent.close.apply(this,arguments)},focus:function(){this.close(),this.search.focus()},isFocused:function(){return this.search.hasClass("select2-focused")},updateSelection:function(t){var n=[],r=[],o=this;e(t).each(function(){i(o.id(this),n)<0&&(n.push(o.id(this)),r.push(this))}),t=r,this.selection.find(".select2-search-choice").remove(),e(t).each(function(){o.addSelectedChoice(this)}),o.postprocessResults()},tokenize:function(){var e=this.search.val();e=this.opts.tokenizer.call(this,e,this.data(),this.bind(this.onSelect),this.opts),null!=e&&e!=t&&(this.search.val(e),e.length>0&&this.open())},onSelect:function(e,n){this.triggerSelect(e)&&(this.addSelectedChoice(e),this.opts.element.trigger({type:"selected",val:this.id(e),choice:e}),this.nextSearchTerm=this.opts.nextSearchTerm(e,this.search.val()),this.clearSearch(),this.updateResults(),(this.select||!this.opts.closeOnSelect)&&this.postprocessResults(e,!1,this.opts.closeOnSelect===!0),this.opts.closeOnSelect?(this.close(),this.search.width(10)):this.countSelectableResults()>0?(this.search.width(10),this.resizeSearch(),this.getMaximumSelectionSize()>0&&this.val().length>=this.getMaximumSelectionSize()?this.updateResults(!0):this.nextSearchTerm!=t&&(this.search.val(this.nextSearchTerm),this.updateResults(),this.search.select()),this.positionDropdown()):(this.close(),this.search.width(10)),this.triggerChange({added:e}),n&&n.noFocus||this.focusSearch())},cancel:function(){this.close(),this.focusSearch()},addSelectedChoice:function(n){var r,i,o=!n.locked,a=e("<li class='select2-search-choice'>    <div></div>    <a href='#' class='select2-search-choice-close' tabindex='-1'></a></li>"),s=e("<li class='select2-search-choice select2-locked'><div></div></li>"),u=o?a:s,l=this.id(n),c=this.getVal();r=this.opts.formatSelection(n,u.find("div"),this.opts.escapeMarkup),r!=t&&u.find("div").replaceWith("<div>"+r+"</div>"),i=this.opts.formatSelectionCssClass(n,u.find("div")),i!=t&&u.addClass(i),o&&u.find(".select2-search-choice-close").on("mousedown",g).on("click dblclick",this.bind(function(t){this.isInterfaceEnabled()&&(this.unselect(e(t.target)),this.selection.find(".select2-search-choice-focus").removeClass("select2-search-choice-focus"),g(t),this.close(),this.focusSearch())})).on("focus",this.bind(function(){this.isInterfaceEnabled()&&(this.container.addClass("select2-container-active"),this.dropdown.addClass("select2-drop-active"))})),u.data("select2-data",n),u.insertBefore(this.searchContainer),c.push(l),this.setVal(c)},unselect:function(t){var n,r,o=this.getVal();if(t=t.closest(".select2-search-choice"),0===t.length)throw"Invalid argument: "+t+". Must be .select2-search-choice";if(n=t.data("select2-data")){var a=e.Event("select2-removing");if(a.val=this.id(n),a.choice=n,this.opts.element.trigger(a),a.isDefaultPrevented())return!1;for(;(r=i(this.id(n),o))>=0;)o.splice(r,1),this.setVal(o),this.select&&this.postprocessResults();return t.remove(),this.opts.element.trigger({type:"select2-removed",val:this.id(n),choice:n}),this.triggerChange({removed:n}),!0}},postprocessResults:function(e,t,n){var r=this.getVal(),o=this.results.find(".select2-result"),a=this.results.find(".select2-result-with-children"),s=this;o.each2(function(e,t){var n=s.id(t.data("select2-data"));i(n,r)>=0&&(t.addClass("select2-selected"),t.find(".select2-result-selectable").addClass("select2-selected"))}),a.each2(function(e,t){t.is(".select2-result-selectable")||0!==t.find(".select2-result-selectable:not(.select2-selected)").length||t.addClass("select2-selected")}),-1==this.highlight()&&n!==!1&&s.highlight(0),!this.opts.createSearchChoice&&!o.filter(".select2-result:not(.select2-selected)").length>0&&(!e||e&&!e.more&&0===this.results.find(".select2-no-results").length)&&P(s.opts.formatNoMatches,"formatNoMatches")&&this.results.append("<li class='select2-no-results'>"+A(s.opts.formatNoMatches,s.search.val())+"</li>")},getMaxSearchWidth:function(){return this.selection.width()-u(this.search)},resizeSearch:function(){var e,t,n,r,i,o=u(this.search);e=v(this.search)+10,t=this.search.offset().left,n=this.selection.width(),r=this.selection.offset().left,i=n-(t-r)-o,e>i&&(i=n-o),40>i&&(i=n-o),0>=i&&(i=e),this.search.width(Math.floor(i))},getVal:function(){var e;return this.select?(e=this.select.val(),null===e?[]:e):(e=this.opts.element.val(),s(e,this.opts.separator))},setVal:function(t){var n;this.select?this.select.val(t):(n=[],e(t).each(function(){i(this,n)<0&&n.push(this)}),this.opts.element.val(0===n.length?"":n.join(this.opts.separator)))},buildChangeDetails:function(e,t){for(var t=t.slice(0),e=e.slice(0),n=0;n<t.length;n++)for(var r=0;r<e.length;r++)a(this.opts.id(t[n]),this.opts.id(e[r]))&&(t.splice(n,1),n>0&&n--,e.splice(r,1),r--);return{added:t,removed:e}},val:function(n,r){var i,o=this;if(0===arguments.length)return this.getVal();if(i=this.data(),i.length||(i=[]),!n&&0!==n)return this.opts.element.val(""),this.updateSelection([]),this.clearSearch(),void(r&&this.triggerChange({added:this.data(),removed:i}));if(this.setVal(n),this.select)this.opts.initSelection(this.select,this.bind(this.updateSelection)),r&&this.triggerChange(this.buildChangeDetails(i,this.data()));else{if(this.opts.initSelection===t)throw new Error("val() cannot be called if initSelection() is not defined");this.opts.initSelection(this.opts.element,function(t){var n=e.map(t,o.id);o.setVal(n),o.updateSelection(t),o.clearSearch(),r&&o.triggerChange(o.buildChangeDetails(i,o.data()))})}this.clearSearch()},onSortStart:function(){if(this.select)throw new Error("Sorting of elements is not supported when attached to <select>. Attach to <input type='hidden'/> instead.");this.search.width(0),this.searchContainer.hide()},onSortEnd:function(){var t=[],n=this;this.searchContainer.show(),this.searchContainer.appendTo(this.searchContainer.parent()),this.resizeSearch(),this.selection.find(".select2-search-choice").each(function(){t.push(n.opts.id(e(this).data("select2-data")))}),this.setVal(t),this.triggerChange()},data:function(t,n){var r,i,o=this;return 0===arguments.length?this.selection.children(".select2-search-choice").map(function(){return e(this).data("select2-data")}).get():(i=this.data(),t||(t=[]),r=e.map(t,function(e){return o.opts.id(e)}),this.setVal(r),this.updateSelection(t),this.clearSearch(),n&&this.triggerChange(this.buildChangeDetails(i,this.data())),void 0)}}),e.fn.select2=function(){var n,r,o,a,s,u=Array.prototype.slice.call(arguments,0),l=["val","destroy","opened","open","close","focus","isFocused","container","dropdown","onSortStart","onSortEnd","enable","disable","readonly","positionDropdown","data","search"],c=["opened","isFocused","container","dropdown"],d=["val","data"],p={search:"externalSearch"};return this.each(function(){if(0===u.length||"object"==typeof u[0])n=0===u.length?{}:e.extend({},u[0]),n.element=e(this),"select"===n.element.get(0).tagName.toLowerCase()?s=n.element.prop("multiple"):(s=n.multiple||!1,"tags"in n&&(n.multiple=s=!0)),r=s?new window.Select2["class"].multi:new window.Select2["class"].single,r.init(n);else{if("string"!=typeof u[0])throw"Invalid arguments to select2 plugin: "+u;if(i(u[0],l)<0)throw"Unknown method: "+u[0];if(a=t,r=e(this).data("select2"),r===t)return;if(o=u[0],"container"===o?a=r.container:"dropdown"===o?a=r.dropdown:(p[o]&&(o=p[o]),a=r[o].apply(r,u.slice(1))),i(u[0],c)>=0||i(u[0],d)>=0&&1==u.length)return!1}}),a===t?this:a},e.fn.select2.defaults={width:"copy",loadMorePadding:0,closeOnSelect:!0,openOnEnter:!0,containerCss:{},dropdownCss:{},containerCssClass:"",dropdownCssClass:"",formatResult:function(e,t,n,r){var i=[];return E(e.text,n.term,i,r),i.join("")},formatSelection:function(e,n,r){return e?r(e.text):t},sortResults:function(e){return e},formatResultCssClass:function(e){return e.css},formatSelectionCssClass:function(){return t},formatMatches:function(e){return e+" results are available, use up and down arrow keys to navigate."},formatNoMatches:function(){return"No matches found"},formatInputTooShort:function(e,t){var n=t-e.length;return"Please enter "+n+" or more character"+(1==n?"":"s")},formatInputTooLong:function(e,t){var n=e.length-t;return"Please delete "+n+" character"+(1==n?"":"s")},formatSelectionTooBig:function(e){return"You can only select "+e+" item"+(1==e?"":"s")},formatLoadMore:function(){return"Loading more results…"},formatSearching:function(){return"Searching…"},minimumResultsForSearch:0,minimumInputLength:0,maximumInputLength:null,maximumSelectionSize:0,id:function(e){return e==t?null:e.id},matcher:function(e,t){return r(""+t).toUpperCase().indexOf(r(""+e).toUpperCase())>=0},separator:",",tokenSeparators:[],tokenizer:I,escapeMarkup:b,blurOnChange:!1,selectOnBlur:!1,adaptContainerCssClass:function(e){return e},adaptDropdownCssClass:function(){return null},nextSearchTerm:function(){return t},searchInputPlaceholder:"",createSearchChoicePosition:"top",shouldFocusInput:function(e){return e.opts.minimumResultsForSearch<0?!1:!0}},e.fn.select2.ajaxDefaults={transport:e.ajax,params:{type:"GET",cache:!1,dataType:"json"}},window.Select2={query:{ajax:R,local:T,tags:O},util:{debounce:d,markMatch:E,escapeMarkup:b,stripDiacritics:r},"class":{"abstract":D,single:F,multi:L}}}}(jQuery),define("select2",["jquery"],function(e){return function(){var t;return t||e.Select2}}(this)),define("h5.pubsub/Subscriptions",["require","exports","module"],function(e,t,n){function r(e){this.messageBroker=e,this.children={},this.subscriptions=[],this.subscriptionsPendingRemoval=[],this.sendingMessagesCount=0,this.removeSubscription=this.removeSubscription.bind(this)}n.exports=r;var i=[];r.TOKEN={SEPARATOR:".",ANY:"*",ALL:"**"},r.prototype.destroy=function(){for(var e=this.children,t=Object.keys(e),n=0,r=t.length;r>n;++n)e[t[n]].destroy();this.children=null,this.removeSubscriptions(),this.subscriptionsPendingRemoval=null,this.messageBroker=null},r.prototype.count=function(e,t){this.subscriptions.length&&(t[e]=this.subscriptions.length);var n=Object.keys(this.children),i=n.length;if(i){0!==e.length&&(e+=r.TOKEN.SEPARATOR);for(var o=0;i>o;++o){var a=n[o];this.children[a].count(e+a,t)}}},r.prototype.add=function(e){var t=this.splitTopic(e.getTopic());this.addSubscription(t,e)},r.prototype.remove=function(e){this.removeSubscriptions(this.splitTopic(e))},r.prototype.send=function(e,t,n){var r=this.splitTopic(e);this.sendMessage(r,e,t,n)},r.prototype.addSubscription=function(e,t){if(0===e.length)return this.subscriptions.push(t),t.on("cancel",this.removeSubscription),void(1===this.subscriptions.length&&this.messageBroker.emit("new topic",t.getTopic()));var n=this.children,i=e.shift();"undefined"==typeof n[i]&&(n[i]=new r(this.messageBroker)),n[i].addSubscription(e,t)},r.prototype.removeSubscriptions=function(e){var t,n;if("undefined"==typeof e||0===e.length){var r=this.subscriptions;if(!r.length)return;this.subscriptions=[];var i=r[0].getTopic();for(t=0,n=r.length;n>t;++t)r[t].cancel();return void this.messageBroker.emit("empty topic",i)}var o=e.shift();"undefined"!=typeof this.children[o]&&this.children[o].removeSubscriptions(e)},r.prototype.sendMessage=function(e,t,n,o){if(++this.sendingMessagesCount,"undefined"!=typeof this.children[r.TOKEN.ALL]&&this.children[r.TOKEN.ALL].sendMessage(i,t,n,o),0===e.length)for(var a=0,s=this.subscriptions.length;s>a;++a)this.subscriptions[a].send(t,n,o);else{var u=e.shift();"undefined"!=typeof this.children[r.TOKEN.ANY]&&this.children[r.TOKEN.ANY].sendMessage([].concat(e),t,n,o),"undefined"!=typeof this.children[u]&&this.children[u].sendMessage(e,t,n,o)}--this.sendingMessagesCount,this.removePendingSubscriptions()},r.prototype.splitTopic=function(e){var t=e.split(r.TOKEN.SEPARATOR).filter(function(e){return 0!==e.length});if(0===t.length)throw new Error("Invalid subscription topic: "+e);return t},r.prototype.removeSubscription=function(e){return this.messageBroker.emit("cancel",e),0!==this.subscriptions.length?1===this.subscriptions.length&&this.subscriptions[0]===e?(this.subscriptions.length=0,void this.messageBroker.emit("empty topic",e.getTopic())):void this.removeOrQueueRemoval(e):void 0},r.prototype.removeOrQueueRemoval=function(e){0===this.sendingMessagesCount?this.subscriptions.splice(this.subscriptions.indexOf(e),1):this.subscriptionsPendingRemoval.push(e)},r.prototype.removePendingSubscriptions=function(){var e=this.subscriptionsPendingRemoval,t=e.length;if(t&&!this.sendingMessagesCount){var n=this.subscriptions;if(t===n.length)return e.length=0,void(n.length=0);var r,i,o=[];for(r=0;t>r;++r)o.push(n.indexOf(e[r]));for(o.sort(function(e,t){return t-e}),r=0,i=o.length;i>r;++r)n.splice(o[r],1);e.length=0}}}),define("h5.pubsub/Subscription",["require","exports","module"],function(e,t,n){function r(e,t){this.cancelled=!1,this.id=e,this.topic=t,this.messageFilter=null,this.messageLimit=0,this.messageCount=0,this.doFilter=null,this.listeners={cancel:null,message:null}}n.exports=r,r.compileFilter=function(){throw new Error("Subscription.compileFilter() is not implemented!")},r.prototype.toJSON=function(){var e=this.getFilter();return"function"==typeof e&&(e=e.toString()),{id:this.getId(),topic:this.getTopic(),limit:this.getLimit(),filter:e}},r.prototype.getId=function(){return this.id},r.prototype.getTopic=function(){return this.topic},r.prototype.getFilter=function(){return this.messageFilter},r.prototype.setFilter=function(e){if(this.messageFilter=e,"function"==typeof e)this.doFilter=e;else if(this.doFilter=r.compileFilter(e),"function"!=typeof this.doFilter)throw new Error("Subscription.compileFilter() must return a function.");return this},r.prototype.getLimit=function(){return this.messageLimit},r.prototype.setLimit=function(e){if(1>e)throw new Error("Subscription limit must be greater than 0.");return this.messageLimit=e,this},r.prototype.getMessageCount=function(){return this.messageCount},r.prototype.on=function(e,t){if(this.cancelled)return this;var n=this.listeners[e],r=typeof n;if("undefined"===r)throw new Error("Unknown event: "+e);return"function"===r?this.listeners[e]=[n,t]:null===n?this.listeners[e]=t:this.listeners[e].push(t),this},r.prototype.off=function(e,t){if(this.cancelled)return this;var n=this.listeners[e],r=typeof n;if("undefined"===r)throw new Error("Unknown event: "+e);if("function"===r&&n===t)this.listeners[e]=null;else if("object"===r&&null!==n){for(var i=-1,o=n.length,a=0;o>a;++a)if(n[a]===t){i=a;break}-1!==i&&(n.splice(i,1),2===o&&(this.listeners[e]=n[0]))}return this},r.prototype.cancel=function(){this.cancelled||(this.cancelled=!0,this.emit("cancel",this),this.listeners=null,this.doFilter=null)},r.prototype.send=function(e,t,n){this.cancelled||null!==this.doFilter&&!this.doFilter(t,e,n,this)||(++this.messageCount,this.emit("message",t,e,n,this),this.messageCount===this.messageLimit&&this.cancel())},r.prototype.emit=function(e){var t=this.listeners[e];if(null!==t){var n=arguments.length;if("function"==typeof t)return void(5===n?t(arguments[1],arguments[2],arguments[3],arguments[4]):t(arguments[1]));for(var r=0,i=t.length;i>r;++r)5===n?t[r](arguments[1],arguments[2],arguments[3],arguments[4]):t[r](arguments[1])}}}),define("h5.pubsub/Sandbox",["require","exports","module"],function(e,t,n){function r(e){this.broker=e,this.subscriptions={},this.removeSubscription=this.removeSubscription.bind(this)}n.exports=r,r.prototype.destroy=function(){var e=this.subscriptions;null!==e&&Object.keys(e).forEach(function(t){e[t].cancel()}),this.subscriptions=null,this.broker=null},r.prototype.sandbox=function(){return new r(this)},r.prototype.publish=function(e,t,n){return this.broker.publish(e,t,n),this},r.prototype.subscribe=function(e,t){var n=this.broker.subscribe(e,t);return n.on("cancel",this.removeSubscription),this.subscriptions[n.getId()]=n,n},r.prototype.unsubscribe=function(e){var t=[],n=this.subscriptions;for(var r in n)n.hasOwnProperty(r)&&n[r].getTopic()===e&&t.push(r);for(var i=0,o=t.length;o>i;++i)n[t[i]].cancel();return this},r.prototype.removeSubscription=function(e){delete this.subscriptions[e.getId()]}}),define("h5.pubsub/MessageBroker",["require","exports","module","./Subscriptions","./Subscription","./Sandbox"],function(e,t,n){function r(){this.subscriptions=new i(this),this.nextSubscriptionId=0,this.listeners={subscribe:[],cancel:[],"new topic":[],"empty topic":[],message:[]}}var i=e("./Subscriptions"),o=e("./Subscription"),a=e("./Sandbox");n.exports=r,r.prototype.destroy=function(){this.subscriptions.destroy(),this.subscriptions=null,this.listeners=null},r.prototype.sandbox=function(){return new a(this)},r.prototype.publish=function(e,t,n){return"undefined"==typeof n&&(n={}),this.emit("message",e,t,n),this.subscriptions.send(e,t,n),this},r.prototype.subscribe=function(e,t){var n=new o(this.getNextSubscriptionId(),e);return"function"==typeof t&&n.on("message",t),this.subscriptions.add(n),this.emit("subscribe",n),n},r.prototype.unsubscribe=function(e){return this.subscriptions.remove(e),this},r.prototype.count=function(){var e={};if(null===this.subscriptions)return e;var t="";return this.subscriptions.count(t,e),e},r.prototype.on=function(e,t){var n=this.listeners[e],r=typeof n;if("undefined"===r)throw new Error("Unknown event: "+e);return n.push(t),this},r.prototype.off=function(e,t){var n=this.listeners[e],r=typeof n;if("undefined"===r)throw new Error("Unknown event: "+e);var i=n.indexOf(t);return-1!==i&&n.splice(i,1),this},r.prototype.emit=function(e,t){var n=this.listeners[e],r=typeof n;if("undefined"===r)throw new Error("Unknown event: "+e);if(!n.length)return this;var i=arguments.length;i>4&&(t=Array.prototype.slice.call(arguments),t.shift());for(var o=0,a=n.length;a>o;++o){var s=n[o];switch(i){case 4:s(arguments[1],arguments[2],arguments[3]);break;case 3:s(arguments[1],arguments[2]);break;case 2:s(arguments[1]);break;default:s.apply(null,t)}}return this},r.prototype.getNextSubscriptionId=function(){return(this.nextSubscriptionId++).toString(36)}}),define("app/broker",["h5.pubsub/MessageBroker"],function(e){var t=new e;return t.on("message",function(e,t){}),window.broker=t,t}),define("app/i18n",["underscore","moment","select2","app/broker"],function(e,t,n,r){function i(e,t,n){try{return l[e][t](n)}catch(i){if(l[e]&&l[e][t])throw i;return r.publish("i18n.missingKey",{domain:e,key:t}),t}}function o(e,t,n){l[e]=t,"string"==typeof n&&c.push(n),r.publish("i18n.registered",{domain:e,keys:t,moduleId:n})}function a(o,a){var s="en";e.isObject(i.config)&&(s=i.config.locale,i.config.locale=o),c.forEach(require.undef);var u=[].concat(c);"en"!==o&&u.unshift("moment-lang/"+o),u.unshift("select2-lang/"+o),require(u,function(){t.lang(o),n.lang(o),r.publish("i18n.reloaded",{oldLocale:s,newLocale:o}),e.isFunction(a)&&a()})}function s(e,t,n){function r(){return i(e,t,n)}return r.toString=r,r}function u(e,t){return"undefined"!=typeof l[e]&&"function"==typeof l[e][t]}var l={},c=[];return i.config=null,i.translate=i,i.register=o,i.reload=a,i.bound=s,i.has=u,window.i18n=i,i});var io="undefined"==typeof module?{}:module.exports;!function(){!function(e,t){var n=e;n.version="0.9.16",n.protocol=1,n.transports=[],n.j=[],n.sockets={},n.connect=function(e,r){var i,o,a=n.util.parseUri(e);t&&t.location&&(a.protocol=a.protocol||t.location.protocol.slice(0,-1),a.host=a.host||(t.document?t.document.domain:t.location.hostname),a.port=a.port||t.location.port),i=n.util.uniqueUri(a);var s={host:a.host,secure:"https"==a.protocol,port:a.port||("https"==a.protocol?443:80),query:a.query||""};return n.util.merge(s,r),(s["force new connection"]||!n.sockets[i])&&(o=new n.Socket(s)),!s["force new connection"]&&o&&(n.sockets[i]=o),o=o||n.sockets[i],o.of(a.path.length>1?a.path:"")}}("object"==typeof module?module.exports:this.io={},this),function(e,t){var n=e.util={},r=/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,i=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];n.parseUri=function(e){for(var t=r.exec(e||""),n={},o=14;o--;)n[i[o]]=t[o]||"";return n},n.uniqueUri=function(e){var n=e.protocol,r=e.host,i=e.port;return"document"in t?(r=r||document.domain,i=i||("https"==n&&"https:"!==document.location.protocol?443:document.location.port)):(r=r||"localhost",i||"https"!=n||(i=443)),(n||"http")+"://"+r+":"+(i||80)},n.query=function(e,t){var r=n.chunkQuery(e||""),i=[];n.merge(r,n.chunkQuery(t||""));for(var o in r)r.hasOwnProperty(o)&&i.push(o+"="+r[o]);
return i.length?"?"+i.join("&"):""},n.chunkQuery=function(e){for(var t,n={},r=e.split("&"),i=0,o=r.length;o>i;++i)t=r[i].split("="),t[0]&&(n[t[0]]=t[1]);return n};var o=!1;n.load=function(e){return"document"in t&&"complete"===document.readyState||o?e():void n.on(t,"load",e,!1)},n.on=function(e,t,n,r){e.attachEvent?e.attachEvent("on"+t,n):e.addEventListener&&e.addEventListener(t,n,r)},n.request=function(e){if(e&&"undefined"!=typeof XDomainRequest&&!n.ua.hasCORS)return new XDomainRequest;if("undefined"!=typeof XMLHttpRequest&&(!e||n.ua.hasCORS))return new XMLHttpRequest;if(!e)try{return new(window[["Active"].concat("Object").join("X")])("Microsoft.XMLHTTP")}catch(t){}return null},"undefined"!=typeof window&&n.load(function(){o=!0}),n.defer=function(e){return n.ua.webkit&&"undefined"==typeof importScripts?void n.load(function(){setTimeout(e,100)}):e()},n.merge=function(e,t,r,i){var o,a=i||[],s="undefined"==typeof r?2:r;for(o in t)t.hasOwnProperty(o)&&n.indexOf(a,o)<0&&("object"==typeof e[o]&&s?n.merge(e[o],t[o],s-1,a):(e[o]=t[o],a.push(t[o])));return e},n.mixin=function(e,t){n.merge(e.prototype,t.prototype)},n.inherit=function(e,t){function n(){}n.prototype=t.prototype,e.prototype=new n},n.isArray=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},n.intersect=function(e,t){for(var r=[],i=e.length>t.length?e:t,o=e.length>t.length?t:e,a=0,s=o.length;s>a;a++)~n.indexOf(i,o[a])&&r.push(o[a]);return r},n.indexOf=function(e,t,n){for(var r=e.length,n=0>n?0>n+r?0:n+r:n||0;r>n&&e[n]!==t;n++);return n>=r?-1:n},n.toArray=function(e){for(var t=[],n=0,r=e.length;r>n;n++)t.push(e[n]);return t},n.ua={},n.ua.hasCORS="undefined"!=typeof XMLHttpRequest&&function(){try{var e=new XMLHttpRequest}catch(t){return!1}return void 0!=e.withCredentials}(),n.ua.webkit="undefined"!=typeof navigator&&/webkit/i.test(navigator.userAgent),n.ua.iDevice="undefined"!=typeof navigator&&/iPad|iPhone|iPod/i.test(navigator.userAgent)}("undefined"!=typeof io?io:module.exports,this),function(e,t){function n(){}e.EventEmitter=n,n.prototype.on=function(e,n){return this.$events||(this.$events={}),this.$events[e]?t.util.isArray(this.$events[e])?this.$events[e].push(n):this.$events[e]=[this.$events[e],n]:this.$events[e]=n,this},n.prototype.addListener=n.prototype.on,n.prototype.once=function(e,t){function n(){r.removeListener(e,n),t.apply(this,arguments)}var r=this;return n.listener=t,this.on(e,n),this},n.prototype.removeListener=function(e,n){if(this.$events&&this.$events[e]){var r=this.$events[e];if(t.util.isArray(r)){for(var i=-1,o=0,a=r.length;a>o;o++)if(r[o]===n||r[o].listener&&r[o].listener===n){i=o;break}if(0>i)return this;r.splice(i,1),r.length||delete this.$events[e]}else(r===n||r.listener&&r.listener===n)&&delete this.$events[e]}return this},n.prototype.removeAllListeners=function(e){return void 0===e?(this.$events={},this):(this.$events&&this.$events[e]&&(this.$events[e]=null),this)},n.prototype.listeners=function(e){return this.$events||(this.$events={}),this.$events[e]||(this.$events[e]=[]),t.util.isArray(this.$events[e])||(this.$events[e]=[this.$events[e]]),this.$events[e]},n.prototype.emit=function(e){if(!this.$events)return!1;var n=this.$events[e];if(!n)return!1;var r=Array.prototype.slice.call(arguments,1);if("function"==typeof n)n.apply(this,r);else{if(!t.util.isArray(n))return!1;for(var i=n.slice(),o=0,a=i.length;a>o;o++)i[o].apply(this,r)}return!0}}("undefined"!=typeof io?io:module.exports,"undefined"!=typeof io?io:module.parent.exports),function(exports,nativeJSON){function f(e){return 10>e?"0"+e:e}function date(e){return isFinite(e.valueOf())?e.getUTCFullYear()+"-"+f(e.getUTCMonth()+1)+"-"+f(e.getUTCDate())+"T"+f(e.getUTCHours())+":"+f(e.getUTCMinutes())+":"+f(e.getUTCSeconds())+"Z":null}function quote(e){return escapable.lastIndex=0,escapable.test(e)?'"'+e.replace(escapable,function(e){var t=meta[e];return"string"==typeof t?t:"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+e+'"'}function str(e,t){var n,r,i,o,a,s=gap,u=t[e];switch(u instanceof Date&&(u=date(e)),"function"==typeof rep&&(u=rep.call(t,e,u)),typeof u){case"string":return quote(u);case"number":return isFinite(u)?String(u):"null";case"boolean":case"null":return String(u);case"object":if(!u)return"null";if(gap+=indent,a=[],"[object Array]"===Object.prototype.toString.apply(u)){for(o=u.length,n=0;o>n;n+=1)a[n]=str(n,u)||"null";return i=0===a.length?"[]":gap?"[\n"+gap+a.join(",\n"+gap)+"\n"+s+"]":"["+a.join(",")+"]",gap=s,i}if(rep&&"object"==typeof rep)for(o=rep.length,n=0;o>n;n+=1)"string"==typeof rep[n]&&(r=rep[n],i=str(r,u),i&&a.push(quote(r)+(gap?": ":":")+i));else for(r in u)Object.prototype.hasOwnProperty.call(u,r)&&(i=str(r,u),i&&a.push(quote(r)+(gap?": ":":")+i));return i=0===a.length?"{}":gap?"{\n"+gap+a.join(",\n"+gap)+"\n"+s+"}":"{"+a.join(",")+"}",gap=s,i}}if(nativeJSON&&nativeJSON.parse)return exports.JSON={parse:nativeJSON.parse,stringify:nativeJSON.stringify};var JSON=exports.JSON={},cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;JSON.stringify=function(e,t,n){var r;if(gap="",indent="","number"==typeof n)for(r=0;n>r;r+=1)indent+=" ";else"string"==typeof n&&(indent=n);if(rep=t,t&&"function"!=typeof t&&("object"!=typeof t||"number"!=typeof t.length))throw new Error("JSON.stringify");return str("",{"":e})},JSON.parse=function(text,reviver){function walk(e,t){var n,r,i=e[t];if(i&&"object"==typeof i)for(n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r=walk(i,n),void 0!==r?i[n]=r:delete i[n]);return reviver.call(e,t,i)}var j;if(text=String(text),cx.lastIndex=0,cx.test(text)&&(text=text.replace(cx,function(e){return"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})),/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return j=eval("("+text+")"),"function"==typeof reviver?walk({"":j},""):j;throw new SyntaxError("JSON.parse")}}("undefined"!=typeof io?io:module.exports,"undefined"!=typeof JSON?JSON:void 0),function(e,t){var n=e.parser={},r=n.packets=["disconnect","connect","heartbeat","message","json","event","ack","error","noop"],i=n.reasons=["transport not supported","client not handshaken","unauthorized"],o=n.advice=["reconnect"],a=t.JSON,s=t.util.indexOf;n.encodePacket=function(e){var t=s(r,e.type),n=e.id||"",u=e.endpoint||"",l=e.ack,c=null;switch(e.type){case"error":var d=e.reason?s(i,e.reason):"",p=e.advice?s(o,e.advice):"";(""!==d||""!==p)&&(c=d+(""!==p?"+"+p:""));break;case"message":""!==e.data&&(c=e.data);break;case"event":var f={name:e.name};e.args&&e.args.length&&(f.args=e.args),c=a.stringify(f);break;case"json":c=a.stringify(e.data);break;case"connect":e.qs&&(c=e.qs);break;case"ack":c=e.ackId+(e.args&&e.args.length?"+"+a.stringify(e.args):"")}var h=[t,n+("data"==l?"+":""),u];return null!==c&&void 0!==c&&h.push(c),h.join(":")},n.encodePayload=function(e){var t="";if(1==e.length)return e[0];for(var n=0,r=e.length;r>n;n++){var i=e[n];t+="�"+i.length+"�"+e[n]}return t};var u=/([^:]+):([0-9]+)?(\+)?:([^:]+)?:?([\s\S]*)?/;n.decodePacket=function(e){var t=e.match(u);if(!t)return{};var n=t[2]||"",e=t[5]||"",s={type:r[t[1]],endpoint:t[4]||""};switch(n&&(s.id=n,s.ack=t[3]?"data":!0),s.type){case"error":var t=e.split("+");s.reason=i[t[0]]||"",s.advice=o[t[1]]||"";break;case"message":s.data=e||"";break;case"event":try{var l=a.parse(e);s.name=l.name,s.args=l.args}catch(c){}s.args=s.args||[];break;case"json":try{s.data=a.parse(e)}catch(c){}break;case"connect":s.qs=e||"";break;case"ack":var t=e.match(/^([0-9]+)(\+)?(.*)/);if(t&&(s.ackId=t[1],s.args=[],t[3]))try{s.args=t[3]?a.parse(t[3]):[]}catch(c){}break;case"disconnect":case"heartbeat":}return s},n.decodePayload=function(e){if("�"==e.charAt(0)){for(var t=[],r=1,i="";r<e.length;r++)"�"==e.charAt(r)?(t.push(n.decodePacket(e.substr(r+1).substr(0,i))),r+=Number(i)+1,i=""):i+=e.charAt(r);return t}return[n.decodePacket(e)]}}("undefined"!=typeof io?io:module.exports,"undefined"!=typeof io?io:module.parent.exports),function(e,t){function n(e,t){this.socket=e,this.sessid=t}e.Transport=n,t.util.mixin(n,t.EventEmitter),n.prototype.heartbeats=function(){return!0},n.prototype.onData=function(e){if(this.clearCloseTimeout(),(this.socket.connected||this.socket.connecting||this.socket.reconnecting)&&this.setCloseTimeout(),""!==e){var n=t.parser.decodePayload(e);if(n&&n.length)for(var r=0,i=n.length;i>r;r++)this.onPacket(n[r])}return this},n.prototype.onPacket=function(e){return this.socket.setHeartbeatTimeout(),"heartbeat"==e.type?this.onHeartbeat():("connect"==e.type&&""==e.endpoint&&this.onConnect(),"error"==e.type&&"reconnect"==e.advice&&(this.isOpen=!1),this.socket.onPacket(e),this)},n.prototype.setCloseTimeout=function(){if(!this.closeTimeout){var e=this;this.closeTimeout=setTimeout(function(){e.onDisconnect()},this.socket.closeTimeout)}},n.prototype.onDisconnect=function(){return this.isOpen&&this.close(),this.clearTimeouts(),this.socket.onDisconnect(),this},n.prototype.onConnect=function(){return this.socket.onConnect(),this},n.prototype.clearCloseTimeout=function(){this.closeTimeout&&(clearTimeout(this.closeTimeout),this.closeTimeout=null)},n.prototype.clearTimeouts=function(){this.clearCloseTimeout(),this.reopenTimeout&&clearTimeout(this.reopenTimeout)},n.prototype.packet=function(e){this.send(t.parser.encodePacket(e))},n.prototype.onHeartbeat=function(){this.packet({type:"heartbeat"})},n.prototype.onOpen=function(){this.isOpen=!0,this.clearCloseTimeout(),this.socket.onOpen()},n.prototype.onClose=function(){this.isOpen=!1,this.socket.onClose(),this.onDisconnect()},n.prototype.prepareUrl=function(){var e=this.socket.options;return this.scheme()+"://"+e.host+":"+e.port+"/"+e.resource+"/"+t.protocol+"/"+this.name+"/"+this.sessid},n.prototype.ready=function(e,t){t.call(this)}}("undefined"!=typeof io?io:module.exports,"undefined"!=typeof io?io:module.parent.exports),function(e,t,n){function r(e){if(this.options={port:80,secure:!1,document:"document"in n?document:!1,resource:"socket.io",transports:t.transports,"connect timeout":1e4,"try multiple transports":!0,reconnect:!0,"reconnection delay":500,"reconnection limit":1/0,"reopen delay":3e3,"max reconnection attempts":10,"sync disconnect on unload":!1,"auto connect":!0,"flash policy port":10843,manualFlush:!1},t.util.merge(this.options,e),this.connected=!1,this.open=!1,this.connecting=!1,this.reconnecting=!1,this.namespaces={},this.buffer=[],this.doBuffer=!1,this.options["sync disconnect on unload"]&&(!this.isXDomain()||t.util.ua.hasCORS)){var r=this;t.util.on(n,"beforeunload",function(){r.disconnectSync()},!1)}this.options["auto connect"]&&this.connect()}function i(){}e.Socket=r,t.util.mixin(r,t.EventEmitter),r.prototype.of=function(e){return this.namespaces[e]||(this.namespaces[e]=new t.SocketNamespace(this,e),""!==e&&this.namespaces[e].packet({type:"connect"})),this.namespaces[e]},r.prototype.publish=function(){this.emit.apply(this,arguments);var e;for(var t in this.namespaces)this.namespaces.hasOwnProperty(t)&&(e=this.of(t),e.$emit.apply(e,arguments))},r.prototype.handshake=function(e){function n(t){t instanceof Error?(r.connecting=!1,r.onError(t.message)):e.apply(null,t.split(":"))}var r=this,o=this.options,a=["http"+(o.secure?"s":"")+":/",o.host+":"+o.port,o.resource,t.protocol,t.util.query(this.options.query,"t="+ +new Date)].join("/");if(this.isXDomain()&&!t.util.ua.hasCORS){var s=document.getElementsByTagName("script")[0],u=document.createElement("script");u.src=a+"&jsonp="+t.j.length,s.parentNode.insertBefore(u,s),t.j.push(function(e){n(e),u.parentNode.removeChild(u)})}else{var l=t.util.request();l.open("GET",a,!0),this.isXDomain()&&(l.withCredentials=!0),l.onreadystatechange=function(){4==l.readyState&&(l.onreadystatechange=i,200==l.status?n(l.responseText):403==l.status?r.onError(l.responseText):(r.connecting=!1,r.onError(l.responseText)))},l.send(null)}},r.prototype.getTransport=function(e){for(var n,r=e||this.transports,i=0;n=r[i];i++)if(t.Transport[n]&&t.Transport[n].check(this)&&(!this.isXDomain()||t.Transport[n].xdomainCheck(this)))return new t.Transport[n](this,this.sessionid);return null},r.prototype.connect=function(e){if(this.connecting)return this;var n=this;return n.connecting=!0,this.handshake(function(r,i,o,a){function s(e){return n.transport&&n.transport.clearTimeouts(),n.transport=n.getTransport(e),n.transport?void n.transport.ready(n,function(){n.connecting=!0,n.publish("connecting",n.transport.name),n.transport.open(),n.options["connect timeout"]&&(n.connectTimeoutTimer=setTimeout(function(){if(!n.connected&&(n.connecting=!1,n.options["try multiple transports"])){for(var e=n.transports;e.length>0&&e.splice(0,1)[0]!=n.transport.name;);e.length?s(e):n.publish("connect_failed")}},n.options["connect timeout"]))}):n.publish("connect_failed")}n.sessionid=r,n.closeTimeout=1e3*o,n.heartbeatTimeout=1e3*i,n.transports||(n.transports=n.origTransports=a?t.util.intersect(a.split(","),n.options.transports):n.options.transports),n.setHeartbeatTimeout(),s(n.transports),n.once("connect",function(){clearTimeout(n.connectTimeoutTimer),e&&"function"==typeof e&&e()})}),this},r.prototype.setHeartbeatTimeout=function(){if(clearTimeout(this.heartbeatTimeoutTimer),!this.transport||this.transport.heartbeats()){var e=this;this.heartbeatTimeoutTimer=setTimeout(function(){e.transport.onClose()},this.heartbeatTimeout)}},r.prototype.packet=function(e){return this.connected&&!this.doBuffer?this.transport.packet(e):this.buffer.push(e),this},r.prototype.setBuffer=function(e){this.doBuffer=e,!e&&this.connected&&this.buffer.length&&(this.options.manualFlush||this.flushBuffer())},r.prototype.flushBuffer=function(){this.transport.payload(this.buffer),this.buffer=[]},r.prototype.disconnect=function(){return(this.connected||this.connecting)&&(this.open&&this.of("").packet({type:"disconnect"}),this.onDisconnect("booted")),this},r.prototype.disconnectSync=function(){var e=t.util.request(),n=["http"+(this.options.secure?"s":"")+":/",this.options.host+":"+this.options.port,this.options.resource,t.protocol,"",this.sessionid].join("/")+"/?disconnect=1";e.open("GET",n,!1),e.send(null),this.onDisconnect("booted")},r.prototype.isXDomain=function(){var e=n.location.port||("https:"==n.location.protocol?443:80);return this.options.host!==n.location.hostname||this.options.port!=e},r.prototype.onConnect=function(){this.connected||(this.connected=!0,this.connecting=!1,this.doBuffer||this.setBuffer(!1),this.emit("connect"))},r.prototype.onOpen=function(){this.open=!0},r.prototype.onClose=function(){this.open=!1,clearTimeout(this.heartbeatTimeoutTimer)},r.prototype.onPacket=function(e){this.of(e.endpoint).onPacket(e)},r.prototype.onError=function(e){e&&e.advice&&"reconnect"===e.advice&&(this.connected||this.connecting)&&(this.disconnect(),this.options.reconnect&&this.reconnect()),this.publish("error",e&&e.reason?e.reason:e)},r.prototype.onDisconnect=function(e){var t=this.connected,n=this.connecting;this.connected=!1,this.connecting=!1,this.open=!1,(t||n)&&(this.transport.close(),this.transport.clearTimeouts(),t&&(this.publish("disconnect",e),"booted"!=e&&this.options.reconnect&&!this.reconnecting&&this.reconnect()))},r.prototype.reconnect=function(){function e(){if(n.connected){for(var e in n.namespaces)n.namespaces.hasOwnProperty(e)&&""!==e&&n.namespaces[e].packet({type:"connect"});n.publish("reconnect",n.transport.name,n.reconnectionAttempts)}clearTimeout(n.reconnectionTimer),n.removeListener("connect_failed",t),n.removeListener("connect",t),n.reconnecting=!1,delete n.reconnectionAttempts,delete n.reconnectionDelay,delete n.reconnectionTimer,delete n.redoTransports,n.options["try multiple transports"]=i}function t(){return n.reconnecting?n.connected?e():n.connecting&&n.reconnecting?n.reconnectionTimer=setTimeout(t,1e3):void(n.reconnectionAttempts++>=r?n.redoTransports?(n.publish("reconnect_failed"),e()):(n.on("connect_failed",t),n.options["try multiple transports"]=!0,n.transports=n.origTransports,n.transport=n.getTransport(),n.redoTransports=!0,n.connect()):(n.reconnectionDelay<o&&(n.reconnectionDelay*=2),n.connect(),n.publish("reconnecting",n.reconnectionDelay,n.reconnectionAttempts),n.reconnectionTimer=setTimeout(t,n.reconnectionDelay))):void 0}this.reconnecting=!0,this.reconnectionAttempts=0,this.reconnectionDelay=this.options["reconnection delay"];var n=this,r=this.options["max reconnection attempts"],i=this.options["try multiple transports"],o=this.options["reconnection limit"];this.options["try multiple transports"]=!1,this.reconnectionTimer=setTimeout(t,this.reconnectionDelay),this.on("connect",t)}}("undefined"!=typeof io?io:module.exports,"undefined"!=typeof io?io:module.parent.exports,this),function(e,t){function n(e,t){this.socket=e,this.name=t||"",this.flags={},this.json=new r(this,"json"),this.ackPackets=0,this.acks={}}function r(e,t){this.namespace=e,this.name=t}e.SocketNamespace=n,t.util.mixin(n,t.EventEmitter),n.prototype.$emit=t.EventEmitter.prototype.emit,n.prototype.of=function(){return this.socket.of.apply(this.socket,arguments)},n.prototype.packet=function(e){return e.endpoint=this.name,this.socket.packet(e),this.flags={},this},n.prototype.send=function(e,t){var n={type:this.flags.json?"json":"message",data:e};return"function"==typeof t&&(n.id=++this.ackPackets,n.ack=!0,this.acks[n.id]=t),this.packet(n)},n.prototype.emit=function(e){var t=Array.prototype.slice.call(arguments,1),n=t[t.length-1],r={type:"event",name:e};return"function"==typeof n&&(r.id=++this.ackPackets,r.ack="data",this.acks[r.id]=n,t=t.slice(0,t.length-1)),r.args=t,this.packet(r)},n.prototype.disconnect=function(){return""===this.name?this.socket.disconnect():(this.packet({type:"disconnect"}),this.$emit("disconnect")),this},n.prototype.onPacket=function(e){function n(){r.packet({type:"ack",args:t.util.toArray(arguments),ackId:e.id})}var r=this;switch(e.type){case"connect":this.$emit("connect");break;case"disconnect":""===this.name?this.socket.onDisconnect(e.reason||"booted"):this.$emit("disconnect",e.reason);break;case"message":case"json":var i=["message",e.data];"data"==e.ack?i.push(n):e.ack&&this.packet({type:"ack",ackId:e.id}),this.$emit.apply(this,i);break;case"event":var i=[e.name].concat(e.args);"data"==e.ack&&i.push(n),this.$emit.apply(this,i);break;case"ack":this.acks[e.ackId]&&(this.acks[e.ackId].apply(this,e.args),delete this.acks[e.ackId]);break;case"error":e.advice?this.socket.onError(e):"unauthorized"==e.reason?this.$emit("connect_failed",e.reason):this.$emit("error",e.reason)}},r.prototype.send=function(){this.namespace.flags[this.name]=!0,this.namespace.send.apply(this.namespace,arguments)},r.prototype.emit=function(){this.namespace.flags[this.name]=!0,this.namespace.emit.apply(this.namespace,arguments)}}("undefined"!=typeof io?io:module.exports,"undefined"!=typeof io?io:module.parent.exports),function(e,t,n){function r(){t.Transport.apply(this,arguments)}e.websocket=r,t.util.inherit(r,t.Transport),r.prototype.name="websocket",r.prototype.open=function(){var e,r=t.util.query(this.socket.options.query),i=this;return e||(e=n.MozWebSocket||n.WebSocket),this.websocket=new e(this.prepareUrl()+r),this.websocket.onopen=function(){i.onOpen(),i.socket.setBuffer(!1)},this.websocket.onmessage=function(e){i.onData(e.data)},this.websocket.onclose=function(){i.onClose(),i.socket.setBuffer(!0)},this.websocket.onerror=function(e){i.onError(e)},this},r.prototype.send=t.util.ua.iDevice?function(e){var t=this;return setTimeout(function(){t.websocket.send(e)},0),this}:function(e){return this.websocket.send(e),this},r.prototype.payload=function(e){for(var t=0,n=e.length;n>t;t++)this.packet(e[t]);return this},r.prototype.close=function(){return this.websocket.close(),this},r.prototype.onError=function(e){this.socket.onError(e)},r.prototype.scheme=function(){return this.socket.options.secure?"wss":"ws"},r.check=function(){return"WebSocket"in n&&!("__addTask"in WebSocket)||"MozWebSocket"in n},r.xdomainCheck=function(){return!0},t.transports.push("websocket")}("undefined"!=typeof io?io.Transport:module.exports,"undefined"!=typeof io?io:module.parent.exports,this),function(e,t,n){function r(e){e&&(t.Transport.apply(this,arguments),this.sendBuffer=[])}function i(){}e.XHR=r,t.util.inherit(r,t.Transport),r.prototype.open=function(){return this.socket.setBuffer(!1),this.onOpen(),this.get(),this.setCloseTimeout(),this},r.prototype.payload=function(e){for(var n=[],r=0,i=e.length;i>r;r++)n.push(t.parser.encodePacket(e[r]));this.send(t.parser.encodePayload(n))},r.prototype.send=function(e){return this.post(e),this},r.prototype.post=function(e){function t(){4==this.readyState&&(this.onreadystatechange=i,o.posting=!1,200==this.status?o.socket.setBuffer(!1):o.onClose())}function r(){this.onload=i,o.socket.setBuffer(!1)}var o=this;this.socket.setBuffer(!0),this.sendXHR=this.request("POST"),n.XDomainRequest&&this.sendXHR instanceof XDomainRequest?this.sendXHR.onload=this.sendXHR.onerror=r:this.sendXHR.onreadystatechange=t,this.sendXHR.send(e)},r.prototype.close=function(){return this.onClose(),this},r.prototype.request=function(e){var n=t.util.request(this.socket.isXDomain()),r=t.util.query(this.socket.options.query,"t="+ +new Date);if(n.open(e||"GET",this.prepareUrl()+r,!0),"POST"==e)try{n.setRequestHeader?n.setRequestHeader("Content-type","text/plain;charset=UTF-8"):n.contentType="text/plain"}catch(i){}return n},r.prototype.scheme=function(){return this.socket.options.secure?"https":"http"},r.check=function(e,r){try{var i=t.util.request(r),o=n.XDomainRequest&&i instanceof XDomainRequest,a=e&&e.options&&e.options.secure?"https:":"http:",s=n.location&&a!=n.location.protocol;if(i&&(!o||!s))return!0}catch(u){}return!1},r.xdomainCheck=function(e){return r.check(e,!0)}}("undefined"!=typeof io?io.Transport:module.exports,"undefined"!=typeof io?io:module.parent.exports,this),function(e,t,n){function r(){t.Transport.XHR.apply(this,arguments)}function i(){}e["xhr-polling"]=r,t.util.inherit(r,t.Transport.XHR),t.util.merge(r,t.Transport.XHR),r.prototype.name="xhr-polling",r.prototype.heartbeats=function(){return!1},r.prototype.open=function(){var e=this;return t.Transport.XHR.prototype.open.call(e),!1},r.prototype.get=function(){function e(){4==this.readyState&&(this.onreadystatechange=i,200==this.status?(o.onData(this.responseText),o.get()):o.onClose())}function t(){this.onload=i,this.onerror=i,o.retryCounter=1,o.onData(this.responseText),o.get()}function r(){o.retryCounter++,!o.retryCounter||o.retryCounter>3?o.onClose():o.get()}if(this.isOpen){var o=this;this.xhr=this.request(),n.XDomainRequest&&this.xhr instanceof XDomainRequest?(this.xhr.onload=t,this.xhr.onerror=r):this.xhr.onreadystatechange=e,this.xhr.send(null)}},r.prototype.onClose=function(){if(t.Transport.XHR.prototype.onClose.call(this),this.xhr){this.xhr.onreadystatechange=this.xhr.onload=this.xhr.onerror=i;try{this.xhr.abort()}catch(e){}this.xhr=null}},r.prototype.ready=function(e,n){var r=this;t.util.defer(function(){n.call(r)})},t.transports.push("xhr-polling")}("undefined"!=typeof io?io.Transport:module.exports,"undefined"!=typeof io?io:module.parent.exports,this),"function"==typeof define&&define.amd&&define("socket.io",[],function(){return io})}(),define("app/core/SocketSandbox",["underscore"],function(e){function t(e){if(this.socket=e,this.listeners={destroy:[]},e instanceof t){var n=this;this.socket.on("destroy",function(){n.destroy()})}}return t.prototype.destroy=function(){var t=this.listeners;if(null!=t){var n=t.destroy;if(e.isArray(n))for(var r=0,i=n.length;i>r;++r)n[r].call(this);delete this.listeners.destroy;for(var o=Object.keys(t),a=0,s=o.length;s>a;++a)for(var u=o[a],l=t[u],c=0,d=l.length;d>c;++c)this.socket.off(u,l[c]);this.listeners=null,this.socket=null}},t.prototype.sandbox=function(){return new t(this)},t.prototype.getId=function(){return this.socket.getId()},t.prototype.isConnected=function(){return this.socket.isConnected()},t.prototype.on=function(t,n){var r=this.listeners[t];return e.isUndefined(r)&&(r=this.listeners[t]=[]),r.push(n),"destroy"!==t&&this.socket.on(t,n),this},t.prototype.off=function(t,n){var r=this.listeners[t];if(e.isUndefined(r))return this;if(e.isUndefined(n))delete this.listeners[t];else{var i=e.indexOf(r,n);if(-1===i)return this;r.splice(i,1),0===r.length&&delete this.listeners[t]}return"destroy"!==t&&this.socket.off(t,n),this},t.prototype.emit=function(){var e=Array.prototype.slice.call(arguments),t=e.length-1;return e[t]=this.wrapCallback(e[t]),this.socket.emit.apply(this.socket,e),this},t.prototype.send=function(e,t){return this.socket.send(e,this.wrapCallback(t)),this},t.prototype.wrapCallback=function(t){if(!e.isFunction(t))return t;var n=this;return function(){null!==n.socket&&t.apply(this,arguments)}},t}),define("app/core/Socket",["app/core/SocketSandbox"],function(e){function t(e){this.sio=e}return t.prototype.sandbox=function(){return new e(this)},t.prototype.getId=function(){return this.sio.socket.sessionid},t.prototype.isConnected=function(){return this.sio.socket.connected},t.prototype.connect=function(){this.isConnected()||this.sio.socket.connecting||this.sio.socket.connect()},t.prototype.reconnect=function(){this.isConnected()||this.sio.socket.reconnecting||this.sio.socket.reconnect()},t.prototype.on=function(e,t){return this.sio.addListener(e,t),this},t.prototype.off=function(e,t){return"undefined"==typeof t?this.sio.removeAllListeners(e):this.sio.removeListener(e,t),this},t.prototype.emit=function(){return this.sio.json.emit.apply(this.sio.json,arguments),this},t.prototype.send=function(e,t){return this.sio.json.send(e,t),this},t}),define("app/socket",["underscore","socket.io","app/broker","app/core/Socket"],function(e,t,n,r){function i(e){""!==e||a||(o.off("error",i),o.reconnect())}var o=new r(t.connect("",{resource:"socket.io",transports:["websocket"],"auto connect":!1,"connect timeout":5e3,reconnect:!0,"reconnection delay":e.random(100,500),"reconnection limit":e.random(4e3,8e3),"max reconnection attempts":1/0})),a=!1,s=!1;return o.on("connecting",function(){n.publish("socket.connecting",!1)}),o.on("connect",function(){a||(a=!0,n.publish("socket.connected"))}),o.on("connect_failed",function(){n.publish("socket.connectFailed",!1)}),o.on("message",function(e){n.publish("socket.message",e)}),o.on("disconnect",function(){n.publish("socket.disconnected")}),o.on("reconnecting",function(){s=!0,n.publish("socket.connecting",!0)}),o.on("reconnect",function(){s=!1,n.publish("socket.connected",!0)}),o.on("reconnect_failed",function(){s=!1,n.publish("socket.connectFailed",!0)}),o.on("error",i),o.on("error",function(){s&&n.publish("socket.connectFailed",!0)}),window.socket=o,o}),function(){var e,t=this,n=t.Backbone,r=[],i=r.push,o=r.slice,a=r.splice;e="undefined"!=typeof exports?exports:t.Backbone={},e.VERSION="1.0.0";var s=t._;s||"undefined"==typeof require||(s=require("underscore")),e.$=t.jQuery||t.Zepto||t.ender||t.$,e.noConflict=function(){return t.Backbone=n,this},e.emulateHTTP=!1,e.emulateJSON=!1;var u=e.Events={on:function(e,t,n){if(!c(this,"on",e,[t,n])||!t)return this;this._events||(this._events={});var r=this._events[e]||(this._events[e]=[]);return r.push({callback:t,context:n,ctx:n||this}),this},once:function(e,t,n){if(!c(this,"once",e,[t,n])||!t)return this;var r=this,i=s.once(function(){r.off(e,i),t.apply(this,arguments)});return i._callback=t,this.on(e,i,n)},off:function(e,t,n){var r,i,o,a,u,l,d,p;if(!this._events||!c(this,"off",e,[t,n]))return this;if(!e&&!t&&!n)return this._events={},this;for(a=e?[e]:s.keys(this._events),u=0,l=a.length;l>u;u++)if(e=a[u],o=this._events[e]){if(this._events[e]=r=[],t||n)for(d=0,p=o.length;p>d;d++)i=o[d],(t&&t!==i.callback&&t!==i.callback._callback||n&&n!==i.context)&&r.push(i);r.length||delete this._events[e]}return this},trigger:function(e){if(!this._events)return this;var t=o.call(arguments,1);if(!c(this,"trigger",e,t))return this;var n=this._events[e],r=this._events.all;return n&&d(n,t),r&&d(r,arguments),this},stopListening:function(e,t,n){var r=this._listeners;if(!r)return this;var i=!t&&!n;"object"==typeof t&&(n=this),e&&((r={})[e._listenerId]=e);for(var o in r)r[o].off(t,n,this),i&&delete this._listeners[o];return this}},l=/\s+/,c=function(e,t,n,r){if(!n)return!0;if("object"==typeof n){for(var i in n)e[t].apply(e,[i,n[i]].concat(r));return!1}if(l.test(n)){for(var o=n.split(l),a=0,s=o.length;s>a;a++)e[t].apply(e,[o[a]].concat(r));return!1}return!0},d=function(e,t){var n,r=-1,i=e.length,o=t[0],a=t[1],s=t[2];switch(t.length){case 0:for(;++r<i;)(n=e[r]).callback.call(n.ctx);return;case 1:for(;++r<i;)(n=e[r]).callback.call(n.ctx,o);return;case 2:for(;++r<i;)(n=e[r]).callback.call(n.ctx,o,a);return;case 3:for(;++r<i;)(n=e[r]).callback.call(n.ctx,o,a,s);return;default:for(;++r<i;)(n=e[r]).callback.apply(n.ctx,t)}},p={listenTo:"on",listenToOnce:"once"};s.each(p,function(e,t){u[t]=function(t,n,r){var i=this._listeners||(this._listeners={}),o=t._listenerId||(t._listenerId=s.uniqueId("l"));return i[o]=t,"object"==typeof n&&(r=this),t[e](n,r,this),this}}),u.bind=u.on,u.unbind=u.off,s.extend(e,u);var f=e.Model=function(e,t){var n,r=e||{};t||(t={}),this.cid=s.uniqueId("c"),this.attributes={},s.extend(this,s.pick(t,h)),t.parse&&(r=this.parse(r,t)||{}),(n=s.result(this,"defaults"))&&(r=s.defaults({},r,n)),this.set(r,t),this.changed={},this.initialize.apply(this,arguments)},h=["url","urlRoot","collection"];s.extend(f.prototype,u,{changed:null,validationError:null,idAttribute:"id",initialize:function(){},toJSON:function(){return s.clone(this.attributes)},sync:function(){return e.sync.apply(this,arguments)},get:function(e){return this.attributes[e]},escape:function(e){return s.escape(this.get(e))},has:function(e){return null!=this.get(e)},set:function(e,t,n){var r,i,o,a,u,l,c,d;if(null==e)return this;if("object"==typeof e?(i=e,n=t):(i={})[e]=t,n||(n={}),!this._validate(i,n))return!1;o=n.unset,u=n.silent,a=[],l=this._changing,this._changing=!0,l||(this._previousAttributes=s.clone(this.attributes),this.changed={}),d=this.attributes,c=this._previousAttributes,this.idAttribute in i&&(this.id=i[this.idAttribute]);for(r in i)t=i[r],s.isEqual(d[r],t)||a.push(r),s.isEqual(c[r],t)?delete this.changed[r]:this.changed[r]=t,o?delete d[r]:d[r]=t;if(!u){a.length&&(this._pending=!0);for(var p=0,f=a.length;f>p;p++)this.trigger("change:"+a[p],this,d[a[p]],n)}if(l)return this;if(!u)for(;this._pending;)this._pending=!1,this.trigger("change",this,n);return this._pending=!1,this._changing=!1,this},unset:function(e,t){return this.set(e,void 0,s.extend({},t,{unset:!0}))},clear:function(e){var t={};for(var n in this.attributes)t[n]=void 0;return this.set(t,s.extend({},e,{unset:!0}))},hasChanged:function(e){return null==e?!s.isEmpty(this.changed):s.has(this.changed,e)},changedAttributes:function(e){if(!e)return this.hasChanged()?s.clone(this.changed):!1;var t,n=!1,r=this._changing?this._previousAttributes:this.attributes;for(var i in e)s.isEqual(r[i],t=e[i])||((n||(n={}))[i]=t);return n},previous:function(e){return null!=e&&this._previousAttributes?this._previousAttributes[e]:null},previousAttributes:function(){return s.clone(this._previousAttributes)},fetch:function(e){e=e?s.clone(e):{},void 0===e.parse&&(e.parse=!0);var t=this,n=e.success;return e.success=function(r){return t.set(t.parse(r,e),e)?(n&&n(t,r,e),void t.trigger("sync",t,r,e)):!1},z(this,e),this.sync("read",this,e)},save:function(e,t,n){var r,i,o,a=this.attributes;if(null==e||"object"==typeof e?(r=e,n=t):(r={})[e]=t,!(!r||n&&n.wait||this.set(r,n)))return!1;if(n=s.extend({validate:!0},n),!this._validate(r,n))return!1;r&&n.wait&&(this.attributes=s.extend({},a,r)),void 0===n.parse&&(n.parse=!0);var u=this,l=n.success;return n.success=function(e){u.attributes=a;
var t=u.parse(e,n);return n.wait&&(t=s.extend(r||{},t)),s.isObject(t)&&!u.set(t,n)?!1:(l&&l(u,e,n),void u.trigger("sync",u,e,n))},z(this,n),i=this.isNew()?"create":n.patch?"patch":"update","patch"===i&&(n.attrs=r),o=this.sync(i,this,n),r&&n.wait&&(this.attributes=a),o},destroy:function(e){e=e?s.clone(e):{};var t=this,n=e.success,r=function(){t.trigger("destroy",t,t.collection,e)};if(e.success=function(i){(e.wait||t.isNew())&&r(),n&&n(t,i,e),t.isNew()||t.trigger("sync",t,i,e)},this.isNew())return e.success(),!1;z(this,e);var i=this.sync("delete",this,e);return e.wait||r(),i},url:function(){var e=s.result(this,"urlRoot")||s.result(this.collection,"url")||_();return this.isNew()?e:e+("/"===e.charAt(e.length-1)?"":"/")+encodeURIComponent(this.id)},parse:function(e){return e},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return null==this.id},isValid:function(e){return this._validate({},s.extend(e||{},{validate:!0}))},_validate:function(e,t){if(!t.validate||!this.validate)return!0;e=s.extend({},this.attributes,e);var n=this.validationError=this.validate(e,t)||null;return n?(this.trigger("invalid",this,n,s.extend(t||{},{validationError:n})),!1):!0}});var m=["keys","values","pairs","invert","pick","omit"];s.each(m,function(e){f.prototype[e]=function(){var t=o.call(arguments);return t.unshift(this.attributes),s[e].apply(s,t)}});var g=e.Collection=function(e,t){t||(t={}),t.url&&(this.url=t.url),t.model&&(this.model=t.model),void 0!==t.comparator&&(this.comparator=t.comparator),this._reset(),this.initialize.apply(this,arguments),e&&this.reset(e,s.extend({silent:!0},t))},y={add:!0,remove:!0,merge:!0},v={add:!0,merge:!1,remove:!1};s.extend(g.prototype,u,{model:f,initialize:function(){},toJSON:function(e){return this.map(function(t){return t.toJSON(e)})},sync:function(){return e.sync.apply(this,arguments)},add:function(e,t){return this.set(e,s.defaults(t||{},v))},remove:function(e,t){e=s.isArray(e)?e.slice():[e],t||(t={});var n,r,i,o;for(n=0,r=e.length;r>n;n++)o=this.get(e[n]),o&&(delete this._byId[o.id],delete this._byId[o.cid],i=this.indexOf(o),this.models.splice(i,1),this.length--,t.silent||(t.index=i,o.trigger("remove",o,this,t)),this._removeReference(o));return this},set:function(e,t){t=s.defaults(t||{},y),t.parse&&(e=this.parse(e,t)),s.isArray(e)||(e=e?[e]:[]);var n,r,o,u,l,c=t.at,d=this.comparator&&null==c&&t.sort!==!1,p=s.isString(this.comparator)?this.comparator:null,f=[],h=[],m={};for(n=0,r=e.length;r>n;n++)(o=this._prepareModel(e[n],t))&&((u=this.get(o))?(t.remove&&(m[u.cid]=!0),t.merge&&(u.set(o.attributes,t),d&&!l&&u.hasChanged(p)&&(l=!0))):t.add&&(f.push(o),o.on("all",this._onModelEvent,this),this._byId[o.cid]=o,null!=o.id&&(this._byId[o.id]=o)));if(t.remove){for(n=0,r=this.length;r>n;++n)m[(o=this.models[n]).cid]||h.push(o);h.length&&this.remove(h,t)}if(f.length&&(d&&(l=!0),this.length+=f.length,null!=c?a.apply(this.models,[c,0].concat(f)):i.apply(this.models,f)),l&&this.sort({silent:!0}),t.silent)return this;for(n=0,r=f.length;r>n;n++)(o=f[n]).trigger("add",o,this,t);return l&&this.trigger("sort",this,t),this},reset:function(e,t){t||(t={});for(var n=0,r=this.models.length;r>n;n++)this._removeReference(this.models[n]);return t.previousModels=this.models,this._reset(),this.add(e,s.extend({silent:!0},t)),t.silent||this.trigger("reset",this,t),this},push:function(e,t){return e=this._prepareModel(e,t),this.add(e,s.extend({at:this.length},t)),e},pop:function(e){var t=this.at(this.length-1);return this.remove(t,e),t},unshift:function(e,t){return e=this._prepareModel(e,t),this.add(e,s.extend({at:0},t)),e},shift:function(e){var t=this.at(0);return this.remove(t,e),t},slice:function(e,t){return this.models.slice(e,t)},get:function(e){return null==e?void 0:this._byId[null!=e.id?e.id:e.cid||e]},at:function(e){return this.models[e]},where:function(e,t){return s.isEmpty(e)?t?void 0:[]:this[t?"find":"filter"](function(t){for(var n in e)if(e[n]!==t.get(n))return!1;return!0})},findWhere:function(e){return this.where(e,!0)},sort:function(e){if(!this.comparator)throw new Error("Cannot sort a set without a comparator");return e||(e={}),s.isString(this.comparator)||1===this.comparator.length?this.models=this.sortBy(this.comparator,this):this.models.sort(s.bind(this.comparator,this)),e.silent||this.trigger("sort",this,e),this},sortedIndex:function(e,t,n){t||(t=this.comparator);var r=s.isFunction(t)?t:function(e){return e.get(t)};return s.sortedIndex(this.models,e,r,n)},pluck:function(e){return s.invoke(this.models,"get",e)},fetch:function(e){e=e?s.clone(e):{},void 0===e.parse&&(e.parse=!0);var t=e.success,n=this;return e.success=function(r){var i=e.reset?"reset":"set";n[i](r,e),t&&t(n,r,e),n.trigger("sync",n,r,e)},z(this,e),this.sync("read",this,e)},create:function(e,t){if(t=t?s.clone(t):{},!(e=this._prepareModel(e,t)))return!1;t.wait||this.add(e,t);var n=this,r=t.success;return t.success=function(i){t.wait&&n.add(e,t),r&&r(e,i,t)},e.save(null,t),e},parse:function(e){return e},clone:function(){return new this.constructor(this.models)},_reset:function(){this.length=0,this.models=[],this._byId={}},_prepareModel:function(e,t){if(e instanceof f)return e.collection||(e.collection=this),e;t||(t={}),t.collection=this;var n=new this.model(e,t);return n._validate(e,t)?n:(this.trigger("invalid",this,e,t),!1)},_removeReference:function(e){this===e.collection&&delete e.collection,e.off("all",this._onModelEvent,this)},_onModelEvent:function(e,t,n,r){("add"!==e&&"remove"!==e||n===this)&&("destroy"===e&&this.remove(t,r),t&&e==="change:"+t.idAttribute&&(delete this._byId[t.previous(t.idAttribute)],null!=t.id&&(this._byId[t.id]=t)),this.trigger.apply(this,arguments))}});var w=["forEach","each","map","collect","reduce","foldl","inject","reduceRight","foldr","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","toArray","size","first","head","take","initial","rest","tail","drop","last","without","indexOf","shuffle","lastIndexOf","isEmpty","chain"];s.each(w,function(e){g.prototype[e]=function(){var t=o.call(arguments);return t.unshift(this.models),s[e].apply(s,t)}});var E=["groupBy","countBy","sortBy"];s.each(E,function(e){g.prototype[e]=function(t,n){var r=s.isFunction(t)?t:function(e){return e.get(t)};return s[e](this.models,r,n)}});var b=e.View=function(e){this.cid=s.uniqueId("view"),this._configure(e||{}),this._ensureElement(),this.initialize.apply(this,arguments),this.delegateEvents()},R=/^(\S+)\s*(.*)$/,T=["model","collection","el","id","attributes","className","tagName","events"];s.extend(b.prototype,u,{tagName:"div",$:function(e){return this.$el.find(e)},initialize:function(){},render:function(){return this},remove:function(){return this.$el.remove(),this.stopListening(),this},setElement:function(t,n){return this.$el&&this.undelegateEvents(),this.$el=t instanceof e.$?t:e.$(t),this.el=this.$el[0],n!==!1&&this.delegateEvents(),this},delegateEvents:function(e){if(!e&&!(e=s.result(this,"events")))return this;this.undelegateEvents();for(var t in e){var n=e[t];if(s.isFunction(n)||(n=this[e[t]]),n){var r=t.match(R),i=r[1],o=r[2];n=s.bind(n,this),i+=".delegateEvents"+this.cid,""===o?this.$el.on(i,n):this.$el.on(i,o,n)}}return this},undelegateEvents:function(){return this.$el.off(".delegateEvents"+this.cid),this},_configure:function(e){this.options&&(e=s.extend({},s.result(this,"options"),e)),s.extend(this,s.pick(e,T)),this.options=e},_ensureElement:function(){if(this.el)this.setElement(s.result(this,"el"),!1);else{var t=s.extend({},s.result(this,"attributes"));this.id&&(t.id=s.result(this,"id")),this.className&&(t["class"]=s.result(this,"className"));var n=e.$("<"+s.result(this,"tagName")+">").attr(t);this.setElement(n,!1)}}}),e.sync=function(t,n,r){var i=O[t];s.defaults(r||(r={}),{emulateHTTP:e.emulateHTTP,emulateJSON:e.emulateJSON});var o={type:i,dataType:"json"};if(r.url||(o.url=s.result(n,"url")||_()),null!=r.data||!n||"create"!==t&&"update"!==t&&"patch"!==t||(o.contentType="application/json",o.data=JSON.stringify(r.attrs||n.toJSON(r))),r.emulateJSON&&(o.contentType="application/x-www-form-urlencoded",o.data=o.data?{model:o.data}:{}),r.emulateHTTP&&("PUT"===i||"DELETE"===i||"PATCH"===i)){o.type="POST",r.emulateJSON&&(o.data._method=i);var a=r.beforeSend;r.beforeSend=function(e){return e.setRequestHeader("X-HTTP-Method-Override",i),a?a.apply(this,arguments):void 0}}"GET"===o.type||r.emulateJSON||(o.processData=!1),"PATCH"!==o.type||!window.ActiveXObject||window.external&&window.external.msActiveXFilteringEnabled||(o.xhr=function(){return new ActiveXObject("Microsoft.XMLHTTP")});var u=r.xhr=e.ajax(s.extend(o,r));return n.trigger("request",n,u,r),u};var O={create:"POST",update:"PUT",patch:"PATCH","delete":"DELETE",read:"GET"};e.ajax=function(){return e.$.ajax.apply(e.$,arguments)};var P=e.Router=function(e){e||(e={}),e.routes&&(this.routes=e.routes),this._bindRoutes(),this.initialize.apply(this,arguments)},A=/\((.*?)\)/g,k=/(\(\?)?:\w+/g,I=/\*\w+/g,C=/[\-{}\[\]+?.,\\\^$|#\s]/g;s.extend(P.prototype,u,{initialize:function(){},route:function(t,n,r){s.isRegExp(t)||(t=this._routeToRegExp(t)),s.isFunction(n)&&(r=n,n=""),r||(r=this[n]);var i=this;return e.history.route(t,function(o){var a=i._extractParameters(t,o);r&&r.apply(i,a),i.trigger.apply(i,["route:"+n].concat(a)),i.trigger("route",n,a),e.history.trigger("route",i,n,a)}),this},navigate:function(t,n){return e.history.navigate(t,n),this},_bindRoutes:function(){if(this.routes){this.routes=s.result(this,"routes");for(var e,t=s.keys(this.routes);null!=(e=t.pop());)this.route(e,this.routes[e])}},_routeToRegExp:function(e){return e=e.replace(C,"\\$&").replace(A,"(?:$1)?").replace(k,function(e,t){return t?e:"([^/]+)"}).replace(I,"(.*?)"),new RegExp("^"+e+"$")},_extractParameters:function(e,t){var n=e.exec(t).slice(1);return s.map(n,function(e){return e?decodeURIComponent(e):null})}});var S=e.History=function(){this.handlers=[],s.bindAll(this,"checkUrl"),"undefined"!=typeof window&&(this.location=window.location,this.history=window.history)},D=/^[#\/]|\s+$/g,F=/^\/+|\/+$/g,L=/msie [\w.]+/,N=/\/$/;S.started=!1,s.extend(S.prototype,u,{interval:50,getHash:function(e){var t=(e||this).location.href.match(/#(.*)$/);return t?t[1]:""},getFragment:function(e,t){if(null==e)if(this._hasPushState||!this._wantsHashChange||t){e=this.location.pathname;var n=this.root.replace(N,"");e.indexOf(n)||(e=e.substr(n.length))}else e=this.getHash();return e.replace(D,"")},start:function(t){if(S.started)throw new Error("Backbone.history has already been started");S.started=!0,this.options=s.extend({},{root:"/"},this.options,t),this.root=this.options.root,this._wantsHashChange=this.options.hashChange!==!1,this._wantsPushState=!!this.options.pushState,this._hasPushState=!!(this.options.pushState&&this.history&&this.history.pushState);var n=this.getFragment(),r=document.documentMode,i=L.exec(navigator.userAgent.toLowerCase())&&(!r||7>=r);this.root=("/"+this.root+"/").replace(F,"/"),i&&this._wantsHashChange&&(this.iframe=e.$('<iframe src="javascript:0" tabindex="-1" />').hide().appendTo("body")[0].contentWindow,this.navigate(n)),this._hasPushState?e.$(window).on("popstate",this.checkUrl):this._wantsHashChange&&"onhashchange"in window&&!i?e.$(window).on("hashchange",this.checkUrl):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),this.fragment=n;var o=this.location,a=o.pathname.replace(/[^\/]$/,"$&/")===this.root;return this._wantsHashChange&&this._wantsPushState&&!this._hasPushState&&!a?(this.fragment=this.getFragment(null,!0),this.location.replace(this.root+this.location.search+"#"+this.fragment),!0):(this._wantsPushState&&this._hasPushState&&a&&o.hash&&(this.fragment=this.getHash().replace(D,""),this.history.replaceState({},document.title,this.root+this.fragment+o.search)),this.options.silent?void 0:this.loadUrl())},stop:function(){e.$(window).off("popstate",this.checkUrl).off("hashchange",this.checkUrl),clearInterval(this._checkUrlInterval),S.started=!1},route:function(e,t){this.handlers.unshift({route:e,callback:t})},checkUrl:function(){var e=this.getFragment();return e===this.fragment&&this.iframe&&(e=this.getFragment(this.getHash(this.iframe))),e===this.fragment?!1:(this.iframe&&this.navigate(e),void(this.loadUrl()||this.loadUrl(this.getHash())))},loadUrl:function(e){var t=this.fragment=this.getFragment(e),n=s.any(this.handlers,function(e){return e.route.test(t)?(e.callback(t),!0):void 0});return n},navigate:function(e,t){if(!S.started)return!1;if(t&&t!==!0||(t={trigger:t}),e=this.getFragment(e||""),this.fragment!==e){this.fragment=e;var n=this.root+e;if(this._hasPushState)this.history[t.replace?"replaceState":"pushState"]({},document.title,n);else{if(!this._wantsHashChange)return this.location.assign(n);this._updateHash(this.location,e,t.replace),this.iframe&&e!==this.getFragment(this.getHash(this.iframe))&&(t.replace||this.iframe.document.open().close(),this._updateHash(this.iframe.location,e,t.replace))}t.trigger&&this.loadUrl(e)}},_updateHash:function(e,t,n){if(n){var r=e.href.replace(/(javascript:|#).*$/,"");e.replace(r+"#"+t)}else e.hash="#"+t}}),e.history=new S;var M=function(e,t){var n,r=this;n=e&&s.has(e,"constructor")?e.constructor:function(){return r.apply(this,arguments)},s.extend(n,r,t);var i=function(){this.constructor=n};return i.prototype=r.prototype,n.prototype=new i,e&&s.extend(n.prototype,e),n.__super__=r.prototype,n};f.extend=g.extend=P.extend=b.extend=S.extend=M;var _=function(){throw new Error('A "url" property or function must be specified')},z=function(e,t){var n=t.error;t.error=function(r){n&&n(e,r,t),e.trigger("error",e,r,t)}}}.call(this),define("backbone",["underscore","jquery"],function(e){return function(){var t;return t||e.Backbone}}(this)),function(e,t){var n=e.Backbone;return"function"==typeof define&&define.amd?define("backbone.layout",["backbone","underscore","jquery"],function(){return t.apply(e,arguments)}):void(n.Layout=t.call(e,n,e._,n.$))}("object"==typeof global?global:this,function(e,t,n){var r=this,i=e.View,o=Array.prototype.push,a=Array.prototype.concat,s=Array.prototype.splice,u=String.prototype.trim?t.bind(String.prototype.trim.call,String.prototype.trim):n.trim,l=e.View.extend({_render:function(){var e=this,t=e.__manager__,n=e.beforeRender,r=e.deferred();return e.hasRendered&&e._removeViews(),t.callback=function(){delete t.isAsync,delete t.callback,e.trigger("beforeRender",e),e._viewRender(t).render().then(function(){r.resolve()})},n&&n.call(e,e),t.isAsync||t.callback(),r.promise()},_applyTemplate:function(e,r,i){t.isString(e)&&(r.noel?(e=n.parseHTML(e,!0),this.$el.slice(1).remove(),this.$el.replaceWith(e),this.setElement(e,!1)):this.html(this.$el,e)),i.resolveWith(this,[this])},_viewRender:function(e){function n(t,n){var i;e.callback=function(t){delete e.isAsync,delete e.callback,a._applyTemplate(t,e,o)},l.cache(r,n),n&&(i=a.renderTemplate.call(a,n,t)),e.isAsync||a._applyTemplate(i,e,o)}var r,i,o,a=this;return{render:function(){var s=a.serialize,u=a.template;return o=a.deferred(),t.isFunction(s)&&(s=s.call(a)),e.callback=function(t){delete e.isAsync,delete e.callback,n(s,t)},"string"==typeof u&&(r=a.prefix+u),(i=l.cache(r))?(n(s,i,r),o):("string"==typeof u?i=a.fetchTemplate.call(a,a.prefix+u):"function"==typeof u?i=u:null!=u&&(i=a.fetchTemplate.call(a,u)),e.isAsync||n(s,i),o)}}},constructor:function(n){this.manage=!0,t.extend(this,n),e.View.apply(this,arguments)},async:function(){var e=this.__manager__;return e.isAsync=!0,e.callback},promise:function(){return this.__manager__.renderDeferred.promise()},renderViews:function(){var e=this,t=e.__manager__,n=e.deferred(),r=e.getViews().map(function(e){return e.render().__manager__.renderDeferred}).value();return t.renderDeferred=n.promise(),e.when(r).then(function(){n.resolveWith(e,[e])}),e},insertView:function(t,n,r){return n instanceof e.View?this.setView(t,n,!0,r):this.setView(t,!0,n)},insertViews:function(e){return t.isArray(e)?this.setViews({"":e}):(t.each(e,function(n,r){e[r]=t.isArray(n)?n:[n]}),this.setViews(e))},getView:function(e){return null==e&&(e=arguments[1]),this.getViews(e).first().value()},getViews:function(e){var n;return"string"==typeof e?(e=this.sections[e]||e,n=this.views[e]||[],t.chain([].concat(n))):(n=t.chain(this.views).map(function(e){return t.isArray(e)?e:[e]},this).flatten(),"object"==typeof e?n.where(e):"function"==typeof e?n.filter(e):n)},removeView:function(e){return this.getViews(e).each(function(e){e.remove()})},setView:function(e,n,r,i){var o,s,u,l=this;if("string"!=typeof e&&(i=r,r=n,n=e,e=""),o=n.__manager__,!o)throw new Error("The argument associated with selector '"+e+"' is defined and a View.  Set `manage` property to true for Backbone.View instances.");return o.parent=l,s=o.selector=l.sections[e]||e,u=l.views[s],r?(l.views[s]=a.call([],l.views[e]||[],n),i&&t.isNumber(i.insertAt)&&u?(u.splice(i.insertAt,0,n),l.views[s]=u,o.insertAt=i.insertAt):l.views[s]=a.call([],u||[],n),l.__manager__.insert=!0,n):(n.hasRendered&&n.partial(l.$el,n.$el,l.__manager__,o),l.removeView(e),l.views[s]=n)},setViews:function(e){return t.each(e,function(e,n){return t.isArray(e)?t.each(e,function(e){this.insertView(n,e)},this):void this.setView(n,e)},this),this},render:function(){function e(){function e(){var e=r.console,n=i.afterRender;n&&n.call(i,i),i.trigger("afterRender",i),a.noel&&i.$el.length>1&&t.isFunction(e.warn)&&!i.suppressWarnings&&(e.warn("`el: false` with multiple top level elements is not supported."),t.isFunction(e.trace)&&e.trace())}var n;return t.each(i.views,function(e,n){t.isArray(e)&&i.htmlBatch(i,e,n)}),s&&!a.insertedViaFragment&&(i.contains(s.el,i.el)||s.partial(s.$el,i.$el,u,a)),i.delegateEvents(),i.hasRendered=!0,(n=a.queue.shift())?n():delete a.queue,u&&u.queue?s.once("afterRender",e):e(),l.resolveWith(i,[i])}function n(){i._render().done(function(){if(!t.keys(i.views).length)return e();var n=t.map(i.views,function(e){var n=t.isArray(e);return n&&e.length?i.when(t.map(e,function(e){return e.__manager__.insertedViaFragment=!0,e.render().__manager__.renderDeferred})):n?e:e.render().__manager__.renderDeferred});i.when(n).done(e)})}var i=this,a=i.__manager__,s=a.parent,u=s&&s.__manager__,l=i.deferred();return a.queue?o.call(a.queue,n):(a.queue=[],n(i,l)),i.__manager__.renderDeferred=l,i},remove:function(){return l._removeView(this,!0),this._remove.apply(this,arguments)}},{_cache:{},_removeViews:function(e,t){"boolean"==typeof e&&(t=e,e=this),e=e||this,e.getViews().each(function(e){(e.hasRendered||t)&&l._removeView(e,t)})},_removeView:function(e,n){var r,i=e.__manager__,o=i.parent&&i.parent.__manager__,a="boolean"==typeof e.keep?e.keep:e.options.keep;if(!a&&o&&o.insert===!0||n){if(l.cleanViews(e),e._removeViews(!0),e.$el.remove(),!i.parent)return;if(r=i.parent.views[i.selector],t.isArray(r))return t.each(t.clone(r),function(e,t){e&&e.__manager__===i&&s.call(r,t,1)});delete i.parent.views[i.selector]}},cache:function(e,t){return e in this._cache&&null==t?this._cache[e]:null!=e&&null!=t?this._cache[e]=t:void 0},cleanViews:function(n){t.each(a.call([],n),function(n){n.unbind(),n.model instanceof e.Model&&n.model.off(null,null,n),n.collection instanceof e.Collection&&n.collection.off(null,null,n),n.stopListening(),t.isFunction(n.cleanup)&&n.cleanup()})},configure:function(n){t.extend(l.prototype,n),n.manage&&(e.View.prototype.manage=!0),n.el===!1&&(e.View.prototype.el=!1),n.suppressWarnings===!0&&(e.View.prototype.suppressWarnings=!0)},setupView:function(n,r){r=r||{},t.each(a.call([],n),function(n){if(!n.__manager__){var i,o,a=l.prototype;t.defaults(n,{views:{},sections:{},__manager__:{},_removeViews:l._removeViews,_removeView:l._removeView},l.prototype),n.options=r,t.extend(n,r),n._remove=e.View.prototype.remove,n.render=l.prototype.render,n.remove!==a.remove&&(n._remove=n.remove,n.remove=a.remove),i=r.views||n.views,t.keys(i).length&&(o=i,n.views={},t.each(o,function(e,t){"function"==typeof e&&(o[t]=e.call(n,n))}),n.setViews(o))}})}});l.VERSION="0.9.4",e.Layout=l,e.View=function(e){var t;e=e||{},("el"in e?e.el===!1:this.el===!1)&&(t=!0),(e.manage||this.manage)&&l.setupView(this,e),this.__manager__&&(this.__manager__.noel=t,this.__manager__.suppressWarnings=e.suppressWarnings),i.apply(this,arguments)},e.View.extend=i.extend,e.View.prototype=i.prototype;var c={prefix:"",deferred:function(){return n.Deferred()},fetchTemplate:function(e){return t.template(n(e).html())},renderTemplate:function(e,t){return u(e(t))},serialize:function(){return this.model?t.clone(this.model.attributes):{}},partial:function(e,t,n,r){var i;r.selector&&(n.noel?(i=e.filter(r.selector),e=i.length?i:e.find(r.selector)):e=e.find(r.selector)),n.insert?this.insert(e,t,r.insertAt):this.html(e,t)},html:function(e,t){e.html(t)},htmlBatch:function(e,r,i){var o=e.__manager__,a={selector:i},s=t.reduce(r,function(t,r){var i="boolean"==typeof r.keep?r.keep:r.options.keep,o=i&&n.contains(e.el,r.el);return r.el&&!o&&t.push(r.el),t},[]);return this.partial(e.$el,n(s),o,a)},insert:function(e,n,r){t.isNumber(r)?this.insertAtIndex(e,n,r):e.append(n)},insertAtIndex:function(e,t,n){var r;r=e.children().eq(0>n?Math.max(0,e.children().length+n):n),r.length?r.before(t):this.insert(e,t)},when:function(e){return n.when.apply(null,e)},contains:function(e,t){return n.contains(e,t)}};return t.extend(l.prototype,c),l}),define("app/pubsub",["underscore","h5.pubsub/MessageBroker","app/broker","app/socket"],function(e,t,n,r){function i(t,r,i){if(r)return void n.publish("pubsub.subscribeFailed",{err:r,topics:t});i.length>0&&n.publish("pubsub.subscribeNotAllowed",{topics:i});var o=e.difference(t,i);o.length>0&&n.publish("pubsub.subscribed",{topics:o})}function o(){r.isConnected()&&r.emit("pubsub.subscribe",l,i.bind(null,l)),l=[],c=null}function a(){var e=Object.keys(u);r.isConnected()&&r.emit("pubsub.unsubscribe",e),u={},d=null,n.publish("pubsub.unsubscribed",{topics:e})}var s=new t,u={},l=[],c=null,d=null;return s.on("new topic",function(e){"undefined"!=typeof u[e]&&delete u[e],r.isConnected()&&(l.push(e),null===c&&(c=setTimeout(o,0)))}),s.on("empty topic",function(e){r.isConnected()&&(u[e]=!0,null===d&&(d=setTimeout(a,0)))}),s.on("message",function(e,t,i){i.remote!==!0&&r.emit("pubsub.publish",e,t,i,function(r){r?n.publish("pubsub.publishFailed",{err:r,topic:e,message:t,meta:i}):n.publish("pubsub.published",{topic:e,message:t,meta:i})})}),r.on("connect",function(){var e=Object.keys(s.count());e.length&&r.emit("pubsub.subscribe",e,i.bind(null,e))}),r.on("pubsub.message",function(e,t){s.publish(e,t,{remote:!0})}),window.pubsub=s,s}),define("app/core/util",["underscore"],function(e){var t={};return t.inherits=function(t,n){e.extend(t,n);var r=function(){this.constructor=t};return r.prototype=n.prototype,t.prototype=new r,t.__super__=n.prototype,t},t.decodeUriComponent=function(e){return decodeURIComponent(e.replace(/\+/g," "))},t.defineSandboxedProperty=function(t,n,r){e.isObject(t._sandboxedProperties)||(t._sandboxedProperties={});var i=t._sandboxedProperties,o=t.options[n];return e.isObject(o)?(i[n]=o,t[n]=o,void delete t.options[n]):(i[n]=null,void Object.defineProperty(t,n,{enumerable:!0,configurable:!0,get:function(){return null===i[n]&&(i[n]=r.sandbox()),i[n]},set:function(e){this[n]=e}}))},t.cleanupSandboxedProperties=function(t){var n=t._sandboxedProperties;if(e.isObject(n)){var r=Object.keys(n);r.forEach(function(t){var r=n[t];r&&e.isFunction(r.destroy)&&r.destroy()}),t._sandboxedProperties=null}},t.subscribeTopics=function(t,n,r,i){if(e.isFunction(r)&&(r=r.call(t)),e.isObject(r)&&e.size(r)){var o=t[n];e.each(r,function(n,r){e.isString(n)&&(n=t[n]),i&&(n=n.bind(t)),o.subscribe(r,n)})}},t.escapeRegExp=function(e){return e.replace(/([.*+?^=!:${}()|\[\]\/\\])/g,"\\$1")},t}),define("app/core/View",["underscore","jquery","backbone.layout","app/broker","app/socket","app/pubsub","./util"],function(e,t,n,r,i,o,a){function s(e){this.options=e||{},this.timers={},this.promises=[],a.defineSandboxedProperty(this,"broker",r),a.defineSandboxedProperty(this,"pubsub",o),a.defineSandboxedProperty(this,"socket",i),n.call(this,e),a.subscribeTopics(this,"broker",this.localTopics,!0),a.subscribeTopics(this,"pubsub",this.remoteTopics,!0)}return a.inherits(s,n),s.prototype.cleanup=function(){e.isFunction(this.destroy)&&this.destroy(),a.cleanupSandboxedProperties(this),e.isObject(this.timers)&&(e.each(this.timers,clearTimeout),this.timers=null),this.cancelRequests()},s.prototype.isRendered=function(){return this.hasRendered===!0},s.prototype.isDetached=function(){return!t.contains(document.documentElement,this.el)},s.prototype.ajax=function(e){return this.promised(t.ajax(e))},s.prototype.promised=function(t){if(t&&e.isFunction(t.abort)){this.promises.push(t);var n=this;t.always(function(){Array.isArray(n.promises)&&n.promises.splice(n.promises.indexOf(t),1)})}return t},s.prototype.cancelRequests=function(){this.promises.forEach(function(e){e.abort()}),this.promises=[]},s.prototype.cancelAnimations=function(e,t){this.$(":animated").stop(e!==!1,t!==!1)},s.prototype.$id=function(e){var t="#";return"string"==typeof this.idPrefix&&(t+=this.idPrefix+"-"),this.$(t+e)},s}),define("app/core/templates/messages",["app/i18n"],function(t){return function anonymous(locals,filters,escape,rethrow){escape=escape||function(e){return String(e).replace(/&(?!#?[a-zA-Z0-9]+;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&#39;").replace(/"/g,"&quot;")};var buf=[];with(locals||{})!function(){buf.push('<ol class="messages"></ol>\n')}();return buf.join("")}}),define("app/core/templates/message",["app/i18n"],function(t){return function anonymous(locals,filters,escape,rethrow){escape=escape||function(e){return String(e).replace(/&(?!#?[a-zA-Z0-9]+;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&#39;").replace(/"/g,"&quot;")};var buf=[];with(locals||{})!function(){buf.push('<div class="message message-',type,'">',text,"</div>\n")}();return buf.join("")}}),define("app/core/views/MessagesView",["underscore","jquery","app/i18n","../View","app/core/templates/messages","app/core/templates/message"],function(e,t,n,r,i,o){var a=0,s=r.extend({template:i,events:{"click .message":function(e){e.currentTarget.parentNode===this.el&&this.hide(t(e.currentTarget))}},localTopics:{"router.executing":function(){this.hide()}}});return s.prototype.initialize=function(){this.$loadingMessage=null,this.loadingTimer=null,this.loadingCounter=0,this.hideTimers=[],this.loading=this.loading.bind(this),this.loaded=this.loaded.bind(this)},s.prototype.destroy=function(){this.$loadingMessage=null,null!==this.loadingTimer&&(clearTimeout(this.loadingTimer),this.loadingTimer=null),this.hideTimers.length>0&&(this.hideTimers.forEach(clearTimeout),this.hideTimers=null),this.$(".message").remove()},s.prototype.show=function(e){var n=t(o({type:e.type||"info",text:e.text}));return this.$el.append(n),this.moveDown(n),n.attr("data-top",n.position().top).css("margin-left",-(n.width()/2)+"px"),e.immediate?n.css("opacity",1):n.animate({opacity:1}),this.scheduleHiding(n,e.time),n},s.prototype.hide=function(e,t){if(e){if(e.hasClass("message-hiding"))return;e.addClass("message-hiding")}else e=this.$(".message"),this.$loadingMessage=null;1===e.length&&(this.moveUp(e),this.removeHideTimer(e)),t?e.remove():e.animate({opacity:0},function(){e.remove()})},s.prototype.loading=function(){this.loadingCounter+=1,null===this.loadingTimer&&(this.loadingTimer=setTimeout(this.showLoadingMessage.bind(this),a))},s.prototype.loaded=function(){this.hideLoadingMessage()},s.prototype.loadingFailed=function(t){this.hideLoadingMessage(),this.show({type:"error",text:e.isString(t)?t:n("core","MSG:LOADING_FAILURE")})},s.prototype.showLoadingMessage=function(){this.loadingTimer=null,null===this.$loadingMessage&&(this.$loadingMessage=this.show({type:"warning",text:'<i class="fa fa-spinner fa-spin"></i><span>'+n("core","MSG:LOADING")+"</span>",immediate:!0}))},s.prototype.hideLoadingMessage=function(){this.loadingCounter>0&&--this.loadingCounter,0===this.loadingCounter&&(null!==this.loadingTimer&&(clearTimeout(this.loadingTimer),this.loadingTimer=null),null!==this.$loadingMessage&&(this.hide(this.$loadingMessage),this.$loadingMessage=null))},s.prototype.moveDown=function(e){this.moveTopBy(this.$(".message"),e,this.getMoveOffset(e))},s.prototype.moveUp=function(e){this.moveTopBy(e.prevAll(".message"),e,-this.getMoveOffset(e))},s.prototype.moveTopBy=function(e,n,r){e.each(function(){if(this!==n[0]){var e=t(this),i=parseInt(e.attr("data-top"),10)+r;e.attr("data-top",i),e.animate({top:i+"px"})}})},s.prototype.getMoveOffset=function(e){return e.outerHeight()+8},s.prototype.scheduleHiding=function(t,n){if(e.isNumber(n)){1e3>n&&(n=1e3);var r=setTimeout(this.hide.bind(this,t),n);t.data("hideTimer",r),this.hideTimers.push(r)}},s.prototype.removeHideTimer=function(t){var n=t.data("hideTimer");e.isUndefined(n)||(clearTimeout(n),t.data("hideTimer",void 0),this.hideTimers.splice(this.hideTimers.indexOf(n),1))},s}),define("app/core/templates/dialogContainer",["app/i18n"],function(t){return function anonymous(locals,filters,escape,rethrow){escape=escape||function(e){return String(e).replace(/&(?!#?[a-zA-Z0-9]+;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&#39;").replace(/"/g,"&quot;")};var buf=[];with(locals||{})!function(){buf.push('<div class="modal fade viewport-dialog" tabindex="-1">\n  <div class="modal-dialog">\n    <div class="modal-content">\n      <div class="modal-header">\n        <button type="button" class="close cancel">×</button>\n        <h3 class="modal-title"></h3>\n      </div>\n      <div class="modal-body"></div>\n    </div>\n  </div>\n</div>\n')}();return buf.join("")}}),define("app/core/Viewport",["require","underscore","jquery","./View","./util","./views/MessagesView","app/core/templates/dialogContainer"],function(e,t,n,r,i,o,a){function s(e){r.call(this,e),this.msg=e.messagesView?e.messagesView:new o({el:this.el}),this.document=e.document||window.document,this.layouts={},this.currentLayout=null,this.currentLayoutName=null,this.currentPage=null,this.$dialog=null,this.dialogQueue=[],this.currentDialog=null,this.closeDialog=this.closeDialog.bind(this),this.$el.on("click",".viewport-dialog .cancel",this.closeDialog)}var u=function(e){return new e};return i.inherits(s,r),s.prototype.cleanup=function(){this.broker.destroy(),this.msg.remove(),this.$dialog.remove(),this.currentPage&&this.currentPage.remove(),this.currentLayout&&this.currentLayout.remove(),this.currentDialog&&this.currentDialog.remove(),t.invoke(this.dialogQueue.filter(t.isObject),"remove"),this.$el.off("click",".viewport-dialog .cancel",this.closeDialog),this.broker=null,this.msg=null,this.$dialog=null,this.currentLayout=null,this.currentDialog=null,this.dialogQueue=null,this.layouts=null},s.prototype.afterRender=function(){return null!==this.$dialog?this.closeDialog():(this.$dialog=n(a()).appendTo(this.el).modal({show:!1,backdrop:!0}),this.$dialog.on("shown.bs.modal",this.onDialogShown.bind(this)),void this.$dialog.on("hidden.bs.modal",this.onDialogHidden.bind(this)))},s.prototype.registerLayout=function(e,t){return this.layouts[e]=t,this},s.prototype.loadPage=function(n,r){this.msg.loading(),t.isFunction(r)||(r=u);var i=this;e([].concat(n),function(){i.showPage(r.apply(null,arguments)),i.msg.loaded()})},s.prototype.showPage=function(e){function r(){return n.when.apply(n,t.map(arguments,e.promised,e))}function i(){null!==s.currentPage&&s.currentPage.remove(),s.currentPage=e;var n=s.setLayout(a);t.isFunction(n.setUpPage)&&n.setUpPage(e),t.isFunction(e.setUpLayout)&&e.setUpLayout(n),t.isObject(e.view)&&e.setView(e.view),n.setView(n.pageContainerSelector,e),s.isRendered()?n.isRendered()?e.render():n.render():s.render()}function o(){e.remove()}var a=t.result(e,"layoutName");if(!t.isObject(this.layouts[a]))throw new Error("Unknown layout: `"+a+"`");var s=this;t.isFunction(e.load)?e.load(r).then(i,o):i()},s.prototype.showDialog=function(e,n){if(null!==this.currentDialog)return this.dialogQueue.push(e,n),this;
var r=e.afterRender,i=this;e.afterRender=function(){i.$dialog.find(".modal-body").empty().append(e.el),i.$dialog.modal("show"),t.isFunction(r)&&r.apply(e,arguments)},this.currentDialog=e;var o=this.$dialog.find(".modal-header");return n?(o.find(".modal-title").text(n),o.show()):o.hide(),e.dialogClassName&&this.$dialog.addClass(t.result(e,"dialogClassName")),e.render(),this},s.prototype.closeDialog=function(e){return null===this.currentDialog?this:(this.$dialog.modal("hide"),e&&e.preventDefault(),this)},s.prototype.closeAllDialogs=function(){this.dialogQueue=[],this.closeDialog()},s.prototype.setLayout=function(e){if(e===this.currentLayoutName)return t.isFunction(this.currentLayout.reset)&&this.currentLayout.reset(),this.currentLayout;var n=this.layouts[e],r=this.options.selector||"";return t.isObject(this.currentLayout)&&this.removeView(r),this.currentLayoutName=e,this.currentLayout=n(),this.setView(r,this.currentLayout),this.currentLayout},s.prototype.onDialogShown=function(){this.currentDialog.$("[autofocus]").focus(),t.isFunction(this.currentDialog.onDialogShown)&&this.currentDialog.onDialogShown(this),this.broker.publish("viewport.dialog.shown",this.currentDialog)},s.prototype.onDialogHidden=function(){this.currentDialog.dialogClassName&&this.$dialog.removeClass(t.result(this.currentDialog,"dialogClassName")),t.isFunction(this.currentDialog.remove)&&(this.currentDialog.remove(),this.broker.publish("viewport.dialog.hidden")),this.currentDialog=null,this.dialogQueue.length&&this.showDialog(this.dialogQueue.shift(),this.dialogQueue.shift())},s}),define("app/viewport",["app/broker","app/core/Viewport"],function(e,t){var n=new t({el:document.body,selector:"#app-viewport"});return e.subscribe("router.executing",function(){window.scrollTo(0,0)}),window.viewport=n,n}),define("h5.rql/Term",["require","exports","module"],function(e,t,n){function r(e,t){this.name=e||null,this.args=t||[]}n.exports=r}),define("h5.rql/specialTerms",["require","exports","module"],function(e,t,n){function r(e,t,n){e.fields={};for(var r="select"===t,i=0,o=n.length;o>i;++i){var a=n[i];Array.isArray(a)&&(a=a.join(".")),e.fields[a]=r}}function i(e,t,n){e.sort={};for(var r=0,i=n.length;i>r;++r){var o=n[r];Array.isArray(o)&&(o=o.join(".")),"-"===o[0]?e.sort[o.substr(1)]=-1:"+"===o[0]?e.sort[o.substr(1)]=1:e.sort[o]=1}}function o(e,t,n){var r=parseInt(n[0],10),i=0;n.length>1&&(i=parseInt(n[1],10)),e.limit=isNaN(r)||1>r?-1:r,e.skip=isNaN(i)||0>i?0:i}n.exports={select:r,exclude:r,sort:i,limit:o}}),define("h5.rql/autoConvertedMap",["require","exports","module"],function(e,t,n){n.exports={"true":!0,"false":!1,"null":null,undefined:void 0,Infinity:1/0,"-Infinity":-1/0}}),define("h5.rql/serializers/stringSerializer",["require","exports","module","../specialTerms","../autoConvertedMap"],function(e,t){function n(e,t){var n=[],s=t&&t.doubleEncode?f:p;return r(n,e.fields),i(n,e.sort),o(n,e.limit,e.skip),a(n,s,e.selector),n.join("").substr(1)}function r(e,t){var n=Object.keys(t);0!==n.length&&e.push(t[n[0]]?"&select(":"&exclude(",n.join(","),")")}function i(e,t){var n=Object.keys(t),r=n.length;if(0!==r){e.push("&sort(");for(var i=0;r>i;++i){var o=n[i];-1===t[o]&&e.push("-"),e.push(o),r-1>i&&e.push(",")}e.push(")")}}function o(e,t,n){-1!==t&&(e.push("&limit(",t),0!==n&&e.push(",",n),e.push(")"))}function a(e,t,n){var r=n.args.length;if(0!==r)if("and"===n.name)for(var i=0;r>i;++i){var o=n.args[i];h.hasOwnProperty(o.name)||(e.push("&"),s(e,t,o,r))}else e.push("&"),s(e,t,n,r,!0)}function s(e,t,n,r,i){if(Array.isArray(n))return void l(e,t,n);if(null===n||"object"!=typeof n||"string"!=typeof n.name||!Array.isArray(n.args))return void c(e,t,n);if(g.hasOwnProperty(n.name)&&n.args.length>1)return s(e,t,n.args[0],0),e.push(g[n.name]),void s(e,t,n.args[1],0);var o=",";"and"===n.name?o="&":"or"===n.name&&i!==!0&&(o="|"),u(e,t,o,n,r)}function u(e,t,n,r,i){var o=r.args.length;","===n?e.push(r.name,"("):1!==i&&e.push("(");for(var a=0;o>a;++a)s(e,t,r.args[a],o),o-1>a&&e.push(n);(","===n||-1!==i)&&e.push(")")}function l(e,t,n){e.push("(");for(var r=0,i=n.length;i>r;++r)s(e,t,n[r],i),i-1>r&&e.push(",");e.push(")")}function c(e,t,n){switch(typeof n){case"undefined":e.push("undefined");break;case"boolean":e.push(n?"true":"false");break;case"number":e.push(n.toString(10));break;case"object":d(e,t,n);break;default:0===n.length?e.push("string:"):isNaN(+n)?m.hasOwnProperty(n)?e.push("string:",n):e.push(t(n)):e.push("string:",n.toString())}}function d(e,t,n){if(null===n)e.push("null");else if(n instanceof Date)e.push("epoch:",n.getTime().toString());else if(n instanceof RegExp){var r=n.toString(),i=r.lastIndexOf("/");""===r.substr(i+1)&&(r=r.substr(1,i-1)),e.push("re:",t(r))}else e.push("function"==typeof n.convertToRqlValue?n.convertToRqlValue(t):t(n.toString()))}function p(e){return e=encodeURIComponent(e),/[\(\)]/.test(e)&&(e=e.replace(/\(/g,"%28").replace(/\)/g,"%29")),e}function f(e){return p(p(e))}var h=e("../specialTerms"),m=e("../autoConvertedMap");t.fromQuery=n;var g={eq:"=",ne:"!=",le:"<=",ge:">=",lt:"<",gt:">","in":"=in=",nin:"=nin="}}),define("h5.rql/Query",["require","exports","module","./Term","./serializers/stringSerializer"],function(e,t,n){function r(){this.selector=new i("and"),this.fields={},this.skip=0,this.limit=-1,this.sort={}}var i=e("./Term"),o=e("./serializers/stringSerializer");n.exports=r,r.fromObject=function(e){if(e instanceof r)return e;var t=new r;return e?(e.selector&&(t.selector=e.selector),e.fields&&(t.fields=e.fields),e.skip&&(t.skip=e.skip),e.limit&&(t.limit=e.limit),e.sort&&(t.sort=e.sort),t):t},r.prototype.toString=function(e){return o.fromQuery(this,e)},r.prototype.isEmpty=function(){return 0===this.skip&&-1===this.limit&&0===Object.keys(this.fields).length&&0===Object.keys(this.sort).length&&0===this.selector.args.length}}),define("h5.rql/valueConverters",["require","exports","module","./autoConvertedMap"],function(e,t,n){function r(e,t){if(p.hasOwnProperty(e))return p[e];var n=+e;return isNaN(n)||n.toString()!==e?(e=decodeURIComponent(e),t.options.jsonQueryCompatible&&"'"===e[0]&&"'"===e[e.length-1]?JSON.parse('"'+e.substring(1,e.length-1)+'"'):e):n}function i(e){var t=+e;if(isNaN(t))throw new Error("Invalid number: "+e);return t}function o(e){var t=new Date(+e);if(isNaN(t.getTime()))throw new Error("Invalid date: "+e);return t}function a(e){return e=decodeURIComponent(e),e="0000".substr(0,4-e.length)+e,e+="0000-01-01T00:00:00Z".substring(e.length),s(e)}function s(e){e=decodeURIComponent(e);var t,n=/^(\d{4})-(\d{2})-(\d{2})T(\d{2}):(\d{2}):(\d{2}(?:\.\d*)?)Z$/.exec(e);if(t=new Date(null!==n?Date.UTC(+n[1],+n[2]-1,+n[3],+n[4],+n[5],+n[6]):e),isNaN(t.getTime()))throw new Error("Invalid date: "+e);return t}function u(e){return e?!0:!1}function l(e){return decodeURIComponent(e)}function c(e){e=decodeURIComponent(e);var t=e,n="";if("/"===e[0]){var r=e.lastIndexOf("/");t=e.substr(1,r-1),n=e.substr(r+1)}return new RegExp(t,n)}function d(e){return e=decodeURIComponent(e).replace(/([\\\|\(\)\[\]\{\}\^\$\*\+\?\.<>])/g,"\\$1").replace(/\\\*/g,".*").replace(/\\\?/g,".?"),e=".*"===e.substr(0,2)?e.substr(2):"^"+e,e=".*"===e.substr(e.length-2)?e.substr(0,e.length-2):e+"$",new RegExp(e,"i")}var p=e("./autoConvertedMap");n.exports={"default":r,auto:r,number:i,epoch:o,isodate:a,date:s,"boolean":u,string:l,re:c,glob:d}}),define("h5.rql/Parser",["require","exports","module","./Term","./valueConverters"],function(e,t,n){function r(e){this.options=e instanceof r.Options?e:new r.Options(e)}var i=e("./Term"),o=e("./valueConverters");n.exports=r;var a=/^[\w_\*\-\+\.\$:%]$/,s=/[\+\*\$\-:\w%\._]*\/[\+\*\$\-:\w%\._\/]*/g,u=new RegExp("(\\([\\+\\*\\$\\-:\\w%\\._,]+\\)|[\\+\\*\\$\\-:\\w%\\._]*|)([<>!]?=(?:[\\w]*=)?|>|<)(\\([\\+\\*\\$\\-:\\w%\\._,]+\\)|[\\+\\*\\$\\-:\\w%\\._]*|)","g"),l={"=":"eq","==":"eq",">":"gt",">=":"ge","<":"lt","<=":"le","!=":"ne"};r.Options=function(e){("object"!=typeof e||null===e)&&(e={}),this.jsonQueryCompatible=e.jsonQueryCompatible===!0,this.fiqlCompatible=!e.hasOwnProperty("fiqlCompatible")||e.fiqlCompatible===!0,this.allowSlashedArrays=e.allowSlashedArrays===!0,this.allowEmptyValues=e.allowEmptyValues===!0,this.defaultValueConverter="function"==typeof e.defaultValueConverter?e.defaultValueConverter:o.default,this.specialTerms=Array.isArray(e.specialTerms)?e.specialTerms:[],this.emptyValue=e.hasOwnProperty("emptyValue")?e.emptyValue:""},r.prototype.parse=function(e,t){var n="object"==typeof t&&null!==t,r=this.options.specialTerms,o=null,s=new i,u=[],l=!0;this.options.jsonQueryCompatible&&(e=this.makeJsonQueryCompatible(e)),this.options.allowSlashedArrays&&(e=this.convertSlashedArrays(e)),this.options.fiqlCompatible&&(e=this.convertFiql(e));for(var c=0,d=e.length;d>c;++c){var p=e[c];switch(p){case"(":u.push(s),s=new i(o),n&&null!==o&&-1!==r.indexOf(o)&&(delete t[o],t[o]=s.args),o=null,l=!0;break;case",":if(l===!1){if(!this.options.allowEmptyValues)throw new Error("Empty value at position "+c+" is not allowed.");o=this.options.emptyValue}null!==o&&(s.args.push(this.convertStringToValue(o)),o=null),l=!1;break;case")":null!==o&&(s.args.push(this.convertStringToValue(o)),o=null);var f=null===s.name?s.args:s;s=u.pop(),s.args.push(f),l=!0;break;case"&":case"|":var h="&"===p?"and":"or";if(null!==s.name&&s.name!==h)throw new Error("Can not mix conjunctions within a group at position "+c+", use parenthesises around each set of the same conjunctions (& and |)");s.name="&"===p?"and":"or",null!==o&&(s.args.push(this.convertStringToValue(o)),o=null);break;default:if(!a.test(p))throw new Error("Invalid character at position "+c+": '"+p+"' ("+p.charCodeAt(0)+")");null===o?o=p:o+=p,l=!0}}return null!==o&&s.args.push(this.convertStringToValue(o)),null===s.name&&(s.name="and"),"and"===s.name&&1===s.args.length&&s.args[0]instanceof i&&"and"===s.args[0].name&&(s=s.args[0]),s},r.prototype.makeJsonQueryCompatible=function(e){return this.options.jsonQueryCompatible&&(e=e.replace(/%3C=/g,"=le=").replace(/%3E=/g,"=ge=").replace(/%3C/g,"=lt=").replace(/%3E/g,"=gt=")),e},r.prototype.convertSlashedArrays=function(e){return-1!==e.indexOf("/")?e.replace(s,function(e){return"("+e.replace(/\//g,",")+")"}):e},r.prototype.convertFiql=function(e){return e.replace(u,function(e,t,n,r){return n=n.length<3?l[n]:n.substring(1,n.length-1),n+"("+t+","+r+")"})},r.prototype.convertStringToValue=function(e){var t,n=e.indexOf(":");if(-1!==n){var r=e.substr(0,n);if(t=o[r],"undefined"==typeof t)throw new Error("Unknown value converter: "+r);e=e.substr(n+1)}else t=this.options.defaultValueConverter;return t(e,this)}}),define("h5.rql/index",["require","exports","module","./Term","./Query","./Parser","./specialTerms","./valueConverters"],function(e,t){var n=e("./Term"),r=e("./Query"),i=e("./Parser"),o=e("./specialTerms"),a=e("./valueConverters");t.Term=n,t.Query=r,t.Parser=i,t.specialTerms=o,t.valueConverters=a,t.parser=null,t.parse=function(e){null===t.parser&&(t.parser=new i({jsonQueryCompatible:!0,fiqlCompatible:!0,allowEmptyValues:!1,allowSlashedArrays:!0,specialTerms:Object.keys(o)}));var n=new r,a={};n.selector=t.parser.parse(e,a);for(var s in a)a.hasOwnProperty(s)&&o.hasOwnProperty(s)&&o[s](n,s,a[s]);return n}}),define("app/core/PaginationData",["underscore","backbone"],function(e,t){return t.Model.extend({defaults:{totalCount:-1,urlTemplate:"?page=${page}&limit=${limit}",page:1,skip:0,limit:10},initialize:function(){this.on("change",this.recalcAttrs,this);var e=this.attributes;e.page<1&&(e.page=1),e.skip<0&&(e.skip=0),e.limit<1&&(e.limit=1),0!==e.skip?this.recalcPage():1!==e.page?this.recalcSkip():this.adjustSkipToLimit()},sync:function(){throw new Error("Not supported!")},recalcAttrs:function(){var t=this.changedAttributes();e.has(t,"total")||e.has(t,"skip")||e.has(t,"limit")?this.recalcPage():e.has(t,"page")&&this.recalcSkip()},recalcPage:function(){this.adjustSkipToLimit();var e=this.attributes;e.page=e.skip/e.limit+1},recalcSkip:function(){var e=this.attributes;e.skip=(e.page-1)*e.limit},adjustSkipToLimit:function(){var e=this.attributes;e.skip>=e.total&&(e.skip=e.total<2?1:e.total-1);var t=e.skip%e.limit;0!==t&&(e.skip-=t)}})}),define("app/core/Collection",["underscore","backbone","h5.rql/index","./util","./PaginationData"],function(e,t,n,r,i){function o(n,r){e.isObject(r)||(r={}),this.rqlQuery=this.createRqlQuery(r.rqlQuery||this.rqlQuery),this.paginationData=r.paginate!==!1?new i:null,this.url||(this.url=this.model.prototype.urlRoot),t.Collection.call(this,n,r),this.paginationData&&this.listenTo(this.paginationData,"change:page",this.onPageChanged)}return r.inherits(o,t.Collection),o.prototype.parse=function(e){return this.paginationData&&this.paginationData.set({totalCount:e.totalCount,urlTemplate:this.genPaginationUrlTemplate(),skip:this.rqlQuery.skip,limit:this.rqlQuery.limit}),e.collection},o.prototype.sync=function(e,n,r){return"read"!==e||r.data||(r.data=this.rqlQuery.toString()),t.Collection.prototype.sync.call(this,e,n,r)},o.prototype.genClientUrl=function(e){if(null===this.model.prototype.clientUrlRoot)throw new Error("Model's `clientUrlRoot` was not specified");var t=this.model.prototype.clientUrlRoot;return"string"==typeof e&&(t+=";"+e),t},o.prototype.getTopicPrefix=function(){return this.topicPrefix||this.model.prototype.topicPrefix},o.prototype.getPrivilegePrefix=function(){return this.privilegePrefix||this.model.prototype.privilegePrefix},o.prototype.getNlsDomain=function(){return this.nlsDomain||this.model.prototype.nlsDomain},o.prototype.createRqlQuery=function(t){return e.isString(t)?t=n.parse(t):e.isFunction(t)?t=t.call(this,n):e.isObject(t)&&(t=n.Query.fromObject(t)),t&&!t.isEmpty()?t:e.isString(this.rqlQuery)?n.parse(this.rqlQuery):e.isFunction(this.rqlQuery)?this.rqlQuery.call(this,n):e.isObject(this.rqlQuery)?n.Query.fromObject(this.rqlQuery):new n.Query},o.prototype.genPaginationUrlTemplate=function(){var e=this.rqlQuery,t=e.skip,n=e.limit;e.skip="${skip}",e.limit="${limit}";var r=this.genClientUrl()+"?"+e.toString();return e.skip=t,e.limit=n,r},o.prototype.onPageChanged=function(e,t){this.rqlQuery.skip=(t-1)*this.rqlQuery.limit,this.fetch({reset:!0})},o}),define("app/core/Model",["underscore","backbone"],function(e,t){return t.Model.extend({idAttribute:"_id",urlRoot:"/",clientUrlRoot:null,topicPrefix:null,privilegePrefix:null,nlsDomain:null,labelAttribute:null,genClientUrl:function(e){if(null===this.clientUrlRoot)throw new Error("`clientUrlRoot` was not specified");var t=this.clientUrlRoot;return"base"===e?t:(t+="/",t+=encodeURIComponent(this.isNew()?this.cid:this.id),"string"==typeof e&&(t+=";"+e),t)},getTopicPrefix:function(){return this.topicPrefix},getPrivilegePrefix:function(){return this.privilegePrefix},getNlsDomain:function(){return this.nlsDomain||"core"},getLabelAttribute:function(){return this.labelAttribute||this.idAttribute},getLabel:function(){return String(this.get(this.getLabelAttribute()))}})}),define("app/divisions/Division",["../core/Model"],function(e){return e.extend({urlRoot:"/divisions",clientUrlRoot:"#divisions",topicPrefix:"divisions",privilegePrefix:"DICTIONARIES",nlsDomain:"divisions",labelAttribute:"_id",defaults:{type:"prod",description:null}})}),define("app/divisions/DivisionCollection",["../core/Collection","./Division"],function(e,t){return e.extend({model:t,rqlQuery:"select(type,description)&sort(_id)"})}),function(){function e(e){function n(e){e+="";var t=e.split(":"),n=~e.indexOf("-")?-1:1,r=Math.abs(+t[0]),i=parseInt(t[1],10)||0,o=parseInt(t[2],10)||0;return n*(60*r+i+o/60)}function r(e,t,r,i,o,a,s,u,l,d){this.name=e,this.startYear=+t,this.endYear=+r,this.month=+i,this.day=+o,this.dayRule=+a,this.time=n(s),this.timeRule=+u,this.offset=n(l),this.letters=d||"",this.date=c(this.date),this.weekdayAfter=c(this.weekdayAfter),this.lastWeekday=c(this.lastWeekday)}function i(e,t){this.rule=t,this.start=t.start(e)}function o(e,t){return e.isLast?-1:t.isLast?1:t.start-e.start}function a(e){this.name=e,this.rules=[],this.lastYearRule=c(this.lastYearRule)}function s(t,r,i,o,a,s){var u,l="string"==typeof a?a.split("_"):[9999];for(this.name=t,this.offset=n(r),this.ruleSet=i,this.letters=o,this.lastRule=c(this.lastRule),u=0;u<l.length;u++)l[u]=+l[u];this.until=e.utc(l).subtract("m",n(s))}function u(e,t){return e.until-t.until}function l(e){this.name=f(e),this.displayName=e,this.zones=[],this.zoneAndRule=c(this.zoneAndRule,function(e){return+e})}function c(e,t){var n={};return function(r){var i=t?t.apply(this,arguments):r;return i in n?n[i]:n[i]=e.apply(this,arguments)}}function d(e){var t,n,r;for(t in e)for(r=e[t],n=0;n<r.length;n++)p(t+"	"+r[n])}function p(e){if(O[e])return O[e];var t=e.split(/\s/),n=f(t[0]),i=new r(n,t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10]);return O[e]=i,y(n).add(i),i}function f(e){return(e||"").toLowerCase().replace(/\//g,"_")}function h(e){var t,n,r;for(t in e)for(r=e[t],n=0;n<r.length;n++)g(t+"	"+r[n])}function m(e){var t;for(t in e)I[f(t)]=f(e[t])}function g(e){if(A[e])return A[e];var t=e.split(/\s/),n=f(t[0]),r=new s(n,t[1],y(t[2]),t[3],t[4],t[5]);return A[e]=r,v(t[0]).add(r),r}function y(e){return e=f(e),P[e]||(P[e]=new a(e)),P[e]}function v(e){var t=f(e);return I[t]&&(t=I[t]),k[t]||(k[t]=new l(e)),k[t]}function w(e){e&&(e.zones&&h(e.zones),e.rules&&d(e.rules),e.links&&m(e.links))}function E(){var e,t=[];for(e in k)t.push(k[e]);return t}var b,R=e.fn.zoneName,T=e.fn.zoneAbbr,O={},P={},A={},k={},I={},C=1,S=2,D=7,F=8;return r.prototype={contains:function(e){return e>=this.startYear&&e<=this.endYear},start:function(t){return t=Math.min(Math.max(t,this.startYear),this.endYear),e.utc([t,this.month,this.date(t),0,this.time])},date:function(e){return this.dayRule===D?this.day:this.dayRule===F?this.lastWeekday(e):this.weekdayAfter(e)},weekdayAfter:function(t){for(var n=this.day,r=e([t,this.month,1]).day(),i=this.dayRule+1-r;n>i;)i+=7;return i},lastWeekday:function(t){var n=this.day,r=n%7,i=e([t,this.month+1,1]).day(),o=e([t,this.month,1]).daysInMonth(),a=o+(r-(i-1))-7*~~(n/7);return r>=i&&(a-=7),a}},i.prototype={equals:function(e){return e&&e.rule===this.rule?Math.abs(e.start-this.start)<864e5:!1}},a.prototype={add:function(e){this.rules.push(e)},ruleYears:function(e,t){var n,r,a,s=e.year(),u=[];for(n=0;n<this.rules.length;n++)r=this.rules[n],r.contains(s)?u.push(new i(s,r)):r.contains(s+1)&&u.push(new i(s+1,r));return u.push(new i(s-1,this.lastYearRule(s-1))),t&&(a=new i(s-1,t.lastRule()),a.start=t.until.clone().utc(),a.isLast=t.ruleSet!==this,u.push(a)),u.sort(o),u},rule:function(e,t,n){var r,i,o,a,s,u=this.ruleYears(e,n),l=0;for(n&&(i=n.offset+n.lastRule().offset,o=9e4*Math.abs(i)),s=u.length-1;s>-1;s--)a=r,r=u[s],r.equals(a)||(n&&!r.isLast&&Math.abs(r.start-n.until)<=o&&(l+=i-t),r.rule.timeRule===S&&(l=t),r.rule.timeRule!==C&&r.start.add("m",-l),l=r.rule.offset+t);for(s=0;s<u.length;s++)if(r=u[s],e>=r.start&&!r.isLast)return r.rule;return b},lastYearRule:function(e){var t,n,r,i=b,o=-1e30;for(t=0;t<this.rules.length;t++)n=this.rules[t],e>=n.startYear&&(r=n.start(e),r>o&&(o=r,i=n));return i}},s.prototype={rule:function(e,t){return this.ruleSet.rule(e,this.offset,t)},lastRule:function(){return this.rule(this.until)},format:function(e){return this.letters.replace("%s",e.letters)}},l.prototype={zoneAndRule:function(e){var t,n,r;for(e=e.clone().utc(),t=0;t<this.zones.length&&(n=this.zones[t],!(e<n.until));t++)r=n;return[n,n.rule(e,r)]},add:function(e){this.zones.push(e),this.zones.sort(u)},format:function(e){var t=this.zoneAndRule(e);return t[0].format(t[1])},offset:function(e){var t=this.zoneAndRule(e);return-(t[0].offset+t[1].offset)}},e.updateOffset=function(e){var t;e._z&&(t=e._z.offset(e),Math.abs(t)<16&&(t/=60),e.zone(t))},e.fn.tz=function(t){return t?(this._z=v(t),this._z&&e.updateOffset(this),this):this._z?this._z.displayName:void 0},e.fn.zoneName=function(){return this._z?this._z.format(this):R.call(this)},e.fn.zoneAbbr=function(){return this._z?this._z.format(this):T.call(this)},e.tz=function(){var t,n=[],r=arguments.length-1;for(t=0;r>t;t++)n[t]=arguments[t];var i=e.apply(null,n),o=i.zone();return i.tz(arguments[r]),i.add("minutes",i.zone()-o)},e.tz.add=w,e.tz.addRule=p,e.tz.addZone=g,e.tz.zones=E,e.tz.version=t,b=p("- 0 9999 0 0 0 0 0 0"),e}var t="0.0.3";"function"==typeof define&&define.amd?define("moment-timezone",["moment"],e):"undefined"!=typeof window&&window.moment?e(window.moment):"undefined"!=typeof module&&(module.exports=e(require("moment")))}.apply(this),define("moment-timezone-data",["moment-timezone"],function(e){e.tz.add({zones:{"Europe/Warsaw":["1:24 - LMT 1880 1:24","1:24 - WMT 1915_7_5 1:24","1 C-Eur CE%sT 1918_8_16_3 2","2 Poland EE%sT 1922_5 2","1 Poland CE%sT 1940_5_23_2 1","1 C-Eur CE%sT 1944_9 2","1 Poland CE%sT 1977 1","1 W-Eur CE%sT 1988 1","1 EU CE%sT"]},rules:{"C-Eur":["1916 1916 3 30 7 23 0 1 S","1916 1916 9 1 7 1 0 0","1917 1918 3 15 1 2 2 1 S","1917 1918 8 15 1 2 2 0","1940 1940 3 1 7 2 2 1 S","1942 1942 10 2 7 2 2 0","1943 1943 2 29 7 2 2 1 S","1943 1943 9 4 7 2 2 0","1944 1945 3 1 1 2 2 1 S","1944 1944 9 2 7 2 2 0","1945 1945 8 16 7 2 2 0","1977 1980 3 1 0 2 2 1 S","1977 1977 8 0 8 2 2 0","1978 1978 9 1 7 2 2 0","1979 1995 8 0 8 2 2 0","1981 9999 2 0 8 2 2 1 S","1996 9999 9 0 8 2 2 0"],Poland:["1918 1919 8 16 7 2 2 0","1919 1919 3 15 7 2 2 1 S","1944 1944 3 3 7 2 2 1 S","1944 1944 9 4 7 2 0 0","1945 1945 3 29 7 0 0 1 S","1945 1945 10 1 7 0 0 0","1946 1946 3 14 7 0 2 1 S","1946 1946 9 7 7 2 2 0","1947 1947 4 4 7 2 2 1 S","1947 1949 9 1 0 2 2 0","1948 1948 3 18 7 2 2 1 S","1949 1949 3 10 7 2 2 1 S","1957 1957 5 2 7 1 2 1 S","1957 1958 8 0 8 1 2 0","1958 1958 2 30 7 1 2 1 S","1959 1959 4 31 7 1 2 1 S","1959 1961 9 1 0 1 2 0","1960 1960 3 3 7 1 2 1 S","1961 1964 4 0 8 1 2 1 S","1962 1964 8 0 8 1 2 0"],"W-Eur":["1977 1980 3 1 0 1 2 1 S","1977 1977 8 0 8 1 2 0","1978 1978 9 1 7 1 2 0","1979 1995 8 0 8 1 2 0","1981 9999 2 0 8 1 2 1 S","1996 9999 9 0 8 1 2 0"],EU:["1977 1980 3 1 0 1 1 1 S","1977 1977 8 0 8 1 1 0","1978 1978 9 1 7 1 1 0","1979 1995 8 0 8 1 1 0","1981 9999 2 0 8 1 1 1 S","1996 9999 9 0 8 1 1 0"]},links:{}})}),define("app/time",["moment-timezone","app/socket","moment-timezone-data"],function(e,t){function n(e,t){for(e=String(e);e.length<t;)e="0"+e;return e}var r="TIME:OFFSET",i="TIME:ZONE",o={synced:!1,offset:parseFloat(localStorage.getItem(r))||0,zone:localStorage.getItem(i)||"Europe/Warsaw",appData:window.TIME||0};return delete window.TIME,o.sync=function(){var e=Date.now();t.emit("time",function(t,n){o.offset=(t-e+(t-Date.now()))/2,o.zone=n,o.synced=!0,localStorage.setItem(r,o.offset.toString()),localStorage.setItem(i,o.zone)})},o.getServerMoment=function(){return e(Date.now()+o.offset).tz(o.zone)},o.getMoment=function(t){return e(t).tz(o.zone)},o.format=function(e,t){var n=o.getMoment(e);return n.isValid()?n.format(t):null},o.toSeconds=function(e){if("number"==typeof e)return e;if("string"!=typeof e)return 0;var t={g:3600,h:3600,m:60,s:1},n=e.trim(),r=parseInt(n,10);if(/^[0-9]+\.?[0-9]*$/.test(n)===!1){var i,o=/([0-9\.]+) *(h|m|s)[a-z]*/gi;for(r=0;i=o.exec(n);)r+=i[1]*t[i[2].toLowerCase()]}return r},o.toString=function(e,t,r){if("number"!=typeof e||0>=e)return t?"00:00:00":"0s";var i="",o=Math.floor(e/3600);o>0?(i+=t?n(o,2)+":":" "+o+"h",e%=3600):t&&(i+="00:");var a=Math.floor(e/60);a>0?(i+=t?n(a,2)+":":" "+a+"min",e%=60):t&&(i+="00:");var s=e;return s>=1?(i+=t?n(Math.round(s),2):" "+Math.round(s)+"s",r&&s%1!==0&&(i+=t?"."+n(Math.round(s%1*1e3),3):" "+(Math.round(s%1*1e3)+"ms"))):s>0&&""===i?i+=" "+1e3*s+"ms":t&&(i+="00"),t?i:i.substr(1)},t.on("connect",function(){o.sync()}),t.isConnected()&&o.sync(),window.time=o,o}),define("app/data/createStorage",["app/time","app/broker","app/pubsub"],function(e,t,n){return function(r,i,o){function a(){localStorage.setItem(r,JSON.stringify({time:Date.now(),data:c.models})),t.publish(i+".synced")}var s={time:e.appData,data:window[r]||[]},u=JSON.parse(localStorage.getItem(r)||"null"),l=u&&u.time>s.time?u:s,c=new o(l.data);return l===s&&a(),c.on("add",a),c.on("remove",a),c.on("destroy",a),c.on("change",a),c.on("sync",a),n.subscribe(i+".added",function(e){c.add(e.model)}),n.subscribe(i+".edited",function(e){var t=c.get(e.model._id);t?t.set(e.model):c.add(e.model)}),n.subscribe(i+".deleted",function(e){c.remove(e.model._id)}),c}}),define("app/data/divisions",["app/divisions/DivisionCollection","./createStorage"],function(e,t){return t("DIVISIONS","divisions",e)}),define("app/subdivisions/Subdivision",["../core/Model"],function(e){return e.extend({urlRoot:"/subdivisions",clientUrlRoot:"#subdivisions",topicPrefix:"subdivisions",privilegePrefix:"DICTIONARIES",nlsDomain:"subdivisions",labelAttribute:"name",defaults:{division:null,type:"assembly",name:null,prodTaskTags:null,aor:null}})}),define("app/subdivisions/SubdivisionCollection",["../core/Collection","./Subdivision"],function(e,t){return e.extend({model:t,rqlQuery:"select(division,type,name,prodTaskTags,aor)&sort(division,name)"})}),define("app/data/subdivisions",["app/subdivisions/SubdivisionCollection","./createStorage"],function(e,t){return t("SUBDIVISIONS","subdivisions",e)}),define("app/core/templates/error400",["app/i18n"],function(t){return function anonymous(locals,filters,escape,rethrow){escape=escape||function(e){return String(e).replace(/&(?!#?[a-zA-Z0-9]+;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&#39;").replace(/"/g,"&quot;")};var buf=[];with(locals||{})!function(){buf.push('<p class="well">',t("core","ERROR:400"),"</p>\n")}();return buf.join("")}}),define("app/core/templates/error401",["app/i18n"],function(t){return function anonymous(locals,filters,escape,rethrow){escape=escape||function(e){return String(e).replace(/&(?!#?[a-zA-Z0-9]+;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&#39;").replace(/"/g,"&quot;")};var buf=[];with(locals||{})!function(){buf.push('<p class="well">',t("core","ERROR:401"),"</p>\n")}();return buf.join("")}}),define("app/core/templates/error404",["app/i18n"],function(t){return function anonymous(locals,filters,escape,rethrow){escape=escape||function(e){return String(e).replace(/&(?!#?[a-zA-Z0-9]+;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&#39;").replace(/"/g,"&quot;")};var buf=[];with(locals||{})!function(){buf.push('<p class="well">',t("core","ERROR:404"),"</p>\n")}();return buf.join("")}}),define("app/core/pages/ErrorPage",["app/i18n","../View","app/core/templates/error400","app/core/templates/error401","app/core/templates/error404"],function(e,t,n,r,i){return t.extend({layoutName:"page",pageId:"error",breadcrumbs:function(){return[e.bound("core","BREADCRUMBS:error",{code:this.options.code,codeStr:"e"+this.options.code})]},initialize:function(){var e;switch(this.options.code){case 401:e=r;break;case 404:e=i;break;default:e=n}this.view=new t({template:e})}})}),define("app/user",["jquery","underscore","app/i18n","app/broker","app/socket","app/viewport","app/data/divisions","app/data/subdivisions","app/core/pages/ErrorPage"],function(e,t,n,r,i,o,a,s,u){var l=null;-1!==window.location.search.indexOf("COMPUTERNAME=")&&window.location.search.substr(1).split("&").forEach(function(e){e=e.split("="),"COMPUTERNAME"===e[0]&&e[1]&&(l=e[1])});var c={};return i.on("user.reload",function(e){c.reload(e)}),c.data=t.extend(window.GUEST_USER||{},{name:n.bound("core","GUEST_USER_NAME")}),delete window.GUEST_USER,c.reload=function(e){if(!t.isEqual(e,c.data)){var i=c.isLoggedIn();t.isObject(e)&&Object.keys(e).length>0&&(e.loggedIn===!1&&(e.name=n.bound("core","GUEST_USER_NAME")),c.data=e),r.publish("user.reloaded"),i&&!c.isLoggedIn()&&r.publish("user.loggedOut")}},c.isLoggedIn=function(){return c.data.loggedIn===!0},c.getLabel=function(){return c.data.name?String(c.data.name):c.data.lastName&&c.data.firstName?c.data.firstName+" "+c.data.lastName:c.data.login},c.getInfo=function(){return{id:c.data._id,ip:c.data.ip||c.data.ipAddress||"0.0.0.0",cname:l,label:c.getLabel()}},c.isAllowedTo=function(e){if(c.data.super)return!0;var t=c.data.privileges;if(!t)return!1;if(!e||0===e.length)return c.isLoggedIn();for(var n=[].concat(e),r=0,i=0,o=n.length;o>i;++i)if(e=n[i],"string"==typeof e)for(var a=new RegExp("^"+e.replace("*",".*?")+"$"),s=0,u=t.length;u>s;++s)if(a.test(t[s])){++r;break}return r===n.length},c.hasAccessToAor=function(e){return!e||c.data.super||!c.data.aors||!c.data.aors.length||-1!==c.data.aors.indexOf(e)},c.auth=function(e){return function(t,n,r){c.isAllowedTo(e)?r():o.showPage(new u({code:401,req:t,referer:n}))}},c.getDivision=function(){var e=null;switch(c.data.orgUnitType){case"division":e=c.data.orgUnitId;break;case"subdivision":var t=s.get(c.data.orgUnitId);t&&(e=t.get("division"))}return a.get(e)||null},c.getSubdivision=function(){return"subdivision"!==c.data.orgUnitType?null:s.get(c.data.orgUnitId)||null},c.getRootUserData=function(){return window.ROOT_USER||{id:null,login:"root",name:"root",loggedIn:!0,"super":!0,privileges:[]}},window.user=c,c}),define("app/updater/views/RestartMessageView",["app/core/View"],function(e){return e.extend({destroy:function(){this.el.ownerDocument.body.style.marginBottom=""},afterRender:function(){this.el.ownerDocument.body.style.marginBottom=this.$el.outerHeight()+15+"px"}})}),define("app/updater/templates/backendRestart",["app/i18n"],function(t){return function anonymous(locals,filters,escape,rethrow){escape=escape||function(e){return String(e).replace(/&(?!#?[a-zA-Z0-9]+;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&#39;").replace(/"/g,"&quot;")};var buf=[];with(locals||{})!function(){buf.push('<div class="updater-restart updater-restart-backend">\n  <i class="fa fa-exclamation-triangle updater-restart-icon"></i><span class="updater-restart-message">',t("updater","restart:backend"),"</span>\n</div>\n")}();return buf.join("")}}),define("app/updater/templates/frontendRestart",["app/i18n"],function(t){return function anonymous(locals,filters,escape,rethrow){escape=escape||function(e){return String(e).replace(/&(?!#?[a-zA-Z0-9]+;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&#39;").replace(/"/g,"&quot;")};var buf=[];with(locals||{})!function(){buf.push('<div class="updater-restart updater-restart-frontend">\n  <i class="fa fa-exclamation-circle updater-restart-icon"></i><span class="updater-restart-message">',t("updater","restart:frontend"),"</span>\n</div>\n")}();return buf.join("")}}),function(){function e(e,t,n,r,i,o){t[e]&&(n.push(e),(t[e]===!0||1===t[e])&&r.push(i+e+"/"+o))}function t(e,t,n,r,i){var o=r+t+"/"+i;require._fileExists(e.toUrl(o+".js"))&&n.push(o)}function n(e,t,r){var i;for(i in t)!t.hasOwnProperty(i)||e.hasOwnProperty(i)&&!r?"object"==typeof t[i]&&(!e[i]&&t[i]&&(e[i]={}),n(e[i],t[i],r)):e[i]=t[i]}var r=/(^.*(^|\/)nls(\/|$))([^\/]*)\/?([^\/]*)/;define("i18n",["module"],function(i){var o=i.config?i.config():{};return{version:"2.0.4",load:function(i,a,s,u){u=u||{},u.locale&&(o.locale=u.locale);var l,c,d,p=r.exec(i),f=p[1],h=p[4],m=p[5],g=h.split("-"),y=[],v={},w="";if(p[5]?(f=p[1],l=f+m):(l=i,m=p[4],h=o.locale,h||(h=o.locale="undefined"==typeof navigator?"root":(navigator.language||navigator.userLanguage||"root").toLowerCase()),g=h.split("-")),u.isBuild){for(y.push(l),t(a,"root",y,f,m),c=0;c<g.length;c++)d=g[c],w+=(w?"-":"")+d,t(a,w,y,f,m);a(y,function(){s()})}else a([l],function(t){var r,i=[];for(e("root",t,i,y,f,m),c=0;c<g.length;c++)r=g[c],w+=(w?"-":"")+r,e(w,t,i,y,f,m);a(y,function(){var e,r,o;for(e=i.length-1;e>-1&&i[e];e--)o=i[e],r=t[o],(r===!0||1===r)&&(r=a(f+o+"/"+m)),n(v,r);s(v)})})}}})}(),define("app/nls/locale/en",[],function(){var e={locale:{}};return e.locale.en=function(e){return 1===e?"one":"other"}}),define("app/nls/updater",["app/nls/locale/en"],function(e){var t={locale:{}};t.locale.en=e;return{root:{"restart:backend":function(){return"Application server is being restarted! Communication with the server might not work for a short while..."},"restart:frontend":function(){return"A new version of the application is available! <a href='javascript:window.location.reload()'>Click here to reload the browser</a>..."}},pl:!0}}),define("app/nls/locale/pl",[],function(){var e={locale:{}};
return e.locale.pl=function(e){return 1==e?"one":e%10>=2&&4>=e%10&&(12>e%100||e%100>14)&&e==Math.floor(e)?"few":e%10===0||1!=e&&e%10==1||(e%10>=5&&9>=e%10||e%100>=12&&14>=e%100)&&e==Math.floor(e)?"many":"other"}}),define("app/nls/pl/updater",["app/nls/locale/pl"],function(e){var t={locale:{}};t.locale.pl=e;return{"restart:backend":function(){return"Serwer aplikacji jest restartowany! Komunikacja z serwerem może przez chwilę nie działać..."},"restart:frontend":function(){return"Dostępna jest nowa wersja aplikacji! <a href='javascript:window.location.reload()'>Kliknij tutaj aby przeładować przeglądarkę</a>..."}}}),define("app/updater/index",["../broker","../pubsub","../socket","../viewport","../time","./views/RestartMessageView","app/updater/templates/backendRestart","app/updater/templates/frontendRestart","i18n!app/nls/updater"],function(e,t,n,r,i,o,a,s){function u(){h.versions.time=Date.now(),localStorage.setItem(f,JSON.stringify(h.versions))}function l(){y||(y=!0,E&&(null!==g&&g.remove(),g=new o({template:a,type:"backend"}),r.insertView(g).render(),g.$el.slideDown()),e.subscribe("socket.connected").setLimit(1).on("message",function(){y=!1,null!==g&&g.$el.slideUp(function(){"backend"===g.options.type&&(g.remove(),g=null)}),e.publish("updater.backendRestarted")}),e.publish("updater.backendRestarting"))}function c(){v||(v=!0,window.addEventListener("mousemove",d),window.addEventListener("keypress",d),E&&(null!==g&&g.remove(),g=new o({template:s,type:"frontend"}),r.insertView(g).render(),g.$el.slideDown()),e.publish("updater.frontendRestarting"),d())}function d(){clearTimeout(m),m=setTimeout(p,6e4)}function p(){n.isConnected()&&(w=!0,e.publish("updater.frontendReloading"),window.location.reload())}var f="VERSIONS",h={},m=null,g=null,y=!1,v=!1,w=!1,E=!0,b=window[f],R=JSON.parse(localStorage.getItem(f)||"null");return delete window[f],h.versions=R&&R.time>i.appData?R:b,h.isRestarting=function(){return y||v},h.isBackendRestarting=function(){return y},h.isFrontendRestarting=function(){return v},h.isFrontendReloading=function(){return w},h.enableViews=function(){E=!0},h.disableViews=function(){E=!1},h.pull=function(e){n.emit("updater.pull",e)},u(),n.on("updater.versions",function(e){var t=h.versions;h.versions=e,u(),e.frontend!==t.frontend&&c()}),t.subscribe("updater.newVersion",function(t){e.publish("updater.newVersion",t),"backend"===t.service?l():"frontend"===t.service&&c()}),window.updater=h,h}),define("app/feedback/Feedback",["../user","../time","../updater/index","../core/Model"],function(e,t,n,r){return r.extend({urlRoot:"/feedback",clientUrlRoot:"#feedback",topicPrefix:"feedback",privilegePrefix:"FEEDBACK",nlsDomain:"feedback",defaults:function(){return{creator:e.getInfo(),createdAt:t.getMoment().toDate(),savedAt:null,page:{title:document.title,url:location.href},versions:n.versions,navigator:{userAgent:navigator.userAgent,userLanguage:navigator.userLanguage,platform:navigator.platform,width:screen.width,height:screen.height,innerWidth:window.innerWidth,innerHeight:window.innerHeight},comment:""}}})}),function(e,t){"function"==typeof define&&define.amd?define("form2js",t):e.form2js=t()}(this,function(){function e(e,r,i,o,a){("undefined"==typeof i||null==i)&&(i=!0),("undefined"==typeof r||null==r)&&(r="."),arguments.length<5&&(a=!1),e="string"==typeof e?document.getElementById(e):e;var s,u=[],l=0;if(e.constructor==Array||"undefined"!=typeof NodeList&&e.constructor==NodeList)for(;s=e[l++];)u=u.concat(n(s,o,a));else u=n(e,o,a);return t(u,i,r)}function t(e,t,n){var r,i,o,a,s,u,l,c,d,p,f,h,m,g={},y={};for(r=0;r<e.length;r++)if(s=e[r].value,!t||""!==s&&null!==s){for(h=e[r].name,m=h.split(n),u=[],l=g,c="",i=0;i<m.length;i++)if(f=m[i].split("]["),f.length>1)for(o=0;o<f.length;o++)if(f[o]=0==o?f[o]+"]":o==f.length-1?"["+f[o]:"["+f[o]+"]",p=f[o].match(/([a-z_]+)?\[([a-z_][a-z0-9_]+?)\]/i))for(a=1;a<p.length;a++)p[a]&&u.push(p[a]);else u.push(f[o]);else u=u.concat(f);for(i=0;i<u.length;i++)f=u[i],f.indexOf("[]")>-1&&i==u.length-1?(d=f.substr(0,f.indexOf("[")),c+=d,l[d]||(l[d]=[]),l[d].push(s)):f.indexOf("[")>-1?(d=f.substr(0,f.indexOf("[")),p=f.replace(/(^([a-z_]+)?\[)|(\]$)/gi,""),c+="_"+d+"_"+p,y[c]||(y[c]={}),""==d||l[d]||(l[d]=[]),i==u.length-1?""==d?(l.push(s),y[c][p]=l[l.length-1]):(l[d].push(s),y[c][p]=l[d][l[d].length-1]):y[c][p]||(l[d].push(/^[a-z_]+\[?/i.test(u[i+1])?{}:[]),y[c][p]=l[d][l[d].length-1]),l=y[c][p]):(c+=f,i<u.length-1?(l[f]||(l[f]={}),l=l[f]):l[f]=s)}return g}function n(e,t,n){var o=i(e,t,n);return o.length>0?o:r(e,t,n)}function r(e,t,n){for(var r=[],o=e.firstChild;o;)r=r.concat(i(o,t,n)),o=o.nextSibling;return r}function i(e,t,n){var i,s,u,l=o(e,n);return i=t&&t(e),i&&i.name?u=[i]:""!=l&&e.nodeName.match(/INPUT|TEXTAREA/i)?(s=a(e),u=[{name:l,value:s}]):""!=l&&e.nodeName.match(/SELECT/i)?(s=a(e),u=[{name:l.replace(/\[\]$/,""),value:s}]):u=r(e,t,n),u}function o(e,t){return e.name&&""!=e.name?e.name:t&&e.id&&""!=e.id?e.id:""}function a(e){if(e.disabled)return null;switch(e.nodeName){case"INPUT":case"TEXTAREA":switch(e.type.toLowerCase()){case"radio":if(e.checked&&"false"===e.value)return!1;case"checkbox":if(e.checked&&"true"===e.value)return!0;if(!e.checked&&"true"===e.value)return!1;if(e.checked)return e.value;break;case"button":case"reset":case"submit":case"image":return"";default:return e.value}break;case"SELECT":return s(e)}return null}function s(e){var t,n,r,i=e.multiple,o=[];if(!i)return e.value;for(t=e.getElementsByTagName("option"),n=0,r=t.length;r>n;n++)t[n].selected&&o.push(t[n].value);return o}return e}),function(e,t){"function"==typeof define&&define.amd?define("js2form",t):e.js2form=t()}(this,function(){function e(e,r,o,a,s){arguments.length<3&&(o="."),arguments.length<4&&(a=null),arguments.length<5&&(s=!1);var l,c;l=i(r),c=n(e,s,o,{},!0);for(var d=0;d<l.length;d++){var p=l[d].name,f=l[d].value;"undefined"!=typeof c[p]?t(c[p],f):"undefined"!=typeof c[p.replace(u,"[]")]&&t(c[p.replace(u,"[]")],f)}}function t(e,t){var n,r,i;if(e instanceof Array)for(r=0;r<e.length;r++)(String(e[r].value)==String(t)||t===!0)&&(e[r].checked=!0);else if(d.test(e.nodeName))e.value=t;else if(/SELECT/i.test(e.nodeName))for(n=e.getElementsByTagName("option"),r=0,i=n.length;i>r;r++)if(n[r].value==t){if(n[r].selected=!0,e.multiple)break}else e.multiple||(n[r].selected=!1)}function n(e,t,i,o,a){arguments.length<4&&(o={});for(var s,l,c,d,p,f,h,m={},g=e.firstChild;g;){if(s="",g.name&&""!=g.name?s=g.name:t&&g.id&&""!=g.id&&(s=g.id),""==s){var y=n(g,t,i,o,a);for(c in y)if("undefined"==typeof m[c])m[c]=y[c];else for(d=0;d<y[c].length;d++)m[c].push(y[c][d])}else if(/SELECT/i.test(g.nodeName))for(p=0,h=g.getElementsByTagName("option"),f=h.length;f>p;p++)a&&(h[p].selected=!1),l=r(s,i,o),l=l.replace(u,"[]"),m[l]=g;else/INPUT/i.test(g.nodeName)&&/CHECKBOX|RADIO/i.test(g.type)?(a&&(g.checked=!1),l=r(s,i,o),l=l.replace(u,"[]"),m[l]||(m[l]=[]),m[l].push(g)):(a&&(g.value=""),l=r(s,i,o),m[l]=g);g=g.nextSibling}return m}function r(e,t,n){var r,i,o,a,s,u,d=[],p=e.split(t);for(e=e.replace(c,"[$1].[$2]"),u=0;u<p.length;u++)r=p[u],d.push(r),i=r.match(l),null!=i&&(o=d.join(t),a=o.replace(l,"$3"),o=o.replace(l,"$1"),"undefined"==typeof n[o]&&(n[o]={lastIndex:-1,indexes:{}}),(""==a||"undefined"==typeof n[o].indexes[a])&&(n[o].lastIndex++,n[o].indexes[a]=n[o].lastIndex),s=n[o].indexes[a],d[d.length-1]=r.replace(l,"$1$2"+s+"$4"));return o=d.join(t),o=o.replace("].[","][")}function i(e,t){var n,r,i=[];if(1==arguments.length&&(t=0),null==e)i=[{name:"",value:null}];else if("string"==typeof e||"number"==typeof e||"date"==typeof e||"boolean"==typeof e)i=[{name:"",value:e}];else if(e instanceof Array)for(n=0;n<e.length;n++)r="["+n+"]",i=i.concat(o(e[n],r,t+1));else for(n in e)r=n,i=i.concat(o(e[n],r,t+1));return i}function o(e,t,n){var r,o,u,l=[],c=i(e,n+1);for(o=0;o<c.length;o++)r=t,a.test(c[o].name)?r+=c[o].name:s.test(c[o].name)&&(r+="."+c[o].name),u={name:r,value:c[o].value},l.push(u);return l}var a=/^\[\d+?\]/,s=/^[a-zA-Z_][a-zA-Z_0-9]+/,u=/\[[0-9]+?\]$/,l=/(.*)(\[)([0-9]*)(\])$/,c=/\[([0-9]+)\]\[([0-9]+)\]/g,d=/INPUT|TEXTAREA/i;return e}),define("app/core/views/FormView",["jquery","underscore","form2js","js2form","app/viewport","../View"],function(e,t,n,r,i,o){return o.extend({events:{submit:"submitForm"},idPrefix:"formView",$errorMessage:null,initialize:function(){this.idPrefix=t.uniqueId(this.idPrefix),this.$errorMessage=null,this.listenTo(this.model,"change",function(){this.isRendered()&&r(this.el,this.serializeToForm())})},destroy:function(){this.hideErrorMessage()},serialize:function(){return{editMode:!!this.options.editMode,idPrefix:this.idPrefix,formMethod:this.options.formMethod,formAction:this.options.formAction,formActionText:this.options.formActionText,panelTitleText:this.options.panelTitleText,model:this.model.toJSON()}},afterRender:function(){r(this.el,this.serializeToForm())},serializeToForm:function(){return this.model.toJSON()},serializeForm:function(e){return e},submitForm:function(){if(this.hideErrorMessage(),!this.el.checkValidity())return!1;var e=this.serializeForm(n(this.el));if(!this.checkValidity(e))return!1;var t=this.$('[type="submit"]').attr("disabled",!0),r=this.promised(this.model.save(e,{wait:!0})),i=this;return r.done(function(){"function"==typeof i.options.done?i.options.done(!0):i.broker.publish("router.navigate",{url:i.model.genClientUrl(),trigger:!0})}),r.fail(this.handleFailure.bind(this)),r.always(function(){t.attr("disabled",!1)}),!1},hideErrorMessage:function(){null!==this.$errorMessage&&(i.msg.hide(this.$errorMessage),this.$errorMessage=null)},checkValidity:function(e){return!!e},handleFailure:function(){this.$errorMessage=i.msg.show({type:"error",text:this.options.failureText})}})}),define("app/feedback/templates/form",["app/i18n"],function(t){return function anonymous(locals,filters,escape,rethrow){escape=escape||function(e){return String(e).replace(/&(?!#?[a-zA-Z0-9]+;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&#39;").replace(/"/g,"&quot;")};var buf=[];with(locals||{})!function(){buf.push('<form class="feedback-form" method="post" action="/feedback">\n  <div class="form-group">\n    <label for="',idPrefix,'-page-title" class="control-label">',t("feedback","property:page:title"),'</label>\n    <input id="',idPrefix,'-page-title" class="form-control" type="text" name="page.title" readonly>\n  </div>\n  <div class="form-group">\n    <label for="',idPrefix,'-page-url" class="control-label">',t("feedback","property:page:url"),'</label>\n    <input id="',idPrefix,'-page-url" class="form-control" type="text" name="page.url" readonly>\n  </div>\n  <div class="form-group">\n    <label for="',idPrefix,'-comment" class="control-label">',t("feedback","property:comment"),'</label>\n    <textarea id="',idPrefix,'-comment" class="form-control" name="comment" rows="10" placeholder="',t("feedback","comment:placeholder"),'" autofocus required></textarea>\n  </div>\n  <div class="form-actions">\n    <button type="submit" class="btn btn-primary">',t("feedback","form:submit"),"</button>\n  </div>\n</form>\n")}();return buf.join("")}}),define("app/feedback/views/FeedbackFormView",["app/core/views/FormView","app/feedback/templates/form"],function(e,t){return e.extend({template:t,events:{submit:"submitForm","blur textarea":function(e){e.currentTarget.value=e.currentTarget.value.trim()}},serializeForm:function(e){return e.createdAt=new Date,e},destroy:function(){e.prototype.destroy.call(this),"function"==typeof this.options.done&&this.options.done(!1)}})}),define("app/nls/feedback",["app/nls/locale/en"],function(e){var t={locale:{}};t.locale.en=e;return{root:{"dialog:title":function(){return"Feedback"},"form:submit":function(){return"Send feedback"},"form:message:failure":function(){return"Failed to send the feedback :("},"form:message:success":function(){return"Feedback was delivered successfully - thank you :)"},"property:page:title":function(){return"Current page title"},"property:page:url":function(){return"Current page URL"},"property:comment":function(){return"Comment"},"comment:placeholder":function(){return"Bugs, notes, opinions, ideas..."}},pl:!0}}),define("app/nls/pl/feedback",["app/nls/locale/pl"],function(e){var t={locale:{}};t.locale.pl=e;return{"dialog:title":function(){return"Feedback"},"form:submit":function(){return"Wyślij feedback"},"form:message:failure":function(){return"Nie udało się wysłać formularza :("},"form:message:success":function(){return"Komentarz został zapisany pomyślnie - dziękujemy :)"},"property:page:title":function(){return"Tytuł wyświetlanej strony"},"property:page:url":function(){return"Adres wyświetlanej strony"},"property:comment":function(){return"Komentarz"},"comment:placeholder":function(){return"Błędy, uwagi, opinie, pomysły..."}}}),define("domReady",[],function(){function e(e){var t;for(t=0;t<e.length;t+=1)e[t](l)}function t(){var t=c;u&&t.length&&(c=[],e(t))}function n(){u||(u=!0,a&&clearInterval(a),t())}function r(e){return u?e(l):c.push(e),r}var i,o,a,s="undefined"!=typeof window&&window.document,u=!s,l=s?document:null,c=[];if(s){if(document.addEventListener)document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1);else if(window.attachEvent){window.attachEvent("onload",n),o=document.createElement("div");try{i=null===window.frameElement}catch(d){}o.doScroll&&i&&window.external&&(a=setInterval(function(){try{o.doScroll(),n()}catch(e){}},30))}"complete"===document.readyState&&n()}return r.version="2.0.1",r.load=function(e,t,n,i){i.isBuild?n(null):r(n)},r}),define("app/core/Request",["underscore","h5.rql/index","./util"],function(e,t,n){function r(e){"/"!==e[0]&&(e="/"+e);var t=e.match(i);this.url=e,this.path=("/"===t[1][0]?"":"/")+t[1],this.queryString=t[2]||"",this.fragment=t[3]||"",this.params={},this.query={},this.rql={},""!==this.queryString&&this.defineGetters()}var i=/^\/(.*?)(?:\?(.*?))?(?:#(.*?))?$/;return r.prototype.defineGetters=function(){Object.defineProperty(this,"query",{enumerable:!0,configurable:!0,get:function(){return this.parseQueryString()},set:function(e){this.query=e}}),Object.defineProperty(this,"rql",{enumerable:!0,configurable:!0,get:function(){return this.parseRqlString()},set:function(e){this.rql=e}})},r.prototype.parseQueryString=function(){delete this.query;for(var t=this.queryString.split("&"),r={},i=0,o=t.length;o>i;++i){var a=t[i],s=e.indexOf(a,"=");if(-1!==s){var u=n.decodeUriComponent(a.substr(0,s)),l=n.decodeUriComponent(a.substr(s+1));r[u]=l}}return this.query=r,r},r.prototype.parseRqlString=function(){return delete this.rql,this.rql=t.parse(this.queryString),this.rql},r}),define("app/core/Router",["underscore","./util","./Request"],function(e,t,n){function r(e){this.broker=e,this.routes=[],this.dispatching=!1,this.dispatchQueue=[],this.currentRequest=null,this.previousUrl=null}function i(n,r){return function(i){var o=n.exec(i.path);if(null===o)return!1;var a=o.length;if(1===a)return!0;var s,u=e.isArray(r)?r.length:0;if(a===u+1)for(s=0;u>s;++s)i.params[r[s]]=t.decodeUriComponent(o[s+1]);else for(s=0;a>s;++s)i.params[s]=t.decodeUriComponent(o[s]);return!0}}var o=/([:*])([\w\-]+)?/g,a=/[\-\[\]{}()+?.,\\\^$|#\s]/g;return r.prototype.getCurrentRequest=function(){return this.currentRequest},r.prototype.map=function(e){var t=Array.prototype.slice.call(arguments);t.shift(),this.routes.unshift(this.createMatcher(e),t)},r.prototype.navigate=function(t,n){this.broker.publish("router.navigate",e.extend({url:t},n))},r.prototype.replace=function(e){this.broker.publish("router.navigate",{url:e,trigger:!0,replace:!0})},r.prototype.update=function(e){this.broker.publish("router.navigate",{url:e,trigger:!1,replace:!0})},r.prototype.dispatch=function(t){if(!e.isUndefined(t)){if(null===t&&(t="/"),this.dispatching)return void this.dispatchQueue.push(t);this.dispatching=!0;var r=new n(t);this.broker.publish("router.dispatching",r);var i=this.match(r);if(null===i){this.dispatching=!1;var o=this.dispatchQueue.shift();e.isUndefined(o)?this.broker.publish("router.404",r):this.dispatch(o)}else this.broker.publish("router.matched",{handlers:i,req:r}),e.defer(this.execute.bind(this,i,r))}},r.prototype.match=function(e){for(var t=this.routes,n=0,r=t.length;r>n;n+=2){var i=t[n];if(i(e))return t[n+1]}return null},r.prototype.execute=function(e,t){function n(i){i+1<e.length?e[i](t,r,n.bind(null,i+1)):e[i](t,r)}this.currentRequest=t,this.broker.publish("router.executing",{handlers:e,req:t});var r=this.previousUrl;n(0),this.previousUrl=t.url,this.dispatching=!1,this.dispatch(this.dispatchQueue.shift())},r.prototype.createMatcher=function(t){if(t instanceof RegExp)return i(t);if(t=t.trim(),""===t||"/"===t)return function(e){return""===e.path||"/"===e.path};var n=[],r=!1,s=t.replace(a,"\\$&");return s=s.replace(o,function(t,i,o){return r=!0,e.isUndefined(o)?"*"===i?".*":t:(n.push(o),"*"===i?"(.*?)":"([^/#?;]*)")}),r?i(new RegExp("^"+s+"$"),n):function(e){return e.path===t}},r}),define("app/router",["backbone","app/broker","app/viewport","app/core/Router","app/core/pages/ErrorPage"],function(e,t,n,r,i){e.Router.prototype._extractParameters=function(e,t){return e.exec(t).slice(1)};var o=new r(t),a=new e.Router;a.route("*catchall","catchall",function(e){o.dispatch(e)}),t.subscribe("router.navigate",function(e){var t=e.url,n=t.charAt(0);("#"===n||"/"===n)&&(t=t.substr(1)),a.navigate(t,{trigger:e.trigger===!0,replace:e.replace===!0})});var s="/404";return t.subscribe("router.404",function(e){e.path===s?n.showPage(new i({code:404,req:e})):o.dispatch(s)}),window.router=o,o}),define("app/core/templates/pageLayout",["app/i18n"],function(t){return function anonymous(locals,filters,escape,rethrow){escape=escape||function(e){return String(e).replace(/&(?!#?[a-zA-Z0-9]+;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&#39;").replace(/"/g,"&quot;")};var buf=[];with(locals||{})!function(){buf.push('<div class="page">\n  <div class="hd">\n    <nav class="navbar navbar-default navbar-fixed-top"></nav>\n    <div class="page-alerts"></div>\n    <div class="page-header">\n      <ul class="page-actions"></ul>\n      <ul class="page-breadcrumbs"></ul>\n    </div>\n  </div>\n  <div class="bd"></div>\n  <div class="ft">\n    <p>\n      by <a href="http://walkner.pl/">walkner.pl</a>\n    </p>\n  </div>\n</div>\n')}();return buf.join("")}}),define("app/core/layouts/PageLayout",["underscore","jquery","app/user","../View","app/core/templates/pageLayout"],function(e,t,n,r,i){var o=r.extend({pageContainerSelector:".bd",template:i});return o.prototype.initialize=function(){this.model={id:null,actions:[],breadcrumbs:[],title:null},this.$header=null,this.$breadcrumbs=null,this.$actions=null},o.prototype.destroy=function(){this.el.ownerDocument&&this.el.ownerDocument.body.classList.remove("page"),this.$breadcrumbs=null,this.$actions=null},o.prototype.afterRender=function(){this.el.ownerDocument&&this.el.ownerDocument.body.classList.add("page"),this.$header=this.$(".page-header").first(),this.$breadcrumbs=this.$(".page-breadcrumbs").first(),this.$actions=this.$(".page-actions").first(),this.changeTitle(),this.renderBreadcrumbs(),this.renderActions(),null!==this.model.id&&this.setId(this.model.id)},o.prototype.reset=function(){this.setId(null),this.model.title=null,this.$header&&this.$header.hide(),this.$breadcrumbs&&(this.model.breadcrumbs=[],this.$breadcrumbs.empty()),this.$actions&&(this.model.actions=[],this.$actions.empty()),this.removeView(this.pageContainerSelector)},o.prototype.setUpPage=function(e){e.pageId&&this.setId(e.pageId),e.breadcrumbs?this.setBreadcrumbs(e.breadcrumbs,e):e.title?this.setTitle(e.title,e):this.changeTitle(),e.actions&&this.setActions(e.actions,e)},o.prototype.setId=function(e){return this.isRendered()&&this.$el.attr("data-id",e),this.model.id=e,this},o.prototype.setBreadcrumbs=function(e,t){return null==e?this:("function"==typeof e&&(e=e.call(t,this)),Array.isArray(e)||(e=[e]),this.model.breadcrumbs=e.map(function(e){var t=typeof e;return("string"===t||"function"===t)&&(e={label:e,href:null}),"string"==typeof e.href&&"#"!==e.href[0]&&(e.href="#"+e.href),e}),this.$breadcrumbs&&this.renderBreadcrumbs(),this.changeTitle(),this)},o.prototype.setTitle=function(e,t){return null==e?this:("function"==typeof e&&(e=e.call(t,this)),Array.isArray(e)||(e=[e]),this.model.title=e,this.changeTitle(),this)},o.prototype.setActions=function(e,t){return null==e?this:("function"==typeof e&&(e=e.call(t,this)),e?(Array.isArray(e)||(e=[e]),this.model.actions=e.map(this.prepareAction.bind(this)),this.$actions&&this.renderActions(),this):this)},o.prototype.prepareAction=function(e){if(e.prepared)return e;if("string"==typeof e.href){var t=e.href.charAt(0);"#"!==t&&"/"!==t&&(e.href="#"+e.href)}else e.href=null;return"string"==typeof e.icon&&(e.icon="fa-"+e.icon.split(" ").join(" fa-")),"string"!=typeof e.className&&(e.className=""),e.className="btn btn-"+(e.type||"default")+" "+e.className,e.prepared=!0,e},o.prototype.renderBreadcrumbs=function(){for(var e=this.model.breadcrumbs,t="",n=0,r=e.length;r>n;++n){var i=e[n];t+="<li>",t+=n!==r-1&&i.href?'<a href="'+i.href+'">'+i.label+"</a>":i.label}this.$breadcrumbs.html(t),this.$header.show()},o.prototype.renderActions=function(){for(var t=this.model.actions,r={},i={},o="",a=0,s=t.length;s>a;++a){var u=t[a];(!u.privileges||(!e.isFunction(u.privileges)||u.privileges())&&n.isAllowedTo(u.privileges))&&("function"==typeof u.callback&&(r[a]=u.callback.bind(this)),"function"==typeof u.afterRender&&(i[a]=u.afterRender.bind(this)),o+='<li data-index="'+a+'">',"function"==typeof u.template?o+=u.template(u):(o+=null===u.href?'<button class="'+u.className+'">':'<a class="'+u.className+'" href="'+u.href+'">',"string"==typeof u.icon&&(o+='<i class="fa '+u.icon+'"></i>'),o+="<span>"+u.label+"</span>"+(u.href?"</a>":"</button>")))}this.$actions.html(o);var l=this.$actions.find("li");Object.keys(r).forEach(function(e){l.filter('li[data-index="'+e+'"]').click(t[e].callback)}),Object.keys(i).forEach(function(e){i[e](l.filter('li[data-index="'+e+'"]'),t[e])}),this.$header.show()},o.prototype.changeTitle=function(){if(this.isRendered()){var t=Array.isArray(this.model.title)?[].concat(this.model.title):e.pluck(this.model.breadcrumbs,"label");this.broker.publish("page.titleChanged",t)}},o}),define("app/core/templates/printLayout",["app/i18n"],function(t){return function anonymous(locals,filters,escape,rethrow){escape=escape||function(e){return String(e).replace(/&(?!#?[a-zA-Z0-9]+;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&#39;").replace(/"/g,"&quot;")};var buf=[];with(locals||{})!function(){buf.push('<div class="printLayout">\n  <div class="print-pages">\n    <div class="print-page">\n      <div class="print-page-hd">\n        <p class="print-page-hd-right"></p>\n        <p class="print-page-hd-left"></p>\n      </div>\n      <div class="print-page-bd"></div>\n      <div class="print-page-ft">\n        <p class="print-page-ft-right">',t("emptyOrders","PRINT_PAGE:FT:PAGE_NO"),'</p>\n        <p class="print-page-ft-left">',t("emptyOrders","PRINT_PAGE:FT:INFO"),"</p>\n      </div>\n    </div>\n  </div>\n</div>\n")}();return buf.join("")}}),define("app/core/layouts/PrintLayout",["underscore","jquery","moment","app/user","../View","app/core/templates/printLayout"],function(e,t,n,r,i,o){var a=i.extend({pageContainerSelector:".print-page-bd",template:o});return a.prototype.initialize=function(){this.model={id:null,actions:[],breadcrumbs:[]}},a.prototype.destroy=function(){this.el.ownerDocument&&this.el.ownerDocument.body.classList.remove("print")},a.prototype.afterRender=function(){this.changeTitle(),null!==this.model.id&&this.setId(this.model.id),this.el.ownerDocument&&this.el.ownerDocument.body.classList.add("print")},a.prototype.reset=function(){this.setId(null),this.model.breadcrumbs=[],this.removeView(this.pageContainerSelector)},a.prototype.setUpPage=function(e){e.pageId&&this.setId(e.pageId),e.breadcrumbs?this.setBreadcrumbs(e.breadcrumbs,e):this.changeTitle(),this.listenTo(e,"afterRender",this.fitToPrintablePage)},a.prototype.setId=function(e){return this.isRendered()&&this.$el.attr("data-id",e),this.model.id=e,this},a.prototype.setBreadcrumbs=function(e,t){return null==e?this:("function"==typeof e&&(e=e.call(t)),Array.isArray(e)||(e=[e]),this.model.breadcrumbs=e.map(function(e){var t=typeof e;return("string"===t||"function"===t)&&(e={label:e}),e}),this.changeTitle(),this)},a.prototype.changeTitle=function(){this.isRendered()&&this.broker.publish("page.titleChanged",e.pluck(this.model.breadcrumbs,"label"))},a.prototype.fitToPrintablePage=function(i){var o=this.$(".print-pages"),a=o.find(".print-page"),s=a.find(".print-page-hd"),u=a.find(".print-page-ft"),l=a.find(".print-page-bd"),c=t('<div class="print-page-bd-container"></div>');e.isFunction(i.hdLeft)&&s.find(".print-page-hd-left").text(i.hdLeft.call(i)),e.isFunction(i.hdRight)&&s.find(".print-page-hd-right").text(i.hdRight.call(i));var d,p=1122,f={top:parseFloat(a.css("padding-top"))||0,left:parseFloat(a.css("padding-left"))||0,right:parseFloat(a.css("padding-right"))||0,bottom:parseFloat(a.css("padding-bottom"))||0},h=s.outerHeight(!0),m=u.outerHeight(!0),g=p-f.top-f.bottom-h-m;d=e.isFunction(i.fitToPrintablePage)?i.fitToPrintablePage.call(i,g):e.isObject(i.view)&&e.isFunction(i.view.fitToPrintablePage)?i.view.fitToPrintablePage.call(i,g):[i.$el.detach()],c.height(g),l.wrap(c),a.detach(),d.forEach(function(e,t){var n=a.clone();n.find(".print-page-bd").append(e),n.find(".print-page-no").text(t+1),n.addClass("print-page-fit"),o.append(n)}),a.remove(),this.$(".print-page-count").text(d.length),this.$(".print-page-date").text(n().format("LLL")),this.$(".print-page-user").text(r.data.name||r.data.login)},a}),define("app/core/templates/blankLayout",["app/i18n"],function(t){return function anonymous(locals,filters,escape,rethrow){escape=escape||function(e){return String(e).replace(/&(?!#?[a-zA-Z0-9]+;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&#39;").replace(/"/g,"&quot;")};var buf=[];with(locals||{})!function(){buf.push('<div class="blankLayout">\n  <div class="blank-page-bd"></div>\n</div>\n')}();return buf.join("")}}),define("app/core/layouts/BlankLayout",["underscore","jquery","moment","app/user","../View","app/core/templates/blankLayout"],function(e,t,n,r,i,o){var a=i.extend({pageContainerSelector:".blank-page-bd",template:o});return a.prototype.initialize=function(){this.model={breadcrumbs:[]}},a.prototype.afterRender=function(){this.changeTitle()},a.prototype.reset=function(){this.removeView(this.pageContainerSelector)},a.prototype.setUpPage=function(e){e.breadcrumbs?this.setBreadcrumbs(e.breadcrumbs,e):this.changeTitle()},a.prototype.setBreadcrumbs=function(e,t){return null==e?this:("function"==typeof e&&(e=e.call(t)),Array.isArray(e)||(e=[e]),this.model.breadcrumbs=e.map(function(e){var t=typeof e;return("string"===t||"function"===t)&&(e={label:e}),e}),this.changeTitle(),this)},a.prototype.changeTitle=function(){this.isRendered()&&this.broker.publish("page.titleChanged",e.pluck(this.model.breadcrumbs,"label"))},a}),define("app/core/templates/navbar",["app/i18n"],function(t){return function anonymous(locals,filters,escape,rethrow){escape=escape||function(e){return String(e).replace(/&(?!#?[a-zA-Z0-9]+;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&#39;").replace(/"/g,"&quot;")};var buf=[];with(locals||{})!function(){buf.push('<div class="navbar-inner">\n  <div class="navbar-header">\n    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">\n      <span class="sr-only">',t("core","NAVBAR:TOGGLE"),'</span>\n      <span class="icon-bar"></span>\n      <span class="icon-bar"></span>\n      <span class="icon-bar"></span>\n    </button>\n    <a class="navbar-brand fa fa-cogs" href="#"></a>\n  </div>\n  <div class="collapse navbar-collapse">\n    <ul class="nav navbar-nav">\n      <li><a href="#">',t("core","NAVBAR:DASHBOARD"),'</a>\n      <li data-online data-privilege="EVENTS:VIEW"><a href="#events">',t("core","NAVBAR:EVENTS"),'</a>\n      <li data-online data-privilege="FTE:*" class="dropdown">\n        <a class="dropdown-toggle" data-toggle="dropdown">\n          ',t("core","NAVBAR:FTE"),'\n          <b class="caret"></b>\n        </a>\n        <ul class="dropdown-menu">\n          <li data-privilege="FTE:MASTER:*" class="dropdown-header">',t("core","NAVBAR:FTE:MASTER"),'\n          <li data-privilege="FTE:MASTER:VIEW"><a href="#fte/master">',t("core","NAVBAR:FTE:MASTER:LIST"),'</a>\n          <li data-privilege="FTE:MASTER:MANAGE"><a href="#fte/master;add">',t("core","NAVBAR:FTE:MASTER:CURRENT"),'</a>\n          <li data-privilege="FTE:MASTER:* FTE:LEADER:*" class="divider">\n          <li data-privilege="FTE:LEADER:*" class="dropdown-header">',t("core","NAVBAR:FTE:LEADER"),'\n          <li data-privilege="FTE:LEADER:VIEW"><a href="#fte/leader">',t("core","NAVBAR:FTE:LEADER:LIST"),'</a>\n          <li data-privilege="FTE:LEADER:MANAGE"><a href="#fte/leader;add">',t("core","NAVBAR:FTE:LEADER:CURRENT"),'</a>\n        </ul>\n      <li data-online data-privilege="HOURLY_PLANS:VIEW"><a href="#hourlyPlans">',t("core","NAVBAR:HOURLY_PLANS"),'</a>\n      <li data-online class="dropdown">\n        <a class="dropdown-toggle" data-toggle="dropdown">\n          ',t("core","NAVBAR:PROD"),'\n          <b class="caret"></b>\n        </a>\n        <ul class="dropdown-menu">\n          <li data-privilege="PRESS_WORKSHEETS:VIEW"><a href="#pressWorksheets">',t("core","NAVBAR:PRESS_WORKSHEETS"),'</a>\n          <li data-privilege="PROD_DATA:VIEW"><a href="#prodLogEntries">',t("core","NAVBAR:PROD:LOG_ENTRIES"),'</a>\n          <li data-privilege="PROD_DATA:VIEW"><a href="#prodShifts">',t("core","NAVBAR:PROD:SHIFTS"),'</a>\n          <li data-privilege="PROD_DATA:VIEW"><a href="#prodShiftOrders">',t("core","NAVBAR:PROD:SHIFT_ORDERS"),'</a>\n          <li data-privilege="PROD_DOWNTIMES:VIEW"><a href="#prodDowntimes">',t("core","NAVBAR:PROD:DOWNTIMES"),'</a>\n          <li data-privilege="XICONF:VIEW" class="divider">\n          <li data-privilege="XICONF:VIEW" class="dropdown-header">',t("core","NAVBAR:XICONF"),'\n          <li data-privilege="XICONF:VIEW"><a href="#xiconf/results">',t("core","NAVBAR:XICONF:RESULTS"),'</a>\n        </ul>\n      <li class="dropdown" data-online>\n        <a class="dropdown-toggle" data-toggle="dropdown">\n          ',t("core","NAVBAR:REPORTS"),'\n          <b class="caret"></b>\n        </a>\n        <ul class="dropdown-menu">\n          <li data-privilege="REPORTS:VIEW"><a href="#reports/1">',t("core","NAVBAR:REPORTS:1"),'</a>\n          <li data-privilege="REPORTS:VIEW"><a href="#reports/2">',t("core","NAVBAR:REPORTS:2"),'</a>\n          <li data-privilege="REPORTS:VIEW"><a href="#reports/3">',t("core","NAVBAR:REPORTS:3"),'</a>\n          <li data-privilege="REPORTS:VIEW"><a href="#reports/4">',t("core","NAVBAR:REPORTS:4"),'</a>\n          <li data-privilege="REPORTS:VIEW" class="divider">\n          <li><a href="#vis/structure">',t("core","NAVBAR:VIS:STRUCTURE"),'</a>\n        </ul>\n      <li data-online class="dropdown">\n        <a class="dropdown-toggle" data-toggle="dropdown">\n          ',t("core","NAVBAR:DICTIONARIES"),'\n          <b class="caret"></b>\n        </a>\n        <ul class="dropdown-menu">\n          <li data-privilege="ORDERS:VIEW"><a href="#mechOrders">',t("core","NAVBAR:MECH_ORDERS"),'</a>\n          <li data-privilege="ORDERS:VIEW"><a href="#orders">',t("core","NAVBAR:OTHER_ORDERS"),'</a>\n          <li data-privilege="ORDERS:VIEW"><a href="#emptyOrders">',t("core","NAVBAR:EMPTY_ORDERS"),'</a>\n          <li data-privilege="USERS:VIEW ORDERS:VIEW" class="divider">\n          <li data-privilege="USERS:VIEW"><a href="#users">',t("core","NAVBAR:USERS"),'</a>\n          <li data-privilege="DICTIONARIES:VIEW USERS:VIEW" class="divider">\n          <li data-privilege="DICTIONARIES:VIEW"><a href="#divisions">',t("core","NAVBAR:DIVISIONS"),'</a>\n          <li data-privilege="DICTIONARIES:VIEW"><a href="#subdivisions">',t("core","NAVBAR:SUBDIVISIONS"),'</a>\n          <li data-privilege="DICTIONARIES:VIEW"><a href="#mrpControllers">',t("core","NAVBAR:MRP_CONTROLLERS"),'</a>\n          <li data-privilege="DICTIONARIES:VIEW"><a href="#prodFlows">',t("core","NAVBAR:PROD_FLOWS"),'</a>\n          <li data-privilege="DICTIONARIES:VIEW"><a href="#workCenters">',t("core","NAVBAR:WORK_CENTERS"),'</a>\n          <li data-privilege="DICTIONARIES:VIEW"><a href="#prodLines">',t("core","NAVBAR:PROD_LINES"),'</a>\n          <li data-privilege="DICTIONARIES:VIEW"><a href="#aors">',t("core","NAVBAR:AORS"),'</a>\n          <li data-privilege="DICTIONARIES:VIEW" class="divider">\n          <li data-privilege="DICTIONARIES:VIEW"><a href="#companies">',t("core","NAVBAR:COMPANIES"),'</a>\n          <li data-privilege="DICTIONARIES:VIEW"><a href="#prodFunctions">',t("core","NAVBAR:PROD_FUNCTIONS"),'</a>\n          <li data-privilege="DICTIONARIES:VIEW"><a href="#prodTasks">',t("core","NAVBAR:PROD_TASKS"),'</a>\n          <li data-privilege="DICTIONARIES:VIEW"><a href="#orderStatuses">',t("core","NAVBAR:ORDER_STATUSES"),'</a>\n          <li data-privilege="DICTIONARIES:VIEW"><a href="#downtimeReasons">',t("core","NAVBAR:DOWNTIME_REASONS"),'</a>\n          <li data-privilege="DICTIONARIES:VIEW"><a href="#lossReasons">',t("core","NAVBAR:LOSS_REASONS"),'</a>\n        </ul>\n    </ul>\n    <ul class="nav navbar-nav navbar-right">\n      <li class="dropdown navbar-account-dropdown">\n        <a href="#account" class="dropdown-toggle" data-toggle="dropdown">\n          <i class="fa fa-user fa-lg navbar-account-status"></i>\n          ',user.getLabel(),'\n          <b class="caret"></b>\n        </a>\n        <ul class="dropdown-menu">\n          <li data-online><a href="#users/',user.data._id,'">',t("core","NAVBAR:MY_ACCOUNT"),'</a>\n          <li class="divider">\n          <li class="dropdown-header">',t("core","NAVBAR:UI_LOCALE"),'\n          <li><a class="navbar-account-locale" href="#" data-locale="pl">',t("core","NAVBAR:LOCALE_PL"),'</a>\n          <li><a class="navbar-account-locale" href="#" data-locale="en">',t("core","NAVBAR:LOCALE_US"),'</a>\n          <li class="divider">\n          <li data-loggedin="false"><a class="navbar-account-logIn" href="#login">',t("core","NAVBAR:LOG_IN"),'</a>\n          <li data-loggedin><a class="navbar-account-logOut" href="/logout">',t("core","NAVBAR:LOG_OUT"),'</a>\n        </ul>\n      </li>\n    </ul>\n    <button class="btn btn-warning navbar-btn navbar-right navbar-feedback" type="button" title="',t("core","feedback:button:tooltip"),'">',t("core","feedback:button:text"),"</button>\n  </div>\n</div>\n")
}();return buf.join("")}}),define("app/core/views/NavbarView",["jquery","underscore","app/i18n","app/user","../View","app/core/templates/navbar"],function(e,t,n,r,i,o){var a=i.extend({template:o,localTopics:{"router.executing":function(e){this.activateNavItem(this.getModuleNameFromPath(e.req.path))},"socket.connected":function(){this.setConnectionStatus("online")},"socket.connecting":function(){this.setConnectionStatus("connecting")},"socket.connectFailed":function(){this.setConnectionStatus("offline")},"socket.disconnected":function(){this.setConnectionStatus("offline")}},events:{"click .disabled a":function(e){e.preventDefault()},"click .navbar-account-locale":function(e){e.preventDefault(),this.changeLocale(e.currentTarget.getAttribute("data-locale"))},"click .navbar-account-logIn":function(e){e.preventDefault(),this.trigger("logIn")},"click .navbar-account-logOut":function(e){e.preventDefault(),this.trigger("logOut")},"click .navbar-feedback":function(e){e.preventDefault(),e.target.disabled=!0,this.trigger("feedback",function(){e.target.disabled=!1})}}});return a.DEFAULT_OPTIONS={currentPath:"/",activeItemClassName:"active",offlineStatusClassName:"navbar-status-offline",onlineStatusClassName:"navbar-status-online",connectingStatusClassName:"navbar-status-connecting"},a.prototype.initialize=function(){t.defaults(this.options,a.DEFAULT_OPTIONS),this.activeModuleName="",this.navItems=null,this.$activeNavItem=null,this.activateNavItem(this.getModuleNameFromPath(this.options.currentPath))},a.prototype.beforeRender=function(){this.navItems=null,this.$activeNavItem=null},a.prototype.afterRender=function(){this.selectActiveNavItem(),this.setConnectionStatus(this.socket.isConnected()?"online":"offline"),this.hideNotAllowedEntries(),this.hideEmptyEntries()},a.prototype.serialize=function(){return{user:r}},a.prototype.activateNavItem=function(e){e!==this.activeModuleName&&(this.activeModuleName=e,this.selectActiveNavItem())},a.prototype.changeLocale=function(e){n.reload(e)},a.prototype.setConnectionStatus=function(e){if(this.isRendered()){var t=this.$(".navbar-account-status");t.removeClass(this.options.offlineStatusClassName).removeClass(this.options.onlineStatusClassName).removeClass(this.options.connectingStatusClassName),t.addClass(this.options[e+"StatusClassName"]),this.toggleConnectionStatusEntries("online"===e)}},a.prototype.getModuleNameFromPath=function(e){if("/"===e[0]&&(e=e.substr(1)),""===e)return"";var t=e.match(/^([a-z0-9][a-z0-9\-]*[a-z0-9]*)/i);return t?t[1]:null},a.prototype.selectActiveNavItem=function(){if(this.isRendered()){null===this.navItems&&this.cacheNavItems();var e=this.options.activeItemClassName;null!==this.$activeNavItem&&this.$activeNavItem.removeClass(e);var n=this.navItems[this.activeModuleName];t.isUndefined(n)?this.$activeNavItem=null:(n.addClass(e),this.$activeNavItem=n)}},a.prototype.cacheNavItems=function(){this.navItems={},this.$(".nav > li").each(this.cacheNavItem.bind(this))},a.prototype.cacheNavItem=function(e,t){var n=this.$(t);n.hasClass(this.options.activeItemClassName)&&(this.$activeNavItem=n);var r=n.find("a").attr("href");if(r&&"#"===r[0]){var i=this.getModuleNameFromPath(r.substr(1));this.navItems[i]=n}else if(n.hasClass("dropdown")){var o=this;n.find(".dropdown-menu > li > a").each(function(){var e=this.getAttribute("href");if(e&&"#"===e[0]){var t=o.getModuleNameFromPath(e.substr(1));o.navItems[t]=n}})}},a.prototype.hideNotAllowedEntries=function(){var e=this;this.$("li[data-privilege]").each(function(){var t=e.$(this),n=t.attr("data-privilege").split(" ");t[r.isAllowedTo(n)?"show":"hide"]()}),this.$("li[data-loggedin]").each(function(){var t=e.$(this),n=t.attr("data-loggedin"),i="false"===n?!r.isLoggedIn():r.isLoggedIn();t[i?"show":"hide"]()})},a.prototype.hideEmptyEntries=function(){this.$(".dropdown > .dropdown-menu").each(function(){var t=e(this),n=!1;t.children().each(function(){n=n||"none"!==this.style.display}),t.parent().toggle(n)})},a.prototype.toggleConnectionStatusEntries=function(e){var t=this;this.$("li[data-online]").each(function(){var n=t.$(this);if("undefined"!=typeof n.attr("data-disabled"))return n.addClass("disabled");switch(n.attr("data-online")){case"show":n[e?"show":"hide"]();break;case"hide":n[e?"hide":"show"]();break;default:n[e?"removeClass":"addClass"]("disabled")}})},a}),define("app/core/templates/logInForm",["app/i18n"],function(t){return function anonymous(locals,filters,escape,rethrow){escape=escape||function(e){return String(e).replace(/&(?!#?[a-zA-Z0-9]+;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&#39;").replace(/"/g,"&quot;")};var buf=[];with(locals||{})!function(){buf.push('<form class="logInForm" method="post" action="/login">\n  <div class="form-group">\n    <input name="login" type="text" class="form-control input-lg" placeholder="',t("core","LOG_IN_FORM:LABEL:LOGIN"),'" autofocus>\n  </div>\n  <div class="form-group">\n    <input name="password" type="password" class="form-control input-lg" placeholder="',t("core","LOG_IN_FORM:LABEL:PASSWORD"),'">\n  </div>\n  <button class="btn btn-block btn-lg btn-primary logInForm-submit" type="submit">\n    <i class="fa fa-spinner fa-spin logInForm-submit-spinner"></i>\n    <span class="logInForm-submit-label">',t("core","LOG_IN_FORM:LABEL:SUBMIT"),"</span>\n  </button>\n</form>\n")}();return buf.join("")}}),define("app/core/views/LogInFormView",["jquery","app/user","../View","app/core/templates/logInForm"],function(e,t,n,r){return n.extend({template:r,events:{submit:"submitForm","keypress input":function(){this.$submitEl.removeClass("btn-danger").addClass("btn-primary")}},destroy:function(){this.$submitEl=null},afterRender:function(){this.$('input[name="login"]').focus(),this.$submitEl=this.$(".logInForm-submit")},submitForm:function(){if(!this.$submitEl.hasClass("btn-primary"))return!1;var n={login:this.$("[name=login]").val(),password:this.$("[name=password]").val(),socketId:this.socket.getId()};if(0===n.login.length||0===n.password.length)return!1;this.$el.addClass("logInForm-loading"),this.$submitEl.attr("disabled",!0);var r=e.ajax({type:"POST",url:this.el.action,data:JSON.stringify(n)}),i=this;return r.done(function(e){i.$submitEl.removeClass("btn-primary").addClass("btn-success"),t.reload(e)}),r.fail(function(){i.$submitEl.removeClass("btn-primary").addClass("btn-danger"),i.$submitEl.attr("disabled",!1),i.$el.removeClass("logInForm-loading"),i.$("[autofocus]").focus()}),!1}})}),define("app/core/util/showDeleteFormPage",["app/viewport"],function(e){return function(t,n,r){var i=new t({_id:n.params.id});e.loadPage("app/core/pages/ActionFormPage",function(e){return new e({model:i,actionKey:"delete",successUrl:i.genClientUrl("base"),cancelUrl:r||i.genClientUrl("base"),formMethod:"DELETE",formAction:i.url(),formActionSeverity:"danger"})})}}),define("app/aors/Aor",["../core/Model"],function(e){return e.extend({urlRoot:"/aors",clientUrlRoot:"#aors",topicPrefix:"aors",privilegePrefix:"DICTIONARIES",nlsDomain:"aors",labelAttribute:"name",defaults:{name:null,description:null}})}),define("app/aors/AorCollection",["../core/Collection","./Aor"],function(e,t){return e.extend({model:t,rqlQuery:"select(name,description)&sort(name)"})}),define("app/data/aors",["app/aors/AorCollection","./createStorage"],function(e,t){return t("AORS","aors",e)}),define("app/nls/aors",["app/nls/locale/en"],function(e){var t={locale:{}};t.locale.en=e;var n=function(e){if(!e)throw new Error("MessageFormat: No data passed to function.")},r=function(e,t){return n(e),e[t]};return{root:{"BREADCRUMBS:browse":function(){return"Areas of responsibility"},"BREADCRUMBS:addForm":function(){return"Adding"},"BREADCRUMBS:editForm":function(){return"Editing"},"BREADCRUMBS:ACTION_FORM:delete":function(){return"Deleting"},"MSG:LOADING_FAILURE":function(){return"Failed to load the areas of responsibility :("},"MSG:LOADING_SINGLE_FAILURE":function(){return"Failed to load the area of resposibility :("},"MSG:DELETED":function(e){return"Area of resposibility <em>"+r(e,"label")+"</em> was deleted."},"PAGE_ACTION:add":function(){return"Add AOR"},"PAGE_ACTION:edit":function(){return"Edit AOR"},"PAGE_ACTION:delete":function(){return"Delete AOR"},"PANEL:TITLE:details":function(){return"AOR's details"},"PANEL:TITLE:addForm":function(){return"Add AOR form"},"PANEL:TITLE:editForm":function(){return"Edit AOR form"},"PROPERTY:_id":function(){return"ID"},"PROPERTY:name":function(){return"Name"},"PROPERTY:description":function(){return"Description"},"FORM:ACTION:add":function(){return"Add AOR"},"FORM:ACTION:edit":function(){return"Edit AOR"},"FORM:ERROR:addFailure":function(){return"Failed to add the new AOR :-("},"FORM:ERROR:editFailure":function(){return"Failed to edit the new AOR :-("},"ACTION_FORM:DIALOG_TITLE:delete":function(){return"AOR deletion confirmation"},"ACTION_FORM:BUTTON:delete":function(){return"Delete AOR"},"ACTION_FORM:MESSAGE:delete":function(){return"Are you sure you want to delete the chosen AOR?"},"ACTION_FORM:MESSAGE_SPECIFIC:delete":function(e){return"Are you sure you want to delete the <em>"+r(e,"label")+"</em> AOR?"},"ACTION_FORM:MESSAGE_FAILURE:delete":function(){return"Failed to delete the AOR :-("}},pl:!0}}),define("app/nls/pl/aors",["app/nls/locale/pl"],function(e){var t={locale:{}};t.locale.pl=e;var n=function(e){if(!e)throw new Error("MessageFormat: No data passed to function.")},r=function(e,t){return n(e),e[t]};return{"BREADCRUMBS:browse":function(){return"Obszary odpowiedzialności"},"BREADCRUMBS:addForm":function(){return"Dodawanie"},"BREADCRUMBS:editForm":function(){return"Edycja"},"BREADCRUMBS:ACTION_FORM:delete":function(){return"Usuwanie"},"MSG:LOADING_FAILURE":function(){return"Ładowanie obszarów odpowiedzialności nie powiodło się :("},"MSG:LOADING_SINGLE_FAILURE":function(){return"Ładowanie obszaru odpowiedzialności nie powiodło się :("},"MSG:DELETED":function(e){return"Obszar odpowiedzialności <em>"+r(e,"label")+"</em> został usunięty."},"PAGE_ACTION:add":function(){return"Dodaj obszar odpowiedzialności"},"PAGE_ACTION:edit":function(){return"Edytuj obszar odpowiedzialności"},"PAGE_ACTION:delete":function(){return"Usuń obszar odpowiedzialności"},"PANEL:TITLE:details":function(){return"Szczegóły obszaru odpowiedzialności"},"PANEL:TITLE:addForm":function(){return"Formularz dodawania obszaru odpowiedzialności"},"PANEL:TITLE:editForm":function(){return"Formularz edycji obszaru odpowiedzialności"},"PROPERTY:_id":function(){return"ID"},"PROPERTY:name":function(){return"Nazwa"},"PROPERTY:description":function(){return"Opis"},"FORM:ACTION:add":function(){return"Dodaj obszar odpowiedzialności"},"FORM:ACTION:edit":function(){return"Edytuj obszar odpowiedzialności"},"FORM:ERROR:addFailure":function(){return"Nie udało się dodać obszaru odpowiedzialności :-("},"FORM:ERROR:editFailure":function(){return"Nie udało się zmodyfikować obszaru odpowiedzialności :-("},"ACTION_FORM:DIALOG_TITLE:delete":function(){return"Potwierdzenie usunięcia obszaru odpowiedzialności"},"ACTION_FORM:BUTTON:delete":function(){return"Usuń obszar odpowiedzialności"},"ACTION_FORM:MESSAGE:delete":function(){return"Czy na pewno chcesz bezpowrotnie usunąć wybrany obszar odpowiedzialności?"},"ACTION_FORM:MESSAGE_SPECIFIC:delete":function(e){return"Czy na pewno chcesz bezpowrotnie usunąć obszar odpowiedzialności <em>"+r(e,"label")+"</em>?"},"ACTION_FORM:MESSAGE_FAILURE:delete":function(){return"Nie udało się usunąć obszaru odpowiedzialności :-("}}}),define("app/aors/routes",["../router","../viewport","../user","../core/util/showDeleteFormPage","../data/aors","./Aor","i18n!app/nls/aors"],function(e,t,n,r,i,o){var a=n.auth("DICTIONARIES:VIEW"),s=n.auth("DICTIONARIES:MANAGE");e.map("/aors",a,function(){t.loadPage(["app/core/pages/ListPage"],function(e){return new e({collection:i,columns:["name","description"]})})}),e.map("/aors/:id",function(e){t.loadPage(["app/core/pages/DetailsPage","app/aors/templates/details"],function(t,n){return new t({model:new o({_id:e.params.id}),detailsTemplate:n})})}),e.map("/aors;add",s,function(){t.loadPage(["app/core/pages/AddFormPage","app/aors/templates/form"],function(e,t){return new e({model:new o,formTemplate:t})})}),e.map("/aors/:id;edit",s,function(e){t.loadPage(["app/core/pages/EditFormPage","app/aors/templates/form"],function(t,n){return new t({model:new o({_id:e.params.id}),formTemplate:n})})}),e.map("/aors/:id;delete",s,r.bind(null,o))}),define("app/companies/Company",["../core/Model"],function(e){return e.extend({urlRoot:"/companies",clientUrlRoot:"#companies",topicPrefix:"companies",privilegePrefix:"DICTIONARIES",nlsDomain:"companies",labelAttribute:"name",defaults:{name:null,fteMasterPosition:-1,fteLeaderPosition:-1},toJSON:function(){var t=e.prototype.toJSON.call(this);return t.name||(t.name=t._id),t}})}),define("app/companies/CompanyCollection",["../core/Collection","./Company"],function(e,t){return e.extend({model:t,rqlQuery:"select(name,fteMasterPosition,fteLeaderPosition)&sort(_id)"})}),define("app/data/companies",["app/companies/CompanyCollection","./createStorage"],function(e,t){return t("COMPANIES","companies",e)}),define("app/nls/companies",["app/nls/locale/en"],function(e){var t={locale:{}};t.locale.en=e;var n=function(e){if(!e)throw new Error("MessageFormat: No data passed to function.")},r=function(e,t){return n(e),e[t]};return{root:{"BREADCRUMBS:browse":function(){return"Companies"},"BREADCRUMBS:addForm":function(){return"Adding"},"BREADCRUMBS:editForm":function(){return"Editing"},"BREADCRUMBS:ACTION_FORM:delete":function(){return"Deleting"},"MSG:LOADING_FAILURE":function(){return"Failed to load the companies :("},"MSG:LOADING_SINGLE_FAILURE":function(){return"Failed to load the company :("},"MSG:DELETED":function(e){return"Company <em>"+r(e,"label")+"</em> was deleted."},"PAGE_ACTION:add":function(){return"Add company"},"PAGE_ACTION:edit":function(){return"Edit company"},"PAGE_ACTION:delete":function(){return"Delete company"},"PANEL:TITLE:details":function(){return"Company's details"},"PANEL:TITLE:addForm":function(){return"Add company form"},"PANEL:TITLE:editForm":function(){return"Edit company form"},"PROPERTY:_id":function(){return"ID"},"PROPERTY:name":function(){return"Name"},"PROPERTY:fteMasterPosition":function(){return"Position in FTE (production)"},"PROPERTY:fteLeaderPosition":function(){return"Position in FTE (distribution)"},"FORM:ACTION:add":function(){return"Add company"},"FORM:ACTION:edit":function(){return"Edit company"},"FORM:ERROR:addFailure":function(){return"Failed to add the new company :-("},"FORM:ERROR:editFailure":function(){return"Failed to edit the company :-("},"ACTION_FORM:DIALOG_TITLE:delete":function(){return"Company deletion confirmation"},"ACTION_FORM:BUTTON:delete":function(){return"Delete company"},"ACTION_FORM:MESSAGE:delete":function(){return"Are you sure you want to delete the chosen company?"},"ACTION_FORM:MESSAGE_SPECIFIC:delete":function(e){return"Are you sure you want to delete the <em>"+r(e,"label")+"</em> company?"},"ACTION_FORM:MESSAGE_FAILURE:delete":function(){return"Failed to delete the company :-("}},pl:!0}}),define("app/nls/pl/companies",["app/nls/locale/pl"],function(e){var t={locale:{}};t.locale.pl=e;var n=function(e){if(!e)throw new Error("MessageFormat: No data passed to function.")},r=function(e,t){return n(e),e[t]};return{"BREADCRUMBS:browse":function(){return"Firmy"},"BREADCRUMBS:addForm":function(){return"Dodawanie"},"BREADCRUMBS:editForm":function(){return"Edycja"},"BREADCRUMBS:ACTION_FORM:delete":function(){return"Usuwanie"},"MSG:LOADING_FAILURE":function(){return"Ładowanie firm nie powiodło się :("},"MSG:LOADING_SINGLE_FAILURE":function(){return"Ładowanie firmy nie powiodło się :("},"MSG:DELETED":function(e){return"Firma <em>"+r(e,"label")+"</em> została usunięta."},"PAGE_ACTION:add":function(){return"Dodaj firmę"},"PAGE_ACTION:edit":function(){return"Edytuj firmę"},"PAGE_ACTION:delete":function(){return"Usuń firmę"},"PANEL:TITLE:details":function(){return"Szczegóły firmy"},"PANEL:TITLE:addForm":function(){return"Formularz dodawania firmy"},"PANEL:TITLE:editForm":function(){return"Formularz edycji firmy"},"PROPERTY:_id":function(){return"ID"},"PROPERTY:name":function(){return"Nazwa"},"PROPERTY:fteMasterPosition":function(){return"Pozycja w FTE (produkcja)"},"PROPERTY:fteLeaderPosition":function(){return"Pozycja w FTE (magazyn)"},"FORM:ACTION:add":function(){return"Dodaj firmę"},"FORM:ACTION:edit":function(){return"Edytuj firmę"},"FORM:ERROR:addFailure":function(){return"Nie udało się dodać firmy :-("},"FORM:ERROR:editFailure":function(){return"Nie udało się zmodyfikować firmy :-("},"ACTION_FORM:DIALOG_TITLE:delete":function(){return"Potwierdzenie usunięcia firmy"},"ACTION_FORM:BUTTON:delete":function(){return"Usuń firmę"},"ACTION_FORM:MESSAGE:delete":function(){return"Czy na pewno chcesz bezpowrotnie usunąć wybraną firmę?"},"ACTION_FORM:MESSAGE_SPECIFIC:delete":function(e){return"Czy na pewno chcesz bezpowrotnie usunąć firmę <em>"+r(e,"label")+"</em>?"},"ACTION_FORM:MESSAGE_FAILURE:delete":function(){return"Nie udało się usunąć firmy :-("}}}),define("app/companies/routes",["../router","../viewport","../user","../data/companies","./Company","i18n!app/nls/companies"],function(e,t,n,r,i){var o=n.auth("DICTIONARIES:VIEW"),a=n.auth("DICTIONARIES:MANAGE");e.map("/companies",o,function(){t.loadPage(["app/core/pages/ListPage"],function(e){return new e({collection:r,columns:["_id","name","fteMasterPosition","fteLeaderPosition"]})})}),e.map("/companies/:id",function(e){t.loadPage(["app/core/pages/DetailsPage","app/companies/templates/details"],function(t,n){return new t({model:new i({_id:e.params.id}),detailsTemplate:n})})}),e.map("/companies;add",a,function(){t.loadPage(["app/core/pages/AddFormPage","app/companies/views/CompanyFormView"],function(e,t){return new e({FormView:t,model:new i})})}),e.map("/companies/:id;edit",a,function(e){t.loadPage(["app/core/pages/EditFormPage","app/companies/views/CompanyFormView"],function(t,n){return new t({FormView:n,model:new i({_id:e.params.id})})})}),e.map("/companies/:id;delete",a,function(e,n){var r=new i({_id:e.params.id});t.loadPage(["app/core/pages/ActionFormPage"],function(e){return new e({model:r,actionKey:"delete",successUrl:r.genClientUrl("base"),cancelUrl:n||r.genClientUrl("base"),formMethod:"DELETE",formAction:r.url(),formActionSeverity:"danger"})})})}),define("app/dashboard/templates/dashboard",["app/i18n"],function(t){return function anonymous(locals,filters,escape,rethrow){escape=escape||function(e){return String(e).replace(/&(?!#?[a-zA-Z0-9]+;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&#39;").replace(/"/g,"&quot;")};var buf=[];with(locals||{})!function(){buf.push("<div>\n  <h1>WIP</h1>\n</div>\n")}();return buf.join("")}}),define("app/dashboard/views/DashboardView",["app/core/View","app/dashboard/templates/dashboard"],function(e,t){return e.extend({template:t})}),define("app/dashboard/pages/DashboardPage",["app/i18n","app/user","app/core/View","app/core/views/LogInFormView","../views/DashboardView"],function(e,t,n,r,i){return n.extend({layoutName:"page",pageId:"dashboard",localTopics:{"user.reloaded":function(){this.view.remove(),this.view=t.isLoggedIn()?new i:new r,this.view.render()}},breadcrumbs:function(){return t.isLoggedIn()?[]:[e.bound("dashboard","breadcrumbs:logIn")]},initialize:function(){this.view=t.isLoggedIn()?new i:new r},afterRender:function(){this.$('input[name="login"]').focus()}})}),define("app/nls/dashboard",["app/nls/locale/en"],function(e){var t={locale:{}};t.locale.en=e;return{root:{"breadcrumbs:logIn":function(){return"Log in form"}},pl:!0}}),define("app/nls/pl/dashboard",["app/nls/locale/pl"],function(e){var t={locale:{}};t.locale.pl=e;return{"breadcrumbs:logIn":function(){return"Logowanie do systemu"}}}),define("app/dashboard/routes",["app/router","app/viewport","./pages/DashboardPage","i18n!app/nls/dashboard"],function(e,t,n){e.map("/",function(){t.showPage(new n)})}),define("app/nls/divisions",["app/nls/locale/en"],function(e){var t={locale:{}};t.locale.en=e;var n=function(e){if(!e)throw new Error("MessageFormat: No data passed to function.")},r=function(e,t){return n(e),e[t]};return{root:{"BREADCRUMBS:browse":function(){return"Divisions"},"BREADCRUMBS:addForm":function(){return"Adding"},"BREADCRUMBS:editForm":function(){return"Editing"},"BREADCRUMBS:ACTION_FORM:delete":function(){return"Deleting"},"MSG:LOADING_FAILURE":function(){return"Failed to load the divisions :("},"MSG:LOADING_SINGLE_FAILURE":function(){return"Failed to load the division :("},"MSG:DELETED":function(e){return"Division <em>"+r(e,"label")+"</em> was deleted."},"PAGE_ACTION:add":function(){return"Add division"},"PAGE_ACTION:edit":function(){return"Edit division"},"PAGE_ACTION:delete":function(){return"Delete division"},"PANEL:TITLE:details":function(){return"Division's details"},"PANEL:TITLE:addForm":function(){return"Add division form"},"PANEL:TITLE:editForm":function(){return"Edit division form"},"PROPERTY:_id":function(){return"ID"},"PROPERTY:description":function(){return"Description"},"PROPERTY:type":function(){return"Type"},"TYPE:prod":function(){return"Production"},"TYPE:dist":function(){return"Distribution"},"FORM:ACTION:add":function(){return"Add division"},"FORM:ACTION:edit":function(){return"Edit division"},"FORM:ERROR:addFailure":function(){return"Failed to add the new division :-("},"FORM:ERROR:editFailure":function(){return"Failed to edit the division :-("},"ACTION_FORM:DIALOG_TITLE:delete":function(){return"Division deletion confirmation"},"ACTION_FORM:BUTTON:delete":function(){return"Delete division"},"ACTION_FORM:MESSAGE:delete":function(){return"Are you sure you want to delete the chosen division?"},"ACTION_FORM:MESSAGE_SPECIFIC:delete":function(e){return"Are you sure you want to delete the <em>"+r(e,"label")+"</em> division?"},"ACTION_FORM:MESSAGE_FAILURE:delete":function(){return"Failed to delete the division :-("}},pl:!0}}),define("app/nls/pl/divisions",["app/nls/locale/pl"],function(e){var t={locale:{}};t.locale.pl=e;var n=function(e){if(!e)throw new Error("MessageFormat: No data passed to function.")},r=function(e,t){return n(e),e[t]};return{"BREADCRUMBS:browse":function(){return"Wydziały"},"BREADCRUMBS:addForm":function(){return"Dodawanie"},"BREADCRUMBS:editForm":function(){return"Edycja"},"BREADCRUMBS:ACTION_FORM:delete":function(){return"Usuwanie"},"MSG:LOADING_FAILURE":function(){return"Ładowanie wydziałów nie powiodło się :("},"MSG:LOADING_SINGLE_FAILURE":function(){return"Ładowanie wydziału nie powiodło się :("},"MSG:DELETED":function(e){return"Wydział <em>"+r(e,"label")+"</em> zostało usunięte."},"PAGE_ACTION:add":function(){return"Dodaj wydział"},"PAGE_ACTION:edit":function(){return"Edytuj wydział"},"PAGE_ACTION:delete":function(){return"Usuń wydział"},"PANEL:TITLE:details":function(){return"Szczegóły wydziału"},"PANEL:TITLE:addForm":function(){return"Formularz dodawania wydziału"},"PANEL:TITLE:editForm":function(){return"Formularz edycji wydziału"},"PROPERTY:_id":function(){return"ID"},"PROPERTY:description":function(){return"Opis"},"PROPERTY:type":function(){return"Typ"},"TYPE:prod":function(){return"Produkcja"},"TYPE:dist":function(){return"Dystrybucja"},"FORM:ACTION:add":function(){return"Dodaj wydział"},"FORM:ACTION:edit":function(){return"Edytuj wydział"},"FORM:ERROR:addFailure":function(){return"Nie udało się dodać wydziału :-("},"FORM:ERROR:editFailure":function(){return"Nie udało się zmodyfikować wydziału :-("},"ACTION_FORM:DIALOG_TITLE:delete":function(){return"Potwierdzenie usunięcia wydziału"},"ACTION_FORM:BUTTON:delete":function(){return"Usuń wydział"},"ACTION_FORM:MESSAGE:delete":function(){return"Czy na pewno chcesz bezpowrotnie usunąć wybrany wydział?"},"ACTION_FORM:MESSAGE_SPECIFIC:delete":function(e){return"Czy na pewno chcesz bezpowrotnie usunąć wydział <em>"+r(e,"label")+"</em>?"},"ACTION_FORM:MESSAGE_FAILURE:delete":function(){return"Nie udało się usunąć wydziału :-("}}}),define("app/divisions/routes",["../router","../viewport","../i18n","../user","../core/util/showDeleteFormPage","../data/divisions","./Division","i18n!app/nls/divisions"],function(e,t,n,r,i,o,a){var s=r.auth("DICTIONARIES:VIEW"),u=r.auth("DICTIONARIES:MANAGE");e.map("/divisions",s,function(){t.loadPage(["app/core/pages/ListPage"],function(e){return new e({collection:o,columns:["_id","type","description"],serializeRow:function(e){var t=e.toJSON();return t.type=n("divisions","TYPE:"+t.type),t}})})}),e.map("/divisions/:id",function(e){t.loadPage(["app/core/pages/DetailsPage","app/divisions/templates/details"],function(t,n){return new t({model:new a({_id:e.params.id}),detailsTemplate:n})})}),e.map("/divisions;add",u,function(){t.loadPage(["app/core/pages/AddFormPage","app/divisions/views/DivisionFormView"],function(e,t){return new e({FormView:t,model:new a})})}),e.map("/divisions/:id;edit",u,function(e){t.loadPage(["app/core/pages/EditFormPage","app/divisions/views/DivisionFormView"],function(t,n){return new t({FormView:n,model:new a({_id:e.params.id})})})}),e.map("/divisions/:id;delete",u,i.bind(null,a))}),define("app/downtimeReasons/DowntimeReason",["../core/Model"],function(e){return e.extend({urlRoot:"/downtimeReasons",clientUrlRoot:"#downtimeReasons",topicPrefix:"downtimeReasons",privilegePrefix:"DICTIONARIES",nlsDomain:"downtimeReasons",labelAttribute:"label",defaults:function(){return{label:null,type:"other",subdivisionTypes:["assembly","press"],opticsPosition:-1,pressPosition:-1,auto:!1,scheduled:!1}}})}),define("app/downtimeReasons/DowntimeReasonCollection",["../core/Collection","./DowntimeReason"],function(e,t){return e.extend({model:t,rqlQuery:"sort(_id)",findBySubdivisionType:function(e){return this.filter(function(t){return-1!==t.get("subdivisionTypes").indexOf(e)})},findFirstBreakIdBySubdivisionType:function(e){return"A"}})}),define("app/data/downtimeReasons",["app/downtimeReasons/DowntimeReasonCollection","./createStorage"],function(e,t){return t("DOWNTIME_REASONS","downtimeReasons",e)}),define("app/core/util/bindLoadingMessage",["app/i18n","app/viewport"],function(e,t){return function(n,r,i,o){function a(){t.msg.loaded()}function s(n){var r=n.statusText;if("abort"===r)return t.msg.loaded();var a=n.responseJSON;a&&a.error&&(a.error.code?r=a.error.code:a.error.message&&(r=a.error.message)),t.msg.loadingFailed(e(o,i,{code:r}))}return o||(o=n.nlsDomain?n.nlsDomain:n.model.prototype.nlsDomain?n.model.prototype.nlsDomain:"core"),i||(i=n.model?"MSG:LOADING_FAILURE":"MSG:LOADING_SINGLE_FAILURE"),r.listenTo(n,"request",function(e,n,r){"read"===r.syncMethod&&(t.msg.loading(),n.done(a),n.fail(s))}),n}}),define("app/core/templates/actionForm",["app/i18n"],function(t){return function anonymous(locals,filters,escape,rethrow){escape=escape||function(e){return String(e).replace(/&(?!#?[a-zA-Z0-9]+;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&#39;").replace(/"/g,"&quot;")};var buf=[];with(locals||{})!function(){buf.push('<form class="action-form" method="post" action="',formAction,'">\n  <input type="hidden" name="_method" value="',formMethod,'">\n  <p>',messageText,'</p>\n  <div class="form-actions">\n    <button type="submit" class="btn btn-',formActionSeverity,'">',formActionText,"</button>\n    "),"#"===cancelUrl?buf.push('\n    <button type="button" class="cancel btn btn-link">',t("core","ACTION_FORM:BUTTON:cancel"),"</button>\n    "):buf.push('\n    <a class="cancel" href="',cancelUrl,'">',t("core","ACTION_FORM:BUTTON:cancel"),"</a>\n    "),buf.push("\n  </div>\n</form>\n")}();return buf.join("")}}),define("app/core/views/ActionFormView",["underscore","jquery","app/i18n","app/viewport","app/router","../View","app/core/templates/actionForm"],function(e,t,n,r,i,o,a){var s={formMethod:"POST",formAction:"/",formActionText:n.bound("core","ACTION_FORM:BUTTON"),formActionSeverity:"primary",messageText:n.bound("core","ACTION_FORM:MESSAGE"),successUrl:null,cancelUrl:"#",failureText:n.bound("core","ACTION_FORM:MESSAGE_FAILURE"),requestData:null},u=o.extend({template:a,events:{submit:"submitForm"},$errorMessage:null,initialize:function(){e.defaults(this.options,s),this.$errorMessage=null},destroy:function(){this.hideErrorMessage()},serialize:function(){return{formMethod:this.options.formMethod,formAction:this.options.formAction,formActionText:this.options.formActionText,formActionSeverity:this.options.formActionSeverity,messageText:this.options.messageText,cancelUrl:this.options.cancelUrl,model:this.model}},afterRender:function(){this.model&&this.listenToOnce(this.model,"change",this.render)},submitForm:function(){this.hideErrorMessage();var n=this.$('[type="submit"]').attr("disabled",!0),i=this.options,o=i.requestData;o=null==o?void 0:e.isFunction(o)?o.call(this):JSON.stringify(o);var a=t.ajax({type:i.formMethod,url:i.formAction,data:o}),s=this;return a.done(function(t){s.trigger("success",t),e.isString(i.successUrl)&&s.broker.publish("router.navigate",{url:i.successUrl,trigger:!0,replace:!0})}),a.fail(function(e){s.trigger("failure",e),i.failureText&&(s.$errorMessage=r.msg.show({type:"error",time:5e3,text:i.failureText}))}),a.always(function(){n.attr("disabled",!1)}),!1},hideErrorMessage:function(){null!==this.$errorMessage&&(r.msg.hide(this.$errorMessage),this.$errorMessage=null)}},{showDialog:function(t){var i=null;if(t.nlsDomain||(t.nlsDomain=t.model.getNlsDomain()),t.nlsDomain){i=n.bound(t.nlsDomain,"ACTION_FORM:DIALOG_TITLE:"+t.actionKey);var o=t.labelAttribute?t.model.get(t.labelAttribute):t.model.getLabel();t.messageText=o?n.bound(t.nlsDomain,"ACTION_FORM:MESSAGE_SPECIFIC:"+t.actionKey,{label:o}):n.bound(t.nlsDomain,"ACTION_FORM:MESSAGE:"+t.actionKey),t.formActionText=n.bound(t.nlsDomain,"ACTION_FORM:BUTTON:"+t.actionKey),t.failureText=n.bound(t.nlsDomain,"ACTION_FORM:MESSAGE_FAILURE:"+t.actionKey)}!t.formAction&&e.isFunction(t.model.url)&&(t.formAction=t.model.url()),e.isObject(t.requestData)||(t.requestData={}),e.isString(t.requestData.action)||(t.requestData.action=t.actionKey);var a=new u(t);return a.on("success",function(){r.closeDialog()}),r.showDialog(a,i),a},showDeleteDialog:function(e){return e.actionKey="delete",e.formMethod="DELETE",e.formActionSeverity="danger",u.showDialog(e)}});return u}),define("app/core/templates/jumpAction",["app/i18n"],function(t){return function anonymous(locals,filters,escape,rethrow){escape=escape||function(e){return String(e).replace(/&(?!#?[a-zA-Z0-9]+;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&#39;").replace(/"/g,"&quot;")};var buf=[];with(locals||{})!function(){buf.push('<form class="page-actions-jump" title="',t(nlsDomain,"PAGE_ACTION:jump:title"),'">\n  <div class="input-group">\n    <input name="rid" type="text" class="form-control" placeholder="',t(nlsDomain,"PAGE_ACTION:jump:placeholder"),'" required autofocus pattern="^ *[0-9]+ *$">\n    <span class="input-group-btn">\n      <button class="btn btn-default" type="submit"><i class="fa fa-search"></i></button>\n    </span>\n  </div>\n</form>\n')}();return buf.join("")}}),define("app/core/util/pageActions",["underscore","jquery","app/i18n","app/viewport","../views/ActionFormView","app/core/templates/jumpAction"],function(e,t,n,r,i,o){function a(e){return e.paginationData?e.paginationData.get("totalCount"):e.length}function s(i,o,a){var s=a[0].rid;if(s.readOnly)return!1;var u=parseInt(s.value,10);if(isNaN(u)||0>=u)return s.value="",!1;s.readOnly=!0,s.value=u;var l=a.find(".fa").removeClass("fa-search").addClass("fa-spinner fa-spin"),c=i.promised(t.ajax({url:e.result(o,"url")+";rid",data:{rid:u}}));return c.done(function(e){i.broker.publish("router.navigate",{url:o.genClientUrl()+"/"+e,trigger:!0})}),c.fail(function(){r.msg.show({type:"error",time:2e3,text:n(o.getNlsDomain(),"MSG:jump:404",{rid:u})}),l.removeClass("fa-spinner fa-spin").addClass("fa-search"),s.readOnly=!1,s.select()}),!1}return{add:function(e,t){return{label:n.bound(e.getNlsDomain(),"PAGE_ACTION:add"),icon:"plus",href:e.genClientUrl("add"),privileges:t||e.getPrivilegePrefix()+":MANAGE"}},edit:function(e,t){return{label:n.bound(e.getNlsDomain(),"PAGE_ACTION:edit"),icon:"edit",href:e.genClientUrl("edit"),privileges:t||e.getPrivilegePrefix()+":MANAGE"}
},"delete":function(e,t){return{label:n.bound(e.getNlsDomain(),"PAGE_ACTION:delete"),icon:"times",href:e.genClientUrl("delete"),privileges:t||e.getPrivilegePrefix()+":MANAGE",callback:function(t){0===t.button&&(t.preventDefault(),i.showDeleteDialog({model:e}))}}},"export":function(t,r,i,o){return r.listenTo(i,"sync",function(){var n=a(i),r=t.$(".page-actions .export").attr("href",e.result(i,"url")+";export?"+i.rqlQuery).toggleClass("disabled",!n).removeClass("btn-default btn-warning");n>=1e4?r.removeClass("btn-default").addClass("btn-warning"):r.removeClass("btn-warning").addClass("btn-default")}),{label:n.bound(i.getNlsDomain(),"PAGE_ACTION:export"),icon:"download",type:a(i)>=1e4?"warning":"default",href:e.result(i,"url")+";export?"+i.rqlQuery,privileges:o||i.getPrivilegePrefix()+":VIEW",className:"export"+(i.length?"":" disabled")}},jump:function(e,t){return{template:function(){return o({nlsDomain:t.getNlsDomain()})},afterRender:function(n){var r=n.find("form");r.submit(s.bind(null,e,t,r))}}}}}),define("app/core/templates/pagination",["app/i18n"],function(t){return function anonymous(locals,filters,escape,rethrow){escape=escape||function(e){return String(e).replace(/&(?!#?[a-zA-Z0-9]+;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&#39;").replace(/"/g,"&quot;")};var buf=[];with(locals||{})!function(){buf.push('<ul class="pagination">\n\n  '),firstLastLinksVisible&&(buf.push("\n    "),firstPageLinkAvailable?buf.push('\n    <li><a href="',firstPageHref,'" title="',t("core","PAGINATION:FIRST_PAGE"),'" data-page="1">&laquo;</a>\n    '):buf.push('\n    <li class="disabled"><span>&laquo;</span>\n    '),buf.push("\n  ")),buf.push("\n\n  "),prevNextLinksVisible&&(buf.push("\n    "),prevPageLinkAvailable?buf.push('\n    <li><a href="',prevPageHref,'" title="',t("core","PAGINATION:PREV_PAGE"),'" data-page="',page-1,'">&lsaquo;</a>\n    '):buf.push('\n    <li class="disabled"><span>&lsaquo;</span>\n    '),buf.push("\n  ")),buf.push("\n\n  "),leftDotsVisible&&buf.push('\n  <li class="disabled"><span class="pagination-dots">...</span>\n  '),buf.push("\n\n  "),pages.forEach(function(e){buf.push('\n  <li class="',e.active?"active":"",'"><a href="',e.href,'" data-page="',e.no,'">',e.no,"</a>\n  ")}),buf.push("\n\n  "),rightDotsVisible&&buf.push('\n  <li class="disabled"><span class="pagination-dots">...</span>\n  '),buf.push("\n\n  "),prevNextLinksVisible&&(buf.push("\n    "),nextPageLinkAvailable?buf.push('\n    <li><a href="',nextPageHref,'" title="',t("core","PAGINATION:NEXT_PAGE"),'" data-page="',page+1,'">&rsaquo;</a>\n    '):buf.push('\n    <li class="disabled"><span>&rsaquo;</span>\n    '),buf.push("\n  ")),buf.push("\n\n  "),firstLastLinksVisible&&(buf.push("\n    "),lastPageLinkAvailable?buf.push('\n    <li><a href="',lastPageHref,'" title="',t("core","PAGINATION:LAST_PAGE"),'" data-page="',pageCount,'">&raquo;</a>\n    '):buf.push('\n    <li class="disabled"><span>&raquo;</span>\n    '),buf.push("\n  ")),buf.push("\n\n</ul>\n")}();return buf.join("")}}),define("app/core/views/PaginationView",["underscore","../View","app/core/templates/pagination"],function(e,t,n){var r={pageNumbers:3,firstLastLinksVisible:!0,prevNextLinksVisible:!0,dotsVisible:!0},i=t.extend({template:n,events:{"click a":function(e){if(0===e.button){e.preventDefault();var t=e.currentTarget;this.changePage(+t.getAttribute("data-page"),t.getAttribute("href"))}}}});return i.prototype.initialize=function(){e.defaults(this.options,r),this.listenTo(this.model,"change:urlTemplate",this.render)},i.prototype.afterRender=function(){var e=this.model.get("limit");(-1===e||this.model.get("totalCount")<=e)&&this.$el.hide()},i.prototype.changePage=function(e,t){this.model.set({page:e}),t&&this.broker.publish("router.navigate",{url:t})},i.prototype.serialize=function(){var e=this.options,t=this.model,n=t.get("page"),r=Math.ceil(t.get("totalCount")/t.get("limit")),i=(e.pageNumbers-1)/2;e.dotsVisible&&(i+=1);var o=n,a=o+i,s=!0,u=!1;1>o-i?o=1:(o-=i,u=e.dotsVisible&&1!==o),u&&(o+=1),a>r&&(a=r,s=!1),i+1>n?(a+=i+1-n,a>r&&(a=r)):n>r-i&&(o-=i-(r-n),1>o&&(o=1));var l=e.dotsVisible&&s&&a!==r;return l&&(a-=1),1===o&&(u=!1),{pageCount:r,page:n,skip:t.get("skip"),limit:t.get("limit"),visible:r>1,firstLastLinksVisible:e.firstLastLinksVisible,prevNextLinksVisible:e.prevNextLinksVisible,leftDotsVisible:u,rightDotsVisible:l,firstPageLinkAvailable:n>1,lastPageLinkAvailable:r>n,prevPageLinkAvailable:n>1,nextPageLinkAvailable:r>n,firstPageHref:this.genPageHref(1),lastPageHref:this.genPageHref(r),prevPageHref:this.genPageHref(n-1),nextPageHref:this.genPageHref(n+1),pages:this.genPages(o,a)}},i.prototype.genPageHref=function(e){var t=this.model.get("urlTemplate"),n=this.model.get("limit");return t.replace("${page}",e).replace("${skip}",(e-1)*n).replace("${limit}",n)},i.prototype.genPages=function(e,t){for(var n=[],r=this.model.get("page"),i=e;t>=i;++i)n.push({no:i,active:i===r,href:this.genPageHref(i)});return n},i}),define("app/core/templates/list",["app/i18n"],function(t){return function anonymous(locals,filters,escape,rethrow){escape=escape||function(e){return String(e).replace(/&(?!#?[a-zA-Z0-9]+;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&#39;").replace(/"/g,"&quot;")};var buf=[];with(locals||{})!function(){buf.push('<div class="list ',"undefined"==typeof className?"":className,'">\n  <table class="table table-bordered table-hover table-condensed">\n    <thead>\n    <tr>\n      '),columns.forEach(function(e){buf.push("\n      <th>",e.label,"</th>\n      ")}),buf.push("\n      "),"function"==typeof actions&&buf.push('\n      <th class="actions">',t("core","LIST:COLUMN:actions"),"</th>\n      "),buf.push("\n    </tr>\n    </thead>\n    <tbody>\n      "),rows.length||buf.push('\n      <tr>\n        <td colspan="',columns.length+1,'">',t("core","LIST:NO_DATA"),"</td>\n      </tr>\n      "),buf.push("\n      "),rows.forEach(function(e){buf.push('\n      <tr class="list-item ',e.className?e.className:"",'"\n        '),e.dataAttrs&&(buf.push("\n        "),Object.keys(e.dataAttrs).forEach(function(t){buf.push("\n        data-",t,'="',escape(e.dataAttrs[t]),'"\n        ')}),buf.push("\n        ")),buf.push("\n        "),e._id&&buf.push('data-id="',e._id,'"'),buf.push("\n      >\n        "),columns.forEach(function(n){buf.push('\n        <td data-id="',n.id,'">\n          '),null==e[n.id]?buf.push("\n          <em>",t("core","LIST:NO_DATA:cell"),"</em>\n          "):buf.push("\n          ",e[n.id],"\n          "),buf.push("\n        </td>\n        ")}),buf.push("\n        "),"function"==typeof actions&&(buf.push('\n        <td class="actions">\n          '),actions(e).forEach(function(e){buf.push("\n          "),e.href?buf.push('\n          <a href="',e.href,'" class="btn btn-default action-',e.id,'" title="',escape(e.label),'"><i class="fa fa-',e.icon,'"></i></a>\n          '):buf.push("\n          TODO\n          "),buf.push("\n          ")}),buf.push("\n        </td>\n        ")),buf.push("\n      </tr>\n      ")}),buf.push('\n    </tbody>\n  </table>\n  <div class="pagination-container"></div>\n</div>\n')}();return buf.join("")}}),define("app/core/views/ListView",["jquery","app/i18n","app/user","../View","./ActionFormView","./PaginationView","app/core/templates/list"],function(e,t,n,r,i,o,a){function s(e,n,r){return n||(n=e.getNlsDomain()),t.has(n,r)?t(n,r):t("core",r)}var u=r.extend({template:a,remoteTopics:function(){var e={},t=this.collection.getTopicPrefix();return e[t+".added"]="refreshCollection",e[t+".edited"]="refreshCollection",e[t+".deleted"]="onModelDeleted",e},events:{"click .action-delete":function(e){e.preventDefault(),i.showDeleteDialog({model:this.getModelFromEvent(e)})}},initialize:function(){this.collection.paginationData&&(this.setView(".pagination-container",new o({model:this.collection.paginationData})),this.listenTo(this.collection.paginationData,"change:page",this.scrollTop))},serialize:function(){return{columns:this.serializeColumns(),actions:this.serializeActions(),rows:this.serializeRows(),className:this.className}},serializeColumns:function(){var e,n=this.collection.getNlsDomain();return e=Array.isArray(this.options.columns)?this.options.columns:Array.isArray(this.columns)?this.columns:[],e.map(function(e){return{id:e,label:t(n,"PROPERTY:"+e)}})},serializeActions:function(){return u.actions.viewEditDelete(this.collection)},serializeRows:function(){return this.collection.map(this.options.serializeRow||this.serializeRow,this)},serializeRow:function(e){return e.toJSON()},beforeRender:function(){this.stopListening(this.collection,"reset",this.render)},afterRender:function(){this.listenToOnce(this.collection,"reset",this.render)},onModelDeleted:function(e){e&&e.model&&e.model._id&&(this.$('.list-item[data-id="'+e.model._id+'"]').addClass("is-deleted"),this.refreshCollection(e))},refreshCollection:function(e){e&&this.timers.refreshCollection||(e?this.timers.refreshCollection=setTimeout(this.refreshCollectionNow.bind(this),2e3):this.refreshCollectionNow())},refreshCollectionNow:function(){this.timers.refreshCollection&&clearTimeout(this.timers.refreshCollection),delete this.timers.refreshCollection,this.promised(this.collection.fetch({reset:!0}))},scrollTop:function(){var t=this.$el.offset().top-14,n=e(".navbar-fixed-top");n.length&&(t-=n.outerHeight()),window.scrollY>t&&e("html, body").stop(!0,!1).animate({scrollTop:t})},getModelFromEvent:function(e){return this.collection.get(this.$(e.target).closest(".list-item").attr("data-id"))}});return u.actions={viewDetails:function(e,t){return{id:"viewDetails",icon:"file-text-o",label:s(e,t,"LIST:ACTION:viewDetails"),href:e.genClientUrl()}},edit:function(e,t){return{id:"edit",icon:"edit",label:s(e,t,"LIST:ACTION:edit"),href:e.genClientUrl("edit")}},"delete":function(e,t){return{id:"delete",icon:"times",label:s(e,t,"LIST:ACTION:delete"),href:e.genClientUrl("delete")}},viewEditDelete:function(e,t,r){return function(i){var o=e.get(i._id),a=[u.actions.viewDetails(o,r)];return n.isAllowedTo((t||o.getPrivilegePrefix())+":MANAGE")&&a.push(u.actions.edit(o,r),u.actions.delete(o,r)),a}}},u}),define("app/core/pages/ListPage",["app/i18n","../util/bindLoadingMessage","../util/pageActions","../View","../views/ListView"],function(e,t,n,r,i){return r.extend({layoutName:"page",pageId:"list",breadcrumbs:function(){return[e.bound(this.collection.getNlsDomain(),"BREADCRUMBS:browse")]},actions:function(){return[n.add(this.collection,this.collection.getPrivilegePrefix()+":MANAGE")]},initialize:function(){this.collection=t(this.options.collection,this);var e=this.options.ListView||i;this.view=new e({collection:this.collection,columns:this.options.columns||e.prototype.columns,serializeRow:this.options.serializeRow||e.prototype.serializeRow})},load:function(e){return e(this.collection.fetch({reset:!0}))}})}),define("app/core/util/onModelDeleted",["app/i18n","app/viewport"],function(e,t){return function(n,r,i,o){var a=i?i.model:null;(o||a&&a._id===r.id)&&(n.subscribe("router.executing").setLimit(1).on("message",function(){t.msg.show({type:"warning",time:5e3,text:e(r.getNlsDomain()||"core","MSG:DELETED",{label:r.getLabel()})})}),n.publish("router.navigate",{url:r.genClientUrl("base"),trigger:!0,replace:!0}))}}),define("app/core/views/DetailsView",["app/viewport","app/i18n","../View","../util/onModelDeleted"],function(e,t,n,r){return n.extend({remoteTopics:function(){var e={},t=this.model.getTopicPrefix();return e[t+".edited"]="onModelEdited",e[t+".deleted"]="onModelDeleted",e},serialize:function(){return{model:this.serializeDetails(this.model)}},serializeDetails:function(e){return e.toJSON()},beforeRender:function(){this.stopListening(this.collection,"change",this.render)},afterRender:function(){this.listenToOnce(this.model,"change",this.render)},onModelEdited:function(e){var t=e.model;t&&t._id===this.model.id&&this.model.set(t)},onModelDeleted:function(e){r(this.broker,this.model,e)}})}),define("app/core/pages/DetailsPage",["app/i18n","../util/bindLoadingMessage","../util/pageActions","../View","../views/DetailsView"],function(e,t,n,r,i){return r.extend({layoutName:"page",pageId:"details",breadcrumbs:function(){return[{label:e.bound(this.model.nlsDomain,"BREADCRUMBS:browse"),href:this.model.genClientUrl("base")},this.model.getLabel()]},actions:function(){return[n.edit(this.model,this.model.privilegePrefix+":MANAGE"),n.delete(this.model,this.model.privilegePrefix+":MANAGE")]},initialize:function(){this.model=t(this.options.model,this);var e=this.DetailsView||i,n={model:this.model};"function"==typeof this.detailsTemplate&&(n.template=this.detailsTemplate),"function"==typeof this.serializeDetails&&(n.serializeDetails=this.serializeDetails),this.view=new e(n)},load:function(e){return e(this.model.fetch(this.fetchOptions))}})}),define("app/core/pages/AddFormPage",["app/i18n","../View","../views/FormView"],function(e,t,n){return t.extend({layoutName:"page",pageId:"addForm",breadcrumbs:function(){return[{label:e.bound(this.model.getNlsDomain(),"BREADCRUMBS:browse"),href:this.model.genClientUrl("base")},e.bound(this.model.getNlsDomain(),"BREADCRUMBS:addForm")]},initialize:function(){var t=this.options.FormView||this.FormView||n,r={editMode:!1,model:this.model,formMethod:"POST",formAction:this.model.url(),formActionText:e(this.model.getNlsDomain(),"FORM:ACTION:add"),failureText:e(this.model.getNlsDomain(),"FORM:ERROR:addFailure"),panelTitleText:e(this.model.getNlsDomain(),"PANEL:TITLE:addForm")};"function"==typeof this.options.formTemplate&&(r.template=this.options.formTemplate),this.view=new t(r)}})}),define("app/core/pages/EditFormPage",["app/i18n","../util/bindLoadingMessage","../View","../views/FormView"],function(e,t,n,r){return n.extend({layoutName:"page",pageId:"editForm",breadcrumbs:function(){return[{label:e.bound(this.model.getNlsDomain(),"BREADCRUMBS:browse"),href:this.model.genClientUrl("base")},{label:this.model.getLabel(),href:this.model.genClientUrl()},e.bound(this.model.getNlsDomain(),"BREADCRUMBS:editForm")]},initialize:function(){this.model=t(this.options.model,this);var n=this.options.FormView||this.FormView||r,i={editMode:!0,model:this.model,formMethod:"PUT",formAction:this.model.url(),formActionText:e(this.model.getNlsDomain(),"FORM:ACTION:edit"),failureText:e(this.model.getNlsDomain(),"FORM:ERROR:editFailure"),panelTitleText:e(this.model.getNlsDomain(),"PANEL:TITLE:editForm")};"function"==typeof this.options.formTemplate&&(i.template=this.options.formTemplate),this.view=new n(i)},load:function(e){return e(this.model.fetch(this.options.fetchOptions))}})}),define("app/core/pages/ActionFormPage",["underscore","app/i18n","../util/bindLoadingMessage","../View","../views/ActionFormView"],function(e,t,n,r,i){return r.extend({layoutName:"page",breadcrumbs:function(){return[{label:t.bound(this.model.getNlsDomain(),"BREADCRUMBS:browse"),href:this.model.genClientUrl("base")},{label:this.model.getLabel(),href:this.model.genClientUrl()},t.bound(this.model.getNlsDomain(),"BREADCRUMBS:ACTION_FORM:"+this.options.actionKey)]},initialize:function(){this.model=n(this.options.model,this);var r=this.options.actionKey;this.view=new i(e.defaults({model:this.model},this.options,{formActionText:t.bound(this.model.getNlsDomain(),"ACTION_FORM:BUTTON:"+r),messageText:t.bound(this.model.getNlsDomain(),"ACTION_FORM:MESSAGE:"+r),failureText:t.bound(this.model.getNlsDomain(),"ACTION_FORM:MESSAGE_FAILURE:"+r),requestData:{action:r}}))},load:function(e){return e(this.model.fetch())}})}),define("app/downtimeReasons/views/decorateDowntimeReason",["app/i18n"],function(e){return function(t){var n=t.toJSON();return n.scheduled=e("core","BOOL:"+n.scheduled),n.auto=e("core","BOOL:"+n.auto),n.type=e("downtimeReasons","type:"+n.type),n.subdivisionTypes=n.subdivisionTypes&&n.subdivisionTypes.length?n.subdivisionTypes.map(function(t){return e("downtimeReasons","subdivisionType:"+t)}).join("; "):e("downtimeReasons","subdivisionType:none"),n}}),define("app/downtimeReasons/templates/form",["app/i18n"],function(t){return function anonymous(locals,filters,escape,rethrow){escape=escape||function(e){return String(e).replace(/&(?!#?[a-zA-Z0-9]+;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&#39;").replace(/"/g,"&quot;")};var buf=[];with(locals||{})!function(){buf.push('<form class="downtimeReasons-form" method="post" action="',formAction,'">\n  <input type="hidden" name="_method" value="',formMethod,'">\n  <div class="panel panel-primary">\n    <div class="panel-heading">',panelTitleText,'</div>\n    <div class="panel-body">\n      <div class="form-group">\n        <label for="',idPrefix,'-id" class="control-label">',t("downtimeReasons","PROPERTY:_id"),'</label>\n        <input id="',idPrefix,'-id" class="form-control" type="text" name="_id" autofocus required maxlength="50" pattern="^[a-zA-Z][a-zA-Z_-]*$">\n      </div>\n      <div class="form-group">\n        <label for="',idPrefix,'-label" class="control-label">',t("downtimeReasons","PROPERTY:label"),'</label>\n        <input id="',idPrefix,'-label" class="form-control" type="text" name="label" required maxlength="100">\n      </div>\n      <div class="form-group">\n        <label for="',idPrefix,'-type-maintenance" class="control-label">',t("downtimeReasons","PROPERTY:type"),'</label>\n        <div class="radio">\n          <label>\n            <input id="',idPrefix,'-type-maintenance" type="radio" name="type" value="maintenance">\n            ',t("downtimeReasons","type:maintenance"),'\n          </label>\n        </div>\n        <div class="radio">\n          <label>\n            <input type="radio" name="type" value="renovation">\n            ',t("downtimeReasons","type:renovation"),'\n          </label>\n        </div>\n        <div class="radio">\n          <label>\n            <input type="radio" name="type" value="malfunction">\n            ',t("downtimeReasons","type:malfunction"),'\n          </label>\n        </div>\n        <div class="radio">\n          <label>\n            <input type="radio" name="type" value="adjusting">\n            ',t("downtimeReasons","type:adjusting"),'\n          </label>\n        </div>\n        <div class="radio">\n          <label>\n            <input type="radio" name="type" value="break">\n            ',t("downtimeReasons","type:break"),'\n          </label>\n        </div>\n        <div class="radio">\n          <label>\n            <input type="radio" name="type" value="otherWorks">\n            ',t("downtimeReasons","type:otherWorks"),'\n          </label>\n        </div>\n        <div class="radio">\n          <label>\n            <input type="radio" name="type" value="other">\n            ',t("downtimeReasons","type:other"),'\n          </label>\n        </div>\n      </div>\n      <div class="form-group">\n        <label for="',idPrefix,'-subdivisions-assembly" class="control-label">',t("downtimeReasons","PROPERTY:subdivisionTypes"),'</label>\n        <div class="checkbox">\n          <label>\n            <input id="',idPrefix,'-subdivisions-assembly" type="checkbox" name="subdivisionTypes[]" value="assembly">\n            ',t("downtimeReasons","subdivisionType:assembly"),'\n          </label>\n        </div>\n        <div class="checkbox">\n          <label>\n            <input type="checkbox" name="subdivisionTypes[]" value="press">\n            ',t("downtimeReasons","subdivisionType:press"),'\n          </label>\n        </div>\n      </div>\n      <div class="form-group">\n        <label for="',idPrefix,'-opticsPosition" class="control-label">',t("downtimeReasons","PROPERTY:opticsPosition"),'</label>\n        <input id="',idPrefix,'-opticsPosition" class="form-control" type="number" name="opticsPosition">\n      </div>\n      <div class="form-group">\n        <label for="',idPrefix,'-pressPosition" class="control-label">',t("downtimeReasons","PROPERTY:pressPosition"),'</label>\n        <input id="',idPrefix,'-pressPosition" class="form-control" type="number" name="pressPosition">\n      </div>\n      <div class="form-group">\n        <label class="control-label checkbox">\n          <input id="',idPrefix,'-auto" type="checkbox" name="auto" value="true">\n          ',t("downtimeReasons","PROPERTY:auto"),'\n        </label>\n      </div>\n      <div class="form-group">\n        <label for="',idPrefix,'-scheduled-yes" class="control-label">',t("downtimeReasons","PROPERTY:scheduled"),'</label>\n        <div class="radio">\n          <label>\n            <input id="',idPrefix,'-type-yes" type="radio" name="scheduled" value="true">\n            ',t("core","BOOL:true"),'\n          </label>\n        </div>\n        <div class="radio">\n          <label>\n            <input type="radio" name="scheduled" value="false">\n            ',t("core","BOOL:false"),'\n          </label>\n        </div>\n        <div class="radio">\n          <label>\n            <input type="radio" name="scheduled" value="null">\n            ',t("core","BOOL:null"),'\n          </label>\n        </div>\n      </div>\n    </div>\n    <div class="panel-footer">\n      <button type="submit" class="btn btn-primary">',formActionText,"</button>\n    </div>\n  </div>\n</form>\n")}();return buf.join("")}}),define("app/downtimeReasons/views/DowntimeReasonFormView",["app/core/views/FormView","app/downtimeReasons/templates/form"],function(e,t){return e.extend({template:t,afterRender:function(){e.prototype.afterRender.call(this),this.options.editMode&&(this.$(".form-control[name=_id]").attr("readonly",!0),this.$(".form-control[name=label]").focus())},serializeToForm:function(){var e=this.model.toJSON();return e.scheduled=String(e.scheduled),e},serializeForm:function(e){return"null"===e.scheduled&&(e.scheduled=null),e}})}),define("app/downtimeReasons/templates/details",["app/i18n"],function(t){return function anonymous(locals,filters,escape,rethrow){escape=escape||function(e){return String(e).replace(/&(?!#?[a-zA-Z0-9]+;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&#39;").replace(/"/g,"&quot;")};var buf=[];with(locals||{})!function(){buf.push('<div class="panel panel-primary">\n  <div class="panel-heading">',t("downtimeReasons","PANEL:TITLE:details"),'</div>\n  <div class="panel-details">\n    <div class="props first">\n      <div class="prop">\n        <div class="prop-name">',t("downtimeReasons","PROPERTY:_id"),'</div>\n        <div class="prop-value">',escape(model._id),'</div>\n      </div>\n      <div class="prop">\n        <div class="prop-name">',t("downtimeReasons","PROPERTY:label"),'</div>\n        <div class="prop-value">',escape(model.label),'</div>\n      </div>\n      <div class="prop">\n        <div class="prop-name">',t("downtimeReasons","PROPERTY:type"),'</div>\n        <div class="prop-value">',escape(model.type),'</div>\n      </div>\n      <div class="prop">\n        <div class="prop-name">',t("downtimeReasons","PROPERTY:subdivisionTypes"),'</div>\n        <div class="prop-value">',escape(model.subdivisionTypes),'</div>\n      </div>\n      <div class="prop">\n        <div class="prop-name">',t("downtimeReasons","PROPERTY:opticsPosition"),'</div>\n        <div class="prop-value">',model.opticsPosition,'</div>\n      </div>\n      <div class="prop">\n        <div class="prop-name">',t("downtimeReasons","PROPERTY:pressPosition"),'</div>\n        <div class="prop-value">',model.pressPosition,'</div>\n      </div>\n      <div class="prop">\n        <div class="prop-name">',t("downtimeReasons","PROPERTY:auto"),'</div>\n        <div class="prop-value">',model.auto,'</div>\n      </div>\n      <div class="prop">\n        <div class="prop-name">',t("downtimeReasons","PROPERTY:scheduled"),'</div>\n        <div class="prop-value">',model.scheduled,"</div>\n      </div>\n    </div>\n  </div>\n</div>\n")}();return buf.join("")}}),define("app/nls/downtimeReasons",["app/nls/locale/en"],function(e){var t={locale:{}};t.locale.en=e;var n=function(e){if(!e)throw new Error("MessageFormat: No data passed to function.")},r=function(e,t){return n(e),e[t]};return{root:{"BREADCRUMBS:browse":function(){return"Downtime reasons"},"BREADCRUMBS:addForm":function(){return"Adding"},"BREADCRUMBS:editForm":function(){return"Editing"},"BREADCRUMBS:ACTION_FORM:delete":function(){return"Deleting"},"MSG:LOADING_FAILURE":function(){return"Failed to load thedowntime reasons :("},"MSG:LOADING_SINGLE_FAILURE":function(){return"Failed to load the downtime reason :("},"MSG:DELETED":function(e){return"Downtime reason <em>"+r(e,"label")+"</em> was deleted."},"PAGE_ACTION:add":function(){return"Add downtime reason"},"PAGE_ACTION:edit":function(){return"Edit downtime reason"},"PAGE_ACTION:delete":function(){return"Delete downtime reason"},"PANEL:TITLE:details":function(){return"Downtime reason's details"},"PANEL:TITLE:addForm":function(){return"Add downtime reason form"},"PANEL:TITLE:editForm":function(){return"Edit downtime reason form"},"PROPERTY:_id":function(){return"ID"},"PROPERTY:label":function(){return"Label"},"PROPERTY:type":function(){return"Type"},"PROPERTY:subdivisionTypes":function(){return"Subdivision types"},"PROPERTY:opticsPosition":function(){return"Position in Worksheet (optics)"},"PROPERTY:pressPosition":function(){return"Position in Worksheet (other)"},"PROPERTY:scheduled":function(){return"Scheduled?"},"PROPERTY:auto":function(){return"Auto confirmation?"},"type:other":function(){return"Other"},"type:malfunction":function(){return"Malfunction"},"type:renovation":function(){return"Inspection/renovation"},"type:maintenance":function(){return"Maintenance"},"type:adjusting":function(){return"Adjusting/rearmament"},"type:break":function(){return"Break"},"type:otherWorks":function(){return"Other works"},"subdivisionType:none":function(){return"None"},"subdivisionType:assembly":function(){return"Assembly"},"subdivisionType:press":function(){return"Press"},"FORM:ACTION:add":function(){return"Add downtime reason"},"FORM:ACTION:edit":function(){return"Edit downtime reason"},"FORM:ERROR:addFailure":function(){return"Failed to add the new downtime reason :-("},"FORM:ERROR:editFailure":function(){return"Failed to edit the downtime reason :-("},"ACTION_FORM:DIALOG_TITLE:delete":function(){return"Downtime reason deletion confirmation"},"ACTION_FORM:BUTTON:delete":function(){return"Delete downtime reason"},"ACTION_FORM:MESSAGE:delete":function(){return"Are you sure you want to delete the chosen downtime reason?"},"ACTION_FORM:MESSAGE_SPECIFIC:delete":function(e){return"Are you sure you want to delete the <em>"+r(e,"label")+"</em> downtime reason?"},"ACTION_FORM:MESSAGE_FAILURE:delete":function(){return"Failed to delete the downtime reason :-("}},pl:!0}}),define("app/nls/pl/downtimeReasons",["app/nls/locale/pl"],function(e){var t={locale:{}};t.locale.pl=e;var n=function(e){if(!e)throw new Error("MessageFormat: No data passed to function.")},r=function(e,t){return n(e),e[t]};return{"BREADCRUMBS:browse":function(){return"Powody przestojów"},"BREADCRUMBS:addForm":function(){return"Dodawanie"},"BREADCRUMBS:editForm":function(){return"Edycja"},"BREADCRUMBS:ACTION_FORM:delete":function(){return"Usuwanie"},"MSG:LOADING_FAILURE":function(){return"Ładowanie powodów przestojów nie powiodło się :("},"MSG:LOADING_SINGLE_FAILURE":function(){return"Ładowanie powodu przestojów nie powiodło się :("},"MSG:DELETED":function(e){return"Powód przestojów <em>"+r(e,"label")+"</em> został usunięty."},"PAGE_ACTION:add":function(){return"Dodaj powód przestojów"},"PAGE_ACTION:edit":function(){return"Edytuj powód przestojów"},"PAGE_ACTION:delete":function(){return"Usuń powód przestojów"},"PANEL:TITLE:details":function(){return"Szczegóły powodu przestojów"},"PANEL:TITLE:addForm":function(){return"Formularz dodawania powodu przestojów"},"PANEL:TITLE:editForm":function(){return"Formularz edycji powodu przestojów"},"PROPERTY:_id":function(){return"ID"},"PROPERTY:label":function(){return"Opis"},"PROPERTY:type":function(){return"Typ"},"PROPERTY:subdivisionTypes":function(){return"Typy działów"},"PROPERTY:opticsPosition":function(){return"Pozycja na karcie pracy (montaż optyki)"},"PROPERTY:pressPosition":function(){return"Pozycja na karcie pracy (inne)"},"PROPERTY:scheduled":function(){return"Planowany?"},"PROPERTY:auto":function(){return"Automatyczne potwierdzanie?"},"type:other":function(){return"Inny"},"type:malfunction":function(){return"Awaria"},"type:renovation":function(){return"Przegląd/remont"},"type:maintenance":function(){return"Konserwacja"},"type:adjusting":function(){return"Ustawianie/przezbrojenie"},"type:break":function(){return"Przerwa"},"type:otherWorks":function(){return"Inne prace"},"subdivisionType:none":function(){return"Żadne"},"subdivisionType:assembly":function(){return"Montaż"},"subdivisionType:press":function(){return"Tłocznia"},"FORM:ACTION:add":function(){return"Dodaj powód przestojów"},"FORM:ACTION:edit":function(){return"Edytuj powód przestojów"},"FORM:ERROR:addFailure":function(){return"Nie udało się dodać powodu przestojów :-("},"FORM:ERROR:editFailure":function(){return"Nie udało się zmodyfikować powodu przestojów :-("},"ACTION_FORM:DIALOG_TITLE:delete":function(){return"Potwierdzenie usunięcia powodu przestojów"},"ACTION_FORM:BUTTON:delete":function(){return"Usuń powód przestojów"},"ACTION_FORM:MESSAGE:delete":function(){return"Czy na pewno chcesz bezpowrotnie usunąć wybrany powód przestojów?"},"ACTION_FORM:MESSAGE_SPECIFIC:delete":function(e){return"Czy na pewno chcesz bezpowrotnie usunąć powód przestojów <em>"+r(e,"label")+"</em>?"},"ACTION_FORM:MESSAGE_FAILURE:delete":function(){return"Nie udało się usunąć powodu przestojów :-("}}}),define("app/downtimeReasons/routes",["../router","../viewport","../user","../i18n","../data/downtimeReasons","./DowntimeReason","../core/pages/ListPage","../core/pages/DetailsPage","../core/pages/AddFormPage","../core/pages/EditFormPage","../core/pages/ActionFormPage","./views/decorateDowntimeReason","./views/DowntimeReasonFormView","app/downtimeReasons/templates/details","i18n!app/nls/downtimeReasons"],function(e,t,n,r,i,o,a,s,u,l,c,d,p,f){var h=n.auth("DICTIONARIES:VIEW"),m=n.auth("DICTIONARIES:MANAGE");e.map("/downtimeReasons",h,function(){t.showPage(new a({collection:i,columns:["_id","label","type","subdivisionTypes","opticsPosition","pressPosition","auto","scheduled"],serializeRow:d}))}),e.map("/downtimeReasons/:id",function(e){t.showPage(new s({model:new o({_id:e.params.id}),detailsTemplate:f,serializeDetails:d}))}),e.map("/downtimeReasons;add",m,function(){t.showPage(new u({FormView:p,model:new o}))}),e.map("/downtimeReasons/:id;edit",m,function(e){t.showPage(new l({FormView:p,model:new o({_id:e.params.id})}))}),e.map("/downtimeReasons/:id;delete",m,function(e,n){var r=new o({_id:e.params.id});t.showPage(new c({model:r,actionKey:"delete",successUrl:r.genClientUrl("base"),cancelUrl:n||r.genClientUrl("base"),formMethod:"DELETE",formAction:r.url(),formActionSeverity:"danger"}))})}),define("app/lossReasons/LossReason",["../core/Model"],function(e){return e.extend({urlRoot:"/lossReasons",clientUrlRoot:"#lossReasons",topicPrefix:"lossReasons",privilegePrefix:"DICTIONARIES",nlsDomain:"lossReasons",labelAttribute:"label",defaults:{label:null,position:0},toJSON:function(){var t=e.prototype.toJSON.call(this);return t.label||(t.label=t._id),t}})}),define("app/lossReasons/LossReasonCollection",["../core/Collection","./LossReason"],function(e,t){return e.extend({model:t,rqlQuery:"select(label,position)&sort(position)"})}),define("app/lossReasons/templates/form",["app/i18n"],function(t){return function anonymous(locals,filters,escape,rethrow){escape=escape||function(e){return String(e).replace(/&(?!#?[a-zA-Z0-9]+;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&#39;").replace(/"/g,"&quot;")};var buf=[];with(locals||{})!function(){buf.push('<form class="lossReasons-form" method="post" action="',formAction,'">\n  <input type="hidden" name="_method" value="',formMethod,'">\n  <div class="panel panel-primary">\n    <div class="panel-heading">',panelTitleText,'</div>\n    <div class="panel-body">\n      <div class="form-group">\n        <label for="',idPrefix,'-id" class="control-label">',t("lossReasons","PROPERTY:_id"),'</label>\n        <input id="',idPrefix,'-id" class="form-control" type="text" name="_id" autofocus required maxlength="50">\n      </div>\n      <div class="form-group">\n        <label for="',idPrefix,'-label" class="control-label">',t("lossReasons","PROPERTY:label"),'</label>\n        <input id="',idPrefix,'-label" class="form-control" type="text" name="label" required maxlength="100">\n      </div>\n      <div class="form-group">\n        <label for="',idPrefix,'-position" class="control-label">',t("lossReasons","PROPERTY:position"),'</label>\n        <input id="',idPrefix,'-position" class="form-control" type="number" name="position" min="0">\n      </div>\n    </div>\n    <div class="panel-footer">\n      <button type="submit" class="btn btn-primary">',formActionText,"</button>\n    </div>\n  </div>\n</form>\n")
}();return buf.join("")}}),define("app/lossReasons/views/LossReasonFormView",["app/core/views/FormView","app/lossReasons/templates/form"],function(e,t){return e.extend({template:t,afterRender:function(){e.prototype.afterRender.call(this),this.options.editMode&&(this.$(".form-control[name=_id]").attr("readonly",!0),this.$(".form-control[name=label]").focus())}})}),define("app/lossReasons/templates/details",["app/i18n"],function(t){return function anonymous(locals,filters,escape,rethrow){escape=escape||function(e){return String(e).replace(/&(?!#?[a-zA-Z0-9]+;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&#39;").replace(/"/g,"&quot;")};var buf=[];with(locals||{})!function(){buf.push('<div class="panel panel-primary">\n  <div class="panel-heading">',t("lossReasons","PANEL:TITLE:details"),'</div>\n  <div class="panel-details">\n    <div class="props first">\n      <div class="prop">\n        <div class="prop-name">',t("lossReasons","PROPERTY:_id"),'</div>\n        <div class="prop-value">',escape(model._id),'</div>\n      </div>\n      <div class="prop">\n        <div class="prop-name">',t("lossReasons","PROPERTY:label"),'</div>\n        <div class="prop-value">',escape(model.label||"-"),'</div>\n      </div>\n      <div class="prop">\n        <div class="prop-name">',t("lossReasons","PROPERTY:position"),'</div>\n        <div class="prop-value">',escape(model.position),"</div>\n      </div>\n    </div>\n  </div>\n</div>\n")}();return buf.join("")}}),define("app/nls/lossReasons",["app/nls/locale/en"],function(e){var t={locale:{}};t.locale.en=e;var n=function(e){if(!e)throw new Error("MessageFormat: No data passed to function.")},r=function(e,t){return n(e),e[t]};return{root:{"BREADCRUMBS:browse":function(){return"Loss reasons"},"BREADCRUMBS:addForm":function(){return"Adding"},"BREADCRUMBS:editForm":function(){return"Editing"},"BREADCRUMBS:ACTION_FORM:delete":function(){return"Deleting"},"MSG:LOADING_FAILURE":function(){return"Failed to load the loss reasons :("},"MSG:LOADING_SINGLE_FAILURE":function(){return"Failed to load the loss reason :("},"MSG:DELETED":function(e){return"Loss reason <em>"+r(e,"label")+"</em> was deleted."},"PAGE_ACTION:add":function(){return"Add loss reason"},"PAGE_ACTION:edit":function(){return"Edit loss reason"},"PAGE_ACTION:delete":function(){return"Delete loss reason"},"PANEL:TITLE:details":function(){return"Loss reason's details"},"PANEL:TITLE:addForm":function(){return"Add loss reason form"},"PANEL:TITLE:editForm":function(){return"Edit loss reason form"},"PROPERTY:_id":function(){return"ID"},"PROPERTY:label":function(){return"Label"},"PROPERTY:position":function(){return"Position in Worksheet"},"FORM:ACTION:add":function(){return"Add loss reason"},"FORM:ACTION:edit":function(){return"Edit loss reason"},"FORM:ERROR:addFailure":function(){return"Failed to add the new loss reason :-("},"FORM:ERROR:editFailure":function(){return"Failed to edit the loss reason :-("},"ACTION_FORM:DIALOG_TITLE:delete":function(){return"Loss reason deletion confirmation"},"ACTION_FORM:BUTTON:delete":function(){return"Delete loss reason"},"ACTION_FORM:MESSAGE:delete":function(){return"Are you sure you want to delete the chosen loss reason?"},"ACTION_FORM:MESSAGE_SPECIFIC:delete":function(e){return"Are you sure you want to delete the <em>"+r(e,"label")+"</em> loss reason?"},"ACTION_FORM:MESSAGE_FAILURE:delete":function(){return"Failed to delete the loss reason :-("}},pl:!0}}),define("app/nls/pl/lossReasons",["app/nls/locale/pl"],function(e){var t={locale:{}};t.locale.pl=e;var n=function(e){if(!e)throw new Error("MessageFormat: No data passed to function.")},r=function(e,t){return n(e),e[t]};return{"BREADCRUMBS:browse":function(){return"Powody strat materiałowych"},"BREADCRUMBS:addForm":function(){return"Dodawanie"},"BREADCRUMBS:editForm":function(){return"Edycja"},"BREADCRUMBS:ACTION_FORM:delete":function(){return"Usuwanie"},"MSG:LOADING_FAILURE":function(){return"Ładowanie powodów strat materiałowych nie powiodło się :("},"MSG:LOADING_SINGLE_FAILURE":function(){return"Ładowanie powodu strat materiałowych nie powiodło się :("},"MSG:DELETED":function(e){return"Powód strat materiałowych <em>"+r(e,"label")+"</em> został usunięty."},"PAGE_ACTION:add":function(){return"Dodaj powod strat materiałowych"},"PAGE_ACTION:edit":function(){return"Edytuj powod strat materiałowych"},"PAGE_ACTION:delete":function(){return"Usuń powod strat materiałowych"},"PANEL:TITLE:details":function(){return"Szczegóły powodu strat materiałowych"},"PANEL:TITLE:addForm":function(){return"Formularz dodawania powodu strat materiałowych"},"PANEL:TITLE:editForm":function(){return"Formularz edycji powodu strat materiałowych"},"PROPERTY:_id":function(){return"ID"},"PROPERTY:label":function(){return"Opis"},"PROPERTY:position":function(){return"Pozycja na karcie pracy"},"FORM:ACTION:add":function(){return"Dodaj powod strat materiałowych"},"FORM:ACTION:edit":function(){return"Edytuj powod strat materiałowych"},"FORM:ERROR:addFailure":function(){return"Nie udało się dodać powodu strat materiałowych :-("},"FORM:ERROR:editFailure":function(){return"Nie udało się zmodyfikować powodu strat materiałowych :-("},"ACTION_FORM:DIALOG_TITLE:delete":function(){return"Potwierdzenie usunięcia powodu strat materiałowych"},"ACTION_FORM:BUTTON:delete":function(){return"Usuń powod strat materiałowych"},"ACTION_FORM:MESSAGE:delete":function(){return"Czy na pewno chcesz bezpowrotnie usunąć wybrany powod strat materiałowych?"},"ACTION_FORM:MESSAGE_SPECIFIC:delete":function(e){return"Czy na pewno chcesz bezpowrotnie usunąć powod strat materiałowych <em>"+r(e,"label")+"</em>?"},"ACTION_FORM:MESSAGE_FAILURE:delete":function(){return"Nie udało się usunąć powodu strat materiałowych :-("}}}),define("app/lossReasons/routes",["../router","../viewport","../user","./LossReasonCollection","./LossReason","../core/pages/ListPage","../core/pages/DetailsPage","../core/pages/AddFormPage","../core/pages/EditFormPage","../core/pages/ActionFormPage","./views/LossReasonFormView","app/lossReasons/templates/details","i18n!app/nls/lossReasons"],function(e,t,n,r,i,o,a,s,u,l,c,d){var p=n.auth("DICTIONARIES:VIEW"),f=n.auth("DICTIONARIES:MANAGE");e.map("/lossReasons",p,function(e){t.showPage(new o({collection:new r(null,{rqlQuery:e.rql}),columns:["_id","label","position"]}))}),e.map("/lossReasons/:id",function(e){t.showPage(new a({model:new i({_id:e.params.id}),detailsTemplate:d}))}),e.map("/lossReasons;add",f,function(){t.showPage(new s({FormView:c,model:new i}))}),e.map("/lossReasons/:id;edit",f,function(e){t.showPage(new u({FormView:c,model:new i({_id:e.params.id})}))}),e.map("/lossReasons/:id;delete",f,function(e,n){var r=new i({_id:e.params.id});t.showPage(new l({model:r,actionKey:"delete",successUrl:r.genClientUrl("base"),cancelUrl:n||r.genClientUrl("base"),formMethod:"DELETE",formAction:r.url(),formActionSeverity:"danger"}))})}),define("app/nls/events",["app/nls/locale/en"],function(e){var t={locale:{}};t.locale.en=e;var n=function(e){if(!e)throw new Error("MessageFormat: No data passed to function.")},r=function(e,t,n){if(isNaN(e[t]))throw new Error("MessageFormat: `"+t+"` isnt a number.");return e[t]-(n||0)},i=function(e,t){return n(e),e[t]},o=function(e,r,i,o,a){return n(e),e[r]in a?a[e[r]]:(r=t.locale[o](e[r]-i),r in a?a[r]:a.other)},a=function(e,t,r){return n(e),e[t]in r?r[e[t]]:r.other};return{root:{"MSG:LOADING_FAILURE":function(){return"Failed to load the events :("},"MSG:LOADING_TYPES_FAILURE":function(){return"Failed to load the event types :("},"BREADCRUMBS:browse":function(){return"Events"},"FILTER:DATE:FROM":function(){return"From"},"FILTER:DATE:TO":function(){return"To"},"FILTER:PLACEHOLDER:type":function(){return"Any type"},"FILTER:SYSTEM_USER":function(){return"System"},"FILTER:LIMIT":function(){return"Limit"},"FILTER:BUTTON":function(){return"Filter events"},"PROPERTY:time":function(){return"Time of occurrence"},"PROPERTY:user":function(){return"User"},"PROPERTY:type":function(){return"Type"},"PROPERTY:text":function(){return"Description"},"PROPERTY:severity":function(){return"Severity"},"TYPE:app.started":function(){return"System start"},"TEXT:app.started":function(e){return"<em>"+a(e,"id",{frontend:"Application server",importer:"Importer server",other:"Server "+i(e,"id")})+"</em> started in the <em>"+a(e,"env",{development:"development",production:"production",other:"unspecified"})+"</em> environment in <em>"+i(e,"time")+"</em> ms."},"TYPE:users.login":function(){return"Users: log in"},"TEXT:users.login":function(){return"-"},"TYPE:users.loginFailure":function(){return"Users: log in failure"},"TEXT:users.loginFailure":function(e){return"Failed log in to account: <em>"+i(e,"login")+"</em>"},"TYPE:users.logout":function(){return"Users: log out"},"TEXT:users.logout":function(){return"-"},"TYPE:users.added":function(){return"Users: added"},"TEXT:users.added":function(e){return"Added user: <a href='#users/"+i(e,"model->_id")+"'>"+i(e,"model->login")+"</a>"},"TYPE:users.edited":function(){return"Users: edited"},"TEXT:users.edited":function(e){return"Edited user: <a href='#users/"+i(e,"model->_id")+"'>"+i(e,"model->login")+"</a>"},"TYPE:users.deleted":function(){return"Users: deleted"},"TEXT:users.deleted":function(e){return"Deleted user: <em>"+i(e,"model->login")+"</em>"},"TYPE:users.synced":function(){return"Users: synchronization"},"TEXT:users.synced":function(e){return"Added "+o(e,"created",0,"en",{one:"1 new user",other:r(e,"created")+" new users"})+" and modified "+o(e,"updated",0,"en",{one:"1 existing user",other:r(e,"updated")+" existing users"})+" during synchronization with the AC database."},"TYPE:users.syncFailed":function(){return"Users: synchronization failure"},"TEXT:users.syncFailed":function(e){return"Failed to synchronize users with the AC database: <em>"+i(e,"error")+"</em>"},"TYPE:mechOrders.edited":function(){return"Mechanical orders: edited"},"TEXT:mechOrders.edited":function(e){return"Edited mechanical order: <a href='#mechOrders/"+i(e,"model->_id")+"'>"+i(e,"model->_id")+"</a>"},"TYPE:mechOrders.synced":function(){return"Mechanical orders: import"},"TEXT:mechOrders.synced":function(e){return"Imported "+o(e,"count",0,"en",{one:"1 mechanical order",other:r(e,"count")+" mechanical orders"})+"."},"TYPE:emptyOrders.synced":function(){return"Empty orders: synchronization"},"TEXT:emptyOrders.synced":function(e){return"Added "+o(e,"count",0,"en",{one:"1 new empty order",other:r(e,"count")+" new empty orders"})+"."},"TYPE:orders.synced":function(){return"Production orders: synchronization"},"TEXT:orders.synced":function(e){return"Added "+i(e,"created")+" new and edited "+o(e,"updated",0,"en",{one:"1 existing order",other:r(e,"updated")+" existing orders"})+a(e,"moduleName",{currentDayOrderImporter:"&nbsp;from the current day",nextDayOrderImporter:"&nbsp;from the next day",prevDayOrderImporter:"&nbsp;from the previous day",other:""})+"."},"TYPE:orderStatuses.added":function(){return"Order statuses: added"},"TEXT:orderStatuses.added":function(e){return"Added order status: <a href='#orderStatuses/"+i(e,"model->_id")+"'>"+i(e,"model->_id")+"</a>"},"TYPE:orderStatuses.edited":function(){return"Order statuses: edited"},"TEXT:orderStatuses.edited":function(e){return"Edited order status: <a href='#orderStatuses/"+i(e,"model->_id")+"'>"+i(e,"model->_id")+"</a>"},"TYPE:orderStatuses.deleted":function(){return"Order statuses: deleted"},"TEXT:orderStatuses.deleted":function(e){return"Deleted order status: <em>"+i(e,"model->_id")+"</em>"},"TYPE:downtimeReasons.added":function(){return"Downtime reasons: added"},"TEXT:downtimeReasons.added":function(e){return"Added downtime reason: <a href='#downtimeReasons/"+i(e,"model->_id")+"'>"+i(e,"model->_id")+"</a>"},"TYPE:downtimeReasons.edited":function(){return"Downtime reasons: edited"},"TEXT:downtimeReasons.edited":function(e){return"Edited downtime reason: <a href='#downtimeReasons/"+i(e,"model->_id")+"'>"+i(e,"model->_id")+"</a>"},"TYPE:downtimeReasons.deleted":function(){return"Downtime reasons: deleted"},"TEXT:downtimeReasons.deleted":function(e){return"Deleted downtime reason: <em>"+i(e,"model->_id")+"</em>"},"TYPE:lossReasons.added":function(){return"Loss reasons: added"},"TEXT:lossReasons.added":function(e){return"Added loss reason: <a href='#lossReasons/"+i(e,"model->_id")+"'>"+i(e,"model->_id")+"</a>"},"TYPE:lossReasons.edited":function(){return"Loss reasons: edited"},"TEXT:lossReasons.edited":function(e){return"Edited loss reason: <a href='#lossReasons/"+i(e,"model->_id")+"'>"+i(e,"model->_id")+"</a>"},"TYPE:lossReasons.deleted":function(){return"Loss reasons: deleted"},"TEXT:lossReasons.deleted":function(e){return"Deleted loss reason: <em>"+i(e,"model->_id")+"</em>"},"TYPE:aors.added":function(){return"Areas of responsibility: added"},"TEXT:aors.added":function(e){return"Added area of responsibility: <a href='#aors/"+i(e,"model->_id")+"'>"+i(e,"model->name")+"</a>"},"TYPE:aors.edited":function(){return"Areas of responsibility: edited"},"TEXT:aors.edited":function(e){return"Edited area of responsibility: <a href='#aors/"+i(e,"model->_id")+"'>"+i(e,"model->name")+"</a>"},"TYPE:aors.deleted":function(){return"Areas of responsibility: deleted"},"TEXT:aors.deleted":function(e){return"Deleted area of responsibility: <em>"+i(e,"model->name")+"</em>"},"TYPE:workCenters.added":function(){return"WorkCenters: added"},"TEXT:workCenters.added":function(e){return"Added WorkCenter: <a href='#workCenters/"+i(e,"model->_id")+"'>"+i(e,"model->_id")+"</a>"},"TYPE:workCenters.edited":function(){return"WorkCenters: edited"},"TEXT:workCenters.edited":function(e){return"Edited WorkCenter: <a href='#workCenters/"+i(e,"model->_id")+"'>"+i(e,"model->_id")+"</a>"},"TYPE:workCenters.deleted":function(){return"WorkCenters: deleted"},"TEXT:workCenters.deleted":function(e){return"Deleted WorkCenter: <em>"+i(e,"model->_id")+"</em>"},"TYPE:divisions.added":function(){return"Divisions: added"},"TEXT:divisions.added":function(e){return"Added division: <a href='#divisions/"+i(e,"model->_id")+"'>"+i(e,"model->_id")+"</a>"},"TYPE:divisions.edited":function(){return"Divisions: edited"},"TEXT:divisions.edited":function(e){return"Edited division: <a href='#divisions/"+i(e,"model->_id")+"'>"+i(e,"model->_id")+"</a>"},"TYPE:divisions.deleted":function(){return"Divisions: deleted"},"TEXT:divisions.deleted":function(e){return"Deleted division: <em>"+i(e,"model->_id")+"</em>"},"TYPE:subdivisions.added":function(){return"Subdivisions: added"},"TEXT:subdivisions.added":function(e){return"Added subdivision: <a href='#subdivisions/"+i(e,"model->_id")+"'>"+i(e,"model->name")+"</a>"},"TYPE:subdivisions.edited":function(){return"Subdivisions: edited"},"TEXT:subdivisions.edited":function(e){return"Edited subdivision: <a href='#subdivisions/"+i(e,"model->_id")+"'>"+i(e,"model->name")+"</a>"},"TYPE:subdivisions.deleted":function(){return"Subdivisions: deleted"},"TEXT:subdivisions.deleted":function(e){return"Deleted subdivision: <em>"+i(e,"model->name")+"</em>"},"TYPE:companies.added":function(){return"Companies: added"},"TEXT:companies.added":function(e){return"Added company: <a href='#companies/"+i(e,"model->_id")+"'>"+i(e,"model->name")+"</a>"},"TYPE:companies.edited":function(){return"Companies: edited"},"TEXT:companies.edited":function(e){return"Edited company: <a href='#companies/"+i(e,"model->_id")+"'>"+i(e,"model->name")+"</a>"},"TYPE:companies.deleted":function(){return"Companies: deleted"},"TEXT:companies.deleted":function(e){return"Deleted company: <em>"+i(e,"model->name")+"</em>"},"TYPE:mrpControllers.added":function(){return"MRP Controllers: added"},"TEXT:mrpControllers.added":function(e){return"Added MRP Controller: <a href='#mrpControllers/"+i(e,"model->_id")+"'>"+i(e,"model->_id")+"</a>"},"TYPE:mrpControllers.edited":function(){return"MRP Controllers: edited"},"TEXT:mrpControllers.edited":function(e){return"Edited MRP Controller: <a href='#mrpControllers/"+i(e,"model->_id")+"'>"+i(e,"model->_id")+"</a>"},"TYPE:mrpControllers.deleted":function(){return"MRP Controllers: deleted"},"TEXT:mrpControllers.deleted":function(e){return"Deleted MRP Controller: <em>"+i(e,"model->_id")+"</em>"},"TYPE:prodLines.added":function(){return"Production line: added"},"TEXT:prodLines.added":function(e){return"Added production line: <a href='#prodLines/"+i(e,"model->_id")+"'>"+i(e,"model->_id")+"</a>"},"TYPE:prodLines.edited":function(){return"Production line: edited"},"TEXT:prodLines.edited":function(e){return"Edited production line: <a href='#prodLines/"+i(e,"model->_id")+"'>"+i(e,"model->_id")+"</a>"},"TYPE:prodLines.deleted":function(){return"Production line: deleted"},"TEXT:prodLines.deleted":function(e){return"Deleted production line: <em>"+i(e,"model->_id")+"</em>"},"TYPE:prodTasks.added":function(){return"Production tasks: added"},"TEXT:prodTasks.added":function(e){return"Added production task: <a href='#prodTasks/"+i(e,"model->_id")+"'>"+i(e,"model->name")+"</a>"},"TYPE:prodTasks.edited":function(){return"Production tasks: edited"},"TEXT:prodTasks.edited":function(e){return"Edited production task: <a href='#prodTasks/"+i(e,"model->_id")+"'>"+i(e,"model->name")+"</a>"},"TYPE:prodTasks.deleted":function(){return"Production tasks: deleted"},"TEXT:prodTasks.deleted":function(e){return"Deleted production task: <em>"+i(e,"model->name")+"</em>"},"TYPE:prodFlows.added":function(){return"Production flows: added"},"TEXT:prodFlows.added":function(e){return"Added production flow: <a href='#prodFlows/"+i(e,"model->_id")+"'>"+i(e,"model->name")+"</a>"},"TYPE:prodFlows.edited":function(){return"Production flows: edited"},"TEXT:prodFlows.edited":function(e){return"Edited production flow: <a href='#prodFlows/"+i(e,"model->_id")+"'>"+i(e,"model->name")+"</a>"},"TYPE:prodFlows.deleted":function(){return"Production flows: deleted"},"TEXT:prodFlows.deleted":function(e){return"Deleted production flow: <em>"+i(e,"model->name")+"</em>"},"TYPE:prodFunctions.added":function(){return"Production functions: added"},"TEXT:prodFunctions.added":function(e){return"Added production function: <a href='#prodFunctions/"+i(e,"model->_id")+"'>"+i(e,"model->label")+"</a>"},"TYPE:prodFunctions.edited":function(){return"Production functions: edited"},"TEXT:prodFunctions.edited":function(e){return"Edited production function: <a href='#prodFunctions/"+i(e,"model->_id")+"'>"+i(e,"model->label")+"</a>"},"TYPE:prodFunctions.deleted":function(){return"Production functions: deleted"},"TEXT:prodFunctions.deleted":function(e){return"Deleted production function: <em>"+i(e,"model->label")+"</em>"},"TYPE:fte.leader.created":function(){return"FTE (warehouse): added"},"TEXT:fte.leader.created":function(e){return"Created <a href='#fte/leader/"+i(e,"model->_id")+"'>a new FTE (warehouse) entry</a> for <em>"+i(e,"model->shift")+"</em> shift of <em>"+i(e,"model->date")+"</em> for subdivision <em>"+i(e,"model->subdivision")+"</em>."},"TYPE:fte.leader.locked":function(){return"FTE (warehouse): locked"},"TEXT:fte.leader.locked":function(e){return"Locked <a href='#fte/leader/"+i(e,"model->_id")+"'>an FTE (warehouse) entry</a> for <em>"+i(e,"model->shift")+"</em> shift of <em>"+i(e,"model->date")+"</em> for subdivision <em>"+i(e,"model->subdivision")+"</em>."},"TYPE:fte.leader.deleted":function(){return"FTE (warehouse): deleted"},"TEXT:fte.leader.deleted":function(e){return"Deleted an FTE (warehouse) entry for <em>"+i(e,"model->shift")+"</em> shift of <em>"+i(e,"model->date")+"</em> for subdivision <em>"+i(e,"model->subdivision")+"</em>."},"TYPE:fte.master.created":function(){return"FTE (production): added"},"TEXT:fte.master.created":function(e){return"Created <a href='#fte/master/"+i(e,"model->_id")+"'>a new FTE (production) entry</a> for <em>"+i(e,"model->shift")+"</em> shift of <em>"+i(e,"model->date")+"</em> for subdivision <em>"+i(e,"model->subdivision")+"</em>."},"TYPE:fte.master.locked":function(){return"FTE (production): locked"},"TEXT:fte.master.locked":function(e){return"Locked <a href='#fte/master/"+i(e,"model->_id")+"'>an FTE (production) entry</a> for <em>"+i(e,"model->shift")+"</em> shift of <em>"+i(e,"model->date")+"</em> for subdivision <em>"+i(e,"model->subdivision")+"</em>."},"TYPE:fte.master.deleted":function(){return"FTE (production): deleted"},"TEXT:fte.master.deleted":function(e){return"Deleted an FTE (production) entry for <em>"+i(e,"model->shift")+"</em> shift of <em>"+i(e,"model->date")+"</em> for subdivision <em>"+i(e,"model->subdivision")+"</em>."},"TYPE:hourlyPlans.created":function(){return"Hourly plans: added"},"TEXT:hourlyPlans.created":function(e){return"Created <a href='#hourlyPlans/"+i(e,"model->_id")+"'>a new hourly plan</a> for <em>"+i(e,"model->shift")+"</em> shift of <em>"+i(e,"model->date")+"</em> for division <em>"+i(e,"model->division")+"</em>."},"TYPE:hourlyPlans.locked":function(){return"Hourly plans: locked"},"TEXT:hourlyPlans.locked":function(e){return"Locked <a href='#hourlyPlans/"+i(e,"model->_id")+"'>an hourly plan</a> for <em>"+i(e,"model->shift")+"</em> shift of <em>"+i(e,"model->date")+"</em> for division <em>"+i(e,"model->division")+"</em>."},"TYPE:hourlyPlans.deleted":function(){return"Hourly plans: deleted"},"TEXT:hourlyPlans.deleted":function(e){return"Locked an hourly plan for <em>"+i(e,"model->shift")+"</em> shift of <em>"+i(e,"model->date")+"</em> for division <em>"+i(e,"model->division")+"</em>."},"TYPE:pressWorksheets.added":function(){return"Worksheets: added"},"TEXT:pressWorksheets.added":function(e){return"Added <a href='#pressWorksheets/"+i(e,"model->_id")+"'>a new worksheet</a>."},"TYPE:pressWorksheets.edited":function(){return"Worksheets: edycja"},"TEXT:pressWorksheets.edited":function(e){return"Edited worksheet: <a href='#pressWorksheets/"+i(e,"model->_id")+"'>"+i(e,"model->rid")+"</a>"},"TYPE:pressWorksheets.deleted":function(){return"Worksheets: deleted"},"TEXT:pressWorksheets.deleted":function(e){return"Deleted worksheet: <em>"+i(e,"model->rid")+"</em>"},"TYPE:feedback.added":function(){return"Feedback: added"},"TEXT:feedback.added":function(){return"Added new feedback."}},pl:!0}}),define("app/nls/pl/events",["app/nls/locale/pl"],function(e){var t={locale:{}};t.locale.pl=e;var n=function(e){if(!e)throw new Error("MessageFormat: No data passed to function.")},r=function(e,t,n){if(isNaN(e[t]))throw new Error("MessageFormat: `"+t+"` isnt a number.");return e[t]-(n||0)},i=function(e,t){return n(e),e[t]},o=function(e,r,i,o,a){return n(e),e[r]in a?a[e[r]]:(r=t.locale[o](e[r]-i),r in a?a[r]:a.other)},a=function(e,t,r){return n(e),e[t]in r?r[e[t]]:r.other};return{"MSG:LOADING_FAILURE":function(){return"Ładowanie zdarzeń nie powiodło się :("},"MSG:LOADING_TYPES_FAILURE":function(){return"Ładowanie typów zdarzeń nie powiodło się :("},"BREADCRUMBS:browse":function(){return"Zdarzenia"},"FILTER:DATE:FROM":function(){return"Od"},"FILTER:DATE:TO":function(){return"Do"},"FILTER:PLACEHOLDER:type":function(){return"Dowolny typ"},"FILTER:SYSTEM_USER":function(){return"System"},"FILTER:LIMIT":function(){return"Limit"},"FILTER:BUTTON":function(){return"Filtruj zdarzenia"},"PROPERTY:time":function(){return"Czas wystąpienia"},"PROPERTY:user":function(){return"Użytkownik"},"PROPERTY:type":function(){return"Typ"},"PROPERTY:text":function(){return"Opis"},"PROPERTY:severity":function(){return"Poziom ważności"},"TYPE:app.started":function(){return"Start systemu"},"TEXT:app.started":function(e){return"<em>"+a(e,"id",{frontend:"Serwer aplikacji",controller:"Serwer sterownika",alarms:"Serwer alarmów",other:"Serwer "+i(e,"id")})+"</em> wystartował w środowisku <em>"+a(e,"env",{development:"rozwojowym",production:"produkcyjnym",other:"nieokreślonym"})+"</em> w ciągu <em>"+i(e,"time")+"</em> ms."},"TYPE:users.login":function(){return"Użytkownicy: zalogowanie"},"TEXT:users.login":function(){return"-"},"TYPE:users.loginFailure":function(){return"Użytkownicy: Nieudane logowanie"},"TEXT:users.loginFailure":function(e){return"Nieudane logowanie na konto: <em>"+i(e,"login")+"</em>"},"TYPE:users.logout":function(){return"Użytkownicy: wylogowanie"},"TEXT:users.logout":function(){return"-"},"TYPE:users.added":function(){return"Użytkownicy: dodanie"},"TEXT:users.added":function(e){return"Dodano użytkownika: <a href='#users/"+i(e,"model->_id")+"'>"+i(e,"model->login")+"</a>"},"TYPE:users.edited":function(){return"Użytkownicy: edycja"},"TEXT:users.edited":function(e){return"Zmodyfikowano użytkownika: <a href='#users/"+i(e,"model->_id")+"'>"+i(e,"model->login")+"</a>"},"TYPE:users.deleted":function(){return"Użytkownicy: usunięcie"},"TEXT:users.deleted":function(e){return"Usunięto użytkownika: <em>"+i(e,"model->login")+"</em>"},"TYPE:users.synced":function(){return"Użytkownicy: synchronizacja"},"TEXT:users.synced":function(e){return"Dodano "+o(e,"created",0,"pl",{one:"1 nowego użytkownika",other:r(e,"created")+" nowych użytkowników"})+" i zmodyfikowano "+o(e,"updated",0,"pl",{one:"1 istniejącego użytkownika",other:r(e,"updated")+" istniejących użytkowników"})+" podczas synchronizacji z bazą KD."},"TYPE:users.syncFailed":function(){return"Użytkownicy: błąd synchronizacji"},"TEXT:users.syncFailed":function(e){return"Nie udało się zsynchronizować użytkowników z bazą KD: <em>"+i(e,"error")+"</em>"},"TYPE:mechOrders.edited":function(){return"Zlecenia działu mechanicznego: edycja"},"TEXT:mechOrders.edited":function(e){return"Zmodyfikowano zlecenie działu mechanicznego: <a href='#mechOrders/"+i(e,"model->_id")+"'>"+i(e,"model->_id")+"</a>"},"TYPE:mechOrders.synced":function(){return"Zlecenia działu mechanicznego: import"},"TEXT:mechOrders.synced":function(e){return"Zaimportowano "+o(e,"count",0,"pl",{one:"1 zlecenie",few:r(e,"count")+" zlecenia",other:r(e,"count")+" zleceń"})+" działu mechanicznego."},"TYPE:emptyOrders.synced":function(){return"Puste zlecenia: synchronizacja"},"TEXT:emptyOrders.synced":function(e){return"Dodano "+o(e,"count",0,"pl",{one:"1 nowe puste zlecenie",few:r(e,"count")+" nowe puste zlecenia",other:r(e,"count")+" nowych pustych zleceń"})+"."},"TYPE:orders.synced":function(){return"Zlecenia reszty działów: synchronizacja"},"TEXT:orders.synced":function(e){return"Dodano "+o(e,"created",0,"pl",{one:"1 nowe",few:r(e,"created")+" nowe",other:r(e,"created")+" nowych"})+" i zmodyfikowano "+o(e,"updated",0,"pl",{one:"1 istniejące zlecenie",few:r(e,"updated")+" istniejące zlecenia",other:r(e,"updated")+" istniejących zleceń"})+a(e,"moduleName",{currentDayOrderImporter:"&nbsp;z aktualnego dnia",nextDayOrderImporter:"&nbsp;z następnego dnia",prevDayOrderImporter:"&nbsp;z poprzedniego dnia",other:""})+"."},"TYPE:orderStatuses.added":function(){return"Statusy zleceń: dodanie"},"TEXT:orderStatuses.added":function(e){return"Dodano status zleceń: <a href='#orderStatuses/"+i(e,"model->_id")+"'>"+i(e,"model->_id")+"</a>"},"TYPE:orderStatuses.edited":function(){return"Statusy zleceń: edycja"},"TEXT:orderStatuses.edited":function(e){return"Zmodyfikowano status zleceń: <a href='#orderStatuses/"+i(e,"model->_id")+"'>"+i(e,"model->_id")+"</a>"},"TYPE:orderStatuses.deleted":function(){return"Statusy zleceń: usunięcie"},"TEXT:orderStatuses.deleted":function(e){return"Usunięto status zleceń: <em>"+i(e,"model->_id")+"</em>"},"TYPE:downtimeReasons.added":function(){return"Powody przestojów: dodanie"},"TEXT:downtimeReasons.added":function(e){return"Dodano powód przestojów: <a href='#downtimeReasons/"+i(e,"model->_id")+"'>"+i(e,"model->_id")+"</a>"},"TYPE:downtimeReasons.edited":function(){return"Powody przestojów: edycja"},"TEXT:downtimeReasons.edited":function(e){return"Zmodyfikowano powód przestojów: <a href='#downtimeReasons/"+i(e,"model->_id")+"'>"+i(e,"model->_id")+"</a>"},"TYPE:downtimeReasons.deleted":function(){return"Powody przestojów: usunięcie"},"TEXT:downtimeReasons.deleted":function(e){return"Usunięto powód przestojów: <em>"+i(e,"model->_id")+"</em>"},"TYPE:lossReasons.added":function(){return"Powody strat materiałowych: dodanie"},"TEXT:lossReasons.added":function(e){return"Dodano powód strat materiałowych: <a href='#lossReasons/"+i(e,"model->_id")+"'>"+i(e,"model->_id")+"</a>"},"TYPE:lossReasons.edited":function(){return"Powody strat materiałowych: edycja"},"TEXT:lossReasons.edited":function(e){return"Zmodyfikowano powód strat materiałowych: <a href='#lossReasons/"+i(e,"model->_id")+"'>"+i(e,"model->_id")+"</a>"},"TYPE:lossReasons.deleted":function(){return"Powody strat materiałowych: usunięcie"},"TEXT:lossReasons.deleted":function(e){return"Usunięto powód strat materiałowych: <em>"+i(e,"model->_id")+"</em>"},"TYPE:aors.added":function(){return"Obszary odpowiedzialności: dodanie"},"TEXT:aors.added":function(e){return"Dodano obszar odpowiedzialności: <a href='#aors/"+i(e,"model->_id")+"'>"+i(e,"model->name")+"</a>"},"TYPE:aors.edited":function(){return"Obszary odpowiedzialności: edycja"},"TEXT:aors.edited":function(e){return"Zmodyfikowano obszar odpowiedzialności: <a href='#aors/"+i(e,"model->_id")+"'>"+i(e,"model->name")+"</a>"},"TYPE:aors.deleted":function(){return"Obszary odpowiedzialności: usunięcie"},"TEXT:aors.deleted":function(e){return"Usunięto obszar odpowiedzialności: <em>"+i(e,"model->name")+"</em>"},"TYPE:workCenters.added":function(){return"WorkCentera: dodanie"},"TEXT:workCenters.added":function(e){return"Dodano WorkCenter: <a href='#workCenters/"+i(e,"model->_id")+"'>"+i(e,"model->_id")+"</a>"},"TYPE:workCenters.edited":function(){return"WorkCentera: edycja"},"TEXT:workCenters.edited":function(e){return"Zmodyfikowano WorkCenter: <a href='#workCenters/"+i(e,"model->_id")+"'>"+i(e,"model->_id")+"</a>"},"TYPE:workCenters.deleted":function(){return"WorkCentera: usunięcie"},"TEXT:workCenters.deleted":function(e){return"Usunięto WorkCenter: <em>"+i(e,"model->_id")+"</em>"},"TYPE:divisions.added":function(){return"Wydziały: dodanie"},"TEXT:divisions.added":function(e){return"Dodano wydział: <a href='#divisions/"+i(e,"model->_id")+"'>"+i(e,"model->_id")+"</a>"},"TYPE:divisions.edited":function(){return"Wydziały: edycja"},"TEXT:divisions.edited":function(e){return"Zmodyfikowano wydział: <a href='#divisions/"+i(e,"model->_id")+"'>"+i(e,"model->_id")+"</a>"},"TYPE:divisions.deleted":function(){return"Wydziały: usunięcie"},"TEXT:divisions.deleted":function(e){return"Usunięto wydział: <em>"+i(e,"model->_id")+"</em>"},"TYPE:subdivisions.added":function(){return"Działy: dodanie"},"TEXT:subdivisions.added":function(e){return"Dodano dział: <a href='#subdivisions/"+i(e,"model->_id")+"'>"+i(e,"model->name")+"</a>"},"TYPE:subdivisions.edited":function(){return"Działy: edycja"},"TEXT:subdivisions.edited":function(e){return"Zmodyfikowano dział: <a href='#subdivisions/"+i(e,"model->_id")+"'>"+i(e,"model->name")+"</a>"},"TYPE:subdivisions.deleted":function(){return"Działy: usunięcie"},"TEXT:subdivisions.deleted":function(e){return"Usunięto dział: <em>"+i(e,"model->name")+"</em>"},"TYPE:companies.added":function(){return"Firmy: dodanie"},"TEXT:companies.added":function(e){return"Dodano firmę: <a href='#companies/"+i(e,"model->_id")+"'>"+i(e,"model->name")+"</a>"},"TYPE:companies.edited":function(){return"Firmy: edycja"},"TEXT:companies.edited":function(e){return"Zmodyfikowano firmę: <a href='#companies/"+i(e,"model->_id")+"'>"+i(e,"model->name")+"</a>"},"TYPE:companies.deleted":function(){return"Firmy: usunięcie"},"TEXT:companies.deleted":function(e){return"Usunięto firmę: <em>"+i(e,"model->name")+"</em>"},"TYPE:mrpControllers.added":function(){return"Kontrolery MRP: dodanie"},"TEXT:mrpControllers.added":function(e){return"Dodano kontroler MRP: <a href='#mrpControllers/"+i(e,"model->_id")+"'>"+i(e,"model->_id")+"</a>"},"TYPE:mrpControllers.edited":function(){return"Kontrolery MRP: edycja"},"TEXT:mrpControllers.edited":function(e){return"Zmodyfikowano kontroler MRP: <a href='#mrpControllers/"+i(e,"model->_id")+"'>"+i(e,"model->_id")+"</a>"},"TYPE:mrpControllers.deleted":function(){return"Kontrolery MRP: usunięcie"},"TEXT:mrpControllers.deleted":function(e){return"Usunięto kontroler MRP: <em>"+i(e,"model->_id")+"</em>"},"TYPE:prodLines.added":function(){return"Linie produkcyjne: dodanie"
},"TEXT:prodLines.added":function(e){return"Dodano linię produkcyjną: <a href='#prodLines/"+i(e,"model->_id")+"'>"+i(e,"model->_id")+"</a>"},"TYPE:prodLines.edited":function(){return"Linie produkcyjne: edycja"},"TEXT:prodLines.edited":function(e){return"Zmodyfikowano linię produkcyjną: <a href='#prodLines/"+i(e,"model->_id")+"'>"+i(e,"model->_id")+"</a>"},"TYPE:prodLines.deleted":function(){return"Linie produkcyjne: usunięcie"},"TEXT:prodLines.deleted":function(e){return"Usunięto linię produkcyjną: <em>"+i(e,"model->_id")+"</em>"},"TYPE:prodTasks.added":function(){return"Zadania produkcyjne: dodanie"},"TEXT:prodTasks.added":function(e){return"Dodano zadanie produkcyjne: <a href='#prodTasks/"+i(e,"model->_id")+"'>"+i(e,"model->name")+"</a>"},"TYPE:prodTasks.edited":function(){return"Zadania produkcyjne: edycja"},"TEXT:prodTasks.edited":function(e){return"Zmodyfikowano zadanie produkcyjne: <a href='#prodTasks/"+i(e,"model->_id")+"'>"+i(e,"model->name")+"</a>"},"TYPE:prodTasks.deleted":function(){return"Zadania produkcyjne: usunięcie"},"TEXT:prodTasks.deleted":function(e){return"Usunięto zadanie produkcyjne: <em>"+i(e,"model->name")+"</em>"},"TYPE:prodFlows.added":function(){return"Przepływy: dodanie"},"TEXT:prodFlows.added":function(e){return"Dodano przepływ: <a href='#prodFlows/"+i(e,"model->_id")+"'>"+i(e,"model->name")+"</a>"},"TYPE:prodFlows.edited":function(){return"Przepływy: edycja"},"TEXT:prodFlows.edited":function(e){return"Zmodyfikowano przepływ: <a href='#prodFlows/"+i(e,"model->_id")+"'>"+i(e,"model->name")+"</a>"},"TYPE:prodFlows.deleted":function(){return"Przepływy: usunięcie"},"TEXT:prodFlows.deleted":function(e){return"Usunięto przepływ: <em>"+i(e,"model->name")+"</em>"},"TYPE:prodFunctions.added":function(){return"Funkcje na produkcji: dodanie"},"TEXT:prodFunctions.added":function(e){return"Dodano funkcję na produkcji: <a href='#prodFunctions/"+i(e,"model->_id")+"'>"+i(e,"model->label")+"</a>"},"TYPE:prodFunctions.edited":function(){return"Funkcje na produkcji: edycja"},"TEXT:prodFunctions.edited":function(e){return"Zmodyfikowano funkcję na produkcji: <a href='#prodFunctions/"+i(e,"model->_id")+"'>"+i(e,"model->label")+"</a>"},"TYPE:prodFunctions.deleted":function(){return"Funkcje na produkcji: usunięcie"},"TEXT:prodFunctions.deleted":function(e){return"Usunięto funkcję na produkcji: <em>"+i(e,"model->label")+"</em>"},"TYPE:fte.leader.created":function(){return"FTE (magazyn): dodanie"},"TEXT:fte.leader.created":function(e){return"Utworzono <a href='#fte/leader/"+i(e,"model->_id")+"'>nowy wpis FTE (magazyn)</a> dla <em>"+i(e,"model->shift")+"</em> zmiany dnia <em>"+i(e,"model->date")+"</em> dla działu <em>"+i(e,"model->subdivision")+"</em>."},"TYPE:fte.leader.locked":function(){return"FTE (magazyn): zamknięcie"},"TEXT:fte.leader.locked":function(e){return"Zamknięto <a href='#fte/leader/"+i(e,"model->_id")+"'>wpis FTE (magazyn)</a> dla <em>"+i(e,"model->shift")+"</em> zmiany dnia <em>"+i(e,"model->date")+"</em> dla działu <em>"+i(e,"model->subdivision")+"</em>."},"TYPE:fte.leader.deleted":function(){return"FTE (magazyn): usunięcie"},"TEXT:fte.leader.deleted":function(e){return"Usunięto wpis FTE (magazyn) dla <em>"+i(e,"model->shift")+"</em> zmiany dnia <em>"+i(e,"model->date")+"</em> dla działu <em>"+i(e,"model->subdivision")+"</em>."},"TYPE:fte.master.created":function(){return"FTE (produkcja): dodanie"},"TEXT:fte.master.created":function(e){return"Utworzono <a href='#fte/master/"+i(e,"model->_id")+"'>nowy wpis FTE (produkcja)</a> dla <em>"+i(e,"model->shift")+"</em> zmiany dnia <em>"+i(e,"model->date")+"</em> dla działu <em>"+i(e,"model->subdivision")+"</em>."},"TYPE:fte.master.locked":function(){return"FTE (produkcja): zamknięcie"},"TEXT:fte.master.locked":function(e){return"Zamknięto <a href='#fte/master/"+i(e,"model->_id")+"'>wpis FTE (produkcja)</a> dla <em>"+i(e,"model->shift")+"</em> zmiany dnia <em>"+i(e,"model->date")+"</em> dla działu <em>"+i(e,"model->subdivision")+"</em>."},"TYPE:fte.master.deleted":function(){return"FTE (produkcja): usunięcie"},"TEXT:fte.master.deleted":function(e){return"Usunięto wpis FTE (produkcja) dla <em>"+i(e,"model->shift")+"</em> zmiany dnia <em>"+i(e,"model->date")+"</em> dla działu <em>"+i(e,"model->subdivision")+"</em>."},"TYPE:hourlyPlans.created":function(){return"Plany godzinowe: dodanie"},"TEXT:hourlyPlans.created":function(e){return"Utworzono <a href='#hourlyPlans/"+i(e,"model->_id")+"'>nowy plan godzinowy</a> dla <em>"+i(e,"model->shift")+"</em> zmiany dnia <em>"+i(e,"model->date")+"</em> dla wydziału <em>"+i(e,"model->division")+"</em>."},"TYPE:hourlyPlans.locked":function(){return"Plany godzinowe: zamknięcie"},"TEXT:hourlyPlans.locked":function(e){return"Zamknięto <a href='#hourlyPlans/"+i(e,"model->_id")+"'>plan godzinowy</a> dla <em>"+i(e,"model->shift")+"</em> zmiany dnia <em>"+i(e,"model->date")+"</em> dla wydziału <em>"+i(e,"model->division")+"</em>."},"TYPE:hourlyPlans.deleted":function(){return"Plany godzinowe: usunięcie"},"TEXT:hourlyPlans.deleted":function(e){return"Usunięto plan godzinowy dla <em>"+i(e,"model->shift")+"</em> zmiany dnia <em>"+i(e,"model->date")+"</em> dla wydziału <em>"+i(e,"model->division")+"</em>."},"TYPE:pressWorksheets.added":function(){return"Karty pracy: dodanie"},"TEXT:pressWorksheets.added":function(e){return"Dodano nową <a href='#pressWorksheets/"+i(e,"model->_id")+"'>kartę pracy</a>."},"TYPE:pressWorksheets.edited":function(){return"Karty pracy: edycja"},"TEXT:pressWorksheets.edited":function(e){return"Zmodyfikowano kartę pracy: <a href='#pressWorksheets/"+i(e,"model->_id")+"'>"+i(e,"model->rid")+"</a>"},"TYPE:pressWorksheets.deleted":function(){return"Karty pracy: usunięcie"},"TEXT:pressWorksheets.deleted":function(e){return"Usunięto kartę pracy: <em>"+i(e,"model->rid")+"</em>"},"TYPE:feedback.added":function(){return"Feedback: dodanie"},"TEXT:feedback.added":function(){return"Dodano nowy feedback."}}}),define("app/events/routes",["../router","../viewport","../user","i18n!app/nls/events"],function(e,t,n){e.map("/events",n.auth("EVENTS:VIEW"),function(e){t.loadPage("app/events/pages/EventListPage",function(t){return new t({rql:e.rql})})})}),define("app/emptyOrders/EmptyOrder",["moment","../core/Model"],function(e,t){return t.extend({urlRoot:"/emptyOrders",clientUrlRoot:"#emptyOrders",topicPrefix:"emptyOrders",privilegePrefix:"ORDERS",nlsDomain:"emptyOrders",labelAttribute:"_id",defaults:{nc12:null,mrp:null,startDate:null,finishDate:null,statuses:null,createdAt:null},toJSON:function(n){n||(n={});var r=t.prototype.toJSON.call(this);return r.startDate&&(r.startDateText=e(r.startDate).format(n.startFinishDateFormat||"LL")),r.finishDate&&(r.finishDateText=e(r.finishDate).format(n.startFinishDateFormat||"LL")),r.createdAt&&(r.createdAtText=e(r.createdAt).format("LLLL")),r}})}),define("app/emptyOrders/EmptyOrderCollection",["../core/Collection","./EmptyOrder"],function(e,t){return e.extend({model:t,rqlQuery:function(e){var t=new Date;return t.setHours(0),t.setMinutes(0),t.setSeconds(0),t.setMilliseconds(0),e.Query.fromObject({fields:{nc12:1,mrp:1,startDate:1,finishDate:1},sort:{startDate:-1,finishDate:-1},limit:15,selector:{name:"and",args:[{name:"eq",args:["startDate",t.getTime()]}]}})}})}),define("app/emptyOrders/views/EmptyOrderListView",["app/i18n","app/core/views/ListView"],function(e,t){return t.extend({remoteTopics:{"emptyOrders.synced":"refreshCollection"},serializeColumns:function(){return[{id:"_id",label:e("emptyOrders","PROPERTY:_id")},{id:"nc12",label:e("emptyOrders","PROPERTY:nc12")},{id:"mrp",label:e("emptyOrders","PROPERTY:mrp")},{id:"startDateText",label:e("emptyOrders","PROPERTY:startDate")},{id:"finishDateText",label:e("emptyOrders","PROPERTY:finishDate")}]},serializeActions:function(){return[]}})}),define("app/emptyOrders/templates/filter",["app/i18n"],function(t){return function anonymous(locals,filters,escape,rethrow){escape=escape||function(e){return String(e).replace(/&(?!#?[a-zA-Z0-9]+;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&#39;").replace(/"/g,"&quot;")};var buf=[];with(locals||{})!function(){buf.push('<div class="well">\n  <form id="',idPrefix,'-form" class="filter-form">\n    <div class="form-group emptyOrders-filter-date-group">\n      <div>\n        <label>\n          <input name="dateType" type="radio" value="start">\n          ',t("emptyOrders","PROPERTY:startDate"),'\n        </label><label\n          class="emptyOrders-filter-date-finish-label">\n          <input name="dateType" type="radio" value="finish">\n          ',t("emptyOrders","PROPERTY:finishDate"),'\n        </label>\n      </div><div class="emptyOrders-filter-date-range">\n        <input id="',idPrefix,'-date" class="form-control" name="date" type="date" placeholder="YYYY-MM-DD">\n      </div>\n    </div><div\n      class="form-group">\n      <label for="',idPrefix,'-limit">',t("emptyOrders","FILTER:LIMIT"),'</label>\n      <input id="',idPrefix,'-limit" class="form-control" name="limit" type="number" value="25" min="5" max="100" step="1">\n    </div><div\n      class="form-group filter-actions">\n      <input type="submit" class="btn btn-primary" value="',escape(t("emptyOrders","FILTER:BUTTON")),'">\n    </div>\n  </form>\n</div>\n')}();return buf.join("")}}),define("app/emptyOrders/views/EmptyOrderFilterView",["underscore","moment","js2form","app/i18n","app/core/View","app/emptyOrders/templates/filter"],function(e,t,n,r,i,o){return i.extend({template:o,events:{"submit .filter-form":function(e){e.preventDefault(),this.changeFilter()}},initialize:function(){this.idPrefix=e.uniqueId("orderFilter")},serialize:function(){return{idPrefix:this.idPrefix}},afterRender:function(){var e=this.serializeRqlQuery();n(this.el.querySelector(".filter-form"),e)},serializeRqlQuery:function(){var e=this.model.rqlQuery,n={dateType:"start",date:"",limit:e.limit<5?5:e.limit>100?100:e.limit};return e.selector.args.forEach(function(e){var r=e.args[0];switch(r){case"startDate":case"finishDate":n.date=t(e.args[1]).format("YYYY-MM-DD")}}),n},changeFilter:function(){var e=this.model.rqlQuery,n=[],r=t(this.$id("date").val()),i=this.$("[name=dateType]:checked").val()+"Date";r.isValid()&&n.push({name:"eq",args:[i,r.valueOf()]}),e.selector={name:"and",args:n},e.limit=parseInt(this.$id("limit").val(),10)||15,e.skip=0,this.trigger("filterChanged",e)}})}),define("app/emptyOrders/templates/listPage",["app/i18n"],function(t){return function anonymous(locals,filters,escape,rethrow){escape=escape||function(e){return String(e).replace(/&(?!#?[a-zA-Z0-9]+;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&#39;").replace(/"/g,"&quot;")};var buf=[];with(locals||{})!function(){buf.push('<div>\n  <div class="filter-container"></div>\n  <div class="emptyOrders-list-container"></div>\n</div>\n')}();return buf.join("")}}),define("app/emptyOrders/pages/EmptyOrderListPage",["jquery","app/i18n","app/core/util/bindLoadingMessage","app/core/util/pageActions","app/core/View","../EmptyOrderCollection","../views/EmptyOrderListView","../views/EmptyOrderFilterView","app/emptyOrders/templates/listPage"],function(e,t,n,r,i,o,a,s,u){return i.extend({template:u,layoutName:"page",pageId:"emptyOrderList",breadcrumbs:[t.bound("emptyOrders","BREADCRUMBS:browse")],actions:[{className:"emptyOrders-pageAction-print",label:t.bound("emptyOrders","PAGE_ACTION:print"),icon:"print",href:"#emptyOrders;print",privileges:"ORDERS:VIEW"}],initialize:function(){this.defineModels(),this.defineViews(),this.setView(".emptyOrders-list-container",this.listView),this.setView(".filter-container",this.filterView)},destroy:function(){this.layout=null},setUpLayout:function(e){this.layout=e},defineModels:function(){this.collection=n(new o(null,{rqlQuery:this.options.rql}),this)},defineViews:function(){this.filterView=new s({model:{rqlQuery:this.collection.rqlQuery}}),this.listView=new a({collection:this.collection}),this.listenTo(this.filterView,"filterChanged",this.refreshList)},load:function(e){return e(this.collection.fetch({reset:!0}))},refreshList:function(e){this.collection.rqlQuery=e,this.listView.refreshCollection(null,!0);var t=e.toString();this.broker.publish("router.navigate",{url:this.collection.genClientUrl()+"?"+t,trigger:!1,replace:!0}),this.layout&&(this.actions[0].href="#emptyOrders;print?"+t,this.layout.setActions(this.actions,this))}})}),define("app/core/templates/printableList",["app/i18n"],function(t){return function anonymous(locals,filters,escape,rethrow){escape=escape||function(e){return String(e).replace(/&(?!#?[a-zA-Z0-9]+;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&#39;").replace(/"/g,"&quot;")};var buf=[];with(locals||{})!function(){buf.push('<table class="table table-bordered table-condensed ',className,'">\n  <thead>\n    <tr>\n      '),columns.forEach(function(e){buf.push("\n      <th>",e.label,"</th>\n      ")}),buf.push("\n    </tr>\n  </thead>\n  <tbody>\n    "),rows.length||buf.push('\n    <tr>\n      <td colspan="',columns.length+1,'">',t("core","LIST:NO_DATA"),"</td>\n    </tr>\n    "),buf.push("\n    "),rows.forEach(function(e){buf.push('\n    <tr class="list-item ',e.className?e.className:"",'">\n      '),columns.forEach(function(n){buf.push("\n      <td>\n        "),null==e[n.id]?buf.push("\n        <em>",t("core","LIST:NO_DATA:cell"),"</em>\n        "):buf.push("\n        ",e[n.id],"\n        "),buf.push("\n      </td>\n      ")}),buf.push("\n    </tr>\n    ")}),buf.push("\n  </tbody>\n</table>\n")}();return buf.join("")}}),define("app/core/views/PrintableListView",["jquery","app/i18n","app/user","../View","./ActionFormView","./PaginationView","app/core/templates/printableList"],function(e,t,n,r,i,o,a){return r.extend({template:a,serialize:function(){return{className:this.className||"",columns:this.serializeColumns(),rows:this.serializeRows()}},serializeColumns:function(){var e,n=this.collection.getNlsDomain();return e=Array.isArray(this.options.columns)?this.options.columns:Array.isArray(this.columns)?this.columns:[],e.map(function(e){return{id:e,label:t(n,"PROPERTY:"+e)}})},serializeRows:function(){return this.collection.toJSON()},afterRender:function(){this.listenToOnce(this.collection,"reset",this.render)},fitToPrintablePage:function(t){var n=this.$("table"),r=n.find("thead").outerHeight(),i=[[]],o=r;this.$("tbody > tr").each(function(){var n=e(this),a=n.height();o+a>t&&(o=r,i[i.length-1].forEach(function(e){e.detach()}),i.push([])),o+=a,i[i.length-1].push(n)}),n.find("tbody").empty();var a=i.map(function(e){var t=n.clone(),r=t.find("tbody");return e.forEach(function(e){r.append(e.detach())}),t});return n.remove(),a}})}),define("app/emptyOrders/views/EmptyOrderPrintableListView",["app/i18n","app/core/views/PrintableListView"],function(e,t){return t.extend({serializeColumns:function(){return[{id:"_id",label:e("emptyOrders","PROPERTY:_id")},{id:"nc12",label:e("emptyOrders","PROPERTY:nc12")},{id:"mrp",label:e("emptyOrders","PROPERTY:mrp")},{id:"startDateText",label:e("emptyOrders","PROPERTY:startDate")},{id:"finishDateText",label:e("emptyOrders","PROPERTY:finishDate")}]},serializeRows:function(){return this.collection.toJSON({startFinishDateFormat:"YYYY-MM-DD"})}})}),define("app/emptyOrders/pages/EmptyOrderPrintableListPage",["underscore","moment","app/i18n","app/core/util/bindLoadingMessage","app/core/util/pageActions","app/core/View","../EmptyOrderCollection","../views/EmptyOrderPrintableListView"],function(e,t,n,r,i,o,a,s){return o.extend({layoutName:"print",pageId:"emptyOrderPrintableList",hdLeft:function(){var r=e.find(this.collection.rqlQuery.selector.args,function(e){return"eq"===e.name&&("startDate"===e.args[0]||"finishDate"===e.args[0])});return r?n("emptyOrders","PRINT_PAGE:HD:LEFT:"+r.args[0],{date:t(r.args[1]).format("LL")}):n("emptyOrders","PRINT_PAGE:HD:LEFT:all")},breadcrumbs:[n.bound("emptyOrders","BREADCRUMBS:browse")],initialize:function(){this.collection=r(new a(null,{rqlQuery:this.options.rql}),this),this.collection.rqlQuery.limit=-1,this.view=new s({collection:this.collection})},load:function(e){return e(this.collection.fetch({reset:!0}))}})}),define("app/nls/emptyOrders",["app/nls/locale/en"],function(e){var t={locale:{}};t.locale.en=e;var n=function(e){if(!e)throw new Error("MessageFormat: No data passed to function.")},r=function(e,t){return n(e),e[t]};return{root:{"BREADCRUMBS:browse":function(){return"Empty orders"},"MSG:LOADING_FAILURE":function(){return"Failed to load the empty orders :("},"PAGE_ACTION:print":function(){return"Show printable version"},"PRINT_PAGE:HD:LEFT:all":function(){return"All orders without any operations"},"PRINT_PAGE:HD:LEFT:startDate":function(e){return"Orders without any operations starting at "+r(e,"date")},"PRINT_PAGE:HD:LEFT:finishDate":function(e){return"Orders without any operations finishing at "+r(e,"date")},"PRINT_PAGE:FT:PAGE_NO":function(){return"Page <span class=print-page-no>?</span> of <span class=print-page-count>?</span>"},"PRINT_PAGE:FT:INFO":function(){return"Printout generated at <span class=print-page-date>?</span> by <span class=print-page-user>?</span>."},"PROPERTY:_id":function(){return"Order no"},"PROPERTY:createdAt":function(){return"Created at"},"PROPERTY:nc12":function(){return"12NC"},"PROPERTY:mrp":function(){return"MRP"},"PROPERTY:startDate":function(){return"Start date"},"PROPERTY:finishDate":function(){return"Finish date"},"PROPERTY:statuses":function(){return"Status"},"FILTER:LIMIT":function(){return"Limit"},"FILTER:BUTTON":function(){return"Filter empty orders"}},pl:!0}}),define("app/nls/pl/emptyOrders",["app/nls/locale/pl"],function(e){var t={locale:{}};t.locale.pl=e;var n=function(e){if(!e)throw new Error("MessageFormat: No data passed to function.")},r=function(e,t){return n(e),e[t]};return{"BREADCRUMBS:browse":function(){return"Puste zlecenia"},"MSG:LOADING_FAILURE":function(){return"Ładowanie pustych zleceń nie powiodło się :("},"PAGE_ACTION:print":function(){return"Pokaż wersję do druku"},"PRINT_PAGE:HD:LEFT:all":function(){return"Wszystkie zlecenia bez żadnych operacji"},"PRINT_PAGE:HD:LEFT:startDate":function(e){return"Zlecenia bez żadnych operacji rozpoczynające się "+r(e,"date")},"PRINT_PAGE:HD:LEFT:finishDate":function(e){return"Zlecenia bez żadnych operacji kończące się "+r(e,"date")},"PRINT_PAGE:FT:PAGE_NO":function(){return"Strona <span class=print-page-no>?</span> z <span class=print-page-count>?</span>"},"PRINT_PAGE:FT:INFO":function(){return"Wydruk wygenerowany <span class=print-page-date>?</span> przez użytkownika <span class=print-page-user>?</span>."},"PROPERTY:_id":function(){return"Nr zlecenia"},"PROPERTY:createdAt":function(){return"Czas stworzenia"},"PROPERTY:nc12":function(){return"12NC"},"PROPERTY:mrp":function(){return"MRP"},"PROPERTY:startDate":function(){return"Data startu"},"PROPERTY:finishDate":function(){return"Data ukończenia"},"PROPERTY:statuses":function(){return"Status"},"FILTER:LIMIT":function(){return"Limit"},"FILTER:BUTTON":function(){return"Filtruj puste zlecenia"}}}),define("app/emptyOrders/routes",["../router","../viewport","../user","./pages/EmptyOrderListPage","./pages/EmptyOrderPrintableListPage","i18n!app/nls/emptyOrders"],function(e,t,n,r,i){var o=n.auth("ORDERS:VIEW");e.map("/emptyOrders",o,function(e){t.showPage(new r({rql:e.rql}))}),e.map("/emptyOrders;print",o,function(e){t.showPage(new i({rql:e.rql}))})}),define("app/prodFunctions/ProdFunction",["../core/Model"],function(e){return e.extend({urlRoot:"/prodFunctions",clientUrlRoot:"#prodFunctions",topicPrefix:"prodFunctions",privilegePrefix:"DICTIONARIES",nlsDomain:"prodFunctions",labelAttribute:"label",defaults:function(){return{label:"",fteMasterPosition:-1,direct:!1,companies:[]}},toJSON:function(){var t=e.prototype.toJSON.call(this);return t.label||(t.label=t._id),t}})}),define("app/prodFunctions/ProdFunctionCollection",["../core/Collection","./ProdFunction"],function(e,t){return e.extend({model:t,rqlQuery:"sort(fteMasterPosition)"})}),define("app/data/prodFunctions",["app/prodFunctions/ProdFunctionCollection","./createStorage"],function(e,t){return t("PROD_FUNCTIONS","prodFunctions",e)}),define("app/mrpControllers/MrpController",["../core/Model","app/data/subdivisions"],function(e,t){return e.extend({urlRoot:"/mrpControllers",clientUrlRoot:"#mrpControllers",topicPrefix:"mrpControllers",privilegePrefix:"DICTIONARIES",nlsDomain:"mrpControllers",labelAttribute:"_id",defaults:{subdivision:null,description:null},getSubdivision:function(){return t.get(this.get("subdivision"))||null}})}),define("app/mrpControllers/MrpControllerCollection",["../core/Collection","./MrpController"],function(e,t){return e.extend({model:t,rqlQuery:"select(subdivision,description)&sort(_id)"})}),define("app/data/mrpControllers",["app/mrpControllers/MrpControllerCollection","./createStorage"],function(e,t){return t("MRP_CONTROLLERS","mrpControllers",e)}),define("app/prodFlows/ProdFlow",["../core/Model","app/data/mrpControllers"],function(e,t){return e.extend({urlRoot:"/prodFlows",clientUrlRoot:"#prodFlows",topicPrefix:"prodFlows",privilegePrefix:"DICTIONARIES",nlsDomain:"prodFlows",labelAttribute:"name",defaults:{mrpController:null,name:null},parse:function(e){return"string"==typeof e.mrpController?e.mrpController=[e.mrpController]:Array.isArray(e.mrpController)||(e.mrpController=[]),e},getSubdivision:function(){var e=this.get("mrpController");if(!Array.isArray(e)||!e.length)return null;var n=t.get(e[0]);return n?n.getSubdivision():null}})}),define("app/prodFlows/ProdFlowCollection",["../core/Collection","./ProdFlow"],function(e,t){return e.extend({model:t,rqlQuery:"select(mrpController,name)&sort(name)"})}),define("app/data/prodFlows",["app/prodFlows/ProdFlowCollection","./createStorage"],function(e,t){return t("PROD_FLOWS","prodFlows",e)}),define("app/workCenters/WorkCenter",["../core/Model","app/data/mrpControllers","app/data/prodFlows"],function(e,t,n){return e.extend({urlRoot:"/workCenters",clientUrlRoot:"#workCenters",topicPrefix:"workCenters",privilegePrefix:"DICTIONARIES",nlsDomain:"workCenters",labelAttribute:"_id",defaults:{mrpController:null,prodFlow:null,description:null},getSubdivision:function(){var e;if(this.get("mrpController"))e=t.get(this.get("mrpController"));else{var r=n.get(this.get("prodFlow"));r&&(e=t.get((r.get("mrpController")||[])[0]))}return e?e.getSubdivision():null}})}),define("app/workCenters/WorkCenterCollection",["../core/Collection","./WorkCenter"],function(e,t){return e.extend({model:t,rqlQuery:"select(mrpController,prodFlow,description)&sort(_id)"})}),define("app/data/workCenters",["app/workCenters/WorkCenterCollection","./createStorage"],function(e,t){return t("WORK_CENTERS","workCenters",e)}),define("app/prodLines/ProdLine",["../core/Model","../data/workCenters"],function(e,t){return e.extend({urlRoot:"/prodLines",clientUrlRoot:"#prodLines",topicPrefix:"prodLines",privilegePrefix:"DICTIONARIES",nlsDomain:"prodLines",labelAttribute:"_id",defaults:{workCenter:null,description:null},getSubdivision:function(){var e=t.get(this.get("workCenter"));return e?e.getSubdivision():null}})}),define("app/prodLines/ProdLineCollection",["../user","../core/Collection","./ProdLine"],function(e,t,n){return t.extend({model:n,rqlQuery:"select(workCenter,description)&sort(workCenter,_id)",getForCurrentUser:function(){var t=e.getDivision(),n=e.getSubdivision();return this.filter(function(r){if(e.data.super||!t)return!0;var i=r.getSubdivision();if(!i)return!0;if(n)return i.id===n.id;var o=i.get("division");return o?o===t.id:!0})}})}),define("app/data/prodLines",["app/prodLines/ProdLineCollection","./createStorage"],function(e,t){return t("PROD_LINES","prodLines",e)}),define("app/data/views/renderOrgUnitPath",["underscore","../divisions","../subdivisions","../mrpControllers","../workCenters","../prodFlows","../prodLines"],function(e,t,n,r,i,o,a){return function(s,u,l){if(!s)return null;var c=[];return s.constructor!==a.model||(c.unshift(s),s=i.get(s.get("workCenter")))?s.constructor!==i.model||(c.unshift(s),s=s.get("prodFlow")?o.get(s.get("prodFlow")):r.get(s.get("mrpController")))?s.constructor!==o.model||(c.unshift(s),s=r.get((s.get("mrpController")||[])[0]))?s.constructor!==r.model||(c.unshift(s),s=n.get(s.get("subdivision")))?s.constructor!==n.model||(c.unshift(s),s=t.get(s.get("division")))?(s.constructor===t.model&&c.unshift(s),l!==!1&&c.pop(),0===c.length?null:c.map(function(t){var n=e.escape(t.getLabel());return u?'<a href="'+t.genClientUrl()+'">'+n+"</a>":n}).join(" \\ ")):null:null:null:null:null}}),define("app/fte/util/isEditable",["app/data/subdivisions"],function(e){return function(t,n){if(n.isAllowedTo("PROD_DATA:MANAGE"))return!0;if(!n.isAllowedTo(t.getPrivilegePrefix()+":MANAGE"))return!1;var r=Date.parse(t.get("createdAt"));if(Date.now()>=r+288e5)return!1;var i=n.getDivision();if(!i||n.isAllowedTo(t.getPrivilegePrefix()+":ALL"))return!0;var o=e.get(t.get("subdivision"));if(!o)return!1;var a=o.get("division");if(!a||i.id!==a)return!1;var s=n.getSubdivision();return s?s.id===o.id:!0}}),define("app/fte/FteMasterEntry",["underscore","../i18n","../time","../data/subdivisions","../data/prodFunctions","../data/views/renderOrgUnitPath","../core/Model","./util/isEditable"],function(e,t,n,r,i,o,a,s){return a.extend({urlRoot:"/fte/master",clientUrlRoot:"#fte/master",topicPrefix:"fte.master",privilegePrefix:"FTE:MASTER",nlsDomain:"fte",defaults:{subdivision:null,date:null,shift:null,flows:null,tasks:null,createdAt:null,creator:null,updatedAt:null,updater:null,absentUsers:null},getLabel:function(){return t(this.nlsDomain,"label",{subdivision:this.getSubdivisionPath(),date:n.format(this.get("date"),"LL"),shift:t("core","SHIFT:"+this.get("shift"))})},getSubdivisionPath:function(){var e=r.get(this.get("subdivision"));return e?o(e,!1,!1):"?"},serializeWithTotals:function(){var e={},r={};this.get("tasks").length&&this.get("tasks")[0].functions.forEach(function(t){var n=i.get(t.id);r[t.id]={prodFunction:n?n.getLabel():t.id,total:0,companies:{}},t.companies.forEach(function(n){r[t.id].companies[n.id]=0,e[n.id]={name:n.name,total:0}})});var o=this.serializeTasks(e,r),a=0;return Object.keys(e).forEach(function(t){a+=e[t].total}),{subdivision:this.getSubdivisionPath(),date:n.format(this.get("date"),"LL"),shift:t("core","SHIFT:"+this.get("shift")),companyCount:Object.keys(e).length,totalByCompany:e,totalByProdFunction:r,total:a,tasks:o,absentUsers:(this.get("absentUsers")||[]).filter(function(e){return!!e})}},serializeTasks:function(e,t){return this.get("tasks").map(function(n){return n.totalByCompany={},n.functions.forEach(function(r){r.companies.forEach(function(i){"number"!=typeof n.totalByCompany[i.id]&&(n.totalByCompany[i.id]=0),n.totalByCompany[i.id]+=i.count,e&&(e[i.id].total+=i.count),t&&(t[r.id].total+=i.count,t[r.id].companies[i.id]+=i.count)})}),n})},isEditable:function(e){return s(this,e)},handleUpdateMessage:function(e,t){"count"===e.type?this.handleCountMessage(e,t):"plan"===e.type?this.handlePlanMessage(e,t):"addAbsentUser"===e.type?this.handleAddAbsentUserMessage(e,t):"removeAbsentUser"===e.type&&this.handleRemoveAbsentUserMessage(e,t)},handleCountMessage:function(e,t){var n=this.get("tasks");if(n){var r=n[e.taskIndex];if(r){var i=r.functions[e.functionIndex];if(i){var o=i.companies[e.companyIndex];o&&(o.count=e.newCount,t||(this.trigger("change:tasks"),this.trigger("change")))}}}},handlePlanMessage:function(t,n){var r=e.find(this.get("tasks"),function(e){return e.id===t.taskId});r&&(r.noPlan=t.newValue,r.noPlan&&r.functions.forEach(function(e){e.companies.forEach(function(e){e.count=0})}),n||(this.trigger("change:tasks"),this.trigger("change")))},handleAddAbsentUserMessage:function(e,t){var n=this.get("absentUsers")||[];n.push(e.user),t||(this.trigger("change:absentUsers"),this.trigger("change"))},handleRemoveAbsentUserMessage:function(e,t){for(var n=this.get("absentUsers")||[],r=-1,i=0,o=n.length;o>i;++i)if(n[i].id===e.userId){r=i;break}-1!==r&&(n.splice(r,1),t||(this.trigger("change:absentUsers"),this.trigger("change")))}})}),define("app/fte/FteLeaderEntry",["../i18n","../time","../data/subdivisions","../data/views/renderOrgUnitPath","../core/Model","./util/isEditable"],function(e,t,n,r,i,o){return i.extend({urlRoot:"/fte/leader",clientUrlRoot:"#fte/leader",topicPrefix:"fte.leader",privilegePrefix:"FTE:LEADER",nlsDomain:"fte",defaults:{subdivision:null,date:null,shift:null,fteDiv:null,tasks:null,createdAt:null,creator:null,updatedAt:null,updater:null},getLabel:function(){return e(this.nlsDomain,"label",{subdivision:this.getSubdivisionPath(),date:t.format(this.get("date"),"LL"),shift:e("core","SHIFT:"+this.get("shift"))})},getSubdivisionPath:function(){var e=n.get(this.get("subdivision"));return e?r(e,!1,!1):"?"},serializeWithTotals:function(){var n=this.serializeCompanies();return{subdivision:this.getSubdivisionPath(),date:t.format(this.get("date"),"LL"),shift:e("core","SHIFT:"+this.get("shift")),total:n.reduce(function(e,t){return e+t.total},0),companies:n,divisions:this.get("fteDiv")||[],tasks:this.serializeTasks()}},serializeCompanies:function(){var e=this.get("tasks");return e.length?e[0].companies.map(function(t,n){return t.total=e.reduce(function(e,t){return Array.isArray(t.companies[n].count)?t.companies[n].count.forEach(function(t){e+=t.value}):e+=t.companies[n].count,e},0),t}):[]},serializeTasks:function(){return this.get("tasks").map(function(e){return e.total=e.companies.reduce(function(e,t){return Array.isArray(t.count)?t.count.forEach(function(t){e+=t.value}):e+=t.count,e},0),e})},isEditable:function(e){return o(this,e)},handleUpdateMessage:function(e,t){var n=this.get("tasks");if(n){var r=n[e.taskIndex];if(r){var i=r.companies[e.companyIndex];if(i){if("number"==typeof e.divisionIndex){var o=i.count[e.divisionIndex];if(!o)return;o.value=e.newCount}else i.count=e.newCount;t||(this.trigger("change:tasks"),this.trigger("change"))}}}}})}),define("app/fte/FteMasterEntryCollection",["app/user","../core/Collection","./FteMasterEntry"],function(e,t,n){return t.extend({model:n,rqlQuery:function(t){var n,r=e.getDivision();return r&&"prod"===r.get("type")&&(n={name:"and",args:[{name:"eq",args:[e.data.orgUnitType,e.data.orgUnitId]}]}),t.Query.fromObject({fields:{subdivision:1,date:1,shift:1,createdAt:1,creator:1},sort:{date:-1},limit:15,selector:n})}})}),define("app/fte/views/FteLeaderEntryListView",["moment","app/i18n","app/user","app/data/subdivisions","app/data/views/renderOrgUnitPath","app/core/views/ListView"],function(e,t,n,r,i,o){return o.extend({remoteTopics:{"fte.leader.created":"refreshCollection","fte.leader.deleted":"onModelDeleted"},serializeColumns:function(){return[{id:"subdivision",label:t("core","ORG_UNIT:subdivision")},{id:"date",label:t(this.collection.getNlsDomain(),"property:date")},{id:"shift",label:t(this.collection.getNlsDomain(),"property:shift")}]},serializeActions:function(){var e=this.collection;return function(r){var i=e.get(r._id),a=[o.actions.viewDetails(i),{icon:"print",label:t("core","LIST:ACTION:print"),href:i.genClientUrl("print")}];return i.isEditable(n)&&a.push(o.actions.edit(i),o.actions.delete(i)),a}},serializeRows:function(){return this.collection.map(function(n){var r=n.toJSON();return r.subdivision=n.getSubdivisionPath(),r.date=e(r.date).format("LL"),r.shift=t("core","SHIFT:"+r.shift),r})}})}),define("app/fte/views/FteMasterEntryListView",["./FteLeaderEntryListView"],function(e){return e.extend({remoteTopics:{"fte.master.created":"refreshCollection","fte.master.deleted":"onModelDeleted"}})}),define("app/data/views/OrgUnitDropdownsView",["underscore","jquery","app/i18n","app/core/View","../divisions","../subdivisions","../mrpControllers","../prodFlows","../workCenters","../prodLines"],function(e,t,n,r,i,o,a,s,u,l){function c(e){return{id:e.id,text:e.getLabel()}}var d={DIVISION:1,SUBDIVISION:2,MRP_CONTROLLER:3,PROD_FLOW:4,WORK_CENTER:5,PROD_LINE:6},p={1:"division",2:"subdivision",3:"mrpController",4:"prodFlow",5:"workCenter",6:"prodLine"},f=function(){return!0};return r.extend({tagName:"div",className:"orgUnitDropdowns",initialize:function(){this.idPrefix=e.uniqueId("orgUnitDropdown")
},destroy:function(){this.$('.select2-offscreen[tabindex="-1"]').select2("destroy")},afterRender:function(){0!==this.$el.children().length&&this.$el.empty(),this.options.noGrid!==!0&&this.$el.addClass("row");var e=this.options.orgUnit||d.DIVISION;e>=d.DIVISION&&this.renderDivisionDropdown(),e>=d.SUBDIVISION&&this.renderSubdivisionDropdown(),e>=d.MRP_CONTROLLER&&this.renderMrpControllerDropdown(),e>=d.PROD_FLOW&&this.renderProdFlowDropdown(),e>=d.WORK_CENTER&&this.renderWorkCenterDropdown(),e>=d.PROD_LINE&&this.renderProdLineDropdown()},focus:function(){return this.$id("division").select2("focus"),this},selectValue:function(e,t){var n=!t;switch(t||this.options.orgUnit){case d.DIVISION:this.selectDivision(e,n);break;case d.SUBDIVISION:this.selectSubdivision(e,n);break;case d.MRP_CONTROLLER:this.selectMrpController(e,n);break;case d.PROD_FLOW:this.selectProdFlow(e,n);break;case d.WORK_CENTER:this.selectWorkCenter(e,n);break;case d.PROD_LINE:this.selectProdLine(e,n)}return this},selectDivision:function(e,t){return this.selectModel(e,null,i,"division",t)},selectSubdivision:function(e,t){return this.selectModel(e,"selectDivision",o,"subdivision",t)},selectMrpController:function(e,t){return this.selectModel(e,"selectSubdivision",a,"mrpController",t)},selectProdFlow:function(e,t){return e?e.get("prodFlow")?this.selectModel(e,"selectMrpController",s,"prodFlow",t):e.get("mrpController")?(e=this.selectMrpController(e,t),e&&this.$id("prodFlow").select2("val",null),e):null:null},selectWorkCenter:function(e,t){return this.selectModel(e,"selectProdFlow",u,"workCenter",t)},selectProdLine:function(){throw new Error("TODO")},selectModel:function(e,t,n,r,i){if(!e)return null;var o=e.get(r);Array.isArray(o)&&(o=o[0]);var a=n.get(o);return null!==t&&(a=this[t](a,i)),a?(this.$id(r).select2("val",o).trigger({type:"change",val:o,selectFirst:i}),e):null},createDropdownElement:function(e,r){var i=this.idPrefix+"-"+e,o=t('<div class="form-group"><label for="'+i+'">'+n("core","ORG_UNIT:"+e)+'</label><input id="'+i+'" name="'+e+'"></div>');return this.options.noGrid!==!0&&o.addClass("col-lg-"+Math.floor(12/this.options.orgUnit)),o.appendTo(this.el).find("input").select2({data:r||[],placeholder:" ",allowClear:this.options.allowClear||this.options.orgUnit===d.PROD_FLOW,multiple:this.options.multiple&&e===p[this.options.orgUnit]})},onChange:function(e,t,n,r){var i=[];null!==r.val&&(i=t.filter(function(e){var t=e.get(n);return Array.isArray(t)?-1!==t.indexOf(r.val):t===r.val}).map(c));var o={data:i,placeholder:" ",allowClear:!!this.options.allowClear||"mrpController"===n&&this.options.orgUnit===d.PROD_FLOW,multiple:this.options.multiple&&e.attr("name")===p[this.options.orgUnit]};e.select2("val",null),e.select2(o),i.length&&r.selectFirst!==!1&&e.select2("val",i[0].id),e.trigger({type:"change",val:i.length?i[0].id:null})},renderDivisionDropdown:function(){this.createDropdownElement("division",i.filter(this.options.divisionFilter||f).map(c))},renderSubdivisionDropdown:function(){var e=this.createDropdownElement("subdivision");this.$id("division").on("change",this.onChange.bind(this,e,o,"division"))},renderMrpControllerDropdown:function(){var e=this.createDropdownElement("mrpController");this.$id("subdivision").on("change",this.onChange.bind(this,e,a,"subdivision"))},renderProdFlowDropdown:function(){var e=this.createDropdownElement("prodFlow");this.$id("mrpController").on("change",this.onChange.bind(this,e,s,"mrpController"))},renderWorkCenterDropdown:function(){var e=this.createDropdownElement("workCenter");this.$id("prodFlow").on("change",this.onChange.bind(this,e,u,"prodFlow"))},renderProdLineDropdown:function(){var e=this.createDropdownElement("prodLine");this.$id("workCenter").on("change",this.onChange.bind(this,e,l,"prodLine"))}},{ORG_UNIT:d})}),define("app/fte/templates/filter",["app/i18n"],function(t){return function anonymous(locals,filters,escape,rethrow){escape=escape||function(e){return String(e).replace(/&(?!#?[a-zA-Z0-9]+;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&#39;").replace(/"/g,"&quot;")};var buf=[];with(locals||{})!function(){buf.push('<div class="well">\n  <form id="',idPrefix,'-form" class="filter-form">\n    <div class="orgUnitDropdowns-container"></div><div\n      class="form-group">\n      <label for="',idPrefix,'-date">',t("fte","FILTER:DATE"),'</label>\n      <input id="',idPrefix,'-date" class="form-control" name="date" type="date">\n    </div><div\n      class="form-group">\n      <label for="',idPrefix,'-shift-any">',t("fte","FILTER:SHIFT"),'</label>\n      <div class="filter-radio-group">\n        <label class="radio-inline">\n          <input id="',idPrefix,'-shift-any" name="shift" type="radio" value="0">\n          ',t("core","SHIFT:ANY"),'\n        </label>\n        <label class="radio-inline">\n          <input name="shift" type="radio" value="1">\n          ',t("core","SHIFT:1"),'\n        </label>\n        <label class="radio-inline">\n          <input name="shift" type="radio" value="2">\n          ',t("core","SHIFT:2"),'\n        </label>\n        <label class="radio-inline">\n          <input name="shift" type="radio" value="3">\n          ',t("core","SHIFT:3"),'\n        </label>\n      </div>\n    </div><div\n      class="form-group">\n      <label for="',idPrefix,'-limit">',t("fte","FILTER:LIMIT"),'</label>\n      <input id="',idPrefix,'-limit" class="form-control" name="limit" type="number" value="25" min="5" max="100" step="1">\n    </div><div\n      class="form-group filter-actions">\n      <input type="submit" class="btn btn-primary" value="',escape(t("fte","FILTER:BUTTON")),'">\n    </div>\n  </form>\n</div>\n')}();return buf.join("")}}),define("app/fte/views/FteEntryFilterView",["underscore","js2form","app/i18n","app/user","app/time","app/data/divisions","app/data/subdivisions","app/data/views/OrgUnitDropdownsView","app/core/Model","app/core/View","app/fte/templates/filter"],function(e,t,n,r,i,o,a,s,u,l,c){var d=s.ORG_UNIT;return l.extend({template:c,events:{"submit .filter-form":function(e){e.preventDefault(),this.changeFilter()}},initialize:function(){this.idPrefix=e.uniqueId("fteFilter"),this.orgUnitDropdownsView=new s({orgUnit:this.options.divisionOnly?d.DIVISION:d.SUBDIVISION,divisionFilter:this.options.divisionFilter||null,allowClear:!0,noGrid:!0}),this.setView(".orgUnitDropdowns-container",this.orgUnitDropdownsView)},serialize:function(){return{idPrefix:this.idPrefix}},afterRender:function(){var e=this.serializeRqlQuery();t(this.el.querySelector(".filter-form"),e),this.listenToOnce(this.orgUnitDropdownsView,"afterRender",function(){var t=null,n=null;""!==e.subdivision?(n=d.SUBDIVISION,t=new u({subdivision:e.subdivision})):""!==e.division&&(n=d.DIVISION,t=new u({division:e.division})),this.orgUnitDropdownsView.selectValue(t,n)})},serializeRqlQuery:function(){var e=this.model.rqlQuery,t={division:"",subdivision:"",date:"",shift:0,limit:e.limit<5?5:e.limit>100?100:e.limit},n=this;return e.selector.args.forEach(function(e){if("eq"===e.name||"in"===e.name){var r=e.args[0];switch(r){case"division":case"subdivision":t[r]=e.args[1],("division"===r?o:a).get(t[r])||(t[r]="");break;case"date":if("in"===e.name)t.date=i.format(e.args[1][0],"YYYY-MM-DD");else{var s=i.getMoment(e.args[1]);t.date=s.format("YYYY-MM-DD"),t.shift=n.getShiftNoFromMoment(s)}break;case"shift":t.shift=e.args[1]}}}),t},changeFilter:function(){var t=this.model.rqlQuery,n=[],r=this.orgUnitDropdownsView.$id("division").val(),o=this.orgUnitDropdownsView.$id("subdivision").val(),a=i.getMoment(this.$id("date").val()),s=parseInt(this.$("input[name=shift]:checked").val(),10);if(this.setHoursByShiftNo(a,s),e.isEmpty(o)?e.isEmpty(r)||n.push({name:"eq",args:["division",r]}):n.push({name:"eq",args:["subdivision",o]}),a.isValid())if(0===s){var u=a.valueOf();n.push({name:"in",args:["date",[u+216e5,u+504e5,u+792e5]]})}else n.push({name:"eq",args:["date",a.valueOf()]});else 0!==s&&n.push({name:"eq",args:["shift",s]});t.selector={name:"and",args:n},t.limit=parseInt(this.$id("limit").val(),10)||15,t.skip=0,this.trigger("filterChanged",t)},getShiftNoFromMoment:function(e){var t=e.hours();return 6===t?1:14===t?2:22===t?3:0},setHoursByShiftNo:function(e,t){e.hours(1===t?6:2===t?14:3===t?22:0)}})}),define("app/fte/templates/listPage",["app/i18n"],function(t){return function anonymous(locals,filters,escape,rethrow){escape=escape||function(e){return String(e).replace(/&(?!#?[a-zA-Z0-9]+;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&#39;").replace(/"/g,"&quot;")};var buf=[];with(locals||{})!function(){buf.push('<div>\n  <div class="filter-container"></div>\n  <div class="fte-list-container"></div>\n</div>\n')}();return buf.join("")}}),define("app/fte/pages/FteMasterEntryListPage",["app/i18n","app/core/util/bindLoadingMessage","app/core/util/pageActions","app/core/View","../FteMasterEntryCollection","../views/FteMasterEntryListView","../views/FteEntryFilterView","app/fte/templates/listPage"],function(e,t,n,r,i,o,a,s){return r.extend({template:s,layoutName:"page",pageId:"fteMasterEntryList",breadcrumbs:[e.bound("fte","BREADCRUMBS:master:browse")],actions:function(t){return[{label:e.bound("fte","PAGE_ACTION:add"),href:"#fte/master;add",icon:"plus",privileges:"FTE:MASTER:MANAGE|PROD_DATA:MANAGE"},n.export(t,this,this.collection)]},initialize:function(){this.defineModels(),this.defineViews(),this.setView(".filter-container",this.filterView),this.setView(".fte-list-container",this.listView)},defineModels:function(){this.collection=t(new i(null,{rqlQuery:this.options.rql}),this)},defineViews:function(){this.filterView=new a({model:{rqlQuery:this.collection.rqlQuery},divisionFilter:function(e){return"prod"===e.get("type")}}),this.listView=new o({collection:this.collection}),this.listenTo(this.filterView,"filterChanged",this.refreshList)},load:function(e){return e(this.collection.fetch({reset:!0}))},refreshList:function(e){this.collection.rqlQuery=e,this.listView.refreshCollection(null,!0);var t=e.toString();this.broker.publish("router.navigate",{url:this.collection.genClientUrl()+"?"+t,trigger:!1,replace:!0})}})}),define("app/core/util/getShiftStartInfo",["app/time"],function(e){return function(t){var n=e.getMoment(t),r=n.hour(),i=-1;return r>=6&&14>r?(n.hours(6),i=1):r>=14&&22>r?(n.hours(14),i=2):(n.hours(22),6>r&&n.subtract("days",1),i=3),{moment:n.minutes(0).seconds(0).milliseconds(0),shift:i}}}),define("app/fte/templates/addForm",["app/i18n"],function(t){return function anonymous(locals,filters,escape,rethrow){escape=escape||function(e){return String(e).replace(/&(?!#?[a-zA-Z0-9]+;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&#39;").replace(/"/g,"&quot;")};var buf=[];with(locals||{})!function(){buf.push('<form class="panel panel-primary">\n  <div class="panel-heading">\n    ',t("fte","addForm:panel:title"),'\n  </div>\n  <div class="panel-body">\n    <div class="form-group orgUnitDropdowns-container"></div>\n    <div class="form-group">\n      <label for="',idPrefix,'-date" class="control-label">',t("fte","property:date"),'</label>\n      <input id="',idPrefix,'-date" class="form-control" type="date" value="',date,'" max="',date,'" min="2013-12-01" required>\n    </div>\n    <div class="form-group">\n      <label for="',idPrefix,'-shift-any">',t("fte","property:shift"),'</label>\n      <div class="filter-radio-group">\n        '),[1,2,3].forEach(function(e){buf.push('\n        <label class="radio-inline">\n          <input name="shift" type="radio" value="',e,'" ',shift===e?"checked":"","> ",t("core","SHIFT:"+e),"\n        </label>\n        ")}),buf.push('\n      </div>\n    </div>\n  </div>\n  <div class="panel-footer">\n    <button class="btn btn-primary">\n      <i class="fa fa-plus"></i>\n      <span>',escape(t("fte","addForm:submit")),"</span>\n    </button>\n  </div>\n</form>\n")}();return buf.join("")}}),define("app/fte/views/FteEntryAddFormView",["app/i18n","app/viewport","app/user","app/data/divisions","app/data/subdivisions","app/data/views/OrgUnitDropdownsView","app/core/Model","app/core/View","app/core/util/getShiftStartInfo","app/fte/templates/addForm"],function(e,t,n,r,i,o,a,s,u,l){var c=o.ORG_UNIT;return s.extend({template:l,idPrefix:"addFteEntryForm",events:{submit:"submitForm"},initialize:function(){this.readonlyDivision=!1,this.$submit=null,this.oudView=new o({orgUnit:c.SUBDIVISION,divisionFilter:this.options.divisionFilter,allowClear:!0,noGrid:!0}),this.setView(".orgUnitDropdowns-container",this.oudView)},destroy:function(){null!==this.$submit&&(this.$submit.remove(),this.$submit=null)},serialize:function(){var e=u(new Date);return{idPrefix:this.idPrefix,date:e.moment.format("YYYY-MM-DD"),shift:e.shift}},afterRender:function(){var e=this,t=n.getDivision(),r=n.getSubdivision();this.$submit=this.$(".btn-primary").attr("disabled",!0),this.listenToOnce(this.oudView,"afterRender",function(){e.oudView.$id("subdivision").on("change",function(t){e.$submit.attr("disabled",""===t.val||null===t.val)});var i=null,o=null;null!==r?(o=c.SUBDIVISION,i=new a({subdivision:r.id})):null!==t&&(o=c.DIVISION,i=new a({division:t.id})),e.oudView.selectValue(i,o),e.readonlyDivision=!n.isAllowedTo(e.model.getPrivilegePrefix()+":ALL")&&t,e.oudView.$id("division").select2("readonly",e.readonlyDivision),e.oudView.$id(e.readonlyDivision?"subdivision":"division").select2("focus"),e.readonlyDivision&&!e.options.divisionFilter(t)&&e.oudView.$id("subdivision").select2("readonly",!0)})},submitForm:function(n){if(n.preventDefault(),!this.socket.isConnected())return t.msg.show({type:"error",time:5e3,text:e("fte","addForm:msg:offline")});var r=this,i=this.oudView.$id("division"),o=this.oudView.$id("subdivision"),a=this.$submit.find("i").removeClass("fa-edit").addClass("fa-spinner fa-spin");i.select2("readonly",!0),o.select2("readonly",!0),this.$submit.attr("disabled",!0);var s=this.model.getTopicPrefix()+".findOrCreate",u={subdivision:o.select2("val"),date:new Date(this.$id("date").val()+" 00:00:00"),shift:parseInt(this.$("input[name=shift]:checked").val(),10)};this.socket.emit(s,u,function(n,s){return s&&r.model.set("_id",s),n?"AUTH"===n.message&&s?r.trigger("uneditable",r.model):(a.removeClass("fa-spinner fa-spin").addClass("fa-edit"),i.select2("readonly",r.readonlyDivision),o.select2("readonly",!1),r.$submit.attr("disabled",!1).focus(),t.msg.show({type:"error",time:5e3,text:e("fte","addForm:msg:failure",{error:n.message})})):void r.trigger("editable",r.model)})}})}),define("app/fte/pages/FteMasterEntryAddFormPage",["app/i18n","app/core/View","../FteMasterEntry","../views/FteEntryAddFormView"],function(e,t,n,r){return t.extend({layoutName:"page",pageId:"fteMasterEntryAddForm",breadcrumbs:[{label:e.bound("fte","BREADCRUMBS:master:browse"),href:"#fte/master"},e.bound("fte","BREADCRUMBS:addForm")],initialize:function(){this.view=new r({model:new n,divisionFilter:function(e){return e&&"prod"===e.get("type")}}),this.listenTo(this.view,"editable",function(e){this.broker.publish("router.navigate",{url:e.genClientUrl("edit"),trigger:!0})}),this.listenTo(this.view,"uneditable",function(e){this.broker.publish("router.navigate",{url:e.genClientUrl(),trigger:!0})})}})}),define("app/users/util/setUpUserSelect2",["underscore","app/i18n","app/user"],function(e,t,n){return function(r,i){return r.select2(e.extend({openOnEnter:null,allowClear:!0,minimumInputLength:3,placeholder:t("users","select2:placeholder"),ajax:{cache:!0,quietMillis:300,url:function(e){e=e.trim();var t=/^[0-9]+$/.test(e)?"personellId":"lastName";return e=encodeURIComponent("^"+e),"/users?select(personellId,lastName,firstName,login)&sort("+t+")&limit(20)&regex("+t+","+e+",i)"},results:function(e,r){var o=n.getRootUserData(),a=[{id:"$SYSTEM",text:t("users","select2:users:system"),name:t("users","select2:users:system"),login:null},{id:o._id,text:o.name||o.login,name:o.name||o.login,login:o.login,personellId:"-"}].filter(function(e){return-1!==e.text.indexOf(r.term)}),s=a.concat(e.collection||[]);return i&&i.userFilter&&(s=s.filter(i.userFilter)),{results:s.map(function(e){var t=e.lastName&&e.firstName?e.lastName+" "+e.firstName:"-",n=e.personellId?e.personellId:"-";return{id:e._id,text:t+" ("+n+")",name:t,login:e.login,personellId:n}}).sort(function(e,t){return e.text.localeCompare(t.text)})}}}},i))}}),define("app/fte/templates/masterEntry",["app/i18n"],function(t){return function anonymous(locals,filters,escape,rethrow){escape=escape||function(e){return String(e).replace(/&(?!#?[a-zA-Z0-9]+;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&#39;").replace(/"/g,"&quot;")};var buf=[];with(locals||{})!function(){buf.push('<div>\n  <div class="well">\n    <div class="fte-property">\n      <span class="fte-property-name">',t("core","ORG_UNIT:subdivision"),'</span>\n      <span class="fte-property-value">',subdivision,'</span>\n    </div>\n    <div class="fte-property">\n      <span class="fte-property-name">',t("fte","property:date"),'</span>\n      <span class="fte-property-value">',date,'</span>\n    </div>\n    <div class="fte-property">\n      <span class="fte-property-name">',t("fte","property:shift"),'</span>\n      <span class="fte-property-value">',shift,'</span>\n    </div>\n  </div>\n  <div class="panel panel-primary">\n    <div class="panel-heading">',t("fte","masterEntry:tasksPanel:title"+(editable?":editable":"")),"</div>\n    "),editable&&buf.push('\n    <div class="message message-inline message-info">',t("fte","panel:info"),"</div>\n    "),buf.push('\n    <table class="table table-bordered table-condensed table-hover fte-masterEntry">\n      <thead>\n      <tr>\n        <th class="fte-masterEntry-column-task" rowspan="4">',t("fte","masterEntry:column:task"),'\n        <th class="fte-masterEntry-column-noPlan even" rowspan="4">',t("fte","masterEntry:column:noPlan"),'\n        <th colspan="2">',t("fte","masterEntry:column:total"),"</th>\n        "),Object.keys(totalByProdFunction).forEach(function(e,t){buf.push('\n        <th class="fte-masterEntry-column-prodFunction ',t%2?"":"even",'" colspan="',Object.keys(totalByProdFunction[e].companies).length,'" data-column="',t,'">',totalByProdFunction[e].prodFunction,"</th>\n        ")}),buf.push('\n      </tr>\n      <tr>\n        <th colspan="',companyCount,'" class="fte-masterEntry-total">',round(total),"\n        "),Object.keys(totalByProdFunction).forEach(function(e,t){buf.push('\n        <th class="fte-masterEntry-total-prodFunction ',t%2?"":"even",'" colspan="',Object.keys(totalByProdFunction[e].companies).length,'" class="fte-masterEntry-total-prodFunction" data-column="',t,'" data-functionId="',e,'">',round(totalByProdFunction[e].total),"\n        ")}),buf.push("\n      </tr>\n      <tr>\n        "),Object.keys(totalByCompany).forEach(function(e){buf.push('\n        <th class="fte-masterEntry-column-company" >',totalByCompany[e].name,"\n        ")}),buf.push("\n        "),Object.keys(totalByProdFunction).forEach(function(e,t){buf.push("\n        "),Object.keys(totalByProdFunction[e].companies).forEach(function(e,n){buf.push('\n        <th class="fte-masterEntry-column-company ',t%2?"":"even",'" data-column="',t,":",n,'">',escape(totalByCompany[e].name),"\n        ")}),buf.push("\n        ")}),buf.push("\n      </tr>\n      <tr>\n        "),Object.keys(totalByCompany).forEach(function(e){buf.push('\n        <th class="fte-masterEntry-total-company" data-companyId="',e,'">',round(totalByCompany[e].total),"\n        ")}),buf.push("\n        "),Object.keys(totalByProdFunction).forEach(function(e,t){buf.push("\n        "),Object.keys(totalByProdFunction[e].companies).forEach(function(n,r){buf.push('\n        <th class="fte-masterEntry-total-prodFunction-company ',t%2?"":"even",'" data-functionId="',e,'" data-companyId="',n,'" data-column="',t,":",r,'">',round(totalByProdFunction[e].companies[n]),"\n        ")}),buf.push("\n        ")}),buf.push("\n      </tr>\n      </thead>\n      <tbody>\n      "),tasks.forEach(function(e,t){buf.push('\n      <tr>\n        <td class="fte-masterEntry-cell-task">\n          '),"prodFlow"===e.type?buf.push("\n          ",escape(e.name),"\n          "):buf.push("\n          <em>",escape(e.name),"</em>\n          "),buf.push('\n        <td class="even '),editable&&buf.push("fte-masterEntry-noPlan-container"),buf.push('">\n          '),editable?buf.push('\n          <input class="fte-masterEntry-noPlan" type="checkbox" data-taskId="',e.id,'" data-task="',t,'" ',e.noPlan?"checked":"",">\n          "):buf.push('\n          <i class="fa fa-',e.noPlan?"check":"times",'"></i>\n          '),buf.push("\n        </td>\n        "),Object.keys(e.totalByCompany).forEach(function(t,n){buf.push('\n        <td class="fte-masterEntry-total-company-task" data-companyId="',t,'" data-companyIndex="',n,'">',round(e.totalByCompany[t]),"</td>\n        ")}),buf.push("\n        "),e.functions.forEach(function(n,r){buf.push("\n        "),n.companies.forEach(function(i,o){buf.push('\n        <td class="',r%2?"":"even",'">\n          '),editable?buf.push('\n          <input\n            class="form-control no-controls fte-masterEntry-count"\n            type="number"\n            min="0"\n            max="9999"\n            value="',i.count,'"\n            data-value="',i.count,'"\n            data-task="',t,'"\n            data-function="',r,'"\n            data-company="',o,'"\n            data-functionId="',n.id,'"\n            data-companyId="',i.id,'"\n            ',e.noPlan?"disabled":"",">\n          "):buf.push("\n          ",round(i.count),"\n          "),buf.push("\n        </td>\n        ")}),buf.push("\n        ")}),buf.push("\n      </tr>\n      ")}),buf.push('\n      </tbody>\n    </table>\n  </div>\n  <div class="panel panel-primary">\n    <div class="panel-heading">',t("fte","masterEntry:absencePanel:title"+(editable?":editable":"")),"</div>\n    "),editable&&buf.push('\n    <div class="fte-masterEntry-absence-userFinder-container">\n      <input class="fte-masterEntry-absence-userFinder" type="text">\n    </div>\n    '),buf.push('\n    <table class="table table-bordered table-condensed table-hover fte-masterEntry-absence">\n      <thead>\n      <tr>\n        <th>',t("users","PROPERTY:personellId"),"\n        <th>",t("users","PROPERTY:name"),"\n        "),editable&&buf.push('\n        <th class="actions">',t("core","LIST:COLUMN:actions"),"</th>\n        "),buf.push('\n      </tr>\n      </thead>\n      <tbody class="fte-masterEntry-absence-noEntries">\n      <tr>\n        <td colspan="3">',t("core","LIST:NO_DATA"),'\n      <tbody class="fte-masterEntry-absence-entries">\n      '),absentUsers.forEach(function(e){buf.push("\n      ",renderAbsentUserRow({absentUser:e,editable:editable}),"\n      ")}),buf.push("\n    </table>\n  </div>\n</div>\n")}();return buf.join("")}}),define("app/fte/templates/absentUserRow",["app/i18n"],function(t){return function anonymous(locals,filters,escape,rethrow){escape=escape||function(e){return String(e).replace(/&(?!#?[a-zA-Z0-9]+;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&#39;").replace(/"/g,"&quot;")};var buf=[];with(locals||{})!function(){buf.push("<tr>\n  <td>",escape(absentUser.personellId),"\n  <td>",escape(absentUser.name),"\n  "),editable&&buf.push('\n  <td>\n    <button class="btn btn-danger fte-masterEntry-absence-remove" data-userId="',absentUser.id,'">\n      <i class="fa fa-times"></i>\n    </button>\n  '),buf.push("\n")}();return buf.join("")}}),define("app/fte/util/fractions",[],function(){var e="function"==typeof Number.prototype.toLocaleString?"toLocaleString":"toString";return{parse:function(e){var t=parseFloat(e.replace(",",".").replace(/[^0-9\.]+/g,""));return isNaN(t)||0>t?0:t},round:function(t){return(Math.round(1e4*t)/1e4)[e]()}}}),function(e,t){function n(n,a){var s=this;s.$el=e(n),s.el=n,s.id=i++,s.$el.bind("destroyed",e.proxy(s.teardown,s)),s.$clonedHeader=null,s.$originalHeader=null,s.isSticky=!1,s.hasBeenSticky=!1,s.leftOffset=null,s.topOffset=null,s.init=function(){s.options=e.extend({},o,a),s.$el.each(function(){var t=e(this);t.css("padding",0),s.$scrollableArea=e(s.options.scrollableArea),s.$originalHeader=e("thead:first",this),s.$clonedHeader=s.$originalHeader.clone(),t.trigger("clonedHeader."+r,[s.$clonedHeader]),s.$clonedHeader.addClass("tableFloatingHeader"),s.$clonedHeader.css("display","none"),s.$originalHeader.addClass("tableFloatingHeaderOriginal"),s.$originalHeader.after(s.$clonedHeader),s.$printStyle=e('<style type="text/css" media="print">.tableFloatingHeader{display:none !important;}.tableFloatingHeaderOriginal{position:static !important;}</style>'),e("head").append(s.$printStyle)}),s.updateWidth(),s.toggleHeaders(),s.bind()},s.destroy=function(){s.$el.unbind("destroyed",s.teardown),s.teardown()},s.teardown=function(){s.isSticky&&s.$originalHeader.css("position","static"),e.removeData(s.el,"plugin_"+r),s.unbind(),s.$clonedHeader.remove(),s.$originalHeader.removeClass("tableFloatingHeaderOriginal"),s.$originalHeader.css("visibility","visible"),s.$printStyle.remove(),s.el=null,s.$el=null},s.bind=function(){s.$scrollableArea.on("scroll."+r,s.toggleHeaders),s.isWindowScrolling()||(e(t).on("scroll."+r+s.id,s.setPositionValues),e(t).on("resize."+r+s.id,s.toggleHeaders)),s.$scrollableArea.on("resize."+r,s.toggleHeaders),s.$scrollableArea.on("resize."+r,s.updateWidth)},s.unbind=function(){s.$scrollableArea.off("."+r,s.toggleHeaders),s.isWindowScrolling()||(e(t).off("."+r+s.id,s.setPositionValues),e(t).off("."+r+s.id,s.toggleHeaders)),s.$scrollableArea.off("."+r,s.updateWidth),s.$el.off("."+r),s.$el.find("*").off("."+r)},s.toggleHeaders=function(){s.$el&&s.$el.each(function(){var t,n=e(this),r=s.isWindowScrolling()?isNaN(s.options.fixedOffset)?s.options.fixedOffset.outerHeight():s.options.fixedOffset:s.$scrollableArea.offset().top+(isNaN(s.options.fixedOffset)?0:s.options.fixedOffset),i=n.offset(),o=s.$scrollableArea.scrollTop()+r,a=s.$scrollableArea.scrollLeft(),u=s.isWindowScrolling()?o>i.top:r>i.top,l=(s.isWindowScrolling()?o:0)<i.top+n.height()-s.$clonedHeader.height()-(s.isWindowScrolling()?0:r);u&&l?(t=i.left-a+s.options.leftOffset,s.$originalHeader.css({position:"fixed","margin-top":0,left:t,"z-index":1}),s.isSticky=!0,s.leftOffset=t,s.topOffset=r,s.$clonedHeader.css("display",""),s.setPositionValues(),s.updateWidth()):s.isSticky&&(s.$originalHeader.css("position","static"),s.$clonedHeader.css("display","none"),s.isSticky=!1,s.resetWidth(e("td,th",s.$clonedHeader),e("td,th",s.$originalHeader)))})},s.isWindowScrolling=function(){return s.$scrollableArea[0]===t},s.setPositionValues=function(){var n=e(t).scrollTop(),r=e(t).scrollLeft();!s.isSticky||0>n||n+e(t).height()>e(document).height()||0>r||r+e(t).width()>e(document).width()||s.$originalHeader.css({top:s.topOffset-(s.isWindowScrolling()?0:n),left:s.leftOffset-(s.isWindowScrolling()?0:r)})},s.updateWidth=function(){if(s.isSticky){s.$originalHeaderCells||(s.$originalHeaderCells=e("th,td",s.$originalHeader)),s.$clonedHeaderCells||(s.$clonedHeaderCells=e("th,td",s.$clonedHeader));var t=s.getWidth(s.$clonedHeaderCells);s.setWidth(t,s.$clonedHeaderCells,s.$originalHeaderCells),s.$originalHeader.css("width",s.$clonedHeader.width())}},s.getWidth=function(t){var n=[];return t.each(function(t){var r,i=e(this);r="border-box"===i.css("box-sizing")?i.outerWidth():i.width(),n[t]=r}),n},s.setWidth=function(e,t,n){t.each(function(t){var r=e[t];n.eq(t).css({"min-width":r,"max-width":r})})},s.resetWidth=function(t,n){t.each(function(t){var r=e(this);n.eq(t).css({"min-width":r.css("min-width"),"max-width":r.css("max-width")})})},s.updateOptions=function(t){s.options=e.extend({},o,t),s.updateWidth(),s.toggleHeaders()},s.init()}var r="stickyTableHeaders",i=0,o={fixedOffset:0,leftOffset:0,scrollableArea:t};e.fn[r]=function(t){return this.each(function(){var i=e.data(this,"plugin_"+r);i?"string"==typeof t?i[t].apply(i):i.updateOptions(t):"destroy"!==t&&e.data(this,"plugin_"+r,new n(this,t))})}}(jQuery,window),define("jquery.stickytableheaders",function(){}),define("app/fte/views/FteMasterEntryEditFormView",["underscore","jquery","app/i18n","app/core/View","app/core/util/onModelDeleted","app/users/util/setUpUserSelect2","app/fte/templates/masterEntry","app/fte/templates/absentUserRow","../util/fractions","jquery.stickytableheaders"],function(e,t,n,r,i,o,a,s,u){return r.extend({template:a,idPrefix:"masterEntryForm",events:{"change .fte-masterEntry-count":"updateCount","keyup .fte-masterEntry-count":"updateCount","change .fte-masterEntry-noPlan":"updatePlan","click .fte-masterEntry-noPlan-container":function(e){e.target.classList.contains("fte-masterEntry-noPlan-container")&&this.$(e.target).find(".fte-masterEntry-noPlan").click()},"click .fte-masterEntry-absence-remove":"removeAbsentUser","focus .fte-masterEntry-count, .fte-masterEntry-noPlan":function(e){var n=e.target,r=n.parentNode.parentNode,i=n.dataset,o=this.cachedColumns;if(this.focused=[n.parentNode,r.children[0]],n.classList.contains("fte-masterEntry-noPlan"))this.focused.push(this.el.querySelector(".fte-masterEntry-column-noPlan"));else{var a=i.function+":"+i.company;this.focused.push(o.prodFunctions[i.function],o.prodFunctionTotals[i.function],o.companies[a],o.companyTotals[a],r.querySelector('.fte-masterEntry-total-company-task[data-companyindex="'+i.company+'"]'))}t(this.focused).addClass("is-focused")},"blur .fte-masterEntry-count, .fte-masterEntry-noPlan":function(){t(this.focused).removeClass("is-focused")}},remoteTopics:function(){var e={};return e["fte.master.updated."+this.model.id]="onRemoteEdit",e["fte.master.deleted"]="onModelDeleted",e},initialize:function(){this.focused=null,this.cachedColumns={prodFunctions:null,prodFunctionTotals:null,companies:null,companyTotals:null}},destroy:function(){this.$(".fte-masterEntry").stickyTableHeaders("destroy"),this.focused=null,this.cachedColumns=null},beforeRender:function(){this.stopListening(this.model,"change",this.render)},afterRender:function(){this.listenToOnce(this.model,"change",this.render),this.setUpUserFinder(),this.setUpStickyHeaders(),this.cacheColumns(),this.focusFirstEnabledInput()},serialize:function(){return e.extend(this.model.serializeWithTotals(),{editable:!0,renderAbsentUserRow:s,round:u.round})},setUpUserFinder:function(){var e=this,t=this.$(".fte-masterEntry-absence-entries"),n=this.$(".fte-masterEntry-absence-noEntries"),r=o(this.$(".fte-masterEntry-absence-userFinder"),{userFilter:function(e){var n='.fte-masterEntry-absence-remove[data-userId="'+e._id+'"]';return 0===t.find(n).length}});t.children().length?n.hide():t.hide(),r.on("change",function(t){r.select2("val","");var n={type:"addAbsentUser",socketId:e.socket.getId(),_id:e.model.id,user:t.added};e.socket.emit("fte.master.addAbsentUser",n,function(t){t?e.trigger("remoteError",t):e.handleAddAbsentUserChange(n)})})},setUpStickyHeaders:function(){this.$(".fte-masterEntry").stickyTableHeaders({fixedOffset:t(".navbar-fixed-top")})},cacheColumns:function(){function e(e,r){n.find(".fte-masterEntry-"+e).each(function(){t[r][this.dataset.column]=this})}var t={prodFunctions:{},prodFunctionTotals:{},companies:{},companyTotals:{}},n=this.$(".tableFloatingHeaderOriginal");e("column-prodFunction","prodFunctions"),e("total-prodFunction","prodFunctionTotals"),e("column-company","companies"),e("total-prodFunction-company","companyTotals"),this.cachedColumns=t},focusNextInput:function(e){var t=e.closest("td").next("td");if(t.length)return t.find("input").select();var n=e.closest("tr").next();return n.length?void this.focusNextEnabledInput(n):this.focusFirstEnabledInput()},focusFirstEnabledInput:function(){var e=this.el.querySelector(".fte-masterEntry-noPlan:not(:checked)");e&&this.$(e).closest("tr").find(".fte-masterEntry-count").first().select()},focusNextEnabledInput:function(e){return e.length?e.find(".fte-masterEntry-noPlan:checked").length?this.focusNextEnabledInput(e.next()):void e.find(".fte-masterEntry-count").first().select():this.focusFirstEnabledInput()},toggleCountsInRow:function(e,t){var n=this.$(this.el.ownerDocument.activeElement).closest("tr"),r=this.$(".fte-masterEntry > tbody > :last-child"),i=e.closest("tr");
return i.find(".fte-masterEntry-count").attr("disabled",e[0].checked),e[0].checked||t||i.find(".fte-masterEntry-count").first().select(),this.recountAll(i),t?i[0]===n[0]?i[0]===r[0]?this.focusFirstEnabledInput():this.focusNextEnabledInput(i):void 0:i[0]===r[0]?this.focusFirstEnabledInput():this.focusNextEnabledInput(i)},updatePlan:function(e){var t={type:"plan",socketId:this.socket.getId(),_id:this.model.id,taskId:e.target.getAttribute("data-taskId"),taskIndex:parseInt(e.target.getAttribute("data-task"),10),newValue:e.target.checked},n=this.$(e.target),r=this;this.toggleCountsInRow(n),this.socket.emit("fte.master.updatePlan",t,function(t){t&&(e.target.checked=!e.target.checked,r.toggleCountsInRow(n),r.trigger("remoteError",t))})},updateCount:function(e){if(13===e.which)return this.focusNextInput(this.$(e.target));var t=u.parse(e.target.getAttribute("data-value")),n=u.parse(e.target.value);if(t!==n){var r=e.target.getAttribute("data-task")+":"+e.target.getAttribute("data-function")+":"+e.target.getAttribute("data-company");this.timers[r]&&clearTimeout(this.timers[r]),this.timers[r]=setTimeout(this.doUpdateCount.bind(this),250,e.target,r,t,n)}},doUpdateCount:function(e,t,n,r){delete this.timers[t];var i=e.getAttribute("data-remote"),o={type:"count",socketId:this.socket.getId(),_id:this.model.id,newCount:r,taskIndex:parseInt(e.getAttribute("data-task"),10),functionIndex:parseInt(e.getAttribute("data-function"),10),companyIndex:parseInt(e.getAttribute("data-company"),10)};e.setAttribute("data-value",o.newCount),e.setAttribute("data-remote","false");var a=this;this.socket.emit("fte.master.updateCount",o,function(t){t&&("true"!==e.getAttribute("data-remote")&&(e.value=n,e.setAttribute("data-value",n),e.setAttribute("data-remote",i),a.recount(e)),a.trigger("remoteError",t))}),this.recount(e)},recount:function(e){var t,n,r,i=this.$(e).closest("tr"),o=this.$(".tableFloatingHeaderOriginal"),a=e.getAttribute("data-functionId"),s=e.getAttribute("data-companyId");r=0,t='.fte-masterEntry-count[data-companyId="'+s+'"]',n='.fte-masterEntry-total-company-task[data-companyId="'+s+'"]',i.find(t).each(function(){r+=u.parse(this.value)}),i.find(n).text(u.round(r)),r=0,t=".fte-masterEntry-count[data-functionId="+a+"][data-companyId="+s+"]",n=".fte-masterEntry-total-prodFunction-company[data-functionId="+a+"][data-companyId="+s+"]",this.$(t).each(function(){this.disabled||(r+=u.parse(this.value))}),o.find(n).text(u.round(r)),r=0,t='.fte-masterEntry-total-prodFunction-company[data-companyId="'+s+'"]',n='.fte-masterEntry-total-company[data-companyId="'+s+'"]',o.find(t).each(function(){r+=u.parse(this.innerHTML)}),o.find(n).text(u.round(r)),r=0,t='.fte-masterEntry-total-prodFunction-company[data-functionId="'+a+'"]',n='.fte-masterEntry-total-prodFunction[data-functionId="'+a+'"]',o.find(t).each(function(){r+=u.parse(this.innerHTML)}),o.find(n).text(u.round(r)),r=0,t=".fte-masterEntry-total-company",n=".fte-masterEntry-total",o.find(t).each(function(){r+=u.parse(this.innerHTML)}),o.find(n).text(u.round(r))},recountAll:function(e){var t=this;e.find(".fte-masterEntry-count").each(function(){this.value="0",this.setAttribute("data-value","0"),t.recount(this)})},removeAbsentUser:function(e){var t=this.$(e.target).closest("button").attr("disabled",!0),n={type:"removeAbsentUser",socketId:this.socket.getId(),_id:this.model.id,userId:t.attr("data-userId")},r=this;this.socket.emit("fte.master.removeAbsentUser",n,function(e){e?(t.attr("disabled",!1),r.trigger("remoteError",e)):r.handleRemoveAbsentUserChange(n)})},onRemoteEdit:function(e){if(e.socketId!==this.socket.getId())switch(this.model.handleUpdateMessage(e,!0),e.type){case"plan":return this.handlePlanChange(e);case"count":return this.handleCountChange(e);case"addAbsentUser":return this.handleAddAbsentUserChange(e);case"removeAbsentUser":return this.handleRemoveAbsentUserChange(e)}},handleAddAbsentUserChange:function(e){var n=e.user;this.$('.fte-masterEntry-absence-remove[data-userId="'+n.id+'"]').length||(t(s({absentUser:n,editable:!0})).hide().appendTo(this.$(".fte-masterEntry-absence-entries").show()).fadeIn("fast"),this.$(".fte-masterEntry-absence-noEntries").hide())},handleRemoveAbsentUserChange:function(e){var n=this.$('.fte-masterEntry-absence-remove[data-userId="'+e.userId+'"]');if(n.length){var r=this;n.closest("tr").fadeOut(function(){t(this).remove();var e=r.$(".fte-masterEntry-absence-entries");e.length||(e.hide(),r.$(".fte-masterEntry-absence-noEntries").show())})}},handlePlanChange:function(e){var t='.fte-masterEntry-noPlan[data-task="'+e.taskIndex+'"]',n=this.$(t);n.length&&(n.prop("checked",e.newValue),this.toggleCountsInRow(n,!0))},handleCountChange:function(e){var t=".fte-masterEntry-count[data-task="+e.taskIndex+"][data-function="+e.functionIndex+"][data-company="+e.companyIndex+"]",n=this.$(t);n.length&&(n.val(e.newCount),n.attr({"data-value":e.newCount,"data-remote":"true"}),this.recount(n[0],e.taskIndex,e.companyIndex))},onModelDeleted:function(e){i(this.broker,this.model,e)}})}),define("app/fte/pages/FteMasterEntryEditFormPage",["app/i18n","app/core/util/bindLoadingMessage","app/core/View","../FteMasterEntry","../views/FteMasterEntryEditFormView"],function(e,t,n,r,i){return n.extend({layoutName:"page",pageId:"fteMasterEntryForm",breadcrumbs:function(){return[{label:e.bound("fte","BREADCRUMBS:master:browse"),href:this.model.genClientUrl("base")},{label:e.bound("fte","BREADCRUMBS:details"),href:this.model.genClientUrl()},e.bound("fte","BREADCRUMBS:editForm")]},initialize:function(){this.model=t(new r({_id:this.options.modelId}),this),this.view=new i({model:this.model}),this.listenTo(this.view,"remoteError",function(e){"AUTH"===e.message&&this.broker.publish("router.navigate",{url:this.model.genClientUrl(),trigger:!0,replace:!0})})},load:function(e){return e(this.model.fetch())}})}),define("app/fte/views/FteMasterEntryDetailsView",["underscore","app/core/View","app/core/util/onModelDeleted","app/fte/templates/masterEntry","app/fte/templates/absentUserRow","../util/fractions"],function(e,t,n,r,i,o){return t.extend({template:r,idPrefix:"masterEntryDetails",remoteTopics:function(){var e={};return e["fte.master.updated."+this.model.id]="onModelUpdated",e["fte.master.deleted"]="onModelDeleted",e},serialize:function(){return e.extend(this.model.serializeWithTotals(),{editable:!1,renderAbsentUserRow:i,round:o.round})},beforeRender:function(){this.stopListening(this.model,"change",this.render)},afterRender:function(){this.listenToOnce(this.model,"change",this.render);var e=this.$(".fte-masterEntry-absence-entries"),t=this.$(".fte-masterEntry-absence-noEntries");e.children().length?t.hide():e.hide()},onModelUpdated:function(e){this.model.handleUpdateMessage(e)},onModelDeleted:function(e){n(this.broker,this.model,e)}})}),define("app/fte/pages/FteMasterEntryDetailsPage",["app/i18n","app/user","app/core/util/bindLoadingMessage","app/core/util/pageActions","app/core/View","../FteMasterEntry","../views/FteMasterEntryDetailsView"],function(e,t,n,r,i,o,a){return i.extend({layoutName:"page",pageId:"fteMasterEntryDetails",breadcrumbs:[{label:e.bound("fte","BREADCRUMBS:master:browse"),href:"#fte/master"},e.bound("fte","BREADCRUMBS:details")],actions:function(){var n=[{label:e.bound("fte","PAGE_ACTION:print"),icon:"print",href:this.model.genClientUrl("print")}];return this.model.isEditable(t)&&n.push(r.edit(this.model),r.delete(this.model)),n},initialize:function(){this.model=n(new o({_id:this.options.modelId}),this),this.view=new a({model:this.model})},load:function(e){return e(this.model.fetch())}})}),define("app/fte/templates/printableMasterEntryList",["app/i18n"],function(t){return function anonymous(locals,filters,escape,rethrow){escape=escape||function(e){return String(e).replace(/&(?!#?[a-zA-Z0-9]+;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&#39;").replace(/"/g,"&quot;")};var buf=[];with(locals||{})!function(){buf.push('<table class="table table-bordered table-condensed fte-masterEntry fte-masterEntry-print">\n  <thead>\n  <tr>\n    <th class="fte-masterEntry-column-task">',t("fte","masterEntry:column:task"),'\n    <th class="fte-masterEntry-column-noPlan">',t("fte","masterEntry:column:noPlan"),'\n    <th colspan="2">',t("fte","masterEntry:column:total"),"</th>\n    "),Object.keys(totalByProdFunction).forEach(function(e){buf.push('\n    <th colspan="',Object.keys(totalByProdFunction[e].companies).length,'">',totalByProdFunction[e].prodFunction,"</th>\n    ")}),buf.push("\n  <tr>\n    <th>\n    <th>\n    "),Object.keys(totalByCompany).forEach(function(e){buf.push("\n    <th>",totalByCompany[e].name,"\n    ")}),buf.push("\n    "),Object.keys(totalByProdFunction).forEach(function(e){buf.push("\n    "),Object.keys(totalByProdFunction[e].companies).forEach(function(e){buf.push("\n    <th>",escape(totalByCompany[e].name),"\n    ")}),buf.push("\n    ")}),buf.push('\n  </thead>\n  <tbody>\n  <tr>\n    <th>\n    <th>\n    <th colspan="',companyCount,'">',round(total),"\n    "),Object.keys(totalByProdFunction).forEach(function(e){buf.push('\n    <th colspan="',Object.keys(totalByProdFunction[e].companies).length,'">',round(totalByProdFunction[e].total),"\n    ")}),buf.push("\n  <tr>\n    <th>\n    <th>\n    "),Object.keys(totalByCompany).forEach(function(e){buf.push("\n    <th>",round(totalByCompany[e].total),"\n    ")}),buf.push("\n    "),Object.keys(totalByProdFunction).forEach(function(e){buf.push("\n    "),Object.keys(totalByProdFunction[e].companies).forEach(function(t){buf.push("\n    <th>",round(totalByProdFunction[e].companies[t]),"\n    ")}),buf.push("\n    ")}),buf.push("\n  "),tasks.forEach(function(e){buf.push('\n  <tr>\n    <td class="fte-masterEntry-cell-task">\n      '),"prodFlow"===e.type?buf.push("\n      ",escape(e.name),"\n      "):buf.push("\n      <em>",escape(e.name),"</em>\n      "),buf.push('\n    <td><i class="fa fa-',e.noPlan?"check":"times",'"></i>\n    '),Object.keys(e.totalByCompany).forEach(function(t){buf.push("\n    <td>",round(e.totalByCompany[t]),"</td>\n    ")}),buf.push("\n    "),e.functions.forEach(function(e){buf.push("\n    "),e.companies.forEach(function(e){buf.push("\n    <td>",round(e.count),"\n    ")}),buf.push("\n    ")}),buf.push("\n  ")}),buf.push('\n  <tr class="fte-masterEntry-print-absence-separator">\n    <td colspan="999">&nbsp;\n  <tr class="fte-masterEntry-print-absence-header">\n    <th colspan="999">Absencja personalna\n  <tr class="fte-masterEntry-print-absence-columns">\n    <th>',t("users","PROPERTY:personellId"),'\n    <th colspan="999">',t("users","PROPERTY:name"),"\n  "),absentUsers.forEach(function(e){buf.push('\n  <tr class="fte-masterEntry-print-absence-row">\n    <td>',e.personellId,'\n    <td colspan="999">',e.name,"\n  ")}),buf.push("\n</table>\n")}();return buf.join("")}}),define("app/fte/views/FteMasterEntryDetailsPrintableView",["underscore","app/core/views/PrintableListView","app/fte/templates/printableMasterEntryList","../util/fractions"],function(e,t,n,r){return t.extend({template:n,serialize:function(){return e.extend(this.model.serializeWithTotals(),{round:r.round})},afterRender:function(){}})}),define("app/fte/pages/FteMasterEntryDetailsPrintablePage",["moment","app/i18n","app/data/subdivisions","app/data/views/renderOrgUnitPath","app/core/util/bindLoadingMessage","app/core/View","../FteMasterEntry","../views/FteMasterEntryDetailsPrintableView"],function(e,t,n,r,i,o,a,s){return o.extend({layoutName:"print",pageId:"fteMasterEntryDetailsPrintable",hdLeft:function(){var e=n.get(this.model.get("subdivision"));return t("fte","print:hdLeft",{subdivision:e?r(e,!1,!1):"?"})},hdRight:function(){return t("fte","print:hdRight",{date:e(this.model.get("date")).format("YYYY-MM-DD"),shift:t("core","SHIFT:"+this.model.get("shift"))})},initialize:function(){this.model=i(new a({_id:this.options.modelId}),this),this.view=new s({model:this.model})},load:function(e){return e(this.model.fetch())}})}),define("app/fte/FteLeaderEntryCollection",["app/user","../core/Collection","./FteLeaderEntry"],function(e,t,n){return t.extend({model:n,rqlQuery:function(t){var n,r=e.getDivision();return r&&"prod"===r.get("type")&&(n={name:"and",args:[{name:"eq",args:[e.data.orgUnitType,e.data.orgUnitId]}]}),t.Query.fromObject({fields:{subdivision:1,date:1,shift:1,createdAt:1,creator:1},sort:{date:-1},limit:15,selector:n})}})}),define("app/fte/pages/FteLeaderEntryListPage",["app/i18n","app/core/util/bindLoadingMessage","app/core/util/pageActions","app/core/View","../FteLeaderEntryCollection","../views/FteLeaderEntryListView","../views/FteEntryFilterView","app/fte/templates/listPage"],function(e,t,n,r,i,o,a,s){return r.extend({template:s,layoutName:"page",pageId:"fteLeaderEntryList",breadcrumbs:[e.bound("fte","BREADCRUMBS:leader:browse")],actions:function(t){return[{label:e.bound("fte","PAGE_ACTION:add"),href:"#fte/leader;add",icon:"plus",privileges:"FTE:LEADER:MANAGE|PROD_DATA:MANAGE"},n.export(t,this,this.collection)]},initialize:function(){this.defineModels(),this.defineViews(),this.setView(".filter-container",this.filterView),this.setView(".fte-list-container",this.listView)},defineModels:function(){this.collection=t(new i(null,{rqlQuery:this.options.rql}),this)},defineViews:function(){this.filterView=new a({model:{rqlQuery:this.collection.rqlQuery},divisionFilter:function(e){return"dist"===e.get("type")}}),this.listView=new o({collection:this.collection}),this.listenTo(this.filterView,"filterChanged",this.refreshList)},load:function(e){return e(this.collection.fetch({reset:!0}))},refreshList:function(e){this.collection.rqlQuery=e,this.listView.refreshCollection(null,!0);var t=e.toString();this.broker.publish("router.navigate",{url:this.collection.genClientUrl()+"?"+t,trigger:!1,replace:!0})}})}),define("app/fte/pages/FteLeaderEntryAddFormPage",["app/i18n","app/core/View","../FteLeaderEntry","../views/FteEntryAddFormView"],function(e,t,n,r){return t.extend({layoutName:"page",pageId:"fteLeaderEntryAddForm",breadcrumbs:[{label:e.bound("fte","BREADCRUMBS:leader:browse"),href:"#fte/leader"},e.bound("fte","BREADCRUMBS:addForm")],initialize:function(){this.view=new r({model:new n,divisionFilter:function(e){return e&&"dist"===e.get("type")}}),this.listenTo(this.view,"editable",function(e){this.broker.publish("router.navigate",{url:e.genClientUrl("edit"),trigger:!0})}),this.listenTo(this.view,"uneditable",function(e){this.broker.publish("router.navigate",{url:e.genClientUrl(),trigger:!0})})}})}),define("app/fte/templates/leaderEntry",["app/i18n"],function(t){return function anonymous(locals,filters,escape,rethrow){escape=escape||function(e){return String(e).replace(/&(?!#?[a-zA-Z0-9]+;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&#39;").replace(/"/g,"&quot;")};var buf=[];with(locals||{})!function(){buf.push('<div>\n  <div class="well">\n    <div class="fte-property">\n      <span class="fte-property-name">',t("core","ORG_UNIT:subdivision"),'</span>\n      <span class="fte-property-value">',subdivision,'</span>\n    </div>\n    <div class="fte-property">\n      <span class="fte-property-name">',t("fte","property:date"),'</span>\n      <span class="fte-property-value">',date,'</span>\n    </div>\n    <div class="fte-property">\n      <span class="fte-property-name">',t("fte","property:shift"),'</span>\n      <span class="fte-property-value">',shift,'</span>\n    </div>\n  </div>\n  <div class="panel panel-primary">\n    <div class="panel-heading">',t("fte","leaderEntry:panel:title"+(editable?":editable":"")),"</div>\n    "),editable&&buf.push('\n    <div class="message message-inline message-info">',t("fte","panel:info"),"</div>\n    "),buf.push('\n    <table class="table table-bordered table-condensed table-hover fte-leaderEntry">\n      <thead>\n        <tr>\n          <th class="fte-leaderEntry-column-task" rowspan="3">',t("fte","leaderEntry:column:task"),"\n          <th>",t("fte","leaderEntry:column:taskTotal"),"\n          "),companies.forEach(function(e,t){buf.push('\n          <th class="fte-leaderEntry-column-company" colspan="',divisions.length,'" data-column="',t,'">',escape(e.name),"\n          ")}),buf.push('\n        </tr>\n        <tr>\n          <th class="fte-leaderEntry-total-overall" rowspan="2">',round(total),"\n          "),companies.forEach(function(e,t){buf.push('\n          <th class="fte-leaderEntry-total-company" colspan="',divisions.length,'" data-column="',escape(t),'">',round(e.total),"\n          ")}),buf.push("\n        </tr>\n        "),divisions.length&&(buf.push("\n        <tr>\n          "),companies.forEach(function(e,t){buf.push("\n          "),divisions.forEach(function(e,n){buf.push('\n          <th class="fte-leaderEntry-column-division" data-column="',t,":",n,'">',e,"\n          ")}),buf.push("\n          ")}),buf.push("\n        </tr>\n        ")),buf.push("\n      </thead>\n      <tbody>\n        "),tasks.forEach(function(e,t){buf.push("\n        <tr>\n          <td>",escape(e.name),'\n          <td class="fte-leaderEntry-total-task">',round(e.total),"\n          "),e.companies.forEach(function(e,n){buf.push("\n          "),Array.isArray(e.count)?(buf.push("\n          "),e.count.forEach(function(e,r){buf.push("\n          <td ",editable?"":'class="fte-leaderEntry-count"',">\n            "),editable?buf.push('\n            <input\n              class="form-control no-controls fte-leaderEntry-count"\n              type="number"\n              min="0"\n              max="9999"\n              value="',e.value,'"\n              data-value="',e.value,'"\n              data-task="',t,'"\n              data-company="',n,'"\n              data-division="',r,'">\n            '):buf.push("\n            ",round(e.value),"\n            "),buf.push("\n          </td>\n          ")}),buf.push("\n          ")):(buf.push("\n          <td ",editable?"":'class="fte-leaderEntry-count"',' colspan="',divisions.length,'">\n            '),editable?buf.push('\n            <input\n              class="form-control no-controls fte-leaderEntry-count"\n              type="number"\n              min="0"\n              max="9999"\n              value="',e.count,'"\n              data-value="',e.count,'"\n              data-task="',t,'"\n              data-company="',n,'">\n            '):buf.push("\n            ",round(e.count),"\n            "),buf.push("\n          </td>\n          ")),buf.push("\n          ")}),buf.push("\n        </tr>\n        ")}),buf.push("\n      </tbody>\n    </table>\n  </div>\n</div>\n")}();return buf.join("")}}),define("app/fte/views/FteLeaderEntryEditFormView",["underscore","jquery","app/i18n","app/user","app/core/View","app/core/util/onModelDeleted","app/fte/templates/leaderEntry","../util/fractions"],function(e,t,n,r,i,o,a,s){return i.extend({template:a,idPrefix:"leaderEntryForm",events:{"change .fte-leaderEntry-count":"updateCount","keyup .fte-leaderEntry-count":"updateCount","focus .fte-leaderEntry-count":function(e){var n=e.target,r=n.dataset;this.focused=[n.parentNode,n.parentNode.parentNode.children[0],this.theadEl.querySelector('.fte-leaderEntry-column-company[data-column="'+r.company+'"]'),this.theadEl.querySelector('.fte-leaderEntry-total-company[data-column="'+r.company+'"]')],void 0===n.dataset.division?this.focused.push.apply(this.focused,this.theadEl.querySelectorAll('.fte-leaderEntry-column-division[data-column^="'+r.company+'"]')):this.focused.push(this.theadEl.querySelector('.fte-leaderEntry-column-division[data-column="'+r.company+":"+r.division+'"]')),t(this.focused).addClass("is-focused")},"blur .fte-leaderEntry-count":function(){t(this.focused).removeClass("is-focused")}},remoteTopics:function(){var e={};return e["fte.leader.updated."+this.model.id]="onRemoteEdit",e["fte.leader.deleted"]="onModelDeleted",e},initialize:function(){this.focused=null,this.theadEl=null},destroy:function(){this.focused=null,this.theadEl=null},beforeRender:function(){this.stopListening(this.model,"change",this.render)},afterRender:function(){this.listenToOnce(this.model,"change",this.render),this.theadEl=this.el.getElementsByTagName("thead")[0],this.$(".fte-leaderEntry-count").first().select()},serialize:function(){return e.extend(this.model.serializeWithTotals(),{editable:!0,round:s.round})},focusNextInput:function(e){var t=e.closest("td").next("td");if(t.length)return t.find("input").select();var n=e.closest("tr").next();return n.length?n.find(".fte-leaderEntry-count").first().select():void this.el.querySelector(".fte-leaderEntry-count").select()},updateCount:function(e){if(13===e.which)return this.focusNextInput(this.$(e.target));var t=e.target.dataset,n=s.parse(t.value)||0,r=s.parse(e.target.value)||0;if(n!==r){var i=t.task+":"+t.company+":"+t.division;this.timers[i]&&clearTimeout(this.timers[i]),this.timers[i]=setTimeout(this.doUpdateCount.bind(this),250,e.target,i,n,r)}},doUpdateCount:function(e,t,n,r){delete this.timers[t];var i=e.dataset,o=i.remote,a={socketId:this.socket.getId(),_id:this.model.id,newCount:r,taskIndex:parseInt(i.task,10),companyIndex:parseInt(i.company,10)},s=parseInt(i.division,10);isNaN(s)||(a.divisionIndex=s),i.value=a.newCount,i.remote="false";var u=this;this.socket.emit("fte.leader.updateCount",a,function(t){t&&("true"!==i.remote&&(e.value=n,i.value=n,i.remote=o,u.recount(e,a.taskIndex,a.companyIndex),a.newCount=n,u.model.handleUpdateMessage(a,!0)),u.trigger("remoteError",t))}),this.recount(e,a.taskIndex,a.companyIndex),this.model.handleUpdateMessage(a,!0)},recount:function(e,t,n){var r=0,i=0,o=0,a=this.$(e).closest("tr");a.find(".fte-leaderEntry-count").each(function(){r+=s.parse(this.value)||0}),a.find(".fte-leaderEntry-total-task").text(s.round(r)),this.$(".fte-leaderEntry-count[data-company="+n+"]").each(function(){i+=s.parse(this.value)||0}),this.$(".fte-leaderEntry-total-company[data-column="+n+"]").text(s.round(i)),this.$(".fte-leaderEntry-total-company").each(function(){o+=s.parse(this.innerHTML)||0}),this.$(".fte-leaderEntry-total-overall").text(s.round(o))},onRemoteEdit:function(e){if(e.socketId!==this.socket.getId()){var t=".fte-leaderEntry-count[data-company="+e.companyIndex+"][data-task="+e.taskIndex+"]";"number"==typeof e.divisionIndex&&(t+='[data-division="'+e.divisionIndex+'"]');var n=this.$(t);0!==n.length&&(n.val(e.newCount),n.attr({"data-value":e.newCount,"data-remote":"true"}),this.recount(n[0],e.taskIndex,e.companyIndex),this.model.handleUpdateMessage(e,!0))}},onModelDeleted:function(e){o(this.broker,this.model,e)}})}),define("app/fte/pages/FteLeaderEntryEditFormPage",["app/i18n","app/core/util/bindLoadingMessage","app/core/View","../FteLeaderEntry","../views/FteLeaderEntryEditFormView"],function(e,t,n,r,i){return n.extend({layoutName:"page",pageId:"fteLeaderEntryForm",breadcrumbs:function(){return[{label:e.bound("fte","BREADCRUMBS:leader:browse"),href:this.model.genClientUrl("base")},{label:e.bound("fte","BREADCRUMBS:details"),href:this.model.genClientUrl()},e.bound("fte","BREADCRUMBS:editForm")]},initialize:function(){this.model=t(new r({_id:this.options.modelId}),this),this.view=new i({model:this.model}),this.listenTo(this.view,"remoteError",function(e){"AUTH"===e.message&&this.broker.publish("router.navigate",{url:this.model.genClientUrl(),trigger:!0,replace:!0})})},load:function(e){return e(this.model.fetch())}})}),define("app/fte/views/FteLeaderEntryDetailsView",["underscore","app/core/View","app/core/util/onModelDeleted","app/fte/templates/leaderEntry","../util/fractions"],function(e,t,n,r,i){return t.extend({template:r,idPrefix:"leaderEntryDetails",remoteTopics:function(){var e={};return e["fte.leader.updated."+this.model.id]="onModelUpdated",e["fte.leader.deleted"]="onModelDeleted",e},serialize:function(){return e.extend(this.model.serializeWithTotals(),{editable:!1,round:i.round})},beforeRender:function(){this.stopListening(this.model,"change",this.render)},afterRender:function(){this.listenToOnce(this.model,"change",this.render)},onModelUpdated:function(e){this.model.handleUpdateMessage(e)},onModelDeleted:function(e){n(this.broker,this.model,e)}})}),define("app/fte/pages/FteLeaderEntryDetailsPage",["app/i18n","app/user","app/core/util/bindLoadingMessage","app/core/util/pageActions","app/core/View","../FteLeaderEntry","../views/FteLeaderEntryDetailsView"],function(e,t,n,r,i,o,a){return i.extend({layoutName:"page",pageId:"fteLeaderEntryDetails",breadcrumbs:[{label:e.bound("fte","BREADCRUMBS:leader:browse"),href:"#fte/leader"},e.bound("fte","BREADCRUMBS:details")],actions:function(){var n=[{label:e.bound("fte","PAGE_ACTION:print"),icon:"print",href:this.model.genClientUrl("print")}];return this.model.isEditable(t)&&n.push(r.edit(this.model),r.delete(this.model)),n},initialize:function(){this.model=n(new o({_id:this.options.modelId}),this),this.view=new a({model:this.model})},load:function(e){return e(this.model.fetch())}})}),define("app/fte/templates/printableLeaderEntryList",["app/i18n"],function(t){return function anonymous(locals,filters,escape,rethrow){escape=escape||function(e){return String(e).replace(/&(?!#?[a-zA-Z0-9]+;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&#39;").replace(/"/g,"&quot;")};var buf=[];with(locals||{})!function(){buf.push('<table class="table table-bordered table-condensed fte-leaderEntry-print">\n  <thead>\n    <tr>\n      <th>',t("fte","leaderEntry:column:task"),"</th>\n      <th>",t("fte","leaderEntry:column:taskTotal"),"</th>\n      "),companies.forEach(function(e){buf.push('\n      <th colspan="',divisions.length,'">',escape(e.name),"</th>\n      ")}),buf.push('\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th class="fte-ntb fte-nbb"></th>\n      <th class="fte-nbb">',round(total),"</th>\n      "),companies.forEach(function(e){buf.push('\n      <th class="fte-nbb" colspan="',divisions.length,'">',round(e.total),"</th>\n      ")}),buf.push("\n    </tr>\n    "),divisions.length&&(buf.push('\n    <tr>\n      <th class="fte-ntb"></th>\n      <th class="fte-ntb"></th>\n      '),companies.forEach(function(){buf.push("\n      "),divisions.forEach(function(e){buf.push("\n      <th>",e,"</th>\n      ")}),buf.push("\n      ")}),buf.push("\n    </tr>\n    ")),buf.push("\n    "),tasks.forEach(function(e){buf.push("\n    <tr>\n      <td>",escape(e.name),"\n      <td>",round(e.total),"\n      "),e.companies.forEach(function(e){buf.push("\n      "),Array.isArray(e.count)?(buf.push("\n      "),e.count.forEach(function(e){buf.push("\n      <td>",round(e.value),"</td>\n      ")}),buf.push("\n      ")):buf.push('\n      <td colspan="',divisions.length,'">',round(e.count),"</td>\n      "),buf.push("\n      ")}),buf.push("\n    </tr>\n    ")}),buf.push("\n  </tbody>\n</table>\n")}();return buf.join("")}}),define("app/fte/views/FteLeaderEntryDetailsPrintableView",["underscore","app/i18n","app/core/views/PrintableListView","app/fte/templates/printableLeaderEntryList","../util/fractions"],function(e,t,n,r,i){return n.extend({template:r,serialize:function(){return e.extend(this.model.serializeWithTotals(),{round:i.round})},afterRender:function(){}})}),define("app/fte/pages/FteLeaderEntryDetailsPrintablePage",["moment","app/i18n","app/data/subdivisions","app/data/views/renderOrgUnitPath","app/core/util/bindLoadingMessage","app/core/View","../FteLeaderEntry","../views/FteLeaderEntryDetailsPrintableView"],function(e,t,n,r,i,o,a,s){return o.extend({layoutName:"print",pageId:"fteLeaderEntryDetailsPrintable",hdLeft:function(){var e=n.get(this.model.get("subdivision"));return t("fte","print:hdLeft",{subdivision:e?r(e,!1,!1):"?"})},hdRight:function(){return t("fte","print:hdRight",{date:e(this.model.get("date")).format("YYYY-MM-DD"),shift:t("core","SHIFT:"+this.model.get("shift"))})},initialize:function(){this.model=i(new a({_id:this.options.modelId}),this),this.view=new s({model:this.model})},load:function(e){return e(this.model.fetch())}})}),define("app/nls/fte",["app/nls/locale/en"],function(e){var t={locale:{}};t.locale.en=e;var n=function(e){if(!e)throw new Error("MessageFormat: No data passed to function.")},r=function(e,t){return n(e),e[t]},i=function(e,t,r){return n(e),e[t]in r?r[e[t]]:r.other};return{root:{"BREADCRUMBS:leader:browse":function(){return"FTE (warehouse)"},"BREADCRUMBS:master:browse":function(){return"FTE (production)"},"BREADCRUMBS:addForm":function(){return"Choosing"},"BREADCRUMBS:editForm":function(){return"Editing"},"BREADCRUMBS:details":function(){return"Resources"},"BREADCRUMBS:ACTION_FORM:delete":function(){return"Deleting"},"MSG:LOADING_FAILURE":function(){return"Failed to load the FTE data :("},"MSG:LOADING_SINGLE_FAILURE":function(){return"Failed to load the specific FTE data :("},"MSG:DELETED":function(e){return"FTE entry <em>"+r(e,"label")+"</em> was deleted."},"PAGE_ACTION:print":function(){return"Show printable version"},"PAGE_ACTION:add":function(){return"Allocate resources"},"PAGE_ACTION:edit":function(){return"Edit entry"},"PAGE_ACTION:delete":function(){return"Delete entry"},"PAGE_ACTION:export":function(){return"Export entries"},"FILTER:DATE":function(){return"Date:"},"FILTER:LIMIT":function(){return"Limit:"},"FILTER:SHIFT":function(){return"Shift:"},"FILTER:BUTTON":function(){return"Filter entries"},"addForm:panel:title":function(){return"FTE entry find/create form"},"addForm:submit":function(){return"Allocate resources"},"addForm:msg:offline":function(){return"Cannot allocate FTE: no connection with the server :("},"addForm:msg:failure":function(e){return"Failed to find/create the FTE entry for editing: "+i(e,"error",{AUTH:"no privileges!",INPUT:"invalid input data!",other:r(e,"error")})},"property:date":function(){return"Date"},"property:shift":function(){return"Shift"},label:function(e){return r(e,"subdivision")+", "+r(e,"date")+", "+r(e,"shift")+" shift"},"panel:info":function(){return"All changes are saved on-the-fly!"},"leaderEntry:panel:title":function(){return"Resource allocation"},"leaderEntry:panel:title:editable":function(){return"Resource allocation form"},"leaderEntry:column:task":function(){return"Production task"},"leaderEntry:column:taskTotal":function(){return"Total"},"leaderEntry:column:companyTotal":function(){return"Total"},"masterEntry:tasksPanel:title":function(){return"Resource allocation"},"masterEntry:tasksPanel:title:editable":function(){return"Resource allocation form"},"masterEntry:absencePanel:title":function(){return"Personnel absence"},"masterEntry:absencePanel:title:editable":function(){return"Personnel absence form"},"masterEntry:column:task":function(){return"Production flow/<em>Production task</em>"},"masterEntry:column:noPlan":function(){return"No plan?"},"masterEntry:column:total":function(){return"Total"},"print:hdLeft":function(e){return"FTE allocated to "+r(e,"subdivision")},"print:hdRight":function(e){return r(e,"date")+", "+r(e,"shift")+" shift"},"ACTION_FORM:DIALOG_TITLE:delete":function(){return"FTE entry deletion confirmation"},"ACTION_FORM:BUTTON:delete":function(){return"Delete FTE entry"},"ACTION_FORM:MESSAGE:delete":function(){return"Are you sure you want to delete the chosen FTE entry?"},"ACTION_FORM:MESSAGE_SPECIFIC:delete":function(e){return"Are you sure you want to delete the <em>"+r(e,"label")+"</em> FTE entry?"},"ACTION_FORM:MESSAGE_FAILURE:delete":function(){return"Failed to delete the FTE entry :-("}},pl:!0}}),define("app/nls/pl/fte",["app/nls/locale/pl"],function(e){var t={locale:{}};t.locale.pl=e;var n=function(e){if(!e)throw new Error("MessageFormat: No data passed to function.")},r=function(e,t){return n(e),e[t]},i=function(e,t,r){return n(e),e[t]in r?r[e[t]]:r.other};return{"BREADCRUMBS:browse":function(){return"FTE"},"BREADCRUMBS:leader:browse":function(){return"FTE (magazyn)"},"BREADCRUMBS:master:browse":function(){return"FTE (produkcja)"},"BREADCRUMBS:addForm":function(){return"Wybieranie wpisu"},"BREADCRUMBS:editForm":function(){return"Edycja"},"BREADCRUMBS:details":function(){return"Zasoby"},"BREADCRUMBS:ACTION_FORM:delete":function(){return"Usuwanie"},"MSG:LOADING_FAILURE":function(){return"Ładowanie danych FTE nie powiodło się :("},"MSG:LOADING_SINGLE_FAILURE":function(){return"Ładowanie danych FTE nie powiodło się :("
},"MSG:DELETED":function(e){return"Wpis FTE <em>"+r(e,"label")+"</em> został usunięty."},"PAGE_ACTION:print":function(){return"Pokaż wersję do druku"},"PAGE_ACTION:add":function(){return"Przydzielaj zasoby"},"PAGE_ACTION:edit":function(){return"Edytuj wpis"},"PAGE_ACTION:delete":function(){return"Usuń wpis"},"PAGE_ACTION:export":function(){return"Eksportuj wpisy"},"FILTER:DATE":function(){return"Data:"},"FILTER:LIMIT":function(){return"Limit:"},"FILTER:SHIFT":function(){return"Zmiana:"},"FILTER:BUTTON":function(){return"Filtruj wpisy"},"addForm:panel:title":function(){return"Formularz wyszukiwania/tworzenia wpisu FTE"},"addForm:submit":function(){return"Przydzielaj zasoby"},"addForm:msg:offline":function(){return"Nie można przydzielać zasobów: brak połączenia z serwerem :("},"addForm:msg:failure":function(e){return"Nie udało się znaleźć/utworzyć wpisu do edycji: "+i(e,"error",{AUTH:"brak uprawnień!",INPUT:"nieprawidłowe dane wejściowe!",other:r(e,"error")})},"property:date":function(){return"Data"},"property:shift":function(){return"Zmiana"},label:function(e){return r(e,"subdivision")+", "+r(e,"date")+", "+r(e,"shift")+" zmiana"},"panel:info":function(){return"Wszystkie zmiany w formularzu zapisywane są na bieżąco!"},"leaderEntry:panel:title":function(){return"Podział zasobów"},"leaderEntry:panel:title:editable":function(){return"Formularz przydzielania zasobów"},"leaderEntry:column:task":function(){return"Zadanie produkcyjne"},"leaderEntry:column:taskTotal":function(){return"Suma"},"leaderEntry:column:companyTotal":function(){return"Suma"},"masterEntry:tasksPanel:title":function(){return"Podział zasobów"},"masterEntry:tasksPanel:title:editable":function(){return"Formularz przydzielania zasobów"},"masterEntry:absencePanel:title":function(){return"Absencja personalna"},"masterEntry:absencePanel:title:editable":function(){return"Formularz absencji personalnej"},"masterEntry:column:task":function(){return"Przepływ/<em>Zadanie produkcyjne</em>"},"masterEntry:column:noPlan":function(){return"Brak planu?"},"masterEntry:column:total":function(){return"Suma"},"print:hdLeft":function(e){return"Zasoby przydzielone do "+r(e,"subdivision")},"print:hdRight":function(e){return r(e,"date")+", "+r(e,"shift")+" zmiana"},"ACTION_FORM:DIALOG_TITLE:delete":function(){return"Potwierdzenie usunięcia wpisu FTE"},"ACTION_FORM:BUTTON:delete":function(){return"Usuń wpis FTE"},"ACTION_FORM:MESSAGE:delete":function(){return"Czy na pewno chcesz bezpowrotnie usunąć wybrany wpis FTE?"},"ACTION_FORM:MESSAGE_SPECIFIC:delete":function(e){return"Czy na pewno chcesz bezpowrotnie usunąć wpis FTE <em>"+r(e,"label")+"</em>?"},"ACTION_FORM:MESSAGE_FAILURE:delete":function(){return"Nie udało się usunąć wpisu FTE :-("}}}),define("app/fte/routes",["../router","../viewport","../user","../core/util/showDeleteFormPage","./FteMasterEntry","./FteLeaderEntry","./pages/FteMasterEntryListPage","./pages/FteMasterEntryAddFormPage","./pages/FteMasterEntryEditFormPage","./pages/FteMasterEntryDetailsPage","./pages/FteMasterEntryDetailsPrintablePage","./pages/FteLeaderEntryListPage","./pages/FteLeaderEntryAddFormPage","./pages/FteLeaderEntryEditFormPage","./pages/FteLeaderEntryDetailsPage","./pages/FteLeaderEntryDetailsPrintablePage","i18n!app/nls/fte"],function(e,t,n,r,i,o,a,s,u,l,c,d,p,f,h,m){var g=n.auth("FTE:MASTER:VIEW"),y=n.auth("FTE:MASTER:MANAGE|PROD_DATA:MANAGE"),v=n.auth("FTE:LEADER:VIEW"),w=n.auth("FTE:LEADER:MANAGE|PROD_DATA:MANAGE");e.map("/fte/master",g,function(e){t.showPage(new a({rql:e.rql}))}),e.map("/fte/master;add",y,function(){t.showPage(new s)}),e.map("/fte/master/:id",g,function(e){t.showPage(new l({modelId:e.params.id}))}),e.map("/fte/master/:id;edit",y,function(e){t.showPage(new u({modelId:e.params.id}))}),e.map("/fte/master/:id;print",g,function(e){t.showPage(new c({modelId:e.params.id}))}),e.map("/fte/master/:id;delete",y,r.bind(null,i)),e.map("/fte/leader",v,function(e){t.showPage(new d({rql:e.rql}))}),e.map("/fte/leader;add",w,function(){t.showPage(new p)}),e.map("/fte/leader/:id",v,function(e){t.showPage(new h({modelId:e.params.id}))}),e.map("/fte/leader/:id;edit",w,function(e){t.showPage(new f({modelId:e.params.id}))}),e.map("/fte/leader/:id;print",v,function(e){t.showPage(new m({modelId:e.params.id}))}),e.map("/fte/leader/:id;delete",w,r.bind(null,o))}),define("app/hourlyPlans/HourlyPlan",["../i18n","../time","../data/divisions","../data/views/renderOrgUnitPath","../core/Model"],function(e,t,n,r,i){return i.extend({urlRoot:"/hourlyPlans",clientUrlRoot:"#hourlyPlans",topicPrefix:"hourlyPlans",privilegePrefix:"HOURLY_PLANS",nlsDomain:"hourlyPlans",defaults:{division:null,date:null,shift:null,flows:null,createdAt:null,creator:null,updatedAt:null,updater:null},getLabel:function(){return this.get("division")+", "+t.format(this.get("date"),"LL")},serialize:function(){var i=n.get(this.get("division"));return{division:i?r(i,!1,!1):"?",date:t.format(this.get("date"),"LL"),shift:e("core","SHIFT:"+this.get("shift")),flows:this.get("flows")}},isEditable:function(e){if(e.isAllowedTo("PROD_DATA:MANAGE"))return!0;if(!e.isAllowedTo(this.getPrivilegePrefix()+":MANAGE"))return!1;var t=Date.parse(this.get("createdAt"));if(Date.now()>=t+288e5)return!1;var n=e.getDivision();if(!n||e.isAllowedTo(this.getPrivilegePrefix()+":ALL"))return!0;var r=this.get("division");return r===n.id},handleUpdateMessage:function(e){var t=this.get("flows");if(t){var n=t[e.flowIndex];if(n){if("plan"===e.type)n.noPlan=e.newValue,n.level=0,n.hours=n.hours.map(function(){return 0});else{if("count"!==e.type)return;"number"==typeof e.hourIndex?n.hours[e.hourIndex]=e.newValue:n.level=e.newValue}this.trigger("change:flows"),this.trigger("change")}}}})}),define("app/hourlyPlans/HourlyPlanCollection",["app/user","../core/Collection","./HourlyPlan"],function(e,t,n){return t.extend({model:n,rqlQuery:function(t){var n,r=e.getDivision();return r&&"prod"===r.get("type")&&(n={name:"and",args:[{name:"eq",args:["division",r.id]}]}),t.Query.fromObject({fields:{division:1,date:1,shift:1,createdAt:1,creator:1},sort:{date:-1},limit:15,selector:n})}})}),define("app/hourlyPlans/views/HourlyPlanListView",["moment","app/i18n","app/user","app/data/divisions","app/data/views/renderOrgUnitPath","app/core/views/ListView"],function(e,t,n,r,i,o){return o.extend({remoteTopics:{"hourlyPlans.created":"refreshCollection","hourlyPlans.deleted":"onModelDeleted"},serializeColumns:function(){return[{id:"division",label:t("core","ORG_UNIT:division")},{id:"date",label:t("hourlyPlans","property:date")},{id:"shift",label:t("hourlyPlans","property:shift")}]},serializeActions:function(){var e=this.collection;return function(r){var i=e.get(r._id),a=[o.actions.viewDetails(i),{icon:"print",label:t("core","LIST:ACTION:print"),href:i.genClientUrl("print")}];return i.isEditable(n)&&a.push(o.actions.edit(i),o.actions.delete(i)),a}},serializeRows:function(){return this.collection.map(function(n){var o=r.get(n.get("division")),a=n.toJSON();return a.division=o?i(o,!1,!1):"?",a.date=e(a.date).format("LL"),a.shift=t("core","SHIFT:"+a.shift),a})}})}),define("app/hourlyPlans/templates/listPage",["app/i18n"],function(t){return function anonymous(locals,filters,escape,rethrow){escape=escape||function(e){return String(e).replace(/&(?!#?[a-zA-Z0-9]+;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&#39;").replace(/"/g,"&quot;")};var buf=[];with(locals||{})!function(){buf.push('<div>\n  <div class="filter-container"></div>\n  <div class="hourlyPlans-list-container"></div>\n</div>\n')}();return buf.join("")}}),define("app/hourlyPlans/pages/HourlyPlanListPage",["jquery","app/i18n","app/core/util/bindLoadingMessage","app/core/util/pageActions","app/core/View","../HourlyPlanCollection","../views/HourlyPlanListView","app/fte/views/FteEntryFilterView","app/hourlyPlans/templates/listPage"],function(e,t,n,r,i,o,a,s,u){return i.extend({template:u,layoutName:"page",pageId:"hourlyPlanList",breadcrumbs:[t.bound("hourlyPlans","BREADCRUMBS:browse")],actions:function(e){return[{label:t.bound("hourlyPlans","PAGE_ACTION:add"),href:"#hourlyPlans;add",icon:"plus",privileges:"HOURLY_PLANS:MANAGE|PROD_DATA:MANAGE"},r.export(e,this,this.collection)]},initialize:function(){this.defineModels(),this.defineViews(),this.setView(".filter-container",this.filterView),this.setView(".hourlyPlans-list-container",this.listView)},defineModels:function(){this.collection=n(new o(null,{rqlQuery:this.options.rql}),this)},defineViews:function(){this.filterView=new s({model:{rqlQuery:this.collection.rqlQuery},divisionOnly:!0,divisionFilter:function(e){return"prod"===e.get("type")}}),this.listView=new a({collection:this.collection}),this.listenTo(this.filterView,"filterChanged",this.refreshList)},load:function(e){return e(this.collection.fetch({reset:!0}))},refreshList:function(e){this.collection.rqlQuery=e,this.listView.refreshCollection(null,!0);var t=e.toString();this.broker.publish("router.navigate",{url:this.collection.genClientUrl()+"?"+t,trigger:!1,replace:!0})}})}),define("app/hourlyPlans/templates/addForm",["app/i18n"],function(t){return function anonymous(locals,filters,escape,rethrow){escape=escape||function(e){return String(e).replace(/&(?!#?[a-zA-Z0-9]+;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&#39;").replace(/"/g,"&quot;")};var buf=[];with(locals||{})!function(){buf.push('<form class="panel panel-primary">\n  <div class="panel-heading">\n    ',t("hourlyPlans","addForm:panel:title"),'\n  </div>\n  <div class="panel-body">\n    <div class="form-group orgUnitDropdowns-container"></div>\n    <div class="form-group">\n      <label for="',idPrefix,'-date" class="control-label">',t("hourlyPlans","property:date"),'</label>\n      <input id="',idPrefix,'-date" class="form-control" type="date" value="',date,'" max="',date,'" min="2013-12-01" required>\n    </div>\n  </div>\n  <div class="panel-footer">\n    <button class="btn btn-primary">\n      <i class="fa fa-plus"></i>\n      <span>',t("hourlyPlans","addForm:submit"),"</span>\n    </button>\n  </div>\n</form>\n")}();return buf.join("")}}),define("app/hourlyPlans/views/HourlyPlanAddFormView",["app/i18n","app/time","app/viewport","app/user","app/data/divisions","app/data/views/OrgUnitDropdownsView","app/core/Model","app/core/View","app/core/util/getShiftStartInfo","app/hourlyPlans/templates/addForm"],function(e,t,n,r,i,o,a,s,u,l){var c=o.ORG_UNIT;return s.extend({template:l,idPrefix:"hourlyPlanAddForm",events:{submit:"submitForm"},initialize:function(){this.readonlyDivision=!1,this.$submit=null,this.oudView=new o({orgUnit:c.DIVISION,divisionFilter:function(e){return"prod"===e.get("type")},allowClear:!0,noGrid:!0}),this.setView(".orgUnitDropdowns-container",this.oudView)},destroy:function(){null!==this.$submit&&(this.$submit.remove(),this.$submit=null)},serialize:function(){return{idPrefix:this.idPrefix,date:u(new Date).moment.format("YYYY-MM-DD")}},afterRender:function(){var e=this,t=r.getDivision();this.$submit=this.$(".btn-primary").attr("disabled",!0),this.listenToOnce(this.oudView,"afterRender",function(){e.oudView.$id("division").on("change",function(t){e.$submit.attr("disabled",""===t.val||null===t.val)});var n=null,i=null;null!==t&&(i=c.DIVISION,n=new a({division:t.id})),e.oudView.selectValue(n,i),e.readonlyDivision=!r.isAllowedTo("HOURLY_PLANS:ALL")&&t,e.oudView.$id("division").select2("readonly",e.readonlyDivision),e.readonlyDivision?e.$submit.focus():e.oudView.$id("division").select2("focus")})},submitForm:function(t){if(t.preventDefault(),!this.socket.isConnected())return n.msg.show({type:"error",time:5e3,text:e("hourlyPlans","addForm:msg:offline")});var r=this,i=this.oudView.$id("division"),o=this.$submit.find("i").removeClass("fa-edit").addClass("fa-spinner fa-spin");i.select2("readonly",!0),this.$submit.attr("disabled",!0);var a={division:i.select2("val"),date:new Date(this.$id("date").val()+" 00:00:00"),shift:1};this.socket.emit("hourlyPlans.findOrCreate",a,function(t,a){return a&&r.model.set("_id",a),t?"AUTH"===t.message&&a?r.trigger("uneditable",r.model):(o.removeClass("fa-spinner fa-spin").addClass("fa-edit"),i.select2("readonly",r.readonlyDivision),r.$submit.attr("disabled",!1).focus(),n.msg.show({type:"error",time:5e3,text:e("hourlyPlans","addForm:msg:failure",{error:t.message})})):void r.trigger("editable",r.model)})}})}),define("app/hourlyPlans/pages/HourlyPlanAddFormPage",["app/i18n","app/core/View","../HourlyPlan","../views/HourlyPlanAddFormView"],function(e,t,n,r){return t.extend({layoutName:"page",pageId:"hourlyPlanAddForm",breadcrumbs:function(){return[{label:e.bound("hourlyPlans","BREADCRUMBS:browse"),href:this.model.genClientUrl("base")},e.bound("hourlyPlans","BREADCRUMBS:addForm")]},initialize:function(){this.model=new n,this.view=new r({model:this.model}),this.listenTo(this.view,"editable",function(e){this.broker.publish("router.navigate",{url:e.genClientUrl("edit"),trigger:!0})}),this.listenTo(this.view,"uneditable",function(e){this.broker.publish("router.navigate",{url:e.genClientUrl(),trigger:!0})})}})}),define("app/hourlyPlans/templates/entry",["app/i18n"],function(t){return function anonymous(locals,filters,escape,rethrow){escape=escape||function(e){return String(e).replace(/&(?!#?[a-zA-Z0-9]+;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&#39;").replace(/"/g,"&quot;")};var buf=[];with(locals||{})!function(){buf.push('<div>\n  <div class="well">\n    <div class="fte-property">\n      <span class="fte-property-name">',t("core","ORG_UNIT:division"),'</span>\n      <span class="fte-property-value">',division,'</span>\n    </div>\n    <div class="fte-property">\n      <span class="fte-property-name">',t("hourlyPlans","property:date"),'</span>\n      <span class="fte-property-value">',date,'</span>\n    </div>\n    <div class="fte-property">\n      <span class="fte-property-name">',t("hourlyPlans","property:shift"),'</span>\n      <span class="fte-property-value">',shift,'</span>\n    </div>\n  </div>\n  <div class="panel panel-primary">\n    <div class="panel-heading">',t("hourlyPlans","panel:title"+(editable?":editable":"")),"</div>\n    "),editable&&buf.push('\n    <div class="message message-inline message-info">',t("hourlyPlans","panel:info"),"</div>\n    "),buf.push('\n    <table class="table table-bordered table-condensed table-hover hourlyPlan">\n      <thead>\n      <tr>\n        <th>',t("hourlyPlans","column:flow"),'\n        <th class="hourlyPlan-column-noPlan even">',t("hourlyPlans","column:noPlan"),'\n        <th class="hourlyPlan-column-level">',t("hourlyPlans","column:level"),"\n        "),[6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,0,1,2,3,4,5].forEach(function(e,t){buf.push('\n        <th class="hourlyPlan-column-',t," ",t%2?"":"even",'">\n          <span>',10>e?"0":"","",e,"<!--:00-",23===e?"00":(10>e+1?"0":"")+(e+1),":00//--></span>\n        ")}),buf.push("\n      <tbody>\n      "),flows.forEach(function(e,t){buf.push("\n      <tr>\n        <td>",escape(e.name),'\n        <td class="even '),editable&&buf.push("hourlyPlan-noPlan-container"),buf.push('" data-column="noPlan">\n          '),editable?buf.push('\n          <input class="hourlyPlan-noPlan" type="checkbox" data-flow="',t,'" ',e.noPlan?"checked":"",">\n          "):buf.push('\n          <i class="fa fa-',e.noPlan?"check":"times",'"></i>\n          '),buf.push('\n        <td data-column="level">\n          '),editable?buf.push('\n          <input\n            class="form-control hourlyPlan-count"\n            name="level"\n            type="text"\n            min="0"\n            max="9999"\n            value="',e.level,'"\n            data-value="',e.level,'"\n            data-flow="',t,'"\n            ',e.noPlan?"disabled":"",">\n          "):buf.push("\n          ",e.level,"\n          "),buf.push("\n        "),e.hours.forEach(function(n,r){buf.push('\n        <td class="hourlyPlan-cell-count ',r%2?"":"even",'" data-column="',r,'">\n          '),editable?buf.push('\n          <input\n            class="form-control hourlyPlan-count"\n            name="hour"\n            type="text"\n            min="0"\n            max="9999"\n            value="',n,'"\n            data-value="',n,'"\n            data-flow="',t,'"\n            data-hour="',r,'"\n            ',e.noPlan?"disabled":"",">\n          "):buf.push("\n          ",n,"\n          "),buf.push("\n        ")}),buf.push("\n      ")}),buf.push("\n    </table>\n  </div>\n</div>\n")}();return buf.join("")}}),define("app/hourlyPlans/views/HourlyPlanEditFormView",["underscore","jquery","app/i18n","app/user","app/core/View","app/core/util/onModelDeleted","app/hourlyPlans/templates/entry"],function(e,t,n,r,i,o,a){return i.extend({template:a,idPrefix:"hourlyPlanForm",events:{"change .hourlyPlan-count":"updateCount","keyup .hourlyPlan-count":"updateCount","change .hourlyPlan-noPlan":"updatePlan","click .hourlyPlan-noPlan-container":function(e){e.target.classList.contains("hourlyPlan-noPlan-container")&&this.$(e.target).find(".hourlyPlan-noPlan").click()},"focus .hourlyPlan-count, .hourlyPlan-noPlan":function(e){this.focused=[e.target.parentNode,e.target.parentNode.parentNode.children[0],this.el.querySelector(".hourlyPlan-column-"+e.target.parentNode.dataset.column)],t(this.focused).addClass("is-focused")},"blur .hourlyPlan-count, .hourlyPlan-noPlan":function(){t(this.focused).removeClass("is-focused")}},remoteTopics:function(){var e={};return e["hourlyPlans.updated."+this.model.id]="onRemoteEdit",e["hourlyPlans.deleted"]="onModelDeleted",e},initialize:function(){this.focused=[]},destroy:function(){this.focused=null},afterRender:function(){this.listenToOnce(this.model,"change",this.render),this.focusFirstEnabledInput()},serialize:function(){return e.extend(this.model.serialize(),{editable:!0})},focusNextInput:function(e){var t=e.closest("td").next("td");if(t.length)return t.find("input").select();var n=e.closest("tr").next();return n.length?void this.focusNextEnabledInput(n):this.focusFirstEnabledInput()},focusFirstEnabledInput:function(){var e=this.el.querySelector(".hourlyPlan-noPlan:not(:checked)");e&&this.$(e).closest("tr").find(".hourlyPlan-count").first().select()},focusNextEnabledInput:function(e){return e.length?e.find(".hourlyPlan-noPlan:checked").length?this.focusNextEnabledInput(e.next()):void e.find(".hourlyPlan-count").first().select():this.focusFirstEnabledInput()},toggleCountsInRow:function(e,t){var n=this.$(this.el.ownerDocument.activeElement).closest("tr"),r=this.$(".hourlyPlan > tbody > :last-child"),i=e.closest("tr"),o=i.find(".hourlyPlan-count").attr("disabled",e[0].checked);return e[0].checked?(o.val("0").attr("data-value","0"),t?i[0]===n[0]?i[0]===r[0]?this.focusFirstEnabledInput():this.focusNextEnabledInput(i):void 0:i[0]===r[0]?this.focusFirstEnabledInput():this.focusNextEnabledInput(i)):void(t||i.find(".hourlyPlan-count").first().select())},updatePlan:function(e){var t={type:"plan",socketId:this.socket.getId(),_id:this.model.id,flowIndex:parseInt(e.target.getAttribute("data-flow"),10),newValue:e.target.checked},n=this.$(e.target),r=this;this.toggleCountsInRow(n),this.socket.emit("hourlyPlans.updatePlan",t,function(t){t&&(e.target.checked=!e.target.checked,r.toggleCountsInRow(n),r.trigger("remoteError",t))})},updateCount:function(e){if(13===e.which)return this.focusNextInput(this.$(e.target));var t=parseInt(e.target.getAttribute("data-value"),10)||0,n=parseInt(e.target.value,10)||0;if(t!==n){var r=e.target.getAttribute("data-flow")+":"+e.target.getAttribute("data-hour")+":"+e.target.getAttribute("name");this.timers[r]&&clearTimeout(this.timers[r]),this.timers[r]=setTimeout(this.doUpdateCount.bind(this),250,e.target,r,t,n)}},doUpdateCount:function(e,t,n,r){delete this.timers[t];var i=e.getAttribute("data-remote"),o={type:"count",socketId:this.socket.getId(),_id:this.model.id,newValue:r,flowIndex:parseInt(e.getAttribute("data-flow"),10)};"hour"===e.name&&(o.hourIndex=parseInt(e.getAttribute("data-hour"),10)),e.setAttribute("data-value",o.newValue),e.setAttribute("data-remote","false");var a=this;this.socket.emit("hourlyPlans.updateCount",o,function(t){t&&("true"!==e.getAttribute("data-remote")&&(e.value=n,e.setAttribute("data-value",n),e.setAttribute("data-remote",i)),a.trigger("remoteError",t))})},onRemoteEdit:function(e){if(e.socketId!==this.socket.getId())switch(e.type){case"plan":return this.handlePlanChange(e);case"count":return this.handleCountChange(e)}},handlePlanChange:function(e){var t='.hourlyPlan-noPlan[data-flow="'+e.flowIndex+'"]',n=this.$(t);n.length&&(n.prop("checked",e.newValue),this.toggleCountsInRow(n,!0))},handleCountChange:function(e){var t=".hourlyPlan-count[data-flow="+e.flowIndex+"]";t+="number"==typeof e.hourIndex?"[data-hour="+e.hourIndex+"]":"[name=level]";var n=this.$(t);n.length&&(n.val(e.newValue),n.attr({"data-value":e.newValue,"data-remote":"true"}))},onModelDeleted:function(e){o(this.broker,this.model,e)}})}),define("app/hourlyPlans/pages/HourlyPlanEditFormPage",["app/i18n","app/core/util/bindLoadingMessage","app/core/View","../HourlyPlan","../views/HourlyPlanEditFormView"],function(e,t,n,r,i){return n.extend({layoutName:"page",pageId:"hourlyPlanEditForm",breadcrumbs:function(){return[{label:e.bound("hourlyPlans","BREADCRUMBS:browse"),href:this.model.genClientUrl("base")},{label:this.model.getLabel(),href:this.model.genClientUrl()},e.bound("hourlyPlans","BREADCRUMBS:editForm")]},initialize:function(){this.model=t(new r({_id:this.options.modelId}),this),this.view=new i({model:this.model}),this.listenTo(this.view,"remoteError",function(e){"AUTH"===e.message&&this.broker.publish("router.navigate",{url:this.model.genClientUrl(),trigger:!0,replace:!0})})},load:function(e){return e(this.model.fetch())}})}),define("app/hourlyPlans/views/HourlyPlanDetailsView",["underscore","app/core/View","app/core/util/onModelDeleted","app/hourlyPlans/templates/entry"],function(e,t,n,r){return t.extend({template:r,idPrefix:"hourlyPlanDetails",remoteTopics:function(){var e={};return e["hourlyPlans.updated."+this.model.id]=this.model.handleUpdateMessage.bind(this.model),e["hourlyPlans.deleted"]=this.onModelDeleted.bind(this),e},serialize:function(){return e.extend(this.model.serialize(),{editable:!1})},beforeRender:function(){this.stopListening(this.model,"change",this.render)},afterRender:function(){this.listenToOnce(this.model,"change",this.render)},onModelDeleted:function(e){n(this.broker,this.model,e)}})}),define("app/hourlyPlans/pages/HourlyPlanDetailsPage",["app/i18n","app/user","app/core/util/bindLoadingMessage","app/core/util/pageActions","app/core/View","../HourlyPlan","../views/HourlyPlanDetailsView"],function(e,t,n,r,i,o,a){return i.extend({layoutName:"page",pageId:"hourlyPlanDetails",breadcrumbs:function(){return[{label:e.bound("hourlyPlans","BREADCRUMBS:browse"),href:this.model.genClientUrl("base")},this.model.getLabel()]},actions:function(){var n=[{label:e.bound("hourlyPlans","PAGE_ACTION:print"),icon:"print",href:this.model.genClientUrl("print")}];return this.model.isEditable(t)&&n.push(r.edit(this.model),r.delete(this.model)),n},initialize:function(){this.model=n(new o({_id:this.options.modelId}),this),this.view=new a({model:this.model})},load:function(e){return e(this.model.fetch())}})}),define("app/hourlyPlans/templates/printableList",["app/i18n"],function(t){return function anonymous(locals,filters,escape,rethrow){escape=escape||function(e){return String(e).replace(/&(?!#?[a-zA-Z0-9]+;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&#39;").replace(/"/g,"&quot;")};var buf=[];with(locals||{})!function(){buf.push('<table class="table table-bordered table-condensed table-hover hourlyPlan">\n  <thead>\n  <tr>\n    <th>',t("hourlyPlans","column:flow"),"\n    <th>",t("hourlyPlans","column:noPlan"),"\n    <th>",t("hourlyPlans","column:level"),"\n    "),[6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,0,1,2,3,4,5].forEach(function(e){buf.push("\n    <th>",10>e?"0":"","",e,"\n    ")}),buf.push("\n    <tbody>\n    "),flows.forEach(function(e){buf.push("\n    <tr>\n      <td>",escape(e.name),'\n      <td><i class="fa fa-',e.noPlan?"check":"times",'"></i>\n      <td>',e.level,"\n      "),e.hours.forEach(function(e){buf.push("\n      <td>",e,"\n      ")}),buf.push("\n    ")}),buf.push("\n</table>\n")}();return buf.join("")}}),define("app/hourlyPlans/views/HourlyPlanDetailsPrintableView",["app/core/views/PrintableListView","app/hourlyPlans/templates/printableList"],function(e,t){return e.extend({template:t,serialize:function(){return this.model.serialize()},afterRender:function(){}})}),define("app/hourlyPlans/pages/HourlyPlanDetailsPrintablePage",["moment","app/i18n","app/data/divisions","app/data/views/renderOrgUnitPath","app/core/util/bindLoadingMessage","app/core/View","../HourlyPlan","../views/HourlyPlanDetailsPrintableView"],function(e,t,n,r,i,o,a,s){return o.extend({layoutName:"print",pageId:"hourlyPlanDetailsPrintable",hdLeft:function(){var e=n.get(this.model.get("division"));return t("hourlyPlans","print:hdLeft",{division:e?r(e,!1,!1):"?"})},hdRight:function(){return t("hourlyPlans","print:hdRight",{date:e(this.model.get("date")).format("YYYY-MM-DD"),shift:t("core","SHIFT:"+this.model.get("shift"))})},initialize:function(){this.model=i(new a({_id:this.options.modelId}),this),this.view=new s({model:this.model})},load:function(e){return e(this.model.fetch())}})}),define("app/nls/hourlyPlans",["app/nls/locale/en"],function(e){var t={locale:{}};t.locale.en=e;var n=function(e){if(!e)throw new Error("MessageFormat: No data passed to function.")},r=function(e,t){return n(e),e[t]},i=function(e,t,r){return n(e),e[t]in r?r[e[t]]:r.other};return{root:{"BREADCRUMBS:browse":function(){return"Hourly plans"},"BREADCRUMBS:addForm":function(){return"Choosing"},"BREADCRUMBS:editForm":function(){return"Planning"},"BREADCRUMBS:ACTION_FORM:delete":function(){return"Deleting"},"MSG:LOADING_FAILURE":function(){return"Failed to load the hourly plans :("},"MSG:LOADING_SINGLE_FAILURE":function(){return"Failed to load the hourly plan :("},"MSG:DELETED":function(e){return"Hourly plan <em>"+r(e,"label")+"</em> was deleted."},"PAGE_ACTION:print":function(){return"Show printable version"},"PAGE_ACTION:add":function(){return"Plan"},"PAGE_ACTION:edit":function(){return"Edit hourly plan"},"PAGE_ACTION:delete":function(){return"Delete hourly plan"},"PAGE_ACTION:export":function(){return"Export hourly plans"},"FILTER:DATE":function(){return"Date:"},"FILTER:LIMIT":function(){return"Limit:"},"FILTER:SHIFT":function(){return"Shift:"},"FILTER:BUTTON":function(){return"Filter hourly plans"},"panel:title":function(){return"Hourly plan"},"panel:title:editable":function(){return"Hourly plan edit form"},"panel:info":function(){return"All changes are saved on-the-fly. Planned quantities will be divided among the working Production lines one minute after the last change!"},"column:flow":function(){return"Production flow"},"column:noPlan":function(){return"No<br>plan?"},"column:level":function(){return"Level"},"property:shift":function(){return"Shift"},"property:date":function(){return"Date"},"print:hdLeft":function(e){return"Hourly plan for "+r(e,"division")},"print:hdRight":function(e){return r(e,"date")+", "+r(e,"shift")+" shift"},"addForm:panel:title":function(){return"Hourly plan find/create form"},"addForm:submit":function(){return"Plan"},"addForm:msg:offline":function(){return"Cannot plan: no connection to the server :("},"addForm:msg:failure":function(e){return"Failed to find/create the hourly plan for editing: "+i(e,"error",{AUTH:"no privileges!",INPUT:"invalid input data!",other:r(e,"error")})},"ACTION_FORM:DIALOG_TITLE:delete":function(){return"Hourly plan deletion confirmation"},"ACTION_FORM:BUTTON:delete":function(){return"Delete hourly plan"},"ACTION_FORM:MESSAGE:delete":function(){return"Are you sure you want to delete the chosen hourly plan?"},"ACTION_FORM:MESSAGE_SPECIFIC:delete":function(e){return"Are you sure you want to delete the <em>"+r(e,"label")+"</em> hourly plan?"},"ACTION_FORM:MESSAGE_FAILURE:delete":function(){return"Failed to delete the hourly plan :-("}},pl:!0}}),define("app/nls/pl/hourlyPlans",["app/nls/locale/pl"],function(e){var t={locale:{}};t.locale.pl=e;var n=function(e){if(!e)throw new Error("MessageFormat: No data passed to function.")},r=function(e,t){return n(e),e[t]},i=function(e,t,r){return n(e),e[t]in r?r[e[t]]:r.other};return{"BREADCRUMBS:browse":function(){return"Plany godzinowe"},"BREADCRUMBS:addForm":function(){return"Wybieranie planu"},"BREADCRUMBS:editForm":function(){return"Planowanie"},"BREADCRUMBS:ACTION_FORM:delete":function(){return"Usuwanie"},"MSG:LOADING_FAILURE":function(){return"Ładowanie planów godzinowych nie powiodło się :("},"MSG:LOADING_SINGLE_FAILURE":function(){return"Ładowanie planu godzinowego nie powiodło się :("},"MSG:DELETED":function(e){return"Plan godzinowy <em>"+r(e,"label")+"</em> został usunięty."},"PAGE_ACTION:print":function(){return"Pokaż wersję do druku"},"PAGE_ACTION:add":function(){return"Planuj"},"PAGE_ACTION:edit":function(){return"Edytuj plan"},"PAGE_ACTION:delete":function(){return"Usuń plan"},"PAGE_ACTION:export":function(){return"Eksportuj plany godzinowe"},"FILTER:DATE":function(){return"Data:"},"FILTER:LIMIT":function(){return"Limit:"},"FILTER:SHIFT":function(){return"Zmiana:"},"FILTER:SHIFT:ANY":function(){return"Dowolna"},"FILTER:BUTTON":function(){return"Filtruj plany"},"panel:title":function(){return"Plan godzinowy"},"panel:title:editable":function(){return"Formularz edycji planu godzinowego"},"panel:info":function(){return"Wszystkie zmiany w formularzu zapisywane są na bieżąco. Planowane ilości rozdzielone zostaną dla pracujących Linii produkcyjnych minutę po ostatniej zmianie!"},"column:flow":function(){return"Przepływ"},"column:noPlan":function(){return"Brak<br>planu?"},"column:level":function(){return"Poziom"},"property:shift":function(){return"Zmiana:"},"property:date":function(){return"Data:"},"print:hdLeft":function(e){return"Plan godzinowy dla "+r(e,"division")},"print:hdRight":function(e){return r(e,"date")+", "+r(e,"shift")+" zmiana"},"addForm:panel:title":function(){return"Formularz wyszukiwania/tworzenia planu godzinowego"},"addForm:submit":function(){return"Planuj"},"addForm:msg:offline":function(){return"Nie można planować: brak połączenia z serwerem :("},"addForm:msg:failure":function(e){return"Nie udało się znaleźć/utworzyć wpisu do edycji: "+i(e,"error",{AUTH:"brak uprawnień!",INPUT:"nieprawidłowe dane wejściowe!",other:r(e,"error")})},"ACTION_FORM:DIALOG_TITLE:delete":function(){return"Potwierdzenie usunięcia planu godzinowego"},"ACTION_FORM:BUTTON:delete":function(){return"Usuń plan godzinowy"},"ACTION_FORM:MESSAGE:delete":function(){return"Czy na pewno chcesz bezpowrotnie usunąć wybrany plan godzinowy?"},"ACTION_FORM:MESSAGE_SPECIFIC:delete":function(e){return"Czy na pewno chcesz bezpowrotnie usunąć plan godzinowy <em>"+r(e,"label")+"</em>?"},"ACTION_FORM:MESSAGE_FAILURE:delete":function(){return"Nie udało się usunąć planu godzinowego :-("}}}),define("app/hourlyPlans/routes",["../router","../viewport","../user","../core/util/showDeleteFormPage","./HourlyPlan","./pages/HourlyPlanListPage","./pages/HourlyPlanAddFormPage","./pages/HourlyPlanEditFormPage","./pages/HourlyPlanDetailsPage","./pages/HourlyPlanDetailsPrintablePage","i18n!app/nls/hourlyPlans"],function(e,t,n,r,i,o,a,s,u,l){var c=n.auth("HOURLY_PLANS:VIEW"),d=n.auth("HOURLY_PLANS:MANAGE|PROD_DATA:MANAGE");e.map("/hourlyPlans",c,function(e){t.showPage(new o({rql:e.rql}))}),e.map("/hourlyPlans;add",d,function(){t.showPage(new a)}),e.map("/hourlyPlans/:id",c,function(e){t.showPage(new u({modelId:e.params.id}))}),e.map("/hourlyPlans/:id;edit",d,function(e){t.showPage(new s({modelId:e.params.id}))}),e.map("/hourlyPlans/:id;print",c,function(e){t.showPage(new l({modelId:e.params.id}))}),e.map("/hourlyPlans/:id;delete",d,r.bind(null,i))}),define("app/orders/Operation",["../core/Model"],function(e){var t=["machineSetupTime","machineTime","laborSetupTime","laborTime"];return e.extend({defaults:{no:null,workCenter:null,name:null,qty:null,unit:null,machineSetupTime:-1,machineTime:-1,laborSetupTime:-1,laborTime:-1},toJSON:function(){var n=e.prototype.toJSON.call(this);
return n.qty&&(n.qtyUnit=n.qty,n.unit&&(n.qtyUnit+=" "+n.unit)),t.forEach(function(e){-1===n[e]&&(n[e]=null)}),n}})}),define("app/orders/OperationCollection",["../core/Collection","./Operation"],function(e,t){return e.extend({model:t})}),define("app/mechOrders/MechOrder",["moment","../core/Model","app/orders/OperationCollection"],function(e,t,n){return t.extend({urlRoot:"/mechOrders",clientUrlRoot:"#mechOrders",topicPrefix:"mechOrders",privilegePrefix:"ORDERS",nlsDomain:"mechOrders",labelAttribute:"_id",defaults:{name:null,mrp:null,materialNorm:null,operations:null,importTs:null},parse:function(e,r){return e=t.prototype.parse.call(this,e,r),e.operations=new n(e.operations),e},toJSON:function(){var n=t.prototype.toJSON.call(this);return n.importTs&&(n.importTs=e(n.importTs).format("YYYY-MM-DD HH:mm:ss")),n.operations=null===n.operations?[]:n.operations.toJSON(),n}})}),define("app/mechOrders/MechOrderCollection",["../core/Collection","./MechOrder"],function(e,t){return e.extend({model:t,rqlQuery:function(e){return e.Query.fromObject({fields:{name:1,mrp:1,materialNorm:1},limit:15,sort:{_id:1}})}})}),define("app/mechOrders/views/MechOrderListView",["jquery","app/i18n","app/user","app/viewport","app/data/mrpControllers","app/core/views/ListView"],function(e,t,n,r,i,o){return o.extend({localTopics:{"mrpControllers.synced":"render"},remoteTopics:{"mechOrders.synced":"refreshCollection","mechOrders.edited":function(e){var t=e.model,n=this.collection.get(t._id);n&&t.mrp!==n.get("mrp")&&(n.set("mrp",t.mrp),this.$(".list-item[data-id="+n.id+"] > td[data-id=mrp]").html(this.prepareMrpCell(t.mrp)))}},events:{"click .mechOrders-editMrp":"showMrpEditor"},columns:["_id","name","mrp","materialNorm"],destroy:function(){this.$('.select2-offscreen[tabindex="-1"]').select2("destroy")},serializeActions:function(){var e=this.collection;return function(t){return[o.actions.viewDetails(e.get(t._id))]}},serializeRows:function(){var e=this,t=n.isAllowedTo("ORDERS:MANAGE");return this.collection.map(function(n){var r=n.toJSON();return t&&(r.mrp=e.prepareMrpCell(r.mrp)),r})},prepareMrpCell:function(e){var n="";return e&&(n+="<span>"+e+"</span>"),n+=' <button class="btn btn-link mechOrders-editMrp">'+t("mechOrders","list:mrp:"+(e?"edit":"set"))+"</button>"},showMrpEditor:function(n){var r=this.$(n.target).closest("td"),o=this.collection.get(r.parent().attr("data-id")),a=this,s=e('<input type="text">');r.empty().append(s),s.select2({allowClear:!0,placeholder:t("mechOrders","list:mrp:placeholder"),data:i.map(function(e){return{id:e.id,text:e.getLabel()}})}),s.on("change",function(e){var t=e.val.length?e.val:null;return t===o.get("mrp")?r.html(a.prepareMrpCell(t)):(r.html('<i class="fa fa-spinner fa-spin"></i><span>'+t+"</span>"),a.updateMrp(o,t,r),void r.parent().next("tr").find(".mechOrders-editMrp").focus())}),s.select2("open")},updateMrp:function(e,n,i){var o=e.get("mrp"),a=Date.now(),s=this.promised(e.save("mrp",n,{patch:!0})),u=this;s.then(function(){u.delay(500,a,function(){i.html(u.prepareMrpCell(n))})}),s.fail(function(){e.set("mrp",o),i.html(u.prepareMrpCell(o)),r.msg.show({type:"error",time:3e3,text:t("mechOrders","list:mrp:failure",{nc12:e.id})})})},delay:function(e,t,n){var r=Date.now()-t;r>e?n():this.timers[Math.random()]=setTimeout(n,e-r)}})}),define("app/mechOrders/templates/filter",["app/i18n"],function(t){return function anonymous(locals,filters,escape,rethrow){escape=escape||function(e){return String(e).replace(/&(?!#?[a-zA-Z0-9]+;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&#39;").replace(/"/g,"&quot;")};var buf=[];with(locals||{})!function(){buf.push('<div class="well">\n  <form id="',idPrefix,'-form" class="filter-form">\n    <div class="form-group">\n      <label for="',idPrefix,'-_id">',t("mechOrders","PROPERTY:_id"),'</label>\n      <input id="',idPrefix,'-_id" class="form-control mechOrders-filter-_id" name="_id" type="text" maxlength="12" placeholder="',t("mechOrders","FILTER:PLACEHOLDER:_id"),'">\n    </div><div\n      class="form-group">\n      <label for="',idPrefix,'-limit">',t("mechOrders","FILTER:LIMIT"),'</label>\n      <input id="',idPrefix,'-limit" class="form-control" name="limit" type="number" value="25" min="5" max="100" step="1">\n    </div><div\n      class="form-group filter-actions">\n      <input type="submit" class="btn btn-primary" value="',escape(t("mechOrders","FILTER:BUTTON")),'">\n    </div>\n  </form>\n</div>\n')}();return buf.join("")}}),define("app/mechOrders/views/MechOrderFilterView",["underscore","js2form","app/i18n","app/core/View","app/mechOrders/templates/filter"],function(e,t,n,r,i){return r.extend({template:i,events:{"submit .filter-form":function(e){e.preventDefault(),this.changeFilter()}},initialize:function(){this.idPrefix=e.uniqueId("mechOrderFilter")},serialize:function(){return{idPrefix:this.idPrefix}},afterRender:function(){var e=this.serializeRqlQuery();t(this.el.querySelector(".filter-form"),e)},serializeRqlQuery:function(){var t=this.model.rqlQuery,n={_id:"",limit:t.limit<5?5:t.limit>100?100:t.limit};return t.selector.args.forEach(function(t){var r=t.args[0];switch(r){case"_id":var i=t.args[1];n[r]=e.isString(i)?i.replace(/[^0-9a-zA-Z]/g,""):""}}),n},changeFilter:function(){var e=this.model.rqlQuery,t=[];this.serializeRegexTerm(t,"_id",12),e.selector={name:"and",args:t},e.limit=parseInt(this.$id("limit").val(),10)||15,e.skip=0,this.trigger("filterChanged",e)},serializeRegexTerm:function(e,t,n){var r=this.$id(t),i=r.val().trim();"-"!==i&&(i=i.replace(/[^0-9a-zA-Z]/g,"")),r.val(i),"-"===i&&(i=null),null===i||i.length===n?e.push({name:"eq",args:[t,i]}):i.length>0&&e.push({name:"regex",args:[t,i]})}})}),define("app/mechOrders/templates/import",["app/i18n"],function(t){return function anonymous(locals,filters,escape,rethrow){escape=escape||function(e){return String(e).replace(/&(?!#?[a-zA-Z0-9]+;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&#39;").replace(/"/g,"&quot;")};var buf=[];with(locals||{})!function(){buf.push('<form class="mechOrders-import">\n  <div class="form-group">\n    <label for="',idPrefix,'-file">',t("mechOrders","import:file"),'</label>\n    <input id="',idPrefix,'-file" name="mechOrders" class="form-control" type="file" autofocus>\n  </div>\n  <div class="form-actions">\n    <button type="submit" class="btn btn-primary">',t("mechOrders","import:submit"),'</button>\n    <button type="button" class="cancel btn btn-link">',t("mechOrders","import:cancel"),"</button>\n  </div>\n</form>\n")}();return buf.join("")}}),define("app/mechOrders/views/MechOrderImportView",["jquery","underscore","app/i18n","app/viewport","app/core/View","app/mechOrders/templates/import"],function(e,t,n,r,i,o){return i.extend({template:o,events:{submit:"upload"},initialize:function(){this.idPrefix=t.uniqueId("mechOrderImport")},serialize:function(){return{idPrefix:this.idPrefix}},onDialogShown:function(e){this.closeDialog=e.closeDialog.bind(e)},closeDialog:function(){},upload:function(t){t.preventDefault();var i=this.$("[type=submit]").attr("disabled",!0),o=new FormData(this.el),a=e.ajax({type:"POST",url:"/mechOrders;import",data:o,processData:!1,contentType:!1}),s=this.closeDialog;a.then(function(){r.msg.show({type:"info",time:2500,text:n("mechOrders","import:msg:success")}),s()}),a.fail(function(){r.msg.show({type:"error",time:5e3,text:n("mechOrders","import:msg:failure")})}),a.always(function(){i.attr("disabled",!1)})}})}),define("app/mechOrders/templates/listPage",["app/i18n"],function(t){return function anonymous(locals,filters,escape,rethrow){escape=escape||function(e){return String(e).replace(/&(?!#?[a-zA-Z0-9]+;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&#39;").replace(/"/g,"&quot;")};var buf=[];with(locals||{})!function(){buf.push('<div>\n  <div class="filter-container"></div>\n  <div class="mechOrders-list-container"></div>\n</div>\n')}();return buf.join("")}}),define("app/mechOrders/pages/MechOrderListPage",["app/i18n","app/viewport","app/core/util/bindLoadingMessage","app/core/View","../MechOrderCollection","../views/MechOrderListView","../views/MechOrderFilterView","../views/MechOrderImportView","app/mechOrders/templates/listPage"],function(e,t,n,r,i,o,a,s,u){return r.extend({template:u,layoutName:"page",pageId:"mechOrderList",breadcrumbs:[e.bound("mechOrders","BREADCRUMBS:browse")],actions:[{label:e.bound("mechOrders","PAGE_ACTION:import"),icon:"refresh",privileges:"ORDERS:MANAGE",callback:function(){return t.showDialog(new s,e("mechOrders","import:title")),!1}}],initialize:function(){this.defineModels(),this.defineViews(),this.setView(".filter-container",this.filterView),this.setView(".mechOrders-list-container",this.listView)},defineModels:function(){this.collection=n(new i(null,{rqlQuery:this.options.rql}),this)},defineViews:function(){this.filterView=new a({model:{rqlQuery:this.collection.rqlQuery}}),this.listView=new o({collection:this.collection}),this.listenTo(this.filterView,"filterChanged",this.refreshList)},load:function(e){return e(this.collection.fetch({reset:!0}))},refreshList:function(e){this.collection.rqlQuery=e,this.listView.refreshCollection(null,!0),this.broker.publish("router.navigate",{url:this.collection.genClientUrl()+"?"+e,trigger:!1,replace:!0})}})}),define("app/orders/templates/operationList",["app/i18n"],function(t){return function anonymous(locals,filters,escape,rethrow){escape=escape||function(e){return String(e).replace(/&(?!#?[a-zA-Z0-9]+;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&#39;").replace(/"/g,"&quot;")};var buf=[];with(locals||{})!function(){buf.push('<div class="panel panel-default orders-operations">\n  <div class="panel-heading">',t("orders","PANEL:TITLE:operations"),"</div>\n  "),operations.length?(buf.push('\n  <table class="table table-condensed table-hover">\n    <thead>\n      <tr>\n        <th>',t("orders","PROPERTY:operations.no"),"\n        <th>",t("orders","PROPERTY:operations.workCenter"),"\n        <th>",t("orders","PROPERTY:operations.name"),"\n        <th>",t("orders","PROPERTY:operations.qty"),"\n        <th>",t("orders","PROPERTY:operations.machineSetupTime"),"\n        <th>",t("orders","PROPERTY:operations.laborSetupTime"),"\n        <th>",t("orders","PROPERTY:operations.machineTime"),"\n        <th>",t("orders","PROPERTY:operations.laborTime"),"\n      </tr>\n    </thead>\n    <tbody>\n      "),operations.forEach(function(e){buf.push('\n      <tr class="',e.no===highlighted?"info":"",'">\n        <td>',escape(e.no||"-"),"\n        <td>",escape(e.workCenter||"-"),"\n        <td>",escape(e.name||"-"),"\n        <td>",escape(e.qtyUnit||"-"),"\n        <td>",escape(e.machineSetupTime||"-"),"\n        <td>",escape(e.laborSetupTime||"-"),"\n        <td>",escape(e.machineTime||"-"),"\n        <td>",escape(e.laborTime||"-"),"\n      </tr>\n      ")}),buf.push("\n    </tbody>\n  </table>\n  ")):buf.push('\n  <div class="panel-body">\n    ',t("orders","OPERATIONS:NO_DATA"),"\n  </div>\n  "),buf.push("\n</div>\n")}();return buf.join("")}}),define("app/orders/views/OperationListView",["app/core/View","app/orders/templates/operationList"],function(e,t){return e.extend({template:t,serialize:function(){return{operations:this.model.get("operations").toJSON(),highlighted:this.options.highlighted}},afterRender:function(){this.listenToOnce(this.model,"change:operations",this.render)}})}),define("app/mechOrders/templates/details",["app/i18n"],function(t){return function anonymous(locals,filters,escape,rethrow){escape=escape||function(e){return String(e).replace(/&(?!#?[a-zA-Z0-9]+;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&#39;").replace(/"/g,"&quot;")};var buf=[];with(locals||{})!function(){buf.push('<div class="panel panel-',panelType,' mechOrders-details">\n  <div class="panel-heading">',panelTitle,'</div>\n  <div class="panel-details">\n    <div class="props first">\n      <div class="prop">\n        <div class="prop-name">',t("mechOrders","PROPERTY:_id"),'</div>\n        <div class="prop-value">',escape(model._id||model.nc12),'</div>\n      </div>\n      <div class="prop">\n        <div class="prop-name">',t("mechOrders","PROPERTY:name"),'</div>\n        <div class="prop-value">',escape(model.name||"-"),'</div>\n      </div>\n      <div class="prop">\n        <div class="prop-name">',t("mechOrders","PROPERTY:materialNorm"),'</div>\n        <div class="prop-value">',escape(model.materialNorm||"-"),'</div>\n      </div>\n      <div class="prop">\n        <div class="prop-name">',t("mechOrders","PROPERTY:mrp"),'</div>\n        <div class="prop-value">',escape(model.mrp||"-"),"</div>\n      </div>\n      "),model.importTs&&buf.push('\n      <div class="prop">\n        <div class="prop-name">',t("mechOrders","PROPERTY:importTs"),'</div>\n        <div class="prop-value">',escape(model.importTs),"</div>\n      </div>\n      "),buf.push("\n    </div>\n  </div>\n</div>\n")}();return buf.join("")}}),define("app/mechOrders/views/MechOrderDetailsView",["app/i18n","app/core/views/DetailsView","app/mechOrders/templates/details"],function(e,t,n){return t.extend({template:n,serialize:function(){return{model:this.model.toJSON(),panelType:this.options.panelType||"primary",panelTitle:this.options.panelTitle||e("mechOrders","PANEL:TITLE:details")}}})}),define("app/mechOrders/templates/detailsPage",["app/i18n"],function(t){return function anonymous(locals,filters,escape,rethrow){escape=escape||function(e){return String(e).replace(/&(?!#?[a-zA-Z0-9]+;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&#39;").replace(/"/g,"&quot;")};var buf=[];with(locals||{})!function(){buf.push('<div>\n  <div class="mechOrders-details-container"></div>\n  <div class="mechOrders-operations-container"></div>\n</div>\n')}();return buf.join("")}}),define("app/mechOrders/pages/MechOrderDetailsPage",["app/core/util/bindLoadingMessage","app/core/pages/DetailsPage","../MechOrder","app/orders/views/OperationListView","app/mechOrders/views/MechOrderDetailsView","app/mechOrders/templates/detailsPage"],function(e,t,n,r,i,o){return t.extend({template:o,pageId:"mechOrderDetails",actions:[],initialize:function(){this.model=e(new n({_id:this.options.modelId}),this),this.detailsView=new i({model:this.model}),this.operationsView=new r({model:this.model}),this.setView(".mechOrders-details-container",this.detailsView),this.setView(".mechOrders-operations-container",this.operationsView)},load:function(e){return e(this.model.fetch())}})}),define("app/nls/mechOrders",["app/nls/locale/en"],function(e){var t={locale:{}};t.locale.en=e;var n=function(e){if(!e)throw new Error("MessageFormat: No data passed to function.")},r=function(e,t){return n(e),e[t]};return{root:{"BREADCRUMBS:browse":function(){return"Mechanical orders"},"MSG:LOADING_FAILURE":function(){return"Failed to load the orders :("},"PAGE_ACTION:import":function(){return"Import orders"},"PANEL:TITLE:details":function(){return"Order's details"},"PANEL:TITLE:operations":function(){return"Order's operations"},"PROPERTY:_id":function(){return"12NC"},"PROPERTY:name":function(){return"Product name"},"PROPERTY:importTs":function(){return"Imported at"},"PROPERTY:mrp":function(){return"MRP Controller"},"PROPERTY:materialNorm":function(){return"Material norm [kg]"},"OPERATIONS:NO_DATA":function(){return"Order does not have any operations."},"FILTER:PLACEHOLDER:_id":function(){return"Any 12NC"},"FILTER:LIMIT":function(){return"Limit"},"FILTER:BUTTON":function(){return"Filter orders"},"import:title":function(){return"Import orders"},"import:file":function(){return"CSV file with the orders:"},"import:submit":function(){return"Import orders"},"import:cancel":function(){return"Cancel"},"import:msg:success":function(){return"Orders were imported successfully :)"},"import:msg:failure":function(){return"Failed to import the orders :("},"list:mrp:set":function(){return"(choose MRP Controller)"},"list:mrp:edit":function(){return"(change MRP Controller)"},"list:mrp:placeholder":function(){return"Choose MRP Controller..."},"list:mrp:failure":function(e){return"Failed to change the MRP Controller for the <em>"+r(e,"nc12")+"</em> order :("}},pl:!0}}),define("app/nls/pl/mechOrders",["app/nls/locale/pl"],function(e){var t={locale:{}};t.locale.pl=e;var n=function(e){if(!e)throw new Error("MessageFormat: No data passed to function.")},r=function(e,t){return n(e),e[t]};return{"BREADCRUMBS:browse":function(){return"Zlecenia działu mechanicznego"},"MSG:LOADING_FAILURE":function(){return"Ładowanie zleceń nie powiodło się :("},"PAGE_ACTION:import":function(){return"Importuj zlecenia"},"PANEL:TITLE:details":function(){return"Szczegóły zlecenia"},"PANEL:TITLE:operations":function(){return"Lista operacji zlecenia"},"PROPERTY:_id":function(){return"12NC"},"PROPERTY:name":function(){return"Nazwa wyrobu"},"PROPERTY:importTs":function(){return"Czas zaimportowania"},"PROPERTY:mrp":function(){return"Kontroler MRP"},"PROPERTY:materialNorm":function(){return"Norma materiałowa [kg]"},"OPERATIONS:NO_DATA":function(){return"Zlecenie nie ma zdefiniowanych żadnych operacji."},"FILTER:PLACEHOLDER:_id":function(){return"Dowolny 12NC"},"FILTER:LIMIT":function(){return"Limit"},"FILTER:BUTTON":function(){return"Filtruj zlecenia"},"import:title":function(){return"Importowanie zleceń"},"import:file":function(){return"Plik CSV ze zleceniami:"},"import:submit":function(){return"Importuj zlecenia"},"import:cancel":function(){return"Anuluj"},"import:msg:success":function(){return"Importowanie zleceń przebiegło pomyślnie :)"},"import:msg:failure":function(){return"Nie udało się zaimportować zleceń :("},"list:mrp:set":function(){return"(wybierz kontroler MRP)"},"list:mrp:edit":function(){return"(zmień kontroler MRP)"},"list:mrp:placeholder":function(){return"Wybierz kontroler MRP..."},"list:mrp:failure":function(e){return"Nie udało się zmienić kontrolera MRP dla zlecenia <em>"+r(e,"nc12")+"</em> :("}}}),define("app/mechOrders/routes",["../router","../viewport","../user","./pages/MechOrderListPage","./pages/MechOrderDetailsPage","i18n!app/nls/mechOrders"],function(e,t,n,r,i){var o=n.auth("ORDERS:VIEW");e.map("/mechOrders",o,function(e){t.showPage(new r({rql:e.rql}))}),e.map("/mechOrders/:id",o,function(e){t.showPage(new i({modelId:e.params.id}))})}),define("app/mrpControllers/templates/details",["app/i18n"],function(t){return function anonymous(locals,filters,escape,rethrow){escape=escape||function(e){return String(e).replace(/&(?!#?[a-zA-Z0-9]+;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&#39;").replace(/"/g,"&quot;")};var buf=[];with(locals||{})!function(){buf.push('<div class="panel panel-primary">\n  <div class="panel-heading">\n    ',t("mrpControllers","PANEL:TITLE:details"),'\n  </div>\n  <div class="panel-details">\n    <div class="props first">\n      <div class="prop">\n        <div class="prop-name">',t("mrpControllers","PROPERTY:subdivision"),'</div>\n        <div class="prop-value">',orgUnitPath||"-",'\n        </div>\n      </div>\n      <div class="prop">\n        <div class="prop-name">',t("mrpControllers","PROPERTY:_id"),'</div>\n        <div class="prop-value">',escape(model._id),'</div>\n      </div>\n      <div class="prop">\n        <div class="prop-name">',t("mrpControllers","PROPERTY:description"),'</div>\n        <div class="prop-value">',escape(model.description||"-"),"</div>\n      </div>\n    </div>\n  </div>\n</div>\n")}();return buf.join("")}}),define("app/mrpControllers/views/MrpControllerDetailsView",["app/i18n","app/data/views/renderOrgUnitPath","app/core/views/DetailsView","app/mrpControllers/templates/details"],function(e,t,n,r){return n.extend({template:r,localTopics:{"divisions.synced":"render","subdivisions.synced":"render"},serialize:function(){var e=n.prototype.serialize.call(this);return e.orgUnitPath=t(this.model,!0),e}})}),define("app/mrpControllers/templates/form",["app/i18n"],function(t){return function anonymous(locals,filters,escape,rethrow){escape=escape||function(e){return String(e).replace(/&(?!#?[a-zA-Z0-9]+;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&#39;").replace(/"/g,"&quot;")};var buf=[];with(locals||{})!function(){buf.push('<form class="mrpControllers-form" method="post" action="',formAction,'">\n  <input type="hidden" name="_method" value="',formMethod,'">\n  <div class="panel panel-primary">\n    <div class="panel-heading">',panelTitleText,'</div>\n    <div class="panel-body">\n      <div class="orgUnitDropdowns-container"></div>\n      <div class="form-group">\n        <label for="',idPrefix,'-_id" class="control-label">',t("mrpControllers","PROPERTY:_id"),'</label>\n        <input id="',idPrefix,'-_id" class="form-control" type="text" name="_id" autofocus required maxlength="50" pattern="^[a-zA-Z][a-zA-Z0-9_-]*$">\n      </div>\n      <div class="form-group">\n        <label for="',idPrefix,'-description" class="control-label">',t("mrpControllers","PROPERTY:description"),'</label>\n        <input id="',idPrefix,'-description" class="form-control" type="text" name="description" required maxlength="150">\n      </div>\n    </div>\n    <div class="panel-footer">\n      <button type="submit" class="btn btn-primary">',formActionText,"</button>\n    </div>\n  </div>\n</form>\n")}();return buf.join("")}}),define("app/mrpControllers/views/MrpControllerFormView",["app/data/views/OrgUnitDropdownsView","app/core/views/FormView","app/mrpControllers/templates/form"],function(e,t,n){return t.extend({template:n,idPrefix:"mrpControllerForm",initialize:function(){t.prototype.initialize.call(this),this.orgUnitDropdownsView=new e({orgUnit:e.ORG_UNIT.SUBDIVISION}),this.setView(".orgUnitDropdowns-container",this.orgUnitDropdownsView)},afterRender:function(){t.prototype.afterRender.call(this),this.options.editMode&&this.$id("_id").attr("disabled",!0),this.listenToOnce(this.orgUnitDropdownsView,"afterRender",function(){this.orgUnitDropdownsView.selectValue(this.model).focus()})}})}),define("app/nls/mrpControllers",["app/nls/locale/en"],function(e){var t={locale:{}};t.locale.en=e;var n=function(e){if(!e)throw new Error("MessageFormat: No data passed to function.")},r=function(e,t){return n(e),e[t]};return{root:{"BREADCRUMBS:browse":function(){return"MRP Controllers"},"BREADCRUMBS:addForm":function(){return"Adding"},"BREADCRUMBS:editForm":function(){return"Editing"},"BREADCRUMBS:ACTION_FORM:delete":function(){return"Deleting"},"MSG:LOADING_FAILURE":function(){return"Failed to load the MRP Controllers :("},"MSG:LOADING_SINGLE_FAILURE":function(){return"Failed to load the MRP Controller :("},"MSG:DELETED":function(e){return"MRP Controller <em>"+r(e,"label")+"</em> was deleted."},"PAGE_ACTION:add":function(){return"Add MRP Controller"},"PAGE_ACTION:edit":function(){return"Edit MRP Controller"},"PAGE_ACTION:delete":function(){return"Delete MRP Controller"},"PANEL:TITLE:details":function(){return"MRP Controller's details"},"PANEL:TITLE:addForm":function(){return"Add MRP Controller form"},"PANEL:TITLE:editForm":function(){return"Edit MRP Controller form"},"PROPERTY:_id":function(){return"ID"},"PROPERTY:description":function(){return"Label"},"PROPERTY:division":function(){return"Division"},"PROPERTY:subdivision":function(){return"Subdivision"},"FORM:ACTION:add":function(){return"Add MRP Controller"},"FORM:ACTION:edit":function(){return"Edit MRP Controller"},"FORM:ERROR:addFailure":function(){return"Failed to add the new MRP Controller :-("},"FORM:ERROR:editFailure":function(){return"Failed to edit the MRP Controller :-("},"ACTION_FORM:DIALOG_TITLE:delete":function(){return"MRP Controller deletion confirmation"},"ACTION_FORM:BUTTON:delete":function(){return"Delete MRP Controller"},"ACTION_FORM:MESSAGE:delete":function(){return"Are you sure you want to delete the chosen MRP Controller?"},"ACTION_FORM:MESSAGE_SPECIFIC:delete":function(e){return"Are you sure you want to delete the <em>"+r(e,"label")+"</em> MRP Controller?"},"ACTION_FORM:MESSAGE_FAILURE:delete":function(){return"Failed to delete the MRP Controller :-("}},pl:!0}}),define("app/nls/pl/mrpControllers",["app/nls/locale/pl"],function(e){var t={locale:{}};t.locale.pl=e;var n=function(e){if(!e)throw new Error("MessageFormat: No data passed to function.")},r=function(e,t){return n(e),e[t]};return{"BREADCRUMBS:browse":function(){return"Kontrolery MRP"},"BREADCRUMBS:addForm":function(){return"Dodawanie"},"BREADCRUMBS:editForm":function(){return"Edycja"},"BREADCRUMBS:ACTION_FORM:delete":function(){return"Usuwanie"},"MSG:LOADING_FAILURE":function(){return"Ładowanie kontrolerów MRP nie powiodło się :("},"MSG:LOADING_SINGLE_FAILURE":function(){return"Ładowanie kontrolera MRP nie powiodło się :("},"MSG:DELETED":function(e){return"Kontroler MRP <em>"+r(e,"label")+"</em> zostało usunięte."},"PAGE_ACTION:add":function(){return"Dodaj kontroler MRP"},"PAGE_ACTION:edit":function(){return"Edytuj kontroler MRP"},"PAGE_ACTION:delete":function(){return"Usuń kontroler MRP"},"PANEL:TITLE:details":function(){return"Szczegóły kontrolera MRP"},"PANEL:TITLE:addForm":function(){return"Formularz dodawania kontrolera MRP"},"PANEL:TITLE:editForm":function(){return"Formularz edycji kontrolera MRP"},"PROPERTY:_id":function(){return"ID"},"PROPERTY:description":function(){return"Opis"},"PROPERTY:division":function(){return"Wydział"},"PROPERTY:subdivision":function(){return"Dział"},"FORM:ACTION:add":function(){return"Dodaj kontroler MRP"},"FORM:ACTION:edit":function(){return"Edytuj kontroler MRP"},"FORM:ERROR:addFailure":function(){return"Nie udało się dodać kontrolera MRP :-("},"FORM:ERROR:editFailure":function(){return"Nie udało się zmodyfikować kontrolera MRP :-("},"ACTION_FORM:DIALOG_TITLE:delete":function(){return"Potwierdzenie usunięcia kontrolera MRP"},"ACTION_FORM:BUTTON:delete":function(){return"Usuń kontroler MRP"},"ACTION_FORM:MESSAGE:delete":function(){return"Czy na pewno chcesz bezpowrotnie usunąć wybrany kontroler MRP?"},"ACTION_FORM:MESSAGE_SPECIFIC:delete":function(e){return"Czy na pewno chcesz bezpowrotnie usunąć kontroler MRP <em>"+r(e,"label")+"</em>?"},"ACTION_FORM:MESSAGE_FAILURE:delete":function(){return"Nie udało się usunąć kontrolera MRP :-("}}}),define("app/mrpControllers/routes",["../router","../viewport","../user","../data/mrpControllers","./MrpController","../core/pages/DetailsPage","../core/pages/AddFormPage","../core/pages/EditFormPage","../core/pages/ActionFormPage","./views/MrpControllerDetailsView","./views/MrpControllerFormView","i18n!app/nls/mrpControllers"],function(e,t,n,r,i,o,a,s,u,l,c){var d=n.auth("DICTIONARIES:VIEW"),p=n.auth("DICTIONARIES:MANAGE");e.map("/mrpControllers",d,function(){t.loadPage(["app/core/pages/ListPage","app/mrpControllers/views/MrpControllerListView"],function(e,t){return new e({ListView:t,collection:r})})}),e.map("/mrpControllers/:id",function(e){t.showPage(new o({DetailsView:l,model:new i({_id:e.params.id})}))}),e.map("/mrpControllers;add",p,function(){t.showPage(new a({FormView:c,model:new i}))}),e.map("/mrpControllers/:id;edit",p,function(e){t.showPage(new s({FormView:c,model:new i({_id:e.params.id})}))}),e.map("/mrpControllers/:id;delete",p,function(e,n){var r=new i({_id:e.params.id});t.showPage(new u({model:r,actionKey:"delete",successUrl:r.genClientUrl("base"),cancelUrl:n||r.genClientUrl("base"),formMethod:"DELETE",formAction:r.url(),formActionSeverity:"danger"}))})}),define("app/orders/Order",["moment","../core/Model","./OperationCollection"],function(e,t,n){return t.extend({urlRoot:"/orders",clientUrlRoot:"#orders",topicPrefix:"orders",privilegePrefix:"ORDERS",nlsDomain:"orders",labelAttribute:"_id",defaults:{nc12:null,name:null,mrp:null,qty:null,unit:null,startDate:null,finishDate:null,statuses:null,operations:null,createdAt:null,updatedAt:null},parse:function(e,r){return e=t.prototype.parse.call(this,e,r),e.operations=new n(e.operations),e},toJSON:function(){var n=t.prototype.toJSON.call(this);return n.startDate&&(n.startDateText=e(n.startDate).format("LL")),n.finishDate&&(n.finishDateText=e(n.finishDate).format("LL")),n.qty&&n.unit&&(n.qtyUnit=n.qty+" "+n.unit),n.createdAt&&(n.createdAtText=e(n.createdAt).format("LLLL")),n.updatedAt&&(n.updatedAtText=e(n.updatedAt).format("LLLL")),n.operations=null===n.operations?[]:n.operations.toJSON(),n}})}),define("app/orders/OrderCollection",["../core/Collection","./Order"],function(e,t){return e.extend({model:t,rqlQuery:function(e){var t=new Date;return t.setHours(0),t.setMinutes(0),t.setSeconds(0),t.setMilliseconds(0),e.Query.fromObject({fields:{nc12:1,name:1,mrp:1,qty:1,unit:1,startDate:1,finishDate:1,statuses:1},limit:15,sort:{startDate:-1,finishDate:-1},selector:{name:"and",args:[{name:"ge",args:["finishDate",t.getTime()]}]}})}})}),define("app/orderStatuses/OrderStatus",["../core/Model"],function(e){return e.extend({urlRoot:"/orderStatuses",clientUrlRoot:"#orderStatuses",topicPrefix:"orderStatuses",privilegePrefix:"DICTIONARIES",nlsDomain:"orderStatuses",labelAttribute:"_id",defaults:{label:null,color:"#999999"},toJSON:function(){var t=e.prototype.toJSON.call(this);return t.label||(t.label=t._id),t}})}),define("app/orderStatuses/OrderStatusCollection",["../core/Collection","./OrderStatus"],function(e,t){return e.extend({model:t,rqlQuery:"select(label,color)&sort(_id)",findAndFill:function(e){var n=this;return e.map(function(e){var r=n.get(e);return r||(r=new t({_id:e})),r.toJSON()})}})}),define("app/data/orderStatuses",["app/orderStatuses/OrderStatusCollection","./createStorage"],function(e,t){return t("ORDER_STATUSES","orderStatuses",e)}),define("app/orderStatuses/templates/_orderStatus",["app/i18n"],function(t){return function anonymous(locals,filters,escape,rethrow){escape=escape||function(e){return String(e).replace(/&(?!#?[a-zA-Z0-9]+;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&#39;").replace(/"/g,"&quot;")};var buf=[];with(locals||{})!function(){buf.push('<span class="label orderStatus" style="background-color: ',color,'" title="',escape(label),'">',escape(_id),"</span>\n")}();return buf.join("")}}),define("app/orders/views/OrderListView",["app/i18n","app/user","app/core/views/ListView","app/data/orderStatuses","app/orderStatuses/templates/_orderStatus"],function(e,t,n,r,i){return n.extend({localTopics:{"orderStatuses.synced":"render"},remoteTopics:{"orders.synced":"refreshCollection","orders.added":"refreshCollection","orders.edited":"refreshCollection","orders.deleted":"onModelDeleted"},serializeColumns:function(){return[{id:"_id",label:e("orders","PROPERTY:_id")},{id:"nc12",label:e("orders","PROPERTY:nc12")},{id:"name",label:e("orders","PROPERTY:name")},{id:"mrp",label:e("orders","PROPERTY:mrp")},{id:"qtyUnit",label:e("orders","PROPERTY:qty")},{id:"startDateText",label:e("orders","PROPERTY:startDate")},{id:"finishDateText",label:e("orders","PROPERTY:finishDate")},{id:"statusLabels",label:e("orders","PROPERTY:statuses")}]},serializeActions:function(){var e=this.collection;return function(t){return[n.actions.viewDetails(e.get(t._id))]}},serializeRows:function(){return this.collection.toJSON().map(function(e){return e.statusLabels=r.findAndFill(e.statuses).map(function(e){return i(e)}).join(""),e})}})}),function(e){var t=function(e,t){var n,r={d:864e5,dy:864e5,day:864e5,days:864e5,h:36e5,hr:36e5,hour:36e5,hours:36e5,m:6e4,min:6e4,minute:6e4,minutes:6e4,s:1e3,sec:1e3,secs:1e3,second:1e3,seconds:1e3},i=e.valueOf(),o=t.toLowerCase().split(" "),a=0,s=1,u=0,l=0,c=-1;for(u=0;u<o.length;u+=1)n=!1,Number(o[u])?a=o[u]:(c=o[u].match(/[a-z]/),c?(l=c.index,n=o[u].substr(l),l>0&&(a=o[u].substr(0,l))):n=o[u],n&&a&&(s=r[n],i+=a*s,a=0,n=!1));return new Date(i)};return e.reltime={parse:t},"undefined"!=typeof exports&&(exports.parse=t),e}(this),define("reltime",function(e){return function(){var t;return t||e.reltime}}(this)),define("app/core/util/fixTimeRange",["underscore","app/time"],function(e,t){function n(e,n){var r;if(e.hasClass("form-group-datetime")){var i=e.find("input[type=date]"),o=e.find("input[type=time]"),a=i.val().trim(),s=o.val().trim();0===s.length&&(s=n),r=t.getMoment(a+" "+s)}else r=t.getMoment(e.val());
var u=r.isValid();if(e.hasClass("form-group-datetime"))e.find("input[type=date]").val(u?r.format("YYYY-MM-DD"):""),e.find("input[type=time]").val(u?r.format("HH:mm"):"");else if(u){var l="";switch(e.attr("type")){case"datetime-local":case"datetime":l=r.toISOString();break;case"date":l=r.format("YYYY-MM-DD");break;case"time":l=r.format("HH:mm");break;default:l=r.format("YYYY-MM-DD HH:mm")}e.val(l)}else e.val("");return r}var r=document.createElement("input");r.setAttribute("type","datetime-local"),r="text"!==r.type;var i={};return i.fromView=function(t,r){r=e.defaults(r||{},{fromId:"from",toId:"to",defaultTime:"00:00"});var i={from:null,to:null},o=n(t.$id(r.fromId),r.defaultTime),a=n(t.$id(r.toId),r.defaultTime);return o.isValid()&&(i.from=o.valueOf()),a.isValid()&&(i.to=a.valueOf()),i},i.toFormData=function(e,n,i){if("select"!==n.name&&"sort"!==n.name){var o="ge"===n.name?"from":"to",a=t.getMoment(n.args[1]);"date+time"===i?(e[o+"-date"]=a.format("YYYY-MM-DD"),e[o+"-time"]=a.format("HH:mm")):e[o]="datetime"===i?r?a.toISOString():a.format("YYYY-MM-DD HH:mm:ss"):a.format("time"===i?"HH:mm:ss":"YYYY-MM-DD")}},i}),define("app/orders/templates/filter",["app/i18n"],function(t){return function anonymous(locals,filters,escape,rethrow){escape=escape||function(e){return String(e).replace(/&(?!#?[a-zA-Z0-9]+;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&#39;").replace(/"/g,"&quot;")};var buf=[];with(locals||{})!function(){buf.push('<div class="well">\n  <form id="',idPrefix,'-form" class="filter-form">\n    <div class="form-group">\n      <label for="',idPrefix,'-_id">',t("orders","PROPERTY:_id"),'</label>\n      <input id="',idPrefix,'-_id" class="form-control orders-filter-_id" name="_id" type="text" minlength="4" maxlength="10" placeholder="',t("orders","FILTER:PLACEHOLDER:_id"),'">\n    </div>\n    <div class="form-group">\n      <label for="',idPrefix,'-nc12">',t("orders","PROPERTY:nc12"),'</label>\n      <input id="',idPrefix,'-nc12" class="form-control orders-filter-nc12" name="nc12" type="text" minlength="3" maxlength="12" placeholder="',t("orders","FILTER:PLACEHOLDER:nc12"),'">\n    </div><div\n      class="form-group orders-filter-date-group">\n      <div>\n        <label>\n          <input id="',idPrefix,'-date-start" name="date" type="radio" value="start">\n          ',t("orders","PROPERTY:startDate"),'\n        </label><label\n          class="orders-filter-date-finish-label">\n          <input id="',idPrefix,'-date-finish" name="date" type="radio" value="finish">\n          ',t("orders","PROPERTY:finishDate"),'\n        </label>\n      </div><div class="orders-filter-date-range">\n        <label for="',idPrefix,'-from">',t("orders","FILTER:DATE:FROM"),'</label>\n        <input id="',idPrefix,'-from" class="form-control" name="from" type="date" placeholder="YYYY-MM-DD">\n        <label for="',idPrefix,'-to" class="control-label">',t("orders","FILTER:DATE:TO"),'</label>\n        <input id="',idPrefix,'-to" class="form-control" name="to" type="date" placeholder="YYYY-MM-DD">\n      </div>\n    </div><div\n      class="form-group">\n      <label for="',idPrefix,'-limit">',t("orders","FILTER:LIMIT"),'</label>\n      <input id="',idPrefix,'-limit" class="form-control" name="limit" type="number" value="25" min="5" max="100" step="1">\n    </div><div\n      class="form-group filter-actions">\n      <input type="submit" class="btn btn-primary" value="',escape(t("orders","FILTER:BUTTON")),'">\n    </div>\n  </form>\n</div>\n')}();return buf.join("")}}),define("app/orders/views/OrderFilterView",["underscore","moment","js2form","reltime","app/i18n","app/core/View","app/core/util/fixTimeRange","app/orders/templates/filter"],function(e,t,n,r,i,o,a,s){return o.extend({template:s,events:{"submit .filter-form":function(e){e.preventDefault(),this.changeFilter()},"change input[name=from]":function(e){var t=this.$("input[name=to]");"true"!==t.attr("data-changed")&&t.val(e.target.value)},"change input[name=to]":function(e){e.target.setAttribute("data-changed","true")}},initialize:function(){this.idPrefix=e.uniqueId("orderFilter")},serialize:function(){return{idPrefix:this.idPrefix}},afterRender:function(){var e=this.serializeRqlQuery();n(this.el.querySelector(".filter-form"),e)},serializeRqlQuery:function(){var t=this.model.rqlQuery,n={_id:"",nc12:"",date:"finish",from:"",to:"",user:"",limit:t.limit<5?5:t.limit>100?100:t.limit,statuses:[]};return t.selector.args.forEach(function(t){var r=t.args[0];switch(r){case"startDate":case"finishDate":a.toFormData(n,t,"date");break;case"_id":case"nc12":var i=t.args[1];n[r]=e.isString(i)?i.replace(/[^0-9]/g,""):"-"}}),n},changeFilter:function(){var e=this.model.rqlQuery,t=a.fromView(this),n=[],r=this.$("input[name=date]:checked").val()+"Date";this.serializeRegexTerm(n,"_id",9),this.serializeRegexTerm(n,"nc12",12),t.from&&n.push({name:"ge",args:[r,t.from]}),t.to&&n.push({name:"le",args:[r,t.to]}),e.selector={name:"and",args:n},e.limit=parseInt(this.$id("limit").val(),10)||15,e.skip=0,this.trigger("filterChanged",e)},serializeRegexTerm:function(e,t,n){var r=this.$id(t),i=r.val().trim();"-"!==i&&(i=i.replace(/[^0-9]/g,"")),r.val(i),"-"===i&&(i=null),null===i||i.length===n?e.push({name:"eq",args:[t,i]}):i.length>0&&e.push({name:"regex",args:[t,i]})}})}),define("app/orders/templates/listPage",["app/i18n"],function(t){return function anonymous(locals,filters,escape,rethrow){escape=escape||function(e){return String(e).replace(/&(?!#?[a-zA-Z0-9]+;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&#39;").replace(/"/g,"&quot;")};var buf=[];with(locals||{})!function(){buf.push('<div>\n  <div class="filter-container"></div>\n  <div class="orders-list-container"></div>\n</div>\n')}();return buf.join("")}}),define("app/orders/pages/OrderListPage",["app/i18n","app/core/util/bindLoadingMessage","app/core/util/pageActions","app/core/View","../OrderCollection","../views/OrderListView","../views/OrderFilterView","app/orders/templates/listPage"],function(e,t,n,r,i,o,a,s){return r.extend({template:s,layoutName:"page",pageId:"orderList",breadcrumbs:[e.bound("orders","BREADCRUMBS:browse")],initialize:function(){this.defineModels(),this.defineViews(),this.setView(".filter-container",this.filterView),this.setView(".orders-list-container",this.listView)},defineModels:function(){this.collection=t(new i(null,{rqlQuery:this.options.rql}),this)},defineViews:function(){this.filterView=new a({model:{rqlQuery:this.collection.rqlQuery}}),this.listView=new o({collection:this.collection}),this.listenTo(this.filterView,"filterChanged",this.refreshList)},load:function(e){return e(this.collection.fetch({reset:!0}))},refreshList:function(e){this.collection.rqlQuery=e,this.listView.refreshCollection(null,!0),this.broker.publish("router.navigate",{url:this.collection.genClientUrl()+"?"+e,trigger:!1,replace:!0})}})}),define("app/orders/templates/details",["app/i18n"],function(t){return function anonymous(locals,filters,escape,rethrow){escape=escape||function(e){return String(e).replace(/&(?!#?[a-zA-Z0-9]+;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&#39;").replace(/"/g,"&quot;")};var buf=[];with(locals||{})!function(){buf.push('<div class="panel panel-',panelType,' orders-details">\n  <div class="panel-heading">',panelTitle,'</div>\n  <div class="panel-details row">\n    <div class="col-md-4">\n      <div class="props first">\n        <div class="prop">\n          <div class="prop-name">',t("orders","PROPERTY:_id"),'</div>\n          <div class="prop-value">',escape(model._id),'</div>\n        </div>\n        <div class="prop">\n          <div class="prop-name">',t("orders","PROPERTY:nc12"),'</div>\n          <div class="prop-value">',escape(model.nc12||"-"),'</div>\n        </div>\n        <div class="prop">\n          <div class="prop-name">',t("orders","PROPERTY:name"),'</div>\n          <div class="prop-value">',escape(model.name||"-"),'</div>\n        </div>\n      </div>\n    </div>\n    <div class="col-md-4">\n      <div class="props">\n        <div class="prop">\n          <div class="prop-name">',t("orders","PROPERTY:mrp"),'</div>\n          <div class="prop-value">',escape(model.mrp||"-"),'</div>\n        </div>\n        <div class="prop">\n          <div class="prop-name">',t("orders","PROPERTY:qty"),'</div>\n          <div class="prop-value">',escape(model.qtyUnit||"-"),'</div>\n        </div>\n        <div class="prop">\n          <div class="prop-name">',t("orders","PROPERTY:statuses"),'</div>\n          <div class="prop-value">',model.statusLabels,'</div>\n        </div>\n      </div>\n    </div>\n    <div class="col-md-4">\n      <div class="props">\n        <div class="prop">\n          <div class="prop-name">',t("orders","PROPERTY:startDate"),'</div>\n          <div class="prop-value">',escape(model.startDateText||"-"),'</div>\n        </div>\n        <div class="prop">\n          <div class="prop-name">',t("orders","PROPERTY:finishDate"),'</div>\n          <div class="prop-value">',escape(model.finishDateText||"-"),'</div>\n        </div>\n        <div class="prop">\n          <div class="prop-name">',t("orders","PROPERTY:createdAt"),'</div>\n          <div class="prop-value">',escape(model.createdAtText||"-"),"</div>\n        </div>\n        "),model.updatedAtText&&buf.push('\n        <div class="prop">\n          <div class="prop-name">',t("orders","PROPERTY:updatedAt"),'</div>\n          <div class="prop-value">',escape(model.updatedAtText),"</div>\n        </div>\n        "),buf.push("\n      </div>\n    </div>\n  </div>\n</div>\n")}();return buf.join("")}}),define("app/orders/views/OrderDetailsView",["app/i18n","app/core/views/DetailsView","app/data/orderStatuses","app/orders/templates/details","app/orderStatuses/templates/_orderStatus"],function(e,t,n,r,i){return t.extend({template:r,localTopics:{"orderStatuses.synced":"render"},serialize:function(){var t=this.model.toJSON();return t.statusLabels=n.findAndFill(t.statuses).map(function(e){return i(e)}).join(""),{model:t,panelType:this.options.panelType||"primary",panelTitle:this.options.panelTitle||e("orders","PANEL:TITLE:details")}}})}),define("app/orders/templates/changes",["app/i18n"],function(t){return function anonymous(locals,filters,escape,rethrow){escape=escape||function(e){return String(e).replace(/&(?!#?[a-zA-Z0-9]+;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&#39;").replace(/"/g,"&quot;")};var buf=[];with(locals||{})!function(){buf.push('<div class="panel panel-default orders-changes">\n  <div class="panel-heading">\n    ',t("orders","PANEL:TITLE:changes"),"\n  </div>\n  "),changes.length?(buf.push('\n  <table class="table table-condensed">\n    <thead>\n      <tr>\n        <th>',t("orders","CHANGES:time"),"\n        <th>",t("orders","CHANGES:property"),"\n        <th>",t("orders","CHANGES:oldValue"),"\n        <th>",t("orders","CHANGES:newValue"),"\n      </tr>\n    </thead>\n    "),changes.length>5&&buf.push('\n    <tfoot>\n      <tr>\n        <td class="orders-changes-more" colspan="4">Pokaż starsze zmiany...</td>\n      </tr>\n    </tfoot>\n    '),buf.push("\n    "),changes.forEach(function(e,n){buf.push("\n    "),n%5===0&&buf.push('\n    <tbody class="orders-changes-page ',n?"hidden":"",'">\n    '),buf.push('\n      <tr>\n        <td rowspan="',e.values.length,'">',e.timeText,'</td>\n        <td class="orders-changes-property">',escape(t("orders","PROPERTY:"+e.values[0].property)),"</td>\n        <td>",renderValueChange(e.values[0],n,"oldValue"),"</td>\n        <td>",renderValueChange(e.values[0],n,"newValue"),"</td>\n      </tr>\n      "),e.values.forEach(function(e,r){buf.push("\n      "),0!==r&&buf.push('\n      <tr>\n        <td class="orders-changes-property">',escape(t("orders","PROPERTY:"+e.property)),"</td>\n        <td>",renderValueChange(e,n,"oldValue"),"</td>\n        <td>",renderValueChange(e,n,"newValue"),"</td>\n      </tr>\n      ")}),buf.push("\n    ")}),buf.push("\n  </table>\n  ")):buf.push('\n  <div class="panel-body">\n    ',t("orders","CHANGES:NO_DATA"),"\n  </div>\n  "),buf.push("\n</div>\n")}();return buf.join("")}}),define("app/orders/views/OrderChangesView",["underscore","jquery","moment","app/i18n","app/viewport","app/data/orderStatuses","app/core/View","./OperationListView","../Order","../OperationCollection","app/orders/templates/changes","app/orderStatuses/templates/_orderStatus"],function(e,t,n,r,i,o,a,s,u,l,c,d){return a.extend({template:c,events:{"click .orders-changes-more":"showMoreChanges","click .orders-changes-operations":"toggleOperations"},initialize:function(){this.$lastToggle=null,this.operationListView=null},destroy:function(){null!==this.$lastToggle&&this.$lastToggle.click()},serialize:function(){return{changes:(this.model.get("changes")||[]).reverse().map(function(e){return e.timeText=n(e.time).format("YYYY-MM-DD HH:mm:ss"),e.values=Object.keys(e.oldValues||{}).map(function(t){return{property:t,oldValue:e.oldValues[t],newValue:e.newValues[t]}}),e}).filter(function(e){return e.values.length}),renderValueChange:this.renderValueChange}},afterRender:function(){this.listenToOnce(this.model,"change:changes",this.render)},renderValueChange:function(t,i,a){var s=t[a];if(null==s||0===s.length)return"-";switch(t.property){case"operations":return'<a class="orders-changes-operations" data-i="'+i+'" data-property="'+a+'">'+r("orders","CHANGES:operations",{count:s.length})+"</a>";case"statuses":return o.findAndFill(s).map(function(e){return d(e)}).join("");case"startDate":case"finishDate":return n(s).format("LL");default:return e.escape(String(s))}},showMoreChanges:function(){var e=this.$(".orders-changes-page.hidden");e.first().removeClass("hidden"),1===e.length&&this.$(".orders-changes-more").hide()},toggleOperations:function(e){if(null!==this.$lastToggle){if(this.$lastToggle[0]===e.target)return this.$lastToggle=null,void this.operationListView.remove();this.$lastToggle.click()}var n=t(e.target),r=n.attr("data-i"),i=n.attr("data-property")+"s",o=new l(this.model.get("changes")[r][i].operations),a=new s({model:new u({operations:o})}),c=n.closest("tr")[0].offsetTop+41+31;a.render(),a.$el.css("top",c),this.$el.append(a.$el),this.$lastToggle=n,this.operationListView=a}})}),define("app/orders/templates/detailsPage",["app/i18n"],function(t){return function anonymous(locals,filters,escape,rethrow){escape=escape||function(e){return String(e).replace(/&(?!#?[a-zA-Z0-9]+;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&#39;").replace(/"/g,"&quot;")};var buf=[];with(locals||{})!function(){buf.push('<div>\n  <div class="orders-details-container"></div>\n  <div class="orders-operations-container"></div>\n  <div class="orders-changes-container"></div>\n</div>\n')}();return buf.join("")}}),define("app/orders/pages/OrderDetailsPage",["app/core/util/bindLoadingMessage","app/core/pages/DetailsPage","../Order","../views/OrderDetailsView","../views/OperationListView","../views/OrderChangesView","app/orders/templates/detailsPage"],function(e,t,n,r,i,o,a){return t.extend({template:a,pageId:"orderDetails",actions:[],initialize:function(){this.model=e(new n({_id:this.options.modelId}),this),this.detailsView=new r({model:this.model}),this.operationsView=new i({model:this.model}),this.changesView=new o({model:this.model}),this.setView(".orders-details-container",this.detailsView),this.setView(".orders-operations-container",this.operationsView),this.setView(".orders-changes-container",this.changesView)},load:function(e){return e(this.model.fetch())}})}),define("app/nls/orders",["app/nls/locale/en"],function(e){var t={locale:{}};t.locale.en=e;var n=function(e){if(!e)throw new Error("MessageFormat: No data passed to function.")},r=function(e,t,n){if(isNaN(e[t]))throw new Error("MessageFormat: `"+t+"` isnt a number.");return e[t]-(n||0)},i=function(e,r,i,o,a){return n(e),e[r]in a?a[e[r]]:(r=t.locale[o](e[r]-i),r in a?a[r]:a.other)};return{root:{"BREADCRUMBS:browse":function(){return"Production orders"},"MSG:LOADING_FAILURE":function(){return"Failed to load the orders :("},"PANEL:TITLE:details":function(){return"Order's details"},"PANEL:TITLE:operations":function(){return"Order's operations"},"PANEL:TITLE:changes":function(){return"Change log"},"PROPERTY:_id":function(){return"Order no"},"PROPERTY:createdAt":function(){return"Created at"},"PROPERTY:updatedAt":function(){return"Updated at"},"PROPERTY:nc12":function(){return"12NC"},"PROPERTY:name":function(){return"Product name"},"PROPERTY:mrp":function(){return"MRP"},"PROPERTY:qty":function(){return"Quantity"},"PROPERTY:unit":function(){return"Unit"},"PROPERTY:startDate":function(){return"Start date"},"PROPERTY:finishDate":function(){return"Finish date"},"PROPERTY:statuses":function(){return"Status"},"PROPERTY:operations":function(){return"Operations"},"PROPERTY:operations.no":function(){return"Operation no"},"PROPERTY:operations.workCenter":function(){return"WorkCenter"},"PROPERTY:operations.name":function(){return"Name"},"PROPERTY:operations.qty":function(){return"Quantity"},"PROPERTY:operations.unit":function(){return"Unit"},"PROPERTY:operations.machineSetupTime":function(){return"<em>Machine Setup</em> Time"},"PROPERTY:operations.laborSetupTime":function(){return"<em>Labor Setup</em> Time"},"PROPERTY:operations.machineTime":function(){return"<em>Machine</em> Time"},"PROPERTY:operations.laborTime":function(){return"<em>Labor</em> Time"},"OPERATIONS:NO_DATA":function(){return"Order does not have any operations."},"CHANGES:NO_DATA":function(){return"Order was not modified."},"CHANGES:operations":function(e){return i(e,"count",0,"en",{one:"1 operation",other:r(e,"count")+" operations"})},"CHANGES:time":function(){return"Time"},"CHANGES:user":function(){return"User"},"CHANGES:property":function(){return"Property"},"CHANGES:oldValue":function(){return"Old value"},"CHANGES:newValue":function(){return"New value"},"FILTER:PLACEHOLDER:_id":function(){return"Any no"},"FILTER:PLACEHOLDER:nc12":function(){return"Any 12NC"},"FILTER:DATE:FROM":function(){return"From:"},"FILTER:DATE:TO":function(){return"To:"},"FILTER:LIMIT":function(){return"Limit"},"FILTER:BUTTON":function(){return"Filter orders"}},pl:!0}}),define("app/nls/pl/orders",["app/nls/locale/pl"],function(e){var t={locale:{}};t.locale.pl=e;var n=function(e){if(!e)throw new Error("MessageFormat: No data passed to function.")},r=function(e,t,n){if(isNaN(e[t]))throw new Error("MessageFormat: `"+t+"` isnt a number.");return e[t]-(n||0)},i=function(e,r,i,o,a){return n(e),e[r]in a?a[e[r]]:(r=t.locale[o](e[r]-i),r in a?a[r]:a.other)};return{"BREADCRUMBS:browse":function(){return"Zlecenia reszty działów"},"MSG:LOADING_FAILURE":function(){return"Ładowanie zleceń nie powiodło się :("},"PANEL:TITLE:details":function(){return"Szczegóły zlecenia"},"PANEL:TITLE:operations":function(){return"Lista operacji zlecenia"},"PANEL:TITLE:changes":function(){return"Historia zmian zlecenia"},"PROPERTY:_id":function(){return"Nr zlecenia"},"PROPERTY:createdAt":function(){return"Czas stworzenia"},"PROPERTY:updatedAt":function(){return"Czas aktualizacji"},"PROPERTY:nc12":function(){return"12NC"},"PROPERTY:name":function(){return"Nazwa wyrobu"},"PROPERTY:mrp":function(){return"MRP"},"PROPERTY:qty":function(){return"Ilość"},"PROPERTY:unit":function(){return"Jednostka"},"PROPERTY:startDate":function(){return"Data startu"},"PROPERTY:finishDate":function(){return"Data ukończenia"},"PROPERTY:statuses":function(){return"Status"},"PROPERTY:operations":function(){return"Operacje"},"PROPERTY:operations.no":function(){return"Nr operacji"},"PROPERTY:operations.workCenter":function(){return"WorkCenter"},"PROPERTY:operations.name":function(){return"Nazwa operacji"},"PROPERTY:operations.qty":function(){return"Ilość"},"PROPERTY:operations.unit":function(){return"Jednostka"},"PROPERTY:operations.machineSetupTime":function(){return"Czas <em>Machine Setup</em>"},"PROPERTY:operations.laborSetupTime":function(){return"Czas <em>Labor Setup</em>"},"PROPERTY:operations.machineTime":function(){return"Czas <em>Machine</em>"},"PROPERTY:operations.laborTime":function(){return"Czas <em>Labor</em>"},"OPERATIONS:NO_DATA":function(){return"Zlecenie nie ma zdefiniowanych żadnych operacji."},"CHANGES:NO_DATA":function(){return"Zlecenie nie było modyfikowane."},"CHANGES:operations":function(e){return i(e,"count",0,"pl",{one:"1 operacja",few:r(e,"count")+" operacje",other:r(e,"count")+" operacji"})},"CHANGES:time":function(){return"Czas"},"CHANGES:user":function(){return"Użytkownik"},"CHANGES:property":function(){return"Atrybut"},"CHANGES:oldValue":function(){return"Stara wartość"},"CHANGES:newValue":function(){return"Nowa wartość"},"FILTER:PLACEHOLDER:_id":function(){return"Dowolny nr"},"FILTER:PLACEHOLDER:nc12":function(){return"Dowolny 12NC"},"FILTER:DATE:FROM":function(){return"Od:"},"FILTER:DATE:TO":function(){return"Do:"},"FILTER:LIMIT":function(){return"Limit"},"FILTER:BUTTON":function(){return"Filtruj zlecenia"}}}),define("app/orders/routes",["../router","../viewport","../user","./pages/OrderListPage","./pages/OrderDetailsPage","i18n!app/nls/orders"],function(e,t,n,r,i){var o=n.auth("ORDERS:VIEW");e.map("/orders",o,function(e){t.showPage(new r({rql:e.rql}))}),e.map("/orders/:id",function(e){t.showPage(new i({modelId:e.params.id}))})}),define("app/nls/orderStatuses",["app/nls/locale/en"],function(e){var t={locale:{}};t.locale.en=e;var n=function(e){if(!e)throw new Error("MessageFormat: No data passed to function.")},r=function(e,t){return n(e),e[t]};return{root:{"BREADCRUMBS:browse":function(){return"Order statuses"},"BREADCRUMBS:addForm":function(){return"Adding"},"BREADCRUMBS:editForm":function(){return"Editing"},"BREADCRUMBS:ACTION_FORM:delete":function(){return"Deleting"},"MSG:LOADING_FAILURE":function(){return"Failed to load the order statuses :("},"MSG:LOADING_SINGLE_FAILURE":function(){return"Failed to load the order status :("},"MSG:DELETED":function(e){return"Order status <em>"+r(e,"label")+"</em> was deleted."},"PAGE_ACTION:add":function(){return"Add order status"},"PAGE_ACTION:edit":function(){return"Edit order status"},"PAGE_ACTION:delete":function(){return"Delete order status"},"PANEL:TITLE:details":function(){return"Order status' details"},"PANEL:TITLE:addForm":function(){return"Add order status form"},"PANEL:TITLE:editForm":function(){return"Edit order status form"},"PROPERTY:_id":function(){return"Label"},"PROPERTY:label":function(){return"Description"},"PROPERTY:color":function(){return"Color"},"FORM:ACTION:add":function(){return"Add order status"},"FORM:ACTION:edit":function(){return"Edit order status"},"FORM:ERROR:addFailure":function(){return"Failed to add the new order status :-("},"FORM:ERROR:editFailure":function(){return"Failed to edit the order status :-("},"ACTION_FORM:DIALOG_TITLE:delete":function(){return"Order status deletion confirmation"},"ACTION_FORM:BUTTON:delete":function(){return"Delete order status"},"ACTION_FORM:MESSAGE:delete":function(){return"Are you sure you want to delete the chosen order status?"},"ACTION_FORM:MESSAGE_SPECIFIC:delete":function(e){return"Are you sure you want to delete the <em>"+r(e,"label")+"</em> order status?"},"ACTION_FORM:MESSAGE_FAILURE:delete":function(){return"Failed to delete the order status :-("}},pl:!0}}),define("app/nls/pl/orderStatuses",["app/nls/locale/pl"],function(e){var t={locale:{}};t.locale.pl=e;var n=function(e){if(!e)throw new Error("MessageFormat: No data passed to function.")},r=function(e,t){return n(e),e[t]};return{"BREADCRUMBS:browse":function(){return"Statusy zleceń"},"BREADCRUMBS:addForm":function(){return"Dodawanie"},"BREADCRUMBS:editForm":function(){return"Edycja"},"BREADCRUMBS:ACTION_FORM:delete":function(){return"Usuwanie"},"MSG:LOADING_FAILURE":function(){return"Ładowanie statusów zleceń nie powiodło się :("},"MSG:LOADING_SINGLE_FAILURE":function(){return"Ładowanie statusu zleceń nie powiodło się :("},"MSG:DELETED":function(e){return"Status zleceń <em>"+r(e,"label")+"</em> został usunięty."},"PAGE_ACTION:add":function(){return"Dodaj status zleceń"},"PAGE_ACTION:edit":function(){return"Edytuj status zleceń"},"PAGE_ACTION:delete":function(){return"Usuń status zleceń"},"PANEL:TITLE:details":function(){return"Szczegóły statusu zleceń"},"PANEL:TITLE:addForm":function(){return"Formularz dodawania statusu zleceń"},"PANEL:TITLE:editForm":function(){return"Formularz edycji statusu zleceń"},"PROPERTY:_id":function(){return"Etykieta"},"PROPERTY:label":function(){return"Opis"},"PROPERTY:color":function(){return"Kolor"},"FORM:ACTION:add":function(){return"Dodaj status zleceń"},"FORM:ACTION:edit":function(){return"Edytuj status zleceń"},"FORM:ERROR:addFailure":function(){return"Nie udało się dodać statusu zleceń :-("},"FORM:ERROR:editFailure":function(){return"Nie udało się zmodyfikować statusu zleceń :-("},"ACTION_FORM:DIALOG_TITLE:delete":function(){return"Potwierdzenie usunięcia statusu zleceń"},"ACTION_FORM:BUTTON:delete":function(){return"Usuń status zleceń"},"ACTION_FORM:MESSAGE:delete":function(){return"Czy na pewno chcesz bezpowrotnie usunąć wybrany status zleceń?"},"ACTION_FORM:MESSAGE_SPECIFIC:delete":function(e){return"Czy na pewno chcesz bezpowrotnie usunąć status zleceń <em>"+r(e,"label")+"</em>?"},"ACTION_FORM:MESSAGE_FAILURE:delete":function(){return"Nie udało się usunąć statusu zleceń :-("}}}),define("app/orderStatuses/routes",["../router","../viewport","../user","../core/util/showDeleteFormPage","../data/orderStatuses","./OrderStatus","i18n!app/nls/orderStatuses"],function(e,t,n,r,i,o){var a=n.auth("DICTIONARIES:VIEW"),s=n.auth("DICTIONARIES:MANAGE");e.map("/orderStatuses",a,function(){t.loadPage(["app/core/pages/ListPage","app/orderStatuses/views/OrderStatusListView"],function(e,t){return new e({ListView:t,collection:i})})}),e.map("/orderStatuses/:id",function(e){t.loadPage(["app/core/pages/DetailsPage","app/orderStatuses/templates/details"],function(t,n){return new t({model:new o({_id:e.params.id}),detailsTemplate:n})})}),e.map("/orderStatuses;add",s,function(){t.loadPage(["app/core/pages/AddFormPage","app/orderStatuses/views/OrderStatusFormView"],function(e,t){return new e({FormView:t,model:new o})})}),e.map("/orderStatuses/:id;edit",s,function(e){t.loadPage(["app/core/pages/EditFormPage","app/orderStatuses/views/OrderStatusFormView"],function(t,n){return new t({FormView:n,model:new o({_id:e.params.id})})})}),e.map("/orderStatuses/:id;delete",s,r.bind(null,o))}),define("app/pressWorksheets/PressWorksheet",["../time","../core/Model"],function(e,t){return t.extend({urlRoot:"/pressWorksheets",clientUrlRoot:"#pressWorksheets",topicPrefix:"pressWorksheets",privilegePrefix:"PRESS_WORKSHEETS",nlsDomain:"pressWorksheets",labelAttribute:"rid",defaults:function(){return{rid:null,date:e.format("YYYY-MM-DD"),shift:1,type:"mech",startedAt:null,finishedAt:null,master:null,operator:null,operators:null,orders:null,createdAt:null,creator:null}}})}),define("app/pressWorksheets/PressWorksheetCollection",["underscore","../core/Collection","./PressWorksheet"],function(e,t,n){return t.extend({model:n,rqlQuery:"select(rid,type,date,shift,master,operator,createdAt,creator)&sort(-date)&limit(15)",sync:function(n,r,i){if("read"===n&&!i.data){var o=e.find(this.rqlQuery.selector.args,function(e){return"eq"===e.name&&"user"===e.args[0]});o&&(this.rqlQuery.selector.args=e.without(this.rqlQuery.selector.args,o)),i.data=this.rqlQuery.toString(),o&&this.rqlQuery.selector.args.push(o)}return t.prototype.sync.call(this,n,r,i)}})}),define("app/pressWorksheets/templates/filter",["app/i18n"],function(t){return function anonymous(locals,filters,escape,rethrow){escape=escape||function(e){return String(e).replace(/&(?!#?[a-zA-Z0-9]+;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&#39;").replace(/"/g,"&quot;")};var buf=[];with(locals||{})!function(){buf.push('<div class="well">\n  <form id="',idPrefix,'-form" class="filter-form">\n    <div class="form-group">\n      <label for="',idPrefix,'-date">',t("pressWorksheets","FILTER:DATE"),'</label>\n      <input id="',idPrefix,'-date" class="form-control" name="date" type="date">\n    </div><div\n      class="form-group">\n      <label>',t("pressWorksheets","FILTER:SHIFT"),'</label>\n      <div id="',idPrefix,'-shift" class="btn-group filter-btn-group" data-toggle="buttons">\n        <label class="btn btn-default">\n          <input type="radio" name="shift" value="0"> ',t("core","SHIFT:ANY"),'\n        </label>\n        <label class="btn btn-default">\n          <input type="radio" name="shift" value="1"> ',t("core","SHIFT:1"),'\n        </label>\n        <label class="btn btn-default">\n          <input type="radio" name="shift" value="2"> ',t("core","SHIFT:2"),'\n        </label>\n        <label class="btn btn-default">\n          <input type="radio" name="shift" value="3"> ',t("core","SHIFT:3"),'\n        </label>\n      </div>\n    </div><div\n      class="form-group">\n      <label>',t("pressWorksheets","PROPERTY:type"),'</label>\n      <div id="',idPrefix,'-type" class="btn-group filter-btn-group" data-toggle="buttons">\n        <label class="btn btn-default">\n          <input type="radio" name="type" value="any"> ',t("pressWorksheets","FILTER:type:any"),'\n        </label>\n        <label class="btn btn-default" title="',t("pressWorksheets","PROPERTY:type:mech"),'">\n          <input type="radio" name="type" value="mech"> ',t("pressWorksheets","FILTER:type:mech"),'\n        </label>\n        <label class="btn btn-default" title="',t("pressWorksheets","PROPERTY:type:paintShop"),'">\n          <input type="radio" name="type" value="paintShop"> ',t("pressWorksheets","FILTER:type:paintShop"),'\n        </label>\n        <label class="btn btn-default" title="',t("pressWorksheets","PROPERTY:type:optics"),'">\n          <input type="radio" name="type" value="optics"> ',t("pressWorksheets","FILTER:type:optics"),'\n        </label>\n      </div>\n    </div><div class="form-group">\n      <div class="filter-radioLabels"><label>\n          <input name="userType" type="radio" value="master">\n          ',t("pressWorksheets","FILTER:user:master"),'\n        </label><label>\n          <input name="userType" type="radio" value="operators">\n          ',t("pressWorksheets","FILTER:user:operators"),'\n        </label>\n      </div>\n      <input id="',idPrefix,'-user" name="user" type="hidden" data-placeholder="',escape(t("pressWorksheets","FILTER:user:placeholder")),'">\n    </div><div\n      class="form-group">\n      <label for="',idPrefix,'-limit">',t("pressWorksheets","FILTER:LIMIT"),'</label>\n      <input id="',idPrefix,'-limit" class="form-control" name="limit" type="number" value="25" min="5" max="100" step="1">\n    </div><div\n      class="form-group">\n      <label>&nbsp;</label>\n      <div id="',idPrefix,'-mine" class="btn-group filter-btn-group" data-toggle="buttons">\n        <label class="btn btn-default" title="',t("pressWorksheets","FILTER:mine:title"),'">\n          <input type="checkbox" name="mine" value="1"> ',t("pressWorksheets","FILTER:mine"),'\n        </label>\n      </div>\n    </div><div\n      class="form-group filter-actions">\n      <input type="submit" class="btn btn-primary" value="',escape(t("pressWorksheets","FILTER:BUTTON")),'">\n    </div>\n  </form>\n</div>\n')}();return buf.join("")}}),define("app/pressWorksheets/views/PressWorksheetFilterView",["underscore","js2form","app/i18n","app/user","app/time","app/core/Model","app/core/View","app/users/util/setUpUserSelect2","app/pressWorksheets/templates/filter"],function(e,t,n,r,i,o,a,s,u){return a.extend({template:u,events:{"submit .filter-form":function(e){e.preventDefault(),this.changeFilter()}},initialize:function(){this.idPrefix=e.uniqueId("pressWorksheetsFilter")},serialize:function(){return{idPrefix:this.idPrefix}},afterRender:function(){var e=this.serializeRqlQuery();t(this.el.querySelector(".filter-form"),e),this.toggleButtonGroup("shift"),this.toggleButtonGroup("type"),this.toggleButtonGroup("mine"),s(this.$id("user")).select2("data",null===e.user.id?null:e.user)
},toggleButtonGroup:function(e){this.$id(e).find("input:checked").parent().addClass("active")},serializeRqlQuery:function(){var e=this.model.rqlQuery,t={date:"",shift:0,type:"any",limit:e.limit<5?5:e.limit>100?100:e.limit,mine:!1,userType:"operators",user:{id:null,text:null}},n=this;return e.selector.args.forEach(function(e){if("eq"===e.name||"in"===e.name){var r=e.args[0];switch(r){case"date":if("in"===e.name)t.date=i.format(e.args[1][0],"YYYY-MM-DD");else{var o=i.getMoment(e.args[1]);t.date=o.format("YYYY-MM-DD"),t.shift=n.getShiftNoFromMoment(o)}break;case"shift":case"type":case"mine":t[r]=e.args[1];break;case"master.id":case"operator.id":case"operators.id":t.userType=r.split(".")[0],t.user.id=e.args[1],null===t.user.text&&(t.user.text=e.args[1]);break;case"user":t.user.text=e.args[1]}}}),t},changeFilter:function(){var e=this.model.rqlQuery,t=[],n=i.getMoment(this.$id("date").val()),r=parseInt(this.$("input[name=shift]:checked").val(),10),o=this.$("input[name=type]:checked").val(),a=this.$("input[name=mine]:checked").val(),s=this.$("input[name=userType]:checked").val(),u=this.$id("user").select2("data");if(this.setHoursByShiftNo(n,r),n.isValid())if(0===r){var l=n.valueOf();t.push({name:"in",args:["date",[l+216e5,l+504e5,l+792e5]]})}else t.push({name:"eq",args:["date",n.valueOf()]});else 0!==r&&t.push({name:"eq",args:["shift",r]});"any"!==o&&t.push({name:"eq",args:["type",o]}),u&&(t.push({name:"eq",args:[s+".id",u.id]}),t.push({name:"eq",args:["user",u.text]})),a?(t.push({name:"eq",args:["mine",1]}),e.sort={createdAt:-1}):e.sort={date:-1},e.selector={name:"and",args:t},e.limit=parseInt(this.$id("limit").val(),10)||15,e.skip=0,this.trigger("filterChanged",e)},getShiftNoFromMoment:function(e){var t=e.hours();return 6===t?1:14===t?2:22===t?3:0},setHoursByShiftNo:function(e,t){e.hours(1===t?6:2===t?14:3===t?22:0)}})}),define("app/pressWorksheets/views/decoratePressWorksheet",["app/time","app/i18n"],function(e,t){function n(e){return e&&e.label?e.label:null}return function(r){var i=r.toJSON();return i.date=e.format(i.date,"YYYY-MM-DD"),i.shift=t("core","SHIFT:"+i.shift),i.master=n(i.master),i.operator=n(i.operator),i.operators=(i.operators||[]).map(n).filter(function(e){return!!e}),i.creator=n(i.creator),i.createdAt=i.createdAt?e.format(i.createdAt,"LLLL"):null,"paintShop"===i.type&&i.orders&&(i.orders=i.orders.map(function(t){return t.startedAt=e.getMoment(t.startedAt).format("HH:mm:ss"),t.finishedAt=e.getMoment(t.finishedAt).format("HH:mm:ss"),t})),i.type=t("pressWorksheets","PROPERTY:type:"+i.type),i}}),define("app/pressWorksheets/views/PressWorksheetListView",["app/i18n","app/user","app/core/views/ListView","./decoratePressWorksheet"],function(e,t,n,r){return n.extend({localTopics:{"companies.synced":"render"},columns:["rid","type","date","shift","master","operator"],serializeActions:function(){function e(e){return i?!0:t.isAllowedTo("PRESS_WORKSHEETS:MANAGE")&&t.data._id===e.get("creator").id&&Date.parse(e.get("createdAt"))+o>a}var r=this.collection,i=t.isAllowedTo("PROD_DATA:MANAGE"),o=288e5,a=Date.now();return function(t){var i=r.get(t._id),o=[n.actions.viewDetails(i)];return e(i)&&(o.push(n.actions.edit(i)),o.push(n.actions.delete(i))),o}},serializeRows:function(){return this.collection.map(r)}})}),define("app/pressWorksheets/templates/listPage",["app/i18n"],function(t){return function anonymous(locals,filters,escape,rethrow){escape=escape||function(e){return String(e).replace(/&(?!#?[a-zA-Z0-9]+;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&#39;").replace(/"/g,"&quot;")};var buf=[];with(locals||{})!function(){buf.push('<div>\n  <div class="filter-container"></div>\n  <div class="pressWorksheets-list-container"></div>\n</div>\n')}();return buf.join("")}}),define("app/pressWorksheets/pages/PressWorksheetListPage",["app/i18n","app/core/util/bindLoadingMessage","app/core/util/pageActions","app/core/View","../PressWorksheetCollection","../views/PressWorksheetFilterView","../views/PressWorksheetListView","app/pressWorksheets/templates/listPage"],function(e,t,n,r,i,o,a,s){return r.extend({template:s,layoutName:"page",pageId:"pressWorksheetList",breadcrumbs:[e.bound("pressWorksheets","BREADCRUMBS:browse")],actions:function(){return[n.jump(this,this.pressWorksheetList),n.add(this.pressWorksheetList)]},initialize:function(){this.defineModels(),this.defineViews(),this.setView(".filter-container",this.filterView),this.setView(".pressWorksheets-list-container",this.listView)},defineModels:function(){this.pressWorksheetList=t(new i(null,{rqlQuery:this.options.rql}),this)},defineViews:function(){this.filterView=new o({model:{rqlQuery:this.pressWorksheetList.rqlQuery}}),this.listView=new a({collection:this.pressWorksheetList}),this.listenTo(this.filterView,"filterChanged",this.refreshList)},load:function(e){return e(this.pressWorksheetList.fetch({reset:!0}))},refreshList:function(e){this.pressWorksheetList.rqlQuery=e,this.listView.refreshCollection(null,!0),this.broker.publish("router.navigate",{url:this.pressWorksheetList.genClientUrl()+"?"+e,trigger:!1,replace:!0})}})}),define("app/pressWorksheets/templates/details",["app/i18n"],function(t){return function anonymous(locals,filters,escape,rethrow){escape=escape||function(e){return String(e).replace(/&(?!#?[a-zA-Z0-9]+;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&#39;").replace(/"/g,"&quot;")};var buf=[];with(locals||{})!function(){buf.push('<div>\n  <div class="panel panel-primary pressWorksheets-details">\n    <div class="panel-heading">\n      ',t("pressWorksheets","PANEL:TITLE:details"),'\n    </div>\n    <div class="panel-details row">\n      <div class="col-md-6">\n        <div class="props first">\n          <div class="prop">\n            <div class="prop-name">',t("pressWorksheets","PROPERTY:type"),'</div>\n            <div class="prop-value">',model.type,'</div>\n          </div>\n          <div class="prop">\n            <div class="prop-name">',t("pressWorksheets","PROPERTY:date"),'</div>\n            <div class="prop-value">',model.date,'</div>\n          </div>\n          <div class="prop">\n            <div class="prop-name">',t("pressWorksheets","PROPERTY:shift"),'</div>\n            <div class="prop-value">',model.shift,'</div>\n          </div>\n          <div class="prop">\n            <div class="prop-name">',t("pressWorksheets","PROPERTY:master"),'</div>\n            <div class="prop-value">',escape(model.master||"-"),'</div>\n          </div>\n          <div class="prop">\n            <div class="prop-name">',t("pressWorksheets","PROPERTY:operator"),'</div>\n            <div class="prop-value">',escape(model.operator||"-"),'</div>\n          </div>\n        </div>\n      </div>\n      <div class="col-md-6">\n        <div class="props">\n          <div class="prop">\n            <div class="prop-name">',t("pressWorksheets","PROPERTY:createdAt"),'</div>\n            <div class="prop-value">',escape(model.createdAt||"-"),'</div>\n          </div>\n          <div class="prop">\n            <div class="prop-name">',t("pressWorksheets","PROPERTY:creator"),'</div>\n            <div class="prop-value">',escape(model.creator||"-"),'</div>\n          </div>\n          <div class="prop">\n            <div class="prop-name">',t("pressWorksheets","PROPERTY:operators"),'</div>\n            <div class="prop-value">\n              '),model.operators.length?(buf.push("\n              <ol>\n                "),model.operators.forEach(function(e){buf.push("\n                <li>",escape(e),"</li>\n                ")}),buf.push("\n              </ol>\n              ")):buf.push("\n              -\n              "),buf.push('\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n  <div class="panel panel-default pressWorksheets-details-orders">\n    <div class="panel-heading">\n      ',t("pressWorksheets","PANEL:TITLE:details:orders"),'\n    </div>\n    <table class="table table-bordered table-condensed">\n      <thead>\n        <tr>\n          <th>',t("pressWorksheets","PROPERTY:order.nc12"),"</th>\n          <th>",t("pressWorksheets","PROPERTY:order.name"),"</th>\n          <th>",t("pressWorksheets","PROPERTY:order.operationName"),"</th>\n          <th>",t("pressWorksheets","PROPERTY:order.operationNo"),"</th>\n          <th>",t("pressWorksheets","PROPERTY:order.prodLine"),"</th>\n          <th>",t("pressWorksheets","PROPERTY:order.quantityDone"),"</th>\n          <th>",t("pressWorksheets","PROPERTY:order.startedAt"),"</th>\n          <th>",t("pressWorksheets","PROPERTY:order.finishedAt"),"</th>\n          <th>",t("pressWorksheets","PROPERTY:order.losses"),"</th>\n          <th>",t("pressWorksheets","PROPERTY:order.downtimes"),"</th>\n        </tr>\n      </thead>\n      <tbody>\n        "),model.orders.forEach(function(e){buf.push("\n        <tr>\n          <td>\n            "),e.prodShiftOrder&&user.isAllowedTo("PROD_DATA:VIEW")?buf.push('\n            <a href="#prodShiftOrders/',e.prodShiftOrder,'">',escape(e.nc12),"</a>\n            "):buf.push("\n            ",escape(e.nc12),"\n            "),buf.push("\n          </td>\n          <td>",escape(e.name),"</td>\n          <td>",escape(e.operationName||"-"),"</td>\n          <td>",escape(e.operationNo),"</td>\n          <td>",escape(e.prodLine),"</td>\n          <td>",escape(e.quantityDone),"</td>\n          <td>",escape(e.startedAt),"</td>\n          <td>",escape(e.finishedAt),'</td>\n          <td class="prodWorksheets-details-tableContainer">\n            '),e.losses.length&&(buf.push('\n            <table class="table table-bordered table-condensed">\n              <thead>\n                <tr>\n                  '),e.losses.forEach(function(e){buf.push("\n                  <th>",escape(e.label),"</th>\n                  ")}),buf.push("\n                </tr>\n              </thead>\n              <tbody>\n                <tr>\n                  "),e.losses.forEach(function(e){buf.push("\n                  <td>",escape(e.count),"</td>\n                  ")}),buf.push("\n                </tr>\n              </tbody>\n            </table>\n            ")),buf.push('\n          </td>\n          <td class="prodWorksheets-details-tableContainer">\n            '),e.downtimes.length&&(buf.push('\n            <table class="table table-bordered table-condensed">\n              <thead>\n                <tr>\n                  '),e.downtimes.forEach(function(e){buf.push("\n                  <th>\n                    "),e.prodDowntime&&user.isAllowedTo("PROD_DOWNTIMES:VIEW")?buf.push('\n                    <a href="#prodDowntimes/',e.prodDowntime,'">',escape(e.label),"</a>\n                    "):buf.push("\n                    ",escape(e.label),"\n                    "),buf.push("\n                  </th>\n                  ")}),buf.push("\n                </tr>\n              </thead>\n              <tbody>\n                <tr>\n                  "),e.downtimes.forEach(function(e){buf.push("\n                  <td>",escape(e.duration),"</td>\n                  ")}),buf.push("\n                </tr>\n              </tbody>\n            </table>\n            ")),buf.push("\n          </td>\n        </tr>\n        ")}),buf.push("\n      </tbody>\n    </table>\n  </div>\n</div>\n")}();return buf.join("")}}),define("app/pressWorksheets/pages/PressWorksheetDetailsPage",["app/user","app/core/util/pageActions","app/core/pages/DetailsPage","../views/decoratePressWorksheet","app/pressWorksheets/templates/details"],function(e,t,n,r,i){return n.extend({detailsTemplate:i,serializeDetails:r,actions:function(){var n=288e5,r=Date.now(),i=[];return(e.isAllowedTo("PROD_DATA:MANAGE")||e.data._id===this.model.get("creator").id&&Date.parse(this.model.get("createdAt"))+n>r)&&i.push(t.edit(this.model),t.delete(this.model)),i}})}),define("app/pressWorksheets/templates/form",["app/i18n"],function(t){return function anonymous(locals,filters,escape,rethrow){escape=escape||function(e){return String(e).replace(/&(?!#?[a-zA-Z0-9]+;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&#39;").replace(/"/g,"&quot;")};var buf=[];with(locals||{})!function(){buf.push('<form class="pressWorksheets-form" method="post" action="',formAction,'" autocomplete="off">\n  <input type="hidden" name="_method" value="',formMethod,'">\n  <div class="panel panel-primary">\n    <div class="panel-heading">',panelTitleText,'</div>\n    <div class="panel-body">\n      <div id="',idPrefix,'-typeChangeWarning" class="message message-inline message-warning">',t("pressWorksheets","FORM:typeChangeWarning"),'</div>\n      <div class="form-group">\n        <label class="radio-inline">\n          <input id="',idPrefix,'-type" type="radio" name="type" value="mech">\n          ',t("pressWorksheets","PROPERTY:type:mech"),'\n        </label>\n        <label class="radio-inline">\n          <input type="radio" name="type" value="optics">\n          ',t("pressWorksheets","PROPERTY:type:optics"),'\n        </label>\n        <label class="radio-inline">\n          <input type="radio" name="type" value="paintShop">\n          ',t("pressWorksheets","PROPERTY:type:paintShop"),'\n        </label>\n      </div>\n      <div class="row">\n        <div class="col-md-3 form-group">\n          <label for="',idPrefix,'-operators" class="control-label">',t("pressWorksheets","PROPERTY:operators"),'</label>\n          <input id="',idPrefix,'-operators" type="text" name="operators" required>\n        </div>\n        <div class="col-md-3 pressWorksheets-form-dateAndShift">\n          <div class="row">\n            <div class="col-md-6 form-group">\n              <label for="',idPrefix,'-date" class="control-label">',t("pressWorksheets","PROPERTY:date"),'</label>\n              <input id="',idPrefix,'-date" class="form-control" type="date" name="date" required>\n            </div>\n            <div class="col-md-6 form-group pressWorksheets-form-group-shift">\n              <label for="',idPrefix,'-shift-1">',t("pressWorksheets","PROPERTY:shift"),'</label>\n              <div class="pressWorksheets-form-group-shift-checkboxes">\n                <label class="radio-inline"><input id="',idPrefix,'-shift-1" name="shift" type="radio" value="1" checked> ',t("core","SHIFT:1"),'</label>\n                <label class="radio-inline"><input name="shift" type="radio" value="2"> ',t("core","SHIFT:2"),'</label>\n                <label class="radio-inline"><input name="shift" type="radio" value="3"> ',t("core","SHIFT:3"),'</label>\n              </div>\n            </div>\n          </div>\n        </div>\n        <div class="col-md-3 form-group">\n          <label for="',idPrefix,'-operator" class="control-label">',t("pressWorksheets","PROPERTY:operator"),'</label>\n          <input id="',idPrefix,'-operator" type="text" name="operator" required>\n        </div>\n        <div class="col-md-3 form-group">\n          <label for="',idPrefix,'-master" class="control-label">',t("pressWorksheets","PROPERTY:master"),'</label>\n          <input id="',idPrefix,'-master" type="text" name="master" required>\n        </div>\n      </div>\n      <div id="',idPrefix,'-existingWarning" class="message message-inline message-warning"></div>\n      <div class="pressWorksheets-form-group-paintShop">\n        <div class="form-group">\n          <label for="',idPrefix,'-startedAt" class="control-label">',t("pressWorksheets","PROPERTY:startedAt"),'</label>\n          <input id="',idPrefix,'-startedAt" class="form-control pressWorksheets-form-time" type="time" name="startedAt">\n        </div>\n        <div class="form-group">\n          <label for="',idPrefix,'-finishedAt" class="control-label">',t("pressWorksheets","PROPERTY:finishedAt"),'</label>\n          <input id="',idPrefix,'-finishedAt" class="form-control pressWorksheets-form-time" type="time" name="finishedAt">\n        </div>\n      </div>\n      <div id="',idPrefix,'-ordersTable" class="table-responsive"></div>\n    </div>\n    <div class="panel-footer">\n      <button type="submit" class="btn btn-primary">',formActionText,'</button>\n      <button type="submit" class="btn btn-danger">',t("pressWorksheets","FROM:ACTION:saveOverlapping"),"</button>\n    </div>\n  </div>\n</form>\n")}();return buf.join("")}}),define("app/pressWorksheets/templates/ordersTable",["app/i18n"],function(t){return function anonymous(locals,filters,escape,rethrow){escape=escape||function(e){return String(e).replace(/&(?!#?[a-zA-Z0-9]+;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&#39;").replace(/"/g,"&quot;")};var buf=[];with(locals||{})!function(){buf.push('<table class="table table-bordered table-condensed pressWorksheets-form-orders">\n  <thead>\n    <tr>\n      <th rowspan="',rowspan,'">',t("core","#"),'</th>\n      <th rowspan="',rowspan,'" data-column="part">\n        ',t("pressWorksheets","PROPERTY:order.part"),'\n        <span class="pressWorksheets-form-focusLastPart">',t("pressWorksheets","FORM:focusLastPart"),'</span>\n      </th>\n      <th rowspan="',rowspan,'" data-column="operation">',t("pressWorksheets","PROPERTY:order.operation"),'</th>\n      <th class="pressWorksheets-form-min" rowspan="',rowspan,'" data-column="prodLine">',t("pressWorksheets","PROPERTY:order.prodLine"),'</th>\n      <th class="pressWorksheets-form-min" rowspan="',rowspan,'" data-column="quantityDone">',t("pressWorksheets","PROPERTY:order.quantityDone"),'</th>\n      <th class="pressWorksheets-form-min pressWorksheets-form-timeCell" rowspan="',rowspan,'" data-column="startedAt">',t("pressWorksheets","PROPERTY:order.startedAt"),'</th>\n      <th class="pressWorksheets-form-min pressWorksheets-form-timeCell" rowspan="',rowspan,'" data-column="finishedAt">',t("pressWorksheets","PROPERTY:order.finishedAt"),"</th>\n      "),lossReasons.length&&buf.push('\n      <th class="pressWorksheets-form-lossCell pressWorksheets-form-min pressWorksheets-form-separator" colspan="',lossReasons.length,'">',t("pressWorksheets","PROPERTY:order.losses"),"</th>\n      "),buf.push("\n      "),downtimeReasons.length&&buf.push('\n      <th class="pressWorksheets-form-downtimeCell pressWorksheets-form-min pressWorksheets-form-separator" colspan="',downtimeReasons.length,'">',t("pressWorksheets","PROPERTY:order.downtimes"),"</th>\n      "),buf.push("\n    </tr>\n    "),rowspan&&(buf.push('\n    <tr class="pressWorksheets-form-losses">\n      '),lossReasons.forEach(function(e,t){buf.push('\n      <th class="pressWorksheets-form-lossCell ',t?"":"pressWorksheets-form-separator",'" data-column="loss.',t,'"><span class="pressWorksheets-form-loss">',e.label,"</span></th>\n      ")}),buf.push("\n      "),downtimeReasons.forEach(function(e,t){buf.push('\n      <th class="pressWorksheets-form-downtimeCell ',t?"":"pressWorksheets-form-separator",'" data-column="downtime.',t,'" data-type="',e.type,'"><span class="pressWorksheets-form-loss">',e.label,"</span></th>\n      ")}),buf.push("\n    </tr>\n    ")),buf.push("\n  </thead>\n  <tbody></tbody>\n</table>\n")}();return buf.join("")}}),define("app/pressWorksheets/templates/ordersTableRow",["app/i18n"],function(t){return function anonymous(locals,filters,escape,rethrow){escape=escape||function(e){return String(e).replace(/&(?!#?[a-zA-Z0-9]+;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&#39;").replace(/"/g,"&quot;")};var buf=[];with(locals||{})!function(){buf.push('<tr class="pressWorksheets-form-order">\n  <td class="pressWorksheets-form-no">0.</td>\n  <td><input class="pressWorksheets-form-part" type="text" name="orders[',no,'].part" data-column="part" placeholder="',t("pressWorksheets","FORM:PLACEHOLDER:part"),'"></td>\n  <td><input class="form-control pressWorksheets-form-operation" type="text" name="orders[',no,'].operation" data-column="operation" placeholder="',t("pressWorksheets","FORM:PLACEHOLDER:operation"),'"></td>\n  <td><input class="pressWorksheets-form-prodLine" type="text" name="orders[',no,'].prodLine" data-column="prodLine" placeholder="',t("pressWorksheets","FORM:PLACEHOLDER:prodLine"),'"></td>\n  <td><input class="form-control no-controls pressWorksheets-form-quantityDone" type="number" name="orders[',no,'].quantityDone" data-column="quantityDone"></td>\n  <td class="pressWorksheets-form-timeCell"><input class="form-control no-controls pressWorksheets-form-time pressWorksheets-form-startedAt" type="time" name="orders[',no,'].startedAt" data-column="startedAt"></td>\n  <td class="pressWorksheets-form-timeCell"><input class="form-control no-controls pressWorksheets-form-time pressWorksheets-form-finishedAt" type="time" name="orders[',no,'].finishedAt" data-column="finishedAt"></td>\n  '),lossReasons.forEach(function(e,t){buf.push('\n  <td class="pressWorksheets-form-lossCell ',t?"":"pressWorksheets-form-separator",'"><input class="form-control no-controls pressWorksheets-form-count is-loss" type="number" name="orders[',no,"].losses.",e._id,'" data-column="loss.',t,'" data-reason="',e._id,'"></td>\n  ')}),buf.push("\n  "),downtimeReasons.forEach(function(e,t){buf.push('\n  <td class="pressWorksheets-form-downtimeCell ',t?"":"pressWorksheets-form-separator",'" data-type="',e.type,'"><input class="form-control no-controls pressWorksheets-form-count is-downtime" type="number" name="orders[',no,"].downtimes.",e._id,'" data-column="downtime.',t,'" data-reason="',e._id,'"></td>\n  ')}),buf.push("\n</tr>\n")}();return buf.join("")}}),define("app/pressWorksheets/views/PressWorksheetFormView",["underscore","jquery","app/time","app/i18n","app/viewport","app/data/downtimeReasons","app/data/prodLines","app/core/Model","app/core/views/FormView","app/users/util/setUpUserSelect2","../PressWorksheetCollection","app/pressWorksheets/templates/form","app/pressWorksheets/templates/ordersTable","app/pressWorksheets/templates/ordersTableRow"],function(e,t,n,r,i,o,a,s,u,l,c,d,p,f){return u.extend({template:d,idPrefix:"pressWorksheetForm",events:{keydown:function(e){13===e.keyCode&&e.preventDefault()},"click button[type=submit]":function(e){this.checkOverlapping=e.target.classList.contains("btn-primary")},submit:function(e){return this.removeIsOverlapping(),this.submitForm(e)},"blur .pressWorksheets-form-time":function(e){var t=e.target.value.trim().replace(/[^0-9: \-]+/g,"");if(0!==t.length){var n=t.match(/^([0-9]+)(?::| +|\-)+([0-9]+)$/),r=0,i=0;n?(r=parseInt(n[1],10),i=parseInt(n[2],10)):4===t.length?(r=parseInt(t.substr(0,2),10),i=parseInt(t.substr(2),10)):3===t.length?(r=parseInt(t[0],10),i=parseInt(t.substr(1),10)):i=parseInt(t,10);var o=isNaN(r)||r>=24,a=isNaN(i)||i>=60;o&&(r=0),a&&(i=0),e.target.value=(10>r?"0":"")+r.toString(10)+":"+(10>i?"0":"")+i.toString(10),this.validateTimes(e.target)}},"blur .pressWorksheets-form-count":function(e){var t=parseInt(e.target.value,10);e.target.value=isNaN(t)?"":t,e.target.classList.contains("is-downtime")&&this.validateTimes(e.target)},"blur .pressWorksheets-form-quantityDone":function(e){var t=parseInt(e.target.value,10);e.target.value=isNaN(t)||0>t?"":t},"focus input":function(e){e.target.classList.contains("select2-focusser")&&e.target.parentNode.classList.contains("pressWorksheets-form-part")?this.$(".table-responsive").prop("scrollLeft",0):e.target.classList.contains("pressWorksheets-form-time")&&e.target.parentNode.classList.contains("form-group")&&(this.paintShopTimeFocused=!0)},"focus .pressWorksheets-form-order input":function(e){var t=this.$(e.target);t.closest("td").addClass("is-focused"),t.hasClass("select2-focusser")&&(t=t.parent().next(".select2-offscreen")),t[0].dataset.column&&this.$('th[data-column="'+t[0].dataset.column+'"]').addClass("is-focused")},"blur .pressWorksheets-form-order input":function(e){this.$(e.target).closest("td").removeClass("is-focused"),this.$("th.is-focused").removeClass("is-focused")},"change input[name=shift]":function(){this.checkShiftStartTimeValidity(),this.validateTimes(null),this.checkForExistingWorksheet()},"change input[name=date]":function(){this.checkShiftStartTimeValidity(),this.checkForExistingWorksheet()},"change input[name=operator]":function(){this.checkForExistingWorksheet()},"change input[name=type]":function(){this.togglePaintShop(),this.filling||(this.renderOrdersTable(),this.addOrderRow())}},initialize:function(){u.prototype.initialize.apply(this,arguments),this.checkOverlapping=!0,this.filling=!1,this.lastOrderNo=-1,this.lossReasons=[],this.downtimeReasons=[],this.paintShopTimeFocused=!1,this.onKeyDown=this.onKeyDown.bind(this),this.existingWorksheets=new c(null,{rqlQuery:"select(rid)"}),this.listenTo(this.existingWorksheets,"request",function(){this.$id("existingWarning").fadeOut()}),this.listenTo(this.existingWorksheets,"reset",this.toggleExistingWarning),t("body").on("keydown",this.onKeyDown)},destroy:function(){t("body").off("keydown",this.onKeyDown),this.$('.select2-offscreen[tabindex="-1"]').select2("destroy")},afterRender:function(){u.prototype.afterRender.call(this),this.prodLinesData=a.filter(function(e){var t=e.getSubdivision();return t&&"press"===t.get("type")}).map(function(e){return{id:e.id,text:e.id}}),l(this.$id("master"));var e=l(this.$id("operator")),t=l(this.$id("operators"),{multiple:!0}),n=this;t.on("change",function(){e.select2("data")||(e.select2("data",t.select2("data")[0]),n.checkForExistingWorksheet())}),this.fillType(),this.renderOrdersTable(),this.fillModelData(),this.addOrderRow(),this.model.id||this.$id("type").focus()},renderOrdersTable:function(){var e="optics"===this.getType(),t=e?"opticsPosition":"pressPosition";this.lossReasons=e?[]:this.model.lossReasons.toJSON(),this.downtimeReasons=o.filter(function(e){return e.get(t)>=0}).map(function(e){return e.toJSON()}).sort(function(e,n){return e[t]-n[t]}),this.lastOrderNo=-1,this.$id("ordersTable").html(p({rowspan:this.lossReasons.length||this.downtimeReasons.length?2:0,lossReasons:this.lossReasons,downtimeReasons:this.downtimeReasons}))},serializeForm:function(e){function t(e){return{id:e.id,label:e.text}}var n=this.$(".pressWorksheets-form-order");return e.orders=(e.orders||[]).filter(function(e){return e.part&&e.part.length&&e.operation&&e.operation.length}).map(this.serializeOrder.bind(this,n,this.model.lossReasons)),e.operators=this.$id("operators").select2("data").map(t),e.operator=t(this.$id("operator").select2("data")),e.master=t(this.$id("master").select2("data")),e.shift=parseInt(e.shift,10),e},serializeOrder:function(t,n,r,i){var a=t.eq(i),s=a.find(".pressWorksheets-form-part"),u=s.select2("data").data;u._id&&(u.nc12=u._id,delete u._id);var l=e.find(u.operations,function(e){return e.no===r.operation}),c=[];r.losses&&Object.keys(r.losses).forEach(function(e){e=n.get(e),r.losses[e.id]>0&&c.push({reason:e.id,label:e.get("label"),count:parseInt(r.losses[e.id],10)})});var d=[];return r.downtimes&&Object.keys(r.downtimes).forEach(function(e){var t=parseInt(r.downtimes[e],10);if(t>0){e=o.get(e);var n=a.find('.is-downtime[data-reason="'+e.id+'"]');d.push({prodDowntime:n.attr("data-prodDowntime")||null,reason:e.id,label:e.get("label"),duration:t})}}),{prodShiftOrder:s.attr("data-prodShiftOrder")||null,prodLine:r.prodLine,nc12:u.nc12,name:u.name,operationNo:l.no,operationName:l.name,orderData:u,quantityDone:r.quantityDone,startedAt:r.startedAt||null,finishedAt:r.finishedAt||null,losses:c,downtimes:d}},checkShiftStartTimeValidity:function(){var e=this.$id("date"),t=this.getShiftMoment();if(e[0].setCustomValidity(t.valueOf()>Date.now()?r("pressWorksheets","FORM:ERROR:date"):""),this.isPaintShop()){var n=this.$id("startedAt"),i=this.$id("finishedAt");if(!t.isValid())return;this.paintShopTimeFocused||(n.val(t.format("HH:mm")),i.val(t.add("hours",8).format("HH:mm")))}},getShiftMoment:function(){var e=this.$id("date"),t=parseInt(this.$("input[name=shift]:checked").val(),10);return n.getMoment(e.val()+" 06:00:00").add("h",8*(t-1))},getType:function(){return this.$("input[name=type]:checked").val()},isPaintShop:function(){return"paintShop"===this.getType()},showFieldError:function(e,t){return e.hasClass("select2-offscreen")?e.select2("focus"):e.focus(),this.$errorMessage=i.msg.show({type:"error",time:3e3,text:r("pressWorksheets","FORM:ERROR:"+t)}),!1},setUpOrderSelect2:function(e){var t=this;e.removeClass("form-control"),e.select2({allowClear:!0,minimumInputLength:6,ajax:{cache:!0,quietMillis:300,url:function(e){return"/production/orders?nc12="+encodeURIComponent(e)},results:function(e){return{results:(e||[]).map(function(e){return{id:e._id,text:e._id+" - "+(e.name||"?"),data:e}})}}}}),e.on("change",function(n){var r=e.closest(".pressWorksheets-form-order"),i=t.isLastOrderRow(r);if(!n.added&&!i)return(r.next()||r.prev()).find(".pressWorksheets-form-part").select2("focus"),r.fadeOut(function(){r.remove(),t.setUpPartValidation(),t.recalcOrderNoColumn()}),void(n.added||2!==t.$(".pressWorksheets-form-order").length||t.$id("typeChangeWarning").fadeOut());var o=[];n.added&&Array.isArray(n.added.data.operations)&&n.added.data.operations.forEach(function(e){""!==e.workCenter&&-1!==e.laborTime&&o.push(e)});var a=r.find(".pressWorksheets-form-operation");t.setUpOperationSelect2(a,o.map(function(e){return{id:e.no,text:e.no+" - "+(e.name||"?")}})),o.length?a.select2("val",o[0].no).select2("focus"):(a.select2("destroy"),a.select2("destroy"),a.addClass("form-control").val(""),e.select2("focus")),i&&t.addOrderRow(r)})},setUpOperationSelect2:function(e,t){e.removeClass("form-control"),e.select2({openOnEnter:null,allowClear:!1,data:t||[]})},setUpProdLineSelect2:function(e,t){e.removeClass("form-control"),e.select2({width:"185px",openOnEnter:null,allowClear:!1,data:this.prodLinesData}),t&&e.select2("val",t.find(".pressWorksheets-form-prodLine").select2("val"))},isLastOrderRow:function(e){return this.$(".pressWorksheets-form-order:last-child")[0]===e[0]},addOrderRow:function(e,n){n=n!==!1,++this.lastOrderNo;var r=t(f({no:this.lastOrderNo,lossReasons:this.lossReasons,downtimeReasons:this.downtimeReasons}));this.lastOrderNo>0&&n&&r.hide(),this.$(".pressWorksheets-form-prodLine:last-child").attr("required",!0),this.$(".pressWorksheets-form-quantityDone:last-child").attr("required",!0),this.isPaintShop()||(this.$(".pressWorksheets-form-startedAt:last-child").attr("required",!0),this.$(".pressWorksheets-form-finishedAt:last-child").attr("required",!0)),this.$(".pressWorksheets-form-orders > tbody").append(r),this.lastOrderNo>0&&n&&r.fadeIn(),this.setUpOrderSelect2(r.find(".pressWorksheets-form-part")),this.setUpProdLineSelect2(r.find(".pressWorksheets-form-prodLine"),e);var i=this.$id("typeChangeWarning");return n?this.lastOrderNo>0?i.fadeIn():i.fadeOut():i.toggle(this.lastOrderNo>0),n&&(this.setUpPartValidation(),this.recalcOrderNoColumn()),e&&this.copyDataFromPrevRow(e),r},copyDataFromPrevRow:function(e){var t=e.prev();t.length&&(e.find(".pressWorksheets-form-prodLine").select2("val",t.find(".pressWorksheets-form-prodLine").select2("val")),e.find(".pressWorksheets-form-startedAt").val(t.find(".pressWorksheets-form-finishedAt").val()))},setUpPartValidation:function(){var e=this.$("input.pressWorksheets-form-part");e.last().attr("required",1===e.length)},recalcOrderNoColumn:function(){this.$(".pressWorksheets-form-order > td:first-child").each(function(e){this.innerHTML=e+1+"."})},togglePaintShop:function(){var e=this.isPaintShop();this.$el.toggleClass("pressWorksheets-form-paintShop",e),this.$(".pressWorksheets-form-group-paintShop input").attr("required",e)},validateTimes:function(e){if(this.isPaintShop())this.checkPaintShopValidity();else if(e)this.checkOrderTimesValidity(e);else{var t=this;this.$(".pressWorksheets-form-startedAt").each(function(){t.checkOrderTimesValidity(this)})}},checkPaintShopValidity:function(){var e=this.$id("startedAt"),t=this.$id("finishedAt");e[0].setCustomValidity(""),t[0].setCustomValidity(""),this.checkTimesValidity(null,e,t)},checkOrderTimesValidity:function(e){var t=this.$(e).closest(".pressWorksheets-form-order"),n=t.find(".pressWorksheets-form-startedAt"),r=t.find(".pressWorksheets-form-finishedAt");n[0].setCustomValidity(""),r[0].setCustomValidity(""),n.prop("required")&&""!==n.val()&&""!==r.val()&&this.checkTimesValidity(t,n,r)
},checkTimesValidity:function(e,t,i){var o=this.$id("date").val();o||(o=n.format(new Date,"YYYY-MM-DD"));var a=this.getShiftMoment(),s=a.valueOf(),u=s+288e5,l=this.getTimeFromString(o,t.val(),!1),c=this.getTimeFromString(o,i.val(),!0);if(s>l||l>u)return t[0].setCustomValidity(r("pressWorksheets","FORM:ERROR:startedAt:boundries"));if(s>c||c>u)return i[0].setCustomValidity(r("pressWorksheets","FORM:ERROR:finishedAt:boundries"));if(l>=c)return i[0].setCustomValidity(r("pressWorksheets","FORM:ERROR:finishedAt:gt"));var d=(c-l)/36e5,p=this.countDowntimeDuration(this.isPaintShop()?null:e);return p>=d?i[0].setCustomValidity(r("pressWorksheets","FORM:ERROR:finishedAt:downtime")):void 0},checkValidity:function(){if(!this.checkOverlapping)return!0;for(var e=this.el.querySelectorAll(".pressWorksheets-form-order"),t=e.length-1,n=this.$id("date").val(),r={},i=0;t>i;++i){var o=e[i],a=o.querySelector("input.pressWorksheets-form-prodLine").value;r[a]||(r[a]=[]),r[a].push({orderRowEl:o,startedAt:this.getTimeFromString(n,o.querySelector(".pressWorksheets-form-startedAt").value,!1),finishedAt:this.getTimeFromString(n,o.querySelector(".pressWorksheets-form-finishedAt").value,!1)})}var s=!0,u=this;return Object.keys(r).forEach(function(e){if(s)for(var t=r[e];t.length;)for(var n=t.shift(),i=0,o=t.length;o>i;++i){var a=t[i];if(a.startedAt>=n.startedAt&&a.startedAt<n.finishedAt||a.finishedAt>n.startedAt&&a.finishedAt<=n.finishedAt)return void(s=u.showOverlappingError(n,a));if(n.startedAt>=a.startedAt&&n.startedAt<a.finishedAt||n.finishedAt>a.startedAt&&n.finishedAt<=a.finishedAt)return void(s=u.showOverlappingError(a,n))}}),s},showOverlappingError:function(e,t){return this.$errorMessage=i.msg.show({type:"error",time:5e3,text:r("pressWorksheets","FORM:ERROR:overlapping")}),e.orderRowEl.classList.add("is-overlapping"),t.orderRowEl.classList.add("is-overlapping"),this.timers.removeIsOverlapping=setTimeout(this.removeIsOverlapping.bind(this),5e3),this.$(".btn-danger").fadeIn(),!1},removeIsOverlapping:function(){this.timers.removeIsOverlapping&&(clearTimeout(this.timers.removeIsOverlapping),this.timers.removeIsOverlapping=null),this.$(".is-overlapping").removeClass("is-overlapping"),this.$(".btn-danger").fadeOut()},countDowntimeDuration:function(e){var t=0;return(e||this.$el).find(".pressWorksheets-form-count.is-downtime").each(function(){var e=parseInt(this.value,10);t+=isNaN(e)||0>=e?0:e}),t/60},getTimeFromString:function(e,t,r){var i=n.getMoment(e+" "+t+":00");return r&&6===i.hours()&&0===i.minutes()&&i.hours(5).minutes(59).seconds(59).milliseconds(999),i.hours()<6&&i.add("days",1),i.valueOf()},serializeToForm:function(){return{}},fillModelData:function(){this.filling=!0,this.fillPersonnel(),this.fillDateAndTimes();var e=this.model.get("orders");Array.isArray(e)&&e.length&&e.forEach(this.fillOrder,this),this.filling=!1},fillType:function(){this.$("input[name=type][value="+this.model.get("type")+"]").trigger("click",!0)},fillPersonnel:function(){function e(e){return{id:e.id,text:e.label}}var t=this.model.get("operators"),n=this.model.get("operator"),r=this.model.get("master");Array.isArray(t)&&t.length&&this.$id("operators").select2("data",t.map(e)),n&&this.$id("operator").select2("data",e(n)),r&&this.$id("master").select2("data",e(r))},fillDateAndTimes:function(){this.$id("date").val(n.format(this.model.get("date"),"YYYY-MM-DD")),this.$("input[name=shift][value="+this.model.get("shift")+"]").click(),"paintShop"===this.model.get("type")&&(this.$id("startedAt").val(this.model.get("startedAt")),this.$id("finishedAt").val(this.model.get("finishedAt")))},fillOrder:function(t){var n=this.addOrderRow(null,!1),r=n.find(".pressWorksheets-form-part"),i=n.find(".pressWorksheets-form-operation");r.attr("data-prodShiftOrder",t.prodShiftOrder).select2("data",{id:t.nc12,text:t.nc12+" - "+(t.name||"?"),data:t.orderData}),this.setUpOperationSelect2(i,e.map(t.orderData.operations,function(e){return{id:e.no,text:e.no+" - "+(e.name||"?")}})),i.select2("val",t.operationNo),n.find(".pressWorksheets-form-prodLine").select2("val",t.prodLine),n.find(".pressWorksheets-form-quantityDone").val(t.quantityDone),Array.isArray(t.losses)&&t.losses.forEach(this.fillLoss.bind(this,n)),Array.isArray(t.downtimes)&&t.downtimes.forEach(this.fillDowntime.bind(this,n)),"paintShop"!==this.model.get("type")&&(n.find(".pressWorksheets-form-startedAt").val(t.startedAt),n.find(".pressWorksheets-form-finishedAt").val(t.finishedAt))},fillLoss:function(e,t){e.find('.is-loss[data-reason="'+t.reason+'"]').val(t.count)},fillDowntime:function(e,t){var n=e.find('.is-downtime[data-reason="'+t.reason+'"]');n.attr("data-prodDowntime",t.prodDowntime).val(t.duration)},toggleExistingWarning:function(){var e=this.$id("existingWarning");this.existingWorksheets.length?e.html(r("pressWorksheets","FORM:existingWarning",{count:this.existingWorksheets.length,links:this.existingWorksheets.map(function(e){return'<a href="'+e.genClientUrl()+'">'+e.getLabel()+"</a>"}).join(", ")})).fadeIn():e.fadeOut()},checkForExistingWorksheet:function(){var e=new Date(this.$id("date").val()+" 06:00:00"),t=parseInt(this.$("input[name=shift]:checked").val(),10),n=this.$id("operator").val(),r=this.$id("existingWarning");if(isNaN(e.getTime())||!t||!n.length)return r.fadeOut();2===t?e.setHours(14):3===t&&e.setHours(22);var i=this.existingWorksheets.rqlQuery.selector;i.args=[{name:"eq",args:["date",e.getTime()]},{name:"eq",args:["operators.id",n]}],this.model.id&&i.args.push({name:"ne",args:["_id",this.model.id]}),this.promised(this.existingWorksheets.fetch({reset:!0}))},onKeyDown:function(e){e.altKey&&13===e.keyCode&&this.$(".pressWorksheets-form-order:last-child").find(".pressWorksheets-form-part").select2("focus")}})}),define("app/pressWorksheets/pages/PressWorksheetAddFormPage",["app/core/pages/AddFormPage","app/lossReasons/LossReasonCollection","../views/PressWorksheetFormView"],function(e,t,n){return e.extend({FormView:n,load:function(e){return this.model.lossReasons=new t(null,{rqlQuery:"select(label)&sort(position)&position>=0"}),e(this.model.lossReasons.fetch({reset:!0}))}})}),define("app/pressWorksheets/pages/PressWorksheetEditFormPage",["app/core/pages/EditFormPage","app/lossReasons/LossReasonCollection","../views/PressWorksheetFormView"],function(e,t,n){return e.extend({FormView:n,load:function(e){return this.model.lossReasons=new t(null,{rqlQuery:"select(label)&sort(position)&position>=0"}),e(this.model.fetch(),this.model.lossReasons.fetch({reset:!0}))}})}),define("app/nls/pressWorksheets",["app/nls/locale/en"],function(e){var t={locale:{}};t.locale.en=e;var n=function(e){if(!e)throw new Error("MessageFormat: No data passed to function.")},r=function(e,t){return n(e),e[t]},i=function(e,r,i,o,a){return n(e),e[r]in a?a[e[r]]:(r=t.locale[o](e[r]-i),r in a?a[r]:a.other)};return{root:{"BREADCRUMBS:browse":function(){return"Worksheets"},"BREADCRUMBS:details":function(){return"Worksheet"},"BREADCRUMBS:addForm":function(){return"Adding"},"BREADCRUMBS:editForm":function(){return"Editing"},"BREADCRUMBS:ACTION_FORM:delete":function(){return"Deleting"},"MSG:LOADING_FAILURE":function(){return"Failed to load the worksheets :("},"MSG:LOADING_SINGLE_FAILURE":function(){return"Failed to load the worksheet :("},"MSG:DELETED":function(e){return"Worksheet <em>"+r(e,"label")+"</em> was deleted."},"MSG:jump:404":function(e){return"Couldn't find a worksheet with ID <em>"+r(e,"rid")+"</em> :("},"PAGE_ACTION:add":function(){return"Add worksheet"},"PAGE_ACTION:edit":function(){return"Edit worksheet"},"PAGE_ACTION:delete":function(){return"Delete worksheet"},"PAGE_ACTION:jump:title":function(){return"Jump to worksheet by ID"},"PAGE_ACTION:jump:placeholder":function(){return"Worksheet ID"},"PANEL:TITLE:details":function(){return"Worksheet's details"},"PANEL:TITLE:addForm":function(){return"Add worksheet form"},"PANEL:TITLE:editForm":function(){return"Edit worksheet form"},"PANEL:TITLE:details:orders":function(){return"Parts"},"FILTER:BUTTON":function(){return"Filter worksheets"},"FILTER:LIMIT":function(){return"Limit"},"FILTER:DATE":function(){return"Date"},"FILTER:SHIFT":function(){return"Shift"},"FILTER:type:any":function(){return"Any"},"FILTER:type:mech":function(){return"Treatment"},"FILTER:type:paintShop":function(){return"Paint shop"},"FILTER:type:optics":function(){return"Optics"},"FILTER:mine":function(){return"Only mine"},"FILTER:mine:title":function(){return"Limit the worksheet to those added by you from the newest to the oldest!"},"FILTER:user:master":function(){return"Master"},"FILTER:user:operators":function(){return"Operator"},"FILTER:user:placeholder":function(){return"Search by last name or personnel ID"},"PROPERTY:rid":function(){return"ID"},"PROPERTY:operators":function(){return"Operators"},"PROPERTY:operator":function(){return"Signed operator"},"PROPERTY:master":function(){return"Signed master"},"PROPERTY:date":function(){return"Date"},"PROPERTY:shift":function(){return"Shift"},"PROPERTY:type":function(){return"Type"},"PROPERTY:type:mech":function(){return"Treatment"},"PROPERTY:type:paintShop":function(){return"Paint shop"},"PROPERTY:type:optics":function(){return"Optics"},"PROPERTY:startedAt":function(){return"Started at"},"PROPERTY:finishedAt":function(){return"Finished at"},"PROPERTY:createdAt":function(){return"Created at"},"PROPERTY:creator":function(){return"Creator"},"PROPERTY:order.part":function(){return"Part"},"PROPERTY:order.operation":function(){return"Operation"},"PROPERTY:order.#":function(){return"#"},"PROPERTY:order.nc12":function(){return"12NC"},"PROPERTY:order.name":function(){return"Part name"},"PROPERTY:order.operationName":function(){return"Operation name"},"PROPERTY:order.operationNo":function(){return"Operation no"},"PROPERTY:order.prodLine":function(){return"Machine"},"PROPERTY:order.quantityDone":function(){return"Good qty"},"PROPERTY:order.startedAt":function(){return"Started at"},"PROPERTY:order.finishedAt":function(){return"Finished at"},"PROPERTY:order.losses":function(){return"Losses [items]"},"PROPERTY:order.downtimes":function(){return"Downtimes by master's instruction [minutes]"},"ACTION_FORM:DIALOG_TITLE:delete":function(){return"Worksheet deletion confirmation"},"ACTION_FORM:BUTTON:delete":function(){return"Delete worksheet"},"ACTION_FORM:MESSAGE:delete":function(){return"Are you sure you want to delete the chosen worksheet?<br><br>Along with the worksheet, all Orders and Downtimes defined in it will be deleted."},"ACTION_FORM:MESSAGE_SPECIFIC:delete":function(e){return"Are you sure you want to delete the <em>"+r(e,"label")+"</em> worksheet? Along with the worksheet, all Orders and Downtimes defined in it will be deleted."},"ACTION_FORM:MESSAGE_FAILURE:delete":function(){return"Failed to delete the worksheet :-("},"FORM:ACTION:add":function(){return"Add worksheet"},"FORM:ACTION:edit":function(){return"Edit worksheet"},"FROM:ACTION:saveOverlapping":function(){return"Save worksheet with overlapping orders"},"FORM:ERROR:addFailure":function(){return"Failed to add the worksheet :-("},"FORM:ERROR:editFailure":function(){return"Failed to edit the worksheet :-("},"FORM:ERROR:startedAt:boundries":function(){return"Started at must be within the boundries of the selected shift."},"FORM:ERROR:finishedAt:boundries":function(){return"Finished at must be within the boundries of the selected shift."},"FORM:ERROR:finishedAt:gt":function(){return"Finished at must be later than Started at."},"FORM:ERROR:finishedAt:downtime":function(){return"Total downtime must be less than the order's duration."},"FORM:ERROR:overlapping":function(){return"Time of the orders on the same machines are overlapping!"},"FORM:ERROR:date":function(){return"Shift's time cannot be in the future."},"FORM:PLACEHOLDER:part":function(){return"Search parts by 12NC..."},"FORM:PLACEHOLDER:operation":function(){return"Choose an operation..."},"FORM:PLACEHOLDER:prodLine":function(){return"Choose a machine..."},"FORM:focusLastPart":function(){return"(ALT+Enter focuses the last search field)"},"FORM:typeChangeWarning":function(){return"<strong>WARNING!</strong> Changing of the type will erase all entered parts!"},"FORM:existingWarning":function(e){return"<strong>WARNING!</strong> "+i(e,"count",0,"en",{one:"Worksheet",other:"Worksheets"})+" for the specified Date, Shift and Signed operator already "+i(e,"count",0,"en",{one:"exists",other:"exist"})+": "+r(e,"links")+"."}},pl:!0}}),define("app/nls/pl/pressWorksheets",["app/nls/locale/pl"],function(e){var t={locale:{}};t.locale.pl=e;var n=function(e){if(!e)throw new Error("MessageFormat: No data passed to function.")},r=function(e,t){return n(e),e[t]},i=function(e,r,i,o,a){return n(e),e[r]in a?a[e[r]]:(r=t.locale[o](e[r]-i),r in a?a[r]:a.other)};return{"BREADCRUMBS:browse":function(){return"Karty pracy"},"BREADCRUMBS:details":function(){return"Karta pracy"},"BREADCRUMBS:addForm":function(){return"Dodawanie"},"BREADCRUMBS:editForm":function(){return"Edycja"},"BREADCRUMBS:ACTION_FORM:delete":function(){return"Usuwanie"},"MSG:LOADING_FAILURE":function(){return"Ładowanie kart pracy nie powiodło się :("},"MSG:LOADING_SINGLE_FAILURE":function(){return"Ładowanie karty pracy nie powiodło się :("},"MSG:DELETED":function(e){return"Karta pracy <em>"+r(e,"label")+"</em> została usunięta."},"MSG:jump:404":function(e){return"Nie znaleziono karty pracy o ID <em>"+r(e,"rid")+"</em> :("},"PAGE_ACTION:add":function(){return"Dodaj kartę pracy"},"PAGE_ACTION:edit":function(){return"Edytuj kartę pracy"},"PAGE_ACTION:delete":function(){return"Usuń kartę pracy"},"PAGE_ACTION:jump:title":function(){return"Skocz do karty pracy po ID"},"PAGE_ACTION:jump:placeholder":function(){return"ID karty pracy"},"PANEL:TITLE:details":function(){return"Szczegóły karty pracy"},"PANEL:TITLE:addForm":function(){return"Formularz dodawania karty pracy"},"PANEL:TITLE:editForm":function(){return"Formularz edycji karty pracy"},"PANEL:TITLE:details:orders":function(){return"Lista części"},"FILTER:BUTTON":function(){return"Filtruj karty pracy"},"FILTER:LIMIT":function(){return"Limit"},"FILTER:DATE":function(){return"Data"},"FILTER:SHIFT":function(){return"Zmiana"},"FILTER:type:any":function(){return"Dowolny"},"FILTER:type:mech":function(){return"Obr. mech."},"FILTER:type:paintShop":function(){return"Malarnia"},"FILTER:type:optics":function(){return"M. optyki"},"FILTER:mine":function(){return"Tylko moje"},"FILTER:mine:title":function(){return"Ogranicz listę kart pracy do dodanych przez Ciebie w kolejności od najnowszej do najstarszej!"},"FILTER:user:master":function(){return"Mistrz"},"FILTER:user:operators":function(){return"Operator"},"FILTER:user:placeholder":function(){return"Szukaj po nazwisku lub nr kadrowym"},"PROPERTY:rid":function(){return"ID"},"PROPERTY:operators":function(){return"Nastawiacze/operatorzy"},"PROPERTY:operator":function(){return"Podpisany nastawiacz/operator"},"PROPERTY:master":function(){return"Podpisany mistrz"},"PROPERTY:date":function(){return"Data"},"PROPERTY:shift":function(){return"Zmiana"},"PROPERTY:type":function(){return"Typ"},"PROPERTY:type:mech":function(){return"Obróbka mechaniczna"},"PROPERTY:type:paintShop":function(){return"Malarnia"},"PROPERTY:type:optics":function(){return"Montaż optyki"},"PROPERTY:startedAt":function(){return"Godz. rozp."},"PROPERTY:finishedAt":function(){return"Godz. zak."},"PROPERTY:createdAt":function(){return"Czas dodania"},"PROPERTY:creator":function(){return"Dodana przez"},"PROPERTY:order.part":function(){return"Część"},"PROPERTY:order.operation":function(){return"Operacja"},"PROPERTY:order.#":function(){return"Lp."},"PROPERTY:order.nc12":function(){return"12NC części"},"PROPERTY:order.name":function(){return"Nazwa części"},"PROPERTY:order.operationName":function(){return"Nazwa operacji"},"PROPERTY:order.operationNo":function(){return"Numer oper."},"PROPERTY:order.prodLine":function(){return"Maszyna"},"PROPERTY:order.quantityDone":function(){return"Ilość dobrych"},"PROPERTY:order.startedAt":function(){return"Godz. rozp."},"PROPERTY:order.finishedAt":function(){return"Godz. zak."},"PROPERTY:order.losses":function(){return"Straty materiałowe [sztuki]"},"PROPERTY:order.downtimes":function(){return"Straty czasu z polecenia mistrza [minuty]"},"ACTION_FORM:DIALOG_TITLE:delete":function(){return"Potwierdzenie usunięcia karty pracy"},"ACTION_FORM:BUTTON:delete":function(){return"Usuń kartę pracy"},"ACTION_FORM:MESSAGE:delete":function(){return"Czy na pewno chcesz bezpowrotnie usunąć wybraną kartę pracy?<br><br>Wraz z kartą pracy usunięte zostaną zdefiniowane w niej Zlecenia i Przestoje."},"ACTION_FORM:MESSAGE_SPECIFIC:delete":function(e){return"Czy na pewno chcesz bezpowrotnie usunąć kartę pracy <em>"+r(e,"label")+"</em>?<br><br>Wraz z kartą pracy usunięte zostaną zdefiniowane w niej Zlecenia i Przestoje."},"ACTION_FORM:MESSAGE_FAILURE:delete":function(){return"Nie udało się usunąć karty pracy :-("},"FORM:ACTION:add":function(){return"Dodaj kartę pracy"},"FORM:ACTION:edit":function(){return"Edytuj kartę pracy"},"FROM:ACTION:saveOverlapping":function(){return"Zapisz kartę pracy z pokrywającymi się czasami zleceń"},"FORM:ERROR:addFailure":function(){return"Nie udało się dodać karty pracy :-("},"FORM:ERROR:editFailure":function(){return"Nie udało się zmodyfikować karty pracy :-("},"FORM:ERROR:startedAt:boundries":function(){return"Godz. rozp. musi mieścić się w zakresie godzinowym wybranej zmiany."},"FORM:ERROR:finishedAt:boundries":function(){return"Godz. zak. musi mieścić się w zakresie godzinowym wybranej zmiany."},"FORM:ERROR:finishedAt:gt":function(){return"Godz. zak. musi być późniejsza niż Godz. rozp."},"FORM:ERROR:finishedAt:downtime":function(){return"Suma przestojów musi być krótsza niż czas trwania zlecenia."},"FORM:ERROR:overlapping":function(){return"Czasy zleceń na tych samych maszynach pokrywają się!"},"FORM:ERROR:date":function(){return"Czas zmiany nie może być z przyszłości."},"FORM:PLACEHOLDER:part":function(){return"Szukaj części po 12NC..."},"FORM:PLACEHOLDER:operation":function(){return"Wybierz operację..."},"FORM:PLACEHOLDER:prodLine":function(){return"Wybierz maszynę..."},"FORM:focusLastPart":function(){return"(skrót ALT+Enter zaznaczy ostatnie pole)"},"FORM:typeChangeWarning":function(){return"<strong>UWAGA!</strong> Zmiana typu wyczyści listę wykonanych części!"},"FORM:existingWarning":function(e){return"<strong>UWAGA!</strong> Dla wybranej Daty, Zmiany i Podpisanego nastawiacza/operatora "+i(e,"count",0,"pl",{one:"istnieje już karta pracy",other:"istnieją już karty pracy"})+": "+r(e,"links")+"."}}}),define("app/pressWorksheets/routes",["../router","../viewport","../user","../core/util/showDeleteFormPage","./PressWorksheet","./pages/PressWorksheetListPage","./pages/PressWorksheetDetailsPage","./pages/PressWorksheetAddFormPage","./pages/PressWorksheetEditFormPage","i18n!app/nls/pressWorksheets"],function(e,t,n,r,i,o,a,s,u){var l=n.auth("PRESS_WORKSHEETS:VIEW"),c=n.auth("PRESS_WORKSHEETS:MANAGE");e.map("/pressWorksheets",l,function(e){t.showPage(new o({rql:e.rql}))}),e.map("/pressWorksheets;add",c,function(){t.showPage(new s({model:new i}))}),e.map("/pressWorksheets/:id",l,function(e){t.showPage(new a({model:new i({_id:e.params.id})}))}),e.map("/pressWorksheets/:id;edit",c,function(e){t.showPage(new u({model:new i({_id:e.params.id})}))}),e.map("/pressWorksheets/:id;delete",c,r.bind(null,i))}),define("app/core/util/getShiftEndDate",["app/time"],function(e){return function(t,n){var r=e.getMoment(t);return r.hours(1===n?6:2===n?14:22),r.add("hours",8).subtract("seconds",1),r.toDate()}}),define("app/prodDowntimes/ProdDowntime",["../time","../core/Model","../core/util/getShiftEndDate"],function(e,t,n){var r={undecided:"warning",confirmed:"success",rejected:"danger"};return t.extend({urlRoot:"/prodDowntimes",clientUrlRoot:"#prodDowntimes",topicPrefix:"prodDowntimes",privilegePrefix:"PROD_DOWNTIMES",nlsDomain:"prodDowntimes",labelAttribute:"rid",defaults:{division:null,subdivision:null,mrpControllers:null,prodFlow:null,workCenter:null,prodLine:null,prodShift:null,prodShiftOrder:null,date:null,shift:null,aor:null,reason:null,reasonComment:null,decisionComment:null,status:null,startedAt:null,finishedAt:null,corroborator:null,corroboratedAt:null,creator:null,master:null,leader:null,operator:null,operators:null,mechOrder:null,orderId:null,operationNo:null},getCssClassName:function(){return r[this.get("status")]},finish:function(){if(null!=this.get("finishedAt"))return null;var t=e.getMoment().toDate(),r=n(this.get("date"),this.get("shift"));return t>r&&(t=r),this.set("finishedAt",t),{_id:this.id,finishedAt:t}},isEditable:function(){return null!=this.get("finishedAt")&&null===this.get("pressWorksheet")}},{STATUS:{UNDECIDED:"undecided",CONFIRMED:"confirmed",REJECTED:"rejected"}})}),define("app/nls/prodDowntimes",["app/nls/locale/en"],function(e){var t={locale:{}};t.locale.en=e;var n=function(e){if(!e)throw new Error("MessageFormat: No data passed to function.")},r=function(e,t){return n(e),e[t]};return{root:{"BREADCRUMBS:browse":function(){return"Downtimes"},"BREADCRUMBS:corroborate":function(){return"Corroboration"},"BREADCRUMBS:editForm":function(){return"Editing"},"BREADCRUMBS:ACTION_FORM:delete":function(){return"Deleting"},"MSG:LOADING_FAILURE":function(){return"Failed to load the downtimes :("},"MSG:LOADING_SINGLE_FAILURE":function(){return"Failed to load the downtime :("},"MSG:DELETED":function(e){return"Downtime <em>"+r(e,"label")+"</em> was deleted."},"MSG:jump:404":function(e){return"Couldn't find a downtime with ID <em>"+r(e,"rid")+"</em> :("},"PAGE_ACTION:export":function(){return"Export downtimes"},"PAGE_ACTION:edit":function(){return"Edit downtime"},"PAGE_ACTION:delete":function(){return"Delete downtime"},"PAGE_ACTION:jump:title":function(){return"Jump to downtime by ID"},"PAGE_ACTION:jump:placeholder":function(){return"Downtime ID"},"PANEL:TITLE:details":function(){return"Downtime's details"},"PANEL:TITLE:details:corroboration":function(){return"Downtime corroboration"},"PANEL:TITLE:editForm":function(){return"Edit downtime form"},"PANEL:TITLE:addForm":function(){return"Add downtime form"},"FILTER:DATE:FROM":function(){return"From"},"FILTER:DATE:TO":function(){return"To"},"FILTER:LIMIT":function(){return"Limit"},"FILTER:BUTTON":function(){return"Filter downtimes"},"FILTER:TOOLTIP:in":function(){return"Checked: all selected\nUnchecked: all but the selected"},"FILTER:PLACEHOLDER:aor":function(){return"Any area of responsibility"},"FILTER:PLACEHOLDER:reason":function(){return"Any downtime reason"},"FILTER:PLACEHOLDER:orgUnit":function(){return"Any Org Unit"},"LIST:ACTION:corroborate":function(){return"Corroborate downtime"},"PROPERTY:rid":function(){return"ID"},"PROPERTY:mrpControllers":function(){return"MRP Controller"},"PROPERTY:prodFlow":function(){return"Production flow"},"PROPERTY:orgUnit":function(){return"Org Unit"},"PROPERTY:aor":function(){return"Area of responsibility"},"PROPERTY:prodLine":function(){return"Production line"},"PROPERTY:reason":function(){return"Downtime reason"},"PROPERTY:reasonComment":function(){return"Reason comment"},"PROPERTY:decisionComment":function(){return"Decision comment"},"PROPERTY:order":function(){return"Order"},"PROPERTY:orderId":function(){return"Order ID"},"PROPERTY:startedAt":function(){return"Started at"},"PROPERTY:finishedAt":function(){return"Finished at"},"PROPERTY:status":function(){return"Status"},"PROPERTY:status:undecided":function(){return"Undecided"},"PROPERTY:status:confirmed":function(){return"Confirmed"},"PROPERTY:status:rejected":function(){return"Rejected"},"PROPERTY:shift":function(){return"Shift"},"PROPERTY:master":function(){return"Master"},"PROPERTY:leader":function(){return"Leader"},"PROPERTY:operator":function(){return"Operator"},"PROPERTY:operators":function(){return"Operators"},"PROPERTY:creator":function(){return"Creator"},"PROPERTY:corroborator":function(){return"Corroborator"},"PROPERTY:corroboratedAt":function(){return"Corroborated at"},"PROPERTY:duration":function(){return"Duration"},"PROPERTY:pressWorksheet":function(){return"Worksheet"},"FORM:ACTION:add":function(){return"Add downtime"},"FORM:ACTION:edit":function(){return"Edit downtime"},"FORM:ERROR:addFailure":function(){return"Failed to add the downtime :-("},"FORM:ERROR:editFailure":function(){return"Failed to edit the downtime :-("},"FORM:ERROR:startedAt":function(){return"Started at must be between the shift's time boundries!"},"FORM:ERROR:finishedAt":function(){return"Finished at must be between the shift's time boundries!"},"FORM:ERROR:times":function(){return"Finished at must be after Started at!"},"FORM:ERROR:INVALID_CHANGES":function(){return"Cannot edit the downtime: no valid changes were detected :("},"FORM:ERROR:INPUT":function(){return"Invalid input data!"},"shift+date":function(e){return r(e,"date")+", "+r(e,"shift")+" shift"},"NO_DATA:order":function(){return"<em>no order</em>"},"NO_DATA:finishedAt":function(){return"<em>unfinished</em>"},"NO_DATA:corroboration":function(){return"Downtime wasn't corroborated yet."},"corroborate:title":function(){return"Downtime corroboration"},"corroborate:decisionComment":function(){return"Optional decision comment..."},"corroborate:cancel":function(){return"Cancel corroboration"},"corroborate:confirm":function(){return"Confirm downtime"},"corroborate:reject":function(){return"Reject downtime"},"corroborate:msg:failure":function(e){return"Failed to corroborate the downtime: "+r(e,"error")},"ACTION_FORM:DIALOG_TITLE:delete":function(){return"Downtime deletion confirmation"},"ACTION_FORM:BUTTON:delete":function(){return"Delete downtime"},"ACTION_FORM:MESSAGE:delete":function(){return"Are you sure you want to delete the chosen downtime?"},"ACTION_FORM:MESSAGE_SPECIFIC:delete":function(e){return"Are you sure you want to delete the <em>"+r(e,"label")+"</em> downtime?"},"ACTION_FORM:MESSAGE_FAILURE:delete":function(){return"Failed to delete the downtime :-("},"filter:message":function(){return"If after going to the downtime details page you want to go back to the downtimes list page with the previously set filters, then you should use the browser's <em><i class='fa fa-arrow-left'></i> Back</em> button or press the <kbd><i class='fa fa-long-arrow-left'></i> Backspace</kbd> key on your keyboard."}},pl:!0}}),define("app/nls/pl/prodDowntimes",["app/nls/locale/pl"],function(e){var t={locale:{}};t.locale.pl=e;var n=function(e){if(!e)throw new Error("MessageFormat: No data passed to function.")},r=function(e,t){return n(e),e[t]};return{"BREADCRUMBS:browse":function(){return"Przestoje"},"BREADCRUMBS:corroborate":function(){return"Potwierdzanie"},"BREADCRUMBS:editForm":function(){return"Edycja"},"BREADCRUMBS:ACTION_FORM:delete":function(){return"Usuwanie"},"MSG:LOADING_FAILURE":function(){return"Ładowanie przestojów nie powiodło się :("},"MSG:LOADING_SINGLE_FAILURE":function(){return"Ładowanie przestoju nie powiodło się :("},"MSG:DELETED":function(e){return"Przestój <em>"+r(e,"label")+"</em> został usunięty."},"MSG:jump:404":function(e){return"Nie znaleziono przestoju o ID <em>"+r(e,"rid")+"</em> :("},"PAGE_ACTION:export":function(){return"Eksportuj przestoje"},"PAGE_ACTION:edit":function(){return"Edytuj przestój"},"PAGE_ACTION:delete":function(){return"Usuń przestój"},"PAGE_ACTION:jump:title":function(){return"Skocz do przestoju po ID"},"PAGE_ACTION:jump:placeholder":function(){return"ID przestoju"},"PANEL:TITLE:details":function(){return"Szczegóły przestoju"},"PANEL:TITLE:details:corroboration":function(){return"Potwierdzenie przestoju"},"PANEL:TITLE:editForm":function(){return"Formularz edycji danych przestoju"},"PANEL:TITLE:addForm":function(){return"Formularz dodawania przestoju"},"FILTER:DATE:FROM":function(){return"Od"},"FILTER:DATE:TO":function(){return"Do"},"FILTER:LIMIT":function(){return"Limit"},"FILTER:BUTTON":function(){return"Filtruj przestoje"},"FILTER:TOOLTIP:in":function(){return"Zaznaczony: wszystkie wybrane\nNiezaznaczony: wszystkie oprócz wybranych"},"FILTER:PLACEHOLDER:aor":function(){return"Dowolny obszar odpowiedzialności"},"FILTER:PLACEHOLDER:reason":function(){return"Dowolny powód przestoju"},"FILTER:PLACEHOLDER:orgUnit":function(){return"Dowolna jednostka organizacyjna"},"LIST:ACTION:corroborate":function(){return"Potwierdź przestój"},"PROPERTY:rid":function(){return"ID"},"PROPERTY:mrpControllers":function(){return"Kontroler MRP"},"PROPERTY:prodFlow":function(){return"Przepływ"},"PROPERTY:orgUnit":function(){return"Jednostka organizacyjna"},"PROPERTY:aor":function(){return"Obszar odpowiedzialności"},"PROPERTY:prodLine":function(){return"Linia produkcyjna/Maszyna"},"PROPERTY:reason":function(){return"Powód przestoju"},"PROPERTY:reasonComment":function(){return"Komentarz powodu"},"PROPERTY:decisionComment":function(){return"Komentarz potwierdzenia"},"PROPERTY:order":function(){return"Wykonywane zlecenie"},"PROPERTY:orderId":function(){return"Zlecenie"},"PROPERTY:startedAt":function(){return"Czas rozpoczęcia"},"PROPERTY:finishedAt":function(){return"Czas zakończenia"},"PROPERTY:status":function(){return"Status"},"PROPERTY:status:undecided":function(){return"Niepotwierdzony"},"PROPERTY:status:confirmed":function(){return"Potwierdzony"},"PROPERTY:status:rejected":function(){return"Odrzucony"},"PROPERTY:shift":function(){return"Zmiana"},"PROPERTY:master":function(){return"Mistrz"},"PROPERTY:leader":function(){return"Lider"},"PROPERTY:operator":function(){return"Operator"},"PROPERTY:operators":function(){return"Operatorzy"},"PROPERTY:creator":function(){return"Użytkownik rozpoczynający"},"PROPERTY:corroborator":function(){return"Użytkownik potwierdzający"},"PROPERTY:corroboratedAt":function(){return"Czas potwierdzenia"},"PROPERTY:duration":function(){return"Czas trwania"},"PROPERTY:pressWorksheet":function(){return"Karta pracy"},"FORM:ACTION:add":function(){return"Dodaj przestój"},"FORM:ACTION:edit":function(){return"Edytuj przestój"},"FORM:ERROR:addFailure":function(){return"Nie udało się dodać przestoju :-("},"FORM:ERROR:editFailure":function(){return"Nie udało się zmodyfikować przestoju :-("},"FORM:ERROR:startedAt":function(){return"Czas rozpoczęcia musi mieścić się w ramach Zmiany produkcyjnej!"},"FORM:ERROR:finishedAt":function(){return"Czas zakończenia musi mieścić się w ramach Zmiany produkcyjnej!"},"FORM:ERROR:times":function(){return"Czas zakończenia musi być po Czasie rozpoczęcia!"},"FORM:ERROR:INVALID_CHANGES":function(){return"Nie można zmodyfikować przestoju: nie wykryto żadnych poprawnych zmian :("},"FORM:ERROR:INPUT":function(){return"Nieprawidłowe dane wejściowe!"},"shift+date":function(e){return r(e,"date")+", "+r(e,"shift")+" zmiana"},"NO_DATA:order":function(){return"<em>brak zlecenia</em>"},"NO_DATA:finishedAt":function(){return"<em>nie ukończony</em>"},"NO_DATA:corroboration":function(){return"Przestój nie został jeszcze potwierdzony."},"corroborate:title":function(){return"Potwierdzenie przestoju"},"corroborate:decisionComment":function(){return"Opcjonalny komentarz do potwierdzenia..."},"corroborate:cancel":function(){return"Anuluj potwierdzenie"},"corroborate:confirm":function(){return"Zatwierdź przestój"},"corroborate:reject":function(){return"Odrzuć przestój"},"corroborate:msg:failure":function(e){return"Nie udało się potwierdzić przestoju: "+r(e,"error")},"ACTION_FORM:DIALOG_TITLE:delete":function(){return"Potwierdzenie usunięcia przestoju"},"ACTION_FORM:BUTTON:delete":function(){return"Usuń przestój"},"ACTION_FORM:MESSAGE:delete":function(){return"Czy na pewno chcesz bezpowrotnie usunąć wybrany przestój?"},"ACTION_FORM:MESSAGE_SPECIFIC:delete":function(e){return"Czy na pewno chcesz bezpowrotnie usunąć przestój <em>"+r(e,"label")+"</em>?"},"ACTION_FORM:MESSAGE_FAILURE:delete":function(){return"Nie udało się usunąć przestoju :-("},"filter:message":function(){return"Jeżeli po przejściu do ekranu szczegołów wybranego przestoju chcesz wrócić do ekranu listy przestojów zachowując wcześniej zdefiniowane filtry, to skorzystaj z przycisku <em><i class='fa fa-arrow-left'></i> Wstecz</em> przeglądarki lub wciśnij klawisz <kbd><i class='fa fa-long-arrow-left'></i> Backspace</kbd> na klawiaturze."
}}}),define("app/prodDowntimes/routes",["../router","../viewport","../user","../core/util/showDeleteFormPage","./ProdDowntime","i18n!app/nls/prodDowntimes"],function(e,t,n,r,i){var o=n.auth("PROD_DOWNTIMES:VIEW"),a=n.auth("PROD_DOWNTIMES:MANAGE");e.map("/prodDowntimes",o,function(e){t.loadPage(["app/prodDowntimes/pages/ProdDowntimeListPage"],function(t){return new t({rql:e.rql})})}),e.map("/prodDowntimes/:id",function(e){t.loadPage(["app/prodDowntimes/pages/ProdDowntimeDetailsPage"],function(t){return new t({modelId:e.params.id})})}),e.map("/prodDowntimes/:id;corroborate",a,function(e,n){t.loadPage(["app/prodDowntimes/pages/CorroborateProdDowntimePage"],function(t){return new t({cancelUrl:n,modelId:e.params.id})})}),e.map("/prodDowntimes/:id;edit",n.auth("PROD_DATA:MANAGE"),function(e){t.loadPage(["app/prodDowntimes/pages/EditProdDowntimeFormPage"],function(t){return new t({model:new i({_id:e.params.id})})})}),e.map("/prodDowntimes/:id;delete",a,r.bind(null,i))}),define("app/nls/prodFlows",["app/nls/locale/en"],function(e){var t={locale:{}};t.locale.en=e;var n=function(e){if(!e)throw new Error("MessageFormat: No data passed to function.")},r=function(e,t){return n(e),e[t]};return{root:{"BREADCRUMBS:browse":function(){return"Production flows"},"BREADCRUMBS:addForm":function(){return"Adding"},"BREADCRUMBS:editForm":function(){return"Editing"},"BREADCRUMBS:ACTION_FORM:delete":function(){return"Deleting"},"MSG:LOADING_FAILURE":function(){return"Failed to load the production flows :("},"MSG:LOADING_SINGLE_FAILURE":function(){return"Failed to load the production flow :("},"MSG:DELETED":function(e){return"Production flow <em>"+r(e,"label")+"</em> was deleted."},"PAGE_ACTION:add":function(){return"Add production flow"},"PAGE_ACTION:edit":function(){return"Edit production flow"},"PAGE_ACTION:delete":function(){return"Delete production flow"},"PANEL:TITLE:details":function(){return"Production flow's details"},"PANEL:TITLE:addForm":function(){return"Add production flow form"},"PANEL:TITLE:editForm":function(){return"Edit production flow form"},"PROPERTY:_id":function(){return"ID"},"PROPERTY:name":function(){return"Name"},"PROPERTY:subdivision":function(){return"Subdivision"},"PROPERTY:mrpControllers":function(){return"MRP Controller"},"FORM:ACTION:add":function(){return"Add production flow"},"FORM:ACTION:edit":function(){return"Edit production flow"},"FORM:ERROR:addFailure":function(){return"Failed to add the new production flow :-("},"FORM:ERROR:editFailure":function(){return"Failed to edit the production flow :-("},"ACTION_FORM:DIALOG_TITLE:delete":function(){return"Production flow deletion confirmation"},"ACTION_FORM:BUTTON:delete":function(){return"Delete production flow"},"ACTION_FORM:MESSAGE:delete":function(){return"Are you sure you want to delete the chosen production flow?"},"ACTION_FORM:MESSAGE_SPECIFIC:delete":function(e){return"Are you sure you want to delete the <em>"+r(e,"label")+"</em> production flow?"},"ACTION_FORM:MESSAGE_FAILURE:delete":function(){return"Failed to delete the production flow :-("}},pl:!0}}),define("app/nls/pl/prodFlows",["app/nls/locale/pl"],function(e){var t={locale:{}};t.locale.pl=e;var n=function(e){if(!e)throw new Error("MessageFormat: No data passed to function.")},r=function(e,t){return n(e),e[t]};return{"BREADCRUMBS:browse":function(){return"Przepływy"},"BREADCRUMBS:addForm":function(){return"Dodawanie"},"BREADCRUMBS:editForm":function(){return"Edycja"},"BREADCRUMBS:ACTION_FORM:delete":function(){return"Usuwanie"},"MSG:LOADING_FAILURE":function(){return"Ładowanie przepływów nie powiodło się :("},"MSG:LOADING_SINGLE_FAILURE":function(){return"Ładowanie przepływu nie powiodło się :("},"MSG:DELETED":function(e){return"Przepływ <em>"+r(e,"label")+"</em> został usunięty."},"PAGE_ACTION:add":function(){return"Dodaj przepływ"},"PAGE_ACTION:edit":function(){return"Edytuj przepływ"},"PAGE_ACTION:delete":function(){return"Usuń przepływ"},"PANEL:TITLE:details":function(){return"Szczegóły przepływu"},"PANEL:TITLE:addForm":function(){return"Formularz dodawania przepływu"},"PANEL:TITLE:editForm":function(){return"Formularz edycji przepływu"},"PROPERTY:_id":function(){return"ID"},"PROPERTY:name":function(){return"Nazwa"},"PROPERTY:subdivision":function(){return"Dział"},"PROPERTY:mrpControllers":function(){return"Kontrolery MRP"},"FORM:ACTION:add":function(){return"Dodaj przepływ"},"FORM:ACTION:edit":function(){return"Edytuj przepływ"},"FORM:ERROR:addFailure":function(){return"Nie udało się dodać przepływu :-("},"FORM:ERROR:editFailure":function(){return"Nie udało się zmodyfikować przepływu :-("},"ACTION_FORM:DIALOG_TITLE:delete":function(){return"Potwierdzenie usunięcia przepływu"},"ACTION_FORM:BUTTON:delete":function(){return"Usuń przepływ"},"ACTION_FORM:MESSAGE:delete":function(){return"Czy na pewno chcesz bezpowrotnie usunąć wybrany przepływ?"},"ACTION_FORM:MESSAGE_SPECIFIC:delete":function(e){return"Czy na pewno chcesz bezpowrotnie usunąć przepływ <em>"+r(e,"label")+"</em>?"},"ACTION_FORM:MESSAGE_FAILURE:delete":function(){return"Nie udało się usunąć przepływu :-("}}}),define("app/prodFlows/routes",["../router","../viewport","../user","../core/util/showDeleteFormPage","../data/prodFlows","./ProdFlow","i18n!app/nls/prodFlows"],function(e,t,n,r,i,o){var a=n.auth("DICTIONARIES:VIEW"),s=n.auth("DICTIONARIES:MANAGE");e.map("/prodFlows",a,function(){t.loadPage(["app/core/pages/ListPage","app/prodFlows/views/ProdFlowListView"],function(e,t){return new e({ListView:t,collection:i})})}),e.map("/prodFlows/:id",function(e){t.loadPage(["app/core/pages/DetailsPage","app/prodFlows/views/ProdFlowDetailsView"],function(t,n){return new t({DetailsView:n,model:new o({_id:e.params.id})})})}),e.map("/prodFlows;add",s,function(){t.loadPage(["app/core/pages/AddFormPage","app/prodFlows/views/ProdFlowFormView"],function(e,t){return new e({FormView:t,model:new o})})}),e.map("/prodFlows/:id;edit",s,function(e){t.loadPage(["app/core/pages/EditFormPage","app/prodFlows/views/ProdFlowFormView"],function(t,n){return new t({FormView:n,model:new o({_id:e.params.id})})})}),e.map("/prodFlows/:id;delete",s,r.bind(null,o))}),define("app/nls/prodFunctions",["app/nls/locale/en"],function(e){var t={locale:{}};t.locale.en=e;var n=function(e){if(!e)throw new Error("MessageFormat: No data passed to function.")},r=function(e,t){return n(e),e[t]};return{root:{"BREADCRUMBS:browse":function(){return"Production functions"},"BREADCRUMBS:addForm":function(){return"Adding"},"BREADCRUMBS:editForm":function(){return"Editing"},"BREADCRUMBS:ACTION_FORM:delete":function(){return"Deleting"},"MSG:LOADING_FAILURE":function(){return"Failed to load the production functions :("},"MSG:LOADING_SINGLE_FAILURE":function(){return"Failed to load the production function :("},"MSG:DELETED":function(e){return"Production function <em>"+r(e,"label")+"</em> was deleted."},"PAGE_ACTION:add":function(){return"Add production function"},"PAGE_ACTION:edit":function(){return"Edit production function"},"PAGE_ACTION:delete":function(){return"Delete production function"},"PANEL:TITLE:details":function(){return"Production function's details"},"PANEL:TITLE:addForm":function(){return"Add production function form"},"PANEL:TITLE:editForm":function(){return"Edit production function form"},"PROPERTY:_id":function(){return"ID"},"PROPERTY:label":function(){return"Label"},"PROPERTY:fteMasterPosition":function(){return"Position in FTE (production)"},"PROPERTY:direct":function(){return"DIRECT/INDIRECT"},"PROPERTY:companies":function(){return"Companies"},"direct:true":function(){return"DIRECT"},"direct:false":function(){return"INDIRECT"},"FORM:ACTION:add":function(){return"Add production function"},"FORM:ACTION:edit":function(){return"Edit production function"},"FORM:ERROR:addFailure":function(){return"Failed to add the new production function :-("},"FORM:ERROR:editFailure":function(){return"Failed to edit the production function :-("},"ACTION_FORM:DIALOG_TITLE:delete":function(){return"Production function deletion confirmation"},"ACTION_FORM:BUTTON:delete":function(){return"Delete production function"},"ACTION_FORM:MESSAGE:delete":function(){return"Are you sure you want to delete the chosen production function?"},"ACTION_FORM:MESSAGE_SPECIFIC:delete":function(e){return"Are you sure you want to delete the <em>"+r(e,"label")+"</em> production function?"},"ACTION_FORM:MESSAGE_FAILURE:delete":function(){return"Failed to delete the production function :-("}},pl:!0}}),define("app/nls/pl/prodFunctions",["app/nls/locale/pl"],function(e){var t={locale:{}};t.locale.pl=e;var n=function(e){if(!e)throw new Error("MessageFormat: No data passed to function.")},r=function(e,t){return n(e),e[t]};return{"BREADCRUMBS:browse":function(){return"Funkcje na produkcji"},"BREADCRUMBS:addForm":function(){return"Dodawanie"},"BREADCRUMBS:editForm":function(){return"Edycja"},"BREADCRUMBS:ACTION_FORM:delete":function(){return"Usuwanie"},"MSG:LOADING_FAILURE":function(){return"Ładowanie funkcji na produkcji nie powiodło się :("},"MSG:LOADING_SINGLE_FAILURE":function(){return"Ładowanie funkcji na produkcji nie powiodło się :("},"MSG:DELETED":function(e){return"Funkcja na produkcji <em>"+r(e,"label")+"</em> została usunięta."},"PAGE_ACTION:add":function(){return"Dodaj funkcję na produkcji"},"PAGE_ACTION:edit":function(){return"Edytuj funkcję na produkcji"},"PAGE_ACTION:delete":function(){return"Usuń funkcję na produkcji"},"PANEL:TITLE:details":function(){return"Szczegóły funkcji na produkcji"},"PANEL:TITLE:addForm":function(){return"Formularz dodawania funkcji na produkcji"},"PANEL:TITLE:editForm":function(){return"Formularz edycji funkcji na produkcji"},"PROPERTY:_id":function(){return"ID"},"PROPERTY:label":function(){return"Opis"},"PROPERTY:fteMasterPosition":function(){return"Pozycja w FTE (produkcja)"},"PROPERTY:direct":function(){return"DIRECT/INDIRECT"},"PROPERTY:companies":function(){return"Firmy"},"direct:true":function(){return"DIRECT"},"direct:false":function(){return"INDIRECT"},"FORM:ACTION:add":function(){return"Dodaj funkcję na produkcji"},"FORM:ACTION:edit":function(){return"Edytuj funkcję na produkcji"},"FORM:ERROR:addFailure":function(){return"Nie udało się dodać funkcji na produkcji :-("},"FORM:ERROR:editFailure":function(){return"Nie udało się zmodyfikować funkcji na produkcji :-("},"ACTION_FORM:DIALOG_TITLE:delete":function(){return"Potwierdzenie usunięcia funkcji na produkcji"},"ACTION_FORM:BUTTON:delete":function(){return"Usuń funkcję na produkcji"},"ACTION_FORM:MESSAGE:delete":function(){return"Czy na pewno chcesz bezpowrotnie usunąć wybraną funkcję na produkcji?"},"ACTION_FORM:MESSAGE_SPECIFIC:delete":function(e){return"Czy na pewno chcesz bezpowrotnie usunąć funkcję na produkcji <em>"+r(e,"label")+"</em>?"},"ACTION_FORM:MESSAGE_FAILURE:delete":function(){return"Nie udało się usunąć funkcji na produkcji :-("}}}),define("app/prodFunctions/routes",["../router","../viewport","../user","../core/util/showDeleteFormPage","../data/prodFunctions","./ProdFunction","i18n!app/nls/prodFunctions"],function(e,t,n,r,i,o){var a=n.auth("DICTIONARIES:VIEW"),s=n.auth("DICTIONARIES:MANAGE");e.map("/prodFunctions",a,function(){t.loadPage(["app/core/pages/ListPage","app/prodFunctions/views/decorateProdFunction"],function(e,t){return new e({collection:i,columns:["_id","label","fteMasterPosition","direct","companies"],serializeRow:t})})}),e.map("/prodFunctions/:id",function(e){t.loadPage(["app/core/pages/DetailsPage","app/prodFunctions/views/ProdFunctionDetailsView"],function(t,n){return new t({DetailsView:n,model:new o({_id:e.params.id})})})}),e.map("/prodFunctions;add",s,function(){t.loadPage(["app/core/pages/AddFormPage","app/prodFunctions/views/ProdFunctionFormView"],function(e,t){return new e({FormView:t,model:new o})})}),e.map("/prodFunctions/:id;edit",s,function(e){t.loadPage(["app/core/pages/EditFormPage","app/prodFunctions/views/ProdFunctionFormView"],function(t,n){return new t({FormView:n,model:new o({_id:e.params.id})})})}),e.map("/prodFunctions/:id;delete",s,r.bind(null,o))}),define("app/nls/prodLines",["app/nls/locale/en"],function(e){var t={locale:{}};t.locale.en=e;var n=function(e){if(!e)throw new Error("MessageFormat: No data passed to function.")},r=function(e,t){return n(e),e[t]};return{root:{"BREADCRUMBS:browse":function(){return"Production lines"},"BREADCRUMBS:addForm":function(){return"Adding"},"BREADCRUMBS:editForm":function(){return"Editing"},"BREADCRUMBS:ACTION_FORM:delete":function(){return"Deleting"},"MSG:LOADING_FAILURE":function(){return"Failed to load the production lines :("},"MSG:LOADING_SINGLE_FAILURE":function(){return"Failed to load the production line :("},"MSG:DELETED":function(e){return"Production line <em>"+r(e,"label")+"</em> was deleted."},"PAGE_ACTION:add":function(){return"Add production line"},"PAGE_ACTION:edit":function(){return"Edit production line"},"PAGE_ACTION:delete":function(){return"Delete production line"},"PANEL:TITLE:details":function(){return"Production line's details"},"PANEL:TITLE:addForm":function(){return"Add production line form"},"PANEL:TITLE:editForm":function(){return"Edit production line form"},"LIST:ACTION:production":function(){return"Show the operator's screen"},"PROPERTY:_id":function(){return"ID"},"PROPERTY:description":function(){return"Description"},"PROPERTY:workCenter":function(){return"WorkCenter"},"FORM:ACTION:add":function(){return"Add production line"},"FORM:ACTION:edit":function(){return"Edit production line"},"FORM:ERROR:addFailure":function(){return"Failed to add the new production line :-("},"FORM:ERROR:editFailure":function(){return"Failed to edit the production line :-("},"ACTION_FORM:DIALOG_TITLE:delete":function(){return"Production line deletion confirmation"},"ACTION_FORM:BUTTON:delete":function(){return"Delete production line"},"ACTION_FORM:MESSAGE:delete":function(){return"Are you sure you want to delete the chosen production line?"},"ACTION_FORM:MESSAGE_SPECIFIC:delete":function(e){return"Are you sure you want to delete the <em>"+r(e,"label")+"</em> production line?"},"ACTION_FORM:MESSAGE_FAILURE:delete":function(){return"Failed to delete the production line :-("}},pl:!0}}),define("app/nls/pl/prodLines",["app/nls/locale/pl"],function(e){var t={locale:{}};t.locale.pl=e;var n=function(e){if(!e)throw new Error("MessageFormat: No data passed to function.")},r=function(e,t){return n(e),e[t]};return{"BREADCRUMBS:browse":function(){return"Linie produkcyjne"},"BREADCRUMBS:addForm":function(){return"Dodawanie"},"BREADCRUMBS:editForm":function(){return"Edycja"},"BREADCRUMBS:ACTION_FORM:delete":function(){return"Usuwanie"},"MSG:LOADING_FAILURE":function(){return"Ładowanie linii produkcyjnych nie powiodło się :("},"MSG:LOADING_SINGLE_FAILURE":function(){return"Ładowanie linii produkcyjnej nie powiodło się :("},"MSG:DELETED":function(e){return"Linii produkcyjna <em>"+r(e,"label")+"</em> została usunięte."},"PAGE_ACTION:add":function(){return"Dodaj linii produkcyjną"},"PAGE_ACTION:edit":function(){return"Edytuj linii produkcyjną"},"PAGE_ACTION:delete":function(){return"Usuń linii produkcyjną"},"LIST:ACTION:production":function(){return"Pokaż formatkę produkcji"},"PANEL:TITLE:details":function(){return"Szczegóły linii produkcyjnej"},"PANEL:TITLE:addForm":function(){return"Formularz dodawania linii produkcyjnej"},"PANEL:TITLE:editForm":function(){return"Formularz edycji linii produkcyjnej"},"PROPERTY:_id":function(){return"ID"},"PROPERTY:description":function(){return"Opis"},"PROPERTY:workCenter":function(){return"WorkCenter"},"FORM:ACTION:add":function(){return"Dodaj linię produkcyjną"},"FORM:ACTION:edit":function(){return"Edytuj linię produkcyjną"},"FORM:ERROR:addFailure":function(){return"Nie udało się dodać linii produkcyjnej :-("},"FORM:ERROR:editFailure":function(){return"Nie udało się zmodyfikować linii produkcyjnej :-("},"ACTION_FORM:DIALOG_TITLE:delete":function(){return"Potwierdzenie usunięcia linii produkcyjnej"},"ACTION_FORM:BUTTON:delete":function(){return"Usuń linię produkcyjną"},"ACTION_FORM:MESSAGE:delete":function(){return"Czy na pewno chcesz bezpowrotnie usunąć wybraną linię produkcyjną?"},"ACTION_FORM:MESSAGE_SPECIFIC:delete":function(e){return"Czy na pewno chcesz bezpowrotnie usunąć linię produkcyjną <em>"+r(e,"label")+"</em>?"},"ACTION_FORM:MESSAGE_FAILURE:delete":function(){return"Nie udało się usunąć linii produkcyjnej :-("}}}),define("app/prodLines/routes",["../router","../viewport","../user","../core/util/showDeleteFormPage","../data/prodLines","./ProdLine","i18n!app/nls/prodLines"],function(e,t,n,r,i,o){var a=n.auth("DICTIONARIES:VIEW"),s=n.auth("DICTIONARIES:MANAGE");e.map("/prodLines",a,function(){t.loadPage(["app/core/pages/ListPage","app/prodLines/views/ProdLineListView"],function(e,t){return new e({ListView:t,collection:i})})}),e.map("/prodLines/:id",function(e){t.loadPage(["app/core/pages/DetailsPage","app/prodLines/views/ProdLineDetailsView"],function(t,n){return new t({DetailsView:n,model:new o({_id:e.params.id})})})}),e.map("/prodLines;add",s,function(){t.loadPage(["app/core/pages/AddFormPage","app/prodLines/views/ProdLineFormView"],function(e,t){return new e({FormView:t,model:new o})})}),e.map("/prodLines/:id;edit",s,function(e){t.loadPage(["app/core/pages/EditFormPage","app/prodLines/views/ProdLineFormView"],function(t,n){return new t({FormView:n,model:new o({_id:e.params.id})})})}),e.map("/prodLines/:id;delete",s,r.bind(null,o))}),define("app/prodTasks/ProdTask",["../core/Model"],function(e){return e.extend({urlRoot:"/prodTasks",clientUrlRoot:"#prodTasks",topicPrefix:"prodTasks",privilegePrefix:"DICTIONARIES",nlsDomain:"prodTasks",labelAttribute:"name",defaults:{name:null,tags:null,fteDiv:!1,inProd:!0,clipColor:"#eeee00"},parse:function(e){return Array.isArray(e.tags)||(e.tags=[]),e.clipColor||(e.clipColor="#eeee00"),e}})}),define("app/prodTasks/ProdTaskCollection",["../core/Collection","./ProdTask"],function(e,t){return e.extend({model:t,rqlQuery:"select(name,tags,fteDiv,inProd,clipColor)&sort(name)"})}),define("app/nls/prodTasks",["app/nls/locale/en"],function(e){var t={locale:{}};t.locale.en=e;var n=function(e){if(!e)throw new Error("MessageFormat: No data passed to function.")},r=function(e,t){return n(e),e[t]};return{root:{"BREADCRUMBS:browse":function(){return"Production tasks"},"BREADCRUMBS:addForm":function(){return"Adding"},"BREADCRUMBS:editForm":function(){return"Editing"},"BREADCRUMBS:ACTION_FORM:delete":function(){return"Deleting"},"MSG:LOADING_FAILURE":function(){return"Failed to load the production task :("},"MSG:LOADING_SINGLE_FAILURE":function(){return"Failed to load the production task :("},"MSG:DELETED":function(e){return"Production task <em>"+r(e,"label")+"</em> was deleted."},"PAGE_ACTION:add":function(){return"Add production task"},"PAGE_ACTION:edit":function(){return"Edit production task"},"PAGE_ACTION:delete":function(){return"Delete production task"},"PANEL:TITLE:details":function(){return"Production task's details"},"PANEL:TITLE:addForm":function(){return"Add production task form"},"PANEL:TITLE:editForm":function(){return"Edit production task form"},"PROPERTY:_id":function(){return"ID"},"PROPERTY:name":function(){return"Name"},"PROPERTY:tags":function(){return"Tags"},"PROPERTY:fteDiv":function(){return"Divide per Division in FTE (distribution)?"},"PROPERTY:clipColor":function(){return"Color in CLIP"},"PROPERTY:inProd":function(){return"Use in Productivity?"},"FORM:ACTION:add":function(){return"Add production task"},"FORM:ACTION:edit":function(){return"Edit production task"},"FORM:ERROR:addFailure":function(){return"Failed to add the new production task :-("},"FORM:ERROR:editFailure":function(){return"Failed to edit the production task :-("},"ACTION_FORM:DIALOG_TITLE:delete":function(){return"Production task deletion confirmation"},"ACTION_FORM:BUTTON:delete":function(){return"Delete production task"},"ACTION_FORM:MESSAGE:delete":function(){return"Are you sure you want to delete the chosen production task?"},"ACTION_FORM:MESSAGE_SPECIFIC:delete":function(e){return"Are you sure you want to delete the <em>"+r(e,"label")+"</em> production task?"},"ACTION_FORM:MESSAGE_FAILURE:delete":function(){return"Failed to delete the production task :-("}},pl:!0}}),define("app/nls/pl/prodTasks",["app/nls/locale/pl"],function(e){var t={locale:{}};t.locale.pl=e;var n=function(e){if(!e)throw new Error("MessageFormat: No data passed to function.")},r=function(e,t){return n(e),e[t]};return{"BREADCRUMBS:browse":function(){return"Zadania produkcyjne"},"BREADCRUMBS:addForm":function(){return"Dodawanie"},"BREADCRUMBS:editForm":function(){return"Edycja"},"BREADCRUMBS:ACTION_FORM:delete":function(){return"Usuwanie"},"MSG:LOADING_FAILURE":function(){return"Ładowanie zadań produkcyjnych nie powiodło się :("},"MSG:LOADING_SINGLE_FAILURE":function(){return"Ładowanie zadania produkcyjnego nie powiodło się :("},"MSG:DELETED":function(e){return"Zadanie produkcyjne <em>"+r(e,"label")+"</em> zostało usunięte."},"PAGE_ACTION:add":function(){return"Dodaj zadanie produkcyjne"},"PAGE_ACTION:edit":function(){return"Edytuj zadanie produkcyjne"},"PAGE_ACTION:delete":function(){return"Usuń zadanie produkcyjne"},"PANEL:TITLE:details":function(){return"Szczegóły zadania produkcyjnego"},"PANEL:TITLE:addForm":function(){return"Formularz dodawania zadania produkcyjnego"},"PANEL:TITLE:editForm":function(){return"Formularz edycji zadania produkcyjnego"},"PROPERTY:_id":function(){return"ID"},"PROPERTY:name":function(){return"Nazwa"},"PROPERTY:tags":function(){return"Tagi"},"PROPERTY:fteDiv":function(){return"Podział na wydziały w FTE (magazyn)?"},"PROPERTY:clipColor":function(){return"Kolor w raporcie CLIP"},"PROPERTY:inProd":function(){return"Użyj w Produktywności?"},"FORM:ACTION:add":function(){return"Dodaj zadanie produkcyjne"},"FORM:ACTION:edit":function(){return"Edytuj zadanie produkcyjne"},"FORM:ERROR:addFailure":function(){return"Nie udało się dodać zadania produkcyjnego :-("},"FORM:ERROR:editFailure":function(){return"Nie udało się zmodyfikować zadania produkcyjnego :-("},"ACTION_FORM:DIALOG_TITLE:delete":function(){return"Potwierdzenie usunięcia zadania produkcyjnego"},"ACTION_FORM:BUTTON:delete":function(){return"Usuń zadanie produkcyjne"},"ACTION_FORM:MESSAGE:delete":function(){return"Czy na pewno chcesz bezpowrotnie usunąć wybrany zadanie produkcyjne?"},"ACTION_FORM:MESSAGE_SPECIFIC:delete":function(e){return"Czy na pewno chcesz bezpowrotnie usunąć zadanie produkcyjne <em>"+r(e,"label")+"</em>?"},"ACTION_FORM:MESSAGE_FAILURE:delete":function(){return"Nie udało się usunąć zadania produkcyjnego :-("}}}),define("app/prodTasks/routes",["../router","../viewport","../user","../core/util/showDeleteFormPage","./ProdTaskCollection","./ProdTask","i18n!app/nls/prodTasks"],function(e,t,n,r,i,o){var a=n.auth("DICTIONARIES:VIEW"),s=n.auth("DICTIONARIES:MANAGE");e.map("/prodTasks",a,function(e){t.loadPage(["app/core/pages/ListPage","app/prodTasks/views/ProdTaskListView"],function(t,n){return new t({ListView:n,collection:new i({rqlQuery:e.rql})})})}),e.map("/prodTasks/:id",function(e){t.loadPage(["app/core/pages/DetailsPage","app/prodTasks/templates/details"],function(t,n){return new t({model:new o({_id:e.params.id}),detailsTemplate:n})})}),e.map("/prodTasks;add",s,function(){t.loadPage("app/prodTasks/pages/AddProdTaskFormPage",function(e){return new e({model:new o})})}),e.map("/prodTasks/:id;edit",s,function(e){t.loadPage("app/prodTasks/pages/EditProdTaskFormPage",function(t){return new t({model:new o({_id:e.params.id})})})}),e.map("/prodTasks/:id;delete",s,r.bind(null,o))}),define("app/core/util/matchesOperType",["underscore"],function(e){return function(t,n){var r=e.find(t.selector.args,function(e){return"eq"===e.name&&"type"===e.args[0]});return r?-1!==n.indexOf(r.args[1]):!0}}),define("app/core/util/matchesProdLine",["underscore","app/user","app/data/prodLines"],function(e,t,n){return function(r,i){var o=e.find(r.selector.args,function(e){return"eq"===e.name&&"prodLine"===e.args[0]});if(o)return o.args[1]===i;if(t.data.super)return!0;var a=n.get(i);if(!a)return!0;var s=t.getDivision();if(!s)return!0;var u=t.getSubdivision(),l=a.getSubdivision();return u?u===l:s.id===l.get("division")}}),define("app/prodLogEntries/ProdLogEntry",["../core/Model"],function(e){return e.extend({urlRoot:"/prodLogEntries",clientUrlRoot:"#prodLogEntries",topicPrefix:"prodLogEntries",privilegePrefix:"PROD_DATA",nlsDomain:"prodLogEntries",defaults:{type:null}})}),define("app/prodLogEntries/ProdLogEntryCollection",["underscore","../user","../data/prodLines","../core/Collection","../core/util/matchesOperType","../core/util/matchesProdLine","./ProdLogEntry"],function(e,t,n,r,i,o,a){return r.extend({model:a,rqlQuery:function(e){return e.Query.fromObject({fields:{},sort:{createdAt:-1},limit:20,selector:{name:"and",args:[]}})},matches:function(e){return i(this.rqlQuery,e.types)&&o(this.rqlQuery,e.prodLine)}})}),define("app/core/templates/userInfo",["app/i18n"],function(t){return function anonymous(locals,filters,escape,rethrow){escape=escape||function(e){return String(e).replace(/&(?!#?[a-zA-Z0-9]+;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&#39;").replace(/"/g,"&quot;")};var buf=[];with(locals||{})!function(){buf.push('<span class="userInfo">\n  '),userInfo?(buf.push("\n  ",escape(userInfo.label),"\n  "),(userInfo.cname||userInfo.ip)&&buf.push("\n  (",escape(userInfo.cname||userInfo.ip),")\n  "),buf.push("\n  ")):buf.push("\n  -\n  "),buf.push("\n</span>\n")}();return buf.join("")}}),define("app/prodLogEntries/views/decorateProdLogEntry",["underscore","app/time","app/i18n","app/data/aors","app/data/prodLines","app/data/downtimeReasons","app/data/views/renderOrgUnitPath","app/core/templates/userInfo"],function(e,t,n,r,i,o,a,s){function u(t,r){var i=e.without(Object.keys(r),"_id");return"editOrder"===t&&(i=e.without(i,"mechOrder","orderData"),-1!==i.indexOf("orderId")&&(i=e.without(i,"operationNo"))),i.map(function(e){return n(l[t],"PROPERTY:"+e)}).join(", ")}var l={editShift:"prodShifts",editOrder:"prodShiftOrders",editDowntime:"prodDowntimes"};return function(e){var i=e.toJSON(),a={};switch(i.type){case"changeShift":a.date=t.format(i.data.startedProdShift.date,"YYYY-MM-DD"),a.shift=n("core","SHIFT:"+i.data.startedProdShift.shift);break;case"changeMaster":case"changeLeader":case"changeOperator":a.name=i.data?i.data.label:"-";break;case"changeQuantitiesDone":a.hour=i.data.hour+1,a.value=i.data.newValue;break;case"changeOrder":case"correctOrder":var l=i.data.orderData&&i.data.orderData.operations?i.data.orderData.operations[i.data.operationNo]:null;a.orderId=i.data.orderId,a.orderName=i.data.orderData.name||"?",a.operationNo=i.data.operationNo,a.operationName=l?l.name:"?";break;case"changeQuantityDone":case"changeWorkerCount":a.value=i.data.newValue;break;case"startDowntime":var c=o.get(i.data.reason),d=r.get(i.data.aor);a._id=i.data._id,a.reason=c?c.getLabel():i.data.reason,a.aor=d?d.getLabel():i.data.aor;break;case"editShift":case"editOrder":case"editDowntime":"editDowntime"===i.type&&(a._id=i.data._id),a.changedProperties=u(i.type,i.data);break;default:a=i.data}var p=null;return i.savedAt&&(p=(Date.parse(i.savedAt)-Date.parse(i.createdAt))/1e3),i.data=n("prodLogEntries","data:"+i.type,a),i.type=n("prodLogEntries","type:"+i.type),i.createdAt=t.format(i.createdAt,"YYYY-MM-DD HH:mm:ss"),i.creator=s({userInfo:i.creator}),p&&(i.createdAt+=" ("+(0>p?"-":"+")+t.toString(Math.abs(p),!1,!0)+")"),i.prodShift&&(i.prodShift='<a href="#prodShifts/'+i.prodShift._id+'">'+t.format(i.prodShift.date,"YYYY-MM-DD")+", "+n("core","SHIFT:"+i.prodShift.shift)+"</a>"),i.prodShiftOrder=i.prodShiftOrder?'<a href="#prodShiftOrders/'+i.prodShiftOrder._id+'">'+i.prodShiftOrder.orderId+", "+i.prodShiftOrder.operationNo+"</a>":n("prodLogEntries","noData:prodShiftOrder"),i}}),define("app/prodLogEntries/views/ProdLogEntryListView",["underscore","app/i18n","app/user","app/viewport","app/core/views/ListView","app/data/prodLines","app/data/views/renderOrgUnitPath","./decorateProdLogEntry"],function(e,t,n,r,i,o,a,s){return i.extend({remoteTopics:{"production.synced.**":"refreshCollection","production.edited.**":function(){this.refreshCollection()}},columns:["prodLine","type","data","prodShift","prodShiftOrder","createdAt","creator"],serializeRows:function(){return this.collection.map(s)},serializeActions:function(){return null},afterRender:function(){i.prototype.afterRender.call(this);var e=this;this.$('.list-item > td[data-id="prodLine"]').popover({container:this.el,trigger:"hover",placement:"auto right",html:!0,content:function(){var t=a(o.get(e.$(this).text().trim()),!1,!1);return t?t.split(" \\ ").join("<br>\\ "):"?"}})},refreshCollection:function(e){return!e||this.collection.matches(e)?i.prototype.refreshCollection.apply(this,arguments):void 0}})}),define("app/prodLogEntries/templates/filter",["app/i18n"],function(t){return function anonymous(locals,filters,escape,rethrow){escape=escape||function(e){return String(e).replace(/&(?!#?[a-zA-Z0-9]+;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&#39;").replace(/"/g,"&quot;")};var buf=[];with(locals||{})!function(){buf.push('<div class="well">\n  <form id="',idPrefix,'-form" class="filter-form">\n    <div class="form-group">\n      <label for="',idPrefix,'-from">',t("prodLogEntries","FILTER:DATE:FROM"),'</label>\n      <div id="',idPrefix,'-from" class="form-group-datetime">\n        <input id="',idPrefix,'-from-date" class="form-control" name="from-date" type="date" placeholder="YYYY-MM-DD">\n        <input id="',idPrefix,'-from-time" class="form-control" name="from-time" type="time" placeholder="hh:mm">\n      </div>\n    </div><div\n      class="form-group">\n      <label for="',idPrefix,'-to">',t("prodLogEntries","FILTER:DATE:TO"),'</label>\n      <div id="',idPrefix,'-to" class="form-group-datetime">\n        <input id="',idPrefix,'-to-date" class="form-control" name="to-date" type="date" placeholder="YYYY-MM-DD">\n        <input id="',idPrefix,'-to-time" class="form-control" name="to-time" type="time" placeholder="hh:mm">\n      </div>\n    </div><div\n      class="form-group">\n      <label for="',idPrefix,'-prodLine">',t("prodLogEntries","PROPERTY:prodLine"),'</label>\n      <input id="',idPrefix,'-prodLine" name="prodLine" type="text" data-placeholder="',t("prodLogEntries","FILTER:PLACEHOLDER:prodLine"),'">\n    </div><div\n      class="form-group">\n      <label for="',idPrefix,'-type">',t("prodLogEntries","PROPERTY:type"),'</label>\n      <select id="',idPrefix,'-type" name="type" data-placeholder="',t("prodLogEntries","FILTER:PLACEHOLDER:type"),'">\n        <option></option>\n        <option value="changeShift">',t("prodLogEntries","type:changeShift"),'</option>\n        <option value="changeMaster">',t("prodLogEntries","type:changeMaster"),'</option>\n        <option value="changeLeader">',t("prodLogEntries","type:changeLeader"),'</option>\n        <option value="changeOperator">',t("prodLogEntries","type:changeOperator"),'</option>\n        <option value="changeQuantitiesDone">',t("prodLogEntries","type:changeQuantitiesDone"),'</option>\n        <option value="changeOrder">',t("prodLogEntries","type:changeOrder"),'</option>\n        <option value="correctOrder">',t("prodLogEntries","type:correctOrder"),'</option>\n        <option value="changeQuantityDone">',t("prodLogEntries","type:changeQuantityDone"),'</option>\n        <option value="changeWorkerCount">',t("prodLogEntries","type:changeWorkerCount"),'</option>\n        <option value="finishOrder">',t("prodLogEntries","type:finishOrder"),'</option>\n        <option value="startDowntime">',t("prodLogEntries","type:startDowntime"),'</option>\n        <option value="finishDowntime">',t("prodLogEntries","type:finishDowntime"),'</option>\n        <option value="corroborateDowntime">',t("prodLogEntries","type:corroborateDowntime"),'</option>\n        <option value="endWork">',t("prodLogEntries","type:endWork"),'</option>\n        <option value="editShift">',t("prodLogEntries","type:editShift"),'</option>\n        <option value="editOrder">',t("prodLogEntries","type:editOrder"),'</option>\n        <option value="editDowntime">',t("prodLogEntries","type:editDowntime"),'</option>\n        <option value="deleteOrder">',t("prodLogEntries","type:deleteOrder"),'</option>\n        <option value="deleteDowntime">',t("prodLogEntries","type:deleteDowntime"),'</option>\n      </select>\n    </div><div\n      class="form-group">\n      <label for="',idPrefix,'-limit">',t("prodLogEntries","FILTER:LIMIT"),'</label>\n      <input id="',idPrefix,'-limit" class="form-control" name="limit" type="number" value="25" min="5" max="100" step="1">\n    </div><div\n      class="form-group filter-actions">\n      <input type="submit" class="btn btn-primary" value="',escape(t("prodLogEntries","FILTER:BUTTON")),'">\n    </div>\n  </form>\n</div>\n')
}();return buf.join("")}}),define("app/prodLogEntries/views/ProdLogEntryFilterView",["underscore","moment","js2form","reltime","app/i18n","app/user","app/data/prodLines","app/core/View","app/core/util/fixTimeRange","app/prodLogEntries/templates/filter","select2"],function(e,t,n,r,i,o,a,s,u,l){return s.extend({template:l,events:{"submit .filter-form":function(e){e.preventDefault(),this.changeFilter()}},initialize:function(){this.idPrefix=e.uniqueId("prodLogEntryFilter")},destroy:function(){this.$('.select2-offscreen[tabindex="-1"]').select2("destroy")},serialize:function(){return{idPrefix:this.idPrefix}},afterRender:function(){var e=this.serializeRqlQuery();n(this.el.querySelector(".filter-form"),e),this.$id("prodLine").select2({width:"275px",allowClear:!o.getDivision(),data:this.getApplicableProdLines()}),this.$id("type").select2({width:"275px",allowClear:!0})},getApplicableProdLines:function(){return a.getForCurrentUser().map(function(e){return{id:e.id,text:e.getLabel()}})},serializeRqlQuery:function(){var e=this.model.rqlQuery,t={createdAt:"",prodLine:null,type:null,limit:e.limit<5?5:e.limit>100?100:e.limit};return e.selector.args.forEach(function(e){var n=e.args[0];switch(n){case"createdAt":u.toFormData(t,e,"date+time");break;case"prodLine":case"type":"eq"===e.name&&(t[n]=e.args[1])}}),t},changeFilter:function(){var e=this.model.rqlQuery,t=u.fromView(this,{defaultTime:"06:00"}),n=[],r=this.$id("prodLine").val(),i=this.$id("type").val();r&&r.length&&n.push({name:"eq",args:["prodLine",r]}),i&&i.length&&n.push({name:"eq",args:["type",i]}),t.from&&n.push({name:"ge",args:["createdAt",t.from]}),t.to&&n.push({name:"le",args:["createdAt",t.to]}),e.selector={name:"and",args:n},e.limit=parseInt(this.$id("limit").val(),10)||15,e.skip=0,this.trigger("filterChanged",e)}})}),define("app/prodLogEntries/templates/listPage",["app/i18n"],function(t){return function anonymous(locals,filters,escape,rethrow){escape=escape||function(e){return String(e).replace(/&(?!#?[a-zA-Z0-9]+;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&#39;").replace(/"/g,"&quot;")};var buf=[];with(locals||{})!function(){buf.push('<div>\n  <div class="filter-container"></div>\n  <div class="prodLogEntries-list-container"></div>\n</div>\n')}();return buf.join("")}}),define("app/prodLogEntries/pages/ProdLogEntryListPage",["jquery","app/i18n","app/viewport","app/core/util/bindLoadingMessage","app/core/util/pageActions","app/core/View","../ProdLogEntryCollection","../views/ProdLogEntryListView","../views/ProdLogEntryFilterView","app/prodLogEntries/templates/listPage"],function(e,t,n,r,i,o,a,s,u,l){return o.extend({template:l,layoutName:"page",pageId:"prodLogEntryList",breadcrumbs:[t.bound("prodLogEntries","BREADCRUMBS:browse")],initialize:function(){this.defineModels(),this.defineViews(),this.setView(".filter-container",this.filterView),this.setView(".prodLogEntries-list-container",this.listView)},defineModels:function(){this.prodLogEntryList=r(new a(null,{rqlQuery:this.options.rql}),this)},defineViews:function(){this.listView=new s({collection:this.prodLogEntryList}),this.filterView=new u({model:{rqlQuery:this.prodLogEntryList.rqlQuery}}),this.listenTo(this.filterView,"filterChanged",this.refreshList)},load:function(e){return e(this.prodLogEntryList.fetch({reset:!0}))},refreshList:function(e){this.prodLogEntryList.rqlQuery=e,this.listView.refreshCollection(null,!0),this.broker.publish("router.navigate",{url:this.prodLogEntryList.genClientUrl()+"?"+e,trigger:!1,replace:!0})}})}),define("app/nls/prodLogEntries",["app/nls/locale/en"],function(e){var t={locale:{}};t.locale.en=e;var n=function(e){if(!e)throw new Error("MessageFormat: No data passed to function.")},r=function(e,t){return n(e),e[t]},i=function(e,t,r){return n(e),e[t]in r?r[e[t]]:r.other};return{root:{"BREADCRUMBS:browse":function(){return"Operation log"},"MSG:LOADING_FAILURE":function(){return"Failed to load the operation log :("},"FILTER:DATE:FROM":function(){return"From"},"FILTER:DATE:TO":function(){return"To"},"FILTER:LIMIT":function(){return"Limit"},"FILTER:BUTTON":function(){return"Filter operations"},"FILTER:PLACEHOLDER:type":function(){return"Any type"},"FILTER:PLACEHOLDER:prodLine":function(){return"Any production line"},"PROPERTY:prodLine":function(){return"Production line"},"PROPERTY:type":function(){return"Type"},"PROPERTY:createdAt":function(){return"Created at"},"PROPERTY:creator":function(){return"Creator"},"PROPERTY:data":function(){return"Additional info"},"PROPERTY:prodShift":function(){return"Shift"},"PROPERTY:prodShiftOrder":function(){return"Order"},"type:changeShift":function(){return"Shift start"},"type:changeMaster":function(){return"Master change"},"type:changeLeader":function(){return"Leader change"},"type:changeOperator":function(){return"Operator change"},"type:changeQuantitiesDone":function(){return"Quantities done in an hour change"},"type:changeOrder":function(){return"Order start"},"type:changeQuantityDone":function(){return"Order's quantity done change"},"type:changeWorkerCount":function(){return"Order's worker count change"},"type:correctOrder":function(){return"Order correction"},"type:finishOrder":function(){return"Order finish"},"type:startDowntime":function(){return"Downtime start"},"type:finishDowntime":function(){return"Downtime finish"},"type:corroborateDowntime":function(){return"Downtime corroboration"},"type:endWork":function(){return"End of work"},"type:editShift":function(){return"Shift edit"},"type:editOrder":function(){return"Order edit"},"type:editDowntime":function(){return"Downtime edit"},"type:deleteDowntime":function(){return"Downtime deletion"},"type:deleteOrder":function(){return"Order deletion"},"data:changeShift":function(e){return"Shift <em>"+r(e,"shift")+"</em> on <em>"+r(e,"date")+"</em>"},"data:changeMaster":function(e){return"New master: <em>"+r(e,"name")+"</em>"},"data:changeLeader":function(e){return"New leader: <em>"+r(e,"name")+"</em>"},"data:changeOperator":function(e){return"New operator: <em>"+r(e,"name")+"</em>"},"data:changeQuantitiesDone":function(e){return"Quantity done in the <em>"+r(e,"hour")+".</em> hour: <em>"+r(e,"value")+"</em>"},"data:changeOrder":function(e){return"Order: <em>"+r(e,"orderId")+"</em> (<em>"+r(e,"orderName")+"</em>); operation: <em>"+r(e,"operationNo")+"</em> (<em>"+r(e,"operationName")+"</em>)"},"data:changeQuantityDone":function(e){return"Quantity done in the order: <em>"+r(e,"value")+"</em>"},"data:changeWorkerCount":function(e){return"Worker count in the order: <em>"+r(e,"value")+"</em>"},"data:correctOrder":function(e){return"Order: <em>"+r(e,"orderId")+"</em> (<em>"+r(e,"orderName")+"</em>); operation: <em>"+r(e,"operationNo")+"</em> (<em>"+r(e,"operationName")+"</em>)"},"data:finishOrder":function(){return"-"},"data:startDowntime":function(e){return"<a href='#prodDowntimes/"+r(e,"_id")+"'>Reason: <em>"+r(e,"reason")+"</em>; AOR: <em>"+r(e,"aor")+"</em></a>"},"data:finishDowntime":function(e){return"Finished <a href='#prodDowntimes/"+r(e,"_id")+"'>downtime</a>."},"data:corroborateDowntime":function(e){return i(e,"status",{confirmed:"Confirmed",rejected:"Rejected",other:"Corroborated"})+" <a href='#prodDowntimes/"+r(e,"_id")+"'>downtime</a>."},"data:endWork":function(){return"-"},"data:editShift":function(e){return"Changed attributes: <em>"+r(e,"changedProperties")+"</em>"},"data:editOrder":function(e){return"Changed attributes: <em>"+r(e,"changedProperties")+"</em>"},"data:editDowntime":function(e){return"Changed attributes of <a href='#prodDowntimes/"+r(e,"_id")+"'>downtime</a>: <em>"+r(e,"changedProperties")+"</em>"},"data:deleteDowntime":function(e){return"Deleted downtime <em>"+r(e,"rid")+"</em>"},"data:deleteOrder":function(e){return"Deleted order <em>"+r(e,"orderId")+"; "+r(e,"operationNo")+"</em>"},"noData:prodShiftOrder":function(){return"<em>no order</em>"}},pl:!0}}),define("app/nls/pl/prodLogEntries",["app/nls/locale/pl"],function(e){var t={locale:{}};t.locale.pl=e;var n=function(e){if(!e)throw new Error("MessageFormat: No data passed to function.")},r=function(e,t){return n(e),e[t]},i=function(e,t,r){return n(e),e[t]in r?r[e[t]]:r.other};return{"BREADCRUMBS:browse":function(){return"Historia operacji na liniach produkcyjnych"},"MSG:LOADING_FAILURE":function(){return"Ładowanie historii operacji nie powiodło się :("},"FILTER:DATE:FROM":function(){return"Od"},"FILTER:DATE:TO":function(){return"Do"},"FILTER:LIMIT":function(){return"Limit"},"FILTER:BUTTON":function(){return"Filtruj historię"},"FILTER:PLACEHOLDER:type":function(){return"Dowolny typ"},"FILTER:PLACEHOLDER:prodLine":function(){return"Dowolna linia produkcyjna"},"PROPERTY:prodLine":function(){return"Linia produkcyjna"},"PROPERTY:type":function(){return"Typ"},"PROPERTY:createdAt":function(){return"Czas operacji"},"PROPERTY:creator":function(){return"Wykonawca operacji"},"PROPERTY:data":function(){return"Dodatkowe informacje"},"PROPERTY:prodShift":function(){return"Zmiana"},"PROPERTY:prodShiftOrder":function(){return"Zlecenie"},"type:changeShift":function(){return"Rozpoczęcie zmiany"},"type:changeMaster":function(){return"Zmiana mistrza"},"type:changeLeader":function(){return"Zmiana lidera"},"type:changeOperator":function(){return"Zmiana operatora"},"type:changeQuantitiesDone":function(){return"Zmiana wykonanej ilości w godzinie"},"type:changeOrder":function(){return"Rozpoczęcie zlecenia"},"type:changeQuantityDone":function(){return"Zmiana wykonanej ilości w zleceniu"},"type:changeWorkerCount":function(){return"Zmiana ilości osób w zleceniu"},"type:correctOrder":function(){return"Poprawa zlecenia"},"type:finishOrder":function(){return"Zakończenie zlecenia"},"type:startDowntime":function(){return"Rozpoczęcie przestoju"},"type:finishDowntime":function(){return"Zakończenie przestoju"},"type:corroborateDowntime":function(){return"Potwierdzenie przestoju"},"type:endWork":function(){return"Zakończenie pracy"},"type:editShift":function(){return"Edycja zmiany"},"type:editOrder":function(){return"Edycja zlecenia"},"type:editDowntime":function(){return"Edycja przestoju"},"type:deleteDowntime":function(){return"Usunięcie przestoju"},"type:deleteOrder":function(){return"Usunięcie zlecenia"},"data:changeShift":function(e){return"Zmiana <em>"+r(e,"shift")+"</em> z dnia <em>"+r(e,"date")+"</em>"},"data:changeMaster":function(e){return"Nowy mistrz: <em>"+r(e,"name")+"</em>"},"data:changeLeader":function(e){return"Nowy lider: <em>"+r(e,"name")+"</em>"},"data:changeOperator":function(e){return"Nowy operator: <em>"+r(e,"name")+"</em>"},"data:changeQuantitiesDone":function(e){return"Wykonana ilość w <em>"+r(e,"hour")+".</em> godzinie: <em>"+r(e,"value")+"</em>"},"data:changeOrder":function(e){return"Zlecenie: <em>"+r(e,"orderId")+"</em> (<em>"+r(e,"orderName")+"</em>); operacja: <em>"+r(e,"operationNo")+"</em> (<em>"+r(e,"operationName")+"</em>)"},"data:changeQuantityDone":function(e){return"Wykonana ilość w zleceniu: <em>"+r(e,"value")+"</em>"},"data:changeWorkerCount":function(e){return"Ilość osób w zleceniu: <em>"+r(e,"value")+"</em>"},"data:correctOrder":function(e){return"Zlecenie: <em>"+r(e,"orderId")+"</em> (<em>"+r(e,"orderName")+"</em>); operacja: <em>"+r(e,"operationNo")+"</em> (<em>"+r(e,"operationName")+"</em>)"},"data:finishOrder":function(){return"-"},"data:startDowntime":function(e){return"<a href='#prodDowntimes/"+r(e,"_id")+"'>Powód: <em>"+r(e,"reason")+"</em>; obszar odpowiedzialności: <em>"+r(e,"aor")+"</em></a>"},"data:finishDowntime":function(e){return"Zakończono <a href='#prodDowntimes/"+r(e,"_id")+"'>przestój</a>."},"data:corroborateDowntime":function(e){return i(e,"status",{confirmed:"Zatwierdzono",rejected:"Odrzucono",other:"Potwierdzono"})+" <a href='#prodDowntimes/"+r(e,"_id")+"'>przestój</a>."},"data:endWork":function(){return"-"},"data:editShift":function(e){return"Zmienione atrybuty: <em>"+r(e,"changedProperties")+"</em>"},"data:editOrder":function(e){return"Zmienione atrybuty: <em>"+r(e,"changedProperties")+"</em>"},"data:editDowntime":function(e){return"Zmienione atrybuty <a href='#prodDowntimes/"+r(e,"_id")+"'>przestoju</a>: <em>"+r(e,"changedProperties")+"</em>"},"data:deleteDowntime":function(e){return"Usunięto przestój <em>"+r(e,"rid")+"</em>."},"data:deleteOrder":function(e){return"Usunięto zlecenie <em>"+r(e,"orderId")+"; "+r(e,"operationNo")+"</em>."},"noData:prodShiftOrder":function(){return"<em>brak zlecenia</em>"}}}),define("app/prodLogEntries/routes",["../router","../viewport","../user","./pages/ProdLogEntryListPage","i18n!app/nls/prodLogEntries"],function(e,t,n,r){var i=n.auth("PROD_DATA:VIEW");e.map("/prodLogEntries",i,function(e){t.showPage(new r({rql:e.rql}))})}),define("app/data/prodLog",["app/i18n","app/user","app/time","app/broker","app/socket","app/updater/index"],function(e,t,n,r,i,o){function a(){if(null!==g){var e=m.getItem(p);null===e?m.setItem(p,g):m.setItem(p,g+"\n"+e),g=null,m.removeItem(f),r.publish("production.synced",{message:"DISCONNECT"})}}function s(){if(y&&i.isConnected()&&null===g&&!o.isRestarting()&&(g=m.getItem(p),null!==g)){m.removeItem(p);var e=m.getItem(f);null!==e&&(g=e+"\n"+g),m.setItem(f,g),r.publish("production.syncing"),i.emit("production.sync",g,function(e){g=null,m.removeItem(f),r.publish("production.synced",e),setTimeout(s,1)})}}function u(e){for(var t=0,n=0,r=e.length;r>n;++n)t=(t<<5)-t+e.charCodeAt(n)|0;return t}function l(e,t){return e.getTime().toString(36)+u(t).toString(36)+Math.round(1e16*Math.random()).toString(36)}function c(){return parseInt(localStorage.getItem(h)||"0",10)}function d(e){localStorage.setItem(h,e)}var p="PRODUCTION:LOG",f="PRODUCTION:LOG:SYNCING",h="PRODUCTION:LOCK",m=localStorage,g=null,y=!1;return r.subscribe("socket.connected",setTimeout.bind(null,s,1337)),r.subscribe("socket.disconnected",a),window.addEventListener("unload",a),i.isConnected()&&s(),{generateId:l,isEnabled:function(){return y},enable:function(){if(!y){var t=c();if(0!==t){var n=window.confirm(e("production","locked"));if(!n)return}d(1),y=!0}},disable:function(){y&&(d(0),y=!1)},isSyncing:function(){return null!==g},record:function(e,r,i){if(!e.isLocked()){if(!y)throw new Error("Production log is disabled!");var o={secretKey:e.getSecretKey(),type:r,data:i||{},createdAt:n.getMoment().toDate(),creator:t.getInfo(),division:e.get("division"),subdivision:e.get("subdivision"),mrpControllers:e.get("mrpControllers"),prodFlow:e.get("prodFlow"),workCenter:e.get("workCenter"),prodLine:e.prodLine.id,prodShift:e.id,prodShiftOrder:e.prodShiftOrder.id||null};o._id=l(o.createdAt,e.id);var a,u=localStorage.getItem(p);a=null===u?JSON.stringify(o):u+"\n"+JSON.stringify(o),m.setItem(p,a),e.saveLocalData(),setTimeout(s,1)}}}}),define("app/prodShiftOrders/ProdShiftOrder",["underscore","../user","../time","../data/prodLog","../data/subdivisions","../core/Model","../core/util/getShiftEndDate"],function(e,t,n,r,i,o,a){return o.extend({urlRoot:"/prodShiftOrders",clientUrlRoot:"#prodShiftOrders",topicPrefix:"prodShiftOrders",privilegePrefix:"PROD_DATA",nlsDomain:"prodShiftOrders",defaults:{pressWorksheet:null,prodShift:null,division:null,subdivision:null,mrpControllers:null,prodFlow:null,workCenter:null,prodLine:null,date:null,shift:null,mechOrder:null,orderId:null,operationNo:null,orderData:null,workerCount:null,totalQuantity:null,quantityDone:null,quantityLost:null,creator:null,startedAt:null,finishedAt:null,master:null,leader:null,operator:null,operators:null},getLabel:function(){return this.get("prodLine")+": "+this.get("orderId")+", "+this.get("operationNo")},onShiftChanged:function(){this.set({_id:null,prodShift:null,division:null,subdivision:null,mrpControllers:null,prodFlow:null,workCenter:null,prodLine:null,date:null,shift:null,workerCount:null,totalQuantity:null,quantityDone:null,quantityLost:null,losses:null,creator:null,startedAt:null,finishedAt:null,master:null,leader:null,operator:null,operators:null})},onOrderChanged:function(e,r,i){this.prepareOperations(r),this.set({prodShift:e.id,division:e.get("division"),subdivision:e.get("subdivision"),mrpControllers:e.get("mrpControllers"),prodFlow:e.get("prodFlow"),workCenter:e.get("workCenter"),prodLine:e.prodLine.id,date:e.get("date"),shift:e.get("shift"),mechOrder:null===r.no,orderId:r.no||r.nc12,operationNo:i,orderData:r,workerCount:0,totalQuantity:0,quantityDone:0,quantityLost:0,losses:null,creator:t.getInfo(),startedAt:n.getMoment().toDate(),finishedAt:null,master:e.get("master"),leader:e.get("leader"),operator:e.get("operator"),operators:e.get("operators")}),this.generateId(e)},onOrderCorrected:function(e,n,r){var i=n.no||n.nc12;if(i===this.get("orderId")&&r===this.get("operationNo"))return null;this.prepareOperations(n);var o={mechOrder:null===n.no,orderId:i,operationNo:r,orderData:n,creator:t.getInfo()};return this.set(o),this.get("workerCount")>this.getMaxWorkerCount()&&e.changeWorkerCount(0),this.get("quantityDone")>this.getMaxQuantityDone()&&e.changeQuantityDone(0),o},onOrderContinued:function(e){this.set({prodShift:e.id,division:e.get("division"),subdivision:e.get("subdivision"),mrpControllers:e.get("mrpControllers"),prodFlow:e.get("prodFlow"),workCenter:e.get("workCenter"),prodLine:e.prodLine.id,date:e.get("date"),shift:e.get("shift"),workerCount:0,totalQuantity:0,quantityDone:0,quantityLost:0,losses:null,creator:t.getInfo(),startedAt:n.getMoment().toDate(),finishedAt:null,master:e.get("master"),leader:e.get("leader"),operator:e.get("operator"),operators:e.get("operators")}),this.generateId(e)},generateId:function(e){this.set("_id",r.generateId(this.get("startedAt"),e.id+this.get("orderId")))},onWorkEnded:function(){this.clear()},isMechOrder:function(){return this.get("mechOrder")},getOrderNo:function(){var e=this.get("orderData");return e?e.no||"?":"-"},getNc12:function(){var e=this.get("orderData");return e?e.nc12||"?":"-"},getProductName:function(){var e=this.get("orderData");return e?e.name||"?":"-"},getOperationName:function(){var e=this.get("orderData"),t=this.get("operationNo");return e&&t?e.operations&&e.operations[t]?e.operations[t].name||t:t:"-"},getTaktTime:function(){var e=this.get("orderData"),t=this.get("operationNo");if(!e||!t)return"-";var n=e.operations?e.operations[t]:null;if(!n)return"?";var r=this.get("workerCount");return r||(r=this.getWorkerCountSap()),"number"!=typeof r||0===r||n.laborTime<=0?"?":Math.max(Math.round(1.053*n.laborTime/r*3600/100),1)},getActualTaktTime:function(){var e=n.getMoment(this.get("finishedAt"));if(!e.isValid())return"-";var t=e.diff(this.get("startedAt"),"seconds"),r=this.get("quantityDone");return r?Math.max(1,Math.round(t/r)):"?"},getWorkerCountSap:function(){var e=this.get("orderData"),t=this.get("operationNo");if(!e||!t)return"-";var n=e.operations?e.operations[t]:null;return!n||n.laborTime<=0||n.machineTime<=0?"?":Math.max(Math.round(n.laborTime/n.machineTime),1)},getWorkerCount:function(){return this.get("workerCount")||0},getWorkerCountForEdit:function(){var e=this.getWorkerCount();return 0!==e?e:(e=this.getWorkerCountSap(),"string"==typeof e||0===e?0:e)},getMaxWorkerCount:function(){var e=this.getWorkerCountSap();return"number"==typeof e?e+Math.max(1,Math.round(.25*e)):15},getMaxQuantityDone:function(){var e=this.get("orderData");return e&&e.qty?Math.ceil(1.25*e.qty):999},getStartedAt:function(){var e=this.get("startedAt");return e?n.format(e,"HH:mm:ss"):"?"},getQuantityDone:function(){return this.get("quantityDone")||0},getSubdivisionType:function(){var e=i.get(this.get("subdivision"));return e?e.get("type"):null},getOrderIdType:function(){return"press"===this.getSubdivisionType()?"nc12":"no"},hasOrderData:function(){return!!this.get("orderId")&&!!this.get("operationNo")&&!!this.get("orderData")},isEditable:function(){return this.hasEnded()&&!this.isFromPressWorksheet()},hasEnded:function(){return null!=this.get("finishedAt")},isFromPressWorksheet:function(){return null!=this.get("pressWorksheet")},finish:function(){if(!this.id||this.hasEnded())return null;var e=n.getMoment().toDate(),t=a(this.get("date"),this.get("shift"));return e>t&&(e=t),this.set("finishedAt",e),{_id:this.id,finishedAt:e}},prepareOperations:function(t){if(Array.isArray(t.operations)){var n={};t.operations.forEach(function(e){""!==e.workCenter&&-1!==e.laborTime&&(n[e.no]=e)}),t.operations=n}else e.isObject(t.operations)||(t.operations={});return t}})}),define("app/core/util/matchesEquals",["underscore"],function(e){return function(t,n,r){var i=e.find(t.selector.args,function(e){return"eq"===e.name&&e.args[0]===n});return!i||i.args[1]===r}}),define("app/prodShiftOrders/ProdShiftOrderCollection",["underscore","../user","../data/prodLines","../core/Collection","../core/util/matchesEquals","../core/util/matchesProdLine","./ProdShiftOrder"],function(e,t,n,r,i,o,a){return r.extend({model:a,rqlQuery:function(e){return e.Query.fromObject({fields:{creator:0,losses:0},sort:{startedAt:-1},limit:15,selector:{name:"and",args:[]}})},hasOrMatches:function(e){return this.get(e._id)?!0:o(this.rqlQuery,e.prodLine)&&i(this.rqlQuery,"orderId",e.orderId)&&i(this.rqlQuery,"operationNo",e.operationNo)&&i(this.rqlQuery,"shift",e.shift)}})}),define("app/prodShiftOrders/views/decorateProdShiftOrder",["app/time","app/i18n","app/user","app/data/subdivisions","app/data/mrpControllers","app/data/prodFlows","app/data/prodLines","app/data/views/renderOrgUnitPath","app/core/util/getShiftStartInfo","app/core/templates/userInfo"],function(e,t,n,r,i,o,a,s,u,l){return function(i,a){var s=i.toJSON(),c=Date.parse(s.startedAt),d=Date.parse(s.finishedAt);if(s.date)s.date=e.format(s.date,"YYYY-MM-DD");else{var p=u(s.startedAt);s.date=p.moment.format("YYYY-MM-DD"),s.shift=p.shift}if(s.shift=t("core","SHIFT:"+s.shift),s.startedAt=e.format(s.startedAt,"HH:mm:ss"),s.finishedAt=e.format(s.finishedAt,"HH:mm:ss"),s.duration=d?e.toString((d-c)/1e3):"-",s.creator=l({userInfo:s.creator}),a.orgUnits){var f=r.get(s.subdivision),h=o.get(s.prodFlow);s.subdivision=f?f.getLabel():"?",s.prodFlow=h?h.getLabel():"?",s.mrpControllers=Array.isArray(s.mrpControllers)&&s.mrpControllers.length?s.mrpControllers.join("; "):"?"}if(s.prodShift=s.prodShift?'<a href="#prodShifts/'+s.prodShift+'">'+s.date+", "+s.shift+"</a>":s.date+", "+s.shift,s.orderData){var m=(s.orderData.operations||{})[s.operationNo]||{};s.order=s.orderId+": <em>"+(s.orderData.name||"?")+"</em>",s.operation=s.operationNo+": <em>"+(m.name||"?")+"</em>"}else s.order=s.orderId,s.operation=s.operationNo;return a.orderUrl&&n.isAllowedTo("ORDERS:VIEW")&&(s.orderUrl="#"+(s.mechOrder?"mechOrders":"orders")+"/"+encodeURIComponent(s.orderId)),s.taktTimeSap=i.getTaktTime(),s.taktTime=i.getActualTaktTime(),s.workerCountSap=i.getWorkerCountSap(),s}}),define("app/prodShiftOrders/views/ProdShiftOrderListView",["underscore","app/i18n","app/user","app/viewport","app/core/views/ListView","app/data/prodLines","app/data/views/renderOrgUnitPath","./decorateProdShiftOrder"],function(e,t,n,r,i,o,a,s){return i.extend({remoteTopics:{"prodShiftOrders.created.*":"refreshIfMatches","prodShiftOrders.updated.*":"refreshIfMatches","prodShiftOrders.deleted.*":"refreshIfMatches"},columns:["mrpControllers","prodFlow","prodLine","order","operation","prodShift","startedAt","duration","quantityDone","workerCount"],serializeRows:function(){return this.collection.map(function(e){return s(e,{orgUnits:!0})})},serializeActions:function(){var e=this.collection;return function(t){return[i.actions.viewDetails(e.get(t._id))]}},afterRender:function(){i.prototype.afterRender.call(this);var e=this;this.$('.list-item > td[data-id="prodLine"]').popover({container:this.el,trigger:"hover",placement:"auto right",html:!0,content:function(){var t=a(o.get(e.$(this).text().trim()),!1,!1);return t?t.split(" \\ ").join("<br>\\ "):"?"}})},refreshIfMatches:function(e){this.collection.hasOrMatches(e)&&this.refreshCollection()}})}),define("app/prodShiftOrders/templates/filter",["app/i18n"],function(t){return function anonymous(locals,filters,escape,rethrow){escape=escape||function(e){return String(e).replace(/&(?!#?[a-zA-Z0-9]+;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&#39;").replace(/"/g,"&quot;")};var buf=[];with(locals||{})!function(){buf.push('<div class="well">\n  <form id="',idPrefix,'-form" class="filter-form">\n    <div class="form-group">\n      <label for="',idPrefix,'-from">',t("prodShiftOrders","FILTER:DATE:FROM"),'</label>\n      <input id="',idPrefix,'-from" class="form-control" name="from" type="date" placeholder="YYYY-MM-DD">\n    </div><div\n      class="form-group">\n      <label for="',idPrefix,'-to">',t("prodShiftOrders","FILTER:DATE:TO"),'</label>\n      <input id="',idPrefix,'-to" class="form-control" name="to" type="date" placeholder="YYYY-MM-DD">\n    </div><div\n      class="form-group">\n      <label for="',idPrefix,'-shift-any">',t("prodShiftOrders","PROPERTY:shift"),'</label>\n      <div class="filter-radio-group">\n        <label class="radio-inline">\n          <input id="',idPrefix,'-shift-any" name="shift" type="radio" value="0">\n          ',t("core","SHIFT:ANY"),'\n        </label>\n        <label class="radio-inline">\n          <input name="shift" type="radio" value="1">\n          ',t("core","SHIFT:1"),'\n        </label>\n        <label class="radio-inline">\n          <input name="shift" type="radio" value="2">\n          ',t("core","SHIFT:2"),'\n        </label>\n        <label class="radio-inline">\n          <input name="shift" type="radio" value="3">\n          ',t("core","SHIFT:3"),'\n        </label>\n      </div>\n    </div><div\n      class="form-group">\n      <label for="',idPrefix,'-orderId">',t("prodShiftOrders","FILTER:orderId"),'</label>\n      <input id="',idPrefix,'-orderId" class="form-control prodShiftOrders-filter-orderId" name="orderId" type="text" placeholder="',t("prodShiftOrders","FILTER:PLACEHOLDER:orderId"),'">\n    </div><div\n      class="form-group">\n      <label for="',idPrefix,'-operationNo">',t("prodShiftOrders","FILTER:operationNo"),'</label>\n      <input id="',idPrefix,'-operationNo" class="form-control prodShiftOrders-filter-operationNo" name="operationNo" type="text" placeholder="',t("prodShiftOrders","FILTER:PLACEHOLDER:operationNo"),'" maxlength="4" pattern="[0-9]+">\n    </div><div\n      class="form-group">\n      <label for="',idPrefix,'-prodLine">',t("prodShiftOrders","PROPERTY:prodLine"),'</label>\n      <input id="',idPrefix,'-prodLine" name="prodLine" type="text" data-placeholder="',t("prodShiftOrders","FILTER:PLACEHOLDER:prodLine"),'">\n    </div><div\n      class="form-group">\n      <label for="',idPrefix,'-limit">',t("prodShiftOrders","FILTER:LIMIT"),'</label>\n      <input id="',idPrefix,'-limit" class="form-control" name="limit" type="number" value="25" min="5" max="100" step="1">\n    </div><div\n      class="form-group filter-actions">\n      <input type="submit" class="btn btn-primary" value="',escape(t("prodShiftOrders","FILTER:BUTTON")),'">\n    </div>\n  </form>\n</div>\n')}();return buf.join("")}}),define("app/prodShiftOrders/views/ProdShiftOrderFilterView",["underscore","moment","js2form","reltime","app/i18n","app/user","app/data/prodLines","app/core/View","app/core/util/fixTimeRange","app/prodShiftOrders/templates/filter","select2"],function(e,t,n,r,i,o,a,s,u,l){return s.extend({template:l,events:{"submit .filter-form":function(e){e.preventDefault(),this.changeFilter()}},initialize:function(){this.idPrefix=e.uniqueId("prodShiftOrderFilter")},destroy:function(){this.$('.select2-offscreen[tabindex="-1"]').select2("destroy")},serialize:function(){return{idPrefix:this.idPrefix}},afterRender:function(){var e=this.serializeRqlQuery();n(this.el.querySelector(".filter-form"),e),this.$id("prodLine").select2({width:"275px",allowClear:!o.getDivision(),data:this.getApplicableProdLines()})},getApplicableProdLines:function(){return a.getForCurrentUser().map(function(e){return{id:e.id,text:e.getLabel()}})},serializeRqlQuery:function(){var e=this.model.rqlQuery,t={createdAt:"",prodLine:null,type:null,shift:0,orderId:"",operationNo:"",limit:e.limit<5?5:e.limit>100?100:e.limit};return e.selector.args.forEach(function(e){var n=e.args[0];switch(n){case"date":u.toFormData(t,e,"date");break;case"prodLine":case"shift":case"orderId":case"operationNo":"eq"===e.name&&(t[n]=e.args[1])}}),t},changeFilter:function(){var e=this.model.rqlQuery,t=u.fromView(this,{defaultTime:"06:00"}),n=[],r=this.$id("prodLine").val(),i=parseInt(this.$("input[name=shift]:checked").val(),10),o=this.$id("orderId").val(),a=this.fixOperationNo();o&&o.length&&n.push({name:"eq",args:["orderId",o]}),r&&r.length&&n.push({name:"eq",args:["prodLine",r]}),i&&n.push({name:"eq",args:["shift",i]}),a&&a.length&&n.push({name:"eq",args:["operationNo",a]}),t.from&&n.push({name:"ge",args:["date",t.from]}),t.to&&n.push({name:"le",args:["date",t.to]}),e.selector={name:"and",args:n},e.limit=parseInt(this.$id("limit").val(),10)||15,e.skip=0,this.trigger("filterChanged",e)},fixOperationNo:function(){var e=this.$id("operationNo"),t=e.val().trim();if(t.length>0)for(;t.length<4;)t="0"+t;return e.val(t),t}})}),define("app/prodShiftOrders/templates/listPage",["app/i18n"],function(t){return function anonymous(locals,filters,escape,rethrow){escape=escape||function(e){return String(e).replace(/&(?!#?[a-zA-Z0-9]+;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&#39;").replace(/"/g,"&quot;")};var buf=[];with(locals||{})!function(){buf.push('<div>\n  <div class="filter-container"></div>\n  <div class="prodShiftOrders-list-container"></div>\n</div>\n')}();return buf.join("")}}),define("app/prodShiftOrders/pages/ProdShiftOrderListPage",["jquery","app/i18n","app/viewport","app/core/util/bindLoadingMessage","app/core/util/pageActions","app/core/View","../ProdShiftOrderCollection","../views/ProdShiftOrderListView","../views/ProdShiftOrderFilterView","app/prodShiftOrders/templates/listPage"],function(e,t,n,r,i,o,a,s,u,l){return o.extend({template:l,layoutName:"page",pageId:"prodShiftOrderList",breadcrumbs:[t.bound("prodShiftOrders","BREADCRUMBS:browse")],actions:function(e){return[i.export(e,this,this.prodShiftOrderList)]},initialize:function(){this.defineModels(),this.defineViews(),this.setView(".filter-container",this.filterView),this.setView(".prodShiftOrders-list-container",this.listView)},defineModels:function(){this.prodShiftOrderList=r(new a(null,{rqlQuery:this.options.rql}),this)},defineViews:function(){this.listView=new s({collection:this.prodShiftOrderList}),this.filterView=new u({model:{rqlQuery:this.prodShiftOrderList.rqlQuery}}),this.listenTo(this.filterView,"filterChanged",this.refreshList)},load:function(e){return e(this.prodShiftOrderList.fetch({reset:!0}))},refreshList:function(e){this.prodShiftOrderList.rqlQuery=e,this.listView.refreshCollection(null,!0),this.broker.publish("router.navigate",{url:this.prodShiftOrderList.genClientUrl()+"?"+e,trigger:!1,replace:!0})}})}),define("app/nls/prodShiftOrders",["app/nls/locale/en"],function(e){var t={locale:{}};t.locale.en=e;var n=function(e){if(!e)throw new Error("MessageFormat: No data passed to function.")},r=function(e,t){return n(e),e[t]};return{root:{"BREADCRUMBS:browse":function(){return"Orders"},"BREADCRUMBS:editForm":function(){return"Editing"},"BREADCRUMBS:ACTION_FORM:delete":function(){return"Deleting"},"MSG:LOADING_FAILURE":function(){return"Failed to load the orders :("},"MSG:LOADING_SINGLE_FAILURE":function(){return"Failed to load the order :("},"MSG:DELETED":function(e){return"Order <em>"+r(e,"label")+"</em> was deleted."},"PAGE_ACTION:prodLogEntries":function(){return"Show operation log"},"PAGE_ACTION:prodDowntimes":function(){return"Show downtimes"},"PAGE_ACTION:export":function(){return"Export orders"},"PAGE_ACTION:edit":function(){return"Edit order"},"PAGE_ACTION:delete":function(){return"Delete order"},"PANEL:TITLE:details":function(){return"Order's production details"},"PANEL:TITLE:orderDetails":function(){return"Order's details at the moment of start"},"PANEL:TITLE:losses":function(){return"Losses"},"PANEL:TITLE:downtimes":function(){return"Downtimes"},"PANEL:TITLE:addForm":function(){return"Add order form"
},"PANEL:TITLE:editForm":function(){return"Edit order form"},"FORM:ACTION:add":function(){return"Add order"},"FORM:ACTION:edit":function(){return"Edit order"},"FORM:ERROR:addFailure":function(){return"Failed to add the order :-("},"FORM:ERROR:editFailure":function(){return"Failed to edit the order :-("},"FORM:ERROR:order":function(){return"Order is required!"},"FORM:ERROR:operation":function(){return"Operation is required!"},"FORM:ERROR:startedAt":function(){return"Started at must be between the shift's time boundries!"},"FORM:ERROR:finishedAt":function(){return"Finished at must be between the shift's time boundries!"},"FORM:ERROR:times":function(){return"Finished at must be after Started at!"},"FORM:ERROR:INVALID_CHANGES":function(){return"Cannot edit the order: no valid changes were detected :("},"FORM:ERROR:INPUT":function(){return"Invalid input data!"},"FILTER:orderId":function(){return"Order no/12NC"},"FILTER:operationNo":function(){return"Oper. no"},"FILTER:DATE:FROM":function(){return"From"},"FILTER:DATE:TO":function(){return"To"},"FILTER:LIMIT":function(){return"Limit"},"FILTER:BUTTON":function(){return"Filter orders"},"FILTER:PLACEHOLDER:type":function(){return"Any type"},"FILTER:PLACEHOLDER:prodLine":function(){return"Any production line"},"FILTER:PLACEHOLDER:orderId":function(){return"Any order"},"FILTER:PLACEHOLDER:operationNo":function(){return"0000"},"PROPERTY:mrpControllers":function(){return"MRP Controller"},"PROPERTY:prodFlow":function(){return"Production flow"},"PROPERTY:prodLine":function(){return"Production line"},"PROPERTY:creator":function(){return"Creator"},"PROPERTY:date":function(){return"Date"},"PROPERTY:shift":function(){return"Shift"},"PROPERTY:prodShift":function(){return"Shift"},"PROPERTY:master":function(){return"Master"},"PROPERTY:leader":function(){return"Leader"},"PROPERTY:operator":function(){return"Operator"},"PROPERTY:operators":function(){return"Operators"},"PROPERTY:startedAt":function(){return"Started at"},"PROPERTY:finishedAt":function(){return"Finished at"},"PROPERTY:duration":function(){return"Duration"},"PROPERTY:quantityDone":function(){return"Quantity done"},"PROPERTY:quantityDoneSap":function(){return"Quantity done / as per SAP"},"PROPERTY:workerCount":function(){return"Worker count"},"PROPERTY:workerCountSap":function(){return"Worker count / as per SAP"},"PROPERTY:taktTime":function(){return"Takt Time / wg SAP"},"PROPERTY:order":function(){return"Order"},"PROPERTY:orderId":function(){return"Order"},"PROPERTY:operation":function(){return"Operation"},"PROPERTY:operationNo":function(){return"Operation"},"PROPERTY:pressWorksheet":function(){return"Worksheet"},"unit:workerCount":function(){return"persons"},"unit:taktTime":function(){return"s"},"ACTION_FORM:DIALOG_TITLE:delete":function(){return"Order deletion confirmation"},"ACTION_FORM:BUTTON:delete":function(){return"Delete order"},"ACTION_FORM:MESSAGE:delete":function(){return"Are you sure you want to delete the chosen order?"},"ACTION_FORM:MESSAGE_SPECIFIC:delete":function(e){return"Are you sure you want to delete the <em>"+r(e,"label")+"</em> order?"},"ACTION_FORM:MESSAGE_FAILURE:delete":function(){return"Failed to delete the order :-("}},pl:!0}}),define("app/nls/pl/prodShiftOrders",["app/nls/locale/pl"],function(e){var t={locale:{}};t.locale.pl=e;var n=function(e){if(!e)throw new Error("MessageFormat: No data passed to function.")},r=function(e,t){return n(e),e[t]};return{"BREADCRUMBS:browse":function(){return"Zlecenia"},"BREADCRUMBS:editForm":function(){return"Edycja"},"BREADCRUMBS:ACTION_FORM:delete":function(){return"Usuwanie"},"MSG:LOADING_FAILURE":function(){return"Ładowanie historii zleceń nie powiodło się :("},"MSG:LOADING_SINGLE_FAILURE":function(){return"Ładowanie danych zlecenia nie powiodło się :("},"MSG:DELETED":function(e){return"Zlecenie <em>"+r(e,"label")+"</em> zostało usunięte."},"PAGE_ACTION:prodLogEntries":function(){return"Pokaż historię operacji"},"PAGE_ACTION:prodDowntimes":function(){return"Pokaż przestoje"},"PAGE_ACTION:export":function(){return"Eksportuj zlecenia"},"PAGE_ACTION:edit":function(){return"Edytuj zlecenie"},"PAGE_ACTION:delete":function(){return"Usuń zlecenie"},"PANEL:TITLE:details":function(){return"Szczegóły zlecenia produkcyjnego"},"PANEL:TITLE:orderDetails":function(){return"Szczegóły zlecenia w momencie rozpoczęcia"},"PANEL:TITLE:losses":function(){return"Straty materiałowe"},"PANEL:TITLE:downtimes":function(){return"Przestoje rozpoczęte w trakcie wykonywania zlecenia"},"PANEL:TITLE:addForm":function(){return"Formularz dodawania zlecenia produkcyjnego"},"PANEL:TITLE:editForm":function(){return"Formularz edycji danych zlecenia produkcyjnego"},"FILTER:orderId":function(){return"Nr/12NC zlecenia"},"FILTER:operationNo":function(){return"Nr oper."},"FILTER:DATE:FROM":function(){return"Od"},"FILTER:DATE:TO":function(){return"Do"},"FILTER:LIMIT":function(){return"Limit"},"FILTER:BUTTON":function(){return"Filtruj historię"},"FILTER:PLACEHOLDER:type":function(){return"Dowolny typ"},"FILTER:PLACEHOLDER:prodLine":function(){return"Dowolna linia produkcyjna"},"FILTER:PLACEHOLDER:orderId":function(){return"Dowolne zlecenie"},"FILTER:PLACEHOLDER:operationNo":function(){return"0000"},"FORM:ACTION:add":function(){return"Dodaj zlecenie"},"FORM:ACTION:edit":function(){return"Edytuj zlecenie"},"FORM:ERROR:addFailure":function(){return"Nie udało się dodać zlecenia :-("},"FORM:ERROR:editFailure":function(){return"Nie udało się zmodyfikować zlecenia :-("},"FORM:ERROR:order":function(){return"Zlecenie jest wymagane!"},"FORM:ERROR:operation":function(){return"Operacja jest wymagana!"},"FORM:ERROR:startedAt":function(){return"Czas rozpoczęcia musi mieścić się w ramach Zmiany produkcyjnej!"},"FORM:ERROR:finishedAt":function(){return"Czas zakończenia musi mieścić się w ramach Zmiany produkcyjnej!"},"FORM:ERROR:times":function(){return"Czas zakończenia musi być po Czasie rozpoczęcia!"},"FORM:ERROR:INVALID_CHANGES":function(){return"Nie można zmodyfikować zlecenia: nie wykryto żadnych poprawnych zmian :("},"FORM:ERROR:INPUT":function(){return"Nieprawidłowe dane wejściowe!"},"PROPERTY:mrpControllers":function(){return"Kontroler MRP"},"PROPERTY:prodFlow":function(){return"Przepływ"},"PROPERTY:prodLine":function(){return"Linia produkcyjna"},"PROPERTY:creator":function(){return"Rozpoczynający"},"PROPERTY:date":function(){return"Data"},"PROPERTY:shift":function(){return"Zmiana"},"PROPERTY:prodShift":function(){return"Zmiana"},"PROPERTY:master":function(){return"Mistrz"},"PROPERTY:leader":function(){return"Lider"},"PROPERTY:operator":function(){return"Operator"},"PROPERTY:operators":function(){return"Operatorzy"},"PROPERTY:startedAt":function(){return"Czas rozpoczęcia"},"PROPERTY:finishedAt":function(){return"Czas zakończenia"},"PROPERTY:duration":function(){return"Czas trwania"},"PROPERTY:quantityDone":function(){return"Ilość wykonana"},"PROPERTY:quantityDoneSap":function(){return"Ilość wykonana / wg SAP"},"PROPERTY:workerCount":function(){return"Ilość osób"},"PROPERTY:workerCountSap":function(){return"Ilość osób / wg SAP"},"PROPERTY:taktTime":function(){return"Takt Time / wg SAP"},"PROPERTY:order":function(){return"Zlecenie"},"PROPERTY:orderId":function(){return"Zlecenie"},"PROPERTY:operation":function(){return"Operacja"},"PROPERTY:operationNo":function(){return"Operacja"},"PROPERTY:pressWorksheet":function(){return"Karta pracy"},"unit:workerCount":function(){return"osoby"},"unit:taktTime":function(){return"s"},"ACTION_FORM:DIALOG_TITLE:delete":function(){return"Potwierdzenie usunięcia zlecenia"},"ACTION_FORM:BUTTON:delete":function(){return"Usuń zlecenie"},"ACTION_FORM:MESSAGE:delete":function(){return"Czy na pewno chcesz bezpowrotnie usunąć wybrane zlecenie?"},"ACTION_FORM:MESSAGE_SPECIFIC:delete":function(e){return"Czy na pewno chcesz bezpowrotnie usunąć zlecenie <em>"+r(e,"label")+"</em>?"},"ACTION_FORM:MESSAGE_FAILURE:delete":function(){return"Nie udało się usunąć zlecenia :-("}}}),define("app/prodShiftOrders/routes",["../router","../viewport","../user","../core/util/showDeleteFormPage","./ProdShiftOrder","./pages/ProdShiftOrderListPage","i18n!app/nls/prodShiftOrders"],function(e,t,n,r,i,o){var a=n.auth("PROD_DATA:VIEW"),s=n.auth("PROD_DATA:VIEW");e.map("/prodShiftOrders",a,function(e){t.showPage(new o({rql:e.rql}))}),e.map("/prodShiftOrders/:id",a,function(e){t.loadPage("app/prodShiftOrders/pages/ProdShiftOrderDetailsPage",function(t){return new t({modelId:e.params.id})})}),e.map("/prodShiftOrders/:id;edit",s,function(e){t.loadPage(["app/prodShiftOrders/pages/EditProdShiftOrderFormPage"],function(t){return new t({model:new i({_id:e.params.id})})})}),e.map("/prodShiftOrders/:id;delete",s,r.bind(null,i))}),define("app/prodDowntimes/ProdDowntimeCollection",["underscore","../time","../user","../data/prodLog","../core/Collection","./ProdDowntime"],function(e,t,n,r,i,o){var a={eq:!0,ne:!0,"in":!0,nin:!0};return i.extend({model:o,rqlQuery:function(e){var t=[{name:"eq",args:["status","undecided"]}];if(!n.isAllowedTo("PROD_DOWNTIMES:ALL")){var r=n.getSubdivision();if(r)t.push({name:"eq",args:["subdivision",r.id]});else{var i=n.getDivision();i&&t.push({name:"eq",args:["division",i.id]})}}return e.Query.fromObject({fields:{rid:1,aor:1,reason:1,reasonComment:1,mrpControllers:1,prodFlow:1,prodLine:1,status:1,startedAt:1,finishedAt:1,date:1,shift:1},sort:{startedAt:-1},limit:15,selector:{name:"and",args:t}})},findFirstUnfinished:function(){return this.find(function(e){return null==e.get("finishedAt")})},finish:function(){var e=this.findFirstUnfinished();return e?e.finish():null},addFromInfo:function(e,i){var a=new o({division:e.get("division"),subdivision:e.get("subdivision"),mrpControllers:e.get("mrpControllers"),prodFlow:e.get("prodFlow"),workCenter:e.get("workCenter"),prodLine:e.prodLine.id,prodShift:e.id,prodShiftOrder:e.prodShiftOrder.id||null,date:e.get("date"),shift:e.get("shift"),aor:i.aor,reason:i.reason,reasonComment:i.reasonComment,status:o.STATUS.UNDECIDED,startedAt:i.startedAt||t.getMoment().toDate(),creator:n.getInfo(),master:e.get("master"),leader:e.get("leader"),operator:e.get("operator"),operators:e.get("operators"),mechOrder:e.prodShiftOrder.get("mechOrder"),orderId:e.prodShiftOrder.get("orderId"),operationNo:e.prodShiftOrder.get("operationNo")});a.set("_id",r.generateId(a.get("startedAt"),e.id+i.aor));for(var s=this.rqlQuery.limit<1?1/0:this.rqlQuery.limit;this.length>=s;)this.pop({silent:!0});return this.unshift(a),a},hasOrMatches:function(e){if(e._id){var t=this.get(e._id);if(t)return!0}return this.matchStatus(e)&&this.matchAor(e)&&this.matchReason(e)&&this.matchOrgUnit(e)},matchStatus:function(t){var n=e.find(this.rqlQuery.selector.args,function(e){return("eq"===e.name||"in"===e.name)&&"status"===e.args[0]});return n?"eq"===n.name?t.status===n.args[1]:-1!==n.args[1].indexOf(t.status):!0},matchAor:function(t){var n=e.find(this.rqlQuery.selector.args,function(e){return"aor"===e.args[0]&&a[e.name]});return n?"eq"===n.name?t.aor===n.args[1]:"ne"===n.name?t.aor!==n.args[1]:"in"===n.name?-1!==n.args[1].indexOf(t.aor):"nin"===n.name?-1===n.args[1].indexOf(t.aor):!0:!0},matchReason:function(t){var n=e.find(this.rqlQuery.selector.args,function(e){return"reason"===e.args[0]&&a[e.name]});return n?"eq"===n.name?t.reason===n.args[1]:"ne"===n.name?t.reason!==n.args[1]:"in"===n.name?-1!==n.args[1].indexOf(t.reason):"nin"===n.name?-1===n.args[1].indexOf(t.reason):!0:!0},matchOrgUnit:function(){return!0}})}),define("app/prodShifts/ProdShift",["underscore","../i18n","../user","../time","../socket","../core/Model","../core/util/getShiftStartInfo","../data/downtimeReasons","../data/subdivisions","../data/workCenters","../data/prodLines","../data/prodLog","../prodDowntimes/ProdDowntime","../prodDowntimes/ProdDowntimeCollection","../prodShiftOrders/ProdShiftOrder"],function(e,t,n,r,i,o,a,s,u,l,c,d,p,f,h){return o.extend({urlRoot:"/prodShifts",clientUrlRoot:"#prodShifts",topicPrefix:"prodShifts",privilegePrefix:"PROD_DATA",nlsDomain:"prodShifts",defaults:function(){return{division:null,subdivision:null,mrpControllers:null,prodFlow:null,workCenter:null,prodLine:null,date:null,shift:null,state:null,quantitiesDone:[{planned:0,actual:0},{planned:0,actual:0},{planned:0,actual:0},{planned:0,actual:0},{planned:0,actual:0},{planned:0,actual:0},{planned:0,actual:0},{planned:0,actual:0}],creator:null,createdAt:null,master:null,leader:null,operator:null,operators:null}},initialize:function(e,t){t&&t.production&&(this.shiftChangeTimer=null,this.prodLine=c.get(this.get("prodLine")),this.prodShiftOrder=new h,this.prodDowntimes=new f(null,{paginate:!1,rqlQuery:"sort(-startedAt)&limit(8)&prodLine="+encodeURIComponent(this.prodLine.id)}))},startShiftChangeMonitor:function(){this.stopShiftChangeMonitor(),this.shiftChangeTimer=setTimeout(function(e){e.shiftChangeTimer=null,e.changeShift(),e.startShiftChangeMonitor()},1e3,this)},stopShiftChangeMonitor:function(){null!==this.shiftChangeTimer&&(clearTimeout(this.shiftChangeTimer),this.shiftChangeTimer=null)},readLocalData:function(){if(!this.isLocked()){var t=null;try{t=JSON.parse(localStorage.getItem(this.getDataStorageKey())),t.date&&(t.date=new Date(t.date)),this.prodShiftOrder.clear(),t.prodShiftOrder&&this.prodShiftOrder.set(t.prodShiftOrder),this.prodDowntimes.reset(t.prodDowntimes||[]),delete t.prodShiftOrder,delete t.prodDowntimes}catch(n){}e.isEmpty(t)||this.set(t),this.changeShift()}},saveLocalData:function(){if(!this.isLocked()){var e=this.toJSON();delete e.division,delete e.subdivision,delete e.mrpControllers,delete e.prodFlow,delete e.workCenter,delete e.prodLine,e.prodShiftOrder=this.prodShiftOrder.toJSON(),e.prodDowntimes=this.prodDowntimes.toJSON(),localStorage.setItem(this.getDataStorageKey(),JSON.stringify(e))}},changeShift:function(){var e=this.getCurrentShiftMoment().toDate(),t=this.get("date");if(t&&e.getTime()===t.getTime())return this.startShiftChangeMonitor();var r=this.id||null;this.finishDowntime(),this.finishOrder(),this.prodShiftOrder.onShiftChanged(),this.set({date:e,shift:this.getCurrentShift(),state:"idle",quantitiesDone:[{planned:0,actual:0},{planned:0,actual:0},{planned:0,actual:0},{planned:0,actual:0},{planned:0,actual:0},{planned:0,actual:0},{planned:0,actual:0},{planned:0,actual:0}],creator:n.getInfo(),createdAt:new Date,master:null,leader:null,operator:null,operators:null}),this.set("_id",d.generateId(this.get("createdAt"),this.prodLine.id)),d.record(this,"changeShift",{finishedProdShiftId:r,startedProdShift:this.toJSON()}),this.startShiftChangeMonitor()},changeMaster:function(e){this.set("master",e),this.onPersonnelChanged("master"),d.record(this,"changeMaster",e)},changeLeader:function(e){this.set("leader",e),this.onPersonnelChanged("leader"),d.record(this,"changeLeader",e)},changeOperator:function(e){this.set("operator",e),this.onPersonnelChanged("operator"),d.record(this,"changeOperator",e)},onPersonnelChanged:function(e){var t=this.get(e);this.prodShiftOrder.id&&this.prodShiftOrder.set(e,t);var n=this.prodDowntimes.findFirstUnfinished();n&&n.set(e,t),"operator"===e&&"assembly"===this.getSubdivisionType()&&(this.set("operators",t?[t]:null),this.onPersonnelChanged("operators"))},changeCurrentQuantitiesDone:function(e){this.changeQuantitiesDone(this.getCurrentQuantityDoneHourIndex(),e)},changeQuantitiesDone:function(e,t){("number"!=typeof t||isNaN(t))&&(t=0);var n=this.get("quantitiesDone");if(!n[e])throw new Error("Invalid hour: "+e);n[e].actual!==t&&(n[e].actual=t,this.trigger("change:quantitiesDone",this,{}),d.record(this,"changeQuantitiesDone",{hour:e,newValue:t}))},changeOrder:function(e,t){this.finishOrder(),this.set("state","working"),this.prodShiftOrder.onOrderChanged(this,e,t),d.record(this,"changeOrder",this.prodShiftOrder.toJSON())},correctOrder:function(e,t){if(!this.hasOrder())throw new Error("Cannot correct the order: no order is started!");var n=this.prodShiftOrder.onOrderCorrected(this,e,t);n&&d.record(this,"correctOrder",n)},continueOrder:function(){if(this.hasOrder())throw new Error("Cannot continue the order: an order is already started!");if(!this.prodShiftOrder.hasOrderData())throw new Error("Cannot continue the order: no order data!");this.set("state","working"),this.prodShiftOrder.onOrderContinued(this),d.record(this,"changeOrder",this.prodShiftOrder.toJSON())},changeQuantityDone:function(e){if(!this.hasOrder())throw new Error("Cannot change the quantity done: no prod shift order!");("number"!=typeof e||isNaN(e))&&(e=0),e!==this.prodShiftOrder.get("quantityDone")&&(this.prodShiftOrder.set("quantityDone",e),d.record(this,"changeQuantityDone",{newValue:e}))},changeWorkerCount:function(e){if(!this.hasOrder())throw new Error("Cannot change the worker count: no prod shift order!");("number"!=typeof e||isNaN(e))&&(e=0),e!==this.prodShiftOrder.get("workerCount")&&(this.prodShiftOrder.set("workerCount",e),d.record(this,"changeWorkerCount",{newValue:e}))},endDowntime:function(){this.hasOrder()?this.set("state","working"):this.set("state","idle"),this.finishDowntime()||this.saveLocalData()},endWork:function(){this.finishDowntime(),this.finishOrder(),this.set("state","idle"),this.prodShiftOrder.onWorkEnded(),d.record(this,"endWork",{})},startDowntime:function(e){var t=this.prodDowntimes.addFromInfo(this,e);this.set("state","downtime"),d.record(this,"startDowntime",t.toJSON())},finishOrder:function(){var e=this.prodShiftOrder.finish();e&&d.record(this,"finishOrder",e)},finishDowntime:function(){var e=this.prodDowntimes.finish();return e&&d.record(this,"finishDowntime",e),!!e},editDowntime:function(e,t){e.set(t),t=e.changedAttributes(),t&&(t._id=e.id,d.record(this,"editDowntime",t))},hasOrder:function(){return!!this.prodShiftOrder.id},getLabel:function(){return this.get("prodLine")+": "+r.format(this.get("date"),"YYYY-MM-DD")+", "+t("core","SHIFT:"+this.get("shift"))},getCurrentTime:function(){return r.getMoment().format("YYYY-MM-DD HH:mm:ss")},getCurrentShift:function(){var e=r.getMoment().hour();return e>=6&&14>e?1:e>=14&&22>e?2:3},getCurrentShiftMoment:function(){return a(Date.now()).moment},getTimeToNextShift:function(){return this.getCurrentShiftMoment().add("hours",8).diff(r.getMoment())},getCurrentQuantityDoneHourIndex:function(){var e=r.getMoment().hours();return e>=6&&14>e?e-6:e>=14&&22>e?e-14:22===e?0:23===e?1:e+2},getCurrentQuantityDoneHourRange:function(){var e=r.getMoment().minutes(0).seconds(0),t=e.format("HH:mm:ss"),n=e.minutes(59).seconds(59).format("HH:mm:ss");return t+"-"+n},getQuantityDoneInCurrentHour:function(){var e=this.get("quantitiesDone");if(!Array.isArray(e))return 0;var t=this.getCurrentQuantityDoneHourIndex();return t>=e.length?0:e[t].actual},getOrderIdType:function(){return"press"===this.getSubdivisionType()?"nc12":"no"},isIdle:function(){return"idle"===this.get("state")},isDowntime:function(){return"downtime"===this.get("state")},isWorking:function(){return"working"===this.get("state")},getMaxQuantitiesDone:function(){return 150},getSubdivisionType:function(){var e=u.get(this.get("subdivision"));return e?e.get("type"):null},getDowntimeReasons:function(){return s.findBySubdivisionType(this.getSubdivisionType())},getBreakReason:function(){return s.findFirstBreakIdBySubdivisionType(this.getSubdivisionType())},getDefaultAor:function(){var e=this.prodLine.getSubdivision();return e?e.get("aor"):null},hasEnded:function(){var e=r.getMoment(this.get("date")).valueOf(),t=a(new Date).moment.valueOf();return t>e},updatePlannedQuantities:function(e){if(Array.isArray(e)&&8===e.length&&Array.isArray(this.attributes.quantitiesDone)){for(var t=0;8>t;++t)this.attributes.quantitiesDone[t].planned=e[t];this.saveLocalData(),this.trigger("change:quantitiesDone",this,{})}},isLocked:function(){return!d.isEnabled()||null===this.getSecretKey()},getSecretKey:function(){var e=localStorage.getItem(this.getSecretKeyStorageKey());return"string"==typeof e?e:null},setSecretKey:function(e){null===e?(localStorage.removeItem(this.getSecretKeyStorageKey()),localStorage.removeItem(this.getDataStorageKey()),this.prodShiftOrder.clear(),this.prodDowntimes.reset(),this.stopShiftChangeMonitor(),this.set({date:null,shift:null,state:null,quantitiesDone:null,creator:null,createdAt:null,master:null,leader:null,operator:null,operators:null}),this.trigger("locked")):(localStorage.setItem(this.getSecretKeyStorageKey(),e),this.trigger("unlocked"),this.readLocalData())},getSecretKeyStorageKey:function(){return"PRODUCTION:SECRET_KEY:"+this.prodLine.id},getDataStorageKey:function(){return"PRODUCTION:DATA:"+this.prodLine.id}},{STATE:{IDLE:"idle",WORKING:"working",DOWNTIME:"downtime"}})}),define("app/prodShifts/ProdShiftCollection",["underscore","../user","../data/prodLines","../core/Collection","../core/util/matchesProdLine","../core/util/matchesEquals","./ProdShift"],function(e,t,n,r,i,o,a){return r.extend({model:a,rqlQuery:function(e){return e.Query.fromObject({fields:{mrpControllers:1,prodFlow:1,prodLine:1,date:1,shift:1,createdAt:1,creator:1},sort:{createdAt:-1},limit:15,selector:{name:"and",args:[]}})},hasOrMatches:function(e){return this.get(e._id)?!0:i(this.rqlQuery,e.prodLine)&&o(this.rqlQuery,"shift",e.shift)}})}),define("app/prodShifts/views/decorateProdShift",["app/time","app/i18n","app/data/subdivisions","app/data/mrpControllers","app/data/prodFlows","app/data/prodLines","app/data/views/renderOrgUnitPath","app/core/templates/userInfo"],function(e,t,n,r,i,o,a,s){return function(r,o){var a=r.toJSON();if(a.createdAt=e.format(a.createdAt,"YYYY-MM-DD HH:mm:ss"),a.creator=s({userInfo:a.creator}),a.date=e.format(a.date,"YYYY-MM-DD"),a.shift=t("core","SHIFT:"+a.shift),o.orgUnits){var u=n.get(a.subdivision),l=i.get(a.prodFlow);a.subdivision=u?u.getLabel():"?",a.prodFlow=l?l.getLabel():"?",a.mrpControllers=Array.isArray(a.mrpControllers)&&a.mrpControllers.length?a.mrpControllers.join("; "):"?"}return o.personnel&&(a.master=s({userInfo:a.master}),a.leader=s({userInfo:a.leader}),a.operator=s({userInfo:a.operator})),a}}),define("app/prodShifts/views/ProdShiftListView",["app/core/views/ListView","app/data/prodLines","app/data/views/renderOrgUnitPath","./decorateProdShift"],function(e,t,n,r){return e.extend({remoteTopics:{"prodShifts.created.*":"refreshIfMatches","prodShifts.updated.*":"refreshIfMatches","prodShifts.deleted.*":"refreshIfMatches"},columns:["mrpControllers","prodFlow","prodLine","date","shift","createdAt","creator"],serializeRows:function(){return this.collection.map(function(e){return r(e,{orgUnits:!0})})},serializeActions:function(){var t=this.collection;return function(n){return[e.actions.viewDetails(t.get(n._id))]}},afterRender:function(){e.prototype.afterRender.call(this);var r=this;this.$('.list-item > td[data-id="prodLine"]').popover({container:this.el,trigger:"hover",placement:"auto right",html:!0,content:function(){return n(t.get(r.$(this).text().trim()),!1,!1).split(" \\ ").join("<br>\\ ")}})},refreshIfMatches:function(e){this.collection.hasOrMatches(e)&&this.refreshCollection()}})}),define("app/prodShifts/templates/filter",["app/i18n"],function(t){return function anonymous(locals,filters,escape,rethrow){escape=escape||function(e){return String(e).replace(/&(?!#?[a-zA-Z0-9]+;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&#39;").replace(/"/g,"&quot;")};var buf=[];with(locals||{})!function(){buf.push('<div class="well">\n  <form id="',idPrefix,'-form" class="filter-form">\n    <div class="form-group">\n      <label for="',idPrefix,'-from">',t("prodShifts","FILTER:DATE:FROM"),'</label>\n      <input id="',idPrefix,'-from" class="form-control" name="from" type="date" placeholder="YYYY-MM-DD">\n    </div><div\n      class="form-group">\n      <label for="',idPrefix,'-to">',t("prodShifts","FILTER:DATE:TO"),'</label>\n      <input id="',idPrefix,'-to" class="form-control" name="to" type="date" placeholder="YYYY-MM-DD">\n    </div><div\n      class="form-group">\n      <label for="',idPrefix,'-shift-any">',t("prodShifts","PROPERTY:shift"),'</label>\n      <div class="filter-radio-group">\n        <label class="radio-inline">\n          <input id="',idPrefix,'-shift-any" name="shift" type="radio" value="0">\n          ',t("core","SHIFT:ANY"),'\n        </label>\n        <label class="radio-inline">\n          <input name="shift" type="radio" value="1">\n          ',t("core","SHIFT:1"),'\n        </label>\n        <label class="radio-inline">\n          <input name="shift" type="radio" value="2">\n          ',t("core","SHIFT:2"),'\n        </label>\n        <label class="radio-inline">\n          <input name="shift" type="radio" value="3">\n          ',t("core","SHIFT:3"),'\n        </label>\n      </div>\n    </div><div\n      class="form-group">\n      <label for="',idPrefix,'-prodLine">',t("prodShifts","PROPERTY:prodLine"),'</label>\n      <input id="',idPrefix,'-prodLine" name="prodLine" type="text" data-placeholder="',t("prodShifts","FILTER:PLACEHOLDER:prodLine"),'">\n    </div><div\n      class="form-group">\n      <label for="',idPrefix,'-limit">',t("prodShifts","FILTER:LIMIT"),'</label>\n      <input id="',idPrefix,'-limit" class="form-control" name="limit" type="number" value="25" min="5" max="100" step="1">\n    </div><div\n      class="form-group filter-actions">\n      <input type="submit" class="btn btn-primary" value="',escape(t("prodShifts","FILTER:BUTTON")),'">\n    </div>\n  </form>\n</div>\n')}();return buf.join("")}}),define("app/prodShifts/views/ProdShiftFilterView",["underscore","moment","js2form","reltime","app/i18n","app/user","app/data/prodLines","app/core/View","app/core/util/fixTimeRange","app/prodShifts/templates/filter","select2"],function(e,t,n,r,i,o,a,s,u,l){return s.extend({template:l,events:{"submit .filter-form":function(e){e.preventDefault(),this.changeFilter()}},initialize:function(){this.idPrefix=e.uniqueId("prodShiftFilter")},destroy:function(){this.$('.select2-offscreen[tabindex="-1"]').select2("destroy")},serialize:function(){return{idPrefix:this.idPrefix}},afterRender:function(){var e=this.serializeRqlQuery();n(this.el.querySelector(".filter-form"),e),this.$id("prodLine").select2({width:"275px",allowClear:!o.getDivision(),data:this.getApplicableProdLines()})},getApplicableProdLines:function(){return a.getForCurrentUser().map(function(e){return{id:e.id,text:e.getLabel()}})},serializeRqlQuery:function(){var e=this.model.rqlQuery,t={createdAt:"",prodLine:null,shift:0,limit:e.limit<5?5:e.limit>100?100:e.limit};return e.selector.args.forEach(function(e){var n=e.args[0];switch(n){case"date":u.toFormData(t,e,"date");break;case"prodLine":case"shift":"eq"===e.name&&(t[n]=e.args[1])}}),t},changeFilter:function(){var e=this.model.rqlQuery,t=u.fromView(this),n=[],r=this.$id("prodLine").val(),i=parseInt(this.$("input[name=shift]:checked").val(),10);r&&r.length&&n.push({name:"eq",args:["prodLine",r]}),i&&n.push({name:"eq",args:["shift",i]}),t.from&&n.push({name:"ge",args:["date",t.from]}),t.to&&n.push({name:"le",args:["date",t.to]}),e.selector={name:"and",args:n},e.limit=parseInt(this.$id("limit").val(),10)||15,e.skip=0,this.trigger("filterChanged",e)}})}),define("app/prodShifts/templates/listPage",["app/i18n"],function(t){return function anonymous(locals,filters,escape,rethrow){escape=escape||function(e){return String(e).replace(/&(?!#?[a-zA-Z0-9]+;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&#39;").replace(/"/g,"&quot;")};var buf=[];with(locals||{})!function(){buf.push('<div>\n  <div class="filter-container"></div>\n  <div class="prodShifts-list-container"></div>\n</div>\n')}();return buf.join("")}}),define("app/prodShifts/pages/ProdShiftListPage",["jquery","app/i18n","app/viewport","app/core/util/bindLoadingMessage","app/core/util/pageActions","app/core/View","../ProdShiftCollection","../views/ProdShiftListView","../views/ProdShiftFilterView","app/prodShifts/templates/listPage"],function(e,t,n,r,i,o,a,s,u,l){return o.extend({template:l,layoutName:"page",pageId:"prodShiftList",breadcrumbs:[t.bound("prodShifts","BREADCRUMBS:browse")],actions:function(e){return[i.export(e,this,this.prodShiftList),i.add(this.prodShiftList,"PROD_DATA:MANAGE")]},initialize:function(){this.defineModels(),this.defineViews(),this.setView(".filter-container",this.filterView),this.setView(".prodShifts-list-container",this.listView)},defineModels:function(){this.prodShiftList=r(new a(null,{rqlQuery:this.options.rql}),this)},defineViews:function(){this.listView=new s({collection:this.prodShiftList}),this.filterView=new u({model:{rqlQuery:this.prodShiftList.rqlQuery}}),this.listenTo(this.filterView,"filterChanged",this.refreshList)},load:function(e){return e(this.prodShiftList.fetch({reset:!0}))},refreshList:function(e){this.prodShiftList.rqlQuery=e,this.listView.refreshCollection(null,!0),this.broker.publish("router.navigate",{url:this.prodShiftList.genClientUrl()+"?"+e,trigger:!1,replace:!0})}})}),define("app/nls/prodShifts",["app/nls/locale/en"],function(e){var t={locale:{}};t.locale.en=e;var n=function(e){if(!e)throw new Error("MessageFormat: No data passed to function.")},r=function(e,t){return n(e),e[t]};return{root:{"BREADCRUMBS:browse":function(){return"Shifts"},"BREADCRUMBS:addForm":function(){return"Adding"},"BREADCRUMBS:editForm":function(){return"Editing"},"BREADCRUMBS:ACTION_FORM:delete":function(){return"Deleting"},"MSG:LOADING_FAILURE":function(){return"Failed to load the shifts :("},"MSG:LOADING_SINGLE_FAILURE":function(){return"Failed to load the shift :("},"MSG:DELETED":function(e){return"Shift <em>"+r(e,"label")+"</em> was deleted."},"PAGE_ACTION:prodLogEntries":function(){return"Show operation log"},"PAGE_ACTION:export":function(){return"Export shifts"},"PAGE_ACTION:add":function(){return"Add shift"},"PAGE_ACTION:edit":function(){return"Edit shift"},"PAGE_ACTION:delete":function(){return"Delete shift"},"PANEL:TITLE:details":function(){return"Shift's details"},"PANEL:TITLE:addForm":function(){return"Add shift form"},"PANEL:TITLE:editForm":function(){return"Edit shift form"},"FILTER:DATE:FROM":function(){return"From"},"FILTER:DATE:TO":function(){return"To"},"FILTER:LIMIT":function(){return"Limit"},"FILTER:BUTTON":function(){return"Filter shifts"},"FILTER:PLACEHOLDER:prodLine":function(){return"Any production line"},"PROPERTY:mrpControllers":function(){return"MRP Controller"},"PROPERTY:prodFlow":function(){return"Production flow"},"PROPERTY:prodLine":function(){return"Production line"},"PROPERTY:type":function(){return"Type"},"PROPERTY:createdAt":function(){return"Created at"},"PROPERTY:creator":function(){return"Creator"},"PROPERTY:date":function(){return"Date"},"PROPERTY:shift":function(){return"Shift"},"PROPERTY:master":function(){return"Master"},"PROPERTY:leader":function(){return"Leader"},"PROPERTY:operator":function(){return"Operator"},"PROPERTY:operators":function(){return"Operators"},"PROPERTY:quantitiesDone":function(){return"Quantities done"},"PROPERTY:quantitiesDone:hour":function(){return"Hour"},"PROPERTY:quantitiesDone:planned":function(){return"Planned"},"PROPERTY:quantitiesDone:actual":function(){return"Actual"},"PROPERTY:totalQuantityDone":function(){return"Quantity done"},"FORM:ACTION:add":function(){return"Add shift"},"FORM:ACTION:edit":function(){return"Edit shift"},"FORM:ERROR:addFailure":function(){return"Failed to add the shift :-("},"FORM:ERROR:editFailure":function(){return"Failed to edit the shift :-("},"FORM:ERROR:INVALID_CHANGES":function(){return"Cannot edit the shift: no valid changes were detected :("},"FORM:ERROR:INPUT":function(){return"Invalid input data!"},"FORM:ERROR:SHIFT_NOT_ENDED":function(){return"The specified shift didn't end yet!"},"FORM:ERROR:EXISTING":function(){return"The specified shift already exists!"},totalQuantityDone:function(e){return r(e,"actual")+" of "+r(e,"planned")},"timeline:title":function(){return"Timeline"},"timeline:title:manage":function(){return"(hold Ctrl while hovering over an area, to enable additional actions)"},"timeline:action:addOrder":function(){return"Add order"},"timeline:action:addDowntime":function(){return"Add downtime"},"timeline:action:editOrder":function(){return"Edit order"},"timeline:action:editDowntime":function(){return"Edit downtime"
},"timeline:action:deleteOrder":function(){return"Delete order"},"timeline:action:deleteDowntime":function(){return"Delete downtime"},"timeline:popover:idle":function(){return"Idle"},"timeline:popover:working":function(){return"Order"},"timeline:popover:downtime":function(){return"Downtime"},"timeline:popover:startedAt":function(){return"Started at"},"timeline:popover:finishedAt":function(){return"Finished at"},"timeline:popover:duration":function(){return"Duration"},"timeline:popover:order":function(){return"Order"},"timeline:popover:operation":function(){return"Operation"},"timeline:popover:reason":function(){return"Reason"},"timeline:popover:aor":function(){return"AOR"},"timeline:popover:workerCount":function(){return"Worker count"},"timeline:popover:quantityDone":function(){return"Quantiy done"},"charts:quantitiesDone:title":function(){return"Quantities done in specific hours"},"charts:quantitiesDone:unit":function(){return" items"},"charts:quantitiesDone:series:planned":function(){return"Planned"},"charts:quantitiesDone:series:actual":function(){return"Actual"},"ACTION_FORM:DIALOG_TITLE:delete":function(){return"Shift deletion confirmation"},"ACTION_FORM:BUTTON:delete":function(){return"Delete shift"},"ACTION_FORM:MESSAGE:delete":function(){return"Are you sure you want to delete the chosen shift?"},"ACTION_FORM:MESSAGE_SPECIFIC:delete":function(e){return"Are you sure you want to delete the <em>"+r(e,"label")+"</em> shift?"},"ACTION_FORM:MESSAGE_FAILURE:delete":function(){return"Failed to delete the shift :-("}},pl:!0}}),define("app/nls/pl/prodShifts",["app/nls/locale/pl"],function(e){var t={locale:{}};t.locale.pl=e;var n=function(e){if(!e)throw new Error("MessageFormat: No data passed to function.")},r=function(e,t){return n(e),e[t]};return{"BREADCRUMBS:browse":function(){return"Zmiany"},"BREADCRUMBS:addForm":function(){return"Dodawanie"},"BREADCRUMBS:editForm":function(){return"Edycja"},"BREADCRUMBS:ACTION_FORM:delete":function(){return"Usuwanie"},"MSG:LOADING_FAILURE":function(){return"Ładowanie historii zmian nie powiodło się :("},"MSG:LOADING_SINGLE_FAILURE":function(){return"Ładowanie danych zmiany nie powiodło się :("},"PAGE_ACTION:prodLogEntries":function(){return"Pokaż historię operacji"},"PAGE_ACTION:export":function(){return"Eksportuj zmiany"},"PAGE_ACTION:add":function(){return"Dodaj zmianę"},"PAGE_ACTION:edit":function(){return"Edytuj zmianę"},"PAGE_ACTION:delete":function(){return"Usuń zmianę"},"PANEL:TITLE:details":function(){return"Szczegóły zmiany"},"PANEL:TITLE:addForm":function(){return"Formularz dodawania zmiany produkcyjnej"},"PANEL:TITLE:editForm":function(){return"Formularz edycji danych zmiany produkcyjnej"},"FILTER:DATE:FROM":function(){return"Od"},"FILTER:DATE:TO":function(){return"Do"},"FILTER:LIMIT":function(){return"Limit"},"FILTER:BUTTON":function(){return"Filtruj historię"},"FILTER:PLACEHOLDER:type":function(){return"Dowolny typ"},"FILTER:PLACEHOLDER:prodLine":function(){return"Dowolna linia produkcyjna"},"PROPERTY:mrpControllers":function(){return"Kontroler MRP"},"PROPERTY:prodFlow":function(){return"Przepływ"},"PROPERTY:prodLine":function(){return"Linia produkcyjna"},"PROPERTY:type":function(){return"Typ"},"PROPERTY:createdAt":function(){return"Czas rozpoczęcia"},"PROPERTY:creator":function(){return"Rozpoczynający"},"PROPERTY:date":function(){return"Data"},"PROPERTY:shift":function(){return"Zmiana"},"PROPERTY:master":function(){return"Mistrz"},"PROPERTY:leader":function(){return"Lider"},"PROPERTY:operator":function(){return"Operator"},"PROPERTY:operators":function(){return"Operatorzy"},"PROPERTY:quantitiesDone":function(){return"Wykonane ilości"},"PROPERTY:quantitiesDone:hour":function(){return"Godz."},"PROPERTY:quantitiesDone:planned":function(){return"Plan"},"PROPERTY:quantitiesDone:actual":function(){return"Wykonane"},"PROPERTY:totalQuantityDone":function(){return"Wykonana ilość"},"FORM:ACTION:add":function(){return"Dodaj zmianę"},"FORM:ACTION:edit":function(){return"Edytuj zmianę"},"FORM:ERROR:addFailure":function(){return"Nie udało się dodać zmiany :-("},"FORM:ERROR:editFailure":function(){return"Nie udało się zmodyfikować zmiany :-("},"FORM:ERROR:INVALID_CHANGES":function(){return"Nie można zmodyfikować zmiany produkcyjnej: nie wykryto żadnych poprawnych zmian :("},"FORM:ERROR:INPUT":function(){return"Nieprawidłowe dane wejściowe!"},"FORM:ERROR:SHIFT_NOT_ENDED":function(){return"Wybrana zmiana jeszcze się nie skończyła!"},"FORM:ERROR:EXISTING":function(){return"Wybrana zmiana już istnieje!"},totalQuantityDone:function(e){return r(e,"actual")+" z "+r(e,"planned")},"timeline:title":function(){return"Oś czasu"},"timeline:title:manage":function(){return"(przytrzymaj Ctrl przy najeżdżaniu na obszar, aby wyświetlić opcje zarządzania)"},"timeline:action:addOrder":function(){return"Dodaj zlecenie"},"timeline:action:addDowntime":function(){return"Dodaj przestój"},"timeline:action:editOrder":function(){return"Edytuj zlecenie"},"timeline:action:editDowntime":function(){return"Edytuj przestój"},"timeline:action:deleteOrder":function(){return"Usuń zlecenie"},"timeline:action:deleteDowntime":function(){return"Usuń przestój"},"timeline:popover:idle":function(){return"Bezczynność"},"timeline:popover:working":function(){return"Zlecenie"},"timeline:popover:downtime":function(){return"Przestój"},"timeline:popover:startedAt":function(){return"Czas rozpoczęcia"},"timeline:popover:finishedAt":function(){return"Czas zakończenia"},"timeline:popover:duration":function(){return"Czas trwania"},"timeline:popover:order":function(){return"Zlecenie"},"timeline:popover:operation":function(){return"Operacja"},"timeline:popover:reason":function(){return"Powód"},"timeline:popover:aor":function(){return"Obszar"},"timeline:popover:workerCount":function(){return"Ilość osób"},"timeline:popover:quantityDone":function(){return"Ilość wykonana"},"charts:quantitiesDone:title":function(){return"Wykonane ilości w przedziałach godzinowych"},"charts:quantitiesDone:unit":function(){return" szt."},"charts:quantitiesDone:series:planned":function(){return"Plan"},"charts:quantitiesDone:series:actual":function(){return"Wykonane"},"ACTION_FORM:DIALOG_TITLE:delete":function(){return"Potwierdzenie usunięcia zmiany"},"ACTION_FORM:BUTTON:delete":function(){return"Usuń zmianę"},"ACTION_FORM:MESSAGE:delete":function(){return"Czy na pewno chcesz bezpowrotnie usunąć wybraną zmianę?"},"ACTION_FORM:MESSAGE_SPECIFIC:delete":function(e){return"Czy na pewno chcesz bezpowrotnie usunąć zmianę <em>"+r(e,"label")+"</em>?"},"ACTION_FORM:MESSAGE_FAILURE:delete":function(){return"Nie udało się usunąć zmiany :-("}}}),define("app/prodShifts/routes",["../router","../viewport","../user","./ProdShift","./pages/ProdShiftListPage","i18n!app/nls/prodShifts"],function(e,t,n,r,i){var o=n.auth("PROD_DATA:VIEW"),a=n.auth("PROD_DATA:MANAGE");e.map("/prodShifts",o,function(e){t.showPage(new i({rql:e.rql}))}),e.map("/prodShifts;add",a,function(){t.loadPage(["app/prodShifts/pages/AddProdShiftFormPage"],function(e){return new e({model:new r})})}),e.map("/prodShifts/:id",o,function(e){t.loadPage("app/prodShifts/pages/ProdShiftDetailsPage",function(t){return new t({modelId:e.params.id})})}),e.map("/prodShifts/:id;edit",a,function(e){t.loadPage(["app/prodShifts/pages/EditProdShiftFormPage"],function(t){return new t({model:new r({_id:e.params.id})})})})}),define("app/data/orgUnits",["./divisions","./subdivisions","./mrpControllers","./prodFlows","./workCenters","./prodLines"],function(e,t,n,r,i,o){function a(e,t,n){return e.filter(function(e){var r=e.get(t);return r?Array.isArray(r)?-1!==r.indexOf(n.id):r===n.id:!1})}var s={division:"subdivision",subdivision:"mrpController",mrpController:"prodFlow",prodFlow:"workCenter",workCenter:"prodLine",prodLine:null},u={prodLine:"workCenter",workCenter:"prodFlow",prodFlow:"mrpController",mrpController:"subdivision",subdivision:"division",division:null},l={division:e,subdivision:t,mrpController:n,prodFlow:r,workCenter:i,prodLine:o};return{getProdFlowsForSubdivision:function(e){return"string"==typeof e&&(e=t.get(e)),e?r.filter(function(t){return t.getSubdivision()===e}):[]},getAllDivisions:function(){return e.models},getAllForProdLine:function(a){"string"==typeof a&&(a=o.get(a));var s={division:null,subdivision:null,mrpControllers:null,prodFlow:null,workCenter:null,prodLine:null};if(!a)return s;s.prodLine=a.id;var u=i.get(a.get("workCenter"));if(!u)return s;s.workCenter=u.id;var l=r.get(u.get("prodFlow"));if(!l)return s;s.prodFlow=l.id;var c=l.get("mrpController");if(!Array.isArray(c)||!c.length)return s;if(s.mrpControllers=c,c=n.get(c[0]),!c)return s;var d=t.get(c.get("subdivision"));if(!d)return s;s.subdivision=d.id;var p=e.get(d.get("division"));return p?(s.division=p.id,s):s},getType:function(a){if(a.constructor===o.model)return"prodLine";if(a.constructor===i.model)return"workCenter";if(a.constructor===r.model)return"prodFlow";if(a.constructor===n.model)return"mrpController";if(a.constructor===t.model)return"subdivision";if(a.constructor===e.model)return"division";throw new Error("Unknown org unit type!")},getChildType:function(e){return s[e]||"division"},getChildren:function(e){var t=this.getType(e),n=this.getChildType(t),r=l[n];return r?a(r,t,e):[]},getByTypeAndId:function(e,t){var n=l[e];return n?n.get(t)||null:null},getParent:function(e){var t=this.getType(e),n=u[t],r=e.get(n);return!r||Array.isArray(r)&&!r.length?null:this.getByTypeAndId(n,Array.isArray(r)?r[0]:r)},RELATION_TYPES:{SIBLINGS:"siblings",TYPES:"types",CHILD:"child",DIFFERENT_CHILD:"differentChild",PARENT:"parent",DIFFERENT_PARENT:"differentParent",UNRELATED:"unrelated"},getRelationType:function(e,t,n,r){if(null===e&&"division"===n)return this.RELATION_TYPES.CHILD;if("division"===e&&null===n)return this.RELATION_TYPES.PARENT;var i=this.getByTypeAndId(e,t),o=this.getByTypeAndId(n,r);return e===n?this.getParent(i)===this.getParent(o)?this.RELATION_TYPES.SIBLINGS:this.RELATION_TYPES.TYPES:s[e]===n?this.getParent(o)===i?this.RELATION_TYPES.CHILD:this.RELATION_TYPES.DIFFERENT_PARENT:u[e]===n?this.getParent(i)===o?this.RELATION_TYPES.PARENT:this.RELATION_TYPES.DIFFERENT_CHILD:this.RELATION_TYPES.UNRELATED},getSubdivisionFor:function(n){return n&&n.constructor!==e.model?n.constructor===t.model?n:this.getSubdivisionFor(this.getParent(n)):null}}}),define("app/production/templates/controls",["app/i18n"],function(t){return function anonymous(locals,filters,escape,rethrow){escape=escape||function(e){return String(e).replace(/&(?!#?[a-zA-Z0-9]+;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&#39;").replace(/"/g,"&quot;")};var buf=[];with(locals||{})!function(){buf.push('<div class="production-controls">\n  <a href="#" class="fa fa-home" title="',t("production","controls:dashboard"),'"></a>\n  '),user.isAllowedTo("DICTIONARIES:MANAGE")?buf.push('\n  <a class="fa fa-unlock production-controls-lock" title="',t("production","controls:lock"),'"></a>\n  <a class="fa fa-lock production-controls-unlock" title="',t("production","controls:unlock"),'"></a>\n  '):buf.push('\n  <i class="fa fa-unlock production-controls-lock" title="',t("production","controls:locked"),'"></i>\n  <i class="fa fa-lock production-controls-unlock" title="',t("production","controls:unlocked"),'"></i>\n  '),buf.push('\n  <i class="fa fa-refresh production-controls-sync" title="',t("production","controls:sync"),'"></i>\n</div>\n')}();return buf.join("")}}),define("app/production/views/ProductionControlsView",["app/i18n","app/user","app/viewport","app/core/View","app/production/templates/controls"],function(e,t,n,r,i){var o={"socket.connected":"#5BB75B","socket.disconnected":"#DA4F49","socket.connectFailed":"#DA4F49","socket.connecting":"#F0AD4E"};return r.extend({template:i,localTopics:{"socket.*":function(e,t){var n=o[t];n&&this.$syncControl.css("color",n)},"production.syncing":function(){this.$syncControl.addClass("fa-spin")},"production.synced":function(){this.$syncControl.removeClass("fa-spin")}},events:{"click a.production-controls-lock":function(){this.model.setSecretKey(null)},"click a.production-controls-unlock":"unlock","mouseover a.production-controls-lock":function(e){this.$(e.target).removeClass("fa-unlock").addClass("fa-lock")},"mouseout a.production-controls-lock":function(e){this.$(e.target).removeClass("fa-lock").addClass("fa-unlock")},"mouseover a.production-controls-unlock":function(e){this.$(e.target).removeClass("fa-lock").addClass("fa-unlock")},"mouseout a.production-controls-unlock":function(e){this.$(e.target).removeClass("fa-unlock").addClass("fa-lock")}},initialize:function(){},destroy:function(){},serialize:function(){return{}},afterRender:function(){this.$syncControl=this.$(".production-controls-sync"),this.$syncControl.css("color",o[this.socket.isConnected()?"socket.connected":"socket.disconnected"])},unlock:function(){if(!this.socket.isConnected())return n.msg.show({type:"warning",time:2e3,text:e("production","controls:msg:sync:noConnection")});var t=this.model;this.socket.emit("production.getSecretKey",this.model.prodLine.id,function(r,i){return r?n.msg.show({type:"error",time:2e3,text:e("production","controls:msg:sync:remoteError")}):(t.setSecretKey(i),void n.msg.show({type:"success",time:2e3,text:e("production","controls:msg:sync:success")}))})}})}),define("app/users/User",["../core/Model"],function(e){return e.extend({urlRoot:"/users",clientUrlRoot:"#users",topicPrefix:"users",privilegePrefix:"USERS",nlsDomain:"users",labelAttribute:"login",defaults:{login:null,email:null,prodFunction:"unspecified",privileges:null,aors:null,company:null,kdDivision:null,personellId:null,card:null,firstName:null,lastName:null,registerDate:null,kdPosition:null,active:!0},initialize:function(){Array.isArray(this.get("privileges"))||this.set("privileges",[]),Array.isArray(this.get("aors"))||this.set("aors",[])},getLabel:function(){var e=this.get("lastName")||"",t=this.get("firstName")||"";return e.length&&t.length?e+" "+t:this.get("login")}})}),define("app/users/UserCollection",["../core/Collection","./User"],function(e,t){return e.extend({model:t,rqlQuery:"select(personellId,lastName,firstName,company,orgUnitType,orgUnitId,prodFunction)&sort(+lastName,+firstName)&limit(15)"})}),define("app/production/templates/personelPicker",["app/i18n"],function(t){return function anonymous(locals,filters,escape,rethrow){escape=escape||function(e){return String(e).replace(/&(?!#?[a-zA-Z0-9]+;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&#39;").replace(/"/g,"&quot;")};var buf=[];with(locals||{})!function(){buf.push('<form class="production-personelPicker">\n  '),offline&&buf.push('\n  <p class="message message-inline message-warning">',t("production","personelPicker:offline:warning"),"</p>\n  "),buf.push('\n  <div class="form-group">\n    <label for="',idPrefix,'-user">',escape(label),'</label>\n    <input id="',idPrefix,'-user" class="form-control" type="text">\n  </div>\n  <div class="form-actions">\n    <button type="submit" class="btn btn-primary">',t("production","personelPicker:submit"),'</button>\n    <button type="button" class="cancel btn btn-link">',t("production","personelPicker:cancel"),"</button>\n  </div>\n</form>\n")}();return buf.join("")}}),define("app/production/views/PersonelPickerView",["underscore","app/i18n","app/viewport","app/core/View","app/users/util/setUpUserSelect2","app/production/templates/personelPicker"],function(e,t,n,r,i,o){return r.extend({template:o,dialogClassName:"production-modal",localTopics:{"socket.connected":"render","socket.disconnected":"render"},events:{"keypress .select2-container":function(e){13===e.which&&(this.$el.submit(),e.preventDefault())},submit:function(e){e.preventDefault();var t=this.$(".btn-primary")[0];if(!t.disabled){t.disabled=!0;var n={id:null,label:null};if(this.socket.isConnected()){var r=this.$id("user").select2("data");r&&(n.id=r.id,n.label=r.text)}else n.label=this.$id("user").val().trim().replace(/[^0-9]+/g,"");this.trigger("userPicked",null!==n.label&&n.label.length?n:null)}}},initialize:function(){this.idPrefix=e.uniqueId("personelPicker")},destroy:function(){this.$('.select2-offscreen[tabindex="-1"]').select2("destroy")},serialize:function(){var e=!this.socket.isConnected();return{idPrefix:this.idPrefix,offline:e,label:t("production","personelPicker:"+(e?"offline":"online")+":label")}},afterRender:function(){var e=this.$id("user");this.socket.isConnected()?(i(e.removeClass("form-control"),{dropdownCssClass:"production-dropdown"}),e.select2("focus")):e.attr("placeholder",t("production","personelPicker:offline:placeholder")).focus()},onDialogShown:function(){this.$id("user").focus().select2("focus")}})}),define("app/production/templates/header",["app/i18n"],function(t){return function anonymous(locals,filters,escape,rethrow){escape=escape||function(e){return String(e).replace(/&(?!#?[a-zA-Z0-9]+;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&#39;").replace(/"/g,"&quot;")};var buf=[];with(locals||{})!function(){buf.push('<div class="production-header">\n  <h1 class="production-pageHeader"></h1>\n  <div class="production-properties">\n    <div class="production-property production-property-currentTime">\n      <div class="production-property-name">',t("production","property:currentTime"),'</div>\n      <div class="production-property-value"></div>\n    </div>\n    <div class="production-property production-property-shift">\n      <div class="production-property-name">',t("production","property:shift"),'</div>\n      <div class="production-property-value"></div>\n    </div>\n    <div class="production-property production-property-orgUnit">\n      <div class="production-property-name">',t("production","property:orgUnit"),'</div>\n      <div class="production-property-value"></div>\n    </div>\n    <div class="production-property production-property-master">\n      <div class="production-property-name">',t("production","property:master"),'</div>\n      <div class="production-property-value is-editable"></div>\n    </div>\n    <div class="production-property production-property-leader">\n      <div class="production-property-name">',t("production","property:leader"),'</div>\n      <div class="production-property-value is-editable"></div>\n    </div>\n    <div class="production-property production-property-operator">\n      <div class="production-property-name">',t("production","property:operator"),'</div>\n      <div class="production-property-value is-editable"></div>\n    </div>\n  </div>\n</div>\n')}();return buf.join("")}}),define("app/production/views/ProductionHeaderView",["app/i18n","app/viewport","app/core/View","app/data/prodLog","app/data/views/renderOrgUnitPath","app/users/UserCollection","./PersonelPickerView","app/production/templates/header"],function(e,t,n,r,i,o,a,s){return n.extend({template:s,localTopics:{"visibility.visible":function(){this.updateCurrentTime()},"visibility.hidden":function(){clearTimeout(this.timers.updateCurrentTime)},"divisions.synced":"updateOrgUnit","subdivisions.synced":"updateOrgUnit","mrpControllers.synced":"updateOrgUnit","prodFlows.synced":"updateOrgUnit","workCenters.synced":"updateOrgUnit","prodLines.synced":"updateOrgUnit","socket.connected":"fillPersonnelData"},events:{"click .production-property-master .btn-link":"showMasterPickerDialog","click .production-property-leader .btn-link":"showLeaderPickerDialog","click .production-property-operator .btn-link":"showOperatorPickerDialog"},initialize:function(){this.updateCurrentTime=this.updateCurrentTime.bind(this),this.listenTo(this.model.prodLine,"change:description",this.updatePageHeader),this.listenTo(this.model,"change:shift",this.updateShift),this.listenTo(this.model,"change:master",this.updateMaster),this.listenTo(this.model,"change:leader",this.updateLeader),this.listenTo(this.model,"change:operator",this.updateOperator),this.listenTo(this.model,"locked unlocked",function(){this.updateMaster(),this.updateLeader(),this.updateOperator()})},afterRender:function(){this.$currentTime=this.$property("currentTime"),this.updatePageHeader(),this.updateCurrentTime(),this.updateShift(),this.updateOrgUnit(),this.updateMaster(),this.updateLeader(),this.updateOperator(),this.socket.isConnected()&&this.fillPersonnelData()},updatePageHeader:function(){this.$(".production-pageHeader").text(this.model.prodLine.get("description")||this.model.prodLine.id)},updateCurrentTime:function(){this.$currentTime.text(this.model.getCurrentTime()),this.scheduleCurrentTimeUpdate()},updateShift:function(){var t=this.model.get("shift");t="number"==typeof t?e("core","SHIFT:"+t):"?",this.$property("shift").text(t)},updateOrgUnit:function(){this.$property("orgUnit").text(i(this.model.prodLine.getSubdivision(),!1,!1)||"?")},updateMaster:function(){this.updatePersonnel("master")},updateLeader:function(){this.updatePersonnel("leader")},updateOperator:function(){this.updatePersonnel("operator")},updatePersonnel:function(t){var n,r=!this.model.isLocked(),i=this.model.get(t),o=i&&i.label?i.label:null;if(o){var a=o.match(/^(.*?) \(.*?\)$/);n=null===a?o:a[1].trim(),r&&(n+=' <button class="btn btn-link">'+e("production","property:"+t+":change")+"</button>")}else n=e("production","property:"+t+":noData:"+(r?"un":"")+"locked"),r&&(n='<button class="btn btn-link">'+n+"</a>");this.$property(t).html(n)},scheduleCurrentTimeUpdate:function(){null!=this.timers.updateCurrentTime&&clearTimeout(this.timers.updateCurrentTime),this.timers.updateCurrentTime=setTimeout(function(e){e.timers.updateCurrentTime=null,e.updateCurrentTime()},999,this)},$property:function(e){return this.$(".production-property-"+e+" .production-property-value")},showMasterPickerDialog:function(e){e&&(e.preventDefault(),e.target.blur()),this.showPickerDialog("master",this.model.changeMaster.bind(this.model))},showLeaderPickerDialog:function(e){e&&(e.preventDefault(),e.target.blur()),this.showPickerDialog("leader",this.model.changeLeader.bind(this.model))},showOperatorPickerDialog:function(e){e&&(e.preventDefault(),e.target.blur()),this.showPickerDialog("operator",this.model.changeOperator.bind(this.model))},showPickerDialog:function(n,r){var i=new a;this.listenTo(i,"userPicked",function(e){t.closeDialog();var i=this.model.get(n);null===i?null!==e&&r(e):(i!==e||e&&(e.id!==i.id||e.label!==i.label))&&r(e),this.$(".production-property-"+n+" .btn-link").focus()}),t.showDialog(i,e("production","personelPicker:title:"+n))},fillPersonnelData:function(){var e=[],t=[],n=this.model;["master","leader","operator"].forEach(function(r){var i=n.get(r);i&&null===i.id&&i.label.trim().length>0&&(e.push(i.label),t.push(r))}),e.length>0&&this.fillUserInfo(e,t)},fillUserInfo:function(e,t){if(r.isSyncing())return this.broker.subscribe("production.synced",this.fillPersonnelData.bind(this)).setLimit(1);var n=new o(null,{rqlQuery:{fields:{firstName:1,lastName:1,personellId:1},selector:{name:e.length>1?"in":"eq",args:["personellId",e.length>1?e:e[0]]}}}),i=this.model;this.promised(n.fetch()).then(function(){var r=0;e.forEach(function(e,r){var o=n.findWhere({personellId:e});o&&i.set(t[r],{id:o.id,label:o.get("firstName")+" "+o.get("lastName")})}),r&&i.saveLocalData()})}})}),define("app/core/views/DialogView",["underscore","../View"],function(e,t){return t.extend({events:{"click .dialog-answer":function(t){var n=this.$(t.target).closest(".dialog-answer");if(!n.prop("disabled")){n.prop("disabled",!0);var r=n.attr("data-answer");e.isString(r)&&r.length>0&&(this.trigger("answered",r),e.isFunction(this.closeDialog)&&this.closeDialog())}}},serialize:function(){return this.model},onDialogShown:function(e){this.closeDialog=this.options.autoHide===!1?function(){}:e.closeDialog.bind(e)}})}),define("app/production/util/orderPickerHelpers",["underscore","jquery","app/viewport","app/i18n"],function(e,t,n,r){return{createGetOrdersUrl:function(e,t){return function(n){var r=e.getOrderIdType();return t.attr("data-type",r),"/production/orders?"+r+"="+encodeURIComponent(n)}},setUpOrderSelect2:function(i,o,a,s){function u(e){return-1!==e.laborTime&&""!==e.workCenter}var l=this;i.select2(e.extend({openOnEnter:null,allowClear:!1,minimumInputLength:6,ajax:{cache:!0,quietMillis:300,url:l.createGetOrdersUrl(a,i),results:function(e){return{results:(Array.isArray(e)?e:[]).map(function(e){return e.id=e._id,e.text=e._id+" - "+(e.name||"?"),e})}},transport:function(e){return t.ajax.apply(t,arguments).fail(function(){n.msg.show({type:"error",time:2e3,text:r("production","newOrderPicker:msg:searchFailure")}),e.success({collection:[]})})}}},s)),i.on("change",function(t){var n;n=Array.isArray(t.operations)?t.operations.filter(u):t.added&&Array.isArray(t.added.operations)?t.added.operations.filter(u):[],l.setUpOperationSelect2(o,n.map(function(e){return{id:e.no,text:e.no+" - "+e.name}}),s),n.length?o.select2("val",t.selectedOperationNo||n[0].no).select2("focus"):e.defer(function(){i.select2("focus")})})},setUpOperationSelect2:function(t,n,i){t.select2(e.extend({width:"100%",placeholder:r("production","newOrderPicker:online:operation:placeholder"),openOnEnter:null,allowClear:!1,minimumResultsForSearch:-1,data:n||[],shouldFocusInput:function(){return!0}},i))},selectOrder:function(t,n){var r=n.get("orderId"),i=n.get("orderData");r&&i&&(t.select2("data",{id:r,text:r+" - "+(i.name||"?"),sameOrder:!0}),t.trigger({type:"change",operations:e.values(i.operations),selectedOperationNo:n.get("operationNo")}))},prepareOrderInfo:function(t,n){if(delete n.__v,delete n.id,delete n.text,n._id&&("no"===t.getOrderIdType()?n.no=n._id:(n.no=null,n.nc12=n._id),delete n._id),Array.isArray(n.operations)){var r={};n.operations.forEach(function(e){""!==e.workCenter&&-1!==e.laborTime&&(r[e.no]=e)}),n.operations=r}else e.isObject(n.operations)||(n.operations={})}}}),define("app/production/templates/newOrderPicker",["app/i18n"],function(t){return function anonymous(locals,filters,escape,rethrow){escape=escape||function(e){return String(e).replace(/&(?!#?[a-zA-Z0-9]+;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&#39;").replace(/"/g,"&quot;")};var buf=[];with(locals||{})!function(){buf.push('<form class="production-newOrderPicker">\n  '),replacingOrder&&buf.push('\n  <p class="message message-inline message-warning">',t("production","newOrderPicker:checkData:warning"),'</p>\n  <div class="form-group">\n    <label for="',idPrefix,'-quantityDone">',t("production","newOrderPicker:quantityDone"),'</label>\n    <input id="',idPrefix,'-quantityDone" class="form-control" type="number" value="',quantityDone,'" autofocus min="0" max="',maxQuantityDone,'">\n  </div>\n  <div class="form-group">\n    <label for="',idPrefix,'-workerCount">',t("production","newOrderPicker:workerCount"),'</label>\n    <input id="',idPrefix,'-workerCount" class="form-control" type="number" value="',workerCount,'" min="1" max="',maxWorkerCount,'">\n  </div>\n  <div class="modal-header">\n    <h3 class="modal-title">',t("production","newOrderPicker:title"),"</h3>\n  </div>\n  "),buf.push("\n  "),correctingOrder||(buf.push("\n  "),offline?buf.push('\n  <p class="message message-inline message-warning">',t("production","newOrderPicker:offline:warning:"+orderIdType),"</p>\n  "):buf.push('\n  <p class="message message-inline message-info">',t("production","newOrderPicker:online:info:"+orderIdType),"</p>\n  "),buf.push("\n  ")),buf.push('\n  <div class="form-group">\n    <label for="',idPrefix,'-order">',t("production","newOrderPicker:order:label"),'</label>\n    <input id="',idPrefix,'-order" class="form-control" type="text" placeholder="',t("production","newOrderPicker:order:placeholder:"+orderIdType),'">\n  </div>\n  <div class="form-group">\n    <label for="',idPrefix,'-operation">',t("production","newOrderPicker:operation:label"),'</label>\n    <input id="',idPrefix,'-operation" class="form-control" type="text" placeholder="',t("production","newOrderPicker:offline:operation:placeholder"),'">\n  </div>\n  <div class="form-actions">\n    <button type="submit" class="btn btn-',correctingOrder?"primary":"success",'">\n      ',t("production","newOrderPicker:submit"+(replacingOrder?":replacing":correctingOrder?":correcting":"")),'\n    </button>\n    <button type="button" class="cancel btn btn-link">',t("production","newOrderPicker:cancel"),"</button>\n  </div>\n</form>\n")}();return buf.join("")}}),define("app/production/views/NewOrderPickerView",["underscore","jquery","app/i18n","app/viewport","app/core/View","../util/orderPickerHelpers","app/production/templates/newOrderPicker"],function(e,t,n,r,i,o,a){return i.extend({template:a,dialogClassName:function(){var e="production-modal production-newOrderPickerDialog";return this.options.correctingOrder?e+=" is-correcting":this.model.hasOrder()&&(e+=" is-replacing"),e},localTopics:{"socket.connected":"render","socket.disconnected":"render"},events:{"keypress .select2-container":function(e){13===e.which&&(this.$el.submit(),e.preventDefault())},submit:function(e){e.preventDefault();var t=this.$("button[type=submit]")[0];t.disabled||(t.disabled=!0,this.socket.isConnected()?this.handleOnlinePick(t):this.handleOfflinePick(t))}},initialize:function(){this.idPrefix=e.uniqueId("newOrderPicker")},destroy:function(){this.$('.select2-offscreen[tabindex="-1"]').select2("destroy")},serialize:function(){return{idPrefix:this.idPrefix,offline:!this.socket.isConnected(),replacingOrder:!this.options.correctingOrder&&this.model.hasOrder(),correctingOrder:!!this.options.correctingOrder,quantityDone:this.model.prodShiftOrder.get("quantityDone")||0,workerCount:this.model.prodShiftOrder.getWorkerCountForEdit(),orderIdType:this.model.getOrderIdType(),maxQuantityDone:this.model.prodShiftOrder.getMaxQuantityDone(),maxWorkerCount:this.model.prodShiftOrder.getMaxWorkerCount()}},afterRender:function(){this.socket.isConnected()?(this.setUpOrderSelect2(),this.setUpOperationSelect2(),this.options.correctingOrder&&this.selectCurrentOrder()):this.options.correctingOrder&&(this.$id("order").val(this.model.prodShiftOrder.get("orderId")),this.$id("operation").val(this.model.prodShiftOrder.get("operationNo"))),this.focusFirstInput()},onDialogShown:function(e){this.closeDialog=e.closeDialog.bind(e),this.focusFirstInput()},closeDialog:function(){},focusFirstInput:function(){!this.options.correctingOrder&&this.model.hasOrder()?this.$id("quantityDone").select():this.socket.isConnected()?this.$id("order").select2("focus"):this.$id("order").select()},setUpOrderSelect2:function(){o.setUpOrderSelect2(this.$id("order").removeClass("form-control"),this.$id("operation"),this.model,{dropdownCssClass:"production-dropdown"})},setUpOperationSelect2:function(){var e=this.$id("operation").attr("placeholder",null).removeClass("form-control");o.setUpOperationSelect2(e,[],{dropdownCssClass:"production-dropdown"})},selectCurrentOrder:function(){o.selectOrder(this.$id("order"),this.model.prodShiftOrder)},handleOnlinePick:function(e){var t=this.$id("order").select2("data"),i=this.$id("operation").select2("val");return t?i?(t.sameOrder?t=this.model.prodShiftOrder.get("orderData"):o.prepareOrderInfo(this.model,t),void this.pickOrder(t,i)):(this.$id("order").select2("focus"),e.disabled=!1,r.msg.show({type:"error",time:2e3,text:n("production","newOrderPicker:msg:emptyOperation")})):(this.$id("order").select2("focus"),e.disabled=!1,r.msg.show({type:"error",time:2e3,text:n("production","newOrderPicker:msg:emptyOrder")}))},handleOfflinePick:function(e){var t=this.model.getOrderIdType(),i={no:null,nc12:null},o=this.$id("order").val().trim().replace(/[^a-zA-Z0-9]+/g,""),a=this.$id("operation").val().trim().replace(/[^0-9]+/g,"");if("no"===t&&/^[0-9]{9,}$/.test(o))i.no=o;else{if("nc12"!==t||!(12===o.length||o.length<9&&/^[a-zA-Z]+[a-zA-Z0-9]*$/.test(o)))return this.$id("order").select(),e.disabled=!1,r.msg.show({type:"error",time:2e3,text:n("production",""===o?"newOrderPicker:msg:emptyOrder":"newOrderPicker:msg:invalidOrderId:"+t)});i.nc12=o}if(!/^[0-9]{1,4}$/.test(a))return this.$id("operation").select(),e.disabled=!1,r.msg.show({type:"error",time:2e3,text:n("production",""===o?"newOrderPicker:msg:emptyOrder":"newOrderPicker:msg:invalidOperationNo")});
for(;a.length<4;)a="0"+a;this.pickOrder(i,a)},pickOrder:function(e,t){!this.options.correctingOrder&&this.model.hasOrder()&&(this.model.changeQuantityDone(this.parseInt("quantityDone")),this.model.changeWorkerCount(this.parseInt("workerCount"))),this.options.correctingOrder?this.model.correctOrder(e,t):this.model.changeOrder(e,t),this.closeDialog()},parseInt:function(e){var t=parseInt(this.$id(e).val(),10);return isNaN(t)||0>t?0:t}})}),define("app/production/templates/downtimePicker",["app/i18n"],function(t){return function anonymous(locals,filters,escape,rethrow){escape=escape||function(e){return String(e).replace(/&(?!#?[a-zA-Z0-9]+;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&#39;").replace(/"/g,"&quot;")};var buf=[];with(locals||{})!function(){buf.push('<form class="production-downtimePicker">\n  <div class="form-group">\n    <label for="',idPrefix,'-startedAt">',t("production","downtimePicker:startedAt"),"</label>\n    "),"start"===mode?buf.push('\n    <div class="input-group">\n      <input id="',idPrefix,'-startedAt" class="form-control" type="text" value="',time.format(startedAt,"YYYY-MM-DD, HH:mm:ss"),'" readonly data-time="',startedAt.getTime(),'">\n      <span class="input-group-btn">\n        <button class="btn btn-default production-downtimePicker-now" type="button">',t("production","downtimePicker:startedAt:now"),"</button>\n      </span>\n    </div>\n    "):buf.push('\n    <input id="',idPrefix,'-startedAt" class="form-control" type="text" value="',time.format(startedAt,"YYYY-MM-DD, HH:mm:ss"),'" readonly data-time="',startedAt.getTime(),'">\n    '),buf.push('\n  </div>\n  <div class="form-group">\n    <label for="',idPrefix,'-reason">',t("production","downtimePicker:reason:label"),'</label>\n    <input id="',idPrefix,'-reason" type="text" placeholder="',t("production","downtimePicker:reason:placeholder"),'">\n  </div>\n  <div class="form-group">\n    <label for="',idPrefix,'-aor">',t("production","downtimePicker:aor:label"),'</label>\n    <input id="',idPrefix,'-aor" type="text" placeholder="',t("production","downtimePicker:aor:placeholder"),'">\n  </div>\n  <div class="form-group">\n    <label for="',idPrefix,'-reasonComment">',t("production","downtimePicker:reasonComment:label"),'</label>\n    <textarea id="',idPrefix,'-reasonComment" class="form-control" rows="4" placeholder="',t("production","downtimePicker:reasonComment:placeholder"),'"></textarea>\n  </div>\n  <div class="form-actions">\n    <button type="submit" class="btn btn-',"start"===mode?"danger":"primary",'">',t("production","downtimePicker:submit:"+mode),'</button>\n    <button type="button" class="cancel btn btn-link">',t("production","downtimePicker:cancel"),"</button>\n  </div>\n</form>\n")}();return buf.join("")}}),define("app/production/views/DowntimePickerView",["underscore","jquery","app/i18n","app/time","app/viewport","app/data/aors","app/data/downtimeReasons","app/core/View","app/production/templates/downtimePicker"],function(e,t,n,r,i,o,a,s,u){return s.extend({template:u,dialogClassName:"production-modal",events:{"keypress .select2-container":function(e){13===e.which&&(e.preventDefault(),this.$el.submit())},"keypress textarea":function(e){13===e.which&&""===e.target.value.trim()&&(e.preventDefault(),this.$el.submit())},submit:function(e){e.preventDefault();var t=this.$('.btn[type="submit"]')[0];t.disabled||(t.disabled=!0,this.handlePick(t))},"click .production-downtimePicker-now":function(){var e=Date.now();this.$id("startedAt").val(r.format(e,"YYYY-MM-DD, HH:mm:ss")).attr("data-time",e)}},initialize:function(){this.idPrefix=e.uniqueId("downtimePicker")},destroy:function(){this.$('.select2-offscreen[tabindex="-1"]').select2("destroy")},serialize:function(){return{idPrefix:this.idPrefix,startedAt:this.model.startedAt,mode:this.model.mode}},afterRender:function(){this.model.reason&&this.$id("reason").val(this.model.reason),this.model.aor&&this.$id("aor").val(this.model.aor),this.model.reasonComment&&this.$id("reasonComment").val(this.model.reasonComment),this.setUpReasonSelect2(),this.setUpAorSelect2(),this.focusControl()},onDialogShown:function(){this.focusControl()},focusControl:function(){this.model.reason?this.model.aor?"edit"===this.model.mode?this.$id("reasonComment").focus():this.$(".btn-danger").focus():this.$id("aor").select2("focus"):this.$id("reason").select2("focus")},setUpReasonSelect2:function(){var e=this,t=this.$id("reason");t.select2({dropdownCssClass:"production-dropdown",openOnEnter:null,data:this.model.prodShift.getDowntimeReasons().map(function(e){return{id:e.id,text:e.id+" - "+e.get("label")}}).sort(function(e,t){return e.id.localeCompare(t.id)})}),t.on("change",function(){t.select2("val")&&e.$id("aor").select2("focus")})},setUpAorSelect2:function(){var e=this,t=this.$id("aor");t.select2({dropdownCssClass:"production-dropdown",openOnEnter:null,data:o.map(function(e){return{id:e.id,text:e.get("name")}})}),t.on("change",function(){t.select2("val")&&e.$id("reasonComment").select()})},handlePick:function(e){var t=this.$id("reason").select2("val"),r=this.$id("aor").select2("val"),o=this.$id("reasonComment").val();return t?r?void this.trigger("downtimePicked",{reason:t,reasonComment:o,aor:r,startedAt:new Date(parseInt(this.$id("startedAt").attr("data-time"),10))}):(this.$id("aor").select2("focus"),e.disabled=!1,i.msg.show({type:"error",time:2e3,text:n("production","downtimePicker:msg:emptyAor")})):(this.$id("reason").select2("focus"),e.disabled=!1,i.msg.show({type:"error",time:2e3,text:n("production","downtimePicker:msg:emptyReason")}))}})}),define("app/production/templates/endWorkDialog",["app/i18n"],function(t){return function anonymous(locals,filters,escape,rethrow){escape=escape||function(e){return String(e).replace(/&(?!#?[a-zA-Z0-9]+;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&#39;").replace(/"/g,"&quot;")};var buf=[];with(locals||{})!function(){buf.push('<form class="production-endWorkDialog">\n  <p class="message message-inline message-warning">',t("production","endWorkDialog:warning",{downtime:downtime}),'</p>\n  <div class="form-group">\n    <label for="',idPrefix,'-quantitiesDone">',t("production","endWorkDialog:quantitiesDone",{hourRange:hourRange}),'</label>\n    <input id="',idPrefix,'-quantitiesDone" class="form-control" type="number" value="',quantitiesDone,'" autofocus min="0" max="',maxQuantitiesDone,'">\n  </div>\n  <div class="form-group">\n    <label for="',idPrefix,'-quantityDone">',t("production","endWorkDialog:quantityDone"),'</label>\n    <input id="',idPrefix,'-quantityDone" class="form-control" type="number" value="',quantityDone,'" max="',maxQuantityDone,'">\n  </div>\n  <div class="form-group">\n    <label for="',idPrefix,'-workerCount">',t("production","endWorkDialog:workerCount"),'</label>\n    <input id="',idPrefix,'-workerCount" class="form-control" type="number" value="',workerCount,'" min="1" max="',maxWorkerCount,'">\n  </div>\n  <div class="form-actions">\n    <button class="btn btn-warning" type="submit">',t("production","endWorkDialog:yes"),'</button>\n    <button class="btn btn-link cancel" type="button">',t("production","endWorkDialog:no"),"</button>\n  </div>\n</form>\n")}();return buf.join("")}}),define("app/production/views/EndWorkDialogView",["underscore","app/i18n","app/core/View","app/production/templates/endWorkDialog"],function(e,t,n,r){return n.extend({template:r,dialogClassName:"production-modal",events:{submit:function(e){e.preventDefault();var t=this.$(".btn-warning")[0];if(!t.disabled){t.disabled=!0;var n=this.parseInt("quantitiesDone"),r=this.parseInt("quantityDone"),i=this.parseInt("workerCount");this.model.changeCurrentQuantitiesDone(n),r!==this.model.prodShiftOrder.get("quantityDone")&&this.model.changeQuantityDone(r),i!==this.model.prodShiftOrder.get("workerCount")&&this.model.changeWorkerCount(i),this.model.endWork(),this.closeDialog()}}},initialize:function(){this.idPrefix=e.uniqueId("endWorkDialog")},serialize:function(){return{idPrefix:this.idPrefix,downtime:this.model.isDowntime(),hourRange:this.model.getCurrentQuantityDoneHourRange(),quantitiesDone:this.model.getQuantityDoneInCurrentHour(),quantityDone:this.model.prodShiftOrder.get("quantityDone")||0,workerCount:this.model.prodShiftOrder.getWorkerCountForEdit(),maxQuantitiesDone:this.model.getMaxQuantitiesDone(),maxQuantityDone:this.model.prodShiftOrder.getMaxQuantityDone(),maxWorkerCount:this.model.prodShiftOrder.getMaxWorkerCount()}},onDialogShown:function(e){this.closeDialog=e.closeDialog.bind(e)},closeDialog:function(){},parseInt:function(e){var t=parseInt(this.$id(e).val(),10);return isNaN(t)||0>t?0:t}})}),define("app/production/templates/data",["app/i18n"],function(t){return function anonymous(locals,filters,escape,rethrow){escape=escape||function(e){return String(e).replace(/&(?!#?[a-zA-Z0-9]+;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&#39;").replace(/"/g,"&quot;")};var buf=[];with(locals||{})!function(){buf.push('<div class="production-data">\n  <h2 class="production-sectionHeader">',t("production","section:data"),'</h2>\n  <div class="production-properties production-properties-orderInfo">\n    <div class="production-property production-property-orderNo">\n      <div class="production-property-name">',t("production","property:orderNo"),'</div>\n      <div class="production-property-value"></div>\n    </div>\n    <div class="production-property production-property-nc12">\n      <div class="production-property-name">',t("production","property:nc12"),'</div>\n      <div class="production-property-value"></div>\n    </div>\n    <div class="production-property production-property-productName">\n      <div class="production-property-name">',t("production","property:productName"),'</div>\n      <div class="production-property-value"></div>\n    </div>\n    <div class="production-property production-property-operationName">\n      <div class="production-property-name">',t("production","property:operationName"),'</div>\n      <div class="production-property-value"></div>\n    </div>\n  </div>\n  <div class="production-properties production-properties-orderData">\n    <div class="production-property production-property-startedAt">\n      <div class="production-property-name">',t("production","property:createdAt"),'</div>\n      <div class="production-property-value"></div>\n    </div>\n    <div class="production-property production-property-quantityDone">\n      <div class="production-property-name">',t("production","property:quantityDone"),'</div>\n      <div class="production-property-value"></div>\n    </div>\n    <div class="production-property production-property-workerCount">\n      <div class="production-property-name">',t("production","property:workerCount"),'</div>\n      <div class="production-property-value"></div>\n    </div>\n    <div class="production-property production-property-workerCountSap">\n      <div class="production-property-name">',t("production","property:workerCountSap"),'</div>\n      <div class="production-property-value"></div>\n    </div>\n    <div class="production-property production-property-taktTime">\n      <div class="production-property-name">',t("production","property:taktTime"),'</div>\n      <div class="production-property-value"></div>\n    </div>\n  </div>\n  <div class="production-actions">\n    <button class="btn btn-danger production-action production-beginDowntime">Przestój</button>\n    <button class="btn btn-danger production-action production-beginBreak">Przerwa</button>\n    <button class="btn btn-success production-action production-endDowntime">Koniec przestoju</button>\n    <button class="btn btn-success production-action production-continueOrder">Kontynuuj zlecenie</button>\n    <button class="btn btn-success production-action production-pickNextOrder">Następne zlecenie</button>\n    <button class="btn btn-warning production-action production-endWork">Koniec pracy</button>\n  </div>\n</div>\n')}();return buf.join("")}}),define("app/production/templates/endDowntimeDialog",["app/i18n"],function(t){return function anonymous(locals,filters,escape,rethrow){escape=escape||function(e){return String(e).replace(/&(?!#?[a-zA-Z0-9]+;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&#39;").replace(/"/g,"&quot;")};var buf=[];with(locals||{})!function(){buf.push('<div class="production-question">\n  ',t("production","endDowntimeDialog:message"),'\n  <div class="form-actions">\n    <button class="btn btn-',yesSeverity,' dialog-answer" type="button" autofocus data-answer="yes">',t("production","endDowntimeDialog:yes"),'</button>\n    <button class="btn btn-link cancel" type="button">',t("production","endDowntimeDialog:no"),"</button>\n  </div>\n</div>\n")}();return buf.join("")}}),define("app/production/templates/continueOrderDialog",["app/i18n"],function(t){return function anonymous(locals,filters,escape,rethrow){escape=escape||function(e){return String(e).replace(/&(?!#?[a-zA-Z0-9]+;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&#39;").replace(/"/g,"&quot;")};var buf=[];with(locals||{})!function(){buf.push('<div class="production-question">\n  ',t("production","continueOrderDialog:message"),'\n  <div class="form-actions">\n    <button class="btn btn-success dialog-answer" type="button" autofocus data-answer="yes">',t("production","continueOrderDialog:yes"),'</button>\n    <button class="btn btn-link cancel" type="button">',t("production","continueOrderDialog:no"),"</button>\n  </div>\n</div>\n")}();return buf.join("")}}),define("app/production/views/ProductionDataView",["underscore","jquery","app/i18n","app/time","app/viewport","app/core/View","app/core/views/DialogView","app/data/prodLog","./NewOrderPickerView","./DowntimePickerView","./EndWorkDialogView","app/production/templates/data","app/production/templates/endDowntimeDialog","app/production/templates/continueOrderDialog"],function(e,t,n,r,i,o,a,s,u,l,c,d,p,f){return o.extend({template:d,localTopics:{"socket.connected":"fillOrderData"},events:{"click .production-newOrder":"newOrder","click .production-continueOrder":"continueOrder","click .production-startDowntime":"startDowntime","click .production-startBreak":"startBreak","click .production-endDowntime":"endDowntime","click .production-endWork":"endWork","click .production-property-orderNo .btn-link":"correctOrder","click .production-property-nc12 .btn-link":"correctOrder","click .production-property-quantityDone .btn-link":"showQuantityDoneEditor","click .production-property-workerCount .btn-link":"showWorkerCountEditor"},initialize:function(){this.listenTo(this.model,"locked unlocked",function(){this.updateWorkerCount(),this.updateQuantityDone(),this.toggleActions()}),this.listenTo(this.model,"change:state",this.toggleActions);var t=this.model.prodShiftOrder;this.listenTo(t,"change:_id change:orderId change:operationNo",e.debounce(function(){this.updateOrderData(),this.updateOrderInfo(),this.updateWorkerCount(),this.updateTaktTime()},1)),this.listenTo(t,"change:quantityDone",this.updateQuantityDone),this.listenTo(t,"change:workerCount",e.debounce(function(){this.updateWorkerCount(),this.updateTaktTime()},1))},afterRender:function(){this.$actions=this.$(".production-actions"),this.updateOrderData(),this.updateOrderInfo(),this.updateQuantityDone(),this.toggleActions(),this.socket.isConnected()&&this.fillOrderData()},updateOrderInfo:function(){var e=this.model.prodShiftOrder;this.updateOrderNo(),this.updateNc12(),this.$property("productName").text(e.getProductName()),this.$property("operationName").text(e.getOperationName())},updateOrderData:function(){this.$el.toggleClass("has-order",this.model.hasOrder()),this.updateTaktTime(),this.updateWorkerCount(),this.$property("startedAt").text(this.model.prodShiftOrder.getStartedAt())},updateOrderNo:function(){var e=this.model.prodShiftOrder.getOrderNo();this.model.isLocked()||!this.model.hasOrder()||this.model.prodShiftOrder.isMechOrder()||(e+=' <button class="btn btn-link">'+n("production","property:orderNo:change")+"</button>"),this.$property("orderNo").html(e)},updateNc12:function(){var e=this.model.prodShiftOrder.getNc12();!this.model.isLocked()&&this.model.hasOrder()&&this.model.prodShiftOrder.isMechOrder()&&(e+=' <button class="btn btn-link">'+n("production","property:nc12:change")+"</button>"),this.$property("nc12").html(e)},updateWorkerCount:function(){this.$property("workerCountSap").text(this.model.prodShiftOrder.getWorkerCountSap());var e=this.model.prodShiftOrder.getWorkerCount(),t="";if(this.model.isIdle())t="-";else if(this.model.isLocked())t="number"==typeof e?e:"-";else{var r="property:workerCount:change:noData";e>0&&(r="property:workerCount:change:data",t+=e+" "),t+='<button class="btn btn-link">'+n("production",r)+"</button>"}this.$property("workerCount").html(t)},updateTaktTime:function(){this.$property("taktTime").text(this.model.prodShiftOrder.getTaktTime())},updateQuantityDone:function(){var e;this.model.isIdle()?e="-":(e=String(this.model.prodShiftOrder.getQuantityDone()),this.model.isLocked()||(e+=' <button class="btn btn-link">'+n("production","property:quantityDone:change")+"</button>")),this.$property("quantityDone").html(e)},toggleActions:function(){this.$actions.empty(),this.model.isLocked()||(this.model.isIdle()?this.toggleIdleActions():this.model.isWorking()?this.toggleWorkingActions():this.toggleDowntimeActions())},toggleIdleActions:function(){e.defer(function(e){e.appendAction("danger","startDowntime"),e.model.getDefaultAor()&&e.appendAction("danger","startBreak"),e.model.prodShiftOrder.hasOrderData()&&e.appendAction("success","continueOrder"),e.appendAction("success","newOrder")},this)},toggleWorkingActions:function(){this.appendAction("danger","startDowntime"),this.model.getDefaultAor()&&this.appendAction("danger","startBreak"),this.appendAction("success","newOrder"),this.appendAction("warning","endWork")},toggleDowntimeActions:function(){this.model.hasOrder()?(this.appendAction("success","endDowntime"),this.appendAction("warning","endWork")):this.appendAction("warning","endDowntime")},appendAction:function(e,t){var r=["btn","btn-"+e,"production-action","production-"+t],i=n("production","action:"+t);this.$actions.append('<button class="'+r.join(" ")+'">'+i+"</button>")},$property:function(e){return this.$(".production-property-"+e+" .production-property-value")},newOrder:function(e){e&&e.target.blur(),i.showDialog(new u({model:this.model}),n("production","newOrderPicker:title"+(this.model.hasOrder()?":replacing":"")))},continueOrder:function(e){e&&e.target.blur();var t=new a({dialogClassName:"production-modal",template:f});this.listenTo(t,"answered",function(e){"yes"===e&&this.model.continueOrder()}),i.showDialog(t,n("production","continueOrderDialog:title"))},correctOrder:function(e){e&&e.target.blur(),i.showDialog(new u({model:this.model,correctingOrder:!0}),n("production","newOrderPicker:title:correcting"))},startDowntime:function(t,o){var a=r.getMoment().toDate();t&&t.target.blur(),o||(o={}),o.model=e.defaults(o.model||{},{mode:"start",prodShift:this.model,startedAt:a,reason:null,aor:null,reasonComment:null});var s=new l(o);this.listenTo(s,"downtimePicked",function(e){i.closeDialog(),this.model.startDowntime(e)}),i.showDialog(s,n("production","downtimePicker:title:start"))},startBreak:function(e){this.startDowntime(e,{model:{prodShift:this.model,reason:this.model.getBreakReason(),aor:this.model.getDefaultAor()}})},endDowntime:function(e){e&&e.target.blur();var t=new a({dialogClassName:"production-modal",template:p,model:{yesSeverity:this.model.hasOrder()?"success":"warning"}});this.listenTo(t,"answered",function(e){"yes"===e&&this.model.endDowntime()}),i.showDialog(t,n("production","endDowntimeDialog:title"))},endWork:function(e){e&&e.target.blur(),i.showDialog(new c({model:this.model}),n("production","endWorkDialog:title"))},showEditor:function(n,r,i,o,a){function s(){p.remove()}function u(){var t=parseInt(p.val(),10);s(),isNaN(t)||c.model[a](t),e.defer(function(){n.find(".btn-link").focus()})}var l=n.find(".production-property-value"),c=this,d=t("<form></form>").submit(function(){return u(),!1}),p=t('<input class="form-control input-lg" type="number">').val(r).attr("min",i).attr("max",o).on("blur",u).on("keydown",function(e){27===e.which&&setTimeout(s,1)}).css({position:"absolute",width:l.width()+"px"}).appendTo(d);d.appendTo(l),p.select()},showQuantityDoneEditor:function(){this.showEditor(this.$(".production-property-quantityDone"),this.model.prodShiftOrder.getQuantityDone(),0,this.model.prodShiftOrder.getMaxQuantityDone(),"changeQuantityDone")},showWorkerCountEditor:function(){this.showEditor(this.$(".production-property-workerCount"),this.model.prodShiftOrder.getWorkerCountForEdit(),1,this.model.prodShiftOrder.getMaxWorkerCount(),"changeWorkerCount")},fillOrderData:function(){var t=this.model.prodShiftOrder.get("orderId"),n=this.model.prodShiftOrder.get("orderData");if(t&&(!n||e.isEmpty(n.operations))){if(s.isSyncing())return this.broker.subscribe("production.synced",this.fillOrderData.bind(this)).setLimit(1);this.fetchOrderData()}},fetchOrderData:function(){var e=this,n=this.model,r=n.prodShiftOrder.get("mechOrder")?"nc12":"no",i=n.prodShiftOrder.get("orderId"),o=t.ajax({type:"GET",url:"/production/orders?"+r+"="+encodeURIComponent(i)});this.promised(o).then(function(t){if(Array.isArray(t)&&t.length){var i=t[0];"no"===r?i.no=i._id:(i.nc12=i._id,i.no=null),delete i._id,n.prodShiftOrder.set("orderData",n.prodShiftOrder.prepareOperations(i)),n.saveLocalData(),e.updateOrderData(),e.updateOrderInfo()}})}})}),define("app/production/views/ProdDowntimeListView",["app/i18n","app/time","app/viewport","app/data/aors","app/data/downtimeReasons","app/core/views/ListView","./DowntimePickerView"],function(e,t,n,r,i,o,a){return o.extend({className:"production-downtimes",localTopics:{"downtimeReasons.synced":"render","aors.synced":"render"},remoteTopics:function(){var e={};return this.model.prodLine&&(e["prodDowntimes.corroborated."+this.model.prodLine.id]="onCorroborated"),e},events:{"click .warning":"showEditDialog"},initialize:function(){this.collection=this.model.prodDowntimes,o.prototype.initialize.apply(this,arguments),this.listenTo(this.model.prodDowntimes,"add",this.render),this.listenTo(this.model.prodDowntimes,"change",this.render),this.listenTo(this.model.prodDowntimes,"remove",this.render)},destroy:function(){this.$el.popover("destroy"),this.$('.select2-offscreen[tabindex="-1"]').select2("destroy")},serializeColumns:function(){return[{id:"startedAt",label:e("production","prodDowntime:startedAt")},{id:"finishedAt",label:e("production","prodDowntime:finishedAt")},{id:"reason",label:e("production","prodDowntime:reason")},{id:"aor",label:e("production","prodDowntime:aor")}]},serializeRows:function(){return this.model.prodDowntimes.map(function(e){var n=e.toJSON(),o=r.get(n.aor),a=i.get(n.reason);return n.className=e.getCssClassName(),n.startedAt=t.format(n.startedAt,"YYYY-MM-DD HH:mm:ss"),n.finishedAt=n.finishedAt?t.format(n.finishedAt,"YYYY-MM-DD HH:mm:ss"):"-",o&&(n.aor=o.get("name")),a&&(n.reason=a.get("label")),n.reasonComment&&(n.className+=" has-comment",n.reason+=' <i class="fa fa-info-circle"></i>'),n})},serializeActions:function(){return[]},afterRender:function(){var e=this;this.$el.popover({selector:".has-comment",trigger:"hover",placement:"top",container:this.el.ownerDocument.body,content:function(){return e.model.prodDowntimes.get(this.dataset.id).get("reasonComment")}}).on("shown.bs.popover",function(t){e.$(t.target).data("bs.popover").$tip.addClass("production-downtimes-popover")})},onCorroborated:function(e){var t=this.model.prodDowntimes.get(e._id);t&&(t.set(e),this.trigger("corroborated",e._id))},showEditDialog:function(t){var r=this.model,i=r.prodDowntimes.get(t.currentTarget.dataset.id),o=new a({model:{mode:"edit",prodShift:r,startedAt:new Date(i.get("startedAt")),reason:i.get("reason"),aor:i.get("aor"),reasonComment:i.get("reasonComment")}});this.listenTo(o,"downtimePicked",function(e){delete e.startedAt,r.editDowntime(i,e),n.closeDialog()}),n.showDialog(o,e("production","downtimePicker:title:edit"))}})}),define("app/production/templates/quantityEditor",["app/i18n"],function(t){return function anonymous(locals,filters,escape,rethrow){escape=escape||function(e){return String(e).replace(/&(?!#?[a-zA-Z0-9]+;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&#39;").replace(/"/g,"&quot;")};var buf=[];with(locals||{})!function(){buf.push('<form class="production-quantityEditor">\n  <div class="form-group">\n    <label for="',idPrefix,'-quantity">',escape(t("production","quantityEditor:label",{from:from,to:to})),'</label>\n    <input id="',idPrefix,'-quantity" class="form-control input-lg" type="number" value="',escape(currentQuantity),'" min="0" max="',maxQuantity,'">\n  </div>\n  <div class="form-actions">\n    <button type="submit" class="btn btn-primary">',t("production","quantityEditor:submit"),'</button>\n    <button type="button" class="cancel btn btn-link">',t("production","quantityEditor:cancel"),"</button>\n  </div>\n</form>\n")}();return buf.join("")}}),define("app/production/views/QuantityEditorView",["underscore","app/i18n","app/viewport","app/core/View","app/production/templates/quantityEditor"],function(e,t,n,r,i){return r.extend({template:i,events:{submit:function(e){e.preventDefault();var t=parseInt(this.$id("quantity").val(),10);(isNaN(t)||t===this.options.currentQuantity||0>t)&&(t=null),this.trigger("quantityChanged",t)}},initialize:function(){this.idPrefix=e.uniqueId("quantityEditor")},serialize:function(){return{idPrefix:this.idPrefix,from:this.options.from,to:this.options.to,currentQuantity:this.options.currentQuantity,maxQuantity:this.options.maxQuantity}},afterRender:function(){this.$id("quantity").select()},onDialogShown:function(){this.$id("quantity").select()}})}),define("app/production/templates/quantities",["app/i18n"],function(t){return function anonymous(locals,filters,escape,rethrow){escape=escape||function(e){return String(e).replace(/&(?!#?[a-zA-Z0-9]+;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&#39;").replace(/"/g,"&quot;")};var buf=[];with(locals||{})!function(){buf.push('<div class="production-quantities">\n  <h3 class="production-subsectionHeader">',t("production","section:quantities"),'</h3>\n  <div class="table-responsive">\n    <table class="table table-bordered table-hover table-condensed">\n      <thead>\n        <tr>\n          <th>',t("production","quantities:column:time"),"</th>\n          <th>",t("production","quantities:column:planned"),"</th>\n          <th>",t("production","quantities:column:actual"),"</th>\n        </tr>\n      </thead>\n      <tbody>\n        "),quantityRows.forEach(function(e,n){buf.push("\n        <tr>\n          <td>",e.time,"</td>\n          <td>",e.planned,'</td>\n          <td class="production-quantities-actual" data-hour="',n,'">\n            <span>',e.actual,"</span>\n            "),e.editable&&buf.push('\n            <button class="btn btn-link">',t("production","quantities:change"),"</button>\n            "),buf.push("\n          </td>\n        </tr>\n        ")}),buf.push("\n      </tbody>\n    </table>\n  </div>\n</div>\n")}();return buf.join("")}}),define("app/production/views/ProductionQuantitiesView",["jquery","app/time","app/i18n","app/viewport","app/core/View","./QuantityEditorView","app/production/templates/quantities"],function(e,t,n,r,i,o,a){return i.extend({template:a,events:{"click .production-quantities-actual .btn-link":"showQuantityEditor"},initialize:function(){this.listenTo(this.model,"change:quantitiesDone change:shift locked unlocked",this.render)},serialize:function(){var e=t.getMoment().valueOf(),n=this.model.getCurrentShiftMoment(),r=!this.model.isLocked();return{quantityRows:(this.model.get("quantitiesDone")||[]).map(function(t,i){var o=r,a=n.format("HH:mm:ss");return n.add("minutes",59).add("seconds",59),o=7===i?o&&e>n.valueOf()-6e5:o&&e>n.valueOf(),a+="-"+n.format("HH:mm:ss"),n.add("seconds",1),{time:a,planned:t.planned,actual:t.actual,editable:o||t.actual>0}})}},afterRender:function(){this.timers.nextRender&&clearTimeout(this.timers.nextRender),this.model.isLocked()||this.scheduleNextRender()},scheduleNextRender:function(){var e=this.model.getCurrentShiftMoment().add("hours",7).hours(),n=t.getMoment(),r=n.valueOf(),i=n.hours(),o=n.minutes(0).seconds(0).milliseconds(0).add("hours",1).valueOf(),a=i===e?o-6e5:o,s=a+1e3-r;s>0?this.timers.nextRender=setTimeout(function(e){e.render(),e.showEditorDialog()},s,this):delete this.timers.nextRender},showQuantityEditor:function(t){function r(){d.remove(),u.show(),l.show()}function i(){var e=parseInt(p.val(),10);r();var t=o.attr("data-hour");return e!==c&&e>=0&&(l.text(e),a.model.changeQuantitiesDone(parseInt(t,0),e)),a.$("td[data-hour="+t+"] .btn-link").focus(),!1}var o=this.$(t.target).closest("td");if(!o.find("input").length){var a=this,s=this.model.getMaxQuantitiesDone(),u=o.find(".btn-link").hide(),l=o.find("span").hide(),c=parseInt(l.text(),10),d=e("<form></form>").submit(i),p=e('<input class="form-control" type="number" min="0">').attr("placeholder",n("production","quantities:newValuePlaceholder")).attr("max",s).val(c).on("blur",i).on("keydown",function(e){27===e.which&&setTimeout(r,1)}).appendTo(d);d.appendTo(o),p.select()}},showEditorDialog:function(e){e||(e=this.$(".btn-link").last().closest("td"));var t=e.parent().find("td:first-child").text().trim().split("-"),i=parseInt(e.attr("data-hour"),10),a={from:t[0],to:t[1],currentQuantity:parseInt(e.find("span").text(),10),maxQuantity:this.model.getMaxQuantitiesDone()},s=new o(a);this.listenTo(s,"quantityChanged",function(e){r.closeDialog(),null!==e&&this.model.changeQuantitiesDone(i,e)}),r.showDialog(s,n("production","quantityEditor:title"))}})}),define("app/production/templates/productionPage",["app/i18n"],function(t){return function anonymous(locals,filters,escape,rethrow){escape=escape||function(e){return String(e).replace(/&(?!#?[a-zA-Z0-9]+;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&#39;").replace(/"/g,"&quot;")};var buf=[];with(locals||{})!function(){buf.push('<div class="production is-',locked?"locked":"unlocked"," is-",state," ",mechOrder?"is-mechOrder":"",'">\n  <div class="production-controls-container"></div>\n  <div class="production-header-container"></div>\n  <div class="production-data-container"></div>\n  <div class="production-ft">\n    <h2 class="production-sectionHeader">',t("production","section:history"),'</h2>\n    <div class="row">\n      <div class="col-md-8">\n        <h3 class="production-subsectionHeader">',t("production","section:downtimes"),'</h3>\n        <div class="table-responsive production-downtimes-container"></div>\n      </div>\n      <div class="col-md-4 production-quantities-container"></div>\n    </div>\n  </div>\n</div>\n')}();return buf.join("")}}),define("app/production/pages/ProductionPage",["jquery","app/user","app/i18n","app/viewport","app/updater/index","app/core/View","app/data/prodLog","app/prodShifts/ProdShift","../views/ProductionControlsView","../views/ProductionHeaderView","../views/ProductionDataView","../views/ProdDowntimeListView","../views/ProductionQuantitiesView","app/production/templates/productionPage"],function(e,t,n,r,i,o,a,s,u,l,c,d,p,f){return o.extend({template:f,layoutName:"blank",localTopics:{"socket.connected":function(){this.setUpTimeLog(),this.refreshDowntimes(),this.refreshPlannedQuantities()},"socket.disconnected":function(){this.timers.diagTimeLog&&(clearTimeout(this.timers.diagTimeLog),this.timers.diagTimeLog=null)},"updater.frontendReloading":function(){this.model.saveLocalData()}},breadcrumbs:function(){return[n("production","breadcrumbs:productionPage"),this.model.getLabel()]},initialize:function(){this.shiftEditedSub=null,i.disableViews(),a.enable(),this.defineModels(),this.defineViews(),this.defineBindings(),this.onBeforeUnload=this.onBeforeUnload.bind(this),e(window).on("beforeunload",this.onBeforeUnload)
},destroy:function(){this.shiftEditedSub=null,e(window).off("beforeunload",this.onBeforeUnload),this.model.stopShiftChangeMonitor(),i.enableViews(),a.disable()},serialize:function(){return{locked:this.model.isLocked(),state:this.model.get("state"),mechOrder:!!this.model.prodShiftOrder.get("mechOrder")}},defineModels:function(){this.model.readLocalData()},defineViews:function(){this.controlsView=new u({model:this.model}),this.headerView=new l({model:this.model}),this.dataView=new c({model:this.model}),this.downtimesView=new d({model:this.model}),this.quantitiesView=new p({model:this.model}),this.setView(".production-controls-container",this.controlsView),this.setView(".production-header-container",this.headerView),this.setView(".production-data-container",this.dataView),this.setView(".production-downtimes-container",this.downtimesView),this.setView(".production-quantities-container",this.quantitiesView)},defineBindings:function(){this.listenTo(this.model,"locked",function(){this.$el.removeClass("is-unlocked").addClass("is-locked")}),this.listenTo(this.model,"unlocked",function(){this.$el.removeClass("is-locked").addClass("is-unlocked"),this.refreshDowntimes(),this.refreshPlannedQuantities()}),this.listenTo(this.model,"change:state",function(){var e=this.model.previous("state");null!==e&&this.$el.removeClass("is-"+e),this.$el.addClass("is-"+this.model.get("state"))}),this.listenTo(this.model,"change:shift",function(){r.closeAllDialogs(),this.model.get("shift")&&r.msg.show({type:"info",time:2e3,text:n("production","msg:shiftChange")})}),this.listenTo(this.model,"change:_id",this.subscribeForShiftChanges),this.model.id&&this.subscribeForShiftChanges(),this.listenTo(this.model.prodShiftOrder,"change:mechOrder",function(){this.$el.toggleClass("is-mechOrder",this.model.prodShiftOrder.isMechOrder())}),this.listenTo(this.downtimesView,"corroborated",function(){this.model.saveLocalData()})},afterRender:function(){this.socket.isConnected()&&(this.setUpTimeLog(),this.refreshDowntimes(),this.refreshPlannedQuantities())},refreshDowntimes:function(){if(a.isSyncing())return this.broker.subscribe("production.synced",this.delayDowntimesRefresh.bind(this)).setLimit(1);if(this.model.isLocked())return this.listenToOnce(this.model,"unlocked",this.delayDowntimesRefresh.bind(this));this.timers.refreshingDowntimes&&clearTimeout(this.timers.refreshingDowntimes);var e=this;this.timers.refreshingDowntimes=setTimeout(function(){if(delete e.timers.refreshingDowntimes,e.socket.isConnected()&&!e.model.isLocked()){var t=e.model.prodDowntimes.fetch({reset:!0});e.promised(t).done(function(){e.model.saveLocalData()})}},3e3)},delayDowntimesRefresh:function(){this.timers.refreshDowntimes&&clearTimeout(this.timers.refreshDowntimes),this.timers.refreshDowntimes=setTimeout(function(e){e.timers.refreshDowntimes=null,e.refreshDowntimes()},2500,this)},refreshPlannedQuantities:function(){if(this.model.isLocked())return this.listenToOnce(this.model,"unlocked",this.refreshPlannedQuantities.bind(this));var e=this;this.socket.emit("production.getPlannedQuantities",this.model.id,function(t,n){!t&&e.shiftEditedSub&&e.model.updatePlannedQuantities(n)})},onBeforeUnload:function(){return this.model.isLocked()||(a.disable(),this.model.isIdle()||i.isFrontendReloading())?void 0:(this.timers.enableProdLog=setTimeout(a.enable.bind(a),1e3),this.model.isDowntime()?n("production","unload:downtime"):n("production","unload:order"))},setUpTimeLog:function(){},logTime:function(){this.socket.emit("diag.log",{createdAt:new Date,creator:t.getInfo(),prodLine:this.model.prodLine.id,type:"ping",data:null})},subscribeForShiftChanges:function(){if(this.shiftEditedSub&&this.shiftEditedSub.cancel(),this.model.id){var e=this.model;this.shiftEditedSub=this.pubsub.subscribe("production.edited.shift."+this.model.id).on("message",function(t){e.set(t)})}}})}),define("app/nls/production",["app/nls/locale/en"],function(e){var t={locale:{}};t.locale.en=e;var n=function(e){if(!e)throw new Error("MessageFormat: No data passed to function.")},r=function(e,t){return n(e),e[t]},i=function(e,t,r){return n(e),e[t]in r?r[e[t]]:r.other};return{root:{"breadcrumbs:productionPage":function(){return"Production"},"msg:shiftChange":function(){return"New shift!"},"controls:dashboard":function(){return"Go to dashboard"},"controls:lock":function(){return"Lock the editing"},"controls:unlock":function(){return"Unlock the editing"},"controls:locked":function(){return"Editing locked"},"controls:unlocked":function(){return"Editing unlocked"},"controls:sync":function(){return"Server communication indicator"},"controls:msg:sync:noConnection":function(){return"Cannot unlock: no connection to the server :("},"controls:msg:sync:remoteError":function(){return"Cannot unlock: failed to get the key :("},"controls:msg:sync:success":function(){return"Editing unlocked successfully :)"},"section:data":function(){return"Production data"},"section:history":function(){return"History"},"section:quantities":function(){return"Quantities done"},"section:downtimes":function(){return"Downtimes"},"property:currentTime":function(){return"Current time"},"property:shift":function(){return"Shift"},"property:orgUnit":function(){return"Subdivision"},"property:master":function(){return"Master"},"property:master:change":function(){return"(change)"},"property:master:noData:locked":function(){return"none"},"property:master:noData:unlocked":function(){return"(change master)"},"property:leader":function(){return"Leader"},"property:leader:change":function(){return"(change)"},"property:leader:noData:locked":function(){return"none"},"property:leader:noData:unlocked":function(){return"(change leader)"},"property:operator":function(){return"Operator"},"property:operator:change":function(){return"(change)"},"property:operator:noData:locked":function(){return"none"},"property:operator:noData:unlocked":function(){return"(change operator)"},"property:orderNo":function(){return"Order no"},"property:orderNo:change":function(){return"(change)"},"property:nc12":function(){return"12NC"},"property:nc12:change":function(){return"(change)"},"property:productName":function(){return"Product name"},"property:operationName":function(){return"Operation name"},"property:taktTime":function(){return"Takt [s]"},"property:workerCountSap":function(){return"Worker count as per SAP"},"property:createdAt":function(){return"Started at"},"property:quantityDone":function(){return"Quantity done"},"property:quantityDone:change":function(){return"(change quantity)"},"property:workerCount":function(){return"Worker count"},"property:workerCount:change:data":function(){return"(change count)"},"property:workerCount:change:noData":function(){return"(set count)"},"action:newOrder":function(){return"New order"},"action:continueOrder":function(){return"Continue order"},"action:startDowntime":function(){return"Downtime"},"action:startBreak":function(){return"Break"},"action:endDowntime":function(){return"End downtime"},"action:endWork":function(){return"End work"},"quantities:column:time":function(){return"Time"},"quantities:column:planned":function(){return"Planned [items]"},"quantities:column:actual":function(){return"Actual [items]"},"quantities:change":function(){return"(change)"},"quantities:newValuePlaceholder":function(){return"New quantity..."},"quantityEditor:title":function(){return"Quantity done in an hour"},"quantityEditor:label":function(e){return"Quantity done from "+r(e,"from")+" to "+r(e,"to")+":"},"quantityEditor:submit":function(){return"Set quantity done"},"quantityEditor:cancel":function(){return"Cancel"},"personelPicker:title:master":function(){return"Changing master"},"personelPicker:title:leader":function(){return"Changing leader"},"personelPicker:title:operator":function(){return"Changing operator"},"personelPicker:submit":function(){return"Change user"},"personelPicker:cancel":function(){return"Cancel"},"personelPicker:online:label":function(){return"User:"},"personelPicker:online:placeholder":function(){return"Search by last name or personell ID"},"personelPicker:offline:label":function(){return"User:"},"personelPicker:offline:placeholder":function(){return"User's personell ID"},"personelPicker:offline:warning":function(){return"No connection to the server. You can only enter the user's personell ID."},"newOrderPicker:title":function(){return"Starting a new order"},"newOrderPicker:title:replacing":function(){return"Ending the current order"},"newOrderPicker:title:correcting":function(){return"Correcting the current order"},"newOrderPicker:order:label":function(){return"New order:"},"newOrderPicker:order:placeholder:no":function(){return"Enter the new order's no..."},"newOrderPicker:order:placeholder:nc12":function(){return"Order's 12NC"},"newOrderPicker:operation:label":function(){return"Operation:"},"newOrderPicker:offline:operation:placeholder":function(){return"Operation no"},"newOrderPicker:online:operation:placeholder":function(){return"Choose the new order's operation..."},"newOrderPicker:submit":function(){return"Start order"},"newOrderPicker:submit:replacing":function(){return"End the current order and start a new one"},"newOrderPicker:submit:correcting":function(){return"Correct the current order"},"newOrderPicker:cancel":function(){return"Cancel"},"newOrderPicker:msg:invalidOrderId:no":function(){return"Invalid order no :("},"newOrderPicker:msg:invalidOrderId:nc12":function(){return"Invalid 12NC :("},"newOrderPicker:msg:invalidOperationNo":function(){return"Invalid operation no :("},"newOrderPicker:msg:searchFailure":function(){return"Searching orders failed :("},"newOrderPicker:msg:emptyOrder":function(){return"Order is required."},"newOrderPicker:msg:emptyOperation":function(){return"Operation is required."},"newOrderPicker:online:info:no":function(){return"Enter the order no and choose an operation from the list to start a new order."},"newOrderPicker:online:info:nc12":function(){return"Enter the order's 12NC and choose an operation from the list to start a new order."},"newOrderPicker:offline:warning:no":function(){return"Enter the order no and operation no to start a new order."},"newOrderPicker:offline:warning:nc12":function(){return"Enter the order's 12NC and operation no to start a new order."},"newOrderPicker:checkData:warning":function(){return"Starting a new order will finish the current order. Make sure that the <em>Quantity done</em> and <em>Worker count</em> of the current order have correct values, because after starting a new order, you won't be able to change them."},"newOrderPicker:quantityDone":function(){return"Quantity done in the finished order:"},"newOrderPicker:workerCount":function(){return"Worker count in the finished order:"},"downtimePicker:title:start":function(){return"Starting a new downtime"},"downtimePicker:title:edit":function(){return"Correcting a downtime"},"downtimePicker:submit:start":function(){return"Start downtime"},"downtimePicker:submit:edit":function(){return"Correct downtime"},"downtimePicker:cancel":function(){return"Cancel"},"downtimePicker:reason:label":function(){return"Downtime reason:"},"downtimePicker:reason:placeholder":function(){return"Choose a downtime reason..."},"downtimePicker:reasonComment:label":function(){return"Comment:"},"downtimePicker:reasonComment:placeholder":function(){return"Optional, additional info..."},"downtimePicker:aor:label":function(){return"Area of responsibility:"},"downtimePicker:aor:placeholder":function(){return"Choose an area of responsibility..."},"downtimePicker:msg:emptyReason":function(){return"Downtime reason is required."},"downtimePicker:msg:emptyAor":function(){return"Area of responsibility is required."},"downtimePicker:startedAt":function(){return"Started at"},"downtimePicker:startedAt:now":function(){return"Now"},"prodDowntime:startedAt":function(){return"Started at"},"prodDowntime:finishedAt":function(){return"Finished at"},"prodDowntime:reason":function(){return"Downtime reason"},"prodDowntime:aor":function(){return"Area of responsibility"},"endDowntimeDialog:title":function(){return"Ending downtime confirmation"},"endDowntimeDialog:message":function(){return"<p>Are you sure you want to end the current downtime?</p>"},"endDowntimeDialog:yes":function(){return"End the downtime"},"endDowntimeDialog:no":function(){return"Do not end the downtime"},"continueOrderDialog:title":function(){return"Order continuation confirmation"},"continueOrderDialog:message":function(){return"<p>Are you sure you want to start the currently chosen order?</p>"},"continueOrderDialog:yes":function(){return"Continue the order"},"continueOrderDialog:no":function(){return"Do not continue the order"},"endWorkDialog:title":function(){return"Ending work confirmation"},"endWorkDialog:warning":function(e){return"Ending work will finish "+i(e,"downtime",{"true":"the current downtime and order",other:"the current order"})+". Make sure that the following fields have correct values, because after ending the work, you won't be able to change them."},"endWorkDialog:quantitiesDone":function(e){return"Quantity done in the "+r(e,"hourRange")+" hour:"},"endWorkDialog:quantityDone":function(){return"Quantity done in the current order:"},"endWorkDialog:workerCount":function(){return"Worker count in the current order:"},"endWorkDialog:yes":function(){return"End work"},"endWorkDialog:no":function(){return"Do not end work"},locked:function(){return"Check whether the operator's screen is not running in another window!\n\nIf it's running in another window, then press Cancel and close this window.\n\nIf you want to continue working in this window, then press OK."},"unload:downtime":function(){return"Are you sure you want to close the browser leaving the production line in a state of downtime?\n\nIf you close the browser without Ending work, then the current downtime will be finished at the end of the current shift!"},"unload:order":function(){return"Are you sure you want to close the browser leaving the production line in a state of working?\n\nIf you close the browser without Ending work, then the current order will be finished at the end of the current shift!"}},pl:!0}}),define("app/nls/pl/production",["app/nls/locale/pl"],function(e){var t={locale:{}};t.locale.pl=e;var n=function(e){if(!e)throw new Error("MessageFormat: No data passed to function.")},r=function(e,t){return n(e),e[t]},i=function(e,t,r){return n(e),e[t]in r?r[e[t]]:r.other};return{"breadcrumbs:productionPage":function(){return"Produkcja"},"msg:shiftChange":function(){return"Nowa zmiana!"},"controls:dashboard":function(){return"Przejdź do dashboardu"},"controls:lock":function(){return"Zablokuj edycję"},"controls:unlock":function(){return"Aktywuj edycję"},"controls:locked":function(){return"Edycja zablokowana"},"controls:unlocked":function(){return"Edycja aktywna"},"controls:sync":function(){return"Wskaźnik komunikacji z serwerem"},"controls:msg:sync:noConnection":function(){return"Nie można aktywować edycji: brak połączenia z serwerem :("},"controls:msg:sync:remoteError":function(){return"Nie można aktywować edycji: nieudane pobranie klucza :("},"controls:msg:sync:success":function(){return"Pomyślnie aktywowano edycję :)"},"section:data":function(){return"Dane produkcyjne"},"section:history":function(){return"Historia"},"section:quantities":function(){return"Wykonane ilości"},"section:downtimes":function(){return"Przestoje"},"property:currentTime":function(){return"Aktualny czas"},"property:shift":function(){return"Zmiana"},"property:orgUnit":function(){return"Dział"},"property:master":function(){return"Mistrz"},"property:master:change":function(){return"(zmień)"},"property:master:noData:locked":function(){return"nie wybrany"},"property:master:noData:unlocked":function(){return"(wybierz mistrza)"},"property:leader":function(){return"Lider"},"property:leader:change":function(){return"(zmień)"},"property:leader:noData:locked":function(){return"nie wybrany"},"property:leader:noData:unlocked":function(){return"(wybierz lidera)"},"property:operator":function(){return"Operator"},"property:operator:change":function(){return"(zmień)"},"property:operator:noData:locked":function(){return"nie wybrany"},"property:operator:noData:unlocked":function(){return"(wybierz operatora)"},"property:orderNo":function(){return"Nr zlecenia"},"property:orderNo:change":function(){return"(popraw)"},"property:nc12":function(){return"12NC"},"property:nc12:change":function(){return"(popraw)"},"property:productName":function(){return"Nazwa rodziny/detalu"},"property:operationName":function(){return"Nazwa operacji"},"property:taktTime":function(){return"Takt [s]"},"property:workerCountSap":function(){return"Osoby wg SAP"},"property:createdAt":function(){return"Czas rozpoczęcia"},"property:quantityDone":function(){return"Wykonana ilość"},"property:quantityDone:change":function(){return"(zmień ilość)"},"property:workerCount":function(){return"Osoby pracujące"},"property:workerCount:change:data":function(){return"(zmień ilość)"},"property:workerCount:change:noData":function(){return"(ustaw ilość)"},"action:newOrder":function(){return"Nowe zlecenie"},"action:continueOrder":function(){return"Kontynuuj zlecenie"},"action:startDowntime":function(){return"Przestój"},"action:startBreak":function(){return"Przerwa"},"action:endDowntime":function(){return"Koniec przestoju"},"action:endWork":function(){return"Koniec pracy"},"quantities:column:time":function(){return"Przedział godzinowy"},"quantities:column:planned":function(){return"Plan [szt]"},"quantities:column:actual":function(){return"Wykonane [szt]"},"quantities:change":function(){return"(zmień)"},"quantities:newValuePlaceholder":function(){return"Nowa ilość..."},"quantityEditor:title":function(){return"Wykonana ilość w przedziale godzinowym"},"quantityEditor:label":function(e){return"Ilość wykonana od "+r(e,"from")+" do "+r(e,"to")+":"},"quantityEditor:submit":function(){return"Ustaw ilość"},"quantityEditor:cancel":function(){return"Anuluj ustawianie"},"personelPicker:title:master":function(){return"Wybieranie mistrza"},"personelPicker:title:leader":function(){return"Wybieranie lidera"},"personelPicker:title:operator":function(){return"Wybieranie operatora"},"personelPicker:submit":function(){return"Wybierz użytkownika"},"personelPicker:cancel":function(){return"Anuluj wybieranie"},"personelPicker:online:label":function(){return"Użytkownik:"},"personelPicker:online:placeholder":function(){return"Szukaj po numerze kadrowym lub nazwisku"},"personelPicker:offline:label":function(){return"Użytkownik:"},"personelPicker:offline:placeholder":function(){return"Numer kadrowy użytkownika"},"personelPicker:offline:warning":function(){return"Brak połączenia z serwerem. Możesz tylko wpisać numer kadrowy użytkownika."},"newOrderPicker:title":function(){return"Rozpoczynanie nowego zlecenia"},"newOrderPicker:title:replacing":function(){return"Kończenie aktualnego zlecenia"},"newOrderPicker:title:correcting":function(){return"Poprawianie aktualnego zlecenia"},"newOrderPicker:order:label":function(){return"Nowe zlecenie:"},"newOrderPicker:order:placeholder:no":function(){return"Wpisz numer nowego zlecenia..."},"newOrderPicker:order:placeholder:nc12":function(){return"12NC zlecenia"},"newOrderPicker:operation:label":function(){return"Operacja:"},"newOrderPicker:offline:operation:placeholder":function(){return"Numer operacji"},"newOrderPicker:online:operation:placeholder":function(){return"Wybierz operację nowego zlecenia..."},"newOrderPicker:submit":function(){return"Rozpocznij nowe zlecenie"},"newOrderPicker:submit:replacing":function(){return"Zakończ aktualne zlecenie i rozpocznij nowe"},"newOrderPicker:submit:correcting":function(){return"Popraw aktualne zlecenie"},"newOrderPicker:cancel":function(){return"Anuluj"},"newOrderPicker:msg:invalidOrderId:no":function(){return"Nieprawidłowy numer zlecenia :("},"newOrderPicker:msg:invalidOrderId:nc12":function(){return"Nieprawidłowe 12NC zlecenia :("},"newOrderPicker:msg:invalidOperationNo":function(){return"Nieprawidłowy numer operacji :("},"newOrderPicker:msg:searchFailure":function(){return"Wyszukiwanie zlecenia nie powiodło się :("},"newOrderPicker:msg:emptyOrder":function(){return"Zlecenie jest wymagane."},"newOrderPicker:msg:emptyOperation":function(){return"Operacja jest wymagana."},"newOrderPicker:online:info:no":function(){return"Wpisz numer zlecenia i wybierz z listy operację aby rozpocząć nowe zlecenie."},"newOrderPicker:online:info:nc12":function(){return"Wpisz 12NC zlecenia i wybierz z listy operację aby rozpocząć nowe zlecenie."},"newOrderPicker:offline:warning:no":function(){return"Wpisz numer zlecenia oraz numer operacji aby rozpocząć nowe zlecenie."},"newOrderPicker:offline:warning:nc12":function(){return"Wpisz 12NC zlecenia oraz numer operacji aby rozpocząć nowe zlecenie."},"newOrderPicker:checkData:warning":function(){return"Wybranie nowego zlecenia ukończy aktualnie wybrane zlecenie. Sprawdź czy pola <em>Ilość wykonana</em> i <em>Osoby pracujące</em> aktualnego zlecenia mają prawidłowe wartości, gdyż po wybraniu nowego zlecenia nie będzie można ich zmienić."},"newOrderPicker:quantityDone":function(){return"Ilość wykonana w kończonym zleceniu:"},"newOrderPicker:workerCount":function(){return"Osoby pracujące przy kończonym zleceniu:"},"downtimePicker:title:start":function(){return"Rozpoczynanie przestoju"},"downtimePicker:title:edit":function(){return"Poprawianie przestoju"},"downtimePicker:submit:start":function(){return"Rozpocznij przestój"},"downtimePicker:submit:edit":function(){return"Popraw przestój"},"downtimePicker:cancel":function(){return"Anuluj"},"downtimePicker:reason:label":function(){return"Powód przestoju:"},"downtimePicker:reason:placeholder":function(){return"Wybierz powód przestoju..."},"downtimePicker:reasonComment:label":function(){return"Komentarz:"},"downtimePicker:reasonComment:placeholder":function(){return"Opcjonalne, dodatkowe informacje..."},"downtimePicker:aor:label":function(){return"Obszar odpowiedzialności:"},"downtimePicker:aor:placeholder":function(){return"Wybierz obszar odpowiedzialności..."},"downtimePicker:msg:emptyReason":function(){return"Powód przestoju jest wymagany."},"downtimePicker:msg:emptyAor":function(){return"Obszar odpowiedzialności jest wymagany."},"downtimePicker:startedAt":function(){return"Czas rozpoczęcia"},"downtimePicker:startedAt:now":function(){return"Teraz"},"prodDowntime:startedAt":function(){return"Czas zatrzymania"},"prodDowntime:finishedAt":function(){return"Czas wznowienia"},"prodDowntime:reason":function(){return"Powód przestoju"},"prodDowntime:aor":function(){return"Obszar odpowiedzialności"},"endDowntimeDialog:title":function(){return"Potwierdzenie zakończenia przestoju"},"endDowntimeDialog:message":function(){return"<p>Czy na pewno chcesz zakończyć aktualny przestój?</p>"},"endDowntimeDialog:yes":function(){return"Zakończ przestój"},"endDowntimeDialog:no":function(){return"Nie kończ przestoju"},"continueOrderDialog:title":function(){return"Potwierdzenie kontynuacji zlecenia"},"continueOrderDialog:message":function(){return"<p>Czy na pewno chcesz rozpocząć aktualnie wybrane zlecenie?</p>"},"continueOrderDialog:yes":function(){return"Kontynuuj zlecenie"},"continueOrderDialog:no":function(){return"Nie kontynuuj zlecenia"},"endWorkDialog:title":function(){return"Potwierdzenie zakończenia pracy"},"endWorkDialog:warning":function(e){return"Zakończenie pracy ukończy "+i(e,"downtime",{"true":"aktualnie wybrany przestój i zlecenie",other:"aktualnie wybrane zlecenie"})+". Sprawdź czy poniższe pola mają prawidłowe wartości, gdyż po zakończeniu pracy nie będzie można ich zmienić."},"endWorkDialog:quantitiesDone":function(e){return"Wykonana ilość w przedziale godzinowym "+r(e,"hourRange")+":"},"endWorkDialog:quantityDone":function(){return"Wykonana ilość aktualnego zlecenia:"},"endWorkDialog:workerCount":function(){return"Osoby pracujące przy aktualnym zleceniu:"},"endWorkDialog:yes":function(){return"Zakończ pracę"},"endWorkDialog:no":function(){return"Anuluj"},locked:function(){return"Sprawdź, czy formatka operatora nie jest uruchomiona w innym oknie!\n\nJeżeli formatka operatora jest otwarta w innym oknie, to wciśnij przycisk Anuluj i zamknij to okno.\n\nJeżeli chcesz kontynuować pracę w tym oknie, to wciśnij przycisk OK."},"unload:downtime":function(){return"Czy na pewno chcesz zamknąć przeglądarkę pozostawiając linię produkcyjną w stanie przestoju?\n\nJeżeli zamkniesz przeglądarkę nie wciskając przycisku Koniec pracy, to czas trwania przestoju będzie się naliczał do końca zmiany!"},"unload:order":function(){return"Czy na pewno chcesz zamknąć przeglądarkę pozostawiając linię produkcyjną w stanie wykonywania zlecenia?\n\nJeżeli zamkniesz przeglądarkę nie wciskając przycisku Koniec pracy, to czas trwania zlecenia będzie się naliczał do końca zmiany!"}}}),define("app/production/routes",["../broker","../router","../viewport","../data/prodLines","../data/orgUnits","../prodShifts/ProdShift","./pages/ProductionPage","i18n!app/nls/production"],function(e,t,n,r,i,o,a){t.map("/production/*prodLineId",function(t){var s=r.get(t.params.prodLineId);return null==s?e.publish("router.404",t):void n.showPage(new a({model:new o(i.getAllForProdLine(s),{production:!0})}))})}),define("app/nls/reports",["app/nls/locale/en"],function(e){var t={locale:{}};t.locale.en=e;var n=function(e){if(!e)throw new Error("MessageFormat: No data passed to function.")},r=function(e,t){return n(e),e[t]};return{root:{"BREADCRUMBS:reports":function(){return"Reports"},"BREADCRUMBS:metricRefs":function(){return"Reference values"},"BREADCRUMBS:divisions":function(){return"Divisions"},"BREADCRUMBS:1":function(){return"PROD, EFF, Downtime"},"BREADCRUMBS:2":function(){return"CLIP"},"BREADCRUMBS:3":function(){return"OEE"},"BREADCRUMBS:4":function(){return"Operators"},"PAGE_ACTION:editMetricRefs":function(){return"Change the reference values"},"1:pageTitle":function(){return"PROD, EFF, Downtime"},"2:pageTitle":function(){return"CLIP"},"charts:title:overall":function(){return"ML"},"coeffs:quantityDone":function(){return"Items"},"coeffs:downtime":function(){return"Downtime"},"coeffs:efficiency":function(){return"Efficiency"},"coeffs:productivity":function(){return"Productivity"},"metrics:clip:orderCount":function(){return"Order count"},"metrics:clip:production":function(){return"CLIP Production"},"metrics:clip:endToEnd":function(){return"CLIP End2End"},"downtimesByAor:title":function(){return"Downtimes - AORs."},"downtimesByAor:seriesName":function(){return"Downtime"},"downtimesByAor:press:shortText":function(){return"PWS"},"downtimesByAor:press:longText":function(){return"Press Worksheet"},"downtimesByReason:title":function(){return"Downtimes - reasons"},"downtimesByReason:seriesName":function(){return"Downtime"},quantitySuffix:function(){return" items"},"dirIndir:title":function(){return"DIR/INDIR"},"dirIndir:seriesName":function(){return"FTE"},"effIneff:title":function(){return"Allocation of resources"},"effIneff:seriesName":function(){return"FTE"},"effIneff:category:value":function(){return"I/E"},"effIneff:category:dirIndir":function(){return"D/I"},"effIneff:category:other":function(){return"..."},"effIneff:name:value":function(){return"INEFF/EFF"},"effIneff:name:dirIndir":function(){return"DIRECT/INDIRECT"},"effIneff:name:other":function(){return"Other"},"tooltipHeaderFormat:month":function(){return"YYYY MMMM"},"tooltipHeaderFormat:week":function(){return"wo [week] (LL)"},"tooltipHeaderFormat:day":function(){return"LL"},"tooltipHeaderFormat:shift":function(e){return"LL[, "+r(e,"shift")+" shift]"},"tooltipHeaderFormat:hour":function(){return"LLL"},"filter:mode":function(){return"Mode"},"filter:mode:online":function(){return"Online"},"filter:mode:date":function(){return"Time range"},"filter:from":function(){return"From: "},"filter:to":function(){return"To: "},"filter:interval":function(){return"Interval"},"filter:interval:month":function(){return"month"},"filter:interval:week":function(){return"week"},"filter:interval:day":function(){return"day"},"filter:interval:shift":function(){return"shift"},"filter:interval:hour":function(){return"hour"},"filter:interval:title:month":function(){return"Month"},"filter:interval:title:week":function(){return"Week"},"filter:interval:title:day":function(){return"Day"},"filter:interval:title:shift":function(){return"Shift"},"filter:interval:title:hour":function(){return"Hour"},"filter:subdivisionType":function(){return"Subdivision type"},"filter:subdivisionType:prod":function(){return"Assembly"},"filter:subdivisionType:press":function(){return"Press"},"filter:submit":function(){return"Filter report"},"filter:submit:currentShift":function(){return"Current shift"},"filter:submit:prevShift":function(){return"Previous shift"},"filter:submit:today":function(){return"Today"},"filter:submit:yesterday":function(){return"Yesterday"},"filter:submit:currentWeek":function(){return"Current week"},"filter:submit:prevWeek":function(){return"Previous week"},"filter:submit:currentMonth":function(){return"Current month"},"filter:submit:prevMonth":function(){return"Previous month"},"filter:divisions":function(){return"Division"},"filter:majorMalfunction":function(){return"Major malfunction [h]"},"metricRefs:efficiency":function(){return"Efficiency"},"metricRefs:productivity":function(){return"Productivity"},"metricRefs:overall":function(){return"ML"},"metricRefs:overall:prod":function(){return"Assembly"},"metricRefs:overall:press":function(){return"Press"},"oee:table:loading":function(){return"Loading..."},"oee:table:loadingFailed":function(){return"Loading failed :("},"oee:no":function(){return"#"},"oee:division":function(){return"Division"},"oee:prodLine":function(){return"Machine name"},"oee:inventoryNo":function(){return"Inventory no"},"oee:totalAvailability":function(){return"Total avail. [h]"},"oee:operationalAvailability:h":function(){return"Oper. avail. [h]"},"oee:operationalAvailability:%":function(){return"Oper. avail. [%]"},"oee:exploitation:h":function(){return"Exploitation [h]"},"oee:exploitation:%":function(){return"Exploitation [%]"},"oee:oee":function(){return"OEE [%]"},"oee:adjusting:duration":function(){return"Adjusting time [h]"},"oee:maintenance:duration":function(){return"Maintenance time [h]"},"oee:renovation:duration":function(){return"Renovation time [h]"},"oee:malfunction:duration":function(){return"Malfunction time [h]"},"oee:malfunction:count":function(){return"Malfunction count"},"oee:majorMalfunction:count":function(){return"Major malfunction count"},"oee:mttr":function(){return"MTTR [h]"},"oee:mtbf":function(){return"MTBF [h]"},"operator:filter:mode:shift":function(){return"Shift"},"operator:filter:mode:masters":function(){return"Masters"},"operator:filter:mode:operators":function(){return"Operators"},"operator:effAndProd:title":function(){return"Efficiency/Productivity"},"operator:efficiency:byDivision":function(e){return r(e,"division")+"'s efficiency"},"operator:efficiency":function(){return"Operators' efficiency"},"operator:productivity":function(){return"Operators' productivity"},"operator:workTimes:title":function(){return"Time worked/Downtimes"},"operator:workTimes:total":function(){return"Total time worked"},"operator:workTimes:sap":function(){return"Time worked (SAP)"},"operator:workTimes:otherWorks":function(){return"Time of other works"},"operator:workTimes:downtime":function(){return"Downtime"},"operator:machineTimes:title":function(){return"Machines - work time/adjusting time"},"operator:machineTimes:machineMedian":function(){return"Machine's adjusting median"},"operator:machineTimes:work":function(){return"Time worked"},"operator:machineTimes:operatorMedian":function(){return"Operators' adjusting median"},"operator:quantities:title":function(){return"Quantities done/Material losses"},"operator:quantities:good":function(){return"Good"},"operator:quantities:bad":function(){return"Bad"},"operator:quantities:total":function(){return"Total"},"operator:quantities:loss":function(){return"Losses"},"filenames:1:coeffs":function(){return"WMES_EffProd"
},"filenames:1:downtimesByAor":function(){return"WMES_Downtimes_AOR"},"filenames:1:downtimesByReason":function(){return"WMES_Downtimes_Reasons"},"filenames:2:clip":function(){return"WMES_CLIP"},"filenames:2:dirIndir":function(){return"WMES_DirIndir"},"filenames:2:effIneff":function(){return"WMES_EffIneff"},"filenames:3:oee":function(){return"WMES_OEE"},"filenames:3:downtime":function(){return"WMES_OEE_Downtime"},"filenames:4:effAndProd":function(){return"WMES_Operators_EffProd"},"filenames:4:workTimes":function(){return"WMES_Operators_WorkTimes"},"filenames:4:machineTimes":function(){return"WMES_Operators_MachineTimes"},"filenames:4:quantities":function(){return"WMES_Operators_Quantities"}},pl:!0}}),define("app/nls/pl/reports",["app/nls/locale/pl"],function(e){var t={locale:{}};t.locale.pl=e;var n=function(e){if(!e)throw new Error("MessageFormat: No data passed to function.")},r=function(e,t){return n(e),e[t]};return{"BREADCRUMBS:reports":function(){return"Raporty"},"BREADCRUMBS:metricRefs":function(){return"Wartości referencyjne"},"BREADCRUMBS:divisions":function(){return"Wydziały"},"BREADCRUMBS:1":function(){return"Wskaźniki"},"BREADCRUMBS:2":function(){return"CLIP"},"BREADCRUMBS:3":function(){return"Wykorzystanie zasobów"},"BREADCRUMBS:4":function(){return"Operatorzy"},"PAGE_ACTION:editMetricRefs":function(){return"Zmień wartości referencyjne"},"1:pageTitle":function(){return"Wskaźniki"},"2:pageTitle":function(){return"CLIP"},"charts:title:overall":function(){return"ML"},"coeffs:quantityDone":function(){return"Sztuki"},"coeffs:downtime":function(){return"Przestoje"},"coeffs:efficiency":function(){return"Wydajność"},"coeffs:productivity":function(){return"Produktywność"},"metrics:clip:orderCount":function(){return"Ilość zleceń"},"metrics:clip:production":function(){return"CLIP Produkcja"},"metrics:clip:endToEnd":function(){return"CLIP End2End"},"downtimesByAor:title":function(){return"Czas przestojów - obszary odp."},"downtimesByAor:seriesName":function(){return"Czas przestojów"},"downtimesByAor:press:shortText":function(){return"TKP"},"downtimesByAor:press:longText":function(){return"Tłocznia (karta pracy)"},"downtimesByReason:title":function(){return"Czas przestojów - przyczyny"},"downtimesByReason:seriesName":function(){return"Czas przestojów"},quantitySuffix:function(){return" szt."},"dirIndir:title":function(){return"DIR/INDIR"},"dirIndir:seriesName":function(){return"FTE"},"effIneff:title":function(){return"Podział zasobów"},"effIneff:seriesName":function(){return"FTE"},"effIneff:category:value":function(){return"I/E"},"effIneff:category:dirIndir":function(){return"D/I"},"effIneff:category:other":function(){return"..."},"effIneff:name:value":function(){return"INEFF/EFF"},"effIneff:name:dirIndir":function(){return"DIRECT/INDIRECT"},"effIneff:name:other":function(){return"Inne"},"tooltipHeaderFormat:month":function(){return"YYYY MMMM"},"tooltipHeaderFormat:week":function(){return"wo [tydzień] (LL)"},"tooltipHeaderFormat:day":function(){return"LL"},"tooltipHeaderFormat:shift":function(e){return"LL[, "+r(e,"shift")+" zmiana]"},"tooltipHeaderFormat:hour":function(){return"LLL"},"filter:mode":function(){return"Tryb"},"filter:mode:online":function(){return"Online"},"filter:mode:date":function(){return"Zadany okres czasu"},"filter:from":function(){return"Od: "},"filter:to":function(){return"Do: "},"filter:interval":function(){return"Podział czasu"},"filter:interval:month":function(){return"mc"},"filter:interval:week":function(){return"tydz"},"filter:interval:day":function(){return"dzień"},"filter:interval:shift":function(){return"zm"},"filter:interval:hour":function(){return"godz"},"filter:interval:title:month":function(){return"Miesiąc"},"filter:interval:title:week":function(){return"Tydzień"},"filter:interval:title:day":function(){return"Dzień"},"filter:interval:title:shift":function(){return"Zmiana"},"filter:interval:title:hour":function(){return"Godzina"},"filter:subdivisionType":function(){return"Typ działu"},"filter:subdivisionType:prod":function(){return"Montaż"},"filter:subdivisionType:press":function(){return"Tłocznia"},"filter:submit":function(){return"Filtruj raport"},"filter:submit:currentShift":function(){return"Aktualna zmiana"},"filter:submit:prevShift":function(){return"Poprzednia zmiana"},"filter:submit:today":function(){return"Dzisiaj"},"filter:submit:yesterday":function(){return"Wczoraj"},"filter:submit:currentWeek":function(){return"Aktualny tydzień"},"filter:submit:prevWeek":function(){return"Poprzedni tydzień"},"filter:submit:currentMonth":function(){return"Aktualny miesiąc"},"filter:submit:prevMonth":function(){return"Poprzedni miesiąc"},"filter:divisions":function(){return"Wydział"},"filter:majorMalfunction":function(){return"Poważna awaria [h]"},"metricRefs:efficiency":function(){return"Wydajność"},"metricRefs:productivity":function(){return"Produktywność"},"metricRefs:overall":function(){return"ML"},"metricRefs:overall:prod":function(){return"Montaż"},"metricRefs:overall:press":function(){return"Tłocznia"},"oee:table:loading":function(){return"Ładowanie..."},"oee:table:loadingFailed":function(){return"Ładowanie nie powiodło się :("},"oee:no":function(){return"Lp."},"oee:division":function(){return"Wydział"},"oee:prodLine":function(){return"Nazwa maszyny"},"oee:inventoryNo":function(){return"Nr inwent."},"oee:totalAvailability":function(){return"Dyspoz. maszyn całkowita [h]"},"oee:operationalAvailability:h":function(){return"Dyspoz. maszyn oper. [h]"},"oee:operationalAvailability:%":function(){return"Dyspoz. maszyn oper. [%]"},"oee:exploitation:h":function(){return"Wykorz. maszyn [h]"},"oee:exploitation:%":function(){return"Wykorz. maszyn [%]"},"oee:oee":function(){return"OEE [%]"},"oee:adjusting:duration":function(){return"Czas ustaw. / przezbr. [h]"},"oee:maintenance:duration":function(){return"Czas konserw. [h]"},"oee:renovation:duration":function(){return"Czas przeglądów / remontów [h]"},"oee:malfunction:duration":function(){return"Czas wszystkich awarii [h]"},"oee:malfunction:count":function(){return"Ilość wszystkich awarii [szt]"},"oee:majorMalfunction:count":function(){return"Ilość poważnych awarii [szt]"},"oee:mttr":function(){return"MTTR [h]"},"oee:mtbf":function(){return"MTBF [h]"},"operator:filter:mode:shift":function(){return"Zmiana"},"operator:filter:mode:masters":function(){return"Mistrzowie"},"operator:filter:mode:operators":function(){return"Operatorzy"},"operator:effAndProd:title":function(){return"Wydajność/Produktywność"},"operator:efficiency:byDivision":function(e){return"Wydajność "+r(e,"division")},"operator:efficiency":function(){return"Wydajność operatorów"},"operator:productivity":function(){return"Produktywność operatorów"},"operator:workTimes:title":function(){return"Przepracowany czas/Przestoje"},"operator:workTimes:total":function(){return"Całkowity przepracowany czas"},"operator:workTimes:sap":function(){return"Czas przepracowany (SAP)"},"operator:workTimes:otherWorks":function(){return"Czas innych prac"},"operator:workTimes:downtime":function(){return"Czas przestoju"},"operator:machineTimes:title":function(){return"Maszyny - czas pracy/czasy przezbrojeń"},"operator:machineTimes:machineMedian":function(){return"Mediana przezbrojeń maszyny"},"operator:machineTimes:work":function(){return"Czas przepracowany"},"operator:machineTimes:operatorMedian":function(){return"Mediana przezbrojeń operatorów"},"operator:quantities:title":function(){return"Ilości wykonane/Straty materiałowe"},"operator:quantities:good":function(){return"Dobre"},"operator:quantities:bad":function(){return"Wadliwe"},"operator:quantities:total":function(){return"Suma"},"operator:quantities:loss":function(){return"Straty"},"filenames:1:coeffs":function(){return"WMES_Wskazniki_WydProd"},"filenames:1:downtimesByAor":function(){return"WMES_Przestoje_ObszOdp"},"filenames:1:downtimesByReason":function(){return"WMES_Przestoje_Powody"},"filenames:2:clip":function(){return"WMES_CLIP"},"filenames:2:dirIndir":function(){return"WMES_DirIndir"},"filenames:2:effIneff":function(){return"WMES_PodzialZasobow"},"filenames:3:oee":function(){return"WMES_WykZas_OEE"},"filenames:3:downtime":function(){return"WMES_WykZas_Przestoje"},"filenames:4:effAndProd":function(){return"WMES_Operatorzy_WydProd"},"filenames:4:workTimes":function(){return"WMES_Operatorzy_CzasPracy"},"filenames:4:machineTimes":function(){return"WMES_Operatorzy_CzasPrzezbr"},"filenames:4:quantities":function(){return"WMES_Operatorzy_WykIlosci"}}}),define("app/reports/routes",["../user","../router","../viewport","i18n!app/nls/reports"],function(e,t,n){var r=e.auth("REPORTS:VIEW");t.map("/reports/1",r,function(e){return n.currentPage&&"report1"===n.currentPage.pageId?n.currentPage.query.reset(e.query):void n.loadPage("app/reports/pages/Report1Page",function(t){return new t({query:e.query})})}),t.map("/reports/2",r,function(e){return n.currentPage&&"report2"===n.currentPage.pageId?n.currentPage.query.reset(e.query):void n.loadPage("app/reports/pages/Report2Page",function(t){return new t({query:e.query})})}),t.map("/reports/3",r,function(e){n.loadPage("app/reports/pages/Report3Page",function(t){return new t({query:e.rql})})}),t.map("/reports/4",r,function(e){n.loadPage("app/reports/pages/Report4Page",function(t){return new t({query:e.query})})}),t.map("/reports;metricRefs",e.auth("REPORTS:MANAGE"),function(e){n.loadPage("app/reports/pages/MetricRefsPage",function(t){return new t({initialTab:e.query.tab||"efficiency"})})})}),define("app/nls/subdivisions",["app/nls/locale/en"],function(e){var t={locale:{}};t.locale.en=e;var n=function(e){if(!e)throw new Error("MessageFormat: No data passed to function.")},r=function(e,t){return n(e),e[t]};return{root:{"BREADCRUMBS:browse":function(){return"Subdivisions"},"BREADCRUMBS:addForm":function(){return"Adding"},"BREADCRUMBS:editForm":function(){return"Editing"},"BREADCRUMBS:ACTION_FORM:delete":function(){return"Deleting"},"MSG:LOADING_FAILURE":function(){return"Failed to load the subdivisions :("},"MSG:LOADING_SINGLE_FAILURE":function(){return"Failed to load the subdivision :("},"MSG:DELETED":function(e){return"Subdivision <em>"+r(e,"label")+"</em> was deleted."},"PAGE_ACTION:add":function(){return"Add subdivision"},"PAGE_ACTION:edit":function(){return"Edit subdivision"},"PAGE_ACTION:delete":function(){return"Delete subdivision"},"PANEL:TITLE:details":function(){return"Subdivision's details"},"PANEL:TITLE:addForm":function(){return"Add subdivision form"},"PANEL:TITLE:editForm":function(){return"Edit subdivision form"},"PROPERTY:_id":function(){return"ID"},"PROPERTY:division":function(){return"Division"},"PROPERTY:name":function(){return"Name"},"PROPERTY:prodTaskTags":function(){return"Production task tags"},"PROPERTY:type":function(){return"Type"},"PROPERTY:aor":function(){return"Default AOR"},"TYPE:assembly":function(){return"Assembly"},"TYPE:press":function(){return"Press"},"TYPE:storage":function(){return"Warehouse"},"FORM:ACTION:add":function(){return"Add subdivision"},"FORM:ACTION:edit":function(){return"Edit subdivision"},"FORM:ERROR:addFailure":function(){return"Failed to add the new subdivision :-("},"FORM:ERROR:editFailure":function(){return"Failed to edit the subdivision :-("},"ACTION_FORM:DIALOG_TITLE:delete":function(){return"Subdivision deletion confirmation"},"ACTION_FORM:BUTTON:delete":function(){return"Delete subdivision"},"ACTION_FORM:MESSAGE:delete":function(){return"Are you sure you want to delete the chosen subdivision?"},"ACTION_FORM:MESSAGE_SPECIFIC:delete":function(e){return"Are you sure you want to delete the <em>"+r(e,"label")+"</em> subdivision?"},"ACTION_FORM:MESSAGE_FAILURE:delete":function(){return"Failed to delete the subdivision :-("}},pl:!0}}),define("app/nls/pl/subdivisions",["app/nls/locale/pl"],function(e){var t={locale:{}};t.locale.pl=e;var n=function(e){if(!e)throw new Error("MessageFormat: No data passed to function.")},r=function(e,t){return n(e),e[t]};return{"BREADCRUMBS:browse":function(){return"Działy"},"BREADCRUMBS:addForm":function(){return"Dodawanie"},"BREADCRUMBS:editForm":function(){return"Edycja"},"BREADCRUMBS:ACTION_FORM:delete":function(){return"Usuwanie"},"MSG:LOADING_FAILURE":function(){return"Ładowanie działów nie powiodło się :("},"MSG:LOADING_SINGLE_FAILURE":function(){return"Ładowanie działu nie powiodło się :("},"MSG:DELETED":function(e){return"Dział <em>"+r(e,"label")+"</em> zostało usunięte."},"PAGE_ACTION:add":function(){return"Dodaj dział"},"PAGE_ACTION:edit":function(){return"Edytuj dział"},"PAGE_ACTION:delete":function(){return"Usuń dział"},"PANEL:TITLE:details":function(){return"Szczegóły działu"},"PANEL:TITLE:addForm":function(){return"Formularz dodawania działu"},"PANEL:TITLE:editForm":function(){return"Formularz edycji działu"},"PROPERTY:_id":function(){return"ID"},"PROPERTY:division":function(){return"Wydział"},"PROPERTY:name":function(){return"Nazwa"},"PROPERTY:prodTaskTags":function(){return"Tagi zadań produkcyjnych"},"PROPERTY:type":function(){return"Typ"},"PROPERTY:aor":function(){return"Domyślny obszar odp."},"TYPE:assembly":function(){return"Montaż"},"TYPE:press":function(){return"Tłocznia"},"TYPE:storage":function(){return"Magazyn"},"FORM:ACTION:add":function(){return"Dodaj dział"},"FORM:ACTION:edit":function(){return"Edytuj dział"},"FORM:ERROR:addFailure":function(){return"Nie udało się dodać działu :-("},"FORM:ERROR:editFailure":function(){return"Nie udało się zmodyfikować działu :-("},"FORM:PLACEHOLDER:aor":function(){return"Wybierz obszar odpowiedzialności..."},"ACTION_FORM:DIALOG_TITLE:delete":function(){return"Potwierdzenie usunięcia działu"},"ACTION_FORM:BUTTON:delete":function(){return"Usuń dział"},"ACTION_FORM:MESSAGE:delete":function(){return"Czy na pewno chcesz bezpowrotnie usunąć wybrany dział?"},"ACTION_FORM:MESSAGE_SPECIFIC:delete":function(e){return"Czy na pewno chcesz bezpowrotnie usunąć dział <em>"+r(e,"label")+"</em>?"},"ACTION_FORM:MESSAGE_FAILURE:delete":function(){return"Nie udało się usunąć działu :-("}}}),define("app/subdivisions/routes",["../router","../viewport","../i18n","../user","../core/util/showDeleteFormPage","../data/subdivisions","./Subdivision","i18n!app/nls/subdivisions"],function(e,t,n,r,i,o,a){var s=r.auth("DICTIONARIES:VIEW"),u=r.auth("DICTIONARIES:MANAGE");e.map("/subdivisions",s,function(){t.loadPage(["app/core/pages/ListPage","app/subdivisions/views/decorateSubdivision"],function(e,t){return new e({collection:o,columns:["division","type","name","prodTaskTags","aor"],serializeRow:t})})}),e.map("/subdivisions/:id",function(e){t.loadPage(["app/core/pages/DetailsPage","app/subdivisions/views/SubdivisionDetailsView"],function(t,n){return new t({DetailsView:n,model:new a({_id:e.params.id})})})}),e.map("/subdivisions;add",u,function(){t.loadPage("app/subdivisions/pages/AddSubdivisionFormPage",function(e){return new e({model:new a})})}),e.map("/subdivisions/:id;edit",u,function(e){t.loadPage("app/subdivisions/pages/EditSubdivisionFormPage",function(t){return new t({model:new a({_id:e.params.id})})})}),e.map("/subdivisions/:id;delete",u,i.bind(null,a))}),define("app/nls/users",["app/nls/locale/en"],function(e){var t={locale:{}};t.locale.en=e;var n=function(e){if(!e)throw new Error("MessageFormat: No data passed to function.")},r=function(e,t){return n(e),e[t]};return{root:{"BREADCRUMBS:browse":function(){return"Users"},"BREADCRUMBS:addForm":function(){return"Adding"},"BREADCRUMBS:editForm":function(){return"Editing"},"BREADCRUMBS:ACTION_FORM:delete":function(){return"Deleting"},"MSG:LOADING_FAILURE":function(){return"Failed to load the users :("},"MSG:LOADING_SINGLE_FAILURE":function(){return"Failed to load the user :("},"MSG:DELETED":function(e){return"User <em>"+r(e,"label")+"</em> was deleted."},"MSG:SYNCED":function(){return"Users were synchronized successfully :)"},"MSG:SYNC_FAILURE":function(){return"Failed to synchronize the users :("},"PAGE_ACTION:add":function(){return"Add user"},"PAGE_ACTION:edit":function(){return"Edit user"},"PAGE_ACTION:delete":function(){return"Delete user"},"PAGE_ACTION:sync":function(){return"Synchronize with the AC database"},"PANEL:TITLE:details":function(){return"User's details"},"PANEL:TITLE:addForm":function(){return"Add user form"},"PANEL:TITLE:editForm":function(){return"Edit user form"},"FILTER:BUTTON":function(){return"Filter users"},"FILTER:LIMIT":function(){return"Limit"},"FILTER:PLACEHOLDER:personellId":function(){return"Any personell ID"},"FILTER:PLACEHOLDER:lastName":function(){return"Any last name"},"PROPERTY:login":function(){return"Login"},"PROPERTY:password":function(){return"Password"},"PROPERTY:password2":function(){return"Confirm password"},"PROPERTY:email":function(){return"E-mail address"},"PROPERTY:privileges":function(){return"Privileges"},"PROPERTY:prodFunction":function(){return"Production function"},"PROPERTY:aors":function(){return"Areas of responsibility"},"PROPERTY:company":function(){return"Companies"},"PROPERTY:kdDivision":function(){return"Division (AC)"},"PROPERTY:personellId":function(){return"Personell ID"},"PROPERTY:card":function(){return"Card no"},"PROPERTY:name":function(){return"Name"},"PROPERTY:firstName":function(){return"First name"},"PROPERTY:lastName":function(){return"Last name"},"PROPERTY:registerDate":function(){return"Register date"},"PROPERTY:kdPosition":function(){return"Position (AC)"},"PROPERTY:active":function(){return"Active?"},"PROPERTY:orgUnit":function(){return"Org Unit"},"ACTIVE:true":function(){return"Yes"},"ACTIVE:false":function(){return"No"},"FORM:ACTION:add":function(){return"Add user"},"FORM:ACTION:edit":function(){return"Edit user"},"FORM:ERROR:passwordMismatch":function(){return"The specified password do not match."},"FORM:ERROR:addFailure":function(){return"Failed to add the user :-("},"FORM:ERROR:editFailure":function(){return"Failed to edit the user :-("},"NO_DATA:aors":function(){return"All"},"NO_DATA:company":function(){return"Unspecified"},"NO_DATA:prodFunction":function(){return"Unspecified"},"ACTION_FORM:DIALOG_TITLE:delete":function(){return"User deletion confirmation"},"ACTION_FORM:BUTTON:delete":function(){return"Delete user"},"ACTION_FORM:MESSAGE:delete":function(){return"Are you sure you want to delete the chosen user?"},"ACTION_FORM:MESSAGE_SPECIFIC:delete":function(e){return"Are you sure you want to delete the <em>"+r(e,"label")+"</em> user?"},"ACTION_FORM:MESSAGE_FAILURE:delete":function(){return"Failed to delete the user :-("},"PRIVILEGE:ORDERS:VIEW":function(){return"Orders: view"},"PRIVILEGE:ORDERS:MANAGE":function(){return"Orders: manage"},"PRIVILEGE:EVENTS:VIEW":function(){return"Events: view"},"PRIVILEGE:EVENTS:MANAGE":function(){return"Events: manage"},"PRIVILEGE:USERS:VIEW":function(){return"Users: view"},"PRIVILEGE:USERS:MANAGE":function(){return"Users: manage"},"PRIVILEGE:DICTIONARIES:VIEW":function(){return"Dictionaries: view"},"PRIVILEGE:DICTIONARIES:MANAGE":function(){return"Dictionaries: manage"},"PRIVILEGE:FTE:MASTER:VIEW":function(){return"FTE (production): view"},"PRIVILEGE:FTE:MASTER:MANAGE":function(){return"FTE (production): manage"},"PRIVILEGE:FTE:MASTER:ALL":function(){return"FTE (production): access to all divisions"},"PRIVILEGE:FTE:LEADER:VIEW":function(){return"FTE (distribution): view"},"PRIVILEGE:FTE:LEADER:MANAGE":function(){return"FTE (distribution): manage"},"PRIVILEGE:FTE:LEADER:ALL":function(){return"FTE (distribution): access to all divisions"},"PRIVILEGE:HOURLY_PLANS:VIEW":function(){return"Hourly plans: view"},"PRIVILEGE:HOURLY_PLANS:MANAGE":function(){return"Hourly plans: manage"},"PRIVILEGE:HOURLY_PLANS:ALL":function(){return"Hourly plans: access to all divisions"},"PRIVILEGE:PROD_DOWNTIMES:VIEW":function(){return"Downtimes: view"},"PRIVILEGE:PROD_DOWNTIMES:MANAGE":function(){return"Downtimes: corroboration"},"PRIVILEGE:PROD_DOWNTIMES:ALL":function(){return"Downtimes: access to all divisions"},"PRIVILEGE:PRESS_WORKSHEETS:VIEW":function(){return"Worksheets: view"},"PRIVILEGE:PRESS_WORKSHEETS:MANAGE":function(){return"Worksheets: manage"},"PRIVILEGE:PROD_DATA:VIEW":function(){return"Production data: view"},"PRIVILEGE:PROD_DATA:MANAGE":function(){return"Production data: manage"},"PRIVILEGE:REPORTS:VIEW":function(){return"Reports: view"},"PRIVILEGE:REPORTS:MANAGE":function(){return"Reports: manage"},"PRIVILEGE:XICONF:VIEW":function(){return"Xiconf: view"},"PRIVILEGE:XICONF:MANAGE":function(){return"Xiconf: manage"},"select2:placeholder":function(){return"Search by last name or personnel ID..."},"select2:users:system":function(){return"System"}},pl:!0}}),define("app/nls/pl/users",["app/nls/locale/pl"],function(e){var t={locale:{}};t.locale.pl=e;var n=function(e){if(!e)throw new Error("MessageFormat: No data passed to function.")},r=function(e,t){return n(e),e[t]};return{"BREADCRUMBS:browse":function(){return"Użytkownicy"},"BREADCRUMBS:addForm":function(){return"Dodawanie"},"BREADCRUMBS:editForm":function(){return"Edycja"},"BREADCRUMBS:ACTION_FORM:delete":function(){return"Usuwanie"},"MSG:LOADING_FAILURE":function(){return"Ładowanie użytkowników nie powiodło się :("},"MSG:LOADING_SINGLE_FAILURE":function(){return"Ładowanie użytkownika nie powiodło się :("},"MSG:DELETED":function(e){return"Użytkownik <em>"+r(e,"label")+"</em> został usunięty."},"MSG:SYNCED":function(){return"Użytkownicy zostali zsynchronizowani :)"},"MSG:SYNC_FAILURE":function(){return"Synchronizacja użytkowników nie powiodła się :("},"PAGE_ACTION:add":function(){return"Dodaj użytkownika"},"PAGE_ACTION:edit":function(){return"Edytuj użytkownika"},"PAGE_ACTION:delete":function(){return"Usuń użytkownika"},"PAGE_ACTION:sync":function(){return"Synchronizuj z bazą KD"},"PANEL:TITLE:details":function(){return"Szczegóły użytkownika"},"PANEL:TITLE:addForm":function(){return"Formularz dodawania użytkownika"},"PANEL:TITLE:editForm":function(){return"Formularz edycji użytkownika"},"FILTER:BUTTON":function(){return"Filtruj użytkowników"},"FILTER:LIMIT":function(){return"Limit"},"FILTER:PLACEHOLDER:personellId":function(){return"Dowolny nr"},"FILTER:PLACEHOLDER:lastName":function(){return"Dowolne nazwisko"},"PROPERTY:login":function(){return"Login"},"PROPERTY:password":function(){return"Hasło"},"PROPERTY:password2":function(){return"Potwierdzenie hasła"},"PROPERTY:email":function(){return"Adres e-mail"},"PROPERTY:privileges":function(){return"Uprawnienia"},"PROPERTY:prodFunction":function(){return"Funkcja na produkcji"},"PROPERTY:aors":function(){return"Obszary odpowiedzialności"},"PROPERTY:company":function(){return"Firma"},"PROPERTY:kdDivision":function(){return"Wydział (KD)"},"PROPERTY:personellId":function(){return"Nr kadrowy"},"PROPERTY:card":function(){return"Nr karty"},"PROPERTY:name":function(){return"Imię i nazwisko"},"PROPERTY:firstName":function(){return"Imię"},"PROPERTY:lastName":function(){return"Nazwisko"},"PROPERTY:registerDate":function(){return"Data rejestracji"},"PROPERTY:kdPosition":function(){return"Stanowisko (KD)"},"PROPERTY:active":function(){return"Aktywny?"},"PROPERTY:orgUnit":function(){return"Jednostka organizacyjna"},"ACTIVE:true":function(){return"Tak"},"ACTIVE:false":function(){return"Nie"},"FORM:ACTION:add":function(){return"Dodaj użytkownika"},"FORM:ACTION:edit":function(){return"Edytuj użytkownika"},"FORM:ERROR:passwordMismatch":function(){return"Podane hasła nie pasują do siebie."},"FORM:ERROR:addFailure":function(){return"Nie udało się dodać użytkownika :-("},"FORM:ERROR:editFailure":function(){return"Nie udało się zmodyfikować użytkownika :-("},"NO_DATA:aors":function(){return"Wszystkie"},"NO_DATA:company":function(){return"Nieokreślona"},"NO_DATA:prodFunction":function(){return"Nieokreślona"},"ACTION_FORM:DIALOG_TITLE:delete":function(){return"Potwierdzenie usunięcia użytkownika"},"ACTION_FORM:BUTTON:delete":function(){return"Usuń użytkownika"},"ACTION_FORM:MESSAGE:delete":function(){return"Czy na pewno chcesz bezpowrotnie usunąć wybranego użytkownika?"},"ACTION_FORM:MESSAGE_SPECIFIC:delete":function(e){return"Czy na pewno chcesz bezpowrotnie usunąć użytkownika <em>"+r(e,"label")+"</em>?"},"ACTION_FORM:MESSAGE_FAILURE:delete":function(){return"Nie udało się usunąć użytkownika :-("},"PRIVILEGE:ORDERS:VIEW":function(){return"Zlecenia: przeglądanie"},"PRIVILEGE:ORDERS:MANAGE":function(){return"Zlecenia: zarządzanie"},"PRIVILEGE:EVENTS:VIEW":function(){return"Zdarzenia: przeglądanie"},"PRIVILEGE:EVENTS:MANAGE":function(){return"Zdarzenia: zarządzanie"},"PRIVILEGE:USERS:VIEW":function(){return"Użytkownicy: przeglądanie"},"PRIVILEGE:USERS:MANAGE":function(){return"Użytkownicy: zarządzanie"},"PRIVILEGE:DICTIONARIES:VIEW":function(){return"Słowniki: przeglądanie"},"PRIVILEGE:DICTIONARIES:MANAGE":function(){return"Słowniki: zarządzanie"},"PRIVILEGE:FTE:MASTER:VIEW":function(){return"FTE (produkcja): przeglądanie"},"PRIVILEGE:FTE:MASTER:MANAGE":function(){return"FTE (produkcja): zarządzanie"},"PRIVILEGE:FTE:MASTER:ALL":function(){return"FTE (produkcja): dostęp do wszystkich wydziałów"},"PRIVILEGE:FTE:LEADER:VIEW":function(){return"FTE (magazyn): przeglądanie"},"PRIVILEGE:FTE:LEADER:MANAGE":function(){return"FTE (magazyn): zarządzanie"},"PRIVILEGE:FTE:LEADER:ALL":function(){return"FTE (magazyn): dostęp do wszystkich wydziałów"},"PRIVILEGE:HOURLY_PLANS:VIEW":function(){return"Plany godzinowe: przeglądanie"},"PRIVILEGE:HOURLY_PLANS:MANAGE":function(){return"Plany godzinowe: zarządzanie"},"PRIVILEGE:HOURLY_PLANS:ALL":function(){return"Plany godzinowe: dostęp do wszystkich wydziałów"},"PRIVILEGE:PROD_DOWNTIMES:VIEW":function(){return"Przestoje: przeglądanie"},"PRIVILEGE:PROD_DOWNTIMES:MANAGE":function(){return"Przestoje: potwierdzanie"},"PRIVILEGE:PROD_DOWNTIMES:ALL":function(){return"Przestoje: dostęp do wszystkich wydziałów"},"PRIVILEGE:PRESS_WORKSHEETS:VIEW":function(){return"Karty pracy: przeglądanie"},"PRIVILEGE:PRESS_WORKSHEETS:MANAGE":function(){return"Karty pracy: dodawanie"},"PRIVILEGE:PROD_DATA:VIEW":function(){return"Dane produkcyjne: przeglądanie"},"PRIVILEGE:PROD_DATA:MANAGE":function(){return"Dane produkcyjne: zarządzanie"},"PRIVILEGE:REPORTS:VIEW":function(){return"Raporty: przeglądanie"},"PRIVILEGE:REPORTS:MANAGE":function(){return"Raporty: zarządzanie"},"PRIVILEGE:XICONF:VIEW":function(){return"Xiconf: przeglądanie"},"PRIVILEGE:XICONF:MANAGE":function(){return"Xiconf: zarządzanie"},"select2:placeholder":function(){return"Szukaj po nazwisku lub nr kadrowym..."},"select2:users:system":function(){return"System"}}}),define("app/users/routes",["../router","../viewport","../user","../core/util/showDeleteFormPage","./User","i18n!app/nls/users"],function(e,t,n,r,i){var o=n.auth("USERS:VIEW"),a=n.auth("USERS:MANAGE");e.map("/users",o,function(e){t.loadPage(["app/users/pages/UserListPage"],function(t){return new t({rql:e.rql})})}),e.map("/users/:id",function(e,t,r){e.params.id===n.data._id?r():o(e,t,r)},function(e){t.loadPage(["app/core/pages/DetailsPage","app/users/views/UserDetailsView"],function(t,n){return new t({DetailsView:n,model:new i({_id:e.params.id})})})}),e.map("/users;add",a,function(){t.loadPage(["app/core/pages/AddFormPage","app/users/views/UserFormView"],function(e,t){return new e({FormView:t,model:new i})})}),e.map("/users/:id;edit",a,function(e){t.loadPage(["app/core/pages/EditFormPage","app/users/views/UserFormView"],function(t,n){return new t({FormView:n,model:new i({_id:e.params.id})})})}),e.map("/users/:id;delete",a,r.bind(null,i))}),define("app/nls/vis",["app/nls/locale/en"],function(e){var t={locale:{}};t.locale.en=e;return{root:{"BREADCRUMBS:structure":function(){return"Org Unit structure"}},pl:!0}}),define("app/nls/pl/vis",["app/nls/locale/pl"],function(e){var t={locale:{}};t.locale.pl=e;return{"BREADCRUMBS:structure":function(){return"Wizualizacja struktury organizacyjnej"}}}),define("app/vis/routes",["../router","../viewport","i18n!app/nls/vis"],function(e,t){e.map("/vis/structure",t.loadPage.bind(t,"app/vis/pages/StructureVisPage"))}),define("app/nls/workCenters",["app/nls/locale/en"],function(e){var t={locale:{}};t.locale.en=e;var n=function(e){if(!e)throw new Error("MessageFormat: No data passed to function.")},r=function(e,t){return n(e),e[t]};return{root:{"BREADCRUMBS:browse":function(){return"WorkCenters"},"BREADCRUMBS:addForm":function(){return"Adding"},"BREADCRUMBS:editForm":function(){return"Editing"},"BREADCRUMBS:ACTION_FORM:delete":function(){return"Deleting"},"MSG:LOADING_FAILURE":function(){return"Failed to load the WorkCenters :("},"MSG:LOADING_SINGLE_FAILURE":function(){return"Failed to load the WorkCenter :("},"MSG:DELETED":function(e){return"WorkCenter <em>"+r(e,"label")+"</em> was deleted."},"PAGE_ACTION:add":function(){return"Add WorkCenter"},"PAGE_ACTION:edit":function(){return"Edit WorkCenter"},"PAGE_ACTION:delete":function(){return"Delete WorkCenter"},"PANEL:TITLE:details":function(){return"WorkCenter's details"},"PANEL:TITLE:addForm":function(){return"Add WorkCenter form"},"PANEL:TITLE:editForm":function(){return"Edit WorkCenter form"},"PROPERTY:_id":function(){return"ID"},"PROPERTY:description":function(){return"Label"},"PROPERTY:orgUnitPath":function(){return"MRP Controller/Production flow"},"FORM:ACTION:add":function(){return"Add WorkCenter"},"FORM:ACTION:edit":function(){return"Edit WorkCenter"},"FORM:ERROR:addFailure":function(){return"Failed to add the new WorkCenter :-("},"FORM:ERROR:editFailure":function(){return"Failed to edit the WorkCenter :-("},"ACTION_FORM:DIALOG_TITLE:delete":function(){return"WorkCenter deletion confirmation"},"ACTION_FORM:BUTTON:delete":function(){return"Delete WorkCenter"},"ACTION_FORM:MESSAGE:delete":function(){return"Are you sure you want to delete the chosen WorkCenter?"},"ACTION_FORM:MESSAGE_SPECIFIC:delete":function(e){return"Are you sure you want to delete the <em>"+r(e,"label")+"</em> WorkCenter?"},"ACTION_FORM:MESSAGE_FAILURE:delete":function(){return"Failed to delete the WorkCenter :-("}},pl:!0}}),define("app/nls/pl/workCenters",["app/nls/locale/pl"],function(e){var t={locale:{}};t.locale.pl=e;var n=function(e){if(!e)throw new Error("MessageFormat: No data passed to function.")},r=function(e,t){return n(e),e[t]};return{"BREADCRUMBS:browse":function(){return"WorkCentra"},"BREADCRUMBS:addForm":function(){return"Dodawanie"},"BREADCRUMBS:editForm":function(){return"Edycja"},"BREADCRUMBS:ACTION_FORM:delete":function(){return"Usuwanie"},"MSG:LOADING_FAILURE":function(){return"Ładowanie WorkCentrów nie powiodło się :("},"MSG:LOADING_SINGLE_FAILURE":function(){return"Ładowanie WorkCenter nie powiodło się :("},"MSG:DELETED":function(e){return"WorkCenter <em>"+r(e,"label")+"</em> zostało usunięte."},"PAGE_ACTION:add":function(){return"Dodaj WorkCenter"},"PAGE_ACTION:edit":function(){return"Edytuj WorkCenter"},"PAGE_ACTION:delete":function(){return"Usuń WorkCenter"},"PANEL:TITLE:details":function(){return"Szczegóły WorkCenter"},"PANEL:TITLE:addForm":function(){return"Formularz dodawania WorkCenter"},"PANEL:TITLE:editForm":function(){return"Formularz edycji WorkCenter"},"PROPERTY:_id":function(){return"ID"},"PROPERTY:description":function(){return"Opis"},"PROPERTY:orgUnitPath":function(){return"Kontroler MRP/Przepływ"},"FORM:ACTION:add":function(){return"Dodaj WorkCenter"},"FORM:ACTION:edit":function(){return"Edytuj WorkCenter"},"FORM:ERROR:addFailure":function(){return"Nie udało się dodać WorkCenter :-("},"FORM:ERROR:editFailure":function(){return"Nie udało się zmodyfikować WorkCenter :-("},"ACTION_FORM:DIALOG_TITLE:delete":function(){return"Potwierdzenie usunięcia WorkCenter"},"ACTION_FORM:BUTTON:delete":function(){return"Usuń WorkCenter"},"ACTION_FORM:MESSAGE:delete":function(){return"Czy na pewno chcesz bezpowrotnie usunąć wybrane WorkCenter?"},"ACTION_FORM:MESSAGE_SPECIFIC:delete":function(e){return"Czy na pewno chcesz bezpowrotnie usunąć WorkCenter <em>"+r(e,"label")+"</em>?"},"ACTION_FORM:MESSAGE_FAILURE:delete":function(){return"Nie udało się usunąć WorkCenter :-("}}}),define("app/workCenters/routes",["../router","../viewport","../user","../core/util/showDeleteFormPage","../data/workCenters","./WorkCenter","i18n!app/nls/workCenters"],function(e,t,n,r,i,o){var a=n.auth("DICTIONARIES:VIEW"),s=n.auth("DICTIONARIES:MANAGE");
e.map("/workCenters",a,function(){t.loadPage(["app/core/pages/ListPage","app/workCenters/views/WorkCenterListView"],function(e,t){return new e({ListView:t,collection:i})})}),e.map("/workCenters/:id",function(e){t.loadPage(["app/core/pages/DetailsPage","app/workCenters/views/WorkCenterDetailsView"],function(t,n){return new t({DetailsView:n,model:new o({_id:e.params.id})})})}),e.map("/workCenters;add",s,function(){t.loadPage(["app/core/pages/AddFormPage","app/workCenters/views/WorkCenterFormView"],function(e,t){return new e({FormView:t,model:new o})})}),e.map("/workCenters/:id;edit",s,function(e){t.loadPage(["app/core/pages/EditFormPage","app/workCenters/views/WorkCenterFormView"],function(t,n){return new t({FormView:n,model:new o({_id:e.params.id})})})}),e.map("/workCenters/:id;delete",s,r.bind(null,o))}),define("app/nls/xiconf",["app/nls/locale/en"],function(e){var t={locale:{}};t.locale.en=e;var n=function(e){if(!e)throw new Error("MessageFormat: No data passed to function.")},r=function(e,t){return n(e),e[t]},i=function(e,r,i,o,a){return n(e),e[r]in a?a[e[r]]:(r=t.locale[o](e[r]-i),r in a?a[r]:a.other)},o=function(e,t,r){return n(e),e[t]in r?r[e[t]]:r.other};return{root:{"BREADCRUMBS:browse":function(){return"Programming results"},"BREADCRUMBS:details":function(){return"Result"},"MSG:LOADING_FAILURE":function(){return"Failed to load the programming results :("},"MSG:LOADING_SINGLE_FAILURE":function(){return"Failed to load the programming result :("},"PANEL:TITLE:details:order":function(){return"Order details"},"PANEL:TITLE:details:entry":function(){return"Programming details"},"PAGE_ACTION:export":function(){return"Export results"},"PAGE_ACTION:download":function(){return"Download configuration"},"PAGE_ACTION:download:workflow":function(){return"Programmer configuration"},"PAGE_ACTION:download:feature":function(){return"Driver configuration"},"PROPERTY:srcId":function(){return"Installation ID"},"PROPERTY:srcTitle":function(){return"Installation title"},"PROPERTY:srcIp":function(){return"Installation IP"},"PROPERTY:srcUuid":function(){return"Installation key"},"PROPERTY:no":function(){return"Order no"},"PROPERTY:totalCounter":function(){return"Total programming attemps"},"PROPERTY:successCounter":function(){return"Successful programming attempts"},"PROPERTY:failureCounter":function(){return"Failed programming attempts"},"PROPERTY:order":function(){return"Order"},"PROPERTY:quantity":function(){return"Quantity"},"PROPERTY:counter":function(){return"Counter"},"PROPERTY:nc12":function(){return"12NC"},"PROPERTY:startedAt":function(){return"Started at"},"PROPERTY:finishedAt":function(){return"Finished at"},"PROPERTY:duration":function(){return"Duration"},"PROPERTY:log":function(){return"Log"},"PROPERTY:result":function(){return"Result"},"PROPERTY:errorCode":function(){return"Error"},"PROPERTY:exception":function(){return"Exception"},"PROPERTY:output":function(){return"MultiOne Workflow output"},"PROPERTY:featureFile":function(){return"Driver configuration file"},"PROPERTY:featureFileName":function(){return"Driver configuration file name"},"PROPERTY:feature":function(){return"Driver configuration file contents"},"PROPERTY:workflowFile":function(){return"Programmer configuration file"},"PROPERTY:workflow":function(){return"Programmer configuration file contents"},"PROPERTY:programName":function(){return"Program name"},"FILTER:from":function(){return"From"},"FILTER:to":function(){return"To"},"FILTER:result:success":function(){return"Success"},"FILTER:result:failure":function(){return"Failure"},"FILTER:PLACEHOLDER:srcId":function(){return"Any"},"FILTER:limit":function(){return"Limit"},"FILTER:submit":function(){return"Filter results"},"tab:log":function(){return"Programming log"},"tab:output":function(){return"MultiOne Workflow output"},"tab:workflow":function(){return"Programmer configuration"},"tab:feature":function(){return"Driver configuration"},"log:ORDER_CREATED":function(e){return"Starting a new order no <code>"+r(e,"orderNo")+"</code> (1/"+r(e,"quantity")+")..."},"log:ORDER_CONTINUED":function(e){return"Continuuing an existing order no <code>"+r(e,"orderNo")+"</code> ("+r(e,"counter")+"/"+r(e,"quantity")+")..."},"log:PROGRAMMING_STARTED":function(e){return"Starting a programming of the 12NC <code>"+r(e,"nc12")+"</code>..."},"log:COUNTDOWN_STARTED":function(e){return"Counting down <code>"+r(e,"delay")+"</code> "+i(e,"delay",0,"en",{one:"second",other:"seconds"})+"..."},"log:READING_WORKFLOW_FILE":function(e){return"Reading contents of the programmer configuration file: <code>"+r(e,"workflowFile")+"</code>"},"log:WORKFLOW_FILE_READ":function(e){return"Read <code>"+r(e,"length")+"B</code> of the programmer configuration file."},"log:SEARCHING_FEATURE_FILE":function(e){return"Searching for a driver configuration file in path: <code>"+r(e,"featurePath")+"</code>"},"log:SEARCHING_FEATURE_FILE_FAILURE":function(e){return"Driver configuration file searching failed: <code>"+r(e,"error")+"</code>"},"log:SEARCHING_FEATURE_FILE_TIMEOUT":function(){return"Driver configuration file searching timed out."},"log:MISSING_FEATURE_FILE_1":function(){return"Driver configuration file was not found in the first path."},"log:MISSING_FEATURE_FILE_2":function(){return"Driver configuration file was not found in the backup path."},"log:DUPLICATE_FEATURE_FILE_1":function(e){return"Found "+r(e,"fileCount")+" driver configuration "+i(e,"fileCount",0,"en",{one:"file",other:"files"})+" for the specified 12NC in the first path."},"log:DUPLICATE_FEATURE_FILE_2":function(e){return"Found "+r(e,"fileCount")+" driver configuration "+i(e,"fileCount",0,"en",{one:"file",other:"files"})+" for the specified 12NC in the backup path."},"log:FEATURE_FILE_FOUND":function(e){return"Found the driver configuration file: <code>"+r(e,"featureFile")+"</code>"},"log:SKIPPING_FEATURE_FILE_2":function(){return"Skipping searching for the driver configuration file in the backup path..."},"log:CANCELLING":function(){return"Cancelling the programming..."},"log:PROGRAMMING_SUCCESS":function(e){return"Successfully finished the programming of the 12NC <code>"+r(e,"nc12")+"</code> in <code>"+r(e,"duration")+"</code>."},"log:PROGRAMMING_FAILURE":function(e){return"Finished the programming of the 12NC <code>"+r(e,"nc12")+"</code> in <code>"+r(e,"duration")+"</code> with an error: <code>"+r(e,"error")+"</code>"},"log:READING_FEATURE_FILE":function(){return"Reading contents of the driver configuration file..."},"log:READING_FEATURE_FILE_FAILURE":function(e){return"Reading contents of the driver configuration file failed: <code>"+r(e,"error")+"</code>"},"log:READING_FEATURE_FILE_TIMEOUT":function(){return"Reading contents of the driver configuration file timed out."},"log:FEATURE_FILE_READ":function(e){return"Read <code>"+r(e,"length")+"B</code> of the driver configuration file."},"log:STARTING_PROGRAMMER":function(e){return"Starting the programmer using the <code>"+o(e,"interface",{d:"DALI",z:"ZigBee",i:"IP",other:"?"})+"</code> interface: <code>"+r(e,"programmerFile")+"</code>"},"error:WORKFLOW_FILE_ERROR":function(){return"Error during reading of the contents of the programmer configuration file."},"error:FEATURE_FILE_ERROR":function(){return"Error during reading of the contents of the driver configuration file."},"error:UNSET_WORKFLOW_FILE":function(){return"Path to the programmer configuration file was not set."},"error:UNSET_FEATURE_PATH_1":function(){return"First path to the driver configuration files was not set."},"error:UNSET_PROGRAMMER_FILE":function(){return"Path to the programmer executable file was not set."},"error:MISSING_WORKFLOW_FILE":function(){return"Programmer configuration file was not found."},"error:MISSING_FEATURE_FILE":function(){return"Driver configuration file was not found."},"error:DUPLICATE_FEATURE_FILE":function(){return"Detected multiple driver configuration files for the specified 12NC."},"error:CANCELLED":function(){return"Programming cancelled."},"error:READING_FEATURE_FILE_TIMEOUT":function(){return"Reading of the contents of the driver configuration file timed out."},"error:MISSING_PROGRAMMER_FILE":function(){return"Programmer executable file was not found."},"error:PROGRAMMER_FILE_ERROR":function(){return"Error during running of the programmer executable file."},"error:EXIT_CODE:-1":function(){return"MultiOneWorkflow (-1): general application failure."},"error:EXIT_CODE:4":function(){return"MultiOneWorkflow (4): verification failed."},"error:EXIT_CODE:9":function(){return"MultiOneWorkflow (9): workflow configuration file not found."},"error:EXIT_CODE:10":function(){return"MultiOneWorkflow (10): workflow configuration file not valid."},"error:EXIT_CODE:101":function(){return"MultiOneWorkflow (101): there are no features to write."},"error:EXIT_CODE:200":function(){return"MultiOneWorkflow (200): feature file not present."},"error:EXIT_CODE:201":function(){return"MultiOneWorkflow (201): invalid feature configuration file."},"error:EXIT_CODE:202":function(){return"MultiOneWorkflow (202): feature configuration file is null or empty."},"error:EXIT_CODE:203":function(){return"MultiOneWorkflow (203): feature configuration file contains duplicate features."},"error:EXIT_CODE:300":function(){return"MultiOneWorkflow (300): the device does not support all features from the feature configuration file."},"error:EXIT_CODE:500":function(){return"MultiOneWorkflow (500): no device found."},"error:EXIT_CODE:501":function(){return"MultiOneWorkflow (501): too many devices found."},"error:EXIT_CODE:502":function(){return"MultiOneWorkflow (502): unable to execute discover."},"error:EXIT_CODE:503":function(){return"MultiOneWorkflow (503): multiple devices share the same short address."},"error:EXIT_CODE:600":function(){return"MultiOneWorkflow (600): no features to convert."},"error:EXIT_CODE:700":function(){return"MultiOneWorkflow (700): no interface connected."},"error:EXIT_CODE:800":function(){return"MultiOneWorkflow (800): convert feature data is not possible."}},pl:!0}}),define("app/nls/pl/xiconf",["app/nls/locale/pl"],function(e){var t={locale:{}};t.locale.pl=e;var n=function(e){if(!e)throw new Error("MessageFormat: No data passed to function.")},r=function(e,t){return n(e),e[t]},i=function(e,r,i,o,a){return n(e),e[r]in a?a[e[r]]:(r=t.locale[o](e[r]-i),r in a?a[r]:a.other)},o=function(e,t,r){return n(e),e[t]in r?r[e[t]]:r.other};return{"BREADCRUMBS:browse":function(){return"Wyniki programowania"},"BREADCRUMBS:details":function(){return"Wynik"},"MSG:LOADING_FAILURE":function(){return"Ładowanie wyników programowania nie powiodło się :("},"MSG:LOADING_SINGLE_FAILURE":function(){return"Ładowanie danych wpisu wyniku programowania nie powiodło się :("},"PANEL:TITLE:details:order":function(){return"Szczegóły zlecenia"},"PANEL:TITLE:details:entry":function(){return"Szczegóły programowania"},"PAGE_ACTION:export":function(){return"Eksportuj wyniki"},"PAGE_ACTION:download":function(){return"Pobierz konfigurację"},"PAGE_ACTION:download:workflow":function(){return"Konfiguracja programatora"},"PAGE_ACTION:download:feature":function(){return"Konfiguracja drivera"},"PROPERTY:srcId":function(){return"ID instalacji"},"PROPERTY:srcTitle":function(){return"Tytuł instalacji"},"PROPERTY:srcIp":function(){return"IP instalacji"},"PROPERTY:srcUuid":function(){return"Klucz instalacji"},"PROPERTY:no":function(){return"Nr zlecenia"},"PROPERTY:totalCounter":function(){return"Całkowita ilość programowań"},"PROPERTY:successCounter":function(){return"Ilość pomyślnych programowań"},"PROPERTY:failureCounter":function(){return"Ilość błędnych programowań"},"PROPERTY:order":function(){return"Zlecenie"},"PROPERTY:quantity":function(){return"Ilość"},"PROPERTY:counter":function(){return"Licznik"},"PROPERTY:nc12":function(){return"12NC"},"PROPERTY:startedAt":function(){return"Czas rozpoczęcia"},"PROPERTY:finishedAt":function(){return"Czas zakończenia"},"PROPERTY:duration":function(){return"Czas trwania"},"PROPERTY:log":function(){return"Log"},"PROPERTY:result":function(){return"Wynik"},"PROPERTY:errorCode":function(){return"Błąd"},"PROPERTY:exception":function(){return"Szczegóły błędu"},"PROPERTY:output":function(){return"Odpowiedź MultiOne Workflow"},"PROPERTY:featureFile":function(){return"Plik konfiguracyjny drivera"},"PROPERTY:featureFileName":function(){return"Nazwa pliku konfiguracyjnego drivera"},"PROPERTY:feature":function(){return"Zawartość pliku konfiguracyjego drivera"},"PROPERTY:workflowFile":function(){return"Plik konfiguracyjny programatora"},"PROPERTY:workflow":function(){return"Zawartość pliku konfiguracyjnego programatora"},"PROPERTY:programName":function(){return"Nazwa programu"},"FILTER:from":function(){return"Od"},"FILTER:to":function(){return"Do"},"FILTER:result:success":function(){return"Sukces"},"FILTER:result:failure":function(){return"Porażka"},"FILTER:PLACEHOLDER:srcId":function(){return"Dowolne"},"FILTER:limit":function(){return"Limit"},"FILTER:submit":function(){return"Filtruj wyniki"},"tab:log":function(){return"Przebieg programowania"},"tab:output":function(){return"Odpowiedź MultiOne Workflow"},"tab:workflow":function(){return"Konfiguracja programatora"},"tab:feature":function(){return"Konfiguracja drivera"},"log:ORDER_CREATED":function(e){return"Rozpoczynanie zlecenia nr <code>"+r(e,"orderNo")+"</code> (1/"+r(e,"quantity")+")..."},"log:ORDER_CONTINUED":function(e){return"Kontynuacja zlecenia nr <code>"+r(e,"orderNo")+"</code> ("+r(e,"counter")+"/"+r(e,"quantity")+")..."},"log:PROGRAMMING_STARTED":function(e){return"Rozpoczynanie programowania 12NC <code>"+r(e,"nc12")+"</code>..."},"log:COUNTDOWN_STARTED":function(e){return"Odliczanie <code>"+r(e,"delay")+"</code> "+i(e,"delay",0,"pl",{one:"sekundy",other:"sekund"})+"..."},"log:READING_WORKFLOW_FILE":function(e){return"Odczytywanie pliku konfiguracyjnego programatora: <code>"+r(e,"workflowFile")+"</code>"},"log:WORKFLOW_FILE_READ":function(e){return"Odczytano <code>"+r(e,"length")+"B</code> pliku konfiguracyjnego programatora."},"log:SEARCHING_FEATURE_FILE":function(e){return"Wyszukiwanie pliku konfiguracyjnego drivera w ścieżce: <code>"+r(e,"featurePath")+"</code>"},"log:SEARCHING_FEATURE_FILE_FAILURE":function(e){return"Nieudane wyszukiwanie pliku: <code>"+r(e,"error")+"</code>"},"log:SEARCHING_FEATURE_FILE_TIMEOUT":function(){return"Upłynął limit czasu wyszukiwania pliku konfiguracyjnego drivera."},"log:MISSING_FEATURE_FILE_1":function(){return"Nie znaleziono pliku konfiguracyjnego drivera w pierwszej ścieżce."},"log:MISSING_FEATURE_FILE_2":function(){return"Nie znaleziono pliku konfiguracyjnego drivera w ścieżce zapasowej."},"log:DUPLICATE_FEATURE_FILE_1":function(e){return"W pierwszej ścieżce wykryto "+r(e,"fileCount")+" "+i(e,"fileCount",0,"pl",{one:"plik konfiguracyjny drivera",few:"pliki konfiguracje driverów",other:"plików konfiguracyjnych driverów"})+" dla danego kodu 12NC."},"log:DUPLICATE_FEATURE_FILE_2":function(e){return"W ścieżce zapasowej wykryto "+r(e,"fileCount")+" "+i(e,"fileCount",0,"pl",{one:"plik konfiguracyjny drivera",few:"pliki konfiguracje driverów",other:"plików konfiguracyjnych driverów"})+" dla danego kodu 12NC."},"log:FEATURE_FILE_FOUND":function(e){return"Znaleziono plik konfiguracyjny drivera: <code>"+r(e,"featureFile")+"</code>"},"log:SKIPPING_FEATURE_FILE_2":function(){return"Pomijanie wyszukiwania pliku konfiguracyjnego drivera w ścieżce zapasowej..."},"log:CANCELLING":function(){return"Anulowanie programowania..."},"log:PROGRAMMING_SUCCESS":function(e){return"Pomyślnie ukończono programowanie 12NC <code>"+r(e,"nc12")+"</code> w ciągu <code>"+r(e,"duration")+"</code>."},"log:PROGRAMMING_FAILURE":function(e){return"Zakończono programowanie 12NC <code>"+r(e,"nc12")+"</code> w ciągu <code>"+r(e,"duration")+"</code> z powodu błędu: <code>"+r(e,"error")+"</code>"},"log:READING_FEATURE_FILE":function(){return"Odczytywanie pliku konfiguracyjnego drivera..."},"log:READING_FEATURE_FILE_FAILURE":function(e){return"Błąd podczas odczytywania pliku: <code>"+r(e,"error")+"</code>"},"log:READING_FEATURE_FILE_TIMEOUT":function(){return"Upłynął limit czasu odczytywania pliku."},"log:FEATURE_FILE_READ":function(e){return"Odczytano <code>"+r(e,"length")+"B</code> pliku konfiguracyjnego drivera."},"log:STARTING_PROGRAMMER":function(e){return"Uruchamianie programatora przez interfejs <code>"+o(e,"interface",{d:"DALI",z:"ZigBee",i:"IP",other:"?"})+"</code>: <code>"+r(e,"programmerFile")+"</code>"},"error:WORKFLOW_FILE_ERROR":function(){return"Błąd podczas odczytywania pliku konfiguracyjnego programatora."},"error:FEATURE_FILE_ERROR":function(){return"Błąd podczas odczytywania pliku konfiguracyjnego drivera."},"error:UNSET_WORKFLOW_FILE":function(){return"Nie ustawiono ścieżki do pliku konfiguracyjnego programatora."},"error:UNSET_FEATURE_PATH_1":function(){return"Nie ustawiono pierwszej ścieżki do plików konfiguracyjnych driverów."},"error:UNSET_PROGRAMMER_FILE":function(){return"Nie ustawiono ścieżki do pliku wykonywalnego programatora."},"error:MISSING_WORKFLOW_FILE":function(){return"Nie znaleziono pliku konfiguracyjnego programatora."},"error:MISSING_FEATURE_FILE":function(){return"Nie znaleziono pliku konfiguracyjnego drivera."},"error:DUPLICATE_FEATURE_FILE":function(){return"Wykryto kilka plików konfiguracyjnych driverów dla danego kodu 12NC."},"error:CANCELLED":function(){return"Programowanie anulowano."},"error:READING_FEATURE_FILE_TIMEOUT":function(){return"Upłynięcie limitu czasu odczytywania pliku konfiguracyjnego drivera."},"error:MISSING_PROGRAMMER_FILE":function(){return"Nie znaleziono pliku wykonywalnego programatora."},"error:PROGRAMMER_FILE_ERROR":function(){return"Błąd podczas uruchamiania pliku wykonywalnego programatora."},"error:EXIT_CODE:-1":function(){return"MultiOneWorkflow (-1): błąd aplikacji."},"error:EXIT_CODE:4":function(){return"MultiOneWorkflow (4): błąd weryfikacji."},"error:EXIT_CODE:9":function(){return"MultiOneWorkflow (9): nie znaleziono pliku konfiguracyjnego programatora."},"error:EXIT_CODE:10":function(){return"MultiOneWorkflow (10): nieprawidłowy plik konfiguracyjny programatora."},"error:EXIT_CODE:101":function(){return"MultiOneWorkflow (101): brak opcji drivera do zapisu."},"error:EXIT_CODE:200":function(){return"MultiOneWorkflow (200): nie znaleziono pliku konfiguracyjnego drivera."},"error:EXIT_CODE:201":function(){return"MultiOneWorkflow (201): nieprawidłowy plik konfiguracyjny drivera."},"error:EXIT_CODE:202":function(){return"MultiOneWorkflow (202): pusty plik konfiguracyjny drivera."},"error:EXIT_CODE:203":function(){return"MultiOneWorkflow (203): wykryto zduplikowane opcje drivera."},"error:EXIT_CODE:300":function(){return"MultiOneWorkflow (300): urządzenie nie obsługuje wszystkich opcji z pliku konfiguracyjnego."},"error:EXIT_CODE:500":function(){return"MultiOneWorkflow (500): nie znaleziono urządzenia."},"error:EXIT_CODE:501":function(){return"MultiOneWorkflow (501): znaleziono za dużo urządzeń."},"error:EXIT_CODE:502":function(){return"MultiOneWorkflow (502): nie można wykonać wyszukiwania urządzeń."},"error:EXIT_CODE:503":function(){return"MultiOneWorkflow (503): kilka urządzeń ma taki sam krótki adres."},"error:EXIT_CODE:600":function(){return"MultiOneWorkflow (600): brak opcji drivera do konwersji."},"error:EXIT_CODE:700":function(){return"MultiOneWorkflow (700): nie podłączono interfejsu."},"error:EXIT_CODE:800":function(){return"MultiOneWorkflow (800): niemożliwa konwersja danych opcji drivera."}}}),define("app/xiconf/routes",["../router","../viewport","../user","i18n!app/nls/xiconf"],function(e,t,n){var r=n.auth("XICONF:VIEW");e.map("/xiconf/results",r,function(e){t.loadPage(["app/xiconf/pages/XiconfResultListPage"],function(t){return new t({rql:e.rql})})}),e.map("/xiconf/results/:id",r,function(e){t.loadPage(["app/xiconf/pages/XiconfResultDetailsPage"],function(t){return new t({modelId:e.params.id})})})}),define("app/routes",["./aors/routes","./companies/routes","./dashboard/routes","./divisions/routes","./downtimeReasons/routes","./lossReasons/routes","./events/routes","./emptyOrders/routes","./fte/routes","./hourlyPlans/routes","./mechOrders/routes","./mrpControllers/routes","./orders/routes","./orderStatuses/routes","./pressWorksheets/routes","./prodDowntimes/routes","./prodFlows/routes","./prodFunctions/routes","./prodLines/routes","./prodTasks/routes","./prodLogEntries/routes","./prodShiftOrders/routes","./prodShifts/routes","./production/routes","./reports/routes","./subdivisions/routes","./users/routes","./vis/routes","./workCenters/routes","./xiconf/routes"],function(){}),function(){window.visibly={q:document,p:void 0,prefixes:["webkit","ms","o","moz","khtml"],props:["VisibilityState","visibilitychange","Hidden"],m:["focus","blur"],visibleCallbacks:[],hiddenCallbacks:[],genericCallbacks:[],_callbacks:[],cachedPrefix:"",onVisible:function(e){"function"==typeof e&&this.visibleCallbacks.push(e)},onHidden:function(e){"function"==typeof e&&this.hiddenCallbacks.push(e)},getPrefix:function(){if(!this.cachedPrefix)for(var e=0;b=this.prefixes[e++];)if(b+this.props[2]in this.q)return this.cachedPrefix=b,this.cachedPrefix},visibilityState:function(){return this._getProp(0)},hidden:function(){return this._getProp(2)},visibilitychange:function(e){"function"==typeof e&&this.genericCallbacks.push(e);var t=this.genericCallbacks.length;if(t)if(this.cachedPrefix)for(;t--;)this.genericCallbacks[t].call(this,this.visibilityState());else for(;t--;)this.genericCallbacks[t].call(this,arguments[0])},isSupported:function(){return this.cachedPrefix+this.props[2]in this.q},_getProp:function(e){return this.q[this.cachedPrefix+this.props[e]]},_execute:function(e){if(e){this._callbacks=1==e?this.visibleCallbacks:this.hiddenCallbacks;for(var t=this._callbacks.length;t--;)this._callbacks[t]()}},_visible:function(){window.visibly._execute(1),window.visibly.visibilitychange.call(window.visibly,"visible")},_hidden:function(){window.visibly._execute(2),window.visibly.visibilitychange.call(window.visibly,"hidden")},_nativeSwitch:function(){this[this._getProp(2)?"_hidden":"_visible"]()},_listen:function(){try{this.isSupported()?this.q.addEventListener(this.cachedPrefix+this.props[1],function(){window.visibly._nativeSwitch.apply(window.visibly,arguments)},1):this.q.addEventListener?(window.addEventListener(this.m[0],this._visible,1),window.addEventListener(this.m[1],this._hidden,1)):this.q.attachEvent&&(this.q.attachEvent("onfocusin",this._visible),this.q.attachEvent("onfocusout",this._hidden))}catch(e){}},init:function(){this.getPrefix(),this._listen()}},this.visibly.init()}(),define("visibly",function(e){return function(){var t;return t||e.visibly}}(this)),define("app/visibility",["jquery","visibly","app/broker"],function(e,t,n){var r={visible:!t.hidden()};return t.onVisible(function(){r.visible=!0,n.publish("visibility.visible",r)}),t.onHidden(function(){r.visible=!1,n.publish("visibility.hidden",r)}),r}),+function(e){var t=function(n,r){this.$element=e(n),this.options=e.extend({},t.DEFAULTS,r)};t.DEFAULTS={loadingText:"loading..."},t.prototype.setState=function(e){var t="disabled",n=this.$element,r=n.is("input")?"val":"html",i=n.data();e+="Text",i.resetText||n.data("resetText",n[r]()),n[r](i[e]||this.options[e]),setTimeout(function(){"loadingText"==e?n.addClass(t).attr(t,t):n.removeClass(t).removeAttr(t)},0)},t.prototype.toggle=function(){var e=this.$element.closest('[data-toggle="buttons"]');if(e.length){var t=this.$element.find("input").prop("checked",!this.$element.hasClass("active")).trigger("change");"radio"===t.prop("type")&&e.find(".active").removeClass("active")}this.$element.toggleClass("active")};var n=e.fn.button;e.fn.button=function(n){return this.each(function(){var r=e(this),i=r.data("bs.button"),o="object"==typeof n&&n;i||r.data("bs.button",i=new t(this,o)),"toggle"==n?i.toggle():n&&i.setState(n)})},e.fn.button.Constructor=t,e.fn.button.noConflict=function(){return e.fn.button=n,this},e(document).on("click.bs.button.data-api","[data-toggle^=button]",function(t){var n=e(t.target);n.hasClass("btn")||(n=n.closest(".btn")),n.button("toggle"),t.preventDefault()})}(jQuery),+function(e){function t(){e(r).remove(),e(i).each(function(t){var r=n(e(this));r.hasClass("open")&&(r.trigger(t=e.Event("hide.bs.dropdown")),t.isDefaultPrevented()||r.removeClass("open").trigger("hidden.bs.dropdown"))})}function n(t){var n=t.attr("data-target");n||(n=t.attr("href"),n=n&&/#/.test(n)&&n.replace(/.*(?=#[^\s]*$)/,""));var r=n&&e(n);return r&&r.length?r:t.parent()}var r=".dropdown-backdrop",i="[data-toggle=dropdown]",o=function(t){e(t).on("click.bs.dropdown",this.toggle)};o.prototype.toggle=function(r){var i=e(this);if(!i.is(".disabled, :disabled")){var o=n(i),a=o.hasClass("open");if(t(),!a){if("ontouchstart"in document.documentElement&&!o.closest(".navbar-nav").length&&e('<div class="dropdown-backdrop"/>').insertAfter(e(this)).on("click",t),o.trigger(r=e.Event("show.bs.dropdown")),r.isDefaultPrevented())return;o.toggleClass("open").trigger("shown.bs.dropdown"),i.focus()}return!1}},o.prototype.keydown=function(t){if(/(38|40|27)/.test(t.keyCode)){var r=e(this);if(t.preventDefault(),t.stopPropagation(),!r.is(".disabled, :disabled")){var o=n(r),a=o.hasClass("open");if(!a||a&&27==t.keyCode)return 27==t.which&&o.find(i).focus(),r.click();var s=e("[role=menu] li:not(.divider):visible a",o);if(s.length){var u=s.index(s.filter(":focus"));38==t.keyCode&&u>0&&u--,40==t.keyCode&&u<s.length-1&&u++,~u||(u=0),s.eq(u).focus()}}}};var a=e.fn.dropdown;e.fn.dropdown=function(t){return this.each(function(){var n=e(this),r=n.data("dropdown");r||n.data("dropdown",r=new o(this)),"string"==typeof t&&r[t].call(n)})},e.fn.dropdown.Constructor=o,e.fn.dropdown.noConflict=function(){return e.fn.dropdown=a,this},e(document).on("click.bs.dropdown.data-api",t).on("click.bs.dropdown.data-api",".dropdown form",function(e){e.stopPropagation()}).on("click.bs.dropdown.data-api",i,o.prototype.toggle).on("keydown.bs.dropdown.data-api",i+", [role=menu]",o.prototype.keydown)}(jQuery),+function(e){var t=function(t,n){this.options=n,this.$element=e(t),this.$backdrop=this.isShown=null,this.options.remote&&this.$element.load(this.options.remote)};t.DEFAULTS={backdrop:!0,keyboard:!0,show:!0},t.prototype.toggle=function(e){return this[this.isShown?"hide":"show"](e)},t.prototype.show=function(t){var n=this,r=e.Event("show.bs.modal",{relatedTarget:t});this.$element.trigger(r),this.isShown||r.isDefaultPrevented()||(this.isShown=!0,this.escape(),this.$element.on("click.dismiss.modal",'[data-dismiss="modal"]',e.proxy(this.hide,this)),this.backdrop(function(){var r=e.support.transition&&n.$element.hasClass("fade");n.$element.parent().length||n.$element.appendTo(document.body),n.$element.show(),r&&n.$element[0].offsetWidth,n.$element.addClass("in").attr("aria-hidden",!1),n.enforceFocus();var i=e.Event("shown.bs.modal",{relatedTarget:t});r?n.$element.find(".modal-dialog").one(e.support.transition.end,function(){n.$element.focus().trigger(i)}).emulateTransitionEnd(300):n.$element.focus().trigger(i)}))},t.prototype.hide=function(t){t&&t.preventDefault(),t=e.Event("hide.bs.modal"),this.$element.trigger(t),this.isShown&&!t.isDefaultPrevented()&&(this.isShown=!1,this.escape(),e(document).off("focusin.bs.modal"),this.$element.removeClass("in").attr("aria-hidden",!0).off("click.dismiss.modal"),e.support.transition&&this.$element.hasClass("fade")?this.$element.one(e.support.transition.end,e.proxy(this.hideModal,this)).emulateTransitionEnd(300):this.hideModal())},t.prototype.enforceFocus=function(){e(document).off("focusin.bs.modal").on("focusin.bs.modal",e.proxy(function(e){this.$element[0]===e.target||this.$element.has(e.target).length||this.$element.focus()},this))},t.prototype.escape=function(){this.isShown&&this.options.keyboard?this.$element.on("keyup.dismiss.bs.modal",e.proxy(function(e){27==e.which&&this.hide()},this)):this.isShown||this.$element.off("keyup.dismiss.bs.modal")},t.prototype.hideModal=function(){var e=this;this.$element.hide(),this.backdrop(function(){e.removeBackdrop(),e.$element.trigger("hidden.bs.modal")})},t.prototype.removeBackdrop=function(){this.$backdrop&&this.$backdrop.remove(),this.$backdrop=null},t.prototype.backdrop=function(t){var n=this.$element.hasClass("fade")?"fade":"";if(this.isShown&&this.options.backdrop){var r=e.support.transition&&n;if(this.$backdrop=e('<div class="modal-backdrop '+n+'" />').appendTo(document.body),this.$element.on("click.dismiss.modal",e.proxy(function(e){e.target===e.currentTarget&&("static"==this.options.backdrop?this.$element[0].focus.call(this.$element[0]):this.hide.call(this))},this)),r&&this.$backdrop[0].offsetWidth,this.$backdrop.addClass("in"),!t)return;r?this.$backdrop.one(e.support.transition.end,t).emulateTransitionEnd(150):t()}else!this.isShown&&this.$backdrop?(this.$backdrop.removeClass("in"),e.support.transition&&this.$element.hasClass("fade")?this.$backdrop.one(e.support.transition.end,t).emulateTransitionEnd(150):t()):t&&t()};var n=e.fn.modal;e.fn.modal=function(n,r){return this.each(function(){var i=e(this),o=i.data("bs.modal"),a=e.extend({},t.DEFAULTS,i.data(),"object"==typeof n&&n);o||i.data("bs.modal",o=new t(this,a)),"string"==typeof n?o[n](r):a.show&&o.show(r)})},e.fn.modal.Constructor=t,e.fn.modal.noConflict=function(){return e.fn.modal=n,this},e(document).on("click.bs.modal.data-api",'[data-toggle="modal"]',function(t){var n=e(this),r=n.attr("href"),i=e(n.attr("data-target")||r&&r.replace(/.*(?=#[^\s]+$)/,"")),o=i.data("modal")?"toggle":e.extend({remote:!/#/.test(r)&&r},i.data(),n.data());t.preventDefault(),i.modal(o,this).one("hide",function(){n.is(":visible")&&n.focus()})}),e(document).on("show.bs.modal",".modal",function(){e(document.body).addClass("modal-open")}).on("hidden.bs.modal",".modal",function(){e(document.body).removeClass("modal-open")})}(jQuery),+function(e){var t=function(e,t){this.type=this.options=this.enabled=this.timeout=this.hoverState=this.$element=null,this.init("tooltip",e,t)};t.DEFAULTS={animation:!0,placement:"top",selector:!1,template:'<div class="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',trigger:"hover focus",title:"",delay:0,html:!1,container:!1},t.prototype.init=function(t,n,r){this.enabled=!0,this.type=t,this.$element=e(n),this.options=this.getOptions(r);for(var i=this.options.trigger.split(" "),o=i.length;o--;){var a=i[o];if("click"==a)this.$element.on("click."+this.type,this.options.selector,e.proxy(this.toggle,this));else if("manual"!=a){var s="hover"==a?"mouseenter":"focus",u="hover"==a?"mouseleave":"blur";this.$element.on(s+"."+this.type,this.options.selector,e.proxy(this.enter,this)),this.$element.on(u+"."+this.type,this.options.selector,e.proxy(this.leave,this))}}this.options.selector?this._options=e.extend({},this.options,{trigger:"manual",selector:""}):this.fixTitle()},t.prototype.getDefaults=function(){return t.DEFAULTS},t.prototype.getOptions=function(t){return t=e.extend({},this.getDefaults(),this.$element.data(),t),t.delay&&"number"==typeof t.delay&&(t.delay={show:t.delay,hide:t.delay}),t},t.prototype.getDelegateOptions=function(){var t={},n=this.getDefaults();return this._options&&e.each(this._options,function(e,r){n[e]!=r&&(t[e]=r)}),t},t.prototype.enter=function(t){var n=t instanceof this.constructor?t:e(t.currentTarget)[this.type](this.getDelegateOptions()).data("bs."+this.type);return clearTimeout(n.timeout),n.hoverState="in",n.options.delay&&n.options.delay.show?void(n.timeout=setTimeout(function(){"in"==n.hoverState&&n.show()},n.options.delay.show)):n.show()},t.prototype.leave=function(t){var n=t instanceof this.constructor?t:e(t.currentTarget)[this.type](this.getDelegateOptions()).data("bs."+this.type);return clearTimeout(n.timeout),n.hoverState="out",n.options.delay&&n.options.delay.hide?void(n.timeout=setTimeout(function(){"out"==n.hoverState&&n.hide()},n.options.delay.hide)):n.hide()},t.prototype.show=function(){var t=e.Event("show.bs."+this.type);if(this.hasContent()&&this.enabled){if(this.$element.trigger(t),t.isDefaultPrevented())return;
var n=this.tip();this.setContent(),this.options.animation&&n.addClass("fade");var r="function"==typeof this.options.placement?this.options.placement.call(this,n[0],this.$element[0]):this.options.placement,i=/\s?auto?\s?/i,o=i.test(r);o&&(r=r.replace(i,"")||"top"),n.detach().css({top:0,left:0,display:"block"}).addClass(r),this.options.container?n.appendTo(this.options.container):n.insertAfter(this.$element);var a=this.getPosition(),s=n[0].offsetWidth,u=n[0].offsetHeight;if(o){var l=this.$element.parent(),c=r,d=document.documentElement.scrollTop||document.body.scrollTop,p="body"==this.options.container?window.innerWidth:l.outerWidth(),f="body"==this.options.container?window.innerHeight:l.outerHeight(),h="body"==this.options.container?0:l.offset().left;r="bottom"==r&&a.top+a.height+u-d>f?"top":"top"==r&&a.top-d-u<0?"bottom":"right"==r&&a.right+s>p?"left":"left"==r&&a.left-s<h?"right":r,n.removeClass(c).addClass(r)}var m=this.getCalculatedOffset(r,a,s,u);this.applyPlacement(m,r),this.$element.trigger("shown.bs."+this.type)}},t.prototype.applyPlacement=function(e,t){var n,r=this.tip(),i=r[0].offsetWidth,o=r[0].offsetHeight,a=parseInt(r.css("margin-top"),10),s=parseInt(r.css("margin-left"),10);isNaN(a)&&(a=0),isNaN(s)&&(s=0),e.top=e.top+a,e.left=e.left+s,r.offset(e).addClass("in");var u=r[0].offsetWidth,l=r[0].offsetHeight;if("top"==t&&l!=o&&(n=!0,e.top=e.top+o-l),/bottom|top/.test(t)){var c=0;e.left<0&&(c=-2*e.left,e.left=0,r.offset(e),u=r[0].offsetWidth,l=r[0].offsetHeight),this.replaceArrow(c-i+u,u,"left")}else this.replaceArrow(l-o,l,"top");n&&r.offset(e)},t.prototype.replaceArrow=function(e,t,n){this.arrow().css(n,e?50*(1-e/t)+"%":"")},t.prototype.setContent=function(){var e=this.tip(),t=this.getTitle();e.find(".tooltip-inner")[this.options.html?"html":"text"](t),e.removeClass("fade in top bottom left right")},t.prototype.hide=function(){function t(){"in"!=n.hoverState&&r.detach()}var n=this,r=this.tip(),i=e.Event("hide.bs."+this.type);return this.$element.trigger(i),i.isDefaultPrevented()?void 0:(r.removeClass("in"),e.support.transition&&this.$tip.hasClass("fade")?r.one(e.support.transition.end,t).emulateTransitionEnd(150):t(),this.$element.trigger("hidden.bs."+this.type),this)},t.prototype.fixTitle=function(){var e=this.$element;(e.attr("title")||"string"!=typeof e.attr("data-original-title"))&&e.attr("data-original-title",e.attr("title")||"").attr("title","")},t.prototype.hasContent=function(){return this.getTitle()},t.prototype.getPosition=function(){var t=this.$element[0];return e.extend({},"function"==typeof t.getBoundingClientRect?t.getBoundingClientRect():{width:t.offsetWidth,height:t.offsetHeight},this.$element.offset())},t.prototype.getCalculatedOffset=function(e,t,n,r){return"bottom"==e?{top:t.top+t.height,left:t.left+t.width/2-n/2}:"top"==e?{top:t.top-r,left:t.left+t.width/2-n/2}:"left"==e?{top:t.top+t.height/2-r/2,left:t.left-n}:{top:t.top+t.height/2-r/2,left:t.left+t.width}},t.prototype.getTitle=function(){var e,t=this.$element,n=this.options;return e=t.attr("data-original-title")||("function"==typeof n.title?n.title.call(t[0]):n.title)},t.prototype.tip=function(){return this.$tip=this.$tip||e(this.options.template)},t.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".tooltip-arrow")},t.prototype.validate=function(){this.$element[0].parentNode||(this.hide(),this.$element=null,this.options=null)},t.prototype.enable=function(){this.enabled=!0},t.prototype.disable=function(){this.enabled=!1},t.prototype.toggleEnabled=function(){this.enabled=!this.enabled},t.prototype.toggle=function(t){var n=t?e(t.currentTarget)[this.type](this.getDelegateOptions()).data("bs."+this.type):this;n.tip().hasClass("in")?n.leave(n):n.enter(n)},t.prototype.destroy=function(){this.hide().$element.off("."+this.type).removeData("bs."+this.type)};var n=e.fn.tooltip;e.fn.tooltip=function(n){return this.each(function(){var r=e(this),i=r.data("bs.tooltip"),o="object"==typeof n&&n;i||r.data("bs.tooltip",i=new t(this,o)),"string"==typeof n&&i[n]()})},e.fn.tooltip.Constructor=t,e.fn.tooltip.noConflict=function(){return e.fn.tooltip=n,this}}(jQuery),+function(e){var t=function(e,t){this.init("popover",e,t)};if(!e.fn.tooltip)throw new Error("Popover requires tooltip.js");t.DEFAULTS=e.extend({},e.fn.tooltip.Constructor.DEFAULTS,{placement:"right",trigger:"click",content:"",template:'<div class="popover"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>'}),t.prototype=e.extend({},e.fn.tooltip.Constructor.prototype),t.prototype.constructor=t,t.prototype.getDefaults=function(){return t.DEFAULTS},t.prototype.setContent=function(){var e=this.tip(),t=this.getTitle(),n=this.getContent();e.find(".popover-title")[this.options.html?"html":"text"](t),e.find(".popover-content")[this.options.html?"html":"text"](n),e.removeClass("fade top bottom left right in"),e.find(".popover-title").html()||e.find(".popover-title").hide()},t.prototype.hasContent=function(){return this.getTitle()||this.getContent()},t.prototype.getContent=function(){var e=this.$element,t=this.options;return e.attr("data-content")||("function"==typeof t.content?t.content.call(e[0]):t.content)},t.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".arrow")},t.prototype.tip=function(){return this.$tip||(this.$tip=e(this.options.template)),this.$tip};var n=e.fn.popover;e.fn.popover=function(n){return this.each(function(){var r=e(this),i=r.data("bs.popover"),o="object"==typeof n&&n;i||r.data("bs.popover",i=new t(this,o)),"string"==typeof n&&i[n]()})},e.fn.popover.Constructor=t,e.fn.popover.noConflict=function(){return e.fn.popover=n,this}}(jQuery),+function(e){var t=function(t){this.element=e(t)};t.prototype.show=function(){var t=this.element,n=t.closest("ul:not(.dropdown-menu)"),r=t.data("target");if(r||(r=t.attr("href"),r=r&&r.replace(/.*(?=#[^\s]*$)/,"")),!t.parent("li").hasClass("active")){var i=n.find(".active:last a")[0],o=e.Event("show.bs.tab",{relatedTarget:i});if(t.trigger(o),!o.isDefaultPrevented()){var a=e(r);this.activate(t.parent("li"),n),this.activate(a,a.parent(),function(){t.trigger({type:"shown.bs.tab",relatedTarget:i})})}}},t.prototype.activate=function(t,n,r){function i(){o.removeClass("active").find("> .dropdown-menu > .active").removeClass("active"),t.addClass("active"),a?(t[0].offsetWidth,t.addClass("in")):t.removeClass("fade"),t.parent(".dropdown-menu")&&t.closest("li.dropdown").addClass("active"),r&&r()}var o=n.find("> .active"),a=r&&e.support.transition&&o.hasClass("fade");a?o.one(e.support.transition.end,i).emulateTransitionEnd(150):i(),o.removeClass("in")};var n=e.fn.tab;e.fn.tab=function(n){return this.each(function(){var r=e(this),i=r.data("bs.tab");i||r.data("bs.tab",i=new t(this)),"string"==typeof n&&i[n]()})},e.fn.tab.Constructor=t,e.fn.tab.noConflict=function(){return e.fn.tab=n,this},e(document).on("click.bs.tab.data-api",'[data-toggle="tab"], [data-toggle="pill"]',function(t){t.preventDefault(),e(this).tab("show")})}(jQuery),+function(e){var t=function(n,r){this.options=e.extend({},t.DEFAULTS,r),this.$window=e(window).on("scroll.bs.affix.data-api",e.proxy(this.checkPosition,this)).on("click.bs.affix.data-api",e.proxy(this.checkPositionWithEventLoop,this)),this.$element=e(n),this.affixed=this.unpin=null,this.checkPosition()};t.RESET="affix affix-top affix-bottom",t.DEFAULTS={offset:0},t.prototype.checkPositionWithEventLoop=function(){setTimeout(e.proxy(this.checkPosition,this),1)},t.prototype.checkPosition=function(){if(this.$element.is(":visible")){var n=e(document).height(),r=this.$window.scrollTop(),i=this.$element.offset(),o=this.options.offset,a=o.top,s=o.bottom;"object"!=typeof o&&(s=a=o),"function"==typeof a&&(a=o.top()),"function"==typeof s&&(s=o.bottom());var u=null!=this.unpin&&r+this.unpin<=i.top?!1:null!=s&&i.top+this.$element.height()>=n-s?"bottom":null!=a&&a>=r?"top":!1;this.affixed!==u&&(this.unpin&&this.$element.css("top",""),this.affixed=u,this.unpin="bottom"==u?i.top-r:null,this.$element.removeClass(t.RESET).addClass("affix"+(u?"-"+u:"")),"bottom"==u&&this.$element.offset({top:document.body.offsetHeight-s-this.$element.height()}))}};var n=e.fn.affix;e.fn.affix=function(n){return this.each(function(){var r=e(this),i=r.data("bs.affix"),o="object"==typeof n&&n;i||r.data("bs.affix",i=new t(this,o)),"string"==typeof n&&i[n]()})},e.fn.affix.Constructor=t,e.fn.affix.noConflict=function(){return e.fn.affix=n,this},e(window).on("load",function(){e('[data-spy="affix"]').each(function(){var t=e(this),n=t.data();n.offset=n.offset||{},n.offsetBottom&&(n.offset.bottom=n.offsetBottom),n.offsetTop&&(n.offset.top=n.offsetTop),t.affix(n)})})}(jQuery),+function(e){var t=function(n,r){this.$element=e(n),this.options=e.extend({},t.DEFAULTS,r),this.transitioning=null,this.options.parent&&(this.$parent=e(this.options.parent)),this.options.toggle&&this.toggle()};t.DEFAULTS={toggle:!0},t.prototype.dimension=function(){var e=this.$element.hasClass("width");return e?"width":"height"},t.prototype.show=function(){if(!this.transitioning&&!this.$element.hasClass("in")){var t=e.Event("show.bs.collapse");if(this.$element.trigger(t),!t.isDefaultPrevented()){var n=this.$parent&&this.$parent.find("> .panel > .in");if(n&&n.length){var r=n.data("bs.collapse");if(r&&r.transitioning)return;n.collapse("hide"),r||n.data("bs.collapse",null)}var i=this.dimension();this.$element.removeClass("collapse").addClass("collapsing")[i](0),this.transitioning=1;var o=function(){this.$element.removeClass("collapsing").addClass("in")[i]("auto"),this.transitioning=0,this.$element.trigger("shown.bs.collapse")};if(!e.support.transition)return o.call(this);var a=e.camelCase(["scroll",i].join("-"));this.$element.one(e.support.transition.end,e.proxy(o,this)).emulateTransitionEnd(350)[i](this.$element[0][a])}}},t.prototype.hide=function(){if(!this.transitioning&&this.$element.hasClass("in")){var t=e.Event("hide.bs.collapse");if(this.$element.trigger(t),!t.isDefaultPrevented()){var n=this.dimension();this.$element[n](this.$element[n]())[0].offsetHeight,this.$element.addClass("collapsing").removeClass("collapse").removeClass("in"),this.transitioning=1;var r=function(){this.transitioning=0,this.$element.trigger("hidden.bs.collapse").removeClass("collapsing").addClass("collapse")};return e.support.transition?void this.$element[n](0).one(e.support.transition.end,e.proxy(r,this)).emulateTransitionEnd(350):r.call(this)}}},t.prototype.toggle=function(){this[this.$element.hasClass("in")?"hide":"show"]()};var n=e.fn.collapse;e.fn.collapse=function(n){return this.each(function(){var r=e(this),i=r.data("bs.collapse"),o=e.extend({},t.DEFAULTS,r.data(),"object"==typeof n&&n);i||r.data("bs.collapse",i=new t(this,o)),"string"==typeof n&&i[n]()})},e.fn.collapse.Constructor=t,e.fn.collapse.noConflict=function(){return e.fn.collapse=n,this},e(document).on("click.bs.collapse.data-api","[data-toggle=collapse]",function(t){var n,r=e(this),i=r.attr("data-target")||t.preventDefault()||(n=r.attr("href"))&&n.replace(/.*(?=#[^\s]+$)/,""),o=e(i),a=o.data("bs.collapse"),s=a?"toggle":r.data(),u=r.attr("data-parent"),l=u&&e(u);a&&a.transitioning||(l&&l.find('[data-toggle=collapse][data-parent="'+u+'"]').not(r).addClass("collapsed"),r[o.hasClass("in")?"addClass":"removeClass"]("collapsed")),o.collapse(s)})}(jQuery),+function(e){function t(){var e=document.createElement("bootstrap"),t={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"};for(var n in t)if(void 0!==e.style[n])return{end:t[n]}}e.fn.emulateTransitionEnd=function(t){var n=!1,r=this;e(this).one(e.support.transition.end,function(){n=!0});var i=function(){n||e(r).trigger(e.support.transition.end)};return setTimeout(i,t),this},e(function(){e.support.transition=t()})}(jQuery),define("bootstrap",function(){}),function(e){"function"==typeof define&&define.amd?define("moment-lang/pl",["moment"],e):"object"==typeof exports?module.exports=e(require("../moment")):e(window.moment)}(function(e){function t(e){return 5>e%10&&e%10>1&&~~(e/10)%10!==1}function n(e,n,r){var i=e+" ";switch(r){case"m":return n?"minuta":"minutę";case"mm":return i+(t(e)?"minuty":"minut");case"h":return n?"godzina":"godzinę";case"hh":return i+(t(e)?"godziny":"godzin");case"MM":return i+(t(e)?"miesiące":"miesięcy");case"yy":return i+(t(e)?"lata":"lat")}}var r="styczeń_luty_marzec_kwiecień_maj_czerwiec_lipiec_sierpień_wrzesień_październik_listopad_grudzień".split("_"),i="stycznia_lutego_marca_kwietnia_maja_czerwca_lipca_sierpnia_września_października_listopada_grudnia".split("_");return e.lang("pl",{months:function(e,t){return/D MMMM/.test(t)?i[e.month()]:r[e.month()]},monthsShort:"sty_lut_mar_kwi_maj_cze_lip_sie_wrz_paź_lis_gru".split("_"),weekdays:"niedziela_poniedziałek_wtorek_środa_czwartek_piątek_sobota".split("_"),weekdaysShort:"nie_pon_wt_śr_czw_pt_sb".split("_"),weekdaysMin:"N_Pn_Wt_Śr_Cz_Pt_So".split("_"),longDateFormat:{LT:"HH:mm",L:"DD.MM.YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY LT",LLLL:"dddd, D MMMM YYYY LT"},calendar:{sameDay:"[Dziś o] LT",nextDay:"[Jutro o] LT",nextWeek:"[W] dddd [o] LT",lastDay:"[Wczoraj o] LT",lastWeek:function(){switch(this.day()){case 0:return"[W zeszłą niedzielę o] LT";case 3:return"[W zeszłą środę o] LT";case 6:return"[W zeszłą sobotę o] LT";default:return"[W zeszły] dddd [o] LT"}},sameElse:"L"},relativeTime:{future:"za %s",past:"%s temu",s:"kilka sekund",m:n,mm:n,h:n,hh:n,d:"1 dzień",dd:"%d dni",M:"miesiąc",MM:n,y:"rok",yy:n},ordinal:"%d.",week:{dow:1,doy:4}})}),define("app/nls/core",["app/nls/locale/en"],function(e){var t={locale:{}};t.locale.en=e;var n=function(e){if(!e)throw new Error("MessageFormat: No data passed to function.")},r=function(e,t){return n(e),e[t]},i=function(e,t,r){return n(e),e[t]in r?r[e[t]]:r.other};return{root:{TITLE:function(){return"Wannabe MES"},"MSG:LOADING":function(){return"Loading..."},"MSG:LOADING_FAILURE":function(){return"Loading failed :("},"MSG:LOG_OUT:FAILURE":function(){return"Logging out failed :("},"MSG:LOG_OUT:SUCCESS":function(){return"You are now logged out!"},"PAGE_ACTION:filter":function(){return"Filter"},"LIST:COLUMN:actions":function(){return"Actions"},"LIST:NO_DATA":function(){return"No data."},"LIST:NO_DATA:cell":function(){return"no data"},"LIST:ACTION:viewDetails":function(){return"View details"},"LIST:ACTION:edit":function(){return"Edit"},"LIST:ACTION:delete":function(){return"Delete"},"LIST:ACTION:print":function(){return"Print"},"BREADCRUMBS:edit":function(){return"Editing"},"BREADCRUMBS:delete":function(){return"Deleting"},"BREADCRUMBS:error":function(e){return"Error "+r(e,"code")+": "+i(e,"codeStr",{e401:"unauthorized access",e404:"not found",other:"bad request"})},"ERROR:400":function(){return"The request cannot be fulfilled due to bad syntax :("},"ERROR:401":function(){return"Unfortunately, you do not have the right privileges to perform the requested action :("},"ERROR:404":function(){return"The requested resource could not be found :("},"PAGINATION:FIRST_PAGE":function(){return"First page"},"PAGINATION:PREV_PAGE":function(){return"Previous page"},"PAGINATION:NEXT_PAGE":function(){return"Next page"},"PAGINATION:LAST_PAGE":function(){return"Last page"},"LOG_IN_FORM:DIALOG_TITLE":function(){return"Log in form"},"LOG_IN_FORM:LABEL:LOGIN":function(){return"Login"},"LOG_IN_FORM:LABEL:PASSWORD":function(){return"Password"},"LOG_IN_FORM:LABEL:SUBMIT":function(){return"Log in"},"BOOL:true":function(){return"Yes"},"BOOL:false":function(){return"No"},"BOOL:null":function(){return"N/A"},"#":function(){return"No."},GUEST_USER_NAME:function(){return"Guest"},"NAVBAR:TOGGLE":function(){return"Show menu"},"NAVBAR:DASHBOARD":function(){return"Dashboard"},"NAVBAR:EVENTS":function(){return"Events"},"NAVBAR:ORDERS":function(){return"Orders"},"NAVBAR:MECH_ORDERS":function(){return"Mechanical orders"},"NAVBAR:OTHER_ORDERS":function(){return"Production orders"},"NAVBAR:EMPTY_ORDERS":function(){return"Empty orders"},"NAVBAR:LINES":function(){return"Production lines"},"NAVBAR:USERS":function(){return"Users"},"NAVBAR:MY_ACCOUNT":function(){return"My account"},"NAVBAR:UI_LOCALE":function(){return"UI locale"},"NAVBAR:LOCALE_PL":function(){return"In Polish"},"NAVBAR:LOCALE_US":function(){return"In English"},"NAVBAR:LOG_IN":function(){return"Log in"},"NAVBAR:LOG_OUT":function(){return"Log out"},"NAVBAR:DICTIONARIES":function(){return"Dictionaries"},"NAVBAR:ORDER_STATUSES":function(){return"Order statuses"},"NAVBAR:DOWNTIME_REASONS":function(){return"Downtime reasons"},"NAVBAR:LOSS_REASONS":function(){return"Loss reasons"},"NAVBAR:AORS":function(){return"Areas of responsibility"},"NAVBAR:WORK_CENTERS":function(){return"WorkCenters"},"NAVBAR:COMPANIES":function(){return"Companies"},"NAVBAR:DIVISIONS":function(){return"Divisions"},"NAVBAR:SUBDIVISIONS":function(){return"Subdivisions"},"NAVBAR:MRP_CONTROLLERS":function(){return"MRP Controllers"},"NAVBAR:PROD_FUNCTIONS":function(){return"Production functions"},"NAVBAR:PROD_FLOWS":function(){return"Production flows"},"NAVBAR:PROD_TASKS":function(){return"Production tasks"},"NAVBAR:PROD_LINES":function(){return"Production lines"},"NAVBAR:HOURLY_PLANS":function(){return"Hourly plans"},"NAVBAR:FTE":function(){return"FTE"},"NAVBAR:FTE:MASTER":function(){return"Production"},"NAVBAR:FTE:MASTER:LIST":function(){return"Entries"},"NAVBAR:FTE:MASTER:CURRENT":function(){return"Allocation"},"NAVBAR:FTE:LEADER":function(){return"Warehouse"},"NAVBAR:FTE:LEADER:LIST":function(){return"Entries"},"NAVBAR:FTE:LEADER:CURRENT":function(){return"Allocation"},"NAVBAR:VIS":function(){return"Visualization"},"NAVBAR:VIS:STRUCTURE":function(){return"Org Unit structure"},"NAVBAR:PRESS_WORKSHEETS":function(){return"Worksheets"},"NAVBAR:REPORTS":function(){return"Reports"},"NAVBAR:REPORTS:1":function(){return"PROD, EFF, Downtime"},"NAVBAR:REPORTS:2":function(){return"CLIP"},"NAVBAR:REPORTS:3":function(){return"OEE"},"NAVBAR:REPORTS:4":function(){return"Operators"},"NAVBAR:PROD":function(){return"Production"},"NAVBAR:PROD:LOG_ENTRIES":function(){return"Operation log"},"NAVBAR:PROD:SHIFTS":function(){return"Shifts"},"NAVBAR:PROD:SHIFT_ORDERS":function(){return"Orders"},"NAVBAR:PROD:DOWNTIMES":function(){return"Downtimes"},"NAVBAR:XICONF":function(){return"Walkner Xiconf"},"NAVBAR:XICONF:RESULTS":function(){return"Programming results"},"ACTION_FORM:BUTTON":function(){return"Perform action"},"ACTION_FORM:BUTTON:delete":function(){return"Delete"},"ACTION_FORM:BUTTON:cancel":function(){return"Cancel"},"ACTION_FORM:MESSAGE":function(){return"Are you sure you want to perform the requested action?"},"ACTION_FORM:MESSAGE:failure":function(){return"Action failed :("},"ORG_UNIT:division":function(){return"Division"},"ORG_UNIT:subdivision":function(){return"Subdivision"},"ORG_UNIT:mrpController":function(){return"MRP Controller"},"ORG_UNIT:prodFlow":function(){return"Production flow"},"ORG_UNIT:workCenter":function(){return"WorkCenter"},"ORG_UNIT:prodLine":function(){return"Production line"},"SHIFT:1":function(){return"I"},"SHIFT:2":function(){return"II"},"SHIFT:3":function(){return"III"},"SHIFT:ANY":function(){return"Any"},"highcharts:contextButtonTitle":function(){return"Chart's context menu"},"highcharts:downloadJPEG":function(){return"Save as JPEG"},"highcharts:downloadPDF":function(){return"Save as PDF"},"highcharts:downloadPNG":function(){return"Save as PNG"},"highcharts:downloadSVG":function(){return"Save as SVG"},"highcharts:printChart":function(){return"Print the chart"},"highcharts:decimalPoint":function(){return"."},"highcharts:thousandsSep":function(){return","},"highcharts:noData":function(){return"No data :("},"highcharts:resetZoom":function(){return"1:1"},"highcharts:resetZoomTitle":function(){return"Reset the zoom level to 1:1"},"highcharts:loading":function(){return"Loading..."},"highcharts:months":function(){return"January_February_March_April_May_June_July_August_September_October_November_December"},"highcharts:shortMonths":function(){return"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec"},"highcharts:weekdays":function(){return"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday"},"dataTables:emptyTable":function(){return"No data."},"dataTables:loadingRecords":function(){return"Loading..."},"dataTables:loadingFailed":function(){return"Loading failed :("},"feedback:button:text":function(){return"Feedback"},"feedback:button:tooltip":function(){return"Report bugs, notes, opinions or ideas!"}},pl:!0}}),define("app/nls/pl/core",["app/nls/locale/pl"],function(e){var t={locale:{}};t.locale.pl=e;var n=function(e){if(!e)throw new Error("MessageFormat: No data passed to function.")},r=function(e,t){return n(e),e[t]},i=function(e,t,r){return n(e),e[t]in r?r[e[t]]:r.other};return{TITLE:function(){return"Wannabe MES"},"MSG:LOADING":function(){return"Ładowanie..."},"MSG:LOADING_FAILURE":function(){return"Ładowanie nie powiodło się :("},"MSG:LOG_OUT:FAILURE":function(){return"Wylogowanie nie powiodło się :("},"MSG:LOG_OUT:SUCCESS":function(){return"Zostałeś wylogowany!"},"PAGE_ACTION:filter":function(){return"Filtruj"},"LIST:COLUMN:actions":function(){return"Akcje"},"LIST:NO_DATA":function(){return"Brak danych."},"LIST:NO_DATA:cell":function(){return"brak danych"},"LIST:ACTION:viewDetails":function(){return"Pokaż szczegóły"},"LIST:ACTION:edit":function(){return"Edytuj"},"LIST:ACTION:delete":function(){return"Usuń"},"LIST:ACTION:print":function(){return"Drukuj"},"BREADCRUMBS:edit":function(){return"Edycja"},"BREADCRUMBS:delete":function(){return"Usuwanie"},"BREADCRUMBS:error":function(e){return"Błąd "+r(e,"code")+": "+i(e,"codeStr",{e401:"nieautoryzowany dostęp",e404:"nie znaleziono",other:"nieprawidłowe zapytanie"})},"ERROR:400":function(){return"Żądanie nie może być obsłużone z powodu błędnej składni zapytania :("},"ERROR:401":function(){return"Niestety, ale nie masz wystarczających uprawnień do wykonania żądanej akcji :("},"ERROR:404":function(){return"Wybrana strona nie istnieje :("},"PAGINATION:FIRST_PAGE":function(){return"Pierwsza strona"},"PAGINATION:PREV_PAGE":function(){return"Poprzednia strona"},"PAGINATION:NEXT_PAGE":function(){return"Następna strona"},"PAGINATION:LAST_PAGE":function(){return"Ostatnia strona"},"LOG_IN_FORM:DIALOG_TITLE":function(){return"Logowanie do systemu"},"LOG_IN_FORM:LABEL:LOGIN":function(){return"Login"},"LOG_IN_FORM:LABEL:PASSWORD":function(){return"Hasło"},"LOG_IN_FORM:LABEL:SUBMIT":function(){return"Zaloguj się"},"BOOL:true":function(){return"Tak"},"BOOL:false":function(){return"Nie"},"BOOL:null":function(){return"Nie dotyczy"},"#":function(){return"Lp."},GUEST_USER_NAME:function(){return"Gość"},"NAVBAR:TOGGLE":function(){return"Pokaż menu"},"NAVBAR:DASHBOARD":function(){return"Dashboard"},"NAVBAR:EVENTS":function(){return"Zdarzenia"},"NAVBAR:ORDERS":function(){return"Zlecenia"},"NAVBAR:MECH_ORDERS":function(){return"Zlecenia działu mechanicznego"},"NAVBAR:OTHER_ORDERS":function(){return"Zlecenia reszty działów"},"NAVBAR:EMPTY_ORDERS":function(){return"Puste zlecenia"},"NAVBAR:LINES":function(){return"Linie produkcyjne"},"NAVBAR:USERS":function(){return"Użytkownicy"},"NAVBAR:MY_ACCOUNT":function(){return"Moje konto"},"NAVBAR:UI_LOCALE":function(){return"Lokalizacja UI"},"NAVBAR:LOCALE_PL":function(){return"Po polsku"},"NAVBAR:LOCALE_US":function(){return"Po angielsku"},"NAVBAR:LOG_IN":function(){return"Zaloguj się"},"NAVBAR:LOG_OUT":function(){return"Wyloguj się"},"NAVBAR:DICTIONARIES":function(){return"Słowniki"},"NAVBAR:ORDER_STATUSES":function(){return"Statusy zleceń"},"NAVBAR:DOWNTIME_REASONS":function(){return"Powody przestojów"},"NAVBAR:LOSS_REASONS":function(){return"Powody strat materiałowych"},"NAVBAR:AORS":function(){return"Obszary odpowiedzialności"},"NAVBAR:WORK_CENTERS":function(){return"WorkCentra"},"NAVBAR:COMPANIES":function(){return"Firmy"},"NAVBAR:DIVISIONS":function(){return"Wydziały"},"NAVBAR:SUBDIVISIONS":function(){return"Działy"},"NAVBAR:MRP_CONTROLLERS":function(){return"Kontrolery MRP"},"NAVBAR:PROD_FUNCTIONS":function(){return"Funkcje na produkcji"},"NAVBAR:PROD_FLOWS":function(){return"Przepływy"},"NAVBAR:PROD_TASKS":function(){return"Zadania produkcyjne"},"NAVBAR:PROD_LINES":function(){return"Linie produkcyjne"},"NAVBAR:HOURLY_PLANS":function(){return"Plany godzinowe"},"NAVBAR:FTE":function(){return"FTE"},"NAVBAR:FTE:MASTER":function(){return"Produkcja"},"NAVBAR:FTE:MASTER:LIST":function(){return"Lista wpisów"},"NAVBAR:FTE:MASTER:CURRENT":function(){return"Przydzielanie zasobów"},"NAVBAR:FTE:LEADER":function(){return"Magazyn"},"NAVBAR:FTE:LEADER:LIST":function(){return"Lista wpisów"},"NAVBAR:FTE:LEADER:CURRENT":function(){return"Przydzielanie zasobów"},"NAVBAR:VIS":function(){return"Wizualizacja"},"NAVBAR:VIS:STRUCTURE":function(){return"Struktura organizacyjna"},"NAVBAR:PRESS_WORKSHEETS":function(){return"Karty pracy"},"NAVBAR:REPORTS":function(){return"Raporty"},"NAVBAR:REPORTS:1":function(){return"Wskaźniki"},"NAVBAR:REPORTS:2":function(){return"CLIP"},"NAVBAR:REPORTS:3":function(){return"Wykorzystanie zasobów"},"NAVBAR:REPORTS:4":function(){return"Operatorzy"},"NAVBAR:PROD":function(){return"Produkcja"},"NAVBAR:PROD:LOG_ENTRIES":function(){return"Historia operacji"},"NAVBAR:PROD:SHIFTS":function(){return"Zmiany"},"NAVBAR:PROD:SHIFT_ORDERS":function(){return"Zlecenia"},"NAVBAR:PROD:DOWNTIMES":function(){return"Przestoje"},"NAVBAR:XICONF":function(){return"Walkner Xiconf"},"NAVBAR:XICONF:RESULTS":function(){return"Wyniki programowania"},"ACTION_FORM:BUTTON":function(){return"Wykonaj akcję"},"ACTION_FORM:BUTTON:delete":function(){return"Usuń"},"ACTION_FORM:BUTTON:cancel":function(){return"Anuluj"},"ACTION_FORM:MESSAGE":function(){return"Czy na pewno chcesz wykonać żądaną akcję?"},"ACTION_FORM:MESSAGE:failure":function(){return"Wykonywanie akcji nie powiodło się :("},"ORG_UNIT:division":function(){return"Wydział"},"ORG_UNIT:subdivision":function(){return"Dział"},"ORG_UNIT:mrpController":function(){return"Kontroler MRP"},"ORG_UNIT:prodFlow":function(){return"Przepływ"},"ORG_UNIT:workCenter":function(){return"WorkCenter"},"ORG_UNIT:prodLine":function(){return"Linia montażowa"},"SHIFT:1":function(){return"I"},"SHIFT:2":function(){return"II"},"SHIFT:3":function(){return"III"},"SHIFT:ANY":function(){return"Dowolna"},"highcharts:contextButtonTitle":function(){return"Menu kontekstowe wykresu"},"highcharts:downloadJPEG":function(){return"Zapisz jako JPEG"},"highcharts:downloadPDF":function(){return"Zapisz jako PDF"},"highcharts:downloadPNG":function(){return"Zapisz jako PNG"},"highcharts:downloadSVG":function(){return"Zapisz jako SVG"},"highcharts:printChart":function(){return"Drukuj wykres"},"highcharts:decimalPoint":function(){return","},"highcharts:thousandsSep":function(){return"."},"highcharts:noData":function(){return"Brak danych :("},"highcharts:resetZoom":function(){return"1:1"},"highcharts:resetZoomTitle":function(){return"Zresetuj przybliżenie"},"highcharts:loading":function(){return"Ładowanie..."},"highcharts:months":function(){return"Styczeń_Luty_Marzec_Kwiecień_Maj_Czerwiec_Lipiec_Sierpień_Wrzesień_Październik_Listopad_Grudzień"},"highcharts:shortMonths":function(){return"Sty_Lut_Mar_Kwi_Maj_Cze_Lip_Sie_Wrz_Paź_Lis_Gru"},"highcharts:weekdays":function(){return"Niedziela_Poniedziałek_Wtorek_Środa_Czwartek_Piątek_Sobota"},"dataTables:emptyTable":function(){return"Brak danych."},"dataTables:loadingRecords":function(){return"Ładowanie danych..."},"dataTables:loadingFailed":function(){return"Ładowanie danych nie powiodło się :("},"feedback:button:text":function(){return"Feedback"},"feedback:button:tooltip":function(){return"Zgłoś błędy, uwagi, opinie lub pomysły!"}}}),function(){function e(e,t,n,o,a,s,u,l,c,d,p,f,h,m,g){function y(){var e=c.getCurrentRequest(),n=new m({currentPath:null===e?"/":e.path});return n.on("logIn",function(){d.showDialog(new g,u("core","LOG_IN_FORM:DIALOG_TITLE"))}),n.on("logOut",function(){t.ajax({type:"GET",url:"/logout"}).fail(function(){d.msg.show({type:"error",text:u("core","MSG:LOG_OUT:FAILURE"),time:5e3})})}),n.on("feedback",function(e){require(["app/feedback/Feedback","app/feedback/views/FeedbackFormView","i18n!app/nls/feedback"],function(t,n){var r=new n({done:function(t){e(),t&&(d.closeDialog(),d.msg.show({type:"success",time:3e3,text:u("feedback","form:message:success")}))},model:new t,failureText:u("feedback","form:message:failure")});d.showDialog(r,u("feedback","dialog:title"))})}),n}function v(){null!==w&&(w.destroy(),w=null),s.subscribe("i18n.reloaded",function(e){localStorage.setItem("LOCALE",e.newLocale),d.render()}),s.subscribe("user.reloaded",function(){d.render(),c.dispatch(c.getCurrentRequest().url)}),s.subscribe("user.loggedOut",function(){d.msg.show({type:"success",text:u("core","MSG:LOG_OUT:SUCCESS"),time:2500}),s.publish("router.navigate",{url:"/",trigger:!0})}),e(function(){t("#app-loading").fadeOut(function(){t(this).remove()}),n.history.start({root:"/",hashChange:!0,pushState:!1})})}var w=null;r(n,t),l.connect(),a.lang(i),t.ajaxSetup({dataType:"json",accepts:{json:"application/json",text:"text/plain"},contentType:"application/json"}),o.configure({manage:!0,el:!1,keep:!0}),d.registerLayout("page",function(){return new p({views:{".navbar":y()}})}),d.registerLayout("print",function(){return new f}),d.registerLayout("blank",function(){return new h}),navigator.onLine?(w=s.sandbox(),w.subscribe("socket.connected",function(){w.subscribe("user.reloaded",v)}),w.subscribe("socket.connectFailed",v),s.subscribe("page.titleChanged",function(e){e.unshift(u("core","TITLE")),document.title=e.reverse().join(" < ")})):v()}function t(){require(["domReady","jquery","backbone","backbone.layout","moment","app/broker","app/i18n","app/socket","app/router","app/viewport","app/core/layouts/PageLayout","app/core/layouts/PrintLayout","app/core/layouts/BlankLayout","app/core/views/NavbarView","app/core/views/LogInFormView","app/time","app/routes","app/visibility","app/updater/index","bootstrap","moment-lang/pl","select2-lang/"+i,"i18n!app/nls/core"],e)}function n(){clearTimeout(c),c=null,u.onnoupdate=null,u.oncached=null,u.onerror=null,u.onobsolete=null,u.onupdateready=null,t()}function r(e,t){var n=e.sync;e.sync=function(e,t,r){return r.syncMethod=e,n.call(this,e,t,r)},t.fn.modal.Constructor.prototype.enforceFocus=function(){},t.fn.modal.Constructor.prototype.escape=function(){this.isShown&&this.options.keyboard?this.$element.on("keydown.dismiss.bs.modal",t.proxy(function(e){27===e.which&&this.hide()},this)):this.isShown||this.$element.off("keydown.dismiss.bs.modal")};var r=t(document.body);t.fn.select2.defaults.dropdownContainer=function(e){var t=e.container.closest(".modal-body");if(0===t.length)return r;var n=t.closest(".modal-dialog");return 0===n.length?r:n}}var i=localStorage.getItem("LOCALE")||navigator.language||"pl";"pl"!==i&&(i="en");var o=[],a=null,s=null;if(require.onError=function(e){var t=document.getElementById("app-loading");if(t){t.className="error";var n=t.getElementsByClassName("fa-spin")[0];n&&n.classList.remove("fa-spin")}},require.onResourceLoad=function(e,t){if("i18n"===t.prefix){var n=e.defined[t.id],r=t.id.substr(t.id.lastIndexOf("/")+1);null!==a?a.register(r,n,t.id):o.push([r,n,t.id])}else if("app/i18n"===t.id)a=e.defined[t.id],a.config=e.config.config.i18n,o.forEach(function(e){a.register(e[0],e[1],e[2])}),o=null;else if("select2"===t.id)s=e.defined[t.id],s.lang=function(e){window.jQuery.extend(window.jQuery.fn.select2.defaults,s.lang[e])};else if(/^select2-lang/.test(t.id)){var i=t.id.substr(t.id.lastIndexOf("/")+1);s.lang[i]=e.defined[t.id]}},!navigator.onLine||!document.getElementsByTagName("html")[0].hasAttribute("manifest"))return t();var u=window.applicationCache,l=location.reload.bind(location),c=setTimeout(l,6e4);u.onnoupdate=n,u.oncached=n,u.onerror=n,u.onobsolete=l,u.onupdateready=l}(),define("main",function(){});