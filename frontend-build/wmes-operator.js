if(define("app/data/localStorage",[],function(){"use strict";var e=null,t=null,n=null;function i(i){var a=i.data;window.parent!==window&&window.IS_EMBEDDED&&"localStorage"===a.type&&(a.action?function(e){var t=e.data,i=e.source;switch(t.action){case"read":if(i)return i.postMessage({type:"localStorage",data:n},"*");break;case"setItem":return r(t.key,t.value);case"remoteItem":return r(t.key);case"clear":o()}}(i):a.data&&(n=a.data,0===Object.keys(n).length&&(Object.keys(localStorage).forEach(function(e){n[e]=localStorage[e]}),window.parent.postMessage({type:"localStorage",action:"write",data:n},"*")),t&&(clearTimeout(t),t=null),e&&(e(),e=null)))}function r(e,t){n[e]=t,window.parent.postMessage({type:"localStorage",action:"setItem",key:e,value:t},"*")}function o(){n={},window.parent.postMessage({type:"localStorage",action:"clear"},"*")}return window.addEventListener("message",i),{start:function(r){if(n)return r();if(e){var o=e;e=function(){o(),r()}}else e=r,t=setTimeout(function(){e(),window.removeEventListener("message",i),e=null,t=null},3333),window.parent.postMessage({type:"localStorage",action:"read"},"*")},getItem:function(e){var t=(n||localStorage)[e];return void 0===t?null:t},setItem:function(e,t){localStorage.setItem(e,t),n&&r(e,t)},removeItem:function(e){localStorage.removeItem(e),n&&function(e){delete n[e],window.parent.postMessage({type:"localStorage",action:"removeItem",key:e},"*")}(e)},clear:function(){localStorage.clear(),n&&o()}}}),define("domReady",[],function(){"use strict";var e,t,n,i="undefined"!=typeof window&&window.document,r=!i,o=i?document:null,a=[];function s(){var e=a;r&&e.length&&(a=[],function(e){var t;for(t=0;t<e.length;t+=1)e[t](o)}(e))}function u(){r||(r=!0,n&&clearInterval(n),s())}if(i){if(document.addEventListener)document.addEventListener("DOMContentLoaded",u,!1),window.addEventListener("load",u,!1);else if(window.attachEvent){window.attachEvent("onload",u),t=document.createElement("div");try{e=null===window.frameElement}catch(e){}t.doScroll&&e&&window.external&&(n=setInterval(function(){try{t.doScroll(),u()}catch(e){}},30))}"complete"===document.readyState&&u()}function c(e){return r?e(o):a.push(e),c}return c.version="2.0.1",c.load=function(e,t,n,i){i.isBuild?n(null):c(n)},c}),function(e,t){"object"==typeof module&&"object"==typeof module.exports?module.exports=e.document?t(e,!0):function(e){if(!e.document)throw new Error("jQuery requires a window with a document");return t(e)}:t(e)}("undefined"!=typeof window?window:this,function(e,t){var n=[],i=n.slice,r=n.concat,o=n.push,a=n.indexOf,s={},u=s.toString,c=s.hasOwnProperty,l={},d=e.document,p=function(e,t){return new p.fn.init(e,t)},f=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,h=/^-ms-/,m=/-([\da-z])/gi,g=function(e,t){return t.toUpperCase()};function v(e){var t=e.length,n=p.type(e);return"function"!==n&&!p.isWindow(e)&&(!(1!==e.nodeType||!t)||("array"===n||0===t||"number"==typeof t&&t>0&&t-1 in e))}p.fn=p.prototype={jquery:"2.1.3",constructor:p,selector:"",length:0,toArray:function(){return i.call(this)},get:function(e){return null!=e?e<0?this[e+this.length]:this[e]:i.call(this)},pushStack:function(e){var t=p.merge(this.constructor(),e);return t.prevObject=this,t.context=this.context,t},each:function(e,t){return p.each(this,e,t)},map:function(e){return this.pushStack(p.map(this,function(t,n){return e.call(t,n,t)}))},slice:function(){return this.pushStack(i.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(e){var t=this.length,n=+e+(e<0?t:0);return this.pushStack(n>=0&&n<t?[this[n]]:[])},end:function(){return this.prevObject||this.constructor(null)},push:o,sort:n.sort,splice:n.splice},p.extend=p.fn.extend=function(){var e,t,n,i,r,o,a=arguments[0]||{},s=1,u=arguments.length,c=!1;for("boolean"==typeof a&&(c=a,a=arguments[s]||{},s++),"object"==typeof a||p.isFunction(a)||(a={}),s===u&&(a=this,s--);s<u;s++)if(null!=(e=arguments[s]))for(t in e)n=a[t],a!==(i=e[t])&&(c&&i&&(p.isPlainObject(i)||(r=p.isArray(i)))?(r?(r=!1,o=n&&p.isArray(n)?n:[]):o=n&&p.isPlainObject(n)?n:{},a[t]=p.extend(c,o,i)):void 0!==i&&(a[t]=i));return a},p.extend({expando:"jQuery"+("2.1.3"+Math.random()).replace(/\D/g,""),isReady:!0,error:function(e){throw new Error(e)},noop:function(){},isFunction:function(e){return"function"===p.type(e)},isArray:Array.isArray,isWindow:function(e){return null!=e&&e===e.window},isNumeric:function(e){return!p.isArray(e)&&e-parseFloat(e)+1>=0},isPlainObject:function(e){return"object"===p.type(e)&&!e.nodeType&&!p.isWindow(e)&&!(e.constructor&&!c.call(e.constructor.prototype,"isPrototypeOf"))},isEmptyObject:function(e){var t;for(t in e)return!1;return!0},type:function(e){return null==e?e+"":"object"==typeof e||"function"==typeof e?s[u.call(e)]||"object":typeof e},globalEval:function(e){var t,n=eval;(e=p.trim(e))&&(1===e.indexOf("use strict")?((t=d.createElement("script")).text=e,d.head.appendChild(t).parentNode.removeChild(t)):n(e))},camelCase:function(e){return e.replace(h,"ms-").replace(m,g)},nodeName:function(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()},each:function(e,t,n){var i=0,r=e.length,o=v(e);if(n){if(o)for(;i<r&&!1!==t.apply(e[i],n);i++);else for(i in e)if(!1===t.apply(e[i],n))break}else if(o)for(;i<r&&!1!==t.call(e[i],i,e[i]);i++);else for(i in e)if(!1===t.call(e[i],i,e[i]))break;return e},trim:function(e){return null==e?"":(e+"").replace(f,"")},makeArray:function(e,t){var n=t||[];return null!=e&&(v(Object(e))?p.merge(n,"string"==typeof e?[e]:e):o.call(n,e)),n},inArray:function(e,t,n){return null==t?-1:a.call(t,e,n)},merge:function(e,t){for(var n=+t.length,i=0,r=e.length;i<n;i++)e[r++]=t[i];return e.length=r,e},grep:function(e,t,n){for(var i=[],r=0,o=e.length,a=!n;r<o;r++)!t(e[r],r)!==a&&i.push(e[r]);return i},map:function(e,t,n){var i,o=0,a=e.length,s=[];if(v(e))for(;o<a;o++)null!=(i=t(e[o],o,n))&&s.push(i);else for(o in e)null!=(i=t(e[o],o,n))&&s.push(i);return r.apply([],s)},guid:1,proxy:function(e,t){var n,r,o;if("string"==typeof t&&(n=e[t],t=e,e=n),p.isFunction(e))return r=i.call(arguments,2),(o=function(){return e.apply(t||this,r.concat(i.call(arguments)))}).guid=e.guid=e.guid||p.guid++,o},now:Date.now,support:l}),p.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(e,t){s["[object "+t+"]"]=t.toLowerCase()});var y=function(e){var t,n,i,r,o,a,s,u,c,l,d,p,f,h,m,g,v,y,_,b="sizzle"+1*new Date,w=e.document,A=0,k=0,E=ae(),T=ae(),S=ae(),C=function(e,t){return e===t&&(d=!0),0},R=1<<31,P={}.hasOwnProperty,N=[],O=N.pop,D=N.push,I=N.push,z=N.slice,x=function(e,t){for(var n=0,i=e.length;n<i;n++)if(e[n]===t)return n;return-1},L="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",M="[\\x20\\t\\r\\n\\f]",F="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",V=F.replace("w","w#"),j="\\["+M+"*("+F+")(?:"+M+"*([*^$|!~]?=)"+M+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+V+"))|)"+M+"*\\]",B=":("+F+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+j+")*)|.*)\\)|)",q=new RegExp(M+"+","g"),U=new RegExp("^"+M+"+|((?:^|[^\\\\])(?:\\\\.)*)"+M+"+$","g"),H=new RegExp("^"+M+"*,"+M+"*"),G=new RegExp("^"+M+"*([>+~]|"+M+")"+M+"*"),W=new RegExp("="+M+"*([^\\]'\"]*?)"+M+"*\\]","g"),$=new RegExp(B),Y=new RegExp("^"+V+"$"),Q={ID:new RegExp("^#("+F+")"),CLASS:new RegExp("^\\.("+F+")"),TAG:new RegExp("^("+F.replace("w","w*")+")"),ATTR:new RegExp("^"+j),PSEUDO:new RegExp("^"+B),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+M+"*(even|odd|(([+-]|)(\\d*)n|)"+M+"*(?:([+-]|)"+M+"*(\\d+)|))"+M+"*\\)|)","i"),bool:new RegExp("^(?:"+L+")$","i"),needsContext:new RegExp("^"+M+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+M+"*((?:-\\d)?\\d*)"+M+"*\\)|)(?=[^-]|$)","i")},K=/^(?:input|select|textarea|button)$/i,Z=/^h\d$/i,J=/^[^{]+\{\s*\[native \w/,X=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,ee=/[+~]/,te=/'|\\/g,ne=new RegExp("\\\\([\\da-f]{1,6}"+M+"?|("+M+")|.)","ig"),ie=function(e,t,n){var i="0x"+t-65536;return i!=i||n?t:i<0?String.fromCharCode(i+65536):String.fromCharCode(i>>10|55296,1023&i|56320)},re=function(){p()};try{I.apply(N=z.call(w.childNodes),w.childNodes),N[w.childNodes.length].nodeType}catch(e){I={apply:N.length?function(e,t){D.apply(e,z.call(t))}:function(e,t){for(var n=e.length,i=0;e[n++]=t[i++];);e.length=n-1}}}function oe(e,t,i,r){var o,s,c,l,d,h,v,y,A,k;if((t?t.ownerDocument||t:w)!==f&&p(t),t=t||f,i=i||[],l=t.nodeType,"string"!=typeof e||!e||1!==l&&9!==l&&11!==l)return i;if(!r&&m){if(11!==l&&(o=X.exec(e)))if(c=o[1]){if(9===l){if(!(s=t.getElementById(c))||!s.parentNode)return i;if(s.id===c)return i.push(s),i}else if(t.ownerDocument&&(s=t.ownerDocument.getElementById(c))&&_(t,s)&&s.id===c)return i.push(s),i}else{if(o[2])return I.apply(i,t.getElementsByTagName(e)),i;if((c=o[3])&&n.getElementsByClassName)return I.apply(i,t.getElementsByClassName(c)),i}if(n.qsa&&(!g||!g.test(e))){if(y=v=b,A=t,k=1!==l&&e,1===l&&"object"!==t.nodeName.toLowerCase()){for(h=a(e),(v=t.getAttribute("id"))?y=v.replace(te,"\\$&"):t.setAttribute("id",y),y="[id='"+y+"'] ",d=h.length;d--;)h[d]=y+ge(h[d]);A=ee.test(e)&&he(t.parentNode)||t,k=h.join(",")}if(k)try{return I.apply(i,A.querySelectorAll(k)),i}catch(e){}finally{v||t.removeAttribute("id")}}}return u(e.replace(U,"$1"),t,i,r)}function ae(){var e=[];return function t(n,r){return e.push(n+" ")>i.cacheLength&&delete t[e.shift()],t[n+" "]=r}}function se(e){return e[b]=!0,e}function ue(e){var t=f.createElement("div");try{return!!e(t)}catch(e){return!1}finally{t.parentNode&&t.parentNode.removeChild(t),t=null}}function ce(e,t){for(var n=e.split("|"),r=e.length;r--;)i.attrHandle[n[r]]=t}function le(e,t){var n=t&&e,i=n&&1===e.nodeType&&1===t.nodeType&&(~t.sourceIndex||R)-(~e.sourceIndex||R);if(i)return i;if(n)for(;n=n.nextSibling;)if(n===t)return-1;return e?1:-1}function de(e){return function(t){return"input"===t.nodeName.toLowerCase()&&t.type===e}}function pe(e){return function(t){var n=t.nodeName.toLowerCase();return("input"===n||"button"===n)&&t.type===e}}function fe(e){return se(function(t){return t=+t,se(function(n,i){for(var r,o=e([],n.length,t),a=o.length;a--;)n[r=o[a]]&&(n[r]=!(i[r]=n[r]))})})}function he(e){return e&&void 0!==e.getElementsByTagName&&e}for(t in n=oe.support={},o=oe.isXML=function(e){var t=e&&(e.ownerDocument||e).documentElement;return!!t&&"HTML"!==t.nodeName},p=oe.setDocument=function(e){var t,r,a=e?e.ownerDocument||e:w;return a!==f&&9===a.nodeType&&a.documentElement?(f=a,h=a.documentElement,(r=a.defaultView)&&r!==r.top&&(r.addEventListener?r.addEventListener("unload",re,!1):r.attachEvent&&r.attachEvent("onunload",re)),m=!o(a),n.attributes=ue(function(e){return e.className="i",!e.getAttribute("className")}),n.getElementsByTagName=ue(function(e){return e.appendChild(a.createComment("")),!e.getElementsByTagName("*").length}),n.getElementsByClassName=J.test(a.getElementsByClassName),n.getById=ue(function(e){return h.appendChild(e).id=b,!a.getElementsByName||!a.getElementsByName(b).length}),n.getById?(i.find.ID=function(e,t){if(void 0!==t.getElementById&&m){var n=t.getElementById(e);return n&&n.parentNode?[n]:[]}},i.filter.ID=function(e){var t=e.replace(ne,ie);return function(e){return e.getAttribute("id")===t}}):(delete i.find.ID,i.filter.ID=function(e){var t=e.replace(ne,ie);return function(e){var n=void 0!==e.getAttributeNode&&e.getAttributeNode("id");return n&&n.value===t}}),i.find.TAG=n.getElementsByTagName?function(e,t){return void 0!==t.getElementsByTagName?t.getElementsByTagName(e):n.qsa?t.querySelectorAll(e):void 0}:function(e,t){var n,i=[],r=0,o=t.getElementsByTagName(e);if("*"===e){for(;n=o[r++];)1===n.nodeType&&i.push(n);return i}return o},i.find.CLASS=n.getElementsByClassName&&function(e,t){if(m)return t.getElementsByClassName(e)},v=[],g=[],(n.qsa=J.test(a.querySelectorAll))&&(ue(function(e){h.appendChild(e).innerHTML="<a id='"+b+"'></a><select id='"+b+"-\f]' msallowcapture=''><option selected=''></option></select>",e.querySelectorAll("[msallowcapture^='']").length&&g.push("[*^$]="+M+"*(?:''|\"\")"),e.querySelectorAll("[selected]").length||g.push("\\["+M+"*(?:value|"+L+")"),e.querySelectorAll("[id~="+b+"-]").length||g.push("~="),e.querySelectorAll(":checked").length||g.push(":checked"),e.querySelectorAll("a#"+b+"+*").length||g.push(".#.+[+~]")}),ue(function(e){var t=a.createElement("input");t.setAttribute("type","hidden"),e.appendChild(t).setAttribute("name","D"),e.querySelectorAll("[name=d]").length&&g.push("name"+M+"*[*^$|!~]?="),e.querySelectorAll(":enabled").length||g.push(":enabled",":disabled"),e.querySelectorAll("*,:x"),g.push(",.*:")})),(n.matchesSelector=J.test(y=h.matches||h.webkitMatchesSelector||h.mozMatchesSelector||h.oMatchesSelector||h.msMatchesSelector))&&ue(function(e){n.disconnectedMatch=y.call(e,"div"),y.call(e,"[s!='']:x"),v.push("!=",B)}),g=g.length&&new RegExp(g.join("|")),v=v.length&&new RegExp(v.join("|")),t=J.test(h.compareDocumentPosition),_=t||J.test(h.contains)?function(e,t){var n=9===e.nodeType?e.documentElement:e,i=t&&t.parentNode;return e===i||!(!i||1!==i.nodeType||!(n.contains?n.contains(i):e.compareDocumentPosition&&16&e.compareDocumentPosition(i)))}:function(e,t){if(t)for(;t=t.parentNode;)if(t===e)return!0;return!1},C=t?function(e,t){if(e===t)return d=!0,0;var i=!e.compareDocumentPosition-!t.compareDocumentPosition;return i||(1&(i=(e.ownerDocument||e)===(t.ownerDocument||t)?e.compareDocumentPosition(t):1)||!n.sortDetached&&t.compareDocumentPosition(e)===i?e===a||e.ownerDocument===w&&_(w,e)?-1:t===a||t.ownerDocument===w&&_(w,t)?1:l?x(l,e)-x(l,t):0:4&i?-1:1)}:function(e,t){if(e===t)return d=!0,0;var n,i=0,r=e.parentNode,o=t.parentNode,s=[e],u=[t];if(!r||!o)return e===a?-1:t===a?1:r?-1:o?1:l?x(l,e)-x(l,t):0;if(r===o)return le(e,t);for(n=e;n=n.parentNode;)s.unshift(n);for(n=t;n=n.parentNode;)u.unshift(n);for(;s[i]===u[i];)i++;return i?le(s[i],u[i]):s[i]===w?-1:u[i]===w?1:0},a):f},oe.matches=function(e,t){return oe(e,null,null,t)},oe.matchesSelector=function(e,t){if((e.ownerDocument||e)!==f&&p(e),t=t.replace(W,"='$1']"),n.matchesSelector&&m&&(!v||!v.test(t))&&(!g||!g.test(t)))try{var i=y.call(e,t);if(i||n.disconnectedMatch||e.document&&11!==e.document.nodeType)return i}catch(e){}return oe(t,f,null,[e]).length>0},oe.contains=function(e,t){return(e.ownerDocument||e)!==f&&p(e),_(e,t)},oe.attr=function(e,t){(e.ownerDocument||e)!==f&&p(e);var r=i.attrHandle[t.toLowerCase()],o=r&&P.call(i.attrHandle,t.toLowerCase())?r(e,t,!m):void 0;return void 0!==o?o:n.attributes||!m?e.getAttribute(t):(o=e.getAttributeNode(t))&&o.specified?o.value:null},oe.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e)},oe.uniqueSort=function(e){var t,i=[],r=0,o=0;if(d=!n.detectDuplicates,l=!n.sortStable&&e.slice(0),e.sort(C),d){for(;t=e[o++];)t===e[o]&&(r=i.push(o));for(;r--;)e.splice(i[r],1)}return l=null,e},r=oe.getText=function(e){var t,n="",i=0,o=e.nodeType;if(o){if(1===o||9===o||11===o){if("string"==typeof e.textContent)return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)n+=r(e)}else if(3===o||4===o)return e.nodeValue}else for(;t=e[i++];)n+=r(t);return n},(i=oe.selectors={cacheLength:50,createPseudo:se,match:Q,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(ne,ie),e[3]=(e[3]||e[4]||e[5]||"").replace(ne,ie),"~="===e[2]&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),"nth"===e[1].slice(0,3)?(e[3]||oe.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*("even"===e[3]||"odd"===e[3])),e[5]=+(e[7]+e[8]||"odd"===e[3])):e[3]&&oe.error(e[0]),e},PSEUDO:function(e){var t,n=!e[6]&&e[2];return Q.CHILD.test(e[0])?null:(e[3]?e[2]=e[4]||e[5]||"":n&&$.test(n)&&(t=a(n,!0))&&(t=n.indexOf(")",n.length-t)-n.length)&&(e[0]=e[0].slice(0,t),e[2]=n.slice(0,t)),e.slice(0,3))}},filter:{TAG:function(e){var t=e.replace(ne,ie).toLowerCase();return"*"===e?function(){return!0}:function(e){return e.nodeName&&e.nodeName.toLowerCase()===t}},CLASS:function(e){var t=E[e+" "];return t||(t=new RegExp("(^|"+M+")"+e+"("+M+"|$)"))&&E(e,function(e){return t.test("string"==typeof e.className&&e.className||void 0!==e.getAttribute&&e.getAttribute("class")||"")})},ATTR:function(e,t,n){return function(i){var r=oe.attr(i,e);return null==r?"!="===t:!t||(r+="","="===t?r===n:"!="===t?r!==n:"^="===t?n&&0===r.indexOf(n):"*="===t?n&&r.indexOf(n)>-1:"$="===t?n&&r.slice(-n.length)===n:"~="===t?(" "+r.replace(q," ")+" ").indexOf(n)>-1:"|="===t&&(r===n||r.slice(0,n.length+1)===n+"-"))}},CHILD:function(e,t,n,i,r){var o="nth"!==e.slice(0,3),a="last"!==e.slice(-4),s="of-type"===t;return 1===i&&0===r?function(e){return!!e.parentNode}:function(t,n,u){var c,l,d,p,f,h,m=o!==a?"nextSibling":"previousSibling",g=t.parentNode,v=s&&t.nodeName.toLowerCase(),y=!u&&!s;if(g){if(o){for(;m;){for(d=t;d=d[m];)if(s?d.nodeName.toLowerCase()===v:1===d.nodeType)return!1;h=m="only"===e&&!h&&"nextSibling"}return!0}if(h=[a?g.firstChild:g.lastChild],a&&y){for(f=(c=(l=g[b]||(g[b]={}))[e]||[])[0]===A&&c[1],p=c[0]===A&&c[2],d=f&&g.childNodes[f];d=++f&&d&&d[m]||(p=f=0)||h.pop();)if(1===d.nodeType&&++p&&d===t){l[e]=[A,f,p];break}}else if(y&&(c=(t[b]||(t[b]={}))[e])&&c[0]===A)p=c[1];else for(;(d=++f&&d&&d[m]||(p=f=0)||h.pop())&&((s?d.nodeName.toLowerCase()!==v:1!==d.nodeType)||!++p||(y&&((d[b]||(d[b]={}))[e]=[A,p]),d!==t)););return(p-=r)===i||p%i==0&&p/i>=0}}},PSEUDO:function(e,t){var n,r=i.pseudos[e]||i.setFilters[e.toLowerCase()]||oe.error("unsupported pseudo: "+e);return r[b]?r(t):r.length>1?(n=[e,e,"",t],i.setFilters.hasOwnProperty(e.toLowerCase())?se(function(e,n){for(var i,o=r(e,t),a=o.length;a--;)e[i=x(e,o[a])]=!(n[i]=o[a])}):function(e){return r(e,0,n)}):r}},pseudos:{not:se(function(e){var t=[],n=[],i=s(e.replace(U,"$1"));return i[b]?se(function(e,t,n,r){for(var o,a=i(e,null,r,[]),s=e.length;s--;)(o=a[s])&&(e[s]=!(t[s]=o))}):function(e,r,o){return t[0]=e,i(t,null,o,n),t[0]=null,!n.pop()}}),has:se(function(e){return function(t){return oe(e,t).length>0}}),contains:se(function(e){return e=e.replace(ne,ie),function(t){return(t.textContent||t.innerText||r(t)).indexOf(e)>-1}}),lang:se(function(e){return Y.test(e||"")||oe.error("unsupported lang: "+e),e=e.replace(ne,ie).toLowerCase(),function(t){var n;do{if(n=m?t.lang:t.getAttribute("xml:lang")||t.getAttribute("lang"))return(n=n.toLowerCase())===e||0===n.indexOf(e+"-")}while((t=t.parentNode)&&1===t.nodeType);return!1}}),target:function(t){var n=e.location&&e.location.hash;return n&&n.slice(1)===t.id},root:function(e){return e===h},focus:function(e){return e===f.activeElement&&(!f.hasFocus||f.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},enabled:function(e){return!1===e.disabled},disabled:function(e){return!0===e.disabled},checked:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&!!e.checked||"option"===t&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,!0===e.selected},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeType<6)return!1;return!0},parent:function(e){return!i.pseudos.empty(e)},header:function(e){return Z.test(e.nodeName)},input:function(e){return K.test(e.nodeName)},button:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&"button"===e.type||"button"===t},text:function(e){var t;return"input"===e.nodeName.toLowerCase()&&"text"===e.type&&(null==(t=e.getAttribute("type"))||"text"===t.toLowerCase())},first:fe(function(){return[0]}),last:fe(function(e,t){return[t-1]}),eq:fe(function(e,t,n){return[n<0?n+t:n]}),even:fe(function(e,t){for(var n=0;n<t;n+=2)e.push(n);return e}),odd:fe(function(e,t){for(var n=1;n<t;n+=2)e.push(n);return e}),lt:fe(function(e,t,n){for(var i=n<0?n+t:n;--i>=0;)e.push(i);return e}),gt:fe(function(e,t,n){for(var i=n<0?n+t:n;++i<t;)e.push(i);return e})}}).pseudos.nth=i.pseudos.eq,{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})i.pseudos[t]=de(t);for(t in{submit:!0,reset:!0})i.pseudos[t]=pe(t);function me(){}function ge(e){for(var t=0,n=e.length,i="";t<n;t++)i+=e[t].value;return i}function ve(e,t,n){var i=t.dir,r=n&&"parentNode"===i,o=k++;return t.first?function(t,n,o){for(;t=t[i];)if(1===t.nodeType||r)return e(t,n,o)}:function(t,n,a){var s,u,c=[A,o];if(a){for(;t=t[i];)if((1===t.nodeType||r)&&e(t,n,a))return!0}else for(;t=t[i];)if(1===t.nodeType||r){if((s=(u=t[b]||(t[b]={}))[i])&&s[0]===A&&s[1]===o)return c[2]=s[2];if(u[i]=c,c[2]=e(t,n,a))return!0}}}function ye(e){return e.length>1?function(t,n,i){for(var r=e.length;r--;)if(!e[r](t,n,i))return!1;return!0}:e[0]}function _e(e,t,n,i,r){for(var o,a=[],s=0,u=e.length,c=null!=t;s<u;s++)(o=e[s])&&(n&&!n(o,i,r)||(a.push(o),c&&t.push(s)));return a}function be(e,t,n,i,r,o){return i&&!i[b]&&(i=be(i)),r&&!r[b]&&(r=be(r,o)),se(function(o,a,s,u){var c,l,d,p=[],f=[],h=a.length,m=o||function(e,t,n){for(var i=0,r=t.length;i<r;i++)oe(e,t[i],n);return n}(t||"*",s.nodeType?[s]:s,[]),g=!e||!o&&t?m:_e(m,p,e,s,u),v=n?r||(o?e:h||i)?[]:a:g;if(n&&n(g,v,s,u),i)for(c=_e(v,f),i(c,[],s,u),l=c.length;l--;)(d=c[l])&&(v[f[l]]=!(g[f[l]]=d));if(o){if(r||e){if(r){for(c=[],l=v.length;l--;)(d=v[l])&&c.push(g[l]=d);r(null,v=[],c,u)}for(l=v.length;l--;)(d=v[l])&&(c=r?x(o,d):p[l])>-1&&(o[c]=!(a[c]=d))}}else v=_e(v===a?v.splice(h,v.length):v),r?r(null,a,v,u):I.apply(a,v)})}function we(e){for(var t,n,r,o=e.length,a=i.relative[e[0].type],s=a||i.relative[" "],u=a?1:0,l=ve(function(e){return e===t},s,!0),d=ve(function(e){return x(t,e)>-1},s,!0),p=[function(e,n,i){var r=!a&&(i||n!==c)||((t=n).nodeType?l(e,n,i):d(e,n,i));return t=null,r}];u<o;u++)if(n=i.relative[e[u].type])p=[ve(ye(p),n)];else{if((n=i.filter[e[u].type].apply(null,e[u].matches))[b]){for(r=++u;r<o&&!i.relative[e[r].type];r++);return be(u>1&&ye(p),u>1&&ge(e.slice(0,u-1).concat({value:" "===e[u-2].type?"*":""})).replace(U,"$1"),n,u<r&&we(e.slice(u,r)),r<o&&we(e=e.slice(r)),r<o&&ge(e))}p.push(n)}return ye(p)}return me.prototype=i.filters=i.pseudos,i.setFilters=new me,a=oe.tokenize=function(e,t){var n,r,o,a,s,u,c,l=T[e+" "];if(l)return t?0:l.slice(0);for(s=e,u=[],c=i.preFilter;s;){for(a in n&&!(r=H.exec(s))||(r&&(s=s.slice(r[0].length)||s),u.push(o=[])),n=!1,(r=G.exec(s))&&(n=r.shift(),o.push({value:n,type:r[0].replace(U," ")}),s=s.slice(n.length)),i.filter)!(r=Q[a].exec(s))||c[a]&&!(r=c[a](r))||(n=r.shift(),o.push({value:n,type:a,matches:r}),s=s.slice(n.length));if(!n)break}return t?s.length:s?oe.error(e):T(e,u).slice(0)},s=oe.compile=function(e,t){var n,r=[],o=[],s=S[e+" "];if(!s){for(t||(t=a(e)),n=t.length;n--;)(s=we(t[n]))[b]?r.push(s):o.push(s);(s=S(e,function(e,t){var n=t.length>0,r=e.length>0,o=function(o,a,s,u,l){var d,p,h,m=0,g="0",v=o&&[],y=[],_=c,b=o||r&&i.find.TAG("*",l),w=A+=null==_?1:Math.random()||.1,k=b.length;for(l&&(c=a!==f&&a);g!==k&&null!=(d=b[g]);g++){if(r&&d){for(p=0;h=e[p++];)if(h(d,a,s)){u.push(d);break}l&&(A=w)}n&&((d=!h&&d)&&m--,o&&v.push(d))}if(m+=g,n&&g!==m){for(p=0;h=t[p++];)h(v,y,a,s);if(o){if(m>0)for(;g--;)v[g]||y[g]||(y[g]=O.call(u));y=_e(y)}I.apply(u,y),l&&!o&&y.length>0&&m+t.length>1&&oe.uniqueSort(u)}return l&&(A=w,c=_),v};return n?se(o):o}(o,r))).selector=e}return s},u=oe.select=function(e,t,r,o){var u,c,l,d,p,f="function"==typeof e&&e,h=!o&&a(e=f.selector||e);if(r=r||[],1===h.length){if((c=h[0]=h[0].slice(0)).length>2&&"ID"===(l=c[0]).type&&n.getById&&9===t.nodeType&&m&&i.relative[c[1].type]){if(!(t=(i.find.ID(l.matches[0].replace(ne,ie),t)||[])[0]))return r;f&&(t=t.parentNode),e=e.slice(c.shift().value.length)}for(u=Q.needsContext.test(e)?0:c.length;u--&&(l=c[u],!i.relative[d=l.type]);)if((p=i.find[d])&&(o=p(l.matches[0].replace(ne,ie),ee.test(c[0].type)&&he(t.parentNode)||t))){if(c.splice(u,1),!(e=o.length&&ge(c)))return I.apply(r,o),r;break}}return(f||s(e,h))(o,t,!m,r,ee.test(e)&&he(t.parentNode)||t),r},n.sortStable=b.split("").sort(C).join("")===b,n.detectDuplicates=!!d,p(),n.sortDetached=ue(function(e){return 1&e.compareDocumentPosition(f.createElement("div"))}),ue(function(e){return e.innerHTML="<a href='#'></a>","#"===e.firstChild.getAttribute("href")})||ce("type|href|height|width",function(e,t,n){if(!n)return e.getAttribute(t,"type"===t.toLowerCase()?1:2)}),n.attributes&&ue(function(e){return e.innerHTML="<input/>",e.firstChild.setAttribute("value",""),""===e.firstChild.getAttribute("value")})||ce("value",function(e,t,n){if(!n&&"input"===e.nodeName.toLowerCase())return e.defaultValue}),ue(function(e){return null==e.getAttribute("disabled")})||ce(L,function(e,t,n){var i;if(!n)return!0===e[t]?t.toLowerCase():(i=e.getAttributeNode(t))&&i.specified?i.value:null}),oe}(e);p.find=y,p.expr=y.selectors,p.expr[":"]=p.expr.pseudos,p.unique=y.uniqueSort,p.text=y.getText,p.isXMLDoc=y.isXML,p.contains=y.contains;var _=p.expr.match.needsContext,b=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,w=/^.[^:#\[\.,]*$/;function A(e,t,n){if(p.isFunction(t))return p.grep(e,function(e,i){return!!t.call(e,i,e)!==n});if(t.nodeType)return p.grep(e,function(e){return e===t!==n});if("string"==typeof t){if(w.test(t))return p.filter(t,e,n);t=p.filter(t,e)}return p.grep(e,function(e){return a.call(t,e)>=0!==n})}p.filter=function(e,t,n){var i=t[0];return n&&(e=":not("+e+")"),1===t.length&&1===i.nodeType?p.find.matchesSelector(i,e)?[i]:[]:p.find.matches(e,p.grep(t,function(e){return 1===e.nodeType}))},p.fn.extend({find:function(e){var t,n=this.length,i=[],r=this;if("string"!=typeof e)return this.pushStack(p(e).filter(function(){for(t=0;t<n;t++)if(p.contains(r[t],this))return!0}));for(t=0;t<n;t++)p.find(e,r[t],i);return(i=this.pushStack(n>1?p.unique(i):i)).selector=this.selector?this.selector+" "+e:e,i},filter:function(e){return this.pushStack(A(this,e||[],!1))},not:function(e){return this.pushStack(A(this,e||[],!0))},is:function(e){return!!A(this,"string"==typeof e&&_.test(e)?p(e):e||[],!1).length}});var k,E=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/;(p.fn.init=function(e,t){var n,i;if(!e)return this;if("string"==typeof e){if(!(n="<"===e[0]&&">"===e[e.length-1]&&e.length>=3?[null,e,null]:E.exec(e))||!n[1]&&t)return!t||t.jquery?(t||k).find(e):this.constructor(t).find(e);if(n[1]){if(t=t instanceof p?t[0]:t,p.merge(this,p.parseHTML(n[1],t&&t.nodeType?t.ownerDocument||t:d,!0)),b.test(n[1])&&p.isPlainObject(t))for(n in t)p.isFunction(this[n])?this[n](t[n]):this.attr(n,t[n]);return this}return(i=d.getElementById(n[2]))&&i.parentNode&&(this.length=1,this[0]=i),this.context=d,this.selector=e,this}return e.nodeType?(this.context=this[0]=e,this.length=1,this):p.isFunction(e)?void 0!==k.ready?k.ready(e):e(p):(void 0!==e.selector&&(this.selector=e.selector,this.context=e.context),p.makeArray(e,this))}).prototype=p.fn,k=p(d);var T=/^(?:parents|prev(?:Until|All))/,S={children:!0,contents:!0,next:!0,prev:!0};function C(e,t){for(;(e=e[t])&&1!==e.nodeType;);return e}p.extend({dir:function(e,t,n){for(var i=[],r=void 0!==n;(e=e[t])&&9!==e.nodeType;)if(1===e.nodeType){if(r&&p(e).is(n))break;i.push(e)}return i},sibling:function(e,t){for(var n=[];e;e=e.nextSibling)1===e.nodeType&&e!==t&&n.push(e);return n}}),p.fn.extend({has:function(e){var t=p(e,this),n=t.length;return this.filter(function(){for(var e=0;e<n;e++)if(p.contains(this,t[e]))return!0})},closest:function(e,t){for(var n,i=0,r=this.length,o=[],a=_.test(e)||"string"!=typeof e?p(e,t||this.context):0;i<r;i++)for(n=this[i];n&&n!==t;n=n.parentNode)if(n.nodeType<11&&(a?a.index(n)>-1:1===n.nodeType&&p.find.matchesSelector(n,e))){o.push(n);break}return this.pushStack(o.length>1?p.unique(o):o)},index:function(e){return e?"string"==typeof e?a.call(p(e),this[0]):a.call(this,e.jquery?e[0]:e):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(e,t){return this.pushStack(p.unique(p.merge(this.get(),p(e,t))))},addBack:function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}}),p.each({parent:function(e){var t=e.parentNode;return t&&11!==t.nodeType?t:null},parents:function(e){return p.dir(e,"parentNode")},parentsUntil:function(e,t,n){return p.dir(e,"parentNode",n)},next:function(e){return C(e,"nextSibling")},prev:function(e){return C(e,"previousSibling")},nextAll:function(e){return p.dir(e,"nextSibling")},prevAll:function(e){return p.dir(e,"previousSibling")},nextUntil:function(e,t,n){return p.dir(e,"nextSibling",n)},prevUntil:function(e,t,n){return p.dir(e,"previousSibling",n)},siblings:function(e){return p.sibling((e.parentNode||{}).firstChild,e)},children:function(e){return p.sibling(e.firstChild)},contents:function(e){return e.contentDocument||p.merge([],e.childNodes)}},function(e,t){p.fn[e]=function(n,i){var r=p.map(this,t,n);return"Until"!==e.slice(-5)&&(i=n),i&&"string"==typeof i&&(r=p.filter(i,r)),this.length>1&&(S[e]||p.unique(r),T.test(e)&&r.reverse()),this.pushStack(r)}});var R,P=/\S+/g,N={};function O(){d.removeEventListener("DOMContentLoaded",O,!1),e.removeEventListener("load",O,!1),p.ready()}p.Callbacks=function(e){var t,n,i,r,o,a,s=[],u=!(e="string"==typeof e?N[e]||function(e){var t=N[e]={};return p.each(e.match(P)||[],function(e,n){t[n]=!0}),t}(e):p.extend({},e)).once&&[],c=function(d){for(t=e.memory&&d,n=!0,a=r||0,r=0,o=s.length,i=!0;s&&a<o;a++)if(!1===s[a].apply(d[0],d[1])&&e.stopOnFalse){t=!1;break}i=!1,s&&(u?u.length&&c(u.shift()):t?s=[]:l.disable())},l={add:function(){if(s){var n=s.length;!function t(n){p.each(n,function(n,i){var r=p.type(i);"function"===r?e.unique&&l.has(i)||s.push(i):i&&i.length&&"string"!==r&&t(i)})}(arguments),i?o=s.length:t&&(r=n,c(t))}return this},remove:function(){return s&&p.each(arguments,function(e,t){for(var n;(n=p.inArray(t,s,n))>-1;)s.splice(n,1),i&&(n<=o&&o--,n<=a&&a--)}),this},has:function(e){return e?p.inArray(e,s)>-1:!(!s||!s.length)},empty:function(){return s=[],o=0,this},disable:function(){return s=u=t=void 0,this},disabled:function(){return!s},lock:function(){return u=void 0,t||l.disable(),this},locked:function(){return!u},fireWith:function(e,t){return!s||n&&!u||(t=[e,(t=t||[]).slice?t.slice():t],i?u.push(t):c(t)),this},fire:function(){return l.fireWith(this,arguments),this},fired:function(){return!!n}};return l},p.extend({Deferred:function(e){var t=[["resolve","done",p.Callbacks("once memory"),"resolved"],["reject","fail",p.Callbacks("once memory"),"rejected"],["notify","progress",p.Callbacks("memory")]],n="pending",i={state:function(){return n},always:function(){return r.done(arguments).fail(arguments),this},then:function(){var e=arguments;return p.Deferred(function(n){p.each(t,function(t,o){var a=p.isFunction(e[t])&&e[t];r[o[1]](function(){var e=a&&a.apply(this,arguments);e&&p.isFunction(e.promise)?e.promise().done(n.resolve).fail(n.reject).progress(n.notify):n[o[0]+"With"](this===i?n.promise():this,a?[e]:arguments)})}),e=null}).promise()},promise:function(e){return null!=e?p.extend(e,i):i}},r={};return i.pipe=i.then,p.each(t,function(e,o){var a=o[2],s=o[3];i[o[1]]=a.add,s&&a.add(function(){n=s},t[1^e][2].disable,t[2][2].lock),r[o[0]]=function(){return r[o[0]+"With"](this===r?i:this,arguments),this},r[o[0]+"With"]=a.fireWith}),i.promise(r),e&&e.call(r,r),r},when:function(e){var t,n,r,o=0,a=i.call(arguments),s=a.length,u=1!==s||e&&p.isFunction(e.promise)?s:0,c=1===u?e:p.Deferred(),l=function(e,n,r){return function(o){n[e]=this,r[e]=arguments.length>1?i.call(arguments):o,r===t?c.notifyWith(n,r):--u||c.resolveWith(n,r)}};if(s>1)for(t=new Array(s),n=new Array(s),r=new Array(s);o<s;o++)a[o]&&p.isFunction(a[o].promise)?a[o].promise().done(l(o,r,a)).fail(c.reject).progress(l(o,n,t)):--u;return u||c.resolveWith(r,a),c.promise()}}),p.fn.ready=function(e){return p.ready.promise().done(e),this},p.extend({isReady:!1,readyWait:1,holdReady:function(e){e?p.readyWait++:p.ready(!0)},ready:function(e){(!0===e?--p.readyWait:p.isReady)||(p.isReady=!0,!0!==e&&--p.readyWait>0||(R.resolveWith(d,[p]),p.fn.triggerHandler&&(p(d).triggerHandler("ready"),p(d).off("ready"))))}}),p.ready.promise=function(t){return R||(R=p.Deferred(),"complete"===d.readyState?setTimeout(p.ready):(d.addEventListener("DOMContentLoaded",O,!1),e.addEventListener("load",O,!1))),R.promise(t)},p.ready.promise();var D=p.access=function(e,t,n,i,r,o,a){var s=0,u=e.length,c=null==n;if("object"===p.type(n))for(s in r=!0,n)p.access(e,t,s,n[s],!0,o,a);else if(void 0!==i&&(r=!0,p.isFunction(i)||(a=!0),c&&(a?(t.call(e,i),t=null):(c=t,t=function(e,t,n){return c.call(p(e),n)})),t))for(;s<u;s++)t(e[s],n,a?i:i.call(e[s],s,t(e[s],n)));return r?e:c?t.call(e):u?t(e[0],n):o};function I(){Object.defineProperty(this.cache={},0,{get:function(){return{}}}),this.expando=p.expando+I.uid++}p.acceptData=function(e){return 1===e.nodeType||9===e.nodeType||!+e.nodeType},I.uid=1,I.accepts=p.acceptData,I.prototype={key:function(e){if(!I.accepts(e))return 0;var t={},n=e[this.expando];if(!n){n=I.uid++;try{t[this.expando]={value:n},Object.defineProperties(e,t)}catch(i){t[this.expando]=n,p.extend(e,t)}}return this.cache[n]||(this.cache[n]={}),n},set:function(e,t,n){var i,r=this.key(e),o=this.cache[r];if("string"==typeof t)o[t]=n;else if(p.isEmptyObject(o))p.extend(this.cache[r],t);else for(i in t)o[i]=t[i];return o},get:function(e,t){var n=this.cache[this.key(e)];return void 0===t?n:n[t]},access:function(e,t,n){var i;return void 0===t||t&&"string"==typeof t&&void 0===n?void 0!==(i=this.get(e,t))?i:this.get(e,p.camelCase(t)):(this.set(e,t,n),void 0!==n?n:t)},remove:function(e,t){var n,i,r,o=this.key(e),a=this.cache[o];if(void 0===t)this.cache[o]={};else{p.isArray(t)?i=t.concat(t.map(p.camelCase)):(r=p.camelCase(t),i=t in a?[t,r]:(i=r)in a?[i]:i.match(P)||[]),n=i.length;for(;n--;)delete a[i[n]]}},hasData:function(e){return!p.isEmptyObject(this.cache[e[this.expando]]||{})},discard:function(e){e[this.expando]&&delete this.cache[e[this.expando]]}};var z=new I,x=new I,L=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,M=/([A-Z])/g;function F(e,t,n){var i;if(void 0===n&&1===e.nodeType)if(i="data-"+t.replace(M,"-$1").toLowerCase(),"string"==typeof(n=e.getAttribute(i))){try{n="true"===n||"false"!==n&&("null"===n?null:+n+""===n?+n:L.test(n)?p.parseJSON(n):n)}catch(e){}x.set(e,t,n)}else n=void 0;return n}p.extend({hasData:function(e){return x.hasData(e)||z.hasData(e)},data:function(e,t,n){return x.access(e,t,n)},removeData:function(e,t){x.remove(e,t)},_data:function(e,t,n){return z.access(e,t,n)},_removeData:function(e,t){z.remove(e,t)}}),p.fn.extend({data:function(e,t){var n,i,r,o=this[0],a=o&&o.attributes;if(void 0===e){if(this.length&&(r=x.get(o),1===o.nodeType&&!z.get(o,"hasDataAttrs"))){for(n=a.length;n--;)a[n]&&0===(i=a[n].name).indexOf("data-")&&(i=p.camelCase(i.slice(5)),F(o,i,r[i]));z.set(o,"hasDataAttrs",!0)}return r}return"object"==typeof e?this.each(function(){x.set(this,e)}):D(this,function(t){var n,i=p.camelCase(e);if(o&&void 0===t)return void 0!==(n=x.get(o,e))?n:void 0!==(n=x.get(o,i))?n:void 0!==(n=F(o,i,void 0))?n:void 0;this.each(function(){var n=x.get(this,i);x.set(this,i,t),-1!==e.indexOf("-")&&void 0!==n&&x.set(this,e,t)})},null,t,arguments.length>1,null,!0)},removeData:function(e){return this.each(function(){x.remove(this,e)})}}),p.extend({queue:function(e,t,n){var i;if(e)return t=(t||"fx")+"queue",i=z.get(e,t),n&&(!i||p.isArray(n)?i=z.access(e,t,p.makeArray(n)):i.push(n)),i||[]},dequeue:function(e,t){t=t||"fx";var n=p.queue(e,t),i=n.length,r=n.shift(),o=p._queueHooks(e,t);"inprogress"===r&&(r=n.shift(),i--),r&&("fx"===t&&n.unshift("inprogress"),delete o.stop,r.call(e,function(){p.dequeue(e,t)},o)),!i&&o&&o.empty.fire()},_queueHooks:function(e,t){var n=t+"queueHooks";return z.get(e,n)||z.access(e,n,{empty:p.Callbacks("once memory").add(function(){z.remove(e,[t+"queue",n])})})}}),p.fn.extend({queue:function(e,t){var n=2;return"string"!=typeof e&&(t=e,e="fx",n--),arguments.length<n?p.queue(this[0],e):void 0===t?this:this.each(function(){var n=p.queue(this,e,t);p._queueHooks(this,e),"fx"===e&&"inprogress"!==n[0]&&p.dequeue(this,e)})},dequeue:function(e){return this.each(function(){p.dequeue(this,e)})},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,t){var n,i=1,r=p.Deferred(),o=this,a=this.length,s=function(){--i||r.resolveWith(o,[o])};for("string"!=typeof e&&(t=e,e=void 0),e=e||"fx";a--;)(n=z.get(o[a],e+"queueHooks"))&&n.empty&&(i++,n.empty.add(s));return s(),r.promise(t)}});var V,j,B=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,q=["Top","Right","Bottom","Left"],U=function(e,t){return e=t||e,"none"===p.css(e,"display")||!p.contains(e.ownerDocument,e)},H=/^(?:checkbox|radio)$/i;V=d.createDocumentFragment().appendChild(d.createElement("div")),(j=d.createElement("input")).setAttribute("type","radio"),j.setAttribute("checked","checked"),j.setAttribute("name","t"),V.appendChild(j),l.checkClone=V.cloneNode(!0).cloneNode(!0).lastChild.checked,V.innerHTML="<textarea>x</textarea>",l.noCloneChecked=!!V.cloneNode(!0).lastChild.defaultValue;l.focusinBubbles="onfocusin"in e;var G=/^key/,W=/^(?:mouse|pointer|contextmenu)|click/,$=/^(?:focusinfocus|focusoutblur)$/,Y=/^([^.]*)(?:\.(.+)|)$/;function Q(){return!0}function K(){return!1}function Z(){try{return d.activeElement}catch(e){}}p.event={global:{},add:function(e,t,n,i,r){var o,a,s,u,c,l,d,f,h,m,g,v=z.get(e);if(v)for(n.handler&&(n=(o=n).handler,r=o.selector),n.guid||(n.guid=p.guid++),(u=v.events)||(u=v.events={}),(a=v.handle)||(a=v.handle=function(t){return void 0!==p&&p.event.triggered!==t.type?p.event.dispatch.apply(e,arguments):void 0}),c=(t=(t||"").match(P)||[""]).length;c--;)h=g=(s=Y.exec(t[c])||[])[1],m=(s[2]||"").split(".").sort(),h&&(d=p.event.special[h]||{},h=(r?d.delegateType:d.bindType)||h,d=p.event.special[h]||{},l=p.extend({type:h,origType:g,data:i,handler:n,guid:n.guid,selector:r,needsContext:r&&p.expr.match.needsContext.test(r),namespace:m.join(".")},o),(f=u[h])||((f=u[h]=[]).delegateCount=0,d.setup&&!1!==d.setup.call(e,i,m,a)||e.addEventListener&&e.addEventListener(h,a,!1)),d.add&&(d.add.call(e,l),l.handler.guid||(l.handler.guid=n.guid)),r?f.splice(f.delegateCount++,0,l):f.push(l),p.event.global[h]=!0)},remove:function(e,t,n,i,r){var o,a,s,u,c,l,d,f,h,m,g,v=z.hasData(e)&&z.get(e);if(v&&(u=v.events)){for(c=(t=(t||"").match(P)||[""]).length;c--;)if(h=g=(s=Y.exec(t[c])||[])[1],m=(s[2]||"").split(".").sort(),h){for(d=p.event.special[h]||{},f=u[h=(i?d.delegateType:d.bindType)||h]||[],s=s[2]&&new RegExp("(^|\\.)"+m.join("\\.(?:.*\\.|)")+"(\\.|$)"),a=o=f.length;o--;)l=f[o],!r&&g!==l.origType||n&&n.guid!==l.guid||s&&!s.test(l.namespace)||i&&i!==l.selector&&("**"!==i||!l.selector)||(f.splice(o,1),l.selector&&f.delegateCount--,d.remove&&d.remove.call(e,l));a&&!f.length&&(d.teardown&&!1!==d.teardown.call(e,m,v.handle)||p.removeEvent(e,h,v.handle),delete u[h])}else for(h in u)p.event.remove(e,h+t[c],n,i,!0);p.isEmptyObject(u)&&(delete v.handle,z.remove(e,"events"))}},trigger:function(t,n,i,r){var o,a,s,u,l,f,h,m=[i||d],g=c.call(t,"type")?t.type:t,v=c.call(t,"namespace")?t.namespace.split("."):[];if(a=s=i=i||d,3!==i.nodeType&&8!==i.nodeType&&!$.test(g+p.event.triggered)&&(g.indexOf(".")>=0&&(g=(v=g.split(".")).shift(),v.sort()),l=g.indexOf(":")<0&&"on"+g,(t=t[p.expando]?t:new p.Event(g,"object"==typeof t&&t)).isTrigger=r?2:3,t.namespace=v.join("."),t.namespace_re=t.namespace?new RegExp("(^|\\.)"+v.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,t.result=void 0,t.target||(t.target=i),n=null==n?[t]:p.makeArray(n,[t]),h=p.event.special[g]||{},r||!h.trigger||!1!==h.trigger.apply(i,n))){if(!r&&!h.noBubble&&!p.isWindow(i)){for(u=h.delegateType||g,$.test(u+g)||(a=a.parentNode);a;a=a.parentNode)m.push(a),s=a;s===(i.ownerDocument||d)&&m.push(s.defaultView||s.parentWindow||e)}for(o=0;(a=m[o++])&&!t.isPropagationStopped();)t.type=o>1?u:h.bindType||g,(f=(z.get(a,"events")||{})[t.type]&&z.get(a,"handle"))&&f.apply(a,n),(f=l&&a[l])&&f.apply&&p.acceptData(a)&&(t.result=f.apply(a,n),!1===t.result&&t.preventDefault());return t.type=g,r||t.isDefaultPrevented()||h._default&&!1!==h._default.apply(m.pop(),n)||!p.acceptData(i)||l&&p.isFunction(i[g])&&!p.isWindow(i)&&((s=i[l])&&(i[l]=null),p.event.triggered=g,i[g](),p.event.triggered=void 0,s&&(i[l]=s)),t.result}},dispatch:function(e){e=p.event.fix(e);var t,n,r,o,a,s,u=i.call(arguments),c=(z.get(this,"events")||{})[e.type]||[],l=p.event.special[e.type]||{};if(u[0]=e,e.delegateTarget=this,!l.preDispatch||!1!==l.preDispatch.call(this,e)){for(s=p.event.handlers.call(this,e,c),t=0;(o=s[t++])&&!e.isPropagationStopped();)for(e.currentTarget=o.elem,n=0;(a=o.handlers[n++])&&!e.isImmediatePropagationStopped();)e.namespace_re&&!e.namespace_re.test(a.namespace)||(e.handleObj=a,e.data=a.data,void 0!==(r=((p.event.special[a.origType]||{}).handle||a.handler).apply(o.elem,u))&&!1===(e.result=r)&&(e.preventDefault(),e.stopPropagation()));return l.postDispatch&&l.postDispatch.call(this,e),e.result}},handlers:function(e,t){var n,i,r,o,a=[],s=t.delegateCount,u=e.target;if(s&&u.nodeType&&(!e.button||"click"!==e.type))for(;u!==this;u=u.parentNode||this)if(!0!==u.disabled||"click"!==e.type){for(i=[],n=0;n<s;n++)void 0===i[r=(o=t[n]).selector+" "]&&(i[r]=o.needsContext?p(r,this).index(u)>=0:p.find(r,this,null,[u]).length),i[r]&&i.push(o);i.length&&a.push({elem:u,handlers:i})}return s<t.length&&a.push({elem:this,handlers:t.slice(s)}),a},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(e,t){return null==e.which&&(e.which=null!=t.charCode?t.charCode:t.keyCode),e}},mouseHooks:{props:"button buttons clientX clientY offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(e,t){var n,i,r,o=t.button;return null==e.pageX&&null!=t.clientX&&(i=(n=e.target.ownerDocument||d).documentElement,r=n.body,e.pageX=t.clientX+(i&&i.scrollLeft||r&&r.scrollLeft||0)-(i&&i.clientLeft||r&&r.clientLeft||0),e.pageY=t.clientY+(i&&i.scrollTop||r&&r.scrollTop||0)-(i&&i.clientTop||r&&r.clientTop||0)),e.which||void 0===o||(e.which=1&o?1:2&o?3:4&o?2:0),e}},fix:function(e){if(e[p.expando])return e;var t,n,i,r=e.type,o=e,a=this.fixHooks[r];for(a||(this.fixHooks[r]=a=W.test(r)?this.mouseHooks:G.test(r)?this.keyHooks:{}),i=a.props?this.props.concat(a.props):this.props,e=new p.Event(o),t=i.length;t--;)e[n=i[t]]=o[n];return e.target||(e.target=d),3===e.target.nodeType&&(e.target=e.target.parentNode),a.filter?a.filter(e,o):e},special:{load:{noBubble:!0},focus:{trigger:function(){if(this!==Z()&&this.focus)return this.focus(),!1},delegateType:"focusin"},blur:{trigger:function(){if(this===Z()&&this.blur)return this.blur(),!1},delegateType:"focusout"},click:{trigger:function(){if("checkbox"===this.type&&this.click&&p.nodeName(this,"input"))return this.click(),!1},_default:function(e){return p.nodeName(e.target,"a")}},beforeunload:{postDispatch:function(e){void 0!==e.result&&e.originalEvent&&(e.originalEvent.returnValue=e.result)}}},simulate:function(e,t,n,i){var r=p.extend(new p.Event,n,{type:e,isSimulated:!0,originalEvent:{}});i?p.event.trigger(r,null,t):p.event.dispatch.call(t,r),r.isDefaultPrevented()&&n.preventDefault()}},p.removeEvent=function(e,t,n){e.removeEventListener&&e.removeEventListener(t,n,!1)},p.Event=function(e,t){if(!(this instanceof p.Event))return new p.Event(e,t);e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||void 0===e.defaultPrevented&&!1===e.returnValue?Q:K):this.type=e,t&&p.extend(this,t),this.timeStamp=e&&e.timeStamp||p.now(),this[p.expando]=!0},p.Event.prototype={isDefaultPrevented:K,isPropagationStopped:K,isImmediatePropagationStopped:K,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=Q,e&&e.preventDefault&&e.preventDefault()},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=Q,e&&e.stopPropagation&&e.stopPropagation()},stopImmediatePropagation:function(){var e=this.originalEvent;this.isImmediatePropagationStopped=Q,e&&e.stopImmediatePropagation&&e.stopImmediatePropagation(),this.stopPropagation()}},p.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(e,t){p.event.special[e]={delegateType:t,bindType:t,handle:function(e){var n,i=e.relatedTarget,r=e.handleObj;return i&&(i===this||p.contains(this,i))||(e.type=r.origType,n=r.handler.apply(this,arguments),e.type=t),n}}}),l.focusinBubbles||p.each({focus:"focusin",blur:"focusout"},function(e,t){var n=function(e){p.event.simulate(t,e.target,p.event.fix(e),!0)};p.event.special[t]={setup:function(){var i=this.ownerDocument||this,r=z.access(i,t);r||i.addEventListener(e,n,!0),z.access(i,t,(r||0)+1)},teardown:function(){var i=this.ownerDocument||this,r=z.access(i,t)-1;r?z.access(i,t,r):(i.removeEventListener(e,n,!0),z.remove(i,t))}}}),p.fn.extend({on:function(e,t,n,i,r){var o,a;if("object"==typeof e){for(a in"string"!=typeof t&&(n=n||t,t=void 0),e)this.on(a,t,n,e[a],r);return this}if(null==n&&null==i?(i=t,n=t=void 0):null==i&&("string"==typeof t?(i=n,n=void 0):(i=n,n=t,t=void 0)),!1===i)i=K;else if(!i)return this;return 1===r&&(o=i,(i=function(e){return p().off(e),o.apply(this,arguments)}).guid=o.guid||(o.guid=p.guid++)),this.each(function(){p.event.add(this,e,i,n,t)})},one:function(e,t,n,i){return this.on(e,t,n,i,1)},off:function(e,t,n){var i,r;if(e&&e.preventDefault&&e.handleObj)return i=e.handleObj,p(e.delegateTarget).off(i.namespace?i.origType+"."+i.namespace:i.origType,i.selector,i.handler),this;if("object"==typeof e){for(r in e)this.off(r,t,e[r]);return this}return!1!==t&&"function"!=typeof t||(n=t,t=void 0),!1===n&&(n=K),this.each(function(){p.event.remove(this,e,n,t)})},trigger:function(e,t){return this.each(function(){p.event.trigger(e,t,this)})},triggerHandler:function(e,t){var n=this[0];if(n)return p.event.trigger(e,t,n,!0)}});var J=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,X=/<([\w:]+)/,ee=/<|&#?\w+;/,te=/<(?:script|style|link)/i,ne=/checked\s*(?:[^=]|=\s*.checked.)/i,ie=/^$|\/(?:java|ecma)script/i,re=/^true\/(.*)/,oe=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,ae={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};function se(e,t){return p.nodeName(e,"table")&&p.nodeName(11!==t.nodeType?t:t.firstChild,"tr")?e.getElementsByTagName("tbody")[0]||e.appendChild(e.ownerDocument.createElement("tbody")):e}function ue(e){return e.type=(null!==e.getAttribute("type"))+"/"+e.type,e}function ce(e){var t=re.exec(e.type);return t?e.type=t[1]:e.removeAttribute("type"),e}function le(e,t){for(var n=0,i=e.length;n<i;n++)z.set(e[n],"globalEval",!t||z.get(t[n],"globalEval"))}function de(e,t){var n,i,r,o,a,s,u,c;if(1===t.nodeType){if(z.hasData(e)&&(o=z.access(e),a=z.set(t,o),c=o.events))for(r in delete a.handle,a.events={},c)for(n=0,i=c[r].length;n<i;n++)p.event.add(t,r,c[r][n]);x.hasData(e)&&(s=x.access(e),u=p.extend({},s),x.set(t,u))}}function pe(e,t){var n=e.getElementsByTagName?e.getElementsByTagName(t||"*"):e.querySelectorAll?e.querySelectorAll(t||"*"):[];return void 0===t||t&&p.nodeName(e,t)?p.merge([e],n):n}ae.optgroup=ae.option,ae.tbody=ae.tfoot=ae.colgroup=ae.caption=ae.thead,ae.th=ae.td,p.extend({clone:function(e,t,n){var i,r,o,a,s,u,c,d=e.cloneNode(!0),f=p.contains(e.ownerDocument,e);if(!(l.noCloneChecked||1!==e.nodeType&&11!==e.nodeType||p.isXMLDoc(e)))for(a=pe(d),i=0,r=(o=pe(e)).length;i<r;i++)s=o[i],u=a[i],void 0,"input"===(c=u.nodeName.toLowerCase())&&H.test(s.type)?u.checked=s.checked:"input"!==c&&"textarea"!==c||(u.defaultValue=s.defaultValue);if(t)if(n)for(o=o||pe(e),a=a||pe(d),i=0,r=o.length;i<r;i++)de(o[i],a[i]);else de(e,d);return(a=pe(d,"script")).length>0&&le(a,!f&&pe(e,"script")),d},buildFragment:function(e,t,n,i){for(var r,o,a,s,u,c,l=t.createDocumentFragment(),d=[],f=0,h=e.length;f<h;f++)if((r=e[f])||0===r)if("object"===p.type(r))p.merge(d,r.nodeType?[r]:r);else if(ee.test(r)){for(o=o||l.appendChild(t.createElement("div")),a=(X.exec(r)||["",""])[1].toLowerCase(),s=ae[a]||ae._default,o.innerHTML=s[1]+r.replace(J,"<$1></$2>")+s[2],c=s[0];c--;)o=o.lastChild;p.merge(d,o.childNodes),(o=l.firstChild).textContent=""}else d.push(t.createTextNode(r));for(l.textContent="",f=0;r=d[f++];)if((!i||-1===p.inArray(r,i))&&(u=p.contains(r.ownerDocument,r),o=pe(l.appendChild(r),"script"),u&&le(o),n))for(c=0;r=o[c++];)ie.test(r.type||"")&&n.push(r);return l},cleanData:function(e){for(var t,n,i,r,o=p.event.special,a=0;void 0!==(n=e[a]);a++){if(p.acceptData(n)&&(r=n[z.expando])&&(t=z.cache[r])){if(t.events)for(i in t.events)o[i]?p.event.remove(n,i):p.removeEvent(n,i,t.handle);z.cache[r]&&delete z.cache[r]}delete x.cache[n[x.expando]]}}}),p.fn.extend({text:function(e){return D(this,function(e){return void 0===e?p.text(this):this.empty().each(function(){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||(this.textContent=e)})},null,e,arguments.length)},append:function(){return this.domManip(arguments,function(e){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||se(this,e).appendChild(e)})},prepend:function(){return this.domManip(arguments,function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=se(this,e);t.insertBefore(e,t.firstChild)}})},before:function(){return this.domManip(arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this)})},after:function(){return this.domManip(arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this.nextSibling)})},remove:function(e,t){for(var n,i=e?p.filter(e,this):this,r=0;null!=(n=i[r]);r++)t||1!==n.nodeType||p.cleanData(pe(n)),n.parentNode&&(t&&p.contains(n.ownerDocument,n)&&le(pe(n,"script")),n.parentNode.removeChild(n));return this},empty:function(){for(var e,t=0;null!=(e=this[t]);t++)1===e.nodeType&&(p.cleanData(pe(e,!1)),e.textContent="");return this},clone:function(e,t){return e=null!=e&&e,t=null==t?e:t,this.map(function(){return p.clone(this,e,t)})},html:function(e){return D(this,function(e){var t=this[0]||{},n=0,i=this.length;if(void 0===e&&1===t.nodeType)return t.innerHTML;if("string"==typeof e&&!te.test(e)&&!ae[(X.exec(e)||["",""])[1].toLowerCase()]){e=e.replace(J,"<$1></$2>");try{for(;n<i;n++)1===(t=this[n]||{}).nodeType&&(p.cleanData(pe(t,!1)),t.innerHTML=e);t=0}catch(e){}}t&&this.empty().append(e)},null,e,arguments.length)},replaceWith:function(){var e=arguments[0];return this.domManip(arguments,function(t){e=this.parentNode,p.cleanData(pe(this)),e&&e.replaceChild(t,this)}),e&&(e.length||e.nodeType)?this:this.remove()},detach:function(e){return this.remove(e,!0)},domManip:function(e,t){e=r.apply([],e);var n,i,o,a,s,u,c=0,d=this.length,f=this,h=d-1,m=e[0],g=p.isFunction(m);if(g||d>1&&"string"==typeof m&&!l.checkClone&&ne.test(m))return this.each(function(n){var i=f.eq(n);g&&(e[0]=m.call(this,n,i.html())),i.domManip(e,t)});if(d&&(i=(n=p.buildFragment(e,this[0].ownerDocument,!1,this)).firstChild,1===n.childNodes.length&&(n=i),i)){for(a=(o=p.map(pe(n,"script"),ue)).length;c<d;c++)s=n,c!==h&&(s=p.clone(s,!0,!0),a&&p.merge(o,pe(s,"script"))),t.call(this[c],s,c);if(a)for(u=o[o.length-1].ownerDocument,p.map(o,ce),c=0;c<a;c++)s=o[c],ie.test(s.type||"")&&!z.access(s,"globalEval")&&p.contains(u,s)&&(s.src?p._evalUrl&&p._evalUrl(s.src):p.globalEval(s.textContent.replace(oe,"")))}return this}}),p.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,t){p.fn[e]=function(e){for(var n,i=[],r=p(e),a=r.length-1,s=0;s<=a;s++)n=s===a?this:this.clone(!0),p(r[s])[t](n),o.apply(i,n.get());return this.pushStack(i)}});var fe,he={};function me(t,n){var i,r=p(n.createElement(t)).appendTo(n.body),o=e.getDefaultComputedStyle&&(i=e.getDefaultComputedStyle(r[0]))?i.display:p.css(r[0],"display");return r.detach(),o}function ge(e){var t=d,n=he[e];return n||("none"!==(n=me(e,t))&&n||((t=(fe=(fe||p("<iframe frameborder='0' width='0' height='0'/>")).appendTo(t.documentElement))[0].contentDocument).write(),t.close(),n=me(e,t),fe.detach()),he[e]=n),n}var ve=/^margin/,ye=new RegExp("^("+B+")(?!px)[a-z%]+$","i"),_e=function(t){return t.ownerDocument.defaultView.opener?t.ownerDocument.defaultView.getComputedStyle(t,null):e.getComputedStyle(t,null)};function be(e,t,n){var i,r,o,a,s=e.style;return(n=n||_e(e))&&(a=n.getPropertyValue(t)||n[t]),n&&(""!==a||p.contains(e.ownerDocument,e)||(a=p.style(e,t)),ye.test(a)&&ve.test(t)&&(i=s.width,r=s.minWidth,o=s.maxWidth,s.minWidth=s.maxWidth=s.width=a,a=n.width,s.width=i,s.minWidth=r,s.maxWidth=o)),void 0!==a?a+"":a}function we(e,t){return{get:function(){if(!e())return(this.get=t).apply(this,arguments);delete this.get}}}!function(){var t,n,i=d.documentElement,r=d.createElement("div"),o=d.createElement("div");function a(){o.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;display:block;margin-top:1%;top:1%;border:1px;padding:1px;width:4px;position:absolute",o.innerHTML="",i.appendChild(r);var a=e.getComputedStyle(o,null);t="1%"!==a.top,n="4px"===a.width,i.removeChild(r)}o.style&&(o.style.backgroundClip="content-box",o.cloneNode(!0).style.backgroundClip="",l.clearCloneStyle="content-box"===o.style.backgroundClip,r.style.cssText="border:0;width:0;height:0;top:0;left:-9999px;margin-top:1px;position:absolute",r.appendChild(o),e.getComputedStyle&&p.extend(l,{pixelPosition:function(){return a(),t},boxSizingReliable:function(){return null==n&&a(),n},reliableMarginRight:function(){var t,n=o.appendChild(d.createElement("div"));return n.style.cssText=o.style.cssText="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;margin:0;border:0;padding:0",n.style.marginRight=n.style.width="0",o.style.width="1px",i.appendChild(r),t=!parseFloat(e.getComputedStyle(n,null).marginRight),i.removeChild(r),o.removeChild(n),t}}))}(),p.swap=function(e,t,n,i){var r,o,a={};for(o in t)a[o]=e.style[o],e.style[o]=t[o];for(o in r=n.apply(e,i||[]),t)e.style[o]=a[o];return r};var Ae=/^(none|table(?!-c[ea]).+)/,ke=new RegExp("^("+B+")(.*)$","i"),Ee=new RegExp("^([+-])=("+B+")","i"),Te={position:"absolute",visibility:"hidden",display:"block"},Se={letterSpacing:"0",fontWeight:"400"},Ce=["Webkit","O","Moz","ms"];function Re(e,t){if(t in e)return t;for(var n=t[0].toUpperCase()+t.slice(1),i=t,r=Ce.length;r--;)if((t=Ce[r]+n)in e)return t;return i}function Pe(e,t,n){var i=ke.exec(t);return i?Math.max(0,i[1]-(n||0))+(i[2]||"px"):t}function Ne(e,t,n,i,r){for(var o=n===(i?"border":"content")?4:"width"===t?1:0,a=0;o<4;o+=2)"margin"===n&&(a+=p.css(e,n+q[o],!0,r)),i?("content"===n&&(a-=p.css(e,"padding"+q[o],!0,r)),"margin"!==n&&(a-=p.css(e,"border"+q[o]+"Width",!0,r))):(a+=p.css(e,"padding"+q[o],!0,r),"padding"!==n&&(a+=p.css(e,"border"+q[o]+"Width",!0,r)));return a}function Oe(e,t,n){var i=!0,r="width"===t?e.offsetWidth:e.offsetHeight,o=_e(e),a="border-box"===p.css(e,"boxSizing",!1,o);if(r<=0||null==r){if(((r=be(e,t,o))<0||null==r)&&(r=e.style[t]),ye.test(r))return r;i=a&&(l.boxSizingReliable()||r===e.style[t]),r=parseFloat(r)||0}return r+Ne(e,t,n||(a?"border":"content"),i,o)+"px"}function De(e,t){for(var n,i,r,o=[],a=0,s=e.length;a<s;a++)(i=e[a]).style&&(o[a]=z.get(i,"olddisplay"),n=i.style.display,t?(o[a]||"none"!==n||(i.style.display=""),""===i.style.display&&U(i)&&(o[a]=z.access(i,"olddisplay",ge(i.nodeName)))):(r=U(i),"none"===n&&r||z.set(i,"olddisplay",r?n:p.css(i,"display"))));for(a=0;a<s;a++)(i=e[a]).style&&(t&&"none"!==i.style.display&&""!==i.style.display||(i.style.display=t?o[a]||"":"none"));return e}function Ie(e,t,n,i,r){return new Ie.prototype.init(e,t,n,i,r)}p.extend({cssHooks:{opacity:{get:function(e,t){if(t){var n=be(e,"opacity");return""===n?"1":n}}}},cssNumber:{columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{float:"cssFloat"},style:function(e,t,n,i){if(e&&3!==e.nodeType&&8!==e.nodeType&&e.style){var r,o,a,s=p.camelCase(t),u=e.style;if(t=p.cssProps[s]||(p.cssProps[s]=Re(u,s)),a=p.cssHooks[t]||p.cssHooks[s],void 0===n)return a&&"get"in a&&void 0!==(r=a.get(e,!1,i))?r:u[t];"string"===(o=typeof n)&&(r=Ee.exec(n))&&(n=(r[1]+1)*r[2]+parseFloat(p.css(e,t)),o="number"),null!=n&&n==n&&("number"!==o||p.cssNumber[s]||(n+="px"),l.clearCloneStyle||""!==n||0!==t.indexOf("background")||(u[t]="inherit"),a&&"set"in a&&void 0===(n=a.set(e,n,i))||(u[t]=n))}},css:function(e,t,n,i){var r,o,a,s=p.camelCase(t);return t=p.cssProps[s]||(p.cssProps[s]=Re(e.style,s)),(a=p.cssHooks[t]||p.cssHooks[s])&&"get"in a&&(r=a.get(e,!0,n)),void 0===r&&(r=be(e,t,i)),"normal"===r&&t in Se&&(r=Se[t]),""===n||n?(o=parseFloat(r),!0===n||p.isNumeric(o)?o||0:r):r}}),p.each(["height","width"],function(e,t){p.cssHooks[t]={get:function(e,n,i){if(n)return Ae.test(p.css(e,"display"))&&0===e.offsetWidth?p.swap(e,Te,function(){return Oe(e,t,i)}):Oe(e,t,i)},set:function(e,n,i){var r=i&&_e(e);return Pe(0,n,i?Ne(e,t,i,"border-box"===p.css(e,"boxSizing",!1,r),r):0)}}}),p.cssHooks.marginRight=we(l.reliableMarginRight,function(e,t){if(t)return p.swap(e,{display:"inline-block"},be,[e,"marginRight"])}),p.each({margin:"",padding:"",border:"Width"},function(e,t){p.cssHooks[e+t]={expand:function(n){for(var i=0,r={},o="string"==typeof n?n.split(" "):[n];i<4;i++)r[e+q[i]+t]=o[i]||o[i-2]||o[0];return r}},ve.test(e)||(p.cssHooks[e+t].set=Pe)}),p.fn.extend({css:function(e,t){return D(this,function(e,t,n){var i,r,o={},a=0;if(p.isArray(t)){for(i=_e(e),r=t.length;a<r;a++)o[t[a]]=p.css(e,t[a],!1,i);return o}return void 0!==n?p.style(e,t,n):p.css(e,t)},e,t,arguments.length>1)},show:function(){return De(this,!0)},hide:function(){return De(this)},toggle:function(e){return"boolean"==typeof e?e?this.show():this.hide():this.each(function(){U(this)?p(this).show():p(this).hide()})}}),p.Tween=Ie,Ie.prototype={constructor:Ie,init:function(e,t,n,i,r,o){this.elem=e,this.prop=n,this.easing=r||"swing",this.options=t,this.start=this.now=this.cur(),this.end=i,this.unit=o||(p.cssNumber[n]?"":"px")},cur:function(){var e=Ie.propHooks[this.prop];return e&&e.get?e.get(this):Ie.propHooks._default.get(this)},run:function(e){var t,n=Ie.propHooks[this.prop];return this.options.duration?this.pos=t=p.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):this.pos=t=e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),n&&n.set?n.set(this):Ie.propHooks._default.set(this),this}},Ie.prototype.init.prototype=Ie.prototype,Ie.propHooks={_default:{get:function(e){var t;return null==e.elem[e.prop]||e.elem.style&&null!=e.elem.style[e.prop]?(t=p.css(e.elem,e.prop,""))&&"auto"!==t?t:0:e.elem[e.prop]},set:function(e){p.fx.step[e.prop]?p.fx.step[e.prop](e):e.elem.style&&(null!=e.elem.style[p.cssProps[e.prop]]||p.cssHooks[e.prop])?p.style(e.elem,e.prop,e.now+e.unit):e.elem[e.prop]=e.now}}},Ie.propHooks.scrollTop=Ie.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},p.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2}},p.fx=Ie.prototype.init,p.fx.step={};var ze,xe,Le=/^(?:toggle|show|hide)$/,Me=new RegExp("^(?:([+-])=|)("+B+")([a-z%]*)$","i"),Fe=/queueHooks$/,Ve=[function(e,t,n){var i,r,o,a,s,u,c,l=this,d={},f=e.style,h=e.nodeType&&U(e),m=z.get(e,"fxshow");n.queue||(null==(s=p._queueHooks(e,"fx")).unqueued&&(s.unqueued=0,u=s.empty.fire,s.empty.fire=function(){s.unqueued||u()}),s.unqueued++,l.always(function(){l.always(function(){s.unqueued--,p.queue(e,"fx").length||s.empty.fire()})}));1===e.nodeType&&("height"in t||"width"in t)&&(n.overflow=[f.overflow,f.overflowX,f.overflowY],c=p.css(e,"display"),"inline"===("none"===c?z.get(e,"olddisplay")||ge(e.nodeName):c)&&"none"===p.css(e,"float")&&(f.display="inline-block"));n.overflow&&(f.overflow="hidden",l.always(function(){f.overflow=n.overflow[0],f.overflowX=n.overflow[1],f.overflowY=n.overflow[2]}));for(i in t)if(r=t[i],Le.exec(r)){if(delete t[i],o=o||"toggle"===r,r===(h?"hide":"show")){if("show"!==r||!m||void 0===m[i])continue;h=!0}d[i]=m&&m[i]||p.style(e,i)}else c=void 0;if(p.isEmptyObject(d))"inline"===("none"===c?ge(e.nodeName):c)&&(f.display=c);else for(i in m?"hidden"in m&&(h=m.hidden):m=z.access(e,"fxshow",{}),o&&(m.hidden=!h),h?p(e).show():l.done(function(){p(e).hide()}),l.done(function(){var t;for(t in z.remove(e,"fxshow"),d)p.style(e,t,d[t])}),d)a=Ue(h?m[i]:0,i,l),i in m||(m[i]=a.start,h&&(a.end=a.start,a.start="width"===i||"height"===i?1:0))}],je={"*":[function(e,t){var n=this.createTween(e,t),i=n.cur(),r=Me.exec(t),o=r&&r[3]||(p.cssNumber[e]?"":"px"),a=(p.cssNumber[e]||"px"!==o&&+i)&&Me.exec(p.css(n.elem,e)),s=1,u=20;if(a&&a[3]!==o){o=o||a[3],r=r||[],a=+i||1;do{a/=s=s||".5",p.style(n.elem,e,a+o)}while(s!==(s=n.cur()/i)&&1!==s&&--u)}return r&&(a=n.start=+a||+i||0,n.unit=o,n.end=r[1]?a+(r[1]+1)*r[2]:+r[2]),n}]};function Be(){return setTimeout(function(){ze=void 0}),ze=p.now()}function qe(e,t){var n,i=0,r={height:e};for(t=t?1:0;i<4;i+=2-t)r["margin"+(n=q[i])]=r["padding"+n]=e;return t&&(r.opacity=r.width=e),r}function Ue(e,t,n){for(var i,r=(je[t]||[]).concat(je["*"]),o=0,a=r.length;o<a;o++)if(i=r[o].call(n,t,e))return i}function He(e,t,n){var i,r,o=0,a=Ve.length,s=p.Deferred().always(function(){delete u.elem}),u=function(){if(r)return!1;for(var t=ze||Be(),n=Math.max(0,c.startTime+c.duration-t),i=1-(n/c.duration||0),o=0,a=c.tweens.length;o<a;o++)c.tweens[o].run(i);return s.notifyWith(e,[c,i,n]),i<1&&a?n:(s.resolveWith(e,[c]),!1)},c=s.promise({elem:e,props:p.extend({},t),opts:p.extend(!0,{specialEasing:{}},n),originalProperties:t,originalOptions:n,startTime:ze||Be(),duration:n.duration,tweens:[],createTween:function(t,n){var i=p.Tween(e,c.opts,t,n,c.opts.specialEasing[t]||c.opts.easing);return c.tweens.push(i),i},stop:function(t){var n=0,i=t?c.tweens.length:0;if(r)return this;for(r=!0;n<i;n++)c.tweens[n].run(1);return t?s.resolveWith(e,[c,t]):s.rejectWith(e,[c,t]),this}}),l=c.props;for(!function(e,t){var n,i,r,o,a;for(n in e)if(r=t[i=p.camelCase(n)],o=e[n],p.isArray(o)&&(r=o[1],o=e[n]=o[0]),n!==i&&(e[i]=o,delete e[n]),(a=p.cssHooks[i])&&"expand"in a)for(n in o=a.expand(o),delete e[i],o)n in e||(e[n]=o[n],t[n]=r);else t[i]=r}(l,c.opts.specialEasing);o<a;o++)if(i=Ve[o].call(c,e,l,c.opts))return i;return p.map(l,Ue,c),p.isFunction(c.opts.start)&&c.opts.start.call(e,c),p.fx.timer(p.extend(u,{elem:e,anim:c,queue:c.opts.queue})),c.progress(c.opts.progress).done(c.opts.done,c.opts.complete).fail(c.opts.fail).always(c.opts.always)}p.Animation=p.extend(He,{tweener:function(e,t){p.isFunction(e)?(t=e,e=["*"]):e=e.split(" ");for(var n,i=0,r=e.length;i<r;i++)n=e[i],je[n]=je[n]||[],je[n].unshift(t)},prefilter:function(e,t){t?Ve.unshift(e):Ve.push(e)}}),p.speed=function(e,t,n){var i=e&&"object"==typeof e?p.extend({},e):{complete:n||!n&&t||p.isFunction(e)&&e,duration:e,easing:n&&t||t&&!p.isFunction(t)&&t};return i.duration=p.fx.off?0:"number"==typeof i.duration?i.duration:i.duration in p.fx.speeds?p.fx.speeds[i.duration]:p.fx.speeds._default,null!=i.queue&&!0!==i.queue||(i.queue="fx"),i.old=i.complete,i.complete=function(){p.isFunction(i.old)&&i.old.call(this),i.queue&&p.dequeue(this,i.queue)},i},p.fn.extend({fadeTo:function(e,t,n,i){return this.filter(U).css("opacity",0).show().end().animate({opacity:t},e,n,i)},animate:function(e,t,n,i){var r=p.isEmptyObject(e),o=p.speed(t,n,i),a=function(){var t=He(this,p.extend({},e),o);(r||z.get(this,"finish"))&&t.stop(!0)};return a.finish=a,r||!1===o.queue?this.each(a):this.queue(o.queue,a)},stop:function(e,t,n){var i=function(e){var t=e.stop;delete e.stop,t(n)};return"string"!=typeof e&&(n=t,t=e,e=void 0),t&&!1!==e&&this.queue(e||"fx",[]),this.each(function(){var t=!0,r=null!=e&&e+"queueHooks",o=p.timers,a=z.get(this);if(r)a[r]&&a[r].stop&&i(a[r]);else for(r in a)a[r]&&a[r].stop&&Fe.test(r)&&i(a[r]);for(r=o.length;r--;)o[r].elem!==this||null!=e&&o[r].queue!==e||(o[r].anim.stop(n),t=!1,o.splice(r,1));!t&&n||p.dequeue(this,e)})},finish:function(e){return!1!==e&&(e=e||"fx"),this.each(function(){var t,n=z.get(this),i=n[e+"queue"],r=n[e+"queueHooks"],o=p.timers,a=i?i.length:0;for(n.finish=!0,p.queue(this,e,[]),r&&r.stop&&r.stop.call(this,!0),t=o.length;t--;)o[t].elem===this&&o[t].queue===e&&(o[t].anim.stop(!0),o.splice(t,1));for(t=0;t<a;t++)i[t]&&i[t].finish&&i[t].finish.call(this);delete n.finish})}}),p.each(["toggle","show","hide"],function(e,t){var n=p.fn[t];p.fn[t]=function(e,i,r){return null==e||"boolean"==typeof e?n.apply(this,arguments):this.animate(qe(t,!0),e,i,r)}}),p.each({slideDown:qe("show"),slideUp:qe("hide"),slideToggle:qe("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(e,t){p.fn[e]=function(e,n,i){return this.animate(t,e,n,i)}}),p.timers=[],p.fx.tick=function(){var e,t=0,n=p.timers;for(ze=p.now();t<n.length;t++)(e=n[t])()||n[t]!==e||n.splice(t--,1);n.length||p.fx.stop(),ze=void 0},p.fx.timer=function(e){p.timers.push(e),e()?p.fx.start():p.timers.pop()},p.fx.interval=13,p.fx.start=function(){xe||(xe=setInterval(p.fx.tick,p.fx.interval))},p.fx.stop=function(){clearInterval(xe),xe=null},p.fx.speeds={slow:600,fast:200,_default:400},p.fn.delay=function(e,t){return e=p.fx&&p.fx.speeds[e]||e,t=t||"fx",this.queue(t,function(t,n){var i=setTimeout(t,e);n.stop=function(){clearTimeout(i)}})},function(){var e=d.createElement("input"),t=d.createElement("select"),n=t.appendChild(d.createElement("option"));e.type="checkbox",l.checkOn=""!==e.value,l.optSelected=n.selected,t.disabled=!0,l.optDisabled=!n.disabled,(e=d.createElement("input")).value="t",e.type="radio",l.radioValue="t"===e.value}();var Ge,We=p.expr.attrHandle;p.fn.extend({attr:function(e,t){return D(this,p.attr,e,t,arguments.length>1)},removeAttr:function(e){return this.each(function(){p.removeAttr(this,e)})}}),p.extend({attr:function(e,t,n){var i,r,o=e.nodeType;if(e&&3!==o&&8!==o&&2!==o)return void 0===e.getAttribute?p.prop(e,t,n):(1===o&&p.isXMLDoc(e)||(t=t.toLowerCase(),i=p.attrHooks[t]||(p.expr.match.bool.test(t)?Ge:void 0)),void 0===n?i&&"get"in i&&null!==(r=i.get(e,t))?r:null==(r=p.find.attr(e,t))?void 0:r:null!==n?i&&"set"in i&&void 0!==(r=i.set(e,n,t))?r:(e.setAttribute(t,n+""),n):void p.removeAttr(e,t))},removeAttr:function(e,t){var n,i,r=0,o=t&&t.match(P);if(o&&1===e.nodeType)for(;n=o[r++];)i=p.propFix[n]||n,p.expr.match.bool.test(n)&&(e[i]=!1),e.removeAttribute(n)},attrHooks:{type:{set:function(e,t){if(!l.radioValue&&"radio"===t&&p.nodeName(e,"input")){var n=e.value;return e.setAttribute("type",t),n&&(e.value=n),t}}}}}),Ge={set:function(e,t,n){return!1===t?p.removeAttr(e,n):e.setAttribute(n,n),n}},p.each(p.expr.match.bool.source.match(/\w+/g),function(e,t){var n=We[t]||p.find.attr;We[t]=function(e,t,i){var r,o;return i||(o=We[t],We[t]=r,r=null!=n(e,t,i)?t.toLowerCase():null,We[t]=o),r}});var $e=/^(?:input|select|textarea|button)$/i;p.fn.extend({prop:function(e,t){return D(this,p.prop,e,t,arguments.length>1)},removeProp:function(e){return this.each(function(){delete this[p.propFix[e]||e]})}}),p.extend({propFix:{for:"htmlFor",class:"className"},prop:function(e,t,n){var i,r,o=e.nodeType;if(e&&3!==o&&8!==o&&2!==o)return(1!==o||!p.isXMLDoc(e))&&(t=p.propFix[t]||t,r=p.propHooks[t]),void 0!==n?r&&"set"in r&&void 0!==(i=r.set(e,n,t))?i:e[t]=n:r&&"get"in r&&null!==(i=r.get(e,t))?i:e[t]},propHooks:{tabIndex:{get:function(e){return e.hasAttribute("tabindex")||$e.test(e.nodeName)||e.href?e.tabIndex:-1}}}}),l.optSelected||(p.propHooks.selected={get:function(e){var t=e.parentNode;return t&&t.parentNode&&t.parentNode.selectedIndex,null}}),p.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){p.propFix[this.toLowerCase()]=this});var Ye=/[\t\r\n\f]/g;p.fn.extend({addClass:function(e){var t,n,i,r,o,a,s="string"==typeof e&&e,u=0,c=this.length;if(p.isFunction(e))return this.each(function(t){p(this).addClass(e.call(this,t,this.className))});if(s)for(t=(e||"").match(P)||[];u<c;u++)if(i=1===(n=this[u]).nodeType&&(n.className?(" "+n.className+" ").replace(Ye," "):" ")){for(o=0;r=t[o++];)i.indexOf(" "+r+" ")<0&&(i+=r+" ");a=p.trim(i),n.className!==a&&(n.className=a)}return this},removeClass:function(e){var t,n,i,r,o,a,s=0===arguments.length||"string"==typeof e&&e,u=0,c=this.length;if(p.isFunction(e))return this.each(function(t){p(this).removeClass(e.call(this,t,this.className))});if(s)for(t=(e||"").match(P)||[];u<c;u++)if(i=1===(n=this[u]).nodeType&&(n.className?(" "+n.className+" ").replace(Ye," "):"")){for(o=0;r=t[o++];)for(;i.indexOf(" "+r+" ")>=0;)i=i.replace(" "+r+" "," ");a=e?p.trim(i):"",n.className!==a&&(n.className=a)}return this},toggleClass:function(e,t){var n=typeof e;return"boolean"==typeof t&&"string"===n?t?this.addClass(e):this.removeClass(e):p.isFunction(e)?this.each(function(n){p(this).toggleClass(e.call(this,n,this.className,t),t)}):this.each(function(){if("string"===n)for(var t,i=0,r=p(this),o=e.match(P)||[];t=o[i++];)r.hasClass(t)?r.removeClass(t):r.addClass(t);else"undefined"!==n&&"boolean"!==n||(this.className&&z.set(this,"__className__",this.className),this.className=this.className||!1===e?"":z.get(this,"__className__")||"")})},hasClass:function(e){for(var t=" "+e+" ",n=0,i=this.length;n<i;n++)if(1===this[n].nodeType&&(" "+this[n].className+" ").replace(Ye," ").indexOf(t)>=0)return!0;return!1}});var Qe=/\r/g;p.fn.extend({val:function(e){var t,n,i,r=this[0];return arguments.length?(i=p.isFunction(e),this.each(function(n){var r;1===this.nodeType&&(null==(r=i?e.call(this,n,p(this).val()):e)?r="":"number"==typeof r?r+="":p.isArray(r)&&(r=p.map(r,function(e){return null==e?"":e+""})),(t=p.valHooks[this.type]||p.valHooks[this.nodeName.toLowerCase()])&&"set"in t&&void 0!==t.set(this,r,"value")||(this.value=r))})):r?(t=p.valHooks[r.type]||p.valHooks[r.nodeName.toLowerCase()])&&"get"in t&&void 0!==(n=t.get(r,"value"))?n:"string"==typeof(n=r.value)?n.replace(Qe,""):null==n?"":n:void 0}}),p.extend({valHooks:{option:{get:function(e){var t=p.find.attr(e,"value");return null!=t?t:p.trim(p.text(e))}},select:{get:function(e){for(var t,n,i=e.options,r=e.selectedIndex,o="select-one"===e.type||r<0,a=o?null:[],s=o?r+1:i.length,u=r<0?s:o?r:0;u<s;u++)if(((n=i[u]).selected||u===r)&&(l.optDisabled?!n.disabled:null===n.getAttribute("disabled"))&&(!n.parentNode.disabled||!p.nodeName(n.parentNode,"optgroup"))){if(t=p(n).val(),o)return t;a.push(t)}return a},set:function(e,t){for(var n,i,r=e.options,o=p.makeArray(t),a=r.length;a--;)((i=r[a]).selected=p.inArray(i.value,o)>=0)&&(n=!0);return n||(e.selectedIndex=-1),o}}}}),p.each(["radio","checkbox"],function(){p.valHooks[this]={set:function(e,t){if(p.isArray(t))return e.checked=p.inArray(p(e).val(),t)>=0}},l.checkOn||(p.valHooks[this].get=function(e){return null===e.getAttribute("value")?"on":e.value})}),p.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(e,t){p.fn[t]=function(e,n){return arguments.length>0?this.on(t,null,e,n):this.trigger(t)}}),p.fn.extend({hover:function(e,t){return this.mouseenter(e).mouseleave(t||e)},bind:function(e,t,n){return this.on(e,null,t,n)},unbind:function(e,t){return this.off(e,null,t)},delegate:function(e,t,n,i){return this.on(t,e,n,i)},undelegate:function(e,t,n){return 1===arguments.length?this.off(e,"**"):this.off(t,e||"**",n)}});var Ke=p.now(),Ze=/\?/;p.parseJSON=function(e){return JSON.parse(e+"")},p.parseXML=function(e){var t;if(!e||"string"!=typeof e)return null;try{t=(new DOMParser).parseFromString(e,"text/xml")}catch(e){t=void 0}return t&&!t.getElementsByTagName("parsererror").length||p.error("Invalid XML: "+e),t};var Je=/#.*$/,Xe=/([?&])_=[^&]*/,et=/^(.*?):[ \t]*([^\r\n]*)$/gm,tt=/^(?:GET|HEAD)$/,nt=/^\/\//,it=/^([\w.+-]+:)(?:\/\/(?:[^\/?#]*@|)([^\/?#:]*)(?::(\d+)|)|)/,rt={},ot={},at="*/".concat("*"),st=e.location.href,ut=it.exec(st.toLowerCase())||[];function ct(e){return function(t,n){"string"!=typeof t&&(n=t,t="*");var i,r=0,o=t.toLowerCase().match(P)||[];if(p.isFunction(n))for(;i=o[r++];)"+"===i[0]?(i=i.slice(1)||"*",(e[i]=e[i]||[]).unshift(n)):(e[i]=e[i]||[]).push(n)}}function lt(e,t,n,i){var r={},o=e===ot;function a(s){var u;return r[s]=!0,p.each(e[s]||[],function(e,s){var c=s(t,n,i);return"string"!=typeof c||o||r[c]?o?!(u=c):void 0:(t.dataTypes.unshift(c),a(c),!1)}),u}return a(t.dataTypes[0])||!r["*"]&&a("*")}function dt(e,t){var n,i,r=p.ajaxSettings.flatOptions||{};for(n in t)void 0!==t[n]&&((r[n]?e:i||(i={}))[n]=t[n]);return i&&p.extend(!0,e,i),e}p.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:st,type:"GET",isLocal:/^(?:about|app|app-storage|.+-extension|file|res|widget):$/.test(ut[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":at,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":p.parseJSON,"text xml":p.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(e,t){return t?dt(dt(e,p.ajaxSettings),t):dt(p.ajaxSettings,e)},ajaxPrefilter:ct(rt),ajaxTransport:ct(ot),ajax:function(e,t){"object"==typeof e&&(t=e,e=void 0),t=t||{};var n,i,r,o,a,s,u,c,l=p.ajaxSetup({},t),d=l.context||l,f=l.context&&(d.nodeType||d.jquery)?p(d):p.event,h=p.Deferred(),m=p.Callbacks("once memory"),g=l.statusCode||{},v={},y={},_=0,b="canceled",w={readyState:0,getResponseHeader:function(e){var t;if(2===_){if(!o)for(o={};t=et.exec(r);)o[t[1].toLowerCase()]=t[2];t=o[e.toLowerCase()]}return null==t?null:t},getAllResponseHeaders:function(){return 2===_?r:null},setRequestHeader:function(e,t){var n=e.toLowerCase();return _||(e=y[n]=y[n]||e,v[e]=t),this},overrideMimeType:function(e){return _||(l.mimeType=e),this},statusCode:function(e){var t;if(e)if(_<2)for(t in e)g[t]=[g[t],e[t]];else w.always(e[w.status]);return this},abort:function(e){var t=e||b;return n&&n.abort(t),A(0,t),this}};if(h.promise(w).complete=m.add,w.success=w.done,w.error=w.fail,l.url=((e||l.url||st)+"").replace(Je,"").replace(nt,ut[1]+"//"),l.type=t.method||t.type||l.method||l.type,l.dataTypes=p.trim(l.dataType||"*").toLowerCase().match(P)||[""],null==l.crossDomain&&(s=it.exec(l.url.toLowerCase()),l.crossDomain=!(!s||s[1]===ut[1]&&s[2]===ut[2]&&(s[3]||("http:"===s[1]?"80":"443"))===(ut[3]||("http:"===ut[1]?"80":"443")))),l.data&&l.processData&&"string"!=typeof l.data&&(l.data=p.param(l.data,l.traditional)),lt(rt,l,t,w),2===_)return w;for(c in(u=p.event&&l.global)&&0==p.active++&&p.event.trigger("ajaxStart"),l.type=l.type.toUpperCase(),l.hasContent=!tt.test(l.type),i=l.url,l.hasContent||(l.data&&(i=l.url+=(Ze.test(i)?"&":"?")+l.data,delete l.data),!1===l.cache&&(l.url=Xe.test(i)?i.replace(Xe,"$1_="+Ke++):i+(Ze.test(i)?"&":"?")+"_="+Ke++)),l.ifModified&&(p.lastModified[i]&&w.setRequestHeader("If-Modified-Since",p.lastModified[i]),p.etag[i]&&w.setRequestHeader("If-None-Match",p.etag[i])),(l.data&&l.hasContent&&!1!==l.contentType||t.contentType)&&w.setRequestHeader("Content-Type",l.contentType),w.setRequestHeader("Accept",l.dataTypes[0]&&l.accepts[l.dataTypes[0]]?l.accepts[l.dataTypes[0]]+("*"!==l.dataTypes[0]?", "+at+"; q=0.01":""):l.accepts["*"]),l.headers)w.setRequestHeader(c,l.headers[c]);if(l.beforeSend&&(!1===l.beforeSend.call(d,w,l)||2===_))return w.abort();for(c in b="abort",{success:1,error:1,complete:1})w[c](l[c]);if(n=lt(ot,l,t,w)){w.readyState=1,u&&f.trigger("ajaxSend",[w,l]),l.async&&l.timeout>0&&(a=setTimeout(function(){w.abort("timeout")},l.timeout));try{_=1,n.send(v,A)}catch(e){if(!(_<2))throw e;A(-1,e)}}else A(-1,"No Transport");function A(e,t,o,s){var c,v,y,b,A,k=t;2!==_&&(_=2,a&&clearTimeout(a),n=void 0,r=s||"",w.readyState=e>0?4:0,c=e>=200&&e<300||304===e,o&&(b=function(e,t,n){for(var i,r,o,a,s=e.contents,u=e.dataTypes;"*"===u[0];)u.shift(),void 0===i&&(i=e.mimeType||t.getResponseHeader("Content-Type"));if(i)for(r in s)if(s[r]&&s[r].test(i)){u.unshift(r);break}if(u[0]in n)o=u[0];else{for(r in n){if(!u[0]||e.converters[r+" "+u[0]]){o=r;break}a||(a=r)}o=o||a}if(o)return o!==u[0]&&u.unshift(o),n[o]}(l,w,o)),b=function(e,t,n,i){var r,o,a,s,u,c={},l=e.dataTypes.slice();if(l[1])for(a in e.converters)c[a.toLowerCase()]=e.converters[a];for(o=l.shift();o;)if(e.responseFields[o]&&(n[e.responseFields[o]]=t),!u&&i&&e.dataFilter&&(t=e.dataFilter(t,e.dataType)),u=o,o=l.shift())if("*"===o)o=u;else if("*"!==u&&u!==o){if(!(a=c[u+" "+o]||c["* "+o]))for(r in c)if((s=r.split(" "))[1]===o&&(a=c[u+" "+s[0]]||c["* "+s[0]])){!0===a?a=c[r]:!0!==c[r]&&(o=s[0],l.unshift(s[1]));break}if(!0!==a)if(a&&e.throws)t=a(t);else try{t=a(t)}catch(e){return{state:"parsererror",error:a?e:"No conversion from "+u+" to "+o}}}return{state:"success",data:t}}(l,b,w,c),c?(l.ifModified&&((A=w.getResponseHeader("Last-Modified"))&&(p.lastModified[i]=A),(A=w.getResponseHeader("etag"))&&(p.etag[i]=A)),204===e||"HEAD"===l.type?k="nocontent":304===e?k="notmodified":(k=b.state,v=b.data,c=!(y=b.error))):(y=k,!e&&k||(k="error",e<0&&(e=0))),w.status=e,w.statusText=(t||k)+"",c?h.resolveWith(d,[v,k,w]):h.rejectWith(d,[w,k,y]),w.statusCode(g),g=void 0,u&&f.trigger(c?"ajaxSuccess":"ajaxError",[w,l,c?v:y]),m.fireWith(d,[w,k]),u&&(f.trigger("ajaxComplete",[w,l]),--p.active||p.event.trigger("ajaxStop")))}return w},getJSON:function(e,t,n){return p.get(e,t,n,"json")},getScript:function(e,t){return p.get(e,void 0,t,"script")}}),p.each(["get","post"],function(e,t){p[t]=function(e,n,i,r){return p.isFunction(n)&&(r=r||i,i=n,n=void 0),p.ajax({url:e,type:t,dataType:r,data:n,success:i})}}),p._evalUrl=function(e){return p.ajax({url:e,type:"GET",dataType:"script",async:!1,global:!1,throws:!0})},p.fn.extend({wrapAll:function(e){var t;return p.isFunction(e)?this.each(function(t){p(this).wrapAll(e.call(this,t))}):(this[0]&&(t=p(e,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&t.insertBefore(this[0]),t.map(function(){for(var e=this;e.firstElementChild;)e=e.firstElementChild;return e}).append(this)),this)},wrapInner:function(e){return p.isFunction(e)?this.each(function(t){p(this).wrapInner(e.call(this,t))}):this.each(function(){var t=p(this),n=t.contents();n.length?n.wrapAll(e):t.append(e)})},wrap:function(e){var t=p.isFunction(e);return this.each(function(n){p(this).wrapAll(t?e.call(this,n):e)})},unwrap:function(){return this.parent().each(function(){p.nodeName(this,"body")||p(this).replaceWith(this.childNodes)}).end()}}),p.expr.filters.hidden=function(e){return e.offsetWidth<=0&&e.offsetHeight<=0},p.expr.filters.visible=function(e){return!p.expr.filters.hidden(e)};var pt=/%20/g,ft=/\[\]$/,ht=/\r?\n/g,mt=/^(?:submit|button|image|reset|file)$/i,gt=/^(?:input|select|textarea|keygen)/i;function vt(e,t,n,i){var r;if(p.isArray(t))p.each(t,function(t,r){n||ft.test(e)?i(e,r):vt(e+"["+("object"==typeof r?t:"")+"]",r,n,i)});else if(n||"object"!==p.type(t))i(e,t);else for(r in t)vt(e+"["+r+"]",t[r],n,i)}p.param=function(e,t){var n,i=[],r=function(e,t){t=p.isFunction(t)?t():null==t?"":t,i[i.length]=encodeURIComponent(e)+"="+encodeURIComponent(t)};if(void 0===t&&(t=p.ajaxSettings&&p.ajaxSettings.traditional),p.isArray(e)||e.jquery&&!p.isPlainObject(e))p.each(e,function(){r(this.name,this.value)});else for(n in e)vt(n,e[n],t,r);return i.join("&").replace(pt,"+")},p.fn.extend({serialize:function(){return p.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var e=p.prop(this,"elements");return e?p.makeArray(e):this}).filter(function(){var e=this.type;return this.name&&!p(this).is(":disabled")&&gt.test(this.nodeName)&&!mt.test(e)&&(this.checked||!H.test(e))}).map(function(e,t){var n=p(this).val();return null==n?null:p.isArray(n)?p.map(n,function(e){return{name:t.name,value:e.replace(ht,"\r\n")}}):{name:t.name,value:n.replace(ht,"\r\n")}}).get()}}),p.ajaxSettings.xhr=function(){try{return new XMLHttpRequest}catch(e){}};var yt=0,_t={},bt={0:200,1223:204},wt=p.ajaxSettings.xhr();e.attachEvent&&e.attachEvent("onunload",function(){for(var e in _t)_t[e]()}),l.cors=!!wt&&"withCredentials"in wt,l.ajax=wt=!!wt,p.ajaxTransport(function(e){var t;if(l.cors||wt&&!e.crossDomain)return{send:function(n,i){var r,o=e.xhr(),a=++yt;if(o.open(e.type,e.url,e.async,e.username,e.password),e.xhrFields)for(r in e.xhrFields)o[r]=e.xhrFields[r];for(r in e.mimeType&&o.overrideMimeType&&o.overrideMimeType(e.mimeType),e.crossDomain||n["X-Requested-With"]||(n["X-Requested-With"]="XMLHttpRequest"),n)o.setRequestHeader(r,n[r]);t=function(e){return function(){t&&(delete _t[a],t=o.onload=o.onerror=null,"abort"===e?o.abort():"error"===e?i(o.status,o.statusText):i(bt[o.status]||o.status,o.statusText,"string"==typeof o.responseText?{text:o.responseText}:void 0,o.getAllResponseHeaders()))}},o.onload=t(),o.onerror=t("error"),t=_t[a]=t("abort");try{o.send(e.hasContent&&e.data||null)}catch(e){if(t)throw e}},abort:function(){t&&t()}}}),p.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(e){return p.globalEval(e),e}}}),p.ajaxPrefilter("script",function(e){void 0===e.cache&&(e.cache=!1),e.crossDomain&&(e.type="GET")}),p.ajaxTransport("script",function(e){var t,n;if(e.crossDomain)return{send:function(i,r){t=p("<script>").prop({async:!0,charset:e.scriptCharset,src:e.url}).on("load error",n=function(e){t.remove(),n=null,e&&r("error"===e.type?404:200,e.type)}),d.head.appendChild(t[0])},abort:function(){n&&n()}}});var At=[],kt=/(=)\?(?=&|$)|\?\?/;p.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=At.pop()||p.expando+"_"+Ke++;return this[e]=!0,e}}),p.ajaxPrefilter("json jsonp",function(t,n,i){var r,o,a,s=!1!==t.jsonp&&(kt.test(t.url)?"url":"string"==typeof t.data&&!(t.contentType||"").indexOf("application/x-www-form-urlencoded")&&kt.test(t.data)&&"data");if(s||"jsonp"===t.dataTypes[0])return r=t.jsonpCallback=p.isFunction(t.jsonpCallback)?t.jsonpCallback():t.jsonpCallback,s?t[s]=t[s].replace(kt,"$1"+r):!1!==t.jsonp&&(t.url+=(Ze.test(t.url)?"&":"?")+t.jsonp+"="+r),t.converters["script json"]=function(){return a||p.error(r+" was not called"),a[0]},t.dataTypes[0]="json",o=e[r],e[r]=function(){a=arguments},i.always(function(){e[r]=o,t[r]&&(t.jsonpCallback=n.jsonpCallback,At.push(r)),a&&p.isFunction(o)&&o(a[0]),a=o=void 0}),"script"}),p.parseHTML=function(e,t,n){if(!e||"string"!=typeof e)return null;"boolean"==typeof t&&(n=t,t=!1),t=t||d;var i=b.exec(e),r=!n&&[];return i?[t.createElement(i[1])]:(i=p.buildFragment([e],t,r),r&&r.length&&p(r).remove(),p.merge([],i.childNodes))};var Et=p.fn.load;p.fn.load=function(e,t,n){if("string"!=typeof e&&Et)return Et.apply(this,arguments);var i,r,o,a=this,s=e.indexOf(" ");return s>=0&&(i=p.trim(e.slice(s)),e=e.slice(0,s)),p.isFunction(t)?(n=t,t=void 0):t&&"object"==typeof t&&(r="POST"),a.length>0&&p.ajax({url:e,type:r,dataType:"html",data:t}).done(function(e){o=arguments,a.html(i?p("<div>").append(p.parseHTML(e)).find(i):e)}).complete(n&&function(e,t){a.each(n,o||[e.responseText,t,e])}),this},p.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(e,t){p.fn[t]=function(e){return this.on(t,e)}}),p.expr.filters.animated=function(e){return p.grep(p.timers,function(t){return e===t.elem}).length};var Tt=e.document.documentElement;function St(e){return p.isWindow(e)?e:9===e.nodeType&&e.defaultView}p.offset={setOffset:function(e,t,n){var i,r,o,a,s,u,c=p.css(e,"position"),l=p(e),d={};"static"===c&&(e.style.position="relative"),s=l.offset(),o=p.css(e,"top"),u=p.css(e,"left"),("absolute"===c||"fixed"===c)&&(o+u).indexOf("auto")>-1?(a=(i=l.position()).top,r=i.left):(a=parseFloat(o)||0,r=parseFloat(u)||0),p.isFunction(t)&&(t=t.call(e,n,s)),null!=t.top&&(d.top=t.top-s.top+a),null!=t.left&&(d.left=t.left-s.left+r),"using"in t?t.using.call(e,d):l.css(d)}},p.fn.extend({offset:function(e){if(arguments.length)return void 0===e?this:this.each(function(t){p.offset.setOffset(this,e,t)});var t,n,i=this[0],r={top:0,left:0},o=i&&i.ownerDocument;return o?(t=o.documentElement,p.contains(t,i)?(void 0!==i.getBoundingClientRect&&(r=i.getBoundingClientRect()),n=St(o),{top:r.top+n.pageYOffset-t.clientTop,left:r.left+n.pageXOffset-t.clientLeft}):r):void 0},position:function(){if(this[0]){var e,t,n=this[0],i={top:0,left:0};return"fixed"===p.css(n,"position")?t=n.getBoundingClientRect():(e=this.offsetParent(),t=this.offset(),p.nodeName(e[0],"html")||(i=e.offset()),i.top+=p.css(e[0],"borderTopWidth",!0),i.left+=p.css(e[0],"borderLeftWidth",!0)),{top:t.top-i.top-p.css(n,"marginTop",!0),left:t.left-i.left-p.css(n,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var e=this.offsetParent||Tt;e&&!p.nodeName(e,"html")&&"static"===p.css(e,"position");)e=e.offsetParent;return e||Tt})}}),p.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(t,n){var i="pageYOffset"===n;p.fn[t]=function(r){return D(this,function(t,r,o){var a=St(t);if(void 0===o)return a?a[n]:t[r];a?a.scrollTo(i?e.pageXOffset:o,i?o:e.pageYOffset):t[r]=o},t,r,arguments.length,null)}}),p.each(["top","left"],function(e,t){p.cssHooks[t]=we(l.pixelPosition,function(e,n){if(n)return n=be(e,t),ye.test(n)?p(e).position()[t]+"px":n})}),p.each({Height:"height",Width:"width"},function(e,t){p.each({padding:"inner"+e,content:t,"":"outer"+e},function(n,i){p.fn[i]=function(i,r){var o=arguments.length&&(n||"boolean"!=typeof i),a=n||(!0===i||!0===r?"margin":"border");return D(this,function(t,n,i){var r;return p.isWindow(t)?t.document.documentElement["client"+e]:9===t.nodeType?(r=t.documentElement,Math.max(t.body["scroll"+e],r["scroll"+e],t.body["offset"+e],r["offset"+e],r["client"+e])):void 0===i?p.css(t,n,a):p.style(t,n,i,a)},t,o?i:void 0,o,null)}})}),p.fn.size=function(){return this.length},p.fn.andSelf=p.fn.addBack,"function"==typeof define&&define.amd&&define("jquery",[],function(){return p});var Ct=e.jQuery,Rt=e.$;return p.noConflict=function(t){return e.$===p&&(e.$=Rt),t&&e.jQuery===p&&(e.jQuery=Ct),p},void 0===t&&(e.jQuery=e.$=p),p}),function(){var e="object"==typeof self&&self.self===self&&self||"object"==typeof global&&global.global===global&&global||this||{},t=e._,n=Array.prototype,i=Object.prototype,r="undefined"!=typeof Symbol?Symbol.prototype:null,o=n.push,a=n.slice,s=i.toString,u=i.hasOwnProperty,c=Array.isArray,l=Object.keys,d=Object.create,p=function(){},f=function(e){return e instanceof f?e:this instanceof f?void(this._wrapped=e):new f(e)};"undefined"==typeof exports||exports.nodeType?e._=f:("undefined"!=typeof module&&!module.nodeType&&module.exports&&(exports=module.exports=f),exports._=f),f.VERSION="1.9.2";var h,m=function(e,t,n){if(void 0===t)return e;switch(null==n?3:n){case 1:return function(n){return e.call(t,n)};case 3:return function(n,i,r){return e.call(t,n,i,r)};case 4:return function(n,i,r,o){return e.call(t,n,i,r,o)}}return function(){return e.apply(t,arguments)}},g=function(e,t,n){return f.iteratee!==h?f.iteratee(e,t):null==e?f.identity:f.isFunction(e)?m(e,t,n):f.isObject(e)&&!f.isArray(e)?f.matcher(e):f.property(e)};f.iteratee=h=function(e,t){return g(e,t,1/0)};var v=function(e,t){return t=null==t?e.length-1:+t,function(){for(var n=Math.max(arguments.length-t,0),i=Array(n),r=0;r<n;r++)i[r]=arguments[r+t];switch(t){case 0:return e.call(this,i);case 1:return e.call(this,arguments[0],i);case 2:return e.call(this,arguments[0],arguments[1],i)}var o=Array(t+1);for(r=0;r<t;r++)o[r]=arguments[r];return o[t]=i,e.apply(this,o)}},y=function(e){if(!f.isObject(e))return{};if(d)return d(e);p.prototype=e;var t=new p;return p.prototype=null,t},_=function(e){return function(t){return null==t?void 0:t[e]}},b=function(e,t){return null!=e&&u.call(e,t)},w=function(e,t){for(var n=t.length,i=0;i<n;i++){if(null==e)return;e=e[t[i]]}return n?e:void 0},A=Math.pow(2,53)-1,k=_("length"),E=function(e){var t=k(e);return"number"==typeof t&&t>=0&&t<=A};f.each=f.forEach=function(e,t,n){var i,r;if(t=m(t,n),E(e))for(i=0,r=e.length;i<r;i++)t(e[i],i,e);else{var o=f.keys(e);for(i=0,r=o.length;i<r;i++)t(e[o[i]],o[i],e)}return e},f.map=f.collect=function(e,t,n){t=g(t,n);for(var i=!E(e)&&f.keys(e),r=(i||e).length,o=Array(r),a=0;a<r;a++){var s=i?i[a]:a;o[a]=t(e[s],s,e)}return o};var T=function(e){return function(t,n,i,r){var o=arguments.length>=3;return function(t,n,i,r){var o=!E(t)&&f.keys(t),a=(o||t).length,s=e>0?0:a-1;for(r||(i=t[o?o[s]:s],s+=e);s>=0&&s<a;s+=e){var u=o?o[s]:s;i=n(i,t[u],u,t)}return i}(t,m(n,r,4),i,o)}};f.reduce=f.foldl=f.inject=T(1),f.reduceRight=f.foldr=T(-1),f.find=f.detect=function(e,t,n){var i=(E(e)?f.findIndex:f.findKey)(e,t,n);if(void 0!==i&&-1!==i)return e[i]},f.filter=f.select=function(e,t,n){var i=[];return t=g(t,n),f.each(e,function(e,n,r){t(e,n,r)&&i.push(e)}),i},f.reject=function(e,t,n){return f.filter(e,f.negate(g(t)),n)},f.every=f.all=function(e,t,n){t=g(t,n);for(var i=!E(e)&&f.keys(e),r=(i||e).length,o=0;o<r;o++){var a=i?i[o]:o;if(!t(e[a],a,e))return!1}return!0},f.some=f.any=function(e,t,n){t=g(t,n);for(var i=!E(e)&&f.keys(e),r=(i||e).length,o=0;o<r;o++){var a=i?i[o]:o;if(t(e[a],a,e))return!0}return!1},f.contains=f.includes=f.include=function(e,t,n,i){return E(e)||(e=f.values(e)),("number"!=typeof n||i)&&(n=0),f.indexOf(e,t,n)>=0},f.invoke=v(function(e,t,n){var i,r;return f.isFunction(t)?r=t:f.isArray(t)&&(i=t.slice(0,-1),t=t[t.length-1]),f.map(e,function(e){var o=r;if(!o){if(i&&i.length&&(e=w(e,i)),null==e)return;o=e[t]}return null==o?o:o.apply(e,n)})}),f.pluck=function(e,t){return f.map(e,f.property(t))},f.where=function(e,t){return f.filter(e,f.matcher(t))},f.findWhere=function(e,t){return f.find(e,f.matcher(t))},f.max=function(e,t,n){var i,r,o=-1/0,a=-1/0;if(null==t||"number"==typeof t&&"object"!=typeof e[0]&&null!=e)for(var s=0,u=(e=E(e)?e:f.values(e)).length;s<u;s++)null!=(i=e[s])&&i>o&&(o=i);else t=g(t,n),f.each(e,function(e,n,i){((r=t(e,n,i))>a||r===-1/0&&o===-1/0)&&(o=e,a=r)});return o},f.min=function(e,t,n){var i,r,o=1/0,a=1/0;if(null==t||"number"==typeof t&&"object"!=typeof e[0]&&null!=e)for(var s=0,u=(e=E(e)?e:f.values(e)).length;s<u;s++)null!=(i=e[s])&&i<o&&(o=i);else t=g(t,n),f.each(e,function(e,n,i){((r=t(e,n,i))<a||r===1/0&&o===1/0)&&(o=e,a=r)});return o},f.shuffle=function(e){return f.sample(e,1/0)},f.sample=function(e,t,n){if(null==t||n)return E(e)||(e=f.values(e)),e[f.random(e.length-1)];var i=E(e)?f.clone(e):f.values(e),r=k(i);t=Math.max(Math.min(t,r),0);for(var o=r-1,a=0;a<t;a++){var s=f.random(a,o),u=i[a];i[a]=i[s],i[s]=u}return i.slice(0,t)},f.sortBy=function(e,t,n){var i=0;return t=g(t,n),f.pluck(f.map(e,function(e,n,r){return{value:e,index:i++,criteria:t(e,n,r)}}).sort(function(e,t){var n=e.criteria,i=t.criteria;if(n!==i){if(n>i||void 0===n)return 1;if(n<i||void 0===i)return-1}return e.index-t.index}),"value")};var S=function(e,t){return function(n,i,r){var o=t?[[],[]]:{};return i=g(i,r),f.each(n,function(t,r){var a=i(t,r,n);e(o,t,a)}),o}};f.groupBy=S(function(e,t,n){b(e,n)?e[n].push(t):e[n]=[t]}),f.indexBy=S(function(e,t,n){e[n]=t}),f.countBy=S(function(e,t,n){b(e,n)?e[n]++:e[n]=1});var C=/[^\ud800-\udfff]|[\ud800-\udbff][\udc00-\udfff]|[\ud800-\udfff]/g;f.toArray=function(e){return e?f.isArray(e)?a.call(e):f.isString(e)?e.match(C):E(e)?f.map(e,f.identity):f.values(e):[]},f.size=function(e){return null==e?0:E(e)?e.length:f.keys(e).length},f.partition=S(function(e,t,n){e[n?0:1].push(t)},!0),f.first=f.head=f.take=function(e,t,n){return null==e||e.length<1?null==t?void 0:[]:null==t||n?e[0]:f.initial(e,e.length-t)},f.initial=function(e,t,n){return a.call(e,0,Math.max(0,e.length-(null==t||n?1:t)))},f.last=function(e,t,n){return null==e||e.length<1?null==t?void 0:[]:null==t||n?e[e.length-1]:f.rest(e,Math.max(0,e.length-t))},f.rest=f.tail=f.drop=function(e,t,n){return a.call(e,null==t||n?1:t)},f.compact=function(e){return f.filter(e,Boolean)};var R=function(e,t,n,i){for(var r=(i=i||[]).length,o=0,a=k(e);o<a;o++){var s=e[o];if(E(s)&&(f.isArray(s)||f.isArguments(s)))if(t)for(var u=0,c=s.length;u<c;)i[r++]=s[u++];else R(s,t,n,i),r=i.length;else n||(i[r++]=s)}return i};f.flatten=function(e,t){return R(e,t,!1)},f.without=v(function(e,t){return f.difference(e,t)}),f.uniq=f.unique=function(e,t,n,i){f.isBoolean(t)||(i=n,n=t,t=!1),null!=n&&(n=g(n,i));for(var r=[],o=[],a=0,s=k(e);a<s;a++){var u=e[a],c=n?n(u,a,e):u;t&&!n?(a&&o===c||r.push(u),o=c):n?f.contains(o,c)||(o.push(c),r.push(u)):f.contains(r,u)||r.push(u)}return r},f.union=v(function(e){return f.uniq(R(e,!0,!0))}),f.intersection=function(e){for(var t=[],n=arguments.length,i=0,r=k(e);i<r;i++){var o=e[i];if(!f.contains(t,o)){var a;for(a=1;a<n&&f.contains(arguments[a],o);a++);a===n&&t.push(o)}}return t},f.difference=v(function(e,t){return t=R(t,!0,!0),f.filter(e,function(e){return!f.contains(t,e)})}),f.unzip=function(e){for(var t=e&&f.max(e,k).length||0,n=Array(t),i=0;i<t;i++)n[i]=f.pluck(e,i);return n},f.zip=v(f.unzip),f.object=function(e,t){for(var n={},i=0,r=k(e);i<r;i++)t?n[e[i]]=t[i]:n[e[i][0]]=e[i][1];return n};var P=function(e){return function(t,n,i){n=g(n,i);for(var r=k(t),o=e>0?0:r-1;o>=0&&o<r;o+=e)if(n(t[o],o,t))return o;return-1}};f.findIndex=P(1),f.findLastIndex=P(-1),f.sortedIndex=function(e,t,n,i){for(var r=(n=g(n,i,1))(t),o=0,a=k(e);o<a;){var s=Math.floor((o+a)/2);n(e[s])<r?o=s+1:a=s}return o};var N=function(e,t,n){return function(i,r,o){var s=0,u=k(i);if("number"==typeof o)e>0?s=o>=0?o:Math.max(o+u,s):u=o>=0?Math.min(o+1,u):o+u+1;else if(n&&o&&u)return i[o=n(i,r)]===r?o:-1;if(r!=r)return(o=t(a.call(i,s,u),f.isNaN))>=0?o+s:-1;for(o=e>0?s:u-1;o>=0&&o<u;o+=e)if(i[o]===r)return o;return-1}};f.indexOf=N(1,f.findIndex,f.sortedIndex),f.lastIndexOf=N(-1,f.findLastIndex),f.range=function(e,t,n){null==t&&(t=e||0,e=0),n||(n=t<e?-1:1);for(var i=Math.max(Math.ceil((t-e)/n),0),r=Array(i),o=0;o<i;o++,e+=n)r[o]=e;return r},f.chunk=function(e,t){if(null==t||t<1)return[];for(var n=[],i=0,r=e.length;i<r;)n.push(a.call(e,i,i+=t));return n};var O=function(e,t,n,i,r){if(!(i instanceof t))return e.apply(n,r);var o=y(e.prototype),a=e.apply(o,r);return f.isObject(a)?a:o};f.bind=v(function(e,t,n){if(!f.isFunction(e))throw new TypeError("Bind must be called on a function");var i=v(function(r){return O(e,i,t,this,n.concat(r))});return i}),f.partial=v(function(e,t){var n=f.partial.placeholder,i=function(){for(var r=0,o=t.length,a=Array(o),s=0;s<o;s++)a[s]=t[s]===n?arguments[r++]:t[s];for(;r<arguments.length;)a.push(arguments[r++]);return O(e,i,this,this,a)};return i}),f.partial.placeholder=f,f.bindAll=v(function(e,t){var n=(t=R(t,!1,!1)).length;if(n<1)throw new Error("bindAll must be passed function names");for(;n--;){var i=t[n];e[i]=f.bind(e[i],e)}}),f.memoize=function(e,t){var n=function(i){var r=n.cache,o=""+(t?t.apply(this,arguments):i);return b(r,o)||(r[o]=e.apply(this,arguments)),r[o]};return n.cache={},n},f.delay=v(function(e,t,n){return setTimeout(function(){return e.apply(null,n)},t)}),f.defer=f.partial(f.delay,f,1),f.throttle=function(e,t,n){var i,r,o,a,s=0;n||(n={});var u=function(){s=!1===n.leading?0:f.now(),i=null,a=e.apply(r,o),i||(r=o=null)},c=function(){var c=f.now();s||!1!==n.leading||(s=c);var l=t-(c-s);return r=this,o=arguments,l<=0||l>t?(i&&(clearTimeout(i),i=null),s=c,a=e.apply(r,o),i||(r=o=null)):i||!1===n.trailing||(i=setTimeout(u,l)),a};return c.cancel=function(){clearTimeout(i),s=0,i=r=o=null},c},f.debounce=function(e,t,n){var i,r,o=function(t,n){i=null,n&&(r=e.apply(t,n))},a=v(function(a){if(i&&clearTimeout(i),n){var s=!i;i=setTimeout(o,t),s&&(r=e.apply(this,a))}else i=f.delay(o,t,this,a);return r});return a.cancel=function(){clearTimeout(i),i=null},a},f.wrap=function(e,t){return f.partial(t,e)},f.negate=function(e){return function(){return!e.apply(this,arguments)}},f.compose=function(){var e=arguments,t=e.length-1;return function(){for(var n=t,i=e[t].apply(this,arguments);n--;)i=e[n].call(this,i);return i}},f.after=function(e,t){return function(){if(--e<1)return t.apply(this,arguments)}},f.before=function(e,t){var n;return function(){return--e>0&&(n=t.apply(this,arguments)),e<=1&&(t=null),n}},f.once=f.partial(f.before,2),f.restArguments=v;var D=!{toString:null}.propertyIsEnumerable("toString"),I=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"],z=function(e,t){var n=I.length,r=e.constructor,o=f.isFunction(r)&&r.prototype||i,a="constructor";for(b(e,a)&&!f.contains(t,a)&&t.push(a);n--;)(a=I[n])in e&&e[a]!==o[a]&&!f.contains(t,a)&&t.push(a)};f.keys=function(e){if(!f.isObject(e))return[];if(l)return l(e);var t=[];for(var n in e)b(e,n)&&t.push(n);return D&&z(e,t),t},f.allKeys=function(e){if(!f.isObject(e))return[];var t=[];for(var n in e)t.push(n);return D&&z(e,t),t},f.values=function(e){for(var t=f.keys(e),n=t.length,i=Array(n),r=0;r<n;r++)i[r]=e[t[r]];return i},f.mapObject=function(e,t,n){t=g(t,n);for(var i=f.keys(e),r=i.length,o={},a=0;a<r;a++){var s=i[a];o[s]=t(e[s],s,e)}return o},f.pairs=function(e){for(var t=f.keys(e),n=t.length,i=Array(n),r=0;r<n;r++)i[r]=[t[r],e[t[r]]];return i},f.invert=function(e){for(var t={},n=f.keys(e),i=0,r=n.length;i<r;i++)t[e[n[i]]]=n[i];return t},f.functions=f.methods=function(e){var t=[];for(var n in e)f.isFunction(e[n])&&t.push(n);return t.sort()};var x=function(e,t){return function(n){var i=arguments.length;if(t&&(n=Object(n)),i<2||null==n)return n;for(var r=1;r<i;r++)for(var o=arguments[r],a=e(o),s=a.length,u=0;u<s;u++){var c=a[u];t&&void 0!==n[c]||(n[c]=o[c])}return n}};f.extend=x(f.allKeys),f.extendOwn=f.assign=x(f.keys),f.findKey=function(e,t,n){t=g(t,n);for(var i,r=f.keys(e),o=0,a=r.length;o<a;o++)if(t(e[i=r[o]],i,e))return i};var L,M,F=function(e,t,n){return t in n};f.pick=v(function(e,t){var n={},i=t[0];if(null==e)return n;f.isFunction(i)?(t.length>1&&(i=m(i,t[1])),t=f.allKeys(e)):(i=F,t=R(t,!1,!1),e=Object(e));for(var r=0,o=t.length;r<o;r++){var a=t[r],s=e[a];i(s,a,e)&&(n[a]=s)}return n}),f.omit=v(function(e,t){var n,i=t[0];return f.isFunction(i)?(i=f.negate(i),t.length>1&&(n=t[1])):(t=f.map(R(t,!1,!1),String),i=function(e,n){return!f.contains(t,n)}),f.pick(e,i,n)}),f.defaults=x(f.allKeys,!0),f.create=function(e,t){var n=y(e);return t&&f.extendOwn(n,t),n},f.clone=function(e){return f.isObject(e)?f.isArray(e)?e.slice():f.extend({},e):e},f.tap=function(e,t){return t(e),e},f.isMatch=function(e,t){var n=f.keys(t),i=n.length;if(null==e)return!i;for(var r=Object(e),o=0;o<i;o++){var a=n[o];if(t[a]!==r[a]||!(a in r))return!1}return!0},L=function(e,t,n,i){if(e===t)return 0!==e||1/e==1/t;if(null==e||null==t)return!1;if(e!=e)return t!=t;var r=typeof e;return("function"===r||"object"===r||"object"==typeof t)&&M(e,t,n,i)},M=function(e,t,n,i){e instanceof f&&(e=e._wrapped),t instanceof f&&(t=t._wrapped);var o=s.call(e);if(o!==s.call(t))return!1;switch(o){case"[object RegExp]":case"[object String]":return""+e==""+t;case"[object Number]":return+e!=+e?+t!=+t:0==+e?1/+e==1/t:+e==+t;case"[object Date]":case"[object Boolean]":return+e==+t;case"[object Symbol]":return r.valueOf.call(e)===r.valueOf.call(t)}var a="[object Array]"===o;if(!a){if("object"!=typeof e||"object"!=typeof t)return!1;var u=e.constructor,c=t.constructor;if(u!==c&&!(f.isFunction(u)&&u instanceof u&&f.isFunction(c)&&c instanceof c)&&"constructor"in e&&"constructor"in t)return!1}n=n||[],i=i||[];for(var l=n.length;l--;)if(n[l]===e)return i[l]===t;if(n.push(e),i.push(t),a){if((l=e.length)!==t.length)return!1;for(;l--;)if(!L(e[l],t[l],n,i))return!1}else{var d,p=f.keys(e);if(l=p.length,f.keys(t).length!==l)return!1;for(;l--;)if(d=p[l],!b(t,d)||!L(e[d],t[d],n,i))return!1}return n.pop(),i.pop(),!0},f.isEqual=function(e,t){return L(e,t)},f.isEmpty=function(e){return null==e||(E(e)&&(f.isArray(e)||f.isString(e)||f.isArguments(e))?0===e.length:0===f.keys(e).length)},f.isElement=function(e){return!(!e||1!==e.nodeType)},f.isArray=c||function(e){return"[object Array]"===s.call(e)},f.isObject=function(e){var t=typeof e;return"function"===t||"object"===t&&!!e},f.each(["Arguments","Function","String","Number","Date","RegExp","Error","Symbol","Map","WeakMap","Set","WeakSet"],function(e){f["is"+e]=function(t){return s.call(t)==="[object "+e+"]"}}),f.isArguments(arguments)||(f.isArguments=function(e){return b(e,"callee")});var V=e.document&&e.document.childNodes;"function"!=typeof/./&&"object"!=typeof Int8Array&&"function"!=typeof V&&(f.isFunction=function(e){return"function"==typeof e||!1}),f.isFinite=function(e){return!f.isSymbol(e)&&isFinite(e)&&!isNaN(parseFloat(e))},f.isNaN=function(e){return f.isNumber(e)&&isNaN(e)},f.isBoolean=function(e){return!0===e||!1===e||"[object Boolean]"===s.call(e)},f.isNull=function(e){return null===e},f.isUndefined=function(e){return void 0===e},f.has=function(e,t){if(!f.isArray(t))return b(e,t);for(var n=t.length,i=0;i<n;i++){var r=t[i];if(null==e||!u.call(e,r))return!1;e=e[r]}return!!n},f.noConflict=function(){return e._=t,this},f.identity=function(e){return e},f.constant=function(e){return function(){return e}},f.noop=function(){},f.property=function(e){return f.isArray(e)?function(t){return w(t,e)}:_(e)},f.propertyOf=function(e){return null==e?function(){}:function(t){return f.isArray(t)?w(e,t):e[t]}},f.matcher=f.matches=function(e){return e=f.extendOwn({},e),function(t){return f.isMatch(t,e)}},f.times=function(e,t,n){var i=Array(Math.max(0,e));t=m(t,n,1);for(var r=0;r<e;r++)i[r]=t(r);return i},f.random=function(e,t){return null==t&&(t=e,e=0),e+Math.floor(Math.random()*(t-e+1))},f.now=Date.now||function(){return(new Date).getTime()};var j={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},B=f.invert(j),q=function(e){var t=function(t){return e[t]},n="(?:"+f.keys(e).join("|")+")",i=RegExp(n),r=RegExp(n,"g");return function(e){return e=null==e?"":""+e,i.test(e)?e.replace(r,t):e}};f.escape=q(j),f.unescape=q(B),f.result=function(e,t,n){f.isArray(t)||(t=[t]);var i=t.length;if(!i)return f.isFunction(n)?n.call(e):n;for(var r=0;r<i;r++){var o=null==e?void 0:e[t[r]];void 0===o&&(o=n,r=i),e=f.isFunction(o)?o.call(e):o}return e};var U=0;f.uniqueId=function(e){var t=++U+"";return e?e+t:t},f.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var H=/(.)^/,G={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},W=/\\|'|\r|\n|\u2028|\u2029/g,$=function(e){return"\\"+G[e]};f.template=function(e,t,n){!t&&n&&(t=n),t=f.defaults({},t,f.templateSettings);var i,r=RegExp([(t.escape||H).source,(t.interpolate||H).source,(t.evaluate||H).source].join("|")+"|$","g"),o=0,a="__p+='";e.replace(r,function(t,n,i,r,s){return a+=e.slice(o,s).replace(W,$),o=s+t.length,n?a+="'+\n((__t=("+n+"))==null?'':_.escape(__t))+\n'":i?a+="'+\n((__t=("+i+"))==null?'':__t)+\n'":r&&(a+="';\n"+r+"\n__p+='"),t}),a+="';\n",t.variable||(a="with(obj||{}){\n"+a+"}\n"),a="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+a+"return __p;\n";try{i=new Function(t.variable||"obj","_",a)}catch(e){throw e.source=a,e}var s=function(e){return i.call(this,e,f)},u=t.variable||"obj";return s.source="function("+u+"){\n"+a+"}",s},f.chain=function(e){var t=f(e);return t._chain=!0,t};var Y=function(e,t){return e._chain?f(t).chain():t};f.mixin=function(e){return f.each(f.functions(e),function(t){var n=f[t]=e[t];f.prototype[t]=function(){var e=[this._wrapped];return o.apply(e,arguments),Y(this,n.apply(f,e))}}),f},f.mixin(f),f.each(["pop","push","reverse","shift","sort","splice","unshift"],function(e){var t=n[e];f.prototype[e]=function(){var n=this._wrapped;return t.apply(n,arguments),"shift"!==e&&"splice"!==e||0!==n.length||delete n[0],Y(this,n)}}),f.each(["concat","join","slice"],function(e){var t=n[e];f.prototype[e]=function(){return Y(this,t.apply(this._wrapped,arguments))}}),f.prototype.value=function(){return this._wrapped},f.prototype.valueOf=f.prototype.toJSON=f.prototype.value,f.prototype.toString=function(){return String(this._wrapped)},"function"==typeof define&&define.amd&&define("underscore",[],function(){return f})}(),function(){var e,t=this,n=t.Backbone,i=[],r=i.push,o=i.slice,a=i.splice;(e="undefined"!=typeof exports?exports:t.Backbone={}).VERSION="1.0.0";var s=t._;s||"undefined"==typeof require||(s=require("underscore")),e.$=t.jQuery||t.Zepto||t.ender||t.$,e.noConflict=function(){return t.Backbone=n,this},e.emulateHTTP=!1,e.emulateJSON=!1;var u=e.Events={on:function(e,t,n){return l(this,"on",e,[t,n])&&t?(this._events||(this._events={}),(this._events[e]||(this._events[e]=[])).push({callback:t,context:n,ctx:n||this}),this):this},once:function(e,t,n){if(!l(this,"once",e,[t,n])||!t)return this;var i=this,r=s.once(function(){i.off(e,r),t.apply(this,arguments)});return r._callback=t,this.on(e,r,n)},off:function(e,t,n){var i,r,o,a,u,c,d,p;if(!this._events||!l(this,"off",e,[t,n]))return this;if(!e&&!t&&!n)return this._events={},this;for(u=0,c=(a=e?[e]:s.keys(this._events)).length;u<c;u++)if(e=a[u],o=this._events[e]){if(this._events[e]=i=[],t||n)for(d=0,p=o.length;d<p;d++)r=o[d],(t&&t!==r.callback&&t!==r.callback._callback||n&&n!==r.context)&&i.push(r);i.length||delete this._events[e]}return this},trigger:function(e){if(!this._events)return this;var t=o.call(arguments,1);if(!l(this,"trigger",e,t))return this;var n=this._events[e],i=this._events.all;return n&&d(n,t),i&&d(i,arguments),this},stopListening:function(e,t,n){var i=this._listeners;if(!i)return this;var r=!t&&!n;for(var o in"object"==typeof t&&(n=this),e&&((i={})[e._listenerId]=e),i)i[o].off(t,n,this),r&&delete this._listeners[o];return this}},c=/\s+/,l=function(e,t,n,i){if(!n)return!0;if("object"==typeof n){for(var r in n)e[t].apply(e,[r,n[r]].concat(i));return!1}if(c.test(n)){for(var o=n.split(c),a=0,s=o.length;a<s;a++)e[t].apply(e,[o[a]].concat(i));return!1}return!0},d=function(e,t){var n,i=-1,r=e.length,o=t[0],a=t[1],s=t[2];switch(t.length){case 0:for(;++i<r;)(n=e[i]).callback.call(n.ctx);return;case 1:for(;++i<r;)(n=e[i]).callback.call(n.ctx,o);return;case 2:for(;++i<r;)(n=e[i]).callback.call(n.ctx,o,a);return;case 3:for(;++i<r;)(n=e[i]).callback.call(n.ctx,o,a,s);return;default:for(;++i<r;)(n=e[i]).callback.apply(n.ctx,t)}};s.each({listenTo:"on",listenToOnce:"once"},function(e,t){u[t]=function(t,n,i){return(this._listeners||(this._listeners={}))[t._listenerId||(t._listenerId=s.uniqueId("l"))]=t,"object"==typeof n&&(i=this),t[e](n,i,this),this}}),u.bind=u.on,u.unbind=u.off,s.extend(e,u);var p=e.Model=function(e,t){var n,i=e||{};t||(t={}),this.cid=s.uniqueId("c"),this.attributes={},s.extend(this,s.pick(t,f)),t.parse&&(i=this.parse(i,t)||{}),(n=s.result(this,"defaults"))&&(i=s.defaults({},i,n)),this.set(i,t),this.changed={},this.initialize.apply(this,arguments)},f=["url","urlRoot","collection"];s.extend(p.prototype,u,{changed:null,validationError:null,idAttribute:"id",initialize:function(){},toJSON:function(e){return s.clone(this.attributes)},sync:function(){return e.sync.apply(this,arguments)},get:function(e){return this.attributes[e]},escape:function(e){return s.escape(this.get(e))},has:function(e){return null!=this.get(e)},set:function(e,t,n){var i,r,o,a,u,c,l,d;if(null==e)return this;if("object"==typeof e?(r=e,n=t):(r={})[e]=t,n||(n={}),!this._validate(r,n))return!1;for(i in o=n.unset,u=n.silent,a=[],c=this._changing,this._changing=!0,c||(this._previousAttributes=s.clone(this.attributes),this.changed={}),d=this.attributes,l=this._previousAttributes,this.idAttribute in r&&(this.id=r[this.idAttribute]),r)t=r[i],s.isEqual(d[i],t)||a.push(i),s.isEqual(l[i],t)?delete this.changed[i]:this.changed[i]=t,o?delete d[i]:d[i]=t;if(!u){a.length&&(this._pending=!0);for(var p=0,f=a.length;p<f;p++)this.trigger("change:"+a[p],this,d[a[p]],n)}if(c)return this;if(!u)for(;this._pending;)this._pending=!1,this.trigger("change",this,n);return this._pending=!1,this._changing=!1,this},unset:function(e,t){return this.set(e,void 0,s.extend({},t,{unset:!0}))},clear:function(e){var t={};for(var n in this.attributes)t[n]=void 0;return this.set(t,s.extend({},e,{unset:!0}))},hasChanged:function(e){return null==e?!s.isEmpty(this.changed):s.has(this.changed,e)},changedAttributes:function(e){if(!e)return!!this.hasChanged()&&s.clone(this.changed);var t,n=!1,i=this._changing?this._previousAttributes:this.attributes;for(var r in e)s.isEqual(i[r],t=e[r])||((n||(n={}))[r]=t);return n},previous:function(e){return null!=e&&this._previousAttributes?this._previousAttributes[e]:null},previousAttributes:function(){return s.clone(this._previousAttributes)},fetch:function(e){void 0===(e=e?s.clone(e):{}).parse&&(e.parse=!0);var t=this,n=e.success;return e.success=function(i){if(!t.set(t.parse(i,e),e))return!1;n&&n(t,i,e),t.trigger("sync",t,i,e)},D(this,e),this.sync("read",this,e)},save:function(e,t,n){var i,r,o,a=this.attributes;if(null==e||"object"==typeof e?(i=e,n=t):(i={})[e]=t,i&&(!n||!n.wait)&&!this.set(i,n))return!1;if(n=s.extend({validate:!0},n),!this._validate(i,n))return!1;i&&n.wait&&(this.attributes=s.extend({},a,i)),void 0===n.parse&&(n.parse=!0);var u=this,c=n.success;return n.success=function(e){u.attributes=a;var t=u.parse(e,n);if(n.wait&&(t=s.extend(i||{},t)),s.isObject(t)&&!u.set(t,n))return!1;c&&c(u,e,n),u.trigger("sync",u,e,n)},D(this,n),"patch"===(r=this.isNew()?"create":n.patch?"patch":"update")&&(n.attrs=i),o=this.sync(r,this,n),i&&n.wait&&(this.attributes=a),o},destroy:function(e){var t=this,n=(e=e?s.clone(e):{}).success,i=function(){t.trigger("destroy",t,t.collection,e)};if(e.success=function(r){(e.wait||t.isNew())&&i(),n&&n(t,r,e),t.isNew()||t.trigger("sync",t,r,e)},this.isNew())return e.success(),!1;D(this,e);var r=this.sync("delete",this,e);return e.wait||i(),r},url:function(){var e=s.result(this,"urlRoot")||s.result(this.collection,"url")||O();return this.isNew()?e:e+("/"===e.charAt(e.length-1)?"":"/")+encodeURIComponent(this.id)},parse:function(e,t){return e},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return null==this.id},isValid:function(e){return this._validate({},s.extend(e||{},{validate:!0}))},_validate:function(e,t){if(!t.validate||!this.validate)return!0;e=s.extend({},this.attributes,e);var n=this.validationError=this.validate(e,t)||null;return!n||(this.trigger("invalid",this,n,s.extend(t||{},{validationError:n})),!1)}});s.each(["keys","values","pairs","invert","pick","omit"],function(e){p.prototype[e]=function(){var t=o.call(arguments);return t.unshift(this.attributes),s[e].apply(s,t)}});var h=e.Collection=function(e,t){t||(t={}),t.url&&(this.url=t.url),t.model&&(this.model=t.model),void 0!==t.comparator&&(this.comparator=t.comparator),this._reset(),this.initialize.apply(this,arguments),e&&this.reset(e,s.extend({silent:!0},t))},m={add:!0,remove:!0,merge:!0},g={add:!0,merge:!1,remove:!1};s.extend(h.prototype,u,{model:p,initialize:function(){},toJSON:function(e){return this.map(function(t){return t.toJSON(e)})},sync:function(){return e.sync.apply(this,arguments)},add:function(e,t){return this.set(e,s.defaults(t||{},g))},remove:function(e,t){var n,i,r,o;for(e=s.isArray(e)?e.slice():[e],t||(t={}),n=0,i=e.length;n<i;n++)(o=this.get(e[n]))&&(delete this._byId[o.id],delete this._byId[o.cid],r=this.indexOf(o),this.models.splice(r,1),this.length--,t.silent||(t.index=r,o.trigger("remove",o,this,t)),this._removeReference(o));return this},set:function(e,t){var n,i,o,u,c;(t=s.defaults(t||{},m)).parse&&(e=this.parse(e,t)),s.isArray(e)||(e=e?[e]:[]);var l=t.at,d=this.comparator&&null==l&&!1!==t.sort,p=s.isString(this.comparator)?this.comparator:null,f=[],h=[],g={};for(n=0,i=e.length;n<i;n++)(o=this._prepareModel(e[n],t))&&((u=this.get(o))?(t.remove&&(g[u.cid]=!0),t.merge&&(u.set(o.attributes,t),d&&!c&&u.hasChanged(p)&&(c=!0))):t.add&&(f.push(o),o.on("all",this._onModelEvent,this),this._byId[o.cid]=o,null!=o.id&&(this._byId[o.id]=o)));if(t.remove){for(n=0,i=this.length;n<i;++n)g[(o=this.models[n]).cid]||h.push(o);h.length&&this.remove(h,t)}if(f.length&&(d&&(c=!0),this.length+=f.length,null!=l?a.apply(this.models,[l,0].concat(f)):r.apply(this.models,f)),c&&this.sort({silent:!0}),t.silent)return this;for(n=0,i=f.length;n<i;n++)(o=f[n]).trigger("add",o,this,t);return c&&this.trigger("sort",this,t),this},reset:function(e,t){t||(t={});for(var n=0,i=this.models.length;n<i;n++)this._removeReference(this.models[n]);return t.previousModels=this.models,this._reset(),this.add(e,s.extend({silent:!0},t)),t.silent||this.trigger("reset",this,t),this},push:function(e,t){return e=this._prepareModel(e,t),this.add(e,s.extend({at:this.length},t)),e},pop:function(e){var t=this.at(this.length-1);return this.remove(t,e),t},unshift:function(e,t){return e=this._prepareModel(e,t),this.add(e,s.extend({at:0},t)),e},shift:function(e){var t=this.at(0);return this.remove(t,e),t},slice:function(e,t){return this.models.slice(e,t)},get:function(e){if(null!=e)return this._byId[null!=e.id?e.id:e.cid||e]},at:function(e){return this.models[e]},where:function(e,t){return s.isEmpty(e)?t?void 0:[]:this[t?"find":"filter"](function(t){for(var n in e)if(e[n]!==t.get(n))return!1;return!0})},findWhere:function(e){return this.where(e,!0)},sort:function(e){if(!this.comparator)throw new Error("Cannot sort a set without a comparator");return e||(e={}),s.isString(this.comparator)||1===this.comparator.length?this.models=this.sortBy(this.comparator,this):this.models.sort(s.bind(this.comparator,this)),e.silent||this.trigger("sort",this,e),this},sortedIndex:function(e,t,n){t||(t=this.comparator);var i=s.isFunction(t)?t:function(e){return e.get(t)};return s.sortedIndex(this.models,e,i,n)},pluck:function(e){return s.invoke(this.models,"get",e)},fetch:function(e){void 0===(e=e?s.clone(e):{}).parse&&(e.parse=!0);var t=e.success,n=this;return e.success=function(i){var r=e.reset?"reset":"set";n[r](i,e),t&&t(n,i,e),n.trigger("sync",n,i,e)},D(this,e),this.sync("read",this,e)},create:function(e,t){if(t=t?s.clone(t):{},!(e=this._prepareModel(e,t)))return!1;t.wait||this.add(e,t);var n=this,i=t.success;return t.success=function(r){t.wait&&n.add(e,t),i&&i(e,r,t)},e.save(null,t),e},parse:function(e,t){return e},clone:function(){return new this.constructor(this.models)},_reset:function(){this.length=0,this.models=[],this._byId={}},_prepareModel:function(e,t){if(e instanceof p)return e.collection||(e.collection=this),e;t||(t={}),t.collection=this;var n=new this.model(e,t);return n._validate(e,t)?n:(this.trigger("invalid",this,e,t),!1)},_removeReference:function(e){this===e.collection&&delete e.collection,e.off("all",this._onModelEvent,this)},_onModelEvent:function(e,t,n,i){("add"!==e&&"remove"!==e||n===this)&&("destroy"===e&&this.remove(t,i),t&&e==="change:"+t.idAttribute&&(delete this._byId[t.previous(t.idAttribute)],null!=t.id&&(this._byId[t.id]=t)),this.trigger.apply(this,arguments))}});s.each(["forEach","each","map","collect","reduce","foldl","inject","reduceRight","foldr","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","toArray","size","first","head","take","initial","rest","tail","drop","last","without","indexOf","shuffle","lastIndexOf","isEmpty","chain"],function(e){h.prototype[e]=function(){var t=o.call(arguments);return t.unshift(this.models),s[e].apply(s,t)}});s.each(["groupBy","countBy","sortBy"],function(e){h.prototype[e]=function(t,n){var i=s.isFunction(t)?t:function(e){return e.get(t)};return s[e](this.models,i,n)}});var v=e.View=function(e){this.cid=s.uniqueId("view"),this._configure(e||{}),this._ensureElement(),this.initialize.apply(this,arguments),this.delegateEvents()},y=/^(\S+)\s*(.*)$/,_=["model","collection","el","id","attributes","className","tagName","events"];s.extend(v.prototype,u,{tagName:"div",$:function(e){return this.$el.find(e)},initialize:function(){},render:function(){return this},remove:function(){return this.$el.remove(),this.stopListening(),this},setElement:function(t,n){return this.$el&&this.undelegateEvents(),this.$el=t instanceof e.$?t:e.$(t),this.el=this.$el[0],!1!==n&&this.delegateEvents(),this},delegateEvents:function(e){if(!e&&!(e=s.result(this,"events")))return this;for(var t in this.undelegateEvents(),e){var n=e[t];if(s.isFunction(n)||(n=this[e[t]]),n){var i=t.match(y),r=i[1],o=i[2];n=s.bind(n,this),r+=".delegateEvents"+this.cid,""===o?this.$el.on(r,n):this.$el.on(r,o,n)}}return this},undelegateEvents:function(){return this.$el.off(".delegateEvents"+this.cid),this},_configure:function(e){this.options&&(e=s.extend({},s.result(this,"options"),e)),s.extend(this,s.pick(e,_)),this.options=e},_ensureElement:function(){if(this.el)this.setElement(s.result(this,"el"),!1);else{var t=s.extend({},s.result(this,"attributes"));this.id&&(t.id=s.result(this,"id")),this.className&&(t.class=s.result(this,"className"));var n=e.$("<"+s.result(this,"tagName")+">").attr(t);this.setElement(n,!1)}}}),e.sync=function(t,n,i){var r=b[t];s.defaults(i||(i={}),{emulateHTTP:e.emulateHTTP,emulateJSON:e.emulateJSON});var o={type:r,dataType:"json"};if(i.url||(o.url=s.result(n,"url")||O()),null!=i.data||!n||"create"!==t&&"update"!==t&&"patch"!==t||(o.contentType="application/json",o.data=JSON.stringify(i.attrs||n.toJSON(i))),i.emulateJSON&&(o.contentType="application/x-www-form-urlencoded",o.data=o.data?{model:o.data}:{}),i.emulateHTTP&&("PUT"===r||"DELETE"===r||"PATCH"===r)){o.type="POST",i.emulateJSON&&(o.data._method=r);var a=i.beforeSend;i.beforeSend=function(e){if(e.setRequestHeader("X-HTTP-Method-Override",r),a)return a.apply(this,arguments)}}"GET"===o.type||i.emulateJSON||(o.processData=!1),"PATCH"!==o.type||!window.ActiveXObject||window.external&&window.external.msActiveXFilteringEnabled||(o.xhr=function(){return new ActiveXObject("Microsoft.XMLHTTP")});var u=i.xhr=e.ajax(s.extend(o,i));return n.trigger("request",n,u,i),u};var b={create:"POST",update:"PUT",patch:"PATCH",delete:"DELETE",read:"GET"};e.ajax=function(){return e.$.ajax.apply(e.$,arguments)};var w=e.Router=function(e){e||(e={}),e.routes&&(this.routes=e.routes),this._bindRoutes(),this.initialize.apply(this,arguments)},A=/\((.*?)\)/g,k=/(\(\?)?:\w+/g,E=/\*\w+/g,T=/[\-{}\[\]+?.,\\\^$|#\s]/g;s.extend(w.prototype,u,{initialize:function(){},route:function(t,n,i){s.isRegExp(t)||(t=this._routeToRegExp(t)),s.isFunction(n)&&(i=n,n=""),i||(i=this[n]);var r=this;return e.history.route(t,function(o){var a=r._extractParameters(t,o);i&&i.apply(r,a),r.trigger.apply(r,["route:"+n].concat(a)),r.trigger("route",n,a),e.history.trigger("route",r,n,a)}),this},navigate:function(t,n){return e.history.navigate(t,n),this},_bindRoutes:function(){if(this.routes){this.routes=s.result(this,"routes");for(var e,t=s.keys(this.routes);null!=(e=t.pop());)this.route(e,this.routes[e])}},_routeToRegExp:function(e){return e=e.replace(T,"\\$&").replace(A,"(?:$1)?").replace(k,function(e,t){return t?e:"([^/]+)"}).replace(E,"(.*?)"),new RegExp("^"+e+"$")},_extractParameters:function(e,t){var n=e.exec(t).slice(1);return s.map(n,function(e){return e?decodeURIComponent(e):null})}});var S=e.History=function(){this.handlers=[],s.bindAll(this,"checkUrl"),"undefined"!=typeof window&&(this.location=window.location,this.history=window.history)},C=/^[#\/]|\s+$/g,R=/^\/+|\/+$/g,P=/msie [\w.]+/,N=/\/$/;S.started=!1,s.extend(S.prototype,u,{interval:50,getHash:function(e){var t=(e||this).location.href.match(/#(.*)$/);return t?t[1]:""},getFragment:function(e,t){if(null==e)if(this._hasPushState||!this._wantsHashChange||t){e=this.location.pathname;var n=this.root.replace(N,"");e.indexOf(n)||(e=e.substr(n.length))}else e=this.getHash();return e.replace(C,"")},start:function(t){if(S.started)throw new Error("Backbone.history has already been started");S.started=!0,this.options=s.extend({},{root:"/"},this.options,t),this.root=this.options.root,this._wantsHashChange=!1!==this.options.hashChange,this._wantsPushState=!!this.options.pushState,this._hasPushState=!!(this.options.pushState&&this.history&&this.history.pushState);var n=this.getFragment(),i=document.documentMode,r=P.exec(navigator.userAgent.toLowerCase())&&(!i||i<=7);this.root=("/"+this.root+"/").replace(R,"/"),r&&this._wantsHashChange&&(this.iframe=e.$('<iframe src="javascript:0" tabindex="-1" />').hide().appendTo("body")[0].contentWindow,this.navigate(n)),this._hasPushState?e.$(window).on("popstate",this.checkUrl):this._wantsHashChange&&"onhashchange"in window&&!r?e.$(window).on("hashchange",this.checkUrl):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),this.fragment=n;var o=this.location,a=o.pathname.replace(/[^\/]$/,"$&/")===this.root;return this._wantsHashChange&&this._wantsPushState&&!this._hasPushState&&!a?(this.fragment=this.getFragment(null,!0),this.location.replace(this.root+this.location.search+"#"+this.fragment),!0):(this._wantsPushState&&this._hasPushState&&a&&o.hash&&(this.fragment=this.getHash().replace(C,""),this.history.replaceState({},document.title,this.root+this.fragment+o.search)),this.options.silent?void 0:this.loadUrl())},stop:function(){e.$(window).off("popstate",this.checkUrl).off("hashchange",this.checkUrl),clearInterval(this._checkUrlInterval),S.started=!1},route:function(e,t){this.handlers.unshift({route:e,callback:t})},checkUrl:function(e){var t=this.getFragment();if(t===this.fragment&&this.iframe&&(t=this.getFragment(this.getHash(this.iframe))),t===this.fragment)return!1;this.iframe&&this.navigate(t),this.loadUrl()||this.loadUrl(this.getHash())},loadUrl:function(e){var t=this.fragment=this.getFragment(e);return s.any(this.handlers,function(e){if(e.route.test(t))return e.callback(t),!0})},navigate:function(e,t){if(!S.started)return!1;if(t&&!0!==t||(t={trigger:t}),e=this.getFragment(e||""),this.fragment!==e){this.fragment=e;var n=this.root+e;if(this._hasPushState)this.history[t.replace?"replaceState":"pushState"]({},document.title,n);else{if(!this._wantsHashChange)return this.location.assign(n);this._updateHash(this.location,e,t.replace),this.iframe&&e!==this.getFragment(this.getHash(this.iframe))&&(t.replace||this.iframe.document.open().close(),this._updateHash(this.iframe.location,e,t.replace))}t.trigger&&this.loadUrl(e)}},_updateHash:function(e,t,n){if(n){var i=e.href.replace(/(javascript:|#).*$/,"");e.replace(i+"#"+t)}else e.hash="#"+t}}),e.history=new S;p.extend=h.extend=w.extend=v.extend=S.extend=function(e,t){var n,i=this;n=e&&s.has(e,"constructor")?e.constructor:function(){return i.apply(this,arguments)},s.extend(n,i,t);var r=function(){this.constructor=n};return r.prototype=i.prototype,n.prototype=new r,e&&s.extend(n.prototype,e),n.__super__=i.prototype,n};var O=function(){throw new Error('A "url" property or function must be specified')},D=function(e,t){var n=t.error;t.error=function(i){n&&n(e,i,t),e.trigger("error",e,i,t)}}}.call(this),define("backbone",["underscore","jquery"],function(e){return function(){return e.Backbone}}(this)),function(e,t){"use strict";var n=e.Backbone;if("function"==typeof define&&define.amd)return define("backbone.layout",["backbone","underscore","jquery"],function(){return t.apply(e,arguments)});n.Layout=t.call(e,n,e._,n.$)}("object"==typeof global?global:this,function(e,t,n){"use strict";var i=this,r=e.View,o=Array.prototype.push,a=Array.prototype.concat,s=Array.prototype.splice,u=String.prototype.trim?t.bind(String.prototype.trim.call,String.prototype.trim):n.trim,c=e.View.extend({_render:function(){var e=this,t=e.__manager__,n=e.beforeRender,i=e.deferred();return e.hasRendered&&e._removeViews(),t.callback=function(){delete t.isAsync,delete t.callback,e.trigger("beforeRender",e),e._viewRender(t).render().then(function(){i.resolve()})},n&&n.call(e,e),t.isAsync||t.callback(),i.promise()},_applyTemplate:function(e,i,r){t.isString(e)&&(i.noel?(e=n.parseHTML(e,!0),this.$el.slice(1).remove(),this.$el.replaceWith(e),this.setElement(e,!1)):this.html(this.$el,e)),r.resolveWith(this,[this])},_viewRender:function(e){var n,i,r,o=this;function a(t,i){var a;e.callback=function(t){delete e.isAsync,delete e.callback,o._applyTemplate(t,e,r)},c.cache(n,i),i&&(a=o.renderTemplate.call(o,i,t)),e.isAsync||o._applyTemplate(a,e,r)}return{render:function(){var s=o.serialize,u=o.template;return r=o.deferred(),t.isFunction(s)&&(s=s.call(o)),e.callback=function(t){delete e.isAsync,delete e.callback,a(s,t)},"string"==typeof u&&(n=o.prefix+u),(i=c.cache(n))?(a(s,i),r):("string"==typeof u?i=o.fetchTemplate.call(o,o.prefix+u):"function"==typeof u?i=u:null!=u&&(i=o.fetchTemplate.call(o,u)),e.isAsync||a(s,i),r)}}},constructor:function(n){this.manage=!0,t.extend(this,n),e.View.apply(this,arguments)},async:function(){var e=this.__manager__;return e.isAsync=!0,e.callback},promise:function(){return this.__manager__.renderDeferred.promise()},renderViews:function(){var e=this,t=e.__manager__,n=e.deferred(),i=e.getViews().map(function(e){return e.render().__manager__.renderDeferred}).value();return t.renderDeferred=n.promise(),e.when(i).then(function(){n.resolveWith(e,[e])}),e},insertView:function(t,n,i){return n instanceof e.View?this.setView(t,n,!0,i):this.setView(t,!0,n)},insertViews:function(e){return t.isArray(e)?this.setViews({"":e}):(t.each(e,function(n,i){e[i]=t.isArray(n)?n:[n]}),this.setViews(e))},getView:function(e){return null==e&&(e=arguments[1]),this.getViews(e).first().value()},getViews:function(e){var n;return"string"==typeof e?(e=this.sections[e]||e,n=this.views[e]||[],t.chain([].concat(n))):(n=t.chain(this.views).map(function(e){return t.isArray(e)?e:[e]},this).flatten(),"object"==typeof e?n.where(e):"function"==typeof e?n.filter(e):n)},removeView:function(e){return this.getViews(e).each(function(e){e.remove()})},setView:function(e,n,i,r){var o,s,u;if("string"!=typeof e&&(r=i,i=n,n=e,e=""),!(o=n.__manager__))throw new Error("The argument associated with selector '"+e+"' is defined and a View.  Set `manage` property to true for Backbone.View instances.");return o.parent=this,s=o.selector=this.sections[e]||e,u=this.views[s],i?(this.views[s]=a.call([],this.views[e]||[],n),r&&t.isNumber(r.insertAt)&&u?(u.splice(r.insertAt,0,n),this.views[s]=u,o.insertAt=r.insertAt):this.views[s]=a.call([],u||[],n),this.__manager__.insert=!0,n):(n.hasRendered&&n.partial(this.$el,n.$el,this.__manager__,o),this.removeView(e),this.views[s]=n)},setViews:function(e){return t.each(e,function(e,n){if(t.isArray(e))return t.each(e,function(e){this.insertView(n,e)},this);this.setView(n,e)},this),this},render:function(){var e=this,n=e.__manager__,r=n.parent,a=r&&r.__manager__,s=e.deferred();function u(){var o;function u(){var r=i.console,o=e.afterRender;o&&o.call(e,e),e.trigger("afterRender",e),n.noel&&e.$el.length>1&&t.isFunction(r.warn)&&!e.suppressWarnings&&(r.warn("`el: false` with multiple top level elements is not supported."),t.isFunction(r.trace)&&r.trace())}return t.each(e.views,function(n,i){t.isArray(n)&&e.htmlBatch(e,n,i)}),r&&!n.insertedViaFragment&&(e.contains(r.el,e.el)||r.partial(r.$el,e.$el,a,n)),e.delegateEvents(),e.hasRendered=!0,(o=n.queue.shift())?o():delete n.queue,a&&a.queue?r.once("afterRender",u):u(),s.resolveWith(e,[e])}function c(){e._render().done(function(){if(!t.keys(e.views).length)return u();var n=t.map(e.views,function(n){var i=t.isArray(n);return i&&n.length?e.when(t.map(n,function(e){return e.__manager__.insertedViaFragment=!0,e.render().__manager__.renderDeferred})):i?n:n.render().__manager__.renderDeferred});e.when(n).done(u)})}return n.queue?o.call(n.queue,c):(n.queue=[],c()),e.__manager__.renderDeferred=s,e},remove:function(){return this.trigger("remove",this),c._removeView(this,!0),this._remove.apply(this,arguments)}},{_cache:{},_removeViews:function(e,t){"boolean"==typeof e&&(t=e,e=this),(e=e||this).getViews().each(function(e){(e.hasRendered||t)&&c._removeView(e,t)})},_removeView:function(e,n){var i,r=e.__manager__,o=r.parent&&r.parent.__manager__;if(!("boolean"==typeof e.keep?e.keep:e.options.keep)&&o&&!0===o.insert||n){if(c.cleanViews(e),e._removeViews(!0),e.$el.remove(),!r.parent)return;if(i=r.parent.views[r.selector],t.isArray(i))return t.each(t.clone(i),function(e,t){e&&e.__manager__===r&&s.call(i,t,1)});delete r.parent.views[r.selector]}},cache:function(e,t){return e in this._cache&&null==t?this._cache[e]:null!=e&&null!=t?this._cache[e]=t:void 0},cleanViews:function(n){t.each(a.call([],n),function(n){n.unbind(),n.model instanceof e.Model&&n.model.off(null,null,n),n.collection instanceof e.Collection&&n.collection.off(null,null,n),n.stopListening(),t.isFunction(n.cleanup)&&n.cleanup()})},configure:function(n){t.extend(c.prototype,n),n.manage&&(e.View.prototype.manage=!0),!1===n.el&&(e.View.prototype.el=!1),!0===n.suppressWarnings&&(e.View.prototype.suppressWarnings=!0)},setupView:function(n,i){i=i||{},t.each(a.call([],n),function(n){if(!n.__manager__){var r,o,a=c.prototype;t.defaults(n,{views:{},sections:{},__manager__:{},_removeViews:c._removeViews,_removeView:c._removeView},c.prototype),n.options=i,t.extend(n,i),n._remove=e.View.prototype.remove,n.render=c.prototype.render,n.remove!==a.remove&&(n._remove=n.remove,n.remove=a.remove),r=i.views||n.views,t.keys(r).length&&(o=r,n.views={},t.each(o,function(e,t){"function"==typeof e&&(o[t]=e.call(n,n))}),n.setViews(o))}})}});c.VERSION="0.9.4",e.Layout=c,e.View=function(e){var t;("el"in(e=e||{})?!1===e.el:!1===this.el)&&(t=!0),(e.manage||this.manage)&&c.setupView(this,e),this.__manager__&&(this.__manager__.noel=t,this.__manager__.suppressWarnings=e.suppressWarnings),r.apply(this,arguments)},e.View.extend=r.extend,e.View.prototype=r.prototype;var l={prefix:"",deferred:function(){return n.Deferred()},fetchTemplate:function(e){return t.template(n(e).html())},renderTemplate:function(e,t){return u(e.call(this,t))},serialize:function(){return this.model?t.clone(this.model.attributes):{}},partial:function(e,t,n,i){var r;i.selector&&(e=n.noel&&(r=e.filter(i.selector)).length?r:e.find(i.selector)),n.insert?this.insert(e,t,i.insertAt,i.selector):this.html(e,t)},html:function(e,t){e.html(t)},htmlBatch:function(e,i,r){var o=e.__manager__,a={selector:r},s=t.reduce(i,function(t,i){var r=("boolean"==typeof i.keep?i.keep:i.options.keep)&&n.contains(e.el,i.el);return i.el&&!r&&t.push(i.el),t},[]);return this.partial(e.$el,n(s),o,a)},insert:function(e,n,i,r){t.isNumber(i)?this.insertAtIndex(e,n,i,r):e.append(n)},insertAtIndex:function(e,t,n,i){var r,o=e.children();r=n<0?o.eq(Math.max(0,o.length+n)):o.eq(n);var a=this.views[i];n<0?n=Math.max(0,a.length-1+n):n+=1;var s=a[n];s?s.el.parentNode?t.insertBefore(s.$el):r.length?r.before(t):e.append(t):e.append(t)},when:function(e){return n.when.apply(null,e)},contains:function(e,t){return n.contains(e,t)}};return t.extend(c.prototype,l),c}),function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define("moment",t):e.moment=t()}(this,function(){"use strict";var e;function t(){return e.apply(null,arguments)}function n(e){return e instanceof Array||"[object Array]"===Object.prototype.toString.call(e)}function i(e){return null!=e&&"[object Object]"===Object.prototype.toString.call(e)}function r(e){return"number"==typeof e||"[object Number]"===Object.prototype.toString.call(e)}function o(e){return e instanceof Date||"[object Date]"===Object.prototype.toString.call(e)}function a(e,t){var n,i=[];for(n=0;n<e.length;++n)i.push(t(e[n],n));return i}function s(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function u(e,t){for(var n in t)s(t,n)&&(e[n]=t[n]);return s(t,"toString")&&(e.toString=t.toString),s(t,"valueOf")&&(e.valueOf=t.valueOf),e}function c(e,t,n,i){return kt(e,t,n,i,!0).utc()}function l(e){return null==e._pf&&(e._pf={empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],meridiem:null}),e._pf}var d=Array.prototype.some?Array.prototype.some:function(e){for(var t=Object(this),n=t.length>>>0,i=0;i<n;i++)if(i in t&&e.call(this,t[i],i,t))return!0;return!1};function p(e){if(null==e._isValid){var t=l(e),n=d.call(t.parsedDateParts,function(e){return null!=e}),i=!isNaN(e._d.getTime())&&t.overflow<0&&!t.empty&&!t.invalidMonth&&!t.invalidWeekday&&!t.nullInput&&!t.invalidFormat&&!t.userInvalidated&&(!t.meridiem||t.meridiem&&n);if(e._strict&&(i=i&&0===t.charsLeftOver&&0===t.unusedTokens.length&&void 0===t.bigHour),null!=Object.isFrozen&&Object.isFrozen(e))return i;e._isValid=i}return e._isValid}function f(e){var t=c(NaN);return null!=e?u(l(t),e):l(t).userInvalidated=!0,t}function h(e){return void 0===e}var m=t.momentProperties=[];function g(e,t){var n,i,r;if(h(t._isAMomentObject)||(e._isAMomentObject=t._isAMomentObject),h(t._i)||(e._i=t._i),h(t._f)||(e._f=t._f),h(t._l)||(e._l=t._l),h(t._strict)||(e._strict=t._strict),h(t._tzm)||(e._tzm=t._tzm),h(t._isUTC)||(e._isUTC=t._isUTC),h(t._offset)||(e._offset=t._offset),h(t._pf)||(e._pf=l(t)),h(t._locale)||(e._locale=t._locale),m.length>0)for(n in m)h(r=t[i=m[n]])||(e[i]=r);return e}var v=!1;function y(e){g(this,e),this._d=new Date(null!=e._d?e._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),!1===v&&(v=!0,t.updateOffset(this),v=!1)}function _(e){return e instanceof y||null!=e&&null!=e._isAMomentObject}function b(e){return e<0?Math.ceil(e)||0:Math.floor(e)}function w(e){var t=+e,n=0;return 0!==t&&isFinite(t)&&(n=b(t)),n}function A(e,t,n){var i,r=Math.min(e.length,t.length),o=Math.abs(e.length-t.length),a=0;for(i=0;i<r;i++)(n&&e[i]!==t[i]||!n&&w(e[i])!==w(t[i]))&&a++;return a+o}function k(e){!1===t.suppressDeprecationWarnings&&"undefined"!=typeof console&&console.warn&&console.warn("Deprecation warning: "+e)}function E(e,n){var i=!0;return u(function(){if(null!=t.deprecationHandler&&t.deprecationHandler(null,e),i){for(var r,o=[],a=0;a<arguments.length;a++){if(r="","object"==typeof arguments[a]){for(var s in r+="\n["+a+"] ",arguments[0])r+=s+": "+arguments[0][s]+", ";r=r.slice(0,-2)}else r=arguments[a];o.push(r)}k(e+"\nArguments: "+Array.prototype.slice.call(o).join("")+"\n"+(new Error).stack),i=!1}return n.apply(this,arguments)},n)}var T={};function S(e,n){null!=t.deprecationHandler&&t.deprecationHandler(e,n),T[e]||(k(n),T[e]=!0)}function C(e){return e instanceof Function||"[object Function]"===Object.prototype.toString.call(e)}function R(e,t){var n,r=u({},e);for(n in t)s(t,n)&&(i(e[n])&&i(t[n])?(r[n]={},u(r[n],e[n]),u(r[n],t[n])):null!=t[n]?r[n]=t[n]:delete r[n]);for(n in e)s(e,n)&&!s(t,n)&&i(e[n])&&(r[n]=u({},r[n]));return r}function P(e){null!=e&&this.set(e)}t.suppressDeprecationWarnings=!1,t.deprecationHandler=null;var N=Object.keys?Object.keys:function(e){var t,n=[];for(t in e)s(e,t)&&n.push(t);return n};var O={};function D(e,t){var n=e.toLowerCase();O[n]=O[n+"s"]=O[t]=e}function I(e){return"string"==typeof e?O[e]||O[e.toLowerCase()]:void 0}function z(e){var t,n,i={};for(n in e)s(e,n)&&(t=I(n))&&(i[t]=e[n]);return i}var x={};function L(e,t){x[e]=t}function M(e,n){return function(i){return null!=i?(V(this,e,i),t.updateOffset(this,n),this):F(this,e)}}function F(e,t){return e.isValid()?e._d["get"+(e._isUTC?"UTC":"")+t]():NaN}function V(e,t,n){e.isValid()&&e._d["set"+(e._isUTC?"UTC":"")+t](n)}function j(e,t,n){var i=""+Math.abs(e),r=t-i.length;return(e>=0?n?"+":"":"-")+Math.pow(10,Math.max(0,r)).toString().substr(1)+i}var B=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|YYYYYY|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,q=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,U={},H={};function G(e,t,n,i){var r=i;"string"==typeof i&&(r=function(){return this[i]()}),e&&(H[e]=r),t&&(H[t[0]]=function(){return j(r.apply(this,arguments),t[1],t[2])}),n&&(H[n]=function(){return this.localeData().ordinal(r.apply(this,arguments),e)})}function W(e,t){return e.isValid()?(t=$(t,e.localeData()),U[t]=U[t]||function(e){var t,n,i,r=e.match(B);for(t=0,n=r.length;t<n;t++)H[r[t]]?r[t]=H[r[t]]:r[t]=(i=r[t]).match(/\[[\s\S]/)?i.replace(/^\[|\]$/g,""):i.replace(/\\/g,"");return function(t){var i,o="";for(i=0;i<n;i++)o+=r[i]instanceof Function?r[i].call(t,e):r[i];return o}}(t),U[t](e)):e.localeData().invalidDate()}function $(e,t){var n=5;function i(e){return t.longDateFormat(e)||e}for(q.lastIndex=0;n>=0&&q.test(e);)e=e.replace(q,i),q.lastIndex=0,n-=1;return e}var Y=/\d/,Q=/\d\d/,K=/\d{3}/,Z=/\d{4}/,J=/[+-]?\d{6}/,X=/\d\d?/,ee=/\d\d\d\d?/,te=/\d\d\d\d\d\d?/,ne=/\d{1,3}/,ie=/\d{1,4}/,re=/[+-]?\d{1,6}/,oe=/\d+/,ae=/[+-]?\d+/,se=/Z|[+-]\d\d:?\d\d/gi,ue=/Z|[+-]\d\d(?::?\d\d)?/gi,ce=/[0-9]*['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+|[\u0600-\u06FF\/]+(\s*?[\u0600-\u06FF]+){1,2}/i,le={};function de(e,t,n){le[e]=C(t)?t:function(e,i){return e&&n?n:t}}function pe(e,t){return s(le,e)?le[e](t._strict,t._locale):new RegExp(fe(e.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(e,t,n,i,r){return t||n||i||r})))}function fe(e){return e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}var he={};function me(e,t){var n,i=t;for("string"==typeof e&&(e=[e]),r(t)&&(i=function(e,n){n[t]=w(e)}),n=0;n<e.length;n++)he[e[n]]=i}function ge(e,t){me(e,function(e,n,i,r){i._w=i._w||{},t(e,i._w,i,r)})}function ve(e,t,n){null!=t&&s(he,e)&&he[e](t,n._a,n,e)}var ye=0,_e=1,be=2,we=3,Ae=4,ke=5,Ee=6,Te=7,Se=8,Ce=Array.prototype.indexOf?Array.prototype.indexOf:function(e){var t;for(t=0;t<this.length;++t)if(this[t]===e)return t;return-1};function Re(e,t){return new Date(Date.UTC(e,t+1,0)).getUTCDate()}G("M",["MM",2],"Mo",function(){return this.month()+1}),G("MMM",0,0,function(e){return this.localeData().monthsShort(this,e)}),G("MMMM",0,0,function(e){return this.localeData().months(this,e)}),D("month","M"),L("month",8),de("M",X),de("MM",X,Q),de("MMM",function(e,t){return t.monthsShortRegex(e)}),de("MMMM",function(e,t){return t.monthsRegex(e)}),me(["M","MM"],function(e,t){t[_e]=w(e)-1}),me(["MMM","MMMM"],function(e,t,n,i){var r=n._locale.monthsParse(e,i,n._strict);null!=r?t[_e]=r:l(n).invalidMonth=e});var Pe=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,Ne="January_February_March_April_May_June_July_August_September_October_November_December".split("_");var Oe="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_");function De(e,t){var n;if(!e.isValid())return e;if("string"==typeof t)if(/^\d+$/.test(t))t=w(t);else if(!r(t=e.localeData().monthsParse(t)))return e;return n=Math.min(e.date(),Re(e.year(),t)),e._d["set"+(e._isUTC?"UTC":"")+"Month"](t,n),e}function Ie(e){return null!=e?(De(this,e),t.updateOffset(this,!0),this):F(this,"Month")}var ze=ce;var xe=ce;function Le(){function e(e,t){return t.length-e.length}var t,n,i=[],r=[],o=[];for(t=0;t<12;t++)n=c([2e3,t]),i.push(this.monthsShort(n,"")),r.push(this.months(n,"")),o.push(this.months(n,"")),o.push(this.monthsShort(n,""));for(i.sort(e),r.sort(e),o.sort(e),t=0;t<12;t++)i[t]=fe(i[t]),r[t]=fe(r[t]);for(t=0;t<24;t++)o[t]=fe(o[t]);this._monthsRegex=new RegExp("^("+o.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+r.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+i.join("|")+")","i")}function Me(e){return Fe(e)?366:365}function Fe(e){return e%4==0&&e%100!=0||e%400==0}G("Y",0,0,function(){var e=this.year();return e<=9999?""+e:"+"+e}),G(0,["YY",2],0,function(){return this.year()%100}),G(0,["YYYY",4],0,"year"),G(0,["YYYYY",5],0,"year"),G(0,["YYYYYY",6,!0],0,"year"),D("year","y"),L("year",1),de("Y",ae),de("YY",X,Q),de("YYYY",ie,Z),de("YYYYY",re,J),de("YYYYYY",re,J),me(["YYYYY","YYYYYY"],ye),me("YYYY",function(e,n){n[ye]=2===e.length?t.parseTwoDigitYear(e):w(e)}),me("YY",function(e,n){n[ye]=t.parseTwoDigitYear(e)}),me("Y",function(e,t){t[ye]=parseInt(e,10)}),t.parseTwoDigitYear=function(e){return w(e)+(w(e)>68?1900:2e3)};var Ve=M("FullYear",!0);function je(e){var t=new Date(Date.UTC.apply(null,arguments));return e<100&&e>=0&&isFinite(t.getUTCFullYear())&&t.setUTCFullYear(e),t}function Be(e,t,n){var i=7+t-n;return-((7+je(e,0,i).getUTCDay()-t)%7)+i-1}function qe(e,t,n,i,r){var o,a,s=1+7*(t-1)+(7+n-i)%7+Be(e,i,r);return s<=0?a=Me(o=e-1)+s:s>Me(e)?(o=e+1,a=s-Me(e)):(o=e,a=s),{year:o,dayOfYear:a}}function Ue(e,t,n){var i,r,o=Be(e.year(),t,n),a=Math.floor((e.dayOfYear()-o-1)/7)+1;return a<1?i=a+He(r=e.year()-1,t,n):a>He(e.year(),t,n)?(i=a-He(e.year(),t,n),r=e.year()+1):(r=e.year(),i=a),{week:i,year:r}}function He(e,t,n){var i=Be(e,t,n),r=Be(e+1,t,n);return(Me(e)-i+r)/7}G("w",["ww",2],"wo","week"),G("W",["WW",2],"Wo","isoWeek"),D("week","w"),D("isoWeek","W"),L("week",5),L("isoWeek",5),de("w",X),de("ww",X,Q),de("W",X),de("WW",X,Q),ge(["w","ww","W","WW"],function(e,t,n,i){t[i.substr(0,1)]=w(e)});G("d",0,"do","day"),G("dd",0,0,function(e){return this.localeData().weekdaysMin(this,e)}),G("ddd",0,0,function(e){return this.localeData().weekdaysShort(this,e)}),G("dddd",0,0,function(e){return this.localeData().weekdays(this,e)}),G("e",0,0,"weekday"),G("E",0,0,"isoWeekday"),D("day","d"),D("weekday","e"),D("isoWeekday","E"),L("day",11),L("weekday",11),L("isoWeekday",11),de("d",X),de("e",X),de("E",X),de("dd",function(e,t){return t.weekdaysMinRegex(e)}),de("ddd",function(e,t){return t.weekdaysShortRegex(e)}),de("dddd",function(e,t){return t.weekdaysRegex(e)}),ge(["dd","ddd","dddd"],function(e,t,n,i){var r=n._locale.weekdaysParse(e,i,n._strict);null!=r?t.d=r:l(n).invalidWeekday=e}),ge(["d","e","E"],function(e,t,n,i){t[i]=w(e)});var Ge="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_");var We="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_");var $e="Su_Mo_Tu_We_Th_Fr_Sa".split("_");var Ye=ce;var Qe=ce;var Ke=ce;function Ze(){function e(e,t){return t.length-e.length}var t,n,i,r,o,a=[],s=[],u=[],l=[];for(t=0;t<7;t++)n=c([2e3,1]).day(t),i=this.weekdaysMin(n,""),r=this.weekdaysShort(n,""),o=this.weekdays(n,""),a.push(i),s.push(r),u.push(o),l.push(i),l.push(r),l.push(o);for(a.sort(e),s.sort(e),u.sort(e),l.sort(e),t=0;t<7;t++)s[t]=fe(s[t]),u[t]=fe(u[t]),l[t]=fe(l[t]);this._weekdaysRegex=new RegExp("^("+l.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+u.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+s.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+a.join("|")+")","i")}function Je(){return this.hours()%12||12}function Xe(e,t){G(e,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),t)})}function et(e,t){return t._meridiemParse}G("H",["HH",2],0,"hour"),G("h",["hh",2],0,Je),G("k",["kk",2],0,function(){return this.hours()||24}),G("hmm",0,0,function(){return""+Je.apply(this)+j(this.minutes(),2)}),G("hmmss",0,0,function(){return""+Je.apply(this)+j(this.minutes(),2)+j(this.seconds(),2)}),G("Hmm",0,0,function(){return""+this.hours()+j(this.minutes(),2)}),G("Hmmss",0,0,function(){return""+this.hours()+j(this.minutes(),2)+j(this.seconds(),2)}),Xe("a",!0),Xe("A",!1),D("hour","h"),L("hour",13),de("a",et),de("A",et),de("H",X),de("h",X),de("HH",X,Q),de("hh",X,Q),de("hmm",ee),de("hmmss",te),de("Hmm",ee),de("Hmmss",te),me(["H","HH"],we),me(["a","A"],function(e,t,n){n._isPm=n._locale.isPM(e),n._meridiem=e}),me(["h","hh"],function(e,t,n){t[we]=w(e),l(n).bigHour=!0}),me("hmm",function(e,t,n){var i=e.length-2;t[we]=w(e.substr(0,i)),t[Ae]=w(e.substr(i)),l(n).bigHour=!0}),me("hmmss",function(e,t,n){var i=e.length-4,r=e.length-2;t[we]=w(e.substr(0,i)),t[Ae]=w(e.substr(i,2)),t[ke]=w(e.substr(r)),l(n).bigHour=!0}),me("Hmm",function(e,t,n){var i=e.length-2;t[we]=w(e.substr(0,i)),t[Ae]=w(e.substr(i))}),me("Hmmss",function(e,t,n){var i=e.length-4,r=e.length-2;t[we]=w(e.substr(0,i)),t[Ae]=w(e.substr(i,2)),t[ke]=w(e.substr(r))});var tt,nt=M("Hours",!0),it={calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},longDateFormat:{LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"},invalidDate:"Invalid date",ordinal:"%d",ordinalParse:/\d{1,2}/,relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},months:Ne,monthsShort:Oe,week:{dow:0,doy:6},weekdays:Ge,weekdaysMin:$e,weekdaysShort:We,meridiemParse:/[ap]\.?m?\.?/i},rt={},ot={};function at(e){return e?e.toLowerCase().replace("_","-"):e}function st(e){var t=null;if(!rt[e]&&"undefined"!=typeof module&&module&&module.exports)try{t=tt._abbr,require("./locale/"+e),ut(t)}catch(e){}return rt[e]}function ut(e,t){var n;return e&&(n=h(t)?lt(e):ct(e,t))&&(tt=n),tt._abbr}function ct(e,t){if(null!==t){var n=it;if(t.abbr=e,null!=rt[e])S("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),n=rt[e]._config;else if(null!=t.parentLocale){if(null==rt[t.parentLocale])return ot[t.parentLocale]||(ot[t.parentLocale]=[]),ot[t.parentLocale].push({name:e,config:t}),null;n=rt[t.parentLocale]._config}return rt[e]=new P(R(n,t)),ot[e]&&ot[e].forEach(function(e){ct(e.name,e.config)}),ut(e),rt[e]}return delete rt[e],null}function lt(e){var t;if(e&&e._locale&&e._locale._abbr&&(e=e._locale._abbr),!e)return tt;if(!n(e)){if(t=st(e))return t;e=[e]}return function(e){for(var t,n,i,r,o=0;o<e.length;){for(t=(r=at(e[o]).split("-")).length,n=(n=at(e[o+1]))?n.split("-"):null;t>0;){if(i=st(r.slice(0,t).join("-")))return i;if(n&&n.length>=t&&A(r,n,!0)>=t-1)break;t--}o++}return null}(e)}function dt(e){var t,n=e._a;return n&&-2===l(e).overflow&&(t=n[_e]<0||n[_e]>11?_e:n[be]<1||n[be]>Re(n[ye],n[_e])?be:n[we]<0||n[we]>24||24===n[we]&&(0!==n[Ae]||0!==n[ke]||0!==n[Ee])?we:n[Ae]<0||n[Ae]>59?Ae:n[ke]<0||n[ke]>59?ke:n[Ee]<0||n[Ee]>999?Ee:-1,l(e)._overflowDayOfYear&&(t<ye||t>be)&&(t=be),l(e)._overflowWeeks&&-1===t&&(t=Te),l(e)._overflowWeekday&&-1===t&&(t=Se),l(e).overflow=t),e}var pt=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,ft=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,ht=/Z|[+-]\d\d(?::?\d\d)?/,mt=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/]],gt=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],vt=/^\/?Date\((\-?\d+)/i;function yt(e){var t,n,i,r,o,a,s=e._i,u=pt.exec(s)||ft.exec(s);if(u){for(l(e).iso=!0,t=0,n=mt.length;t<n;t++)if(mt[t][1].exec(u[1])){r=mt[t][0],i=!1!==mt[t][2];break}if(null==r)return void(e._isValid=!1);if(u[3]){for(t=0,n=gt.length;t<n;t++)if(gt[t][1].exec(u[3])){o=(u[2]||" ")+gt[t][0];break}if(null==o)return void(e._isValid=!1)}if(!i&&null!=o)return void(e._isValid=!1);if(u[4]){if(!ht.exec(u[4]))return void(e._isValid=!1);a="Z"}e._f=r+(o||"")+(a||""),wt(e)}else e._isValid=!1}function _t(e,t,n){return null!=e?e:null!=t?t:n}function bt(e){var n,i,r,o,a=[];if(!e._d){for(r=function(e){var n=new Date(t.now());return e._useUTC?[n.getUTCFullYear(),n.getUTCMonth(),n.getUTCDate()]:[n.getFullYear(),n.getMonth(),n.getDate()]}(e),e._w&&null==e._a[be]&&null==e._a[_e]&&function(e){var t,n,i,r,o,a,s,u;if(null!=(t=e._w).GG||null!=t.W||null!=t.E)o=1,a=4,n=_t(t.GG,e._a[ye],Ue(Et(),1,4).year),i=_t(t.W,1),((r=_t(t.E,1))<1||r>7)&&(u=!0);else{o=e._locale._week.dow,a=e._locale._week.doy;var c=Ue(Et(),o,a);n=_t(t.gg,e._a[ye],c.year),i=_t(t.w,c.week),null!=t.d?((r=t.d)<0||r>6)&&(u=!0):null!=t.e?(r=t.e+o,(t.e<0||t.e>6)&&(u=!0)):r=o}i<1||i>He(n,o,a)?l(e)._overflowWeeks=!0:null!=u?l(e)._overflowWeekday=!0:(s=qe(n,i,r,o,a),e._a[ye]=s.year,e._dayOfYear=s.dayOfYear)}(e),e._dayOfYear&&(o=_t(e._a[ye],r[ye]),e._dayOfYear>Me(o)&&(l(e)._overflowDayOfYear=!0),i=je(o,0,e._dayOfYear),e._a[_e]=i.getUTCMonth(),e._a[be]=i.getUTCDate()),n=0;n<3&&null==e._a[n];++n)e._a[n]=a[n]=r[n];for(;n<7;n++)e._a[n]=a[n]=null==e._a[n]?2===n?1:0:e._a[n];24===e._a[we]&&0===e._a[Ae]&&0===e._a[ke]&&0===e._a[Ee]&&(e._nextDay=!0,e._a[we]=0),e._d=(e._useUTC?je:function(e,t,n,i,r,o,a){var s=new Date(e,t,n,i,r,o,a);return e<100&&e>=0&&isFinite(s.getFullYear())&&s.setFullYear(e),s}).apply(null,a),null!=e._tzm&&e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm),e._nextDay&&(e._a[we]=24)}}function wt(e){if(e._f!==t.ISO_8601){e._a=[],l(e).empty=!0;var n,i,r,o,a,s=""+e._i,u=s.length,c=0;for(r=$(e._f,e._locale).match(B)||[],n=0;n<r.length;n++)o=r[n],(i=(s.match(pe(o,e))||[])[0])&&((a=s.substr(0,s.indexOf(i))).length>0&&l(e).unusedInput.push(a),s=s.slice(s.indexOf(i)+i.length),c+=i.length),H[o]?(i?l(e).empty=!1:l(e).unusedTokens.push(o),ve(o,i,e)):e._strict&&!i&&l(e).unusedTokens.push(o);l(e).charsLeftOver=u-c,s.length>0&&l(e).unusedInput.push(s),e._a[we]<=12&&!0===l(e).bigHour&&e._a[we]>0&&(l(e).bigHour=void 0),l(e).parsedDateParts=e._a.slice(0),l(e).meridiem=e._meridiem,e._a[we]=function(e,t,n){var i;if(null==n)return t;return null!=e.meridiemHour?e.meridiemHour(t,n):null!=e.isPM?((i=e.isPM(n))&&t<12&&(t+=12),i||12!==t||(t=0),t):t}(e._locale,e._a[we],e._meridiem),bt(e),dt(e)}else yt(e)}function At(e){var i=e._i,s=e._f;return e._locale=e._locale||lt(e._l),null===i||void 0===s&&""===i?f({nullInput:!0}):("string"==typeof i&&(e._i=i=e._locale.preparse(i)),_(i)?new y(dt(i)):(o(i)?e._d=i:n(s)?function(e){var t,n,i,r,o;if(0===e._f.length)return l(e).invalidFormat=!0,void(e._d=new Date(NaN));for(r=0;r<e._f.length;r++)o=0,t=g({},e),null!=e._useUTC&&(t._useUTC=e._useUTC),t._f=e._f[r],wt(t),p(t)&&(o+=l(t).charsLeftOver,o+=10*l(t).unusedTokens.length,l(t).score=o,(null==i||o<i)&&(i=o,n=t));u(e,n||t)}(e):s?wt(e):function(e){var i=e._i;void 0===i?e._d=new Date(t.now()):o(i)?e._d=new Date(i.valueOf()):"string"==typeof i?function(e){var n=vt.exec(e._i);null===n?(yt(e),!1===e._isValid&&(delete e._isValid,t.createFromInputFallback(e))):e._d=new Date(+n[1])}(e):n(i)?(e._a=a(i.slice(0),function(e){return parseInt(e,10)}),bt(e)):"object"==typeof i?function(e){if(!e._d){var t=z(e._i);e._a=a([t.year,t.month,t.day||t.date,t.hour,t.minute,t.second,t.millisecond],function(e){return e&&parseInt(e,10)}),bt(e)}}(e):r(i)?e._d=new Date(i):t.createFromInputFallback(e)}(e),p(e)||(e._d=null),e))}function kt(e,t,r,o,a){var s,u={};return!0!==r&&!1!==r||(o=r,r=void 0),(i(e)&&function(e){var t;for(t in e)return!1;return!0}(e)||n(e)&&0===e.length)&&(e=void 0),u._isAMomentObject=!0,u._useUTC=u._isUTC=a,u._l=r,u._i=e,u._f=t,u._strict=o,(s=new y(dt(At(u))))._nextDay&&(s.add(1,"d"),s._nextDay=void 0),s}function Et(e,t,n,i){return kt(e,t,n,i,!1)}t.createFromInputFallback=E("value provided is not in a recognized ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non ISO date formats are discouraged and will be removed in an upcoming major release. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(e){e._d=new Date(e._i+(e._useUTC?" UTC":""))}),t.ISO_8601=function(){};var Tt=E("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var e=Et.apply(null,arguments);return this.isValid()&&e.isValid()?e<this?this:e:f()}),St=E("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var e=Et.apply(null,arguments);return this.isValid()&&e.isValid()?e>this?this:e:f()});function Ct(e,t){var i,r;if(1===t.length&&n(t[0])&&(t=t[0]),!t.length)return Et();for(i=t[0],r=1;r<t.length;++r)t[r].isValid()&&!t[r][e](i)||(i=t[r]);return i}function Rt(e){var t=z(e),n=t.year||0,i=t.quarter||0,r=t.month||0,o=t.week||0,a=t.day||0,s=t.hour||0,u=t.minute||0,c=t.second||0,l=t.millisecond||0;this._milliseconds=+l+1e3*c+6e4*u+1e3*s*60*60,this._days=+a+7*o,this._months=+r+3*i+12*n,this._data={},this._locale=lt(),this._bubble()}function Pt(e){return e instanceof Rt}function Nt(e){return e<0?-1*Math.round(-1*e):Math.round(e)}function Ot(e,t){G(e,0,0,function(){var e=this.utcOffset(),n="+";return e<0&&(e=-e,n="-"),n+j(~~(e/60),2)+t+j(~~e%60,2)})}Ot("Z",":"),Ot("ZZ",""),de("Z",ue),de("ZZ",ue),me(["Z","ZZ"],function(e,t,n){n._useUTC=!0,n._tzm=It(ue,e)});var Dt=/([\+\-]|\d\d)/gi;function It(e,t){var n=(t||"").match(e);if(null===n)return null;var i=((n[n.length-1]||[])+"").match(Dt)||["-",0,0],r=60*i[1]+w(i[2]);return 0===r?0:"+"===i[0]?r:-r}function zt(e,n){var i,r;return n._isUTC?(i=n.clone(),r=(_(e)||o(e)?e.valueOf():Et(e).valueOf())-i.valueOf(),i._d.setTime(i._d.valueOf()+r),t.updateOffset(i,!1),i):Et(e).local()}function xt(e){return 15*-Math.round(e._d.getTimezoneOffset()/15)}function Lt(){return!!this.isValid()&&(this._isUTC&&0===this._offset)}t.updateOffset=function(){};var Mt=/^(\-)?(?:(\d*)[. ])?(\d+)\:(\d+)(?:\:(\d+)(\.\d*)?)?$/,Ft=/^(-)?P(?:(-?[0-9,.]*)Y)?(?:(-?[0-9,.]*)M)?(?:(-?[0-9,.]*)W)?(?:(-?[0-9,.]*)D)?(?:T(?:(-?[0-9,.]*)H)?(?:(-?[0-9,.]*)M)?(?:(-?[0-9,.]*)S)?)?$/;function Vt(e,t){var n,i,o,a=e,u=null;return Pt(e)?a={ms:e._milliseconds,d:e._days,M:e._months}:r(e)?(a={},t?a[t]=e:a.milliseconds=e):(u=Mt.exec(e))?(n="-"===u[1]?-1:1,a={y:0,d:w(u[be])*n,h:w(u[we])*n,m:w(u[Ae])*n,s:w(u[ke])*n,ms:w(Nt(1e3*u[Ee]))*n}):(u=Ft.exec(e))?(n="-"===u[1]?-1:1,a={y:jt(u[2],n),M:jt(u[3],n),w:jt(u[4],n),d:jt(u[5],n),h:jt(u[6],n),m:jt(u[7],n),s:jt(u[8],n)}):null==a?a={}:"object"==typeof a&&("from"in a||"to"in a)&&(o=function(e,t){var n;if(!e.isValid()||!t.isValid())return{milliseconds:0,months:0};t=zt(t,e),e.isBefore(t)?n=Bt(e,t):((n=Bt(t,e)).milliseconds=-n.milliseconds,n.months=-n.months);return n}(Et(a.from),Et(a.to)),(a={}).ms=o.milliseconds,a.M=o.months),i=new Rt(a),Pt(e)&&s(e,"_locale")&&(i._locale=e._locale),i}function jt(e,t){var n=e&&parseFloat(e.replace(",","."));return(isNaN(n)?0:n)*t}function Bt(e,t){var n={milliseconds:0,months:0};return n.months=t.month()-e.month()+12*(t.year()-e.year()),e.clone().add(n.months,"M").isAfter(t)&&--n.months,n.milliseconds=+t-+e.clone().add(n.months,"M"),n}function qt(e,t){return function(n,i){var r;return null===i||isNaN(+i)||(S(t,"moment()."+t+"(period, number) is deprecated. Please use moment()."+t+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),r=n,n=i,i=r),Ut(this,Vt(n="string"==typeof n?+n:n,i),e),this}}function Ut(e,n,i,r){var o=n._milliseconds,a=Nt(n._days),s=Nt(n._months);e.isValid()&&(r=null==r||r,o&&e._d.setTime(e._d.valueOf()+o*i),a&&V(e,"Date",F(e,"Date")+a*i),s&&De(e,F(e,"Month")+s*i),r&&t.updateOffset(e,a||s))}Vt.fn=Rt.prototype;var Ht=qt(1,"add"),Gt=qt(-1,"subtract");function Wt(e){var t;return void 0===e?this._locale._abbr:(null!=(t=lt(e))&&(this._locale=t),this)}t.defaultFormat="YYYY-MM-DDTHH:mm:ssZ",t.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";var $t=E("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(e){return void 0===e?this.localeData():this.locale(e)});function Yt(){return this._locale}function Qt(e,t){G(0,[e,e.length],0,t)}function Kt(e,t,n,i,r){var o;return null==e?Ue(this,i,r).year:(t>(o=He(e,i,r))&&(t=o),function(e,t,n,i,r){var o=qe(e,t,n,i,r),a=je(o.year,0,o.dayOfYear);return this.year(a.getUTCFullYear()),this.month(a.getUTCMonth()),this.date(a.getUTCDate()),this}.call(this,e,t,n,i,r))}G(0,["gg",2],0,function(){return this.weekYear()%100}),G(0,["GG",2],0,function(){return this.isoWeekYear()%100}),Qt("gggg","weekYear"),Qt("ggggg","weekYear"),Qt("GGGG","isoWeekYear"),Qt("GGGGG","isoWeekYear"),D("weekYear","gg"),D("isoWeekYear","GG"),L("weekYear",1),L("isoWeekYear",1),de("G",ae),de("g",ae),de("GG",X,Q),de("gg",X,Q),de("GGGG",ie,Z),de("gggg",ie,Z),de("GGGGG",re,J),de("ggggg",re,J),ge(["gggg","ggggg","GGGG","GGGGG"],function(e,t,n,i){t[i.substr(0,2)]=w(e)}),ge(["gg","GG"],function(e,n,i,r){n[r]=t.parseTwoDigitYear(e)}),G("Q",0,"Qo","quarter"),D("quarter","Q"),L("quarter",7),de("Q",Y),me("Q",function(e,t){t[_e]=3*(w(e)-1)}),G("D",["DD",2],"Do","date"),D("date","D"),L("date",9),de("D",X),de("DD",X,Q),de("Do",function(e,t){return e?t._ordinalParse:t._ordinalParseLenient}),me(["D","DD"],be),me("Do",function(e,t){t[be]=w(e.match(X)[0])});var Zt=M("Date",!0);G("DDD",["DDDD",3],"DDDo","dayOfYear"),D("dayOfYear","DDD"),L("dayOfYear",4),de("DDD",ne),de("DDDD",K),me(["DDD","DDDD"],function(e,t,n){n._dayOfYear=w(e)}),G("m",["mm",2],0,"minute"),D("minute","m"),L("minute",14),de("m",X),de("mm",X,Q),me(["m","mm"],Ae);var Jt=M("Minutes",!1);G("s",["ss",2],0,"second"),D("second","s"),L("second",15),de("s",X),de("ss",X,Q),me(["s","ss"],ke);var Xt,en=M("Seconds",!1);for(G("S",0,0,function(){return~~(this.millisecond()/100)}),G(0,["SS",2],0,function(){return~~(this.millisecond()/10)}),G(0,["SSS",3],0,"millisecond"),G(0,["SSSS",4],0,function(){return 10*this.millisecond()}),G(0,["SSSSS",5],0,function(){return 100*this.millisecond()}),G(0,["SSSSSS",6],0,function(){return 1e3*this.millisecond()}),G(0,["SSSSSSS",7],0,function(){return 1e4*this.millisecond()}),G(0,["SSSSSSSS",8],0,function(){return 1e5*this.millisecond()}),G(0,["SSSSSSSSS",9],0,function(){return 1e6*this.millisecond()}),D("millisecond","ms"),L("millisecond",16),de("S",ne,Y),de("SS",ne,Q),de("SSS",ne,K),Xt="SSSS";Xt.length<=9;Xt+="S")de(Xt,oe);function tn(e,t){t[Ee]=w(1e3*("0."+e))}for(Xt="S";Xt.length<=9;Xt+="S")me(Xt,tn);var nn=M("Milliseconds",!1);G("z",0,0,"zoneAbbr"),G("zz",0,0,"zoneName");var rn=y.prototype;function on(e){return e}rn.add=Ht,rn.calendar=function(e,n){var i=e||Et(),r=zt(i,this).startOf("day"),o=t.calendarFormat(this,r)||"sameElse",a=n&&(C(n[o])?n[o].call(this,i):n[o]);return this.format(a||this.localeData().calendar(o,this,Et(i)))},rn.clone=function(){return new y(this)},rn.diff=function(e,t,n){var i,r,o,a;return this.isValid()&&(i=zt(e,this)).isValid()?(r=6e4*(i.utcOffset()-this.utcOffset()),"year"===(t=I(t))||"month"===t||"quarter"===t?(s=this,u=i,d=12*(u.year()-s.year())+(u.month()-s.month()),p=s.clone().add(d,"months"),u-p<0?(c=s.clone().add(d-1,"months"),l=(u-p)/(p-c)):(c=s.clone().add(d+1,"months"),l=(u-p)/(c-p)),a=-(d+l)||0,"quarter"===t?a/=3:"year"===t&&(a/=12)):(o=this-i,a="second"===t?o/1e3:"minute"===t?o/6e4:"hour"===t?o/36e5:"day"===t?(o-r)/864e5:"week"===t?(o-r)/6048e5:o),n?a:b(a)):NaN;var s,u,c,l,d,p},rn.endOf=function(e){return void 0===(e=I(e))||"millisecond"===e?this:("date"===e&&(e="day"),this.startOf(e).add(1,"isoWeek"===e?"week":e).subtract(1,"ms"))},rn.format=function(e){e||(e=this.isUtc()?t.defaultFormatUtc:t.defaultFormat);var n=W(this,e);return this.localeData().postformat(n)},rn.from=function(e,t){return this.isValid()&&(_(e)&&e.isValid()||Et(e).isValid())?Vt({to:this,from:e}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()},rn.fromNow=function(e){return this.from(Et(),e)},rn.to=function(e,t){return this.isValid()&&(_(e)&&e.isValid()||Et(e).isValid())?Vt({from:this,to:e}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()},rn.toNow=function(e){return this.to(Et(),e)},rn.get=function(e){return C(this[e=I(e)])?this[e]():this},rn.invalidAt=function(){return l(this).overflow},rn.isAfter=function(e,t){var n=_(e)?e:Et(e);return!(!this.isValid()||!n.isValid())&&("millisecond"===(t=I(h(t)?"millisecond":t))?this.valueOf()>n.valueOf():n.valueOf()<this.clone().startOf(t).valueOf())},rn.isBefore=function(e,t){var n=_(e)?e:Et(e);return!(!this.isValid()||!n.isValid())&&("millisecond"===(t=I(h(t)?"millisecond":t))?this.valueOf()<n.valueOf():this.clone().endOf(t).valueOf()<n.valueOf())},rn.isBetween=function(e,t,n,i){return("("===(i=i||"()")[0]?this.isAfter(e,n):!this.isBefore(e,n))&&(")"===i[1]?this.isBefore(t,n):!this.isAfter(t,n))},rn.isSame=function(e,t){var n,i=_(e)?e:Et(e);return!(!this.isValid()||!i.isValid())&&("millisecond"===(t=I(t||"millisecond"))?this.valueOf()===i.valueOf():(n=i.valueOf(),this.clone().startOf(t).valueOf()<=n&&n<=this.clone().endOf(t).valueOf()))},rn.isSameOrAfter=function(e,t){return this.isSame(e,t)||this.isAfter(e,t)},rn.isSameOrBefore=function(e,t){return this.isSame(e,t)||this.isBefore(e,t)},rn.isValid=function(){return p(this)},rn.lang=$t,rn.locale=Wt,rn.localeData=Yt,rn.max=St,rn.min=Tt,rn.parsingFlags=function(){return u({},l(this))},rn.set=function(e,t){if("object"==typeof e)for(var n=function(e){var t=[];for(var n in e)t.push({unit:n,priority:x[n]});return t.sort(function(e,t){return e.priority-t.priority}),t}(e=z(e)),i=0;i<n.length;i++)this[n[i].unit](e[n[i].unit]);else if(C(this[e=I(e)]))return this[e](t);return this},rn.startOf=function(e){switch(e=I(e)){case"year":this.month(0);case"quarter":case"month":this.date(1);case"week":case"isoWeek":case"day":case"date":this.hours(0);case"hour":this.minutes(0);case"minute":this.seconds(0);case"second":this.milliseconds(0)}return"week"===e&&this.weekday(0),"isoWeek"===e&&this.isoWeekday(1),"quarter"===e&&this.month(3*Math.floor(this.month()/3)),this},rn.subtract=Gt,rn.toArray=function(){var e=this;return[e.year(),e.month(),e.date(),e.hour(),e.minute(),e.second(),e.millisecond()]},rn.toObject=function(){var e=this;return{years:e.year(),months:e.month(),date:e.date(),hours:e.hours(),minutes:e.minutes(),seconds:e.seconds(),milliseconds:e.milliseconds()}},rn.toDate=function(){return new Date(this.valueOf())},rn.toISOString=function(){var e=this.clone().utc();return 0<e.year()&&e.year()<=9999?C(Date.prototype.toISOString)?this.toDate().toISOString():W(e,"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]"):W(e,"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]")},rn.inspect=function(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var e="moment",t="";this.isLocal()||(e=0===this.utcOffset()?"moment.utc":"moment.parseZone",t="Z");var n="["+e+'("]',i=0<this.year()&&this.year()<=9999?"YYYY":"YYYYYY",r=t+'[")]';return this.format(n+i+"-MM-DD[T]HH:mm:ss.SSS"+r)},rn.toJSON=function(){return this.isValid()?this.toISOString():null},rn.toString=function(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")},rn.unix=function(){return Math.floor(this.valueOf()/1e3)},rn.valueOf=function(){return this._d.valueOf()-6e4*(this._offset||0)},rn.creationData=function(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}},rn.year=Ve,rn.isLeapYear=function(){return Fe(this.year())},rn.weekYear=function(e){return Kt.call(this,e,this.week(),this.weekday(),this.localeData()._week.dow,this.localeData()._week.doy)},rn.isoWeekYear=function(e){return Kt.call(this,e,this.isoWeek(),this.isoWeekday(),1,4)},rn.quarter=rn.quarters=function(e){return null==e?Math.ceil((this.month()+1)/3):this.month(3*(e-1)+this.month()%3)},rn.month=Ie,rn.daysInMonth=function(){return Re(this.year(),this.month())},rn.week=rn.weeks=function(e){var t=this.localeData().week(this);return null==e?t:this.add(7*(e-t),"d")},rn.isoWeek=rn.isoWeeks=function(e){var t=Ue(this,1,4).week;return null==e?t:this.add(7*(e-t),"d")},rn.weeksInYear=function(){var e=this.localeData()._week;return He(this.year(),e.dow,e.doy)},rn.isoWeeksInYear=function(){return He(this.year(),1,4)},rn.date=Zt,rn.day=rn.days=function(e){if(!this.isValid())return null!=e?this:NaN;var t=this._isUTC?this._d.getUTCDay():this._d.getDay();return null!=e?(e=function(e,t){return"string"!=typeof e?e:isNaN(e)?"number"==typeof(e=t.weekdaysParse(e))?e:null:parseInt(e,10)}(e,this.localeData()),this.add(e-t,"d")):t},rn.weekday=function(e){if(!this.isValid())return null!=e?this:NaN;var t=(this.day()+7-this.localeData()._week.dow)%7;return null==e?t:this.add(e-t,"d")},rn.isoWeekday=function(e){if(!this.isValid())return null!=e?this:NaN;if(null!=e){var t=function(e,t){return"string"==typeof e?t.weekdaysParse(e)%7||7:isNaN(e)?null:e}(e,this.localeData());return this.day(this.day()%7?t:t-7)}return this.day()||7},rn.dayOfYear=function(e){var t=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return null==e?t:this.add(e-t,"d")},rn.hour=rn.hours=nt,rn.minute=rn.minutes=Jt,rn.second=rn.seconds=en,rn.millisecond=rn.milliseconds=nn,rn.utcOffset=function(e,n){var i,r=this._offset||0;if(!this.isValid())return null!=e?this:NaN;if(null!=e){if("string"==typeof e){if(null===(e=It(ue,e)))return this}else Math.abs(e)<16&&(e*=60);return!this._isUTC&&n&&(i=xt(this)),this._offset=e,this._isUTC=!0,null!=i&&this.add(i,"m"),r!==e&&(!n||this._changeInProgress?Ut(this,Vt(e-r,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,t.updateOffset(this,!0),this._changeInProgress=null)),this}return this._isUTC?r:xt(this)},rn.utc=function(e){return this.utcOffset(0,e)},rn.local=function(e){return this._isUTC&&(this.utcOffset(0,e),this._isUTC=!1,e&&this.subtract(xt(this),"m")),this},rn.parseZone=function(){if(null!=this._tzm)this.utcOffset(this._tzm);else if("string"==typeof this._i){var e=It(se,this._i);null!=e?this.utcOffset(e):this.utcOffset(0,!0)}return this},rn.hasAlignedHourOffset=function(e){return!!this.isValid()&&(e=e?Et(e).utcOffset():0,(this.utcOffset()-e)%60==0)},rn.isDST=function(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()},rn.isLocal=function(){return!!this.isValid()&&!this._isUTC},rn.isUtcOffset=function(){return!!this.isValid()&&this._isUTC},rn.isUtc=Lt,rn.isUTC=Lt,rn.zoneAbbr=function(){return this._isUTC?"UTC":""},rn.zoneName=function(){return this._isUTC?"Coordinated Universal Time":""},rn.dates=E("dates accessor is deprecated. Use date instead.",Zt),rn.months=E("months accessor is deprecated. Use month instead",Ie),rn.years=E("years accessor is deprecated. Use year instead",Ve),rn.zone=E("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",function(e,t){return null!=e?("string"!=typeof e&&(e=-e),this.utcOffset(e,t),this):-this.utcOffset()}),rn.isDSTShifted=E("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",function(){if(!h(this._isDSTShifted))return this._isDSTShifted;var e={};if(g(e,this),(e=At(e))._a){var t=e._isUTC?c(e._a):Et(e._a);this._isDSTShifted=this.isValid()&&A(e._a,t.toArray())>0}else this._isDSTShifted=!1;return this._isDSTShifted});var an=P.prototype;function sn(e,t,n,i){var r=lt(),o=c().set(i,t);return r[n](o,e)}function un(e,t,n){if(r(e)&&(t=e,e=void 0),e=e||"",null!=t)return sn(e,t,n,"month");var i,o=[];for(i=0;i<12;i++)o[i]=sn(e,i,n,"month");return o}function cn(e,t,n,i){"boolean"==typeof e?(r(t)&&(n=t,t=void 0),t=t||""):(n=t=e,e=!1,r(t)&&(n=t,t=void 0),t=t||"");var o,a=lt(),s=e?a._week.dow:0;if(null!=n)return sn(t,(n+s)%7,i,"day");var u=[];for(o=0;o<7;o++)u[o]=sn(t,(o+s)%7,i,"day");return u}an.calendar=function(e,t,n){var i=this._calendar[e]||this._calendar.sameElse;return C(i)?i.call(t,n):i},an.longDateFormat=function(e){var t=this._longDateFormat[e],n=this._longDateFormat[e.toUpperCase()];return t||!n?t:(this._longDateFormat[e]=n.replace(/MMMM|MM|DD|dddd/g,function(e){return e.slice(1)}),this._longDateFormat[e])},an.invalidDate=function(){return this._invalidDate},an.ordinal=function(e){return this._ordinal.replace("%d",e)},an.preparse=on,an.postformat=on,an.relativeTime=function(e,t,n,i){var r=this._relativeTime[n];return C(r)?r(e,t,n,i):r.replace(/%d/i,e)},an.pastFuture=function(e,t){var n=this._relativeTime[e>0?"future":"past"];return C(n)?n(t):n.replace(/%s/i,t)},an.set=function(e){var t,n;for(n in e)C(t=e[n])?this[n]=t:this["_"+n]=t;this._config=e,this._ordinalParseLenient=new RegExp(this._ordinalParse.source+"|"+/\d{1,2}/.source)},an.months=function(e,t){return e?n(this._months)?this._months[e.month()]:this._months[(this._months.isFormat||Pe).test(t)?"format":"standalone"][e.month()]:this._months},an.monthsShort=function(e,t){return e?n(this._monthsShort)?this._monthsShort[e.month()]:this._monthsShort[Pe.test(t)?"format":"standalone"][e.month()]:this._monthsShort},an.monthsParse=function(e,t,n){var i,r,o;if(this._monthsParseExact)return function(e,t,n){var i,r,o,a=e.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],i=0;i<12;++i)o=c([2e3,i]),this._shortMonthsParse[i]=this.monthsShort(o,"").toLocaleLowerCase(),this._longMonthsParse[i]=this.months(o,"").toLocaleLowerCase();return n?"MMM"===t?-1!==(r=Ce.call(this._shortMonthsParse,a))?r:null:-1!==(r=Ce.call(this._longMonthsParse,a))?r:null:"MMM"===t?-1!==(r=Ce.call(this._shortMonthsParse,a))?r:-1!==(r=Ce.call(this._longMonthsParse,a))?r:null:-1!==(r=Ce.call(this._longMonthsParse,a))?r:-1!==(r=Ce.call(this._shortMonthsParse,a))?r:null}.call(this,e,t,n);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),i=0;i<12;i++){if(r=c([2e3,i]),n&&!this._longMonthsParse[i]&&(this._longMonthsParse[i]=new RegExp("^"+this.months(r,"").replace(".","")+"$","i"),this._shortMonthsParse[i]=new RegExp("^"+this.monthsShort(r,"").replace(".","")+"$","i")),n||this._monthsParse[i]||(o="^"+this.months(r,"")+"|^"+this.monthsShort(r,""),this._monthsParse[i]=new RegExp(o.replace(".",""),"i")),n&&"MMMM"===t&&this._longMonthsParse[i].test(e))return i;if(n&&"MMM"===t&&this._shortMonthsParse[i].test(e))return i;if(!n&&this._monthsParse[i].test(e))return i}},an.monthsRegex=function(e){return this._monthsParseExact?(s(this,"_monthsRegex")||Le.call(this),e?this._monthsStrictRegex:this._monthsRegex):(s(this,"_monthsRegex")||(this._monthsRegex=xe),this._monthsStrictRegex&&e?this._monthsStrictRegex:this._monthsRegex)},an.monthsShortRegex=function(e){return this._monthsParseExact?(s(this,"_monthsRegex")||Le.call(this),e?this._monthsShortStrictRegex:this._monthsShortRegex):(s(this,"_monthsShortRegex")||(this._monthsShortRegex=ze),this._monthsShortStrictRegex&&e?this._monthsShortStrictRegex:this._monthsShortRegex)},an.week=function(e){return Ue(e,this._week.dow,this._week.doy).week},an.firstDayOfYear=function(){return this._week.doy},an.firstDayOfWeek=function(){return this._week.dow},an.weekdays=function(e,t){return e?n(this._weekdays)?this._weekdays[e.day()]:this._weekdays[this._weekdays.isFormat.test(t)?"format":"standalone"][e.day()]:this._weekdays},an.weekdaysMin=function(e){return e?this._weekdaysMin[e.day()]:this._weekdaysMin},an.weekdaysShort=function(e){return e?this._weekdaysShort[e.day()]:this._weekdaysShort},an.weekdaysParse=function(e,t,n){var i,r,o;if(this._weekdaysParseExact)return function(e,t,n){var i,r,o,a=e.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],i=0;i<7;++i)o=c([2e3,1]).day(i),this._minWeekdaysParse[i]=this.weekdaysMin(o,"").toLocaleLowerCase(),this._shortWeekdaysParse[i]=this.weekdaysShort(o,"").toLocaleLowerCase(),this._weekdaysParse[i]=this.weekdays(o,"").toLocaleLowerCase();return n?"dddd"===t?-1!==(r=Ce.call(this._weekdaysParse,a))?r:null:"ddd"===t?-1!==(r=Ce.call(this._shortWeekdaysParse,a))?r:null:-1!==(r=Ce.call(this._minWeekdaysParse,a))?r:null:"dddd"===t?-1!==(r=Ce.call(this._weekdaysParse,a))?r:-1!==(r=Ce.call(this._shortWeekdaysParse,a))?r:-1!==(r=Ce.call(this._minWeekdaysParse,a))?r:null:"ddd"===t?-1!==(r=Ce.call(this._shortWeekdaysParse,a))?r:-1!==(r=Ce.call(this._weekdaysParse,a))?r:-1!==(r=Ce.call(this._minWeekdaysParse,a))?r:null:-1!==(r=Ce.call(this._minWeekdaysParse,a))?r:-1!==(r=Ce.call(this._weekdaysParse,a))?r:-1!==(r=Ce.call(this._shortWeekdaysParse,a))?r:null}.call(this,e,t,n);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),i=0;i<7;i++){if(r=c([2e3,1]).day(i),n&&!this._fullWeekdaysParse[i]&&(this._fullWeekdaysParse[i]=new RegExp("^"+this.weekdays(r,"").replace(".",".?")+"$","i"),this._shortWeekdaysParse[i]=new RegExp("^"+this.weekdaysShort(r,"").replace(".",".?")+"$","i"),this._minWeekdaysParse[i]=new RegExp("^"+this.weekdaysMin(r,"").replace(".",".?")+"$","i")),this._weekdaysParse[i]||(o="^"+this.weekdays(r,"")+"|^"+this.weekdaysShort(r,"")+"|^"+this.weekdaysMin(r,""),this._weekdaysParse[i]=new RegExp(o.replace(".",""),"i")),n&&"dddd"===t&&this._fullWeekdaysParse[i].test(e))return i;if(n&&"ddd"===t&&this._shortWeekdaysParse[i].test(e))return i;if(n&&"dd"===t&&this._minWeekdaysParse[i].test(e))return i;if(!n&&this._weekdaysParse[i].test(e))return i}},an.weekdaysRegex=function(e){return this._weekdaysParseExact?(s(this,"_weekdaysRegex")||Ze.call(this),e?this._weekdaysStrictRegex:this._weekdaysRegex):(s(this,"_weekdaysRegex")||(this._weekdaysRegex=Ye),this._weekdaysStrictRegex&&e?this._weekdaysStrictRegex:this._weekdaysRegex)},an.weekdaysShortRegex=function(e){return this._weekdaysParseExact?(s(this,"_weekdaysRegex")||Ze.call(this),e?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(s(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=Qe),this._weekdaysShortStrictRegex&&e?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)},an.weekdaysMinRegex=function(e){return this._weekdaysParseExact?(s(this,"_weekdaysRegex")||Ze.call(this),e?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(s(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=Ke),this._weekdaysMinStrictRegex&&e?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)},an.isPM=function(e){return"p"===(e+"").toLowerCase().charAt(0)},an.meridiem=function(e,t,n){return e>11?n?"pm":"PM":n?"am":"AM"},ut("en",{ordinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(e){var t=e%10;return e+(1===w(e%100/10)?"th":1===t?"st":2===t?"nd":3===t?"rd":"th")}}),t.lang=E("moment.lang is deprecated. Use moment.locale instead.",ut),t.langData=E("moment.langData is deprecated. Use moment.localeData instead.",lt);var ln=Math.abs;function dn(e,t,n,i){var r=Vt(t,n);return e._milliseconds+=i*r._milliseconds,e._days+=i*r._days,e._months+=i*r._months,e._bubble()}function pn(e){return e<0?Math.floor(e):Math.ceil(e)}function fn(e){return 4800*e/146097}function hn(e){return 146097*e/4800}function mn(e){return function(){return this.as(e)}}var gn=mn("ms"),vn=mn("s"),yn=mn("m"),_n=mn("h"),bn=mn("d"),wn=mn("w"),An=mn("M"),kn=mn("y");function En(e){return function(){return this._data[e]}}var Tn=En("milliseconds"),Sn=En("seconds"),Cn=En("minutes"),Rn=En("hours"),Pn=En("days"),Nn=En("months"),On=En("years");var Dn=Math.round,In={s:45,m:45,h:22,d:26,M:11};var zn=Math.abs;function xn(){var e,t,n=zn(this._milliseconds)/1e3,i=zn(this._days),r=zn(this._months);t=b((e=b(n/60))/60),n%=60,e%=60;var o=b(r/12),a=r%=12,s=i,u=t,c=e,l=n,d=this.asSeconds();return d?(d<0?"-":"")+"P"+(o?o+"Y":"")+(a?a+"M":"")+(s?s+"D":"")+(u||c||l?"T":"")+(u?u+"H":"")+(c?c+"M":"")+(l?l+"S":""):"P0D"}var Ln=Rt.prototype;return Ln.abs=function(){var e=this._data;return this._milliseconds=ln(this._milliseconds),this._days=ln(this._days),this._months=ln(this._months),e.milliseconds=ln(e.milliseconds),e.seconds=ln(e.seconds),e.minutes=ln(e.minutes),e.hours=ln(e.hours),e.months=ln(e.months),e.years=ln(e.years),this},Ln.add=function(e,t){return dn(this,e,t,1)},Ln.subtract=function(e,t){return dn(this,e,t,-1)},Ln.as=function(e){var t,n,i=this._milliseconds;if("month"===(e=I(e))||"year"===e)return t=this._days+i/864e5,n=this._months+fn(t),"month"===e?n:n/12;switch(t=this._days+Math.round(hn(this._months)),e){case"week":return t/7+i/6048e5;case"day":return t+i/864e5;case"hour":return 24*t+i/36e5;case"minute":return 1440*t+i/6e4;case"second":return 86400*t+i/1e3;case"millisecond":return Math.floor(864e5*t)+i;default:throw new Error("Unknown unit "+e)}},Ln.asMilliseconds=gn,Ln.asSeconds=vn,Ln.asMinutes=yn,Ln.asHours=_n,Ln.asDays=bn,Ln.asWeeks=wn,Ln.asMonths=An,Ln.asYears=kn,Ln.valueOf=function(){return this._milliseconds+864e5*this._days+this._months%12*2592e6+31536e6*w(this._months/12)},Ln._bubble=function(){var e,t,n,i,r,o=this._milliseconds,a=this._days,s=this._months,u=this._data;return o>=0&&a>=0&&s>=0||o<=0&&a<=0&&s<=0||(o+=864e5*pn(hn(s)+a),a=0,s=0),u.milliseconds=o%1e3,e=b(o/1e3),u.seconds=e%60,t=b(e/60),u.minutes=t%60,n=b(t/60),u.hours=n%24,s+=r=b(fn(a+=b(n/24))),a-=pn(hn(r)),i=b(s/12),s%=12,u.days=a,u.months=s,u.years=i,this},Ln.get=function(e){return this[(e=I(e))+"s"]()},Ln.milliseconds=Tn,Ln.seconds=Sn,Ln.minutes=Cn,Ln.hours=Rn,Ln.days=Pn,Ln.weeks=function(){return b(this.days()/7)},Ln.months=Nn,Ln.years=On,Ln.humanize=function(e){var t=this.localeData(),n=function(e,t,n){var i=Vt(e).abs(),r=Dn(i.as("s")),o=Dn(i.as("m")),a=Dn(i.as("h")),s=Dn(i.as("d")),u=Dn(i.as("M")),c=Dn(i.as("y")),l=r<In.s&&["s",r]||o<=1&&["m"]||o<In.m&&["mm",o]||a<=1&&["h"]||a<In.h&&["hh",a]||s<=1&&["d"]||s<In.d&&["dd",s]||u<=1&&["M"]||u<In.M&&["MM",u]||c<=1&&["y"]||["yy",c];return l[2]=t,l[3]=+e>0,l[4]=n,function(e,t,n,i,r){return r.relativeTime(t||1,!!n,e,i)}.apply(null,l)}(this,!e,t);return e&&(n=t.pastFuture(+this,n)),t.postformat(n)},Ln.toISOString=xn,Ln.toString=xn,Ln.toJSON=xn,Ln.locale=Wt,Ln.localeData=Yt,Ln.toIsoString=E("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",xn),Ln.lang=$t,G("X",0,0,"unix"),G("x",0,0,"valueOf"),de("x",ae),de("X",/[+-]?\d+(\.\d{1,3})?/),me("X",function(e,t,n){n._d=new Date(1e3*parseFloat(e,10))}),me("x",function(e,t,n){n._d=new Date(w(e))}),t.version="2.17.0",e=Et,t.fn=rn,t.min=function(){return Ct("isBefore",[].slice.call(arguments,0))},t.max=function(){return Ct("isAfter",[].slice.call(arguments,0))},t.now=function(){return Date.now?Date.now():+new Date},t.utc=c,t.unix=function(e){return Et(1e3*e)},t.months=function(e,t){return un(e,t,"months")},t.isDate=o,t.locale=ut,t.invalid=f,t.duration=Vt,t.isMoment=_,t.weekdays=function(e,t,n){return cn(e,t,n,"weekdays")},t.parseZone=function(){return Et.apply(null,arguments).parseZone()},t.localeData=lt,t.isDuration=Pt,t.monthsShort=function(e,t){return un(e,t,"monthsShort")},t.weekdaysMin=function(e,t,n){return cn(e,t,n,"weekdaysMin")},t.defineLocale=ct,t.updateLocale=function(e,t){if(null!=t){var n,i=it;null!=rt[e]&&(i=rt[e]._config),(n=new P(t=R(i,t))).parentLocale=rt[e],rt[e]=n,ut(e)}else null!=rt[e]&&(null!=rt[e].parentLocale?rt[e]=rt[e].parentLocale:null!=rt[e]&&delete rt[e]);return rt[e]},t.locales=function(){return N(rt)},t.weekdaysShort=function(e,t,n){return cn(e,t,n,"weekdaysShort")},t.normalizeUnits=I,t.relativeTimeRounding=function(e){return void 0===e?Dn:"function"==typeof e&&(Dn=e,!0)},t.relativeTimeThreshold=function(e,t){return void 0!==In[e]&&(void 0===t?In[e]:(In[e]=t,!0))},t.calendarFormat=function(e,t){var n=e.diff(t,"days",!0);return n<-6?"sameElse":n<-1?"lastWeek":n<0?"lastDay":n<1?"sameDay":n<2?"nextDay":n<7?"nextWeek":"sameElse"},t.prototype=rn,t}),"undefined"==typeof jQuery)throw new Error("Bootstrap's JavaScript requires jQuery");!function(e){"use strict";var t=e.fn.jquery.split(" ")[0].split(".");if(t[0]<2&&t[1]<9||1==t[0]&&9==t[1]&&t[2]<1)throw new Error("Bootstrap's JavaScript requires jQuery version 1.9.1 or higher")}(jQuery),function(e){"use strict";var t=function(n,i){this.$element=e(n),this.options=e.extend({},t.DEFAULTS,i),this.isLoading=!1};function n(n){return this.each(function(){var i=e(this),r=i.data("bs.button"),o="object"==typeof n&&n;r||i.data("bs.button",r=new t(this,o)),"toggle"==n?r.toggle():n&&r.setState(n)})}t.VERSION="3.3.2",t.DEFAULTS={loadingText:"loading..."},t.prototype.setState=function(t){var n="disabled",i=this.$element,r=i.is("input")?"val":"html",o=i.data();t+="Text",null==o.resetText&&i.data("resetText",i[r]()),setTimeout(e.proxy(function(){i[r](null==o[t]?this.options[t]:o[t]),"loadingText"==t?(this.isLoading=!0,i.addClass(n).attr(n,n)):this.isLoading&&(this.isLoading=!1,i.removeClass(n).removeAttr(n))},this),0)},t.prototype.toggle=function(){var e=!0,t=this.$element.closest('[data-toggle="buttons"]');if(t.length){var n=this.$element.find("input");"radio"==n.prop("type")&&(n.prop("checked")&&this.$element.hasClass("active")?e=!1:t.find(".active").removeClass("active")),e&&n.prop("checked",!this.$element.hasClass("active")).trigger("change")}else this.$element.attr("aria-pressed",!this.$element.hasClass("active"));e&&this.$element.toggleClass("active")};var i=e.fn.button;e.fn.button=n,e.fn.button.Constructor=t,e.fn.button.noConflict=function(){return e.fn.button=i,this},e(document).on("click.bs.button.data-api",'[data-toggle^="button"]',function(t){var i=e(t.target);i.hasClass("btn")||(i=i.closest(".btn")),n.call(i,"toggle"),t.preventDefault()}).on("focus.bs.button.data-api blur.bs.button.data-api",'[data-toggle^="button"]',function(t){e(t.target).closest(".btn").toggleClass("focus",/^focus(in)?$/.test(t.type))})}(jQuery),function(e){"use strict";var t=".dropdown-backdrop",n='[data-toggle="dropdown"]',i=function(t){e(t).on("click.bs.dropdown",this.toggle)};function r(i){i&&3===i.which||(e(t).remove(),e(n).each(function(){var t=e(this),n=o(t),r={relatedTarget:this};n.hasClass("open")&&(n.trigger(i=e.Event("hide.bs.dropdown",r)),i.isDefaultPrevented()||(t.attr("aria-expanded","false"),n.removeClass("open").trigger("hidden.bs.dropdown",r)))}))}function o(t){var n=t.attr("data-target");n||(n=(n=t.attr("href"))&&/#[A-Za-z]/.test(n)&&n.replace(/.*(?=#[^\s]*$)/,""));var i=n&&e(n);return i&&i.length?i:t.parent()}i.VERSION="3.3.2",i.prototype.toggle=function(t){var n=e(this);if(!n.is(".disabled, :disabled")){var i=o(n),a=i.hasClass("open");if(r(),!a){"ontouchstart"in document.documentElement&&!i.closest(".navbar-nav").length&&e('<div class="dropdown-backdrop"/>').insertAfter(e(this)).on("click",r);var s={relatedTarget:this};if(i.trigger(t=e.Event("show.bs.dropdown",s)),t.isDefaultPrevented())return;n.trigger("focus").attr("aria-expanded","true"),i.toggleClass("open").trigger("shown.bs.dropdown",s)}return!1}},i.prototype.keydown=function(t){if(/(38|40|27|32)/.test(t.which)&&!/input|textarea/i.test(t.target.tagName)){var i=e(this);if(t.preventDefault(),t.stopPropagation(),!i.is(".disabled, :disabled")){var r=o(i),a=r.hasClass("open");if(!a&&27!=t.which||a&&27==t.which)return 27==t.which&&r.find(n).trigger("focus"),i.trigger("click");var s=" li:not(.divider):visible a",u=r.find('[role="menu"]'+s+', [role="listbox"]'+s);if(u.length){var c=u.index(t.target);38==t.which&&c>0&&c--,40==t.which&&c<u.length-1&&c++,~c||(c=0),u.eq(c).trigger("focus")}}}};var a=e.fn.dropdown;e.fn.dropdown=function(t){return this.each(function(){var n=e(this),r=n.data("bs.dropdown");r||n.data("bs.dropdown",r=new i(this)),"string"==typeof t&&r[t].call(n)})},e.fn.dropdown.Constructor=i,e.fn.dropdown.noConflict=function(){return e.fn.dropdown=a,this},e(document).on("click.bs.dropdown.data-api",r).on("click.bs.dropdown.data-api",".dropdown form",function(e){e.stopPropagation()}).on("click.bs.dropdown.data-api",n,i.prototype.toggle).on("keydown.bs.dropdown.data-api",n,i.prototype.keydown).on("keydown.bs.dropdown.data-api",'[role="menu"]',i.prototype.keydown).on("keydown.bs.dropdown.data-api",'[role="listbox"]',i.prototype.keydown)}(jQuery),function(e){"use strict";var t=function(t,n){this.options=n,this.$body=e(document.body),this.$element=e(t),this.$backdrop=this.isShown=null,this.scrollbarWidth=0,this.options.remote&&this.$element.find(".modal-content").load(this.options.remote,e.proxy(function(){this.$element.trigger("loaded.bs.modal")},this))};function n(n,i){return this.each(function(){var r=e(this),o=r.data("bs.modal"),a=e.extend({},t.DEFAULTS,r.data(),"object"==typeof n&&n);o||r.data("bs.modal",o=new t(this,a)),"string"==typeof n?o[n](i):a.show&&o.show(i)})}t.VERSION="3.3.2",t.TRANSITION_DURATION=300,t.BACKDROP_TRANSITION_DURATION=150,t.DEFAULTS={backdrop:!0,keyboard:!0,show:!0},t.prototype.toggle=function(e){return this.isShown?this.hide():this.show(e)},t.prototype.show=function(n){var i=this,r=e.Event("show.bs.modal",{relatedTarget:n});this.$element.trigger(r),this.isShown||r.isDefaultPrevented()||(this.isShown=!0,this.checkScrollbar(),this.setScrollbar(),this.$body.addClass("modal-open"),this.escape(),this.resize(),this.$element.on("click.dismiss.bs.modal",'[data-dismiss="modal"]',e.proxy(this.hide,this)),this.backdrop(function(){var r=e.support.transition&&i.$element.hasClass("fade");i.$element.parent().length||i.$element.appendTo(i.$body),i.$element.show().scrollTop(0),i.options.backdrop&&i.adjustBackdrop(),i.adjustDialog(),r&&i.$element[0].offsetWidth,i.$element.addClass("in").attr("aria-hidden",!1),i.enforceFocus();var o=e.Event("shown.bs.modal",{relatedTarget:n});r?i.$element.find(".modal-dialog").one("bsTransitionEnd",function(){i.$element.trigger("focus").trigger(o)}).emulateTransitionEnd(t.TRANSITION_DURATION):i.$element.trigger("focus").trigger(o)}))},t.prototype.hide=function(n){n&&n.preventDefault(),n=e.Event("hide.bs.modal"),this.$element.trigger(n),this.isShown&&!n.isDefaultPrevented()&&(this.isShown=!1,this.escape(),this.resize(),e(document).off("focusin.bs.modal"),this.$element.removeClass("in").attr("aria-hidden",!0).off("click.dismiss.bs.modal"),e.support.transition&&this.$element.hasClass("fade")?this.$element.one("bsTransitionEnd",e.proxy(this.hideModal,this)).emulateTransitionEnd(t.TRANSITION_DURATION):this.hideModal())},t.prototype.enforceFocus=function(){e(document).off("focusin.bs.modal").on("focusin.bs.modal",e.proxy(function(e){this.$element[0]===e.target||this.$element.has(e.target).length||this.$element.trigger("focus")},this))},t.prototype.escape=function(){this.isShown&&this.options.keyboard?this.$element.on("keydown.dismiss.bs.modal",e.proxy(function(e){27==e.which&&this.hide()},this)):this.isShown||this.$element.off("keydown.dismiss.bs.modal")},t.prototype.resize=function(){this.isShown?e(window).on("resize.bs.modal",e.proxy(this.handleUpdate,this)):e(window).off("resize.bs.modal")},t.prototype.hideModal=function(){var e=this;this.$element.hide(),this.backdrop(function(){e.$body.removeClass("modal-open"),e.resetAdjustments(),e.resetScrollbar(),e.$element.trigger("hidden.bs.modal")})},t.prototype.removeBackdrop=function(){this.$backdrop&&this.$backdrop.remove(),this.$backdrop=null},t.prototype.backdrop=function(n){var i=this,r=this.$element.hasClass("fade")?"fade":"";if(this.isShown&&this.options.backdrop){var o=e.support.transition&&r;if(this.$backdrop=e('<div class="modal-backdrop '+r+'" />').prependTo(this.$element).on("click.dismiss.bs.modal",e.proxy(function(e){e.target===e.currentTarget&&("static"==this.options.backdrop?this.$element[0].focus.call(this.$element[0]):this.hide.call(this))},this)),o&&this.$backdrop[0].offsetWidth,this.$backdrop.addClass("in"),!n)return;o?this.$backdrop.one("bsTransitionEnd",n).emulateTransitionEnd(t.BACKDROP_TRANSITION_DURATION):n()}else if(!this.isShown&&this.$backdrop){this.$backdrop.removeClass("in");var a=function(){i.removeBackdrop(),n&&n()};e.support.transition&&this.$element.hasClass("fade")?this.$backdrop.one("bsTransitionEnd",a).emulateTransitionEnd(t.BACKDROP_TRANSITION_DURATION):a()}else n&&n()},t.prototype.handleUpdate=function(){this.options.backdrop&&this.adjustBackdrop(),this.adjustDialog()},t.prototype.adjustBackdrop=function(){this.$backdrop&&this.$backdrop.css("height",0).css("height",this.$element[0].scrollHeight)},t.prototype.adjustDialog=function(){var e=this.$element[0].scrollHeight>document.documentElement.clientHeight;this.$element.css({paddingLeft:!this.bodyIsOverflowing&&e?this.scrollbarWidth:"",paddingRight:this.bodyIsOverflowing&&!e?this.scrollbarWidth:""})},t.prototype.resetAdjustments=function(){this.$element.css({paddingLeft:"",paddingRight:""})},t.prototype.checkScrollbar=function(){this.bodyIsOverflowing=document.body.scrollHeight>document.documentElement.clientHeight,this.scrollbarWidth=this.measureScrollbar()},t.prototype.setScrollbar=function(){var e=parseInt(this.$body.css("padding-right")||0,10);this.bodyIsOverflowing&&this.$body.css("padding-right",e+this.scrollbarWidth)},t.prototype.resetScrollbar=function(){this.$body.css("padding-right","")},t.prototype.measureScrollbar=function(){var e=document.createElement("div");e.className="modal-scrollbar-measure",this.$body.append(e);var t=e.offsetWidth-e.clientWidth;return this.$body[0].removeChild(e),t};var i=e.fn.modal;e.fn.modal=n,e.fn.modal.Constructor=t,e.fn.modal.noConflict=function(){return e.fn.modal=i,this},e(document).on("click.bs.modal.data-api",'[data-toggle="modal"]',function(t){var i=e(this),r=i.attr("href"),o=e(i.attr("data-target")||r&&r.replace(/.*(?=#[^\s]+$)/,"")),a=o.data("bs.modal")?"toggle":e.extend({remote:!/#/.test(r)&&r},o.data(),i.data());i.is("a")&&t.preventDefault(),o.one("show.bs.modal",function(e){e.isDefaultPrevented()||o.one("hidden.bs.modal",function(){i.is(":visible")&&i.trigger("focus")})}),n.call(o,a,this)})}(jQuery),function(e){"use strict";var t=function(e,t){this.type=this.options=this.enabled=this.timeout=this.hoverState=this.$element=null,this.init("tooltip",e,t)};t.VERSION="3.3.2",t.TRANSITION_DURATION=150,t.DEFAULTS={animation:!0,placement:"top",selector:!1,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',trigger:"hover focus",title:"",delay:0,html:!1,container:!1,viewport:{selector:"body",padding:0}},t.prototype.init=function(t,n,i){this.enabled=!0,this.type=t,this.$element=e(n),this.options=this.getOptions(i),this.$viewport=this.options.viewport&&e(this.options.viewport.selector||this.options.viewport),this.children=[];for(var r=this.options.trigger.split(" "),o=r.length;o--;){var a=r[o];if("click"==a)this.$element.on("click."+this.type,this.options.selector,e.proxy(this.toggle,this));else if("manual"!=a){var s="hover"==a?"mouseenter":"focusin",u="hover"==a?"mouseleave":"focusout";this.$element.on(s+"."+this.type,this.options.selector,e.proxy(this.enter,this)),this.$element.on(u+"."+this.type,this.options.selector,e.proxy(this.leave,this))}}this.options.selector?this._options=e.extend({},this.options,{trigger:"manual",selector:""}):this.fixTitle()},t.prototype.getDefaults=function(){return t.DEFAULTS},t.prototype.getOptions=function(t){return(t=e.extend({},this.getDefaults(),this.$element.data(),t)).delay&&"number"==typeof t.delay&&(t.delay={show:t.delay,hide:t.delay}),t},t.prototype.getDelegateOptions=function(){var t={},n=this.getDefaults();return this._options&&e.each(this._options,function(e,i){n[e]!=i&&(t[e]=i)}),t},t.prototype.enter=function(t){var n=t instanceof this.constructor?t:e(t.currentTarget).data("bs."+this.type);if(n&&n.$tip&&n.$tip.is(":visible"))n.hoverState="in";else{if(n||(n=new this.constructor(t.currentTarget,this.getDelegateOptions()),e(t.currentTarget).data("bs."+this.type,n)),clearTimeout(n.timeout),n.hoverState="in",!n.options.delay||!n.options.delay.show)return n.show();n.timeout=setTimeout(function(){"in"==n.hoverState&&n.show()},n.options.delay.show)}},t.prototype.leave=function(t){var n=t instanceof this.constructor?t:e(t.currentTarget).data("bs."+this.type);if(n||(n=new this.constructor(t.currentTarget,this.getDelegateOptions()),e(t.currentTarget).data("bs."+this.type,n)),clearTimeout(n.timeout),n.hoverState="out",!n.options.delay||!n.options.delay.hide)return n.hide();n.timeout=setTimeout(function(){"out"==n.hoverState&&n.hide()},n.options.delay.hide)},t.prototype.show=function(n){this.children.forEach(function(e){e.show(n)});var i=e.Event("show.bs."+this.type);if(this.hasContent()&&this.enabled){this.$element.trigger(i);var r=e.contains(this.$element[0].ownerDocument.documentElement,this.$element[0]);if(i.isDefaultPrevented()||!r)return;var o=this,a=this.tip(),s=this.getUID(this.type);this.setContent(),a.attr("id",s),this.$element.attr("aria-describedby",s),this.options.animation&&a.addClass("fade");var u="function"==typeof this.options.placement?this.options.placement.call(this,a[0],this.$element[0]):this.options.placement,c=/\s?auto?\s?/i,l=c.test(u);l&&(u=u.replace(c,"")||"top"),a.detach().css({top:0,left:0,display:"block"}).addClass(u).data("bs."+this.type,this),this.options.container?a.appendTo(this.options.container):a.insertAfter(this.$element);var d=this.getPosition(),p=a[0].offsetWidth,f=a[0].offsetHeight;if(l){var h=u,m=this.options.container?e(this.options.container):this.$element.parent(),g=this.getPosition(m);u="bottom"==u&&d.bottom+f>g.bottom?"top":"top"==u&&d.top-f<g.top?"bottom":"right"==u&&d.right+p>g.width?"left":"left"==u&&d.left-p<g.left?"right":u,a.removeClass(h).addClass(u)}var v=this.getCalculatedOffset(u,d,p,f);this.applyPlacement(v,u);var y=function(){var e=o.hoverState;o.$element.trigger("shown.bs."+o.type),o.hoverState=null,"out"==e&&o.leave(o)};n&&!1===n.transition||!e.support.transition||!this.$tip.hasClass("fade")?y():a.one("bsTransitionEnd",y).emulateTransitionEnd(t.TRANSITION_DURATION)}},t.prototype.applyPlacement=function(t,n){var i=this.tip(),r=i[0].offsetWidth,o=i[0].offsetHeight,a=parseInt(i.css("margin-top"),10),s=parseInt(i.css("margin-left"),10);isNaN(a)&&(a=0),isNaN(s)&&(s=0),t.top=t.top+a,t.left=t.left+s,e.offset.setOffset(i[0],e.extend({using:function(e){i.css({top:Math.round(e.top),left:Math.round(e.left)})}},t),0),i.addClass("in");var u=i[0].offsetWidth,c=i[0].offsetHeight;"top"==n&&c!=o&&(t.top=t.top+o-c);var l=this.getViewportAdjustedDelta(n,t,u,c);l.left?t.left+=l.left:t.top+=l.top;var d=/top|bottom/.test(n),p=d?2*l.left-r+u:2*l.top-o+c,f=d?"offsetWidth":"offsetHeight";i.offset(t),this.replaceArrow(p,i[0][f],d)},t.prototype.replaceArrow=function(e,t,n){this.arrow().css(n?"left":"top",50*(1-e/t)+"%").css(n?"top":"left","")},t.prototype.setContent=function(){var e=this.tip(),t=this.getTitle();e.find(".tooltip-inner")[this.options.html?"html":"text"](t),e.removeClass("fade in top bottom left right")},t.prototype.hide=function(n){var i=this;i.children.forEach(function(e){e.hide()});var r=this.tip(),o=e.Event("hide.bs."+this.type);function a(){"in"!=i.hoverState&&r.detach(),i.$element.removeAttr("aria-describedby").trigger("hidden.bs."+i.type),n&&n()}if(this.$element.trigger(o),!o.isDefaultPrevented())return r.removeClass("in"),e.support.transition&&this.$tip.hasClass("fade")?r.one("bsTransitionEnd",a).emulateTransitionEnd(t.TRANSITION_DURATION):a(),this.hoverState=null,this},t.prototype.fixTitle=function(){var e=this.$element;(e.attr("title")||"string"!=typeof e.attr("data-original-title"))&&e.attr("data-original-title",e.attr("title")||"").attr("title","")},t.prototype.hasContent=function(){return this.getTitle()},t.prototype.getPosition=function(t){var n=(t=t||this.$element)[0],i="BODY"==n.tagName,r=n.getBoundingClientRect();null==r.width&&(r=e.extend({},r,{width:r.right-r.left,height:r.bottom-r.top}));var o=i?{top:0,left:0}:t.offset(),a={scroll:i?document.documentElement.scrollTop||document.body.scrollTop:t.scrollTop()},s=i?{width:e(window).width(),height:e(window).height()}:null;return e.extend({},r,a,s,o)},t.prototype.getCalculatedOffset=function(e,t,n,i){return"bottom"==e?{top:t.top+t.height,left:t.left+t.width/2-n/2}:"top"==e?{top:t.top-i,left:t.left+t.width/2-n/2}:"left"==e?{top:t.top+t.height/2-i/2,left:t.left-n}:{top:t.top+t.height/2-i/2,left:t.left+t.width}},t.prototype.getViewportAdjustedDelta=function(e,t,n,i){var r={top:0,left:0};if(!this.$viewport)return r;var o=this.options.viewport&&this.options.viewport.padding||0,a=this.getPosition(this.$viewport);if(/right|left/.test(e)){var s=t.top-o-a.scroll,u=t.top+o-a.scroll+i;s<a.top?r.top=a.top-s:u>a.top+a.height&&(r.top=a.top+a.height-u)}else{var c=t.left-o,l=t.left+o+n;c<a.left?r.left=a.left-c:l>a.width&&(r.left=a.left+a.width-l)}return r},t.prototype.getTitle=function(){var e=this.$element,t=this.options;return e.attr("data-original-title")||("function"==typeof t.title?t.title.call(e[0]):t.title)},t.prototype.getUID=function(e){do{e+=~~(1e6*Math.random())}while(document.getElementById(e));return e},t.prototype.tip=function(){return this.$tip=this.$tip||e(this.options.template)},t.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".tooltip-arrow")},t.prototype.enable=function(){this.enabled=!0},t.prototype.disable=function(){this.enabled=!1},t.prototype.toggleEnabled=function(){this.enabled=!this.enabled},t.prototype.toggle=function(t){var n=this;t&&((n=e(t.currentTarget).data("bs."+this.type))||(n=new this.constructor(t.currentTarget,this.getDelegateOptions()),e(t.currentTarget).data("bs."+this.type,n),this.children.push(n))),n.tip().hasClass("in")?n.leave(n):n.enter(n)},t.prototype.destroy=function(){var e=this;clearTimeout(this.timeout),this.hide(function(){e.$element.off("."+e.type).removeData("bs."+e.type)}),e.children.forEach(function(e){e.destroy()}),e.children=[]};var n=e.fn.tooltip;e.fn.tooltip=function(n){return this.each(function(){var i=e(this),r=i.data("bs.tooltip"),o="object"==typeof n&&n;(r||"destroy"!=n)&&(r||i.data("bs.tooltip",r=new t(this,o)),"string"==typeof n&&r[n]())})},e.fn.tooltip.Constructor=t,e.fn.tooltip.noConflict=function(){return e.fn.tooltip=n,this}}(jQuery),function(e){"use strict";var t=function(e,t){this.init("popover",e,t)};if(!e.fn.tooltip)throw new Error("Popover requires tooltip.js");t.VERSION="3.3.2",t.DEFAULTS=e.extend({},e.fn.tooltip.Constructor.DEFAULTS,{placement:"right",trigger:"click",content:"",template:'<div class="popover" role="tooltip"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>'}),t.prototype=e.extend({},e.fn.tooltip.Constructor.prototype),t.prototype.constructor=t,t.prototype.getDefaults=function(){return t.DEFAULTS},t.prototype.setContent=function(){var e=this.tip(),t=this.getTitle(),n=this.getContent();e.find(".popover-title")[this.options.html?"html":"text"](t),e.find(".popover-content").children().detach().end()[this.options.html?"string"==typeof n?"html":"append":"text"](n),e.removeClass("fade top bottom left right in"),e.find(".popover-title").html()||e.find(".popover-title").hide()},t.prototype.hasContent=function(){return this.getTitle()||this.getContent()},t.prototype.getContent=function(){var e=this.$element,t=this.options;return e.attr("data-content")||("function"==typeof t.content?t.content.call(e[0]):t.content)},t.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".arrow")},t.prototype.tip=function(){return this.$tip||(this.$tip=e(this.options.template)),this.$tip};var n=e.fn.popover;e.fn.popover=function(n){return this.each(function(){var i=e(this),r=i.data("bs.popover"),o="object"==typeof n&&n;(r||"destroy"!=n)&&(r||i.data("bs.popover",r=new t(this,o)),"string"==typeof n&&r[n]())})},e.fn.popover.Constructor=t,e.fn.popover.noConflict=function(){return e.fn.popover=n,this}}(jQuery),function(e){"use strict";var t=function(t){this.element=e(t)};function n(n){return this.each(function(){var i=e(this),r=i.data("bs.tab");r||i.data("bs.tab",r=new t(this)),"string"==typeof n&&r[n]()})}t.VERSION="3.3.2",t.TRANSITION_DURATION=150,t.prototype.show=function(){var t=this.element,n=t.closest("ul:not(.dropdown-menu)"),i=t.data("target");if(i||(i=(i=t.attr("href"))&&i.replace(/.*(?=#[^\s]*$)/,"")),!t.parent("li").hasClass("active")){var r=n.find(".active:last a"),o=e.Event("hide.bs.tab",{relatedTarget:t[0]}),a=e.Event("show.bs.tab",{relatedTarget:r[0]});if(r.trigger(o),t.trigger(a),!a.isDefaultPrevented()&&!o.isDefaultPrevented()){var s=e(i);this.activate(t.closest("li"),n),this.activate(s,s.parent(),function(){r.trigger({type:"hidden.bs.tab",relatedTarget:t[0]}),t.trigger({type:"shown.bs.tab",relatedTarget:r[0]})})}}},t.prototype.activate=function(n,i,r){var o=i.find("> .active"),a=r&&e.support.transition&&(o.length&&o.hasClass("fade")||!!i.find("> .fade").length);function s(){o.removeClass("active").find("> .dropdown-menu > .active").removeClass("active").end().find('[data-toggle="tab"]').attr("aria-expanded",!1),n.addClass("active").find('[data-toggle="tab"]').attr("aria-expanded",!0),a?(n[0].offsetWidth,n.addClass("in")):n.removeClass("fade"),n.parent(".dropdown-menu")&&n.closest("li.dropdown").addClass("active").end().find('[data-toggle="tab"]').attr("aria-expanded",!0),r&&r()}o.length&&a?o.one("bsTransitionEnd",s).emulateTransitionEnd(t.TRANSITION_DURATION):s(),o.removeClass("in")};var i=e.fn.tab;e.fn.tab=n,e.fn.tab.Constructor=t,e.fn.tab.noConflict=function(){return e.fn.tab=i,this};var r=function(t){t.preventDefault(),n.call(e(this),"show")};e(document).on("click.bs.tab.data-api",'[data-toggle="tab"]',r).on("click.bs.tab.data-api",'[data-toggle="pill"]',r)}(jQuery),function(e){"use strict";var t=function(n,i){this.$element=e(n),this.options=e.extend({},t.DEFAULTS,i),this.$trigger=e(this.options.trigger).filter('[href="#'+n.id+'"], [data-target="#'+n.id+'"]'),this.transitioning=null,this.options.parent?this.$parent=this.getParent():this.addAriaAndCollapsedClass(this.$element,this.$trigger),this.options.toggle&&this.toggle()};function n(t){var n,i=t.attr("data-target")||(n=t.attr("href"))&&n.replace(/.*(?=#[^\s]+$)/,"");return e(i)}function i(n){return this.each(function(){var i=e(this),r=i.data("bs.collapse"),o=e.extend({},t.DEFAULTS,i.data(),"object"==typeof n&&n);!r&&o.toggle&&"show"==n&&(o.toggle=!1),r||i.data("bs.collapse",r=new t(this,o)),"string"==typeof n&&r[n]()})}t.VERSION="3.3.2",t.TRANSITION_DURATION=350,t.DEFAULTS={toggle:!0,trigger:'[data-toggle="collapse"]'},t.prototype.dimension=function(){return this.$element.hasClass("width")?"width":"height"},t.prototype.show=function(){if(!this.transitioning&&!this.$element.hasClass("in")){var n,r=this.$parent&&this.$parent.children(".panel").children(".in, .collapsing");if(!(r&&r.length&&(n=r.data("bs.collapse"))&&n.transitioning)){var o=e.Event("show.bs.collapse");if(this.$element.trigger(o),!o.isDefaultPrevented()){r&&r.length&&(i.call(r,"hide"),n||r.data("bs.collapse",null));var a=this.dimension();this.$element.removeClass("collapse").addClass("collapsing")[a](0).attr("aria-expanded",!0),this.$trigger.removeClass("collapsed").attr("aria-expanded",!0),this.transitioning=1;var s=function(){this.$element.removeClass("collapsing").addClass("collapse in")[a](""),this.transitioning=0,this.$element.trigger("shown.bs.collapse")};if(!e.support.transition)return s.call(this);var u=e.camelCase(["scroll",a].join("-"));this.$element.one("bsTransitionEnd",e.proxy(s,this)).emulateTransitionEnd(t.TRANSITION_DURATION)[a](this.$element[0][u])}}}},t.prototype.hide=function(){if(!this.transitioning&&this.$element.hasClass("in")){var n=e.Event("hide.bs.collapse");if(this.$element.trigger(n),!n.isDefaultPrevented()){var i=this.dimension();this.$element[i](this.$element[i]())[0].offsetHeight,this.$element.addClass("collapsing").removeClass("collapse in").attr("aria-expanded",!1),this.$trigger.addClass("collapsed").attr("aria-expanded",!1),this.transitioning=1;var r=function(){this.transitioning=0,this.$element.removeClass("collapsing").addClass("collapse").trigger("hidden.bs.collapse")};if(!e.support.transition)return r.call(this);this.$element[i](0).one("bsTransitionEnd",e.proxy(r,this)).emulateTransitionEnd(t.TRANSITION_DURATION)}}},t.prototype.toggle=function(){this[this.$element.hasClass("in")?"hide":"show"]()},t.prototype.getParent=function(){return e(this.options.parent).find('[data-toggle="collapse"][data-parent="'+this.options.parent+'"]').each(e.proxy(function(t,i){var r=e(i);this.addAriaAndCollapsedClass(n(r),r)},this)).end()},t.prototype.addAriaAndCollapsedClass=function(e,t){var n=e.hasClass("in");e.attr("aria-expanded",n),t.toggleClass("collapsed",!n).attr("aria-expanded",n)};var r=e.fn.collapse;e.fn.collapse=i,e.fn.collapse.Constructor=t,e.fn.collapse.noConflict=function(){return e.fn.collapse=r,this},e(document).on("click.bs.collapse.data-api",'[data-toggle="collapse"]',function(t){var r=e(this);r.attr("data-target")||t.preventDefault();var o=n(r),a=o.data("bs.collapse")?"toggle":e.extend({},r.data(),{trigger:this});i.call(o,a)})}(jQuery),function(e){"use strict";e.fn.emulateTransitionEnd=function(t){var n=!1,i=this;e(this).one("bsTransitionEnd",function(){n=!0});return setTimeout(function(){n||e(i).trigger(e.support.transition.end)},t),this},e(function(){e.support.transition=function(){var e=document.createElement("bootstrap"),t={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"};for(var n in t)if(void 0!==e.style[n])return{end:t[n]};return!1}(),e.support.transition&&(e.event.special.bsTransitionEnd={bindType:e.support.transition.end,delegateType:e.support.transition.end,handle:function(t){if(e(t.target).is(this))return t.handleObj.handler.apply(this,arguments)}})})}(jQuery),define("bootstrap",["jquery"],function(){}),function(e){void 0===e.fn.each2&&e.extend(e.fn,{each2:function(t){for(var n=e([0]),i=-1,r=this.length;++i<r&&(n.context=n[0]=this[i])&&!1!==t.call(n[0],i,n););return this}})}(jQuery),function(e,t){"use strict";if(window.Select2===t){var n,i,r,o,a,s,u,c,l={x:0,y:0},d={TAB:9,ENTER:13,ESC:27,SPACE:32,LEFT:37,UP:38,RIGHT:39,DOWN:40,SHIFT:16,CTRL:17,ALT:18,PAGE_UP:33,PAGE_DOWN:34,HOME:36,END:35,BACKSPACE:8,DELETE:46,isArrow:function(e){switch(e=e.which?e.which:e){case d.LEFT:case d.RIGHT:case d.UP:case d.DOWN:return!0}return!1},isControl:function(e){switch(e.which){case d.SHIFT:case d.CTRL:case d.ALT:return!0}return!!e.metaKey},isFunctionKey:function(e){return(e=e.which?e.which:e)>=112&&e<=123}},p="<div class='select2-measure-scrollbar'></div>",f={"Ⓐ":"A","Ａ":"A","À":"A","Á":"A","Â":"A","Ầ":"A","Ấ":"A","Ẫ":"A","Ẩ":"A","Ã":"A","Ā":"A","Ă":"A","Ằ":"A","Ắ":"A","Ẵ":"A","Ẳ":"A","Ȧ":"A","Ǡ":"A","Ä":"A","Ǟ":"A","Ả":"A","Å":"A","Ǻ":"A","Ǎ":"A","Ȁ":"A","Ȃ":"A","Ạ":"A","Ậ":"A","Ặ":"A","Ḁ":"A","Ą":"A","Ⱥ":"A","Ɐ":"A","Ꜳ":"AA","Æ":"AE","Ǽ":"AE","Ǣ":"AE","Ꜵ":"AO","Ꜷ":"AU","Ꜹ":"AV","Ꜻ":"AV","Ꜽ":"AY","Ⓑ":"B","Ｂ":"B","Ḃ":"B","Ḅ":"B","Ḇ":"B","Ƀ":"B","Ƃ":"B","Ɓ":"B","Ⓒ":"C","Ｃ":"C","Ć":"C","Ĉ":"C","Ċ":"C","Č":"C","Ç":"C","Ḉ":"C","Ƈ":"C","Ȼ":"C","Ꜿ":"C","Ⓓ":"D","Ｄ":"D","Ḋ":"D","Ď":"D","Ḍ":"D","Ḑ":"D","Ḓ":"D","Ḏ":"D","Đ":"D","Ƌ":"D","Ɗ":"D","Ɖ":"D","Ꝺ":"D","Ǳ":"DZ","Ǆ":"DZ","ǲ":"Dz","ǅ":"Dz","Ⓔ":"E","Ｅ":"E","È":"E","É":"E","Ê":"E","Ề":"E","Ế":"E","Ễ":"E","Ể":"E","Ẽ":"E","Ē":"E","Ḕ":"E","Ḗ":"E","Ĕ":"E","Ė":"E","Ë":"E","Ẻ":"E","Ě":"E","Ȅ":"E","Ȇ":"E","Ẹ":"E","Ệ":"E","Ȩ":"E","Ḝ":"E","Ę":"E","Ḙ":"E","Ḛ":"E","Ɛ":"E","Ǝ":"E","Ⓕ":"F","Ｆ":"F","Ḟ":"F","Ƒ":"F","Ꝼ":"F","Ⓖ":"G","Ｇ":"G","Ǵ":"G","Ĝ":"G","Ḡ":"G","Ğ":"G","Ġ":"G","Ǧ":"G","Ģ":"G","Ǥ":"G","Ɠ":"G","Ꞡ":"G","Ᵹ":"G","Ꝿ":"G","Ⓗ":"H","Ｈ":"H","Ĥ":"H","Ḣ":"H","Ḧ":"H","Ȟ":"H","Ḥ":"H","Ḩ":"H","Ḫ":"H","Ħ":"H","Ⱨ":"H","Ⱶ":"H","Ɥ":"H","Ⓘ":"I","Ｉ":"I","Ì":"I","Í":"I","Î":"I","Ĩ":"I","Ī":"I","Ĭ":"I","İ":"I","Ï":"I","Ḯ":"I","Ỉ":"I","Ǐ":"I","Ȉ":"I","Ȋ":"I","Ị":"I","Į":"I","Ḭ":"I","Ɨ":"I","Ⓙ":"J","Ｊ":"J","Ĵ":"J","Ɉ":"J","Ⓚ":"K","Ｋ":"K","Ḱ":"K","Ǩ":"K","Ḳ":"K","Ķ":"K","Ḵ":"K","Ƙ":"K","Ⱪ":"K","Ꝁ":"K","Ꝃ":"K","Ꝅ":"K","Ꞣ":"K","Ⓛ":"L","Ｌ":"L","Ŀ":"L","Ĺ":"L","Ľ":"L","Ḷ":"L","Ḹ":"L","Ļ":"L","Ḽ":"L","Ḻ":"L","Ł":"L","Ƚ":"L","Ɫ":"L","Ⱡ":"L","Ꝉ":"L","Ꝇ":"L","Ꞁ":"L","Ǉ":"LJ","ǈ":"Lj","Ⓜ":"M","Ｍ":"M","Ḿ":"M","Ṁ":"M","Ṃ":"M","Ɱ":"M","Ɯ":"M","Ⓝ":"N","Ｎ":"N","Ǹ":"N","Ń":"N","Ñ":"N","Ṅ":"N","Ň":"N","Ṇ":"N","Ņ":"N","Ṋ":"N","Ṉ":"N","Ƞ":"N","Ɲ":"N","Ꞑ":"N","Ꞥ":"N","Ǌ":"NJ","ǋ":"Nj","Ⓞ":"O","Ｏ":"O","Ò":"O","Ó":"O","Ô":"O","Ồ":"O","Ố":"O","Ỗ":"O","Ổ":"O","Õ":"O","Ṍ":"O","Ȭ":"O","Ṏ":"O","Ō":"O","Ṑ":"O","Ṓ":"O","Ŏ":"O","Ȯ":"O","Ȱ":"O","Ö":"O","Ȫ":"O","Ỏ":"O","Ő":"O","Ǒ":"O","Ȍ":"O","Ȏ":"O","Ơ":"O","Ờ":"O","Ớ":"O","Ỡ":"O","Ở":"O","Ợ":"O","Ọ":"O","Ộ":"O","Ǫ":"O","Ǭ":"O","Ø":"O","Ǿ":"O","Ɔ":"O","Ɵ":"O","Ꝋ":"O","Ꝍ":"O","Ƣ":"OI","Ꝏ":"OO","Ȣ":"OU","Ⓟ":"P","Ｐ":"P","Ṕ":"P","Ṗ":"P","Ƥ":"P","Ᵽ":"P","Ꝑ":"P","Ꝓ":"P","Ꝕ":"P","Ⓠ":"Q","Ｑ":"Q","Ꝗ":"Q","Ꝙ":"Q","Ɋ":"Q","Ⓡ":"R","Ｒ":"R","Ŕ":"R","Ṙ":"R","Ř":"R","Ȑ":"R","Ȓ":"R","Ṛ":"R","Ṝ":"R","Ŗ":"R","Ṟ":"R","Ɍ":"R","Ɽ":"R","Ꝛ":"R","Ꞧ":"R","Ꞃ":"R","Ⓢ":"S","Ｓ":"S","ẞ":"S","Ś":"S","Ṥ":"S","Ŝ":"S","Ṡ":"S","Š":"S","Ṧ":"S","Ṣ":"S","Ṩ":"S","Ș":"S","Ş":"S","Ȿ":"S","Ꞩ":"S","Ꞅ":"S","Ⓣ":"T","Ｔ":"T","Ṫ":"T","Ť":"T","Ṭ":"T","Ț":"T","Ţ":"T","Ṱ":"T","Ṯ":"T","Ŧ":"T","Ƭ":"T","Ʈ":"T","Ⱦ":"T","Ꞇ":"T","Ꜩ":"TZ","Ⓤ":"U","Ｕ":"U","Ù":"U","Ú":"U","Û":"U","Ũ":"U","Ṹ":"U","Ū":"U","Ṻ":"U","Ŭ":"U","Ü":"U","Ǜ":"U","Ǘ":"U","Ǖ":"U","Ǚ":"U","Ủ":"U","Ů":"U","Ű":"U","Ǔ":"U","Ȕ":"U","Ȗ":"U","Ư":"U","Ừ":"U","Ứ":"U","Ữ":"U","Ử":"U","Ự":"U","Ụ":"U","Ṳ":"U","Ų":"U","Ṷ":"U","Ṵ":"U","Ʉ":"U","Ⓥ":"V","Ｖ":"V","Ṽ":"V","Ṿ":"V","Ʋ":"V","Ꝟ":"V","Ʌ":"V","Ꝡ":"VY","Ⓦ":"W","Ｗ":"W","Ẁ":"W","Ẃ":"W","Ŵ":"W","Ẇ":"W","Ẅ":"W","Ẉ":"W","Ⱳ":"W","Ⓧ":"X","Ｘ":"X","Ẋ":"X","Ẍ":"X","Ⓨ":"Y","Ｙ":"Y","Ỳ":"Y","Ý":"Y","Ŷ":"Y","Ỹ":"Y","Ȳ":"Y","Ẏ":"Y","Ÿ":"Y","Ỷ":"Y","Ỵ":"Y","Ƴ":"Y","Ɏ":"Y","Ỿ":"Y","Ⓩ":"Z","Ｚ":"Z","Ź":"Z","Ẑ":"Z","Ż":"Z","Ž":"Z","Ẓ":"Z","Ẕ":"Z","Ƶ":"Z","Ȥ":"Z","Ɀ":"Z","Ⱬ":"Z","Ꝣ":"Z","ⓐ":"a","ａ":"a","ẚ":"a","à":"a","á":"a","â":"a","ầ":"a","ấ":"a","ẫ":"a","ẩ":"a","ã":"a","ā":"a","ă":"a","ằ":"a","ắ":"a","ẵ":"a","ẳ":"a","ȧ":"a","ǡ":"a","ä":"a","ǟ":"a","ả":"a","å":"a","ǻ":"a","ǎ":"a","ȁ":"a","ȃ":"a","ạ":"a","ậ":"a","ặ":"a","ḁ":"a","ą":"a","ⱥ":"a","ɐ":"a","ꜳ":"aa","æ":"ae","ǽ":"ae","ǣ":"ae","ꜵ":"ao","ꜷ":"au","ꜹ":"av","ꜻ":"av","ꜽ":"ay","ⓑ":"b","ｂ":"b","ḃ":"b","ḅ":"b","ḇ":"b","ƀ":"b","ƃ":"b","ɓ":"b","ⓒ":"c","ｃ":"c","ć":"c","ĉ":"c","ċ":"c","č":"c","ç":"c","ḉ":"c","ƈ":"c","ȼ":"c","ꜿ":"c","ↄ":"c","ⓓ":"d","ｄ":"d","ḋ":"d","ď":"d","ḍ":"d","ḑ":"d","ḓ":"d","ḏ":"d","đ":"d","ƌ":"d","ɖ":"d","ɗ":"d","ꝺ":"d","ǳ":"dz","ǆ":"dz","ⓔ":"e","ｅ":"e","è":"e","é":"e","ê":"e","ề":"e","ế":"e","ễ":"e","ể":"e","ẽ":"e","ē":"e","ḕ":"e","ḗ":"e","ĕ":"e","ė":"e","ë":"e","ẻ":"e","ě":"e","ȅ":"e","ȇ":"e","ẹ":"e","ệ":"e","ȩ":"e","ḝ":"e","ę":"e","ḙ":"e","ḛ":"e","ɇ":"e","ɛ":"e","ǝ":"e","ⓕ":"f","ｆ":"f","ḟ":"f","ƒ":"f","ꝼ":"f","ⓖ":"g","ｇ":"g","ǵ":"g","ĝ":"g","ḡ":"g","ğ":"g","ġ":"g","ǧ":"g","ģ":"g","ǥ":"g","ɠ":"g","ꞡ":"g","ᵹ":"g","ꝿ":"g","ⓗ":"h","ｈ":"h","ĥ":"h","ḣ":"h","ḧ":"h","ȟ":"h","ḥ":"h","ḩ":"h","ḫ":"h","ẖ":"h","ħ":"h","ⱨ":"h","ⱶ":"h","ɥ":"h","ƕ":"hv","ⓘ":"i","ｉ":"i","ì":"i","í":"i","î":"i","ĩ":"i","ī":"i","ĭ":"i","ï":"i","ḯ":"i","ỉ":"i","ǐ":"i","ȉ":"i","ȋ":"i","ị":"i","į":"i","ḭ":"i","ɨ":"i","ı":"i","ⓙ":"j","ｊ":"j","ĵ":"j","ǰ":"j","ɉ":"j","ⓚ":"k","ｋ":"k","ḱ":"k","ǩ":"k","ḳ":"k","ķ":"k","ḵ":"k","ƙ":"k","ⱪ":"k","ꝁ":"k","ꝃ":"k","ꝅ":"k","ꞣ":"k","ⓛ":"l","ｌ":"l","ŀ":"l","ĺ":"l","ľ":"l","ḷ":"l","ḹ":"l","ļ":"l","ḽ":"l","ḻ":"l","ſ":"l","ł":"l","ƚ":"l","ɫ":"l","ⱡ":"l","ꝉ":"l","ꞁ":"l","ꝇ":"l","ǉ":"lj","ⓜ":"m","ｍ":"m","ḿ":"m","ṁ":"m","ṃ":"m","ɱ":"m","ɯ":"m","ⓝ":"n","ｎ":"n","ǹ":"n","ń":"n","ñ":"n","ṅ":"n","ň":"n","ṇ":"n","ņ":"n","ṋ":"n","ṉ":"n","ƞ":"n","ɲ":"n","ŉ":"n","ꞑ":"n","ꞥ":"n","ǌ":"nj","ⓞ":"o","ｏ":"o","ò":"o","ó":"o","ô":"o","ồ":"o","ố":"o","ỗ":"o","ổ":"o","õ":"o","ṍ":"o","ȭ":"o","ṏ":"o","ō":"o","ṑ":"o","ṓ":"o","ŏ":"o","ȯ":"o","ȱ":"o","ö":"o","ȫ":"o","ỏ":"o","ő":"o","ǒ":"o","ȍ":"o","ȏ":"o","ơ":"o","ờ":"o","ớ":"o","ỡ":"o","ở":"o","ợ":"o","ọ":"o","ộ":"o","ǫ":"o","ǭ":"o","ø":"o","ǿ":"o","ɔ":"o","ꝋ":"o","ꝍ":"o","ɵ":"o","ƣ":"oi","ȣ":"ou","ꝏ":"oo","ⓟ":"p","ｐ":"p","ṕ":"p","ṗ":"p","ƥ":"p","ᵽ":"p","ꝑ":"p","ꝓ":"p","ꝕ":"p","ⓠ":"q","ｑ":"q","ɋ":"q","ꝗ":"q","ꝙ":"q","ⓡ":"r","ｒ":"r","ŕ":"r","ṙ":"r","ř":"r","ȑ":"r","ȓ":"r","ṛ":"r","ṝ":"r","ŗ":"r","ṟ":"r","ɍ":"r","ɽ":"r","ꝛ":"r","ꞧ":"r","ꞃ":"r","ⓢ":"s","ｓ":"s","ß":"s","ś":"s","ṥ":"s","ŝ":"s","ṡ":"s","š":"s","ṧ":"s","ṣ":"s","ṩ":"s","ș":"s","ş":"s","ȿ":"s","ꞩ":"s","ꞅ":"s","ẛ":"s","ⓣ":"t","ｔ":"t","ṫ":"t","ẗ":"t","ť":"t","ṭ":"t","ț":"t","ţ":"t","ṱ":"t","ṯ":"t","ŧ":"t","ƭ":"t","ʈ":"t","ⱦ":"t","ꞇ":"t","ꜩ":"tz","ⓤ":"u","ｕ":"u","ù":"u","ú":"u","û":"u","ũ":"u","ṹ":"u","ū":"u","ṻ":"u","ŭ":"u","ü":"u","ǜ":"u","ǘ":"u","ǖ":"u","ǚ":"u","ủ":"u","ů":"u","ű":"u","ǔ":"u","ȕ":"u","ȗ":"u","ư":"u","ừ":"u","ứ":"u","ữ":"u","ử":"u","ự":"u","ụ":"u","ṳ":"u","ų":"u","ṷ":"u","ṵ":"u","ʉ":"u","ⓥ":"v","ｖ":"v","ṽ":"v","ṿ":"v","ʋ":"v","ꝟ":"v","ʌ":"v","ꝡ":"vy","ⓦ":"w","ｗ":"w","ẁ":"w","ẃ":"w","ŵ":"w","ẇ":"w","ẅ":"w","ẘ":"w","ẉ":"w","ⱳ":"w","ⓧ":"x","ｘ":"x","ẋ":"x","ẍ":"x","ⓨ":"y","ｙ":"y","ỳ":"y","ý":"y","ŷ":"y","ỹ":"y","ȳ":"y","ẏ":"y","ÿ":"y","ỷ":"y","ẙ":"y","ỵ":"y","ƴ":"y","ɏ":"y","ỿ":"y","ⓩ":"z","ｚ":"z","ź":"z","ẑ":"z","ż":"z","ž":"z","ẓ":"z","ẕ":"z","ƶ":"z","ȥ":"z","ɀ":"z","ⱬ":"z","ꝣ":"z","Ά":"Α","Έ":"Ε","Ή":"Η","Ί":"Ι","Ϊ":"Ι","Ό":"Ο","Ύ":"Υ","Ϋ":"Υ","Ώ":"Ω","ά":"α","έ":"ε","ή":"η","ί":"ι","ϊ":"ι","ΐ":"ι","ό":"ο","ύ":"υ","ϋ":"υ","ΰ":"υ","ω":"ω","ς":"σ"};s=e(document),c=1,o=function(){return c++},i=D(n=D(Object,{bind:function(e){var t=this;return function(){e.apply(t,arguments)}},init:function(n){var i,r;this.opts=n=this.prepareOpts(n),this.id=n.id,n.element.data("select2")!==t&&null!==n.element.data("select2")&&n.element.data("select2").destroy(),this.container=this.createContainer(),this.liveRegion=e(".select2-hidden-accessible"),0==this.liveRegion.length&&(this.liveRegion=e("<span>",{role:"status","aria-live":"polite"}).addClass("select2-hidden-accessible").appendTo(document.body)),this.containerId="s2id_"+(n.element.attr("id")||"autogen"+o()),this.containerEventName=this.containerId.replace(/([.])/g,"_").replace(/([;&,\-\.\+\*\~':"\!\^#$%@\[\]\(\)=>\|])/g,"\\$1"),this.container.attr("id",this.containerId),this.container.attr("title",n.element.attr("title")),this.body=e(document.body),k(this.container,this.opts.element,this.opts.adaptContainerCssClass),this.container.attr("style",n.element.attr("style")),this.container.css(N(n.containerCss,this.opts.element)),this.container.addClass(N(n.containerCssClass,this.opts.element)),this.elementTabIndex=this.opts.element.attr("tabindex"),this.opts.element.data("select2",this).attr("tabindex","-1").before(this.container).on("click.select2",A),this.container.data("select2",this),this.dropdown=this.container.find(".select2-drop"),k(this.dropdown,this.opts.element,this.opts.adaptDropdownCssClass),this.dropdown.addClass(N(n.dropdownCssClass,this.opts.element)),this.dropdown.data("select2",this),this.dropdown.on("click",A),this.results=i=this.container.find(".select2-results"),this.search=r=this.container.find("input.select2-input"),this.queryCount=0,this.resultsPage=0,this.context=null,this.initContainer(),this.container.on("click",A),this.results.on("mousemove",function(n){var i=l;i!==t&&i.x===n.pageX&&i.y===n.pageY||e(n.target).trigger("mousemove-filtered",n)}),this.dropdown.on("mousemove-filtered",".select2-results",this.bind(this.highlightUnderEvent)),this.dropdown.on("touchstart touchmove touchend",".select2-results",this.bind(function(e){this._touchEvent=!0,this.highlightUnderEvent(e)})),this.dropdown.on("touchmove",".select2-results",this.bind(this.touchMoved)),this.dropdown.on("touchstart touchend",".select2-results",this.bind(this.clearTouchMoved)),this.dropdown.on("click",this.bind(function(e){this._touchEvent&&(this._touchEvent=!1,this.selectHighlighted())})),function(e,t){var n=w(e,function(e){t.trigger("scroll-debounced",e)});t.on("scroll",function(e){g(e.target,t.get())>=0&&n(e)})}(80,this.results),this.dropdown.on("scroll-debounced",".select2-results",this.bind(this.loadMoreIfNeeded)),e(this.container).on("change",".select2-input",function(e){e.stopPropagation()}),e(this.dropdown).on("change",".select2-input",function(e){e.stopPropagation()}),e.fn.mousewheel&&i.mousewheel(function(e,t,n,r){var o=i.scrollTop();r>0&&o-r<=0?(i.scrollTop(0),A(e)):r<0&&i.get(0).scrollHeight-i.scrollTop()+r<=i.height()&&(i.scrollTop(i.get(0).scrollHeight-i.height()),A(e))}),b(r),r.on("keyup-change input paste",this.bind(this.updateResults)),r.on("focus",function(){r.addClass("select2-focused")}),r.on("blur",function(){r.removeClass("select2-focused")}),this.dropdown.on("mouseup",".select2-results",this.bind(function(t){e(t.target).closest(".select2-result-selectable").length>0&&(this.highlightUnderEvent(t),this.selectHighlighted(t))})),this.dropdown.on("click mouseup mousedown touchstart touchend focusin",function(e){e.stopPropagation()}),this.nextSearchTerm=t,e.isFunction(this.opts.initSelection)&&(this.initSelection(),this.monitorSource()),null!==n.maximumInputLength&&this.search.attr("maxlength",n.maximumInputLength);var a=n.element.prop("disabled");a===t&&(a=!1),this.enable(!a);var s=n.element.prop("readonly");s===t&&(s=!1),this.readonly(s),u=u||function(){var t=e(p);t.appendTo(document.body);var n={width:t.width()-t[0].clientWidth,height:t.height()-t[0].clientHeight};return t.remove(),n}(),this.autofocus=n.element.prop("autofocus"),n.element.prop("autofocus",!1),this.autofocus&&this.focus(),this.search.attr("placeholder",n.searchInputPlaceholder)},destroy:function(){var e=this.opts.element,n=e.data("select2"),i=this;this.close(),e.length&&e[0].detachEvent&&i._sync&&e.each(function(){i._sync&&this.detachEvent("onpropertychange",i._sync)}),this.propertyObserver&&(this.propertyObserver.disconnect(),this.propertyObserver=null),this._sync=null,n!==t&&(n.container.remove(),n.liveRegion.remove(),n.dropdown.remove(),e.show().removeData("select2").off(".select2").prop("autofocus",this.autofocus||!1),this.elementTabIndex?e.attr({tabindex:this.elementTabIndex}):e.removeAttr("tabindex"),e.css("display","")),O.call(this,"container","liveRegion","dropdown","results","search")},optionToData:function(e){return e.is("option")?{id:e.prop("value"),text:e.text(),element:e.get(),css:e.attr("class"),disabled:e.prop("disabled"),locked:v(e.attr("locked"),"locked")||v(e.data("locked"),!0)}:e.is("optgroup")?{text:e.attr("label"),children:[],element:e.get(),css:e.attr("class")}:void 0},prepareOpts:function(n){var i,r,a,s,u=this;if("select"===(i=n.element).get(0).tagName.toLowerCase()&&(this.select=r=n.element),r&&e.each(["id","multiple","ajax","query","createSearchChoice","initSelection","data","tags"],function(){if(this in n)throw new Error("Option '"+this+"' is not allowed for Select2 when attached to a <select> element.")}),"function"!=typeof(n=e.extend({},{populateResults:function(i,r,a){var s,c=this.opts.id,l=this.liveRegion;(s=function(i,r,d){var p,f,h,m,g,v,y,_,b,w,A=[];for(p=0,f=(i=n.sortResults(i,r,a)).length;p<f;p+=1)m=!(g=!0===(h=i[p]).disabled)&&c(h)!==t,v=h.children&&h.children.length>0,(y=e("<li></li>")).addClass("select2-results-dept-"+d),y.addClass("select2-result"),y.addClass(m?"select2-result-selectable":"select2-result-unselectable"),g&&y.addClass("select2-disabled"),v&&y.addClass("select2-result-with-children"),y.addClass(u.opts.formatResultCssClass(h)),y.attr("role","presentation"),(_=e(document.createElement("div"))).addClass("select2-result-label"),_.attr("id","select2-result-label-"+o()),_.attr("role","option"),(w=n.formatResult(h,_,a,u.opts.escapeMarkup))!==t&&(_.html(w),y.append(_)),v&&((b=e("<ul></ul>")).addClass("select2-result-sub"),s(h.children,b,d+1),y.append(b)),y.data("select2-data",h),A.push(y[0]);r.append(A),l.text(n.formatMatches(i.length))})(r,i,0)}},e.fn.select2.defaults,n)).id&&(a=n.id,n.id=function(e){return e[a]}),e.isArray(n.element.data("select2Tags"))){if("tags"in n)throw"tags specified as both an attribute 'data-select2-tags' and in options of Select2 "+n.element.attr("id");n.tags=n.element.data("select2Tags")}if(r?(n.query=this.bind(function(e){var n,r,o,a={results:[],more:!1},s=e.term;o=function(t,n){var i;t.is("option")?e.matcher(s,t.text(),t)&&n.push(u.optionToData(t)):t.is("optgroup")&&(i=u.optionToData(t),t.children().each2(function(e,t){o(t,i.children)}),i.children.length>0&&n.push(i))},n=i.children(),this.getPlaceholder()!==t&&n.length>0&&(r=this.getPlaceholderOption())&&(n=n.not(r)),n.each2(function(e,t){o(t,a.results)}),e.callback(a)}),n.id=function(e){return e.id}):"query"in n||("ajax"in n?((s=n.element.data("ajax-url"))&&s.length>0&&(n.ajax.url=s),n.query=S.call(n.element,n.ajax)):"data"in n?n.query=C(n.data):"tags"in n&&(n.query=R(n.tags),n.createSearchChoice===t&&(n.createSearchChoice=function(t){return{id:e.trim(t),text:e.trim(t)}}),n.initSelection===t&&(n.initSelection=function(t,i){var r=[];e(y(t.val(),n.separator,n.transformVal)).each(function(){var t={id:this,text:this},i=n.tags;e.isFunction(i)&&(i=i()),e(i).each(function(){if(v(this.id,t.id))return t=this,!1}),r.push(t)}),i(r)}))),"function"!=typeof n.query)throw"query function not defined for Select2 "+n.element.attr("id");if("top"===n.createSearchChoicePosition)n.createSearchChoicePosition=function(e,t){e.unshift(t)};else if("bottom"===n.createSearchChoicePosition)n.createSearchChoicePosition=function(e,t){e.push(t)};else if("function"!=typeof n.createSearchChoicePosition)throw"invalid createSearchChoicePosition option must be 'top', 'bottom' or a custom function";return n},monitorSource:function(){var n,i=this.opts.element,r=this;i.on("change.select2",this.bind(function(e){!0!==this.opts.element.data("select2-change-triggered")&&this.initSelection()})),this._sync=this.bind(function(){var e=i.prop("disabled");e===t&&(e=!1),this.enable(!e);var n=i.prop("readonly");n===t&&(n=!1),this.readonly(n),this.container&&(k(this.container,this.opts.element,this.opts.adaptContainerCssClass),this.container.addClass(N(this.opts.containerCssClass,this.opts.element))),this.dropdown&&(k(this.dropdown,this.opts.element,this.opts.adaptDropdownCssClass),this.dropdown.addClass(N(this.opts.dropdownCssClass,this.opts.element)))}),i.length&&i[0].attachEvent&&i.each(function(){this.attachEvent("onpropertychange",r._sync)}),(n=window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver)!==t&&(this.propertyObserver&&(delete this.propertyObserver,this.propertyObserver=null),this.propertyObserver=new n(function(t){e.each(t,r._sync)}),this.propertyObserver.observe(i.get(0),{attributes:!0,subtree:!1}))},triggerSelect:function(t){var n=e.Event("select2-selecting",{val:this.id(t),object:t,choice:t});return this.opts.element.trigger(n),!n.isDefaultPrevented()},triggerChange:function(t){t=t||{},t=e.extend({},t,{type:"change",val:this.val()}),this.opts.element.data("select2-change-triggered",!0),this.opts.element.trigger(t),this.opts.element.data("select2-change-triggered",!1),this.opts.element.click(),this.opts.blurOnChange&&this.opts.element.blur()},isInterfaceEnabled:function(){return!0===this.enabledInterface},enableInterface:function(){var e=this._enabled&&!this._readonly,t=!e;return e!==this.enabledInterface&&(this.container.toggleClass("select2-container-disabled",t),this.close(),this.enabledInterface=e,!0)},enable:function(e){e===t&&(e=!0),this._enabled!==e&&(this._enabled=e,this.opts.element.prop("disabled",!e),this.enableInterface())},disable:function(){this.enable(!1)},readonly:function(e){e===t&&(e=!1),this._readonly!==e&&(this._readonly=e,this.opts.element.prop("readonly",e),this.enableInterface())},opened:function(){return!!this.container&&this.container.hasClass("select2-dropdown-open")},positionDropdown:function(){var t,n,i,r,o,a=this.dropdown,s=this.container,c=s.offset(),l=s.outerHeight(!1),d=s.outerWidth(!1),p=a.outerHeight(!1),f=e(window),h=f.width(),m=f.height(),g=f.scrollLeft()+h,v=f.scrollTop()+m,y=c.top+l,_=c.left,b=y+p<=v,w=c.top-p>=f.scrollTop(),A=a.outerWidth(!1);a.hasClass("select2-drop-above")?(n=!0,!w&&b&&(i=!0,n=!1)):(n=!1,!b&&w&&(i=!0,n=!0)),i&&(a.hide(),c=this.container.offset(),l=this.container.outerHeight(!1),d=this.container.outerWidth(!1),p=a.outerHeight(!1),g=f.scrollLeft()+h,v=f.scrollTop()+m,y=c.top+l,_=c.left,A=a.outerWidth(!1),a.show(),this.focusSearch()),this.opts.dropdownAutoWidth?(o=e(".select2-results",a)[0],a.addClass("select2-drop-auto-width"),a.css("width",""),(A=a.outerWidth(!1)+(o.scrollHeight===o.clientHeight?0:u.width))>d?d=A:A=d,p=a.outerHeight(!1)):this.container.removeClass("select2-drop-auto-width"),"static"!==this.body.css("position")&&(y-=(t=this.body.offset()).top,_-=t.left),!(_+A<=g)&&c.left+g+s.outerWidth(!1)>A&&(_=c.left+this.container.outerWidth(!1)-A),r={left:_,width:d},n?(r.top=c.top-p,r.bottom="auto",this.container.addClass("select2-drop-above"),a.addClass("select2-drop-above")):(r.top=y,r.bottom="auto",this.container.removeClass("select2-drop-above"),a.removeClass("select2-drop-above")),r=e.extend(r,N(this.opts.dropdownCss,this.opts.element)),a.css(r)},shouldOpen:function(){var t;return!this.opened()&&(!1!==this._enabled&&!0!==this._readonly&&(t=e.Event("select2-opening"),this.opts.element.trigger(t),!t.isDefaultPrevented()))},clearDropdownAlignmentPreference:function(){this.container.removeClass("select2-drop-above"),this.dropdown.removeClass("select2-drop-above")},open:function(){return!!this.shouldOpen()&&(this.opening(),s.on("mousemove.select2Event",function(e){l.x=e.pageX,l.y=e.pageY}),!0)},opening:function(){var t,n=this.containerEventName,i="scroll."+n,r="resize."+n,o="orientationchange."+n;this.container.addClass("select2-dropdown-open").addClass("select2-container-active"),this.clearDropdownAlignmentPreference(),this.dropdown[0]!==this.body.children().last()[0]&&this.dropdown.detach().appendTo(this.body),0===(t=e("#select2-drop-mask")).length&&((t=e(document.createElement("div"))).attr("id","select2-drop-mask").attr("class","select2-drop-mask"),t.hide(),t.appendTo(this.body),t.on("mousedown touchstart click",function(n){h(t);var i,r=e("#select2-drop");r.length>0&&((i=r.data("select2")).opts.selectOnBlur&&i.selectHighlighted({noFocus:!0}),i.close(),n.preventDefault(),n.stopPropagation())})),this.dropdown.prev()[0]!==t[0]&&this.dropdown.before(t),e("#select2-drop").removeAttr("id"),this.dropdown.attr("id","select2-drop"),t.show(),this.positionDropdown(),this.dropdown.show(),this.positionDropdown(),this.dropdown.addClass("select2-drop-active");var a=this;this.container.parents().add(window).each(function(){e(this).on(r+" "+i+" "+o,function(e){a.opened()&&a.positionDropdown()})})},close:function(){if(this.opened()){var t=this.containerEventName,n="scroll."+t,i="resize."+t,r="orientationchange."+t;this.container.parents().add(window).each(function(){e(this).off(n).off(i).off(r)}),this.clearDropdownAlignmentPreference(),e("#select2-drop-mask").hide(),this.dropdown.removeAttr("id"),this.dropdown.hide(),this.container.removeClass("select2-dropdown-open").removeClass("select2-container-active"),this.results.empty(),s.off("mousemove.select2Event"),this.clearSearch(),this.search.removeClass("select2-active"),this.opts.element.trigger(e.Event("select2-close"))}},externalSearch:function(e){this.open(),this.search.val(e),this.updateResults(!1)},clearSearch:function(){},getMaximumSelectionSize:function(){return N(this.opts.maximumSelectionSize,this.opts.element)},ensureHighlightVisible:function(){var t,n,i,r,o,a,s,u=this.results;(n=this.highlight())<0||(0!=n?(t=this.findHighlightableChoices().find(".select2-result-label"),r=(s=((i=e(t[n])).offset()||{}).top||0)+i.outerHeight(!0),n===t.length-1&&(a=u.find("li.select2-more-results")).length>0&&(r=a.offset().top+a.outerHeight(!0)),r>(o=u.offset().top+u.outerHeight(!1))&&u.scrollTop(u.scrollTop()+(r-o)),s-u.offset().top<0&&i.css("display")):u.scrollTop(0))},findHighlightableChoices:function(){return this.results.find(".select2-result-selectable:not(.select2-disabled):not(.select2-selected)")},moveHighlight:function(t){for(var n=this.findHighlightableChoices(),i=this.highlight();i>-1&&i<n.length;){var r=e(n[i+=t]);if(r.hasClass("select2-result-selectable")&&!r.hasClass("select2-disabled")&&!r.hasClass("select2-selected")){this.highlight(i);break}}},highlight:function(t){var n,i,r=this.findHighlightableChoices();if(0===arguments.length)return g(r.filter(".select2-highlighted")[0],r.get());t>=r.length&&(t=r.length-1),t<0&&(t=0),this.removeHighlight(),(n=e(r[t])).addClass("select2-highlighted"),this.search.attr("aria-activedescendant",n.find(".select2-result-label").attr("id")),this.ensureHighlightVisible(),this.liveRegion.text(n.text()),(i=n.data("select2-data"))&&this.opts.element.trigger({type:"select2-highlight",val:this.id(i),choice:i})},removeHighlight:function(){this.results.find(".select2-highlighted").removeClass("select2-highlighted")},touchMoved:function(){this._touchMoved=!0},clearTouchMoved:function(){this._touchMoved=!1},countSelectableResults:function(){return this.findHighlightableChoices().length},highlightUnderEvent:function(t){var n=e(t.target).closest(".select2-result-selectable");if(n.length>0&&!n.is(".select2-highlighted")){var i=this.findHighlightableChoices();this.highlight(i.index(n))}else 0==n.length&&this.removeHighlight()},loadMoreIfNeeded:function(){var e=this.results,t=e.find("li.select2-more-results"),n=this.resultsPage+1,i=this,r=this.search.val(),o=this.context;0!==t.length&&t.offset().top-e.offset().top-e.height()<=this.opts.loadMorePadding&&(t.addClass("select2-active"),this.opts.query({element:this.opts.element,term:r,page:n,context:o,matcher:this.opts.matcher,callback:this.bind(function(a){i.opened()&&(i.opts.populateResults.call(this,e,a.results,{term:r,page:n,context:o}),i.postprocessResults(a,!1,!1),!0===a.more?(t.detach().appendTo(e).html(i.opts.escapeMarkup(N(i.opts.formatLoadMore,i.opts.element,n+1))),window.setTimeout(function(){i.loadMoreIfNeeded()},10)):t.remove(),i.positionDropdown(),i.resultsPage=n,i.context=a.context,this.opts.element.trigger({type:"select2-loaded",items:a}))})}))},tokenize:function(){},updateResults:function(n){var i,r,o,a=this.search,s=this.results,u=this.opts,c=this,l=a.val(),d=e.data(this.container,"select2-last-term");if((!0===n||!d||!v(l,d))&&(e.data(this.container,"select2-last-term",l),!0===n||!1!==this.showSearchInput&&this.opened())){o=++this.queryCount;var p=this.getMaximumSelectionSize();if(!(p>=1&&(i=this.data(),e.isArray(i)&&i.length>=p&&P(u.formatSelectionTooBig,"formatSelectionTooBig"))))return a.val().length<u.minimumInputLength?(P(u.formatInputTooShort,"formatInputTooShort")?h("<li class='select2-no-results'>"+N(u.formatInputTooShort,u.element,a.val(),u.minimumInputLength)+"</li>"):h(""),void(n&&this.showSearch&&this.showSearch(!0))):void(u.maximumInputLength&&a.val().length>u.maximumInputLength?P(u.formatInputTooLong,"formatInputTooLong")?h("<li class='select2-no-results'>"+N(u.formatInputTooLong,u.element,a.val(),u.maximumInputLength)+"</li>"):h(""):(u.formatSearching&&0===this.findHighlightableChoices().length&&h("<li class='select2-searching'>"+N(u.formatSearching,u.element)+"</li>"),a.addClass("select2-active"),this.removeHighlight(),(r=this.tokenize())!=t&&null!=r&&a.val(r),this.resultsPage=1,u.query({element:u.element,term:a.val(),page:this.resultsPage,context:null,matcher:u.matcher,callback:this.bind(function(i){var r;o==this.queryCount&&(this.opened()?i.hasError!==t&&P(u.formatAjaxError,"formatAjaxError")?h("<li class='select2-ajax-error'>"+N(u.formatAjaxError,u.element,i.jqXHR,i.textStatus,i.errorThrown)+"</li>"):(this.context=i.context===t?null:i.context,this.opts.createSearchChoice&&""!==a.val()&&(r=this.opts.createSearchChoice.call(c,a.val(),i.results))!==t&&null!==r&&c.id(r)!==t&&null!==c.id(r)&&0===e(i.results).filter(function(){return v(c.id(this),c.id(r))}).length&&this.opts.createSearchChoicePosition(i.results,r),0===i.results.length&&P(u.formatNoMatches,"formatNoMatches")?h("<li class='select2-no-results'>"+N(u.formatNoMatches,u.element,a.val())+"</li>"):(s.empty(),c.opts.populateResults.call(this,s,i.results,{term:a.val(),page:this.resultsPage,context:null}),!0===i.more&&P(u.formatLoadMore,"formatLoadMore")&&(s.append("<li class='select2-more-results'>"+u.escapeMarkup(N(u.formatLoadMore,u.element,this.resultsPage))+"</li>"),window.setTimeout(function(){c.loadMoreIfNeeded()},10)),this.postprocessResults(i,n),f(),this.opts.element.trigger({type:"select2-loaded",items:i}))):this.search&&this.search.removeClass("select2-active"))})})));h("<li class='select2-selection-limit'>"+N(u.formatSelectionTooBig,u.element,p)+"</li>")}function f(){a.removeClass("select2-active"),c.positionDropdown(),s.find(".select2-no-results,.select2-selection-limit,.select2-searching").length?c.liveRegion.text(s.text()):c.liveRegion.text(c.opts.formatMatches(s.find('.select2-result-selectable:not(".select2-selected")').length))}function h(e){s.html(e),f()}},cancel:function(){this.close()},blur:function(){this.opts.selectOnBlur&&this.selectHighlighted({noFocus:!0}),this.close(),this.container.removeClass("select2-container-active"),this.search[0]===document.activeElement&&this.search.blur(),this.clearSearch(),this.selection.find(".select2-search-choice-focus").removeClass("select2-search-choice-focus")},focusSearch:function(){var e;(e=this.search)[0]!==document.activeElement&&window.setTimeout(function(){var t,n=e[0],i=e.val().length;e.focus(),(n.offsetWidth>0||n.offsetHeight>0)&&n===document.activeElement&&(n.setSelectionRange?n.setSelectionRange(i,i):n.createTextRange&&((t=n.createTextRange()).collapse(!1),t.select()))},0)},selectHighlighted:function(e){if(this._touchMoved)this.clearTouchMoved();else{var t=this.highlight(),n=this.results.find(".select2-highlighted").closest(".select2-result").data("select2-data");n?(this.highlight(t),this.onSelect(n,e)):e&&e.noFocus&&this.close()}},getPlaceholder:function(){var e;return this.opts.element.attr("placeholder")||this.opts.element.attr("data-placeholder")||this.opts.element.data("placeholder")||this.opts.placeholder||((e=this.getPlaceholderOption())!==t?e.text():t)},getPlaceholderOption:function(){if(this.select){var n=this.select.children("option").first();if(this.opts.placeholderOption!==t)return"first"===this.opts.placeholderOption&&n||"function"==typeof this.opts.placeholderOption&&this.opts.placeholderOption(this.select);if(""===e.trim(n.text())&&""===n.val())return n}},initContainerWidth:function(){var n=function(){var n,i,r,o,a;if("off"===this.opts.width)return null;if("element"===this.opts.width)return 0===this.opts.element.outerWidth(!1)?"auto":this.opts.element.outerWidth(!1)+"px";if("copy"===this.opts.width||"resolve"===this.opts.width){if((n=this.opts.element.attr("style"))!==t)for(o=0,a=(i=n.split(";")).length;o<a;o+=1)if(null!==(r=i[o].replace(/\s/g,"").match(/^width:(([-+]?([0-9]*\.)?[0-9]+)(px|em|ex|%|in|cm|mm|pt|pc))/i))&&r.length>=1)return r[1];return"resolve"===this.opts.width?(n=this.opts.element.css("width")).indexOf("%")>0?n:0===this.opts.element.outerWidth(!1)?"auto":this.opts.element.outerWidth(!1)+"px":null}return e.isFunction(this.opts.width)?this.opts.width():this.opts.width}.call(this);null!==n&&this.container.css("width",n)}}),{createContainer:function(){return e(document.createElement("div")).attr({class:"select2-container"}).html(["<a href='javascript:void(0)' class='select2-choice' tabindex='-1'>","   <span class='select2-chosen'>&#160;</span><abbr class='select2-search-choice-close'></abbr>","   <span class='select2-arrow' role='presentation'><b role='presentation'></b></span>","</a>","<label for='' class='select2-offscreen'></label>","<input class='select2-focusser select2-offscreen' type='text' aria-haspopup='true' role='button' />","<div class='select2-drop select2-display-none'>","   <div class='select2-search'>","       <label for='' class='select2-offscreen'></label>","       <input type='text' autocomplete='new-password' autocorrect='off' autocapitalize='off' spellcheck='false' class='select2-input' role='combobox' aria-expanded='true'","       aria-autocomplete='list' />","   </div>","   <ul class='select2-results' role='listbox'>","   </ul>","</div>"].join(""))},enableInterface:function(){this.parent.enableInterface.apply(this,arguments)&&this.focusser.prop("disabled",!this.isInterfaceEnabled())},opening:function(){var n,i,r;this.opts.minimumResultsForSearch>=0&&this.showSearch(!0),this.parent.opening.apply(this,arguments),!1!==this.showSearchInput&&this.search.val(this.focusser.val()),this.opts.shouldFocusInput(this)&&(this.search.focus(),(n=this.search.get(0)).createTextRange?((i=n.createTextRange()).collapse(!1),i.select()):n.setSelectionRange&&(r=this.search.val().length,n.setSelectionRange(r,r))),""===this.search.val()&&this.nextSearchTerm!=t&&(this.search.val(this.nextSearchTerm),this.search.select()),this.focusser.prop("disabled",!0).val(""),this.updateResults(!0),this.opts.element.trigger(e.Event("select2-open"))},close:function(){this.opened()&&(this.parent.close.apply(this,arguments),this.focusser.prop("disabled",!1),this.opts.shouldFocusInput(this)&&this.focusser.focus())},focus:function(){this.opened()?this.close():this.focusser&&(this.focusser.prop("disabled",!1),this.opts.shouldFocusInput(this)&&this.focusser.focus())},isFocused:function(){return this.container.hasClass("select2-container-active")},cancel:function(){this.parent.cancel.apply(this,arguments),this.focusser.prop("disabled",!1),this.opts.shouldFocusInput(this)&&this.focusser.focus()},destroy:function(){e("label[for='"+this.focusser.attr("id")+"']").attr("for",this.opts.element.attr("id")),this.parent.destroy.apply(this,arguments),O.call(this,"selection","focusser")},initContainer:function(){var t,n,i=this.container,r=this.dropdown,a=o();this.opts.minimumResultsForSearch<0?this.showSearch(!1):this.showSearch(!0),this.selection=t=i.find(".select2-choice"),this.focusser=i.find(".select2-focusser"),t.find(".select2-chosen").attr("id","select2-chosen-"+a),this.focusser.attr("aria-labelledby","select2-chosen-"+a),this.results.attr("id","select2-results-"+a),this.search.attr("aria-owns","select2-results-"+a),this.focusser.attr("id","s2id_autogen"+a),n=e("label[for='"+this.opts.element.attr("id")+"']"),this.opts.element.on("focus.select2",this.bind(function(){this.focus()})),this.focusser.prev().text(n.text()).attr("for",this.focusser.attr("id"));var s=this.opts.element.attr("title");this.opts.element.attr("title",s||n.text()),this.focusser.attr("tabindex",this.elementTabIndex),this.search.attr("id",this.focusser.attr("id")+"_search"),this.search.prev().text(e("label[for='"+this.focusser.attr("id")+"']").text()).attr("for",this.search.attr("id")),this.search.on("keydown",this.bind(function(e){if(this.isInterfaceEnabled()&&229!=e.keyCode)if(e.which!==d.PAGE_UP&&e.which!==d.PAGE_DOWN)switch(e.which){case d.UP:case d.DOWN:return this.moveHighlight(e.which===d.UP?-1:1),void A(e);case d.ENTER:return this.selectHighlighted(),void A(e);case d.TAB:return void this.selectHighlighted({noFocus:!0});case d.ESC:return this.cancel(e),void A(e)}else A(e)})),this.search.on("blur",this.bind(function(e){document.activeElement===this.body.get(0)&&window.setTimeout(this.bind(function(){this.opened()&&this.search.focus()}),0)})),this.focusser.on("keydown",this.bind(function(e){if(this.isInterfaceEnabled()&&e.which!==d.TAB&&!d.isControl(e)&&!d.isFunctionKey(e)&&e.which!==d.ESC){if(!1!==this.opts.openOnEnter||e.which!==d.ENTER){if(e.which==d.DOWN||e.which==d.UP||e.which==d.ENTER&&this.opts.openOnEnter){if(e.altKey||e.ctrlKey||e.shiftKey||e.metaKey)return;return this.open(),void A(e)}return e.which==d.DELETE||e.which==d.BACKSPACE?(this.opts.allowClear&&this.clear(),void A(e)):void 0}A(e)}})),b(this.focusser),this.focusser.on("keyup-change input",this.bind(function(e){if(this.opts.minimumResultsForSearch>=0){if(e.stopPropagation(),this.opened())return;this.open()}})),t.on("mousedown touchstart","abbr",this.bind(function(e){var t;this.isInterfaceEnabled()&&(this.clear(),(t=e).preventDefault(),t.stopImmediatePropagation(),this.close(),this.selection&&this.selection.focus())})),t.on("mousedown touchstart",this.bind(function(n){h(t),this.container.hasClass("select2-container-active")||this.opts.element.trigger(e.Event("select2-focus")),this.opened()?this.close():this.isInterfaceEnabled()&&this.open(),A(n)})),r.on("mousedown touchstart",this.bind(function(){this.opts.shouldFocusInput(this)&&this.search.focus()})),t.on("focus",this.bind(function(e){A(e)})),this.focusser.on("focus",this.bind(function(){this.container.hasClass("select2-container-active")||this.opts.element.trigger(e.Event("select2-focus")),this.container.addClass("select2-container-active")})).on("blur",this.bind(function(){this.opened()||(this.container.removeClass("select2-container-active"),this.opts.element.trigger(e.Event("select2-blur")))})),this.search.on("focus",this.bind(function(){this.container.hasClass("select2-container-active")||this.opts.element.trigger(e.Event("select2-focus")),this.container.addClass("select2-container-active")})),this.initContainerWidth(),this.opts.element.hide(),this.setPlaceholder()},clear:function(t){var n=this.selection.data("select2-data");if(n){var i=e.Event("select2-clearing");if(this.opts.element.trigger(i),i.isDefaultPrevented())return;var r=this.getPlaceholderOption();this.opts.element.val(r?r.val():""),this.selection.find(".select2-chosen").empty(),this.selection.removeData("select2-data"),this.setPlaceholder(),!1!==t&&(this.opts.element.trigger({type:"select2-removed",val:this.id(n),choice:n}),this.triggerChange({removed:n}))}},initSelection:function(){if(this.isPlaceholderOptionSelected())this.updateSelection(null),this.close(),this.setPlaceholder();else{var e=this;this.opts.initSelection.call(null,this.opts.element,function(n){n!==t&&null!==n&&(e.updateSelection(n),e.close(),e.setPlaceholder(),e.nextSearchTerm=e.opts.nextSearchTerm(n,e.search.val()))})}},isPlaceholderOptionSelected:function(){var e;return this.getPlaceholder()!==t&&((e=this.getPlaceholderOption())!==t&&e.prop("selected")||""===this.opts.element.val()||this.opts.element.val()===t||null===this.opts.element.val())},prepareOpts:function(){var t=this.parent.prepareOpts.apply(this,arguments),n=this;return"select"===t.element.get(0).tagName.toLowerCase()?t.initSelection=function(e,t){var i=e.find("option").filter(function(){return this.selected&&!this.disabled});t(n.optionToData(i))}:"data"in t&&(t.initSelection=t.initSelection||function(n,i){var r=n.val(),o=null;t.query({matcher:function(e,n,i){var a=v(r,t.id(i));return a&&(o=i),a},callback:e.isFunction(i)?function(){i(o)}:e.noop})}),t},getPlaceholder:function(){return this.select&&this.getPlaceholderOption()===t?t:this.parent.getPlaceholder.apply(this,arguments)},setPlaceholder:function(){var e=this.getPlaceholder();if(this.isPlaceholderOptionSelected()&&e!==t){if(this.select&&this.getPlaceholderOption()===t)return;this.selection.find(".select2-chosen").html(this.opts.escapeMarkup(e)),this.selection.addClass("select2-default"),this.container.removeClass("select2-allowclear")}},postprocessResults:function(t,n,i){var r=0,o=this;if(this.findHighlightableChoices().each2(function(e,t){if(v(o.id(t.data("select2-data")),o.opts.element.val()))return r=e,!1}),!1!==i&&(!0===n&&r>=0?this.highlight(r):this.highlight(0)),!0===n){var a=this.opts.minimumResultsForSearch;a>=0&&this.showSearch(function t(n){var i=0;return e.each(n,function(e,n){n.children?i+=t(n.children):i++}),i}(t.results)>=a)}},showSearch:function(t){this.showSearchInput!==t&&(this.showSearchInput=t,this.dropdown.find(".select2-search").toggleClass("select2-search-hidden",!t),this.dropdown.find(".select2-search").toggleClass("select2-offscreen",!t),e(this.dropdown,this.container).toggleClass("select2-with-searchbox",t))},onSelect:function(e,t){if(this.triggerSelect(e)){var n=this.opts.element.val(),i=this.data();this.opts.element.val(this.id(e)),this.updateSelection(e),this.opts.element.trigger({type:"select2-selected",val:this.id(e),choice:e}),this.nextSearchTerm=this.opts.nextSearchTerm(e,this.search.val()),this.close(),t&&t.noFocus||!this.opts.shouldFocusInput(this)||this.focusser.focus(),v(n,this.id(e))||this.triggerChange({added:e,removed:i})}},updateSelection:function(e){var n,i,r=this.selection.find(".select2-chosen");this.selection.data("select2-data",e),r.empty(),null!==e&&(n=this.opts.formatSelection(e,r,this.opts.escapeMarkup)),n!==t&&r.append(n),(i=this.opts.formatSelectionCssClass(e,r))!==t&&r.addClass(i),this.selection.removeClass("select2-default"),this.opts.allowClear&&this.getPlaceholder()!==t&&this.container.addClass("select2-allowclear")},val:function(){var e,n=!1,i=null,r=this,o=this.data();if(0===arguments.length)return this.opts.element.val();if(e=arguments[0],arguments.length>1&&(n=arguments[1]),this.select)this.select.val(e).find("option").filter(function(){return this.selected}).each2(function(e,t){return i=r.optionToData(t),!1}),this.updateSelection(i),this.setPlaceholder(),n&&this.triggerChange({added:i,removed:o});else{if(!e&&0!==e)return void this.clear(n);if(this.opts.initSelection===t)throw new Error("cannot call val() if initSelection() is not defined");this.opts.element.val(e),this.opts.initSelection(this.opts.element,function(e){r.opts.element.val(e?r.id(e):""),r.updateSelection(e),r.setPlaceholder(),n&&r.triggerChange({added:e,removed:o})})}},clearSearch:function(){this.search.val(""),this.focusser.val("")},data:function(e){var n,i=!1;if(0===arguments.length)return(n=this.selection.data("select2-data"))==t&&(n=null),n;arguments.length>1&&(i=arguments[1]),e?(n=this.data(),this.opts.element.val(e?this.id(e):""),this.updateSelection(e),i&&this.triggerChange({added:e,removed:n})):this.clear(i)}}),r=D(n,{createContainer:function(){return e(document.createElement("div")).attr({class:"select2-container select2-container-multi"}).html(["<ul class='select2-choices'>","  <li class='select2-search-field'>","    <label for='' class='select2-offscreen'></label>","    <input type='text' autocomplete='new-password' autocorrect='off' autocapitalize='off' spellcheck='false' class='select2-input'>","  </li>","</ul>","<div class='select2-drop select2-drop-multi select2-display-none'>","   <ul class='select2-results'>","   </ul>","</div>"].join(""))},prepareOpts:function(){var t=this.parent.prepareOpts.apply(this,arguments),n=this;return"select"===t.element.get(0).tagName.toLowerCase()?t.initSelection=function(e,t){var i=[];e.find("option").filter(function(){return this.selected&&!this.disabled}).each2(function(e,t){i.push(n.optionToData(t))}),t(i)}:"data"in t&&(t.initSelection=t.initSelection||function(n,i){var r=y(n.val(),t.separator,t.transformVal),o=[];t.query({matcher:function(n,i,a){var s=e.grep(r,function(e){return v(e,t.id(a))}).length;return s&&o.push(a),s},callback:e.isFunction(i)?function(){for(var e=[],n=0;n<r.length;n++)for(var a=r[n],s=0;s<o.length;s++){var u=o[s];if(v(a,t.id(u))){e.push(u),o.splice(s,1);break}}i(e)}:e.noop})}),t},selectChoice:function(e){var t=this.container.find(".select2-search-choice-focus");t.length&&e&&e[0]==t[0]||(t.length&&this.opts.element.trigger("choice-deselected",t),t.removeClass("select2-search-choice-focus"),e&&e.length&&(this.close(),e.addClass("select2-search-choice-focus"),this.opts.element.trigger("choice-selected",e)))},destroy:function(){e("label[for='"+this.search.attr("id")+"']").attr("for",this.opts.element.attr("id")),this.parent.destroy.apply(this,arguments),O.call(this,"searchContainer","selection")},initContainer:function(){var t,n=".select2-choices";this.searchContainer=this.container.find(".select2-search-field"),this.selection=t=this.container.find(n);var i=this;this.selection.on("click",".select2-container:not(.select2-container-disabled) .select2-search-choice:not(.select2-locked)",function(t){i.search[0].focus(),i.selectChoice(e(this))}),this.search.attr("id","s2id_autogen"+o()),this.search.prev().text(e("label[for='"+this.opts.element.attr("id")+"']").text()).attr("for",this.search.attr("id")),this.opts.element.on("focus.select2",this.bind(function(){this.focus()})),this.search.on("input paste",this.bind(function(){this.search.attr("placeholder")&&0==this.search.val().length||this.isInterfaceEnabled()&&(this.opened()||this.open())})),this.search.attr("tabindex",this.elementTabIndex),this.keydowns=0,this.search.on("keydown",this.bind(function(n){if(this.isInterfaceEnabled()){++this.keydowns;var i=t.find(".select2-search-choice-focus"),r=i.prev(".select2-search-choice:not(.select2-locked)"),o=i.next(".select2-search-choice:not(.select2-locked)"),a=function(t){var n=0,i=0;if("selectionStart"in(t=e(t)[0]))n=t.selectionStart,i=t.selectionEnd-n;else if("selection"in document){t.focus();var r=document.selection.createRange();i=document.selection.createRange().text.length,r.moveStart("character",-t.value.length),n=r.text.length-i}return{offset:n,length:i}}(this.search);if(i.length&&(n.which==d.LEFT||n.which==d.RIGHT||n.which==d.BACKSPACE||n.which==d.DELETE||n.which==d.ENTER)){var s=i;return n.which==d.LEFT&&r.length?s=r:n.which==d.RIGHT?s=o.length?o:null:n.which===d.BACKSPACE?this.unselect(i.first())&&(this.search.width(10),s=r.length?r:o):n.which==d.DELETE?this.unselect(i.first())&&(this.search.width(10),s=o.length?o:null):n.which==d.ENTER&&(s=null),this.selectChoice(s),A(n),void(s&&s.length||this.open())}if((n.which===d.BACKSPACE&&1==this.keydowns||n.which==d.LEFT)&&0==a.offset&&!a.length)return this.selectChoice(t.find(".select2-search-choice:not(.select2-locked)").last()),void A(n);if(this.selectChoice(null),this.opened())switch(n.which){case d.UP:case d.DOWN:return this.moveHighlight(n.which===d.UP?-1:1),void A(n);case d.ENTER:return this.selectHighlighted(),void A(n);case d.TAB:return this.selectHighlighted({noFocus:!0}),void this.close();case d.ESC:return this.cancel(n),void A(n)}if(n.which!==d.TAB&&!d.isControl(n)&&!d.isFunctionKey(n)&&n.which!==d.BACKSPACE&&n.which!==d.ESC){if(n.which===d.ENTER){if(!1===this.opts.openOnEnter)return;if(n.altKey||n.ctrlKey||n.shiftKey||n.metaKey)return}this.open(),n.which!==d.PAGE_UP&&n.which!==d.PAGE_DOWN||A(n),n.which===d.ENTER&&A(n)}}})),this.search.on("keyup",this.bind(function(e){this.keydowns=0,this.resizeSearch()})),this.search.on("blur",this.bind(function(t){this.container.removeClass("select2-container-active"),this.search.removeClass("select2-focused"),this.selectChoice(null),this.opened()||this.clearSearch(),t.stopImmediatePropagation(),this.opts.element.trigger(e.Event("select2-blur"))})),this.container.on("click",n,this.bind(function(t){this.isInterfaceEnabled()&&(e(t.target).closest(".select2-search-choice").length>0||(this.selectChoice(null),this.clearPlaceholder(),this.container.hasClass("select2-container-active")||this.opts.element.trigger(e.Event("select2-focus")),this.open(),this.focusSearch(),t.preventDefault()))})),this.container.on("focus",n,this.bind(function(){this.isInterfaceEnabled()&&(this.container.hasClass("select2-container-active")||this.opts.element.trigger(e.Event("select2-focus")),this.container.addClass("select2-container-active"),this.dropdown.addClass("select2-drop-active"),this.clearPlaceholder())})),this.initContainerWidth(),this.opts.element.hide(),this.clearSearch()},enableInterface:function(){this.parent.enableInterface.apply(this,arguments)&&this.search.prop("disabled",!this.isInterfaceEnabled())},initSelection:function(){if(""===this.opts.element.val()&&""===this.opts.element.text()&&(this.updateSelection([]),this.close(),this.clearSearch()),this.select||""!==this.opts.element.val()){var e=this;this.opts.initSelection.call(null,this.opts.element,function(n){n!==t&&null!==n&&(e.updateSelection(n),e.close(),e.clearSearch())})}},clearSearch:function(){var e=this.getPlaceholder(),n=this.getMaxSearchWidth();e!==t&&0===this.getVal().length&&!1===this.search.hasClass("select2-focused")?(this.search.val(e).addClass("select2-default"),this.search.width(n>0?n:this.container.css("width"))):this.search.val("").width(10)},clearPlaceholder:function(){this.search.hasClass("select2-default")&&this.search.val("").removeClass("select2-default")},opening:function(){this.clearPlaceholder(),this.resizeSearch(),this.parent.opening.apply(this,arguments),this.focusSearch(),""===this.search.val()&&this.nextSearchTerm!=t&&(this.search.val(this.nextSearchTerm),this.search.select()),this.updateResults(!0),this.opts.shouldFocusInput(this)&&this.search.focus(),this.opts.element.trigger(e.Event("select2-open"))},close:function(){this.opened()&&this.parent.close.apply(this,arguments)},focus:function(){this.close(),this.search.focus()},isFocused:function(){return this.search.hasClass("select2-focused")},updateSelection:function(t){var n=[],i=[],r=this;e(t).each(function(){g(r.id(this),n)<0&&(n.push(r.id(this)),i.push(this))}),t=i,this.selection.find(".select2-search-choice").remove(),e(t).each(function(){r.addSelectedChoice(this)}),r.postprocessResults()},tokenize:function(){var e=this.search.val();null!=(e=this.opts.tokenizer.call(this,e,this.data(),this.bind(this.onSelect),this.opts))&&e!=t&&(this.search.val(e),e.length>0&&this.open())},onSelect:function(e,n){this.triggerSelect(e)&&""!==e.text&&(this.addSelectedChoice(e),this.opts.element.trigger({type:"selected",val:this.id(e),choice:e}),this.nextSearchTerm=this.opts.nextSearchTerm(e,this.search.val()),this.clearSearch(),this.updateResults(),!this.select&&this.opts.closeOnSelect||this.postprocessResults(e,!1,!0===this.opts.closeOnSelect),this.opts.closeOnSelect?(this.close(),this.search.width(10)):this.countSelectableResults()>0?(this.search.width(10),this.resizeSearch(),this.getMaximumSelectionSize()>0&&this.val().length>=this.getMaximumSelectionSize()?this.updateResults(!0):this.nextSearchTerm!=t&&(this.search.val(this.nextSearchTerm),this.updateResults(),this.search.select()),this.positionDropdown()):(this.close(),this.search.width(10)),this.triggerChange({added:e}),n&&n.noFocus||this.focusSearch())},cancel:function(){this.close(),this.focusSearch()},addSelectedChoice:function(n){var i,r,o=!n.locked,a=e("<li class='select2-search-choice'>    <div></div>    <a href='#' class='select2-search-choice-close' tabindex='-1'></a></li>"),s=e("<li class='select2-search-choice select2-locked'><div></div></li>"),u=o?a:s,c=this.id(n),l=this.getVal();(i=this.opts.formatSelection(n,u.find("div"),this.opts.escapeMarkup))!=t&&u.find("div").replaceWith(e("<div></div>").html(i)),(r=this.opts.formatSelectionCssClass(n,u.find("div")))!=t&&u.addClass(r),o&&u.find(".select2-search-choice-close").on("mousedown",A).on("click dblclick",this.bind(function(t){this.isInterfaceEnabled()&&(this.unselect(e(t.target)),this.selection.find(".select2-search-choice-focus").removeClass("select2-search-choice-focus"),A(t),this.close(),this.focusSearch())})).on("focus",this.bind(function(){this.isInterfaceEnabled()&&(this.container.addClass("select2-container-active"),this.dropdown.addClass("select2-drop-active"))})),u.data("select2-data",n),u.insertBefore(this.searchContainer),l.push(c),this.setVal(l)},unselect:function(t){var n,i,r=this.getVal();if(0===(t=t.closest(".select2-search-choice")).length)throw"Invalid argument: "+t+". Must be .select2-search-choice";if(n=t.data("select2-data")){var o=e.Event("select2-removing");if(o.val=this.id(n),o.choice=n,this.opts.element.trigger(o),o.isDefaultPrevented())return!1;for(;(i=g(this.id(n),r))>=0;)r.splice(i,1),this.setVal(r),this.select&&this.postprocessResults();return t.remove(),this.opts.element.trigger({type:"select2-removed",val:this.id(n),choice:n}),this.triggerChange({removed:n}),!0}},postprocessResults:function(e,t,n){var i=this.getVal(),r=this.results.find(".select2-result"),o=this.results.find(".select2-result-with-children"),a=this;r.each2(function(e,t){g(a.id(t.data("select2-data")),i)>=0&&(t.addClass("select2-selected"),t.find(".select2-result-selectable").addClass("select2-selected"))}),o.each2(function(e,t){t.is(".select2-result-selectable")||0!==t.find(".select2-result-selectable:not(.select2-selected)").length||t.addClass("select2-selected")}),-1==this.highlight()&&!1!==n&&!0===this.opts.closeOnSelect&&a.highlight(0),!this.opts.createSearchChoice&&!r.filter(".select2-result:not(.select2-selected)").length>0&&(!e||e&&!e.more&&0===this.results.find(".select2-no-results").length)&&P(a.opts.formatNoMatches,"formatNoMatches")&&this.results.append("<li class='select2-no-results'>"+N(a.opts.formatNoMatches,a.opts.element,a.search.val())+"</li>")},getMaxSearchWidth:function(){return this.selection.width()-_(this.search)},resizeSearch:function(){var t,n,i,r,o=_(this.search);t=function(t){if(!a){var n=t[0].currentStyle||window.getComputedStyle(t[0],null);(a=e(document.createElement("div")).css({position:"absolute",left:"-10000px",top:"-10000px",display:"none",fontSize:n.fontSize,fontFamily:n.fontFamily,fontStyle:n.fontStyle,fontWeight:n.fontWeight,letterSpacing:n.letterSpacing,textTransform:n.textTransform,whiteSpace:"nowrap"})).attr("class","select2-sizer"),e(document.body).append(a)}return a.text(t.val()),a.width()}(this.search)+10,n=this.search.offset().left,(r=(i=this.selection.width())-(n-this.selection.offset().left)-o)<t&&(r=i-o),r<40&&(r=i-o),r<=0&&(r=t),this.search.width(Math.floor(r))},getVal:function(){var e;return this.select?null===(e=this.select.val())?[]:e:y(e=this.opts.element.val(),this.opts.separator,this.opts.transformVal)},setVal:function(t){var n;this.select?this.select.val(t):(n=[],e(t).each(function(){g(this,n)<0&&n.push(this)}),this.opts.element.val(0===n.length?"":n.join(this.opts.separator)))},buildChangeDetails:function(e,t){t=t.slice(0),e=e.slice(0);for(var n=0;n<t.length;n++)for(var i=0;i<e.length;i++)v(this.opts.id(t[n]),this.opts.id(e[i]))&&(t.splice(n,1),n>0&&n--,e.splice(i,1),i--);return{added:t,removed:e}},val:function(n,i){var r,o=this;if(0===arguments.length)return this.getVal();if((r=this.data()).length||(r=[]),!n&&0!==n)return this.opts.element.val(""),this.updateSelection([]),this.clearSearch(),void(i&&this.triggerChange({added:this.data(),removed:r}));if(this.setVal(n),this.select)this.opts.initSelection(this.select,this.bind(this.updateSelection)),i&&this.triggerChange(this.buildChangeDetails(r,this.data()));else{if(this.opts.initSelection===t)throw new Error("val() cannot be called if initSelection() is not defined");this.opts.initSelection(this.opts.element,function(t){var n=e.map(t,o.id);o.setVal(n),o.updateSelection(t),o.clearSearch(),i&&o.triggerChange(o.buildChangeDetails(r,o.data()))})}this.clearSearch()},onSortStart:function(){if(this.select)throw new Error("Sorting of elements is not supported when attached to <select>. Attach to <input type='hidden'/> instead.");this.search.width(0),this.searchContainer.hide()},onSortEnd:function(){var t=[],n=this;this.searchContainer.show(),this.searchContainer.appendTo(this.searchContainer.parent()),this.resizeSearch(),this.selection.find(".select2-search-choice").each(function(){t.push(n.opts.id(e(this).data("select2-data")))}),this.setVal(t),this.triggerChange()},data:function(t,n){var i,r,o=this;if(0===arguments.length)return this.selection.children(".select2-search-choice").map(function(){return e(this).data("select2-data")}).get();r=this.data(),t||(t=[]),i=e.map(t,function(e){return o.opts.id(e)}),this.setVal(i),this.updateSelection(t),this.clearSearch(),n&&this.triggerChange(this.buildChangeDetails(r,this.data()))}}),e.fn.select2=function(){var n,i,r,o,a,s=Array.prototype.slice.call(arguments,0),u=["val","destroy","opened","open","close","focus","isFocused","container","dropdown","onSortStart","onSortEnd","enable","disable","readonly","positionDropdown","data","search"],c=["opened","isFocused","container","dropdown"],l=["val","data"],d={search:"externalSearch"};return this.each(function(){if(0===s.length||"object"==typeof s[0])(n=0===s.length?{}:e.extend({},s[0])).element=e(this),"select"===n.element.get(0).tagName.toLowerCase()?a=n.element.prop("multiple"):(a=n.multiple||!1,"tags"in n&&(n.multiple=a=!0)),(i=a?new window.Select2.class.multi:new window.Select2.class.single).init(n);else{if("string"!=typeof s[0])throw"Invalid arguments to select2 plugin: "+s;if(g(s[0],u)<0)throw"Unknown method: "+s[0];if(o=t,(i=e(this).data("select2"))===t)return;if("container"===(r=s[0])?o=i.container:"dropdown"===r?o=i.dropdown:(d[r]&&(r=d[r]),o=i[r].apply(i,s.slice(1))),g(s[0],c)>=0||g(s[0],l)>=0&&1==s.length)return!1}}),o===t?this:o},e.fn.select2.defaults={width:"copy",loadMorePadding:0,closeOnSelect:!0,openOnEnter:!0,containerCss:{},dropdownCss:{},containerCssClass:"",dropdownCssClass:"",formatResult:function(e,t,n,i){var r=[];return E(this.text(e),n.term,r,i),r.join("")},transformVal:function(t){return e.trim(t)},formatSelection:function(e,n,i){return e?i(this.text(e)):t},sortResults:function(e,t,n){return e},formatResultCssClass:function(e){return e.css},formatSelectionCssClass:function(e,n){return t},minimumResultsForSearch:0,minimumInputLength:0,maximumInputLength:null,maximumSelectionSize:0,id:function(e){return e==t?null:e.id},text:function(t){return t&&this.data&&this.data.text?e.isFunction(this.data.text)?this.data.text(t):t[this.data.text]:t.text},matcher:function(e,t){return m(""+t).toUpperCase().indexOf(m(""+e).toUpperCase())>=0},separator:",",tokenSeparators:[],tokenizer:function(e,n,i,r){var o,a,s,u,c,l=e,d=!1;if(!r.createSearchChoice||!r.tokenSeparators||r.tokenSeparators.length<1)return t;for(;;){for(a=-1,s=0,u=r.tokenSeparators.length;s<u&&(c=r.tokenSeparators[s],!((a=e.indexOf(c))>=0));s++);if(a<0)break;if(o=e.substring(0,a),e=e.substring(a+c.length),o.length>0&&(o=r.createSearchChoice.call(this,o,n))!==t&&null!==o&&r.id(o)!==t&&null!==r.id(o)){for(d=!1,s=0,u=n.length;s<u;s++)if(v(r.id(o),r.id(n[s]))){d=!0;break}d||i(o)}}return l!==e?e:void 0},escapeMarkup:T,blurOnChange:!1,selectOnBlur:!1,adaptContainerCssClass:function(e){return e},adaptDropdownCssClass:function(e){return null},nextSearchTerm:function(e,n){return t},searchInputPlaceholder:"",createSearchChoicePosition:"top",shouldFocusInput:function(e){return!("ontouchstart"in window||navigator.msMaxTouchPoints>0)||!(e.opts.minimumResultsForSearch<0)}},e.fn.select2.locales=[],e.fn.select2.locales.en={formatMatches:function(e){return 1===e?"One result is available, press enter to select it.":e+" results are available, use up and down arrow keys to navigate."},formatNoMatches:function(){return"No matches found"},formatAjaxError:function(e,t,n){return"Loading failed"},formatInputTooShort:function(e,t){var n=t-e.length;return"Please enter "+n+" or more character"+(1==n?"":"s")},formatInputTooLong:function(e,t){var n=e.length-t;return"Please delete "+n+" character"+(1==n?"":"s")},formatSelectionTooBig:function(e){return"You can only select "+e+" item"+(1==e?"":"s")},formatLoadMore:function(e){return"Loading more results…"},formatSearching:function(){return"Searching…"}},e.extend(e.fn.select2.defaults,e.fn.select2.locales.en),e.fn.select2.ajaxDefaults={transport:e.ajax,params:{type:"GET",cache:!1,dataType:"json"}},window.Select2={query:{ajax:S,local:C,tags:R},util:{debounce:w,markMatch:E,escapeMarkup:T,stripDiacritics:m},class:{abstract:n,single:i,multi:r}}}function h(t){var n=e(document.createTextNode(""));t.before(n),n.before(t),n.remove()}function m(e){return e.replace(/[^\u0000-\u007E]/g,function(e){return f[e]||e})}function g(e,t){for(var n=0,i=t.length;n<i;n+=1)if(v(e,t[n]))return n;return-1}function v(e,n){return e===n||e!==t&&n!==t&&(null!==e&&null!==n&&(e.constructor===String?e+""==n+"":n.constructor===String&&n+""==e+""))}function y(e,t,n){var i,r,o;if(null===e||e.length<1)return[];for(r=0,o=(i=e.split(t)).length;r<o;r+=1)i[r]=n(i[r]);return i}function _(e){return e.outerWidth(!1)-e.width()}function b(n){var i="keyup-change-value";n.on("keydown",function(){e.data(n,i)===t&&e.data(n,i,n.val())}),n.on("keyup",function(){var r=e.data(n,i);r!==t&&n.val()!==r&&(e.removeData(n,i),n.trigger("keyup-change"))})}function w(e,n,i){var r;return i=i||t,function(){var t=arguments;window.clearTimeout(r),r=window.setTimeout(function(){n.apply(i,t)},e)}}function A(e){e.preventDefault(),e.stopPropagation()}function k(t,n,i){var r,o,a=[];(r=e.trim(t.attr("class")))&&e((r=""+r).split(/\s+/)).each2(function(){0===this.indexOf("select2-")&&a.push(this)}),(r=e.trim(n.attr("class")))&&e((r=""+r).split(/\s+/)).each2(function(){0!==this.indexOf("select2-")&&(o=i(this))&&a.push(o)}),t.attr("class",a.join(" "))}function E(e,t,n,i){if(t.trim().length){var r=m(e.toUpperCase()).indexOf(m(t.toUpperCase())),o=t.length;r<0?n.push(i(e)):(n.push(i(e.substring(0,r))),n.push("<span class='select2-match'>"),n.push(i(e.substring(r,r+o))),n.push("</span>"),n.push(i(e.substring(r+o,e.length))))}else n.push(i(e))}function T(e){var t={"\\":"&#92;","&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#47;"};return String(e).replace(/[&<>"'\/\\]/g,function(e){return t[e]})}function S(n){var i,r=null,o=n.quietMillis||100,a=n.url,s=this;return function(u){window.clearTimeout(i),i=window.setTimeout(function(){var i=n.data,o=a,c=n.transport||e.fn.select2.ajaxDefaults.transport,l={type:n.type||"GET",cache:n.cache||!1,jsonpCallback:n.jsonpCallback||t,dataType:n.dataType||"json"},d=e.extend({},e.fn.select2.ajaxDefaults.params,l);i=i?i.call(s,u.term,u.page,u.context):null,o="function"==typeof o?o.call(s,u.term,u.page,u.context):o,r&&"function"==typeof r.abort&&r.abort(),n.params&&(e.isFunction(n.params)?e.extend(d,n.params.call(s)):e.extend(d,n.params)),e.extend(d,{url:o,dataType:n.dataType,data:i,success:function(e){var t=n.results(e,u.page,u);u.callback(t)},error:function(e,t,n){var i={hasError:!0,jqXHR:e,textStatus:t,errorThrown:n};u.callback(i)}}),r=c.call(s,d)},o)}}function C(t){var n,i,r=t,o=function(e){return""+e.text};e.isArray(r)&&(r={results:i=r}),!1===e.isFunction(r)&&(i=r,r=function(){return i});var a=r();return a.text&&(o=a.text,e.isFunction(o)||(n=a.text,o=function(e){return e[n]})),function(t){var n,i=t.term,a={results:[]};""!==i?(n=function(r,a){var s,u;if((r=r[0]).children){for(u in s={},r)r.hasOwnProperty(u)&&(s[u]=r[u]);s.children=[],e(r.children).each2(function(e,t){n(t,s.children)}),(s.children.length||t.matcher(i,o(s),r))&&a.push(s)}else t.matcher(i,o(r),r)&&a.push(r)},e(r().results).each2(function(e,t){n(t,a.results)}),t.callback(a)):t.callback(r())}}function R(n){var i=e.isFunction(n);return function(r){var o=r.term,a={results:[]},s=i?n(r):n;e.isArray(s)&&(e(s).each(function(){var e=this.text!==t,n=e?this.text:this;(""===o||r.matcher(o,n))&&a.results.push(e?this:{id:this,text:this})}),r.callback(a))}}function P(t,n){if(e.isFunction(t))return!0;if(!t)return!1;if("string"==typeof t)return!0;throw new Error(n+" must be a string, function, or falsy value")}function N(t,n){if(e.isFunction(t)){var i=Array.prototype.slice.call(arguments,2);return t.apply(n,i)}return t}function O(){var t=this;e.each(arguments,function(e,n){t[n].remove(),t[n]=null})}function D(t,n){var i=function(){};return(i.prototype=new t).constructor=i,i.prototype.parent=t.prototype,i.prototype=e.extend(i.prototype,n),i}}(jQuery),define("select2",["jquery"],function(e){return function(){return e.Select2}}(this)),define("app/monkeyPatch",["underscore","jquery","backbone","bootstrap","select2"],function(e,t,n){"use strict";var i=n.sync;n.sync=function(e,t,n){return n.syncMethod=e,i.call(this,e,t,n)},t.fn.modal.Constructor.prototype.enforceFocus=function(){},t.fn.modal.Constructor.prototype.escape=function(){this.isShown&&this.options.keyboard?this.$element.on("keydown.dismiss.bs.modal",t.proxy(function(e){27!==e.which||this.$element.hasClass("modal-no-keyboard")||this.hide()},this)):this.isShown||this.$element.off("keydown.dismiss.bs.modal")},t.fn.modal.Constructor.prototype.backdrop=function(e){var n=this,i=n.$element.hasClass("fade")?"fade":"";if(n.isShown&&n.options.backdrop){var r=t.support.transition&&i;if(n.$backdrop=t('<div class="modal-backdrop '+i+'" />').prependTo(n.$element).on("click.dismiss.bs.modal",function(e){e.target===e.currentTarget&&("static"===n.options.backdrop||n.$element.hasClass("modal-static")?n.$element[0].focus.call(n.$element[0]):n.hide.call(n))}),r&&n.$backdrop[0].offsetWidth,n.$backdrop.addClass("in"),!e)return;r?this.$backdrop.one("bsTransitionEnd",e).emulateTransitionEnd(t.fn.modal.Constructor.BACKDROP_TRANSITION_DURATION):e()}else if(!n.isShown&&n.$backdrop){n.$backdrop.removeClass("in");var o=function(){n.removeBackdrop(),e&&e()};t.support.transition&&n.$element.hasClass("fade")?n.$backdrop.one("bsTransitionEnd",o).emulateTransitionEnd(t.fn.modal.Constructor.BACKDROP_TRANSITION_DURATION):o()}else e&&e()},t.fn.modal.Constructor.prototype.checkScrollbar=function(){this.bodyIsOverflowing=document.body.scrollHeight>document.documentElement.clientHeight||"scroll"===t(document.body).css("overflow-y"),this.scrollbarWidth=this.measureScrollbar()},t.fn.popover.Constructor.prototype.hasContent=function(){return"function"==typeof this.options.hasContent?!!this.options.hasContent.call(this.$element[0]):"boolean"==typeof this.options.hasContent?this.options.hasContent:!!this.getTitle()||!!this.getContent()},t.fn.popover.Constructor.prototype.tip=function(){if(this.$tip)return this.$tip;var e=this.options,n=e.template;return"function"==typeof n&&(n=n.call(this.$element[0],t.fn.popover.Constructor.DEFAULTS.template)),this.$tip="string"==typeof n?t(n):n,e.css&&this.$tip.css(e.css),e.contentCss&&this.$tip.find(".popover-content").first().css(e.contentCss),e.className&&("function"==typeof e.className?this.$tip.addClass(e.className(this)):this.$tip.addClass(e.className)),this.$tip},t.fn.popover.Constructor.prototype.getTitle=function(){var e=this.$element,t=this.options;return t.title?"function"==typeof t.title?t.title.call(e[0]):t.title:e.attr("data-original-title")||""};var r=t(document.body);return t.fn.select2.defaults.dropdownContainer=function(e){var t=e.container.closest(".modal-body");if(0===t.length)return r;var n=t.closest(".modal-dialog");return 0===n.length?r:n},r.on("click","label[for]",function(e){var n=t("#"+e.currentTarget.htmlFor),i=n.data("select2");i&&i.isInterfaceEnabled()&&!n.parent().hasClass("has-required-select2")&&n.select2("focus")}),{}}),define("h5.pubsub/Subscriptions",["require","exports","module"],function(e,t,n){"use strict";n.exports=r;var i=[];function r(e){this.messageBroker=e,this.children={},this.subscriptions=[],this.subscriptionsPendingRemoval=[],this.sendingMessagesCount=0,this.removeSubscription=this.removeSubscription.bind(this)}r.TOKEN={SEPARATOR:".",ANY:"*",ALL:"**"},r.prototype.destroy=function(){for(var e=this.children,t=Object.keys(e),n=0,i=t.length;n<i;++n)e[t[n]].destroy();this.children=null,this.removeSubscriptions(),this.subscriptionsPendingRemoval=null,this.messageBroker=null},r.prototype.count=function(e,t){this.subscriptions.length&&(t[e]=this.subscriptions.length);var n=Object.keys(this.children),i=n.length;if(i){0!==e.length&&(e+=r.TOKEN.SEPARATOR);for(var o=0;o<i;++o){var a=n[o];this.children[a].count(e+a,t)}}},r.prototype.add=function(e){var t=this.splitTopic(e.getTopic());this.addSubscription(t,e)},r.prototype.remove=function(e){this.removeSubscriptions(this.splitTopic(e))},r.prototype.send=function(e,t,n){var i=this.splitTopic(e);this.sendMessage(i,e,t,n)},r.prototype.addSubscription=function(e,t){if(0===e.length)return this.subscriptions.push(t),t.on("cancel",this.removeSubscription),void(1===this.subscriptions.length&&this.messageBroker.emit("new topic",t.getTopic()));var n=this.children,i=e.shift();void 0===n[i]&&(n[i]=new r(this.messageBroker)),n[i].addSubscription(e,t)},r.prototype.removeSubscriptions=function(e){var t,n;if(void 0!==e&&0!==e.length){var i=e.shift();void 0!==this.children[i]&&this.children[i].removeSubscriptions(e)}else{var r=this.subscriptions;if(!r.length)return;this.subscriptions=[];var o=r[0].getTopic();for(t=0,n=r.length;t<n;++t)r[t].cancel();this.messageBroker.emit("empty topic",o)}},r.prototype.sendMessage=function(e,t,n,o){if(++this.sendingMessagesCount,void 0!==this.children[r.TOKEN.ALL]&&this.children[r.TOKEN.ALL].sendMessage(i,t,n,o),0===e.length)for(var a=0,s=this.subscriptions.length;a<s;++a)this.subscriptions[a].send(t,n,o);else{var u=e.shift();void 0!==this.children[r.TOKEN.ANY]&&this.children[r.TOKEN.ANY].sendMessage([].concat(e),t,n,o),void 0!==this.children[u]&&this.children[u].sendMessage(e,t,n,o)}--this.sendingMessagesCount,this.removePendingSubscriptions()},r.prototype.splitTopic=function(e){var t=e.split(r.TOKEN.SEPARATOR).filter(function(e){return 0!==e.length});if(0===t.length)throw new Error("Invalid subscription topic: "+e);return t},r.prototype.removeSubscription=function(e){if(this.messageBroker.emit("cancel",e),0!==this.subscriptions.length)return 1===this.subscriptions.length&&this.subscriptions[0]===e?(this.subscriptions.length=0,void this.messageBroker.emit("empty topic",e.getTopic())):void this.removeOrQueueRemoval(e)},r.prototype.removeOrQueueRemoval=function(e){0===this.sendingMessagesCount?this.subscriptions.splice(this.subscriptions.indexOf(e),1):this.subscriptionsPendingRemoval.push(e)},r.prototype.removePendingSubscriptions=function(){var e=this.subscriptionsPendingRemoval,t=e.length;if(t&&!this.sendingMessagesCount){var n=this.subscriptions;if(t===n.length)return e.length=0,void(n.length=0);var i,r,o=[];for(i=0;i<t;++i)o.push(n.indexOf(e[i]));for(o.sort(function(e,t){return t-e}),i=0,r=o.length;i<r;++i)n.splice(o[i],1);e.length=0}}}),define("h5.pubsub/Subscription",["require","exports","module"],function(e,t,n){"use strict";function i(e,t){this.cancelled=!1,this.id=e,this.topic=t,this.messageFilter=null,this.messageLimit=0,this.messageCount=0,this.doFilter=null,this.listeners={cancel:null,message:null}}n.exports=i,i.compileFilter=function(){throw new Error("Subscription.compileFilter() is not implemented!")},i.prototype.toJSON=function(){var e=this.getFilter();return"function"==typeof e&&(e=e.toString()),{id:this.getId(),topic:this.getTopic(),limit:this.getLimit(),filter:e}},i.prototype.getId=function(){return this.id},i.prototype.getTopic=function(){return this.topic},i.prototype.getFilter=function(){return this.messageFilter},i.prototype.setFilter=function(e){if(this.messageFilter=e,"function"==typeof e)this.doFilter=e;else if(this.doFilter=i.compileFilter(e),"function"!=typeof this.doFilter)throw new Error("Subscription.compileFilter() must return a function.");return this},i.prototype.getLimit=function(){return this.messageLimit},i.prototype.setLimit=function(e){if(e<1)throw new Error("Subscription limit must be greater than 0.");return this.messageLimit=e,this},i.prototype.getMessageCount=function(){return this.messageCount},i.prototype.on=function(e,t){if(this.cancelled)return this;var n=this.listeners[e],i=typeof n;if("undefined"===i)throw new Error("Unknown event: "+e);return"function"===i?this.listeners[e]=[n,t]:null===n?this.listeners[e]=t:this.listeners[e].push(t),this},i.prototype.off=function(e,t){if(this.cancelled)return this;var n=this.listeners[e],i=typeof n;if("undefined"===i)throw new Error("Unknown event: "+e);if("function"===i&&n===t)this.listeners[e]=null;else if("object"===i&&null!==n){for(var r=-1,o=n.length,a=0;a<o;++a)if(n[a]===t){r=a;break}-1!==r&&(n.splice(r,1),2===o&&(this.listeners[e]=n[0]))}return this},i.prototype.cancel=function(){this.cancelled||(this.cancelled=!0,this.emit("cancel",this),this.listeners=null,this.doFilter=null)},i.prototype.send=function(e,t,n){this.cancelled||null!==this.doFilter&&!this.doFilter(t,e,n,this)||(++this.messageCount,this.emit("message",t,e,n,this),this.messageCount===this.messageLimit&&this.cancel())},i.prototype.emit=function(e){var t=this.listeners[e];if(null!==t){var n=arguments.length;if("function"!=typeof t)for(var i=0,r=t.length;i<r;++i)5===n?t[i](arguments[1],arguments[2],arguments[3],arguments[4]):t[i](arguments[1]);else 5===n?t(arguments[1],arguments[2],arguments[3],arguments[4]):t(arguments[1])}}}),define("h5.pubsub/Sandbox",["require","exports","module"],function(e,t,n){"use strict";function i(e){this.broker=e,this.subscriptions={},this.removeSubscription=this.removeSubscription.bind(this)}n.exports=i,i.prototype.destroy=function(){var e=this.subscriptions;null!==e&&Object.keys(e).forEach(function(t){e[t].cancel()})},i.prototype.sandbox=function(){return new i(this)},i.prototype.publish=function(e,t,n){return this.broker.publish(e,t,n),this},i.prototype.subscribe=function(e,t){var n=this.broker.subscribe(e,t);return n.on("cancel",this.removeSubscription),this.subscriptions[n.getId()]=n,n},i.prototype.unsubscribe=function(e){var t=[],n=this.subscriptions;for(var i in n)n.hasOwnProperty(i)&&n[i].getTopic()===e&&t.push(i);for(var r=0,o=t.length;r<o;++r)n[t[r]].cancel();return this},i.prototype.removeSubscription=function(e){delete this.subscriptions[e.getId()]}}),define("h5.pubsub/MessageBroker",["require","exports","module","./Subscriptions","./Subscription","./Sandbox"],function(e,t,n){"use strict";var i=e("./Subscriptions"),r=e("./Subscription"),o=e("./Sandbox");function a(){this.subscriptions=new i(this),this.nextSubscriptionId=0,this.listeners={subscribe:[],cancel:[],"new topic":[],"empty topic":[],message:[]}}n.exports=a,a.prototype.destroy=function(){this.subscriptions.destroy(),this.listeners={}},a.prototype.sandbox=function(){return new o(this)},a.prototype.publish=function(e,t,n){return void 0===n&&(n={}),this.emit("message",e,t,n),this.subscriptions.send(e,t,n),this},a.prototype.subscribe=function(e,t){var n=new r(this.getNextSubscriptionId(),e);return"function"==typeof t&&n.on("message",t),this.subscriptions.add(n),this.emit("subscribe",n),n},a.prototype.unsubscribe=function(e){return this.subscriptions.remove(e),this},a.prototype.count=function(){var e={};if(null===this.subscriptions)return e;return this.subscriptions.count("",e),e},a.prototype.on=function(e,t){var n=this.listeners[e];if("undefined"===typeof n)throw new Error("Unknown event: "+e);return n.push(t),this},a.prototype.off=function(e,t){var n=this.listeners[e];if("undefined"===typeof n)throw new Error("Unknown event: "+e);var i=n.indexOf(t);return-1!==i&&n.splice(i,1),this},a.prototype.emit=function(e,t){var n=this.listeners[e];if("undefined"===typeof n)throw new Error("Unknown event: "+e);if(!n.length)return this;var i=arguments.length;i>4&&(t=Array.prototype.slice.call(arguments)).shift();for(var r=0,o=n.length;r<o;++r){var a=n[r];switch(i){case 4:a(arguments[1],arguments[2],arguments[3]);break;case 3:a(arguments[1],arguments[2]);break;case 2:a(arguments[1]);break;default:a.apply(null,t)}}return this},a.prototype.getNextSubscriptionId=function(){return(this.nextSubscriptionId++).toString(36)}}),define("app/broker",["h5.pubsub/MessageBroker"],function(e){"use strict";var t=new e;return t.on("message",function(e,t){void 0===t?console.log("[%s]",e):console.log("[%s]",e,t)}),window.broker=t,t}),define("app/i18n",["underscore","moment","select2","app/broker"],function(e,t,n,i){"use strict";var r={},o=[];function a(e,t,n){try{return r[e][t](n)}catch(n){if(r[e]&&r[e][t])throw n;return i.publish("i18n.missingKey",{domain:e,key:t}),t}}function s(e,t){return void 0!==r[e]&&"function"==typeof r[e][t]}function u(t){var n={};if(null==t)return n;for(var i=Object.keys(t),r=0,o=i.length;r<o;++r){var a=i[r],s=t[a];if(null!==s&&"object"==typeof s)for(var c=u(s),l=Object.keys(c),d=0,p=l.length;d<p;++d)n[a+"->"+l[d]]=String(c[l[d]]);else n[a]="_"===a.charAt(0)?String(s):e.escape(String(s))}return n}return a.config=null,a.translate=a,a.register=function(e,t,n){r[e]=t,"string"==typeof n&&o.push(n),i.publish("i18n.registered",{domain:e,keys:t,moduleId:n})},a.reload=function(r,s){var u="en";e.isObject(a.config)&&(u=a.config.locale,a.config.locale=r),o.forEach(require.undef);var c=[].concat(o);"en"!==r&&c.unshift("moment-lang/"+r),c.unshift("select2-lang/"+r),require(c,function(){t.locale(r),n.lang(r),i.publish("i18n.reloaded",{oldLocale:u,newLocale:r}),e.isFunction(s)&&s()})},a.bound=function(e,t,n){function i(){return a(e,t,n)}return i.toString=i,i},a.has=s,a.flatten=u,a.forDomain=function(e){var t=function(t,n,i){return"object"==typeof n?a(e,t,n):"string"==typeof n||i?a(t,n,i):a(e,t)};return t.translate=t,t.bound=function(e,n,i){function r(){return t(e,n,i)}return r.toString=r,r},t.has=function(t,n){return n?s(t,n):s(e,t)},t.flatten=u,t},window.i18n=a,a}),define("socket.io",[],function(){return function(e){var t={};function n(i){if(t[i])return t[i].exports;var r=t[i]={exports:{},id:i,loaded:!1};return e[i].call(r.exports,r,r.exports,n),r.loaded=!0,r.exports}return n.m=e,n.c=t,n.p="",n(0)}([function(e,t,n){"use strict";var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e},r=n(1),o=n(4),a=n(10),s=n(3)("socket.io-client");e.exports=t=c;var u=t.managers={};function c(e,t){"object"==(void 0===e?"undefined":i(e))&&(t=e,e=void 0),t=t||{};var n,o=r(e),c=o.source,l=o.id,d=o.path,p=u[l]&&d in u[l].nsps;return t.forceNew||t["force new connection"]||!1===t.multiplex||p?(s("ignoring socket cache for %s",c),n=a(c,t)):(u[l]||(s("new io instance for %s",c),u[l]=a(c,t)),n=u[l]),n.socket(o.path)}t.protocol=o.protocol,t.connect=c,t.Manager=n(10),t.Socket=n(37)},function(e,t,n){(function(t){"use strict";var i=n(2),r=n(3)("socket.io-client:url");e.exports=function(e,n){var o=e,n=n||t.location;null==e&&(e=n.protocol+"//"+n.host);"string"==typeof e&&("/"==e.charAt(0)&&(e="/"==e.charAt(1)?n.protocol+e:n.host+e),/^(https?|wss?):\/\//.test(e)||(r("protocol-less url %s",e),e=void 0!==n?n.protocol+"//"+e:"https://"+e),r("parse %s",e),o=i(e));o.port||(/^(http|ws)$/.test(o.protocol)?o.port="80":/^(http|ws)s$/.test(o.protocol)&&(o.port="443"));o.path=o.path||"/";var a=-1!==o.host.indexOf(":")?"["+o.host+"]":o.host;return o.id=o.protocol+"://"+a+":"+o.port,o.href=o.protocol+"://"+a+(n&&n.port==o.port?"":":"+o.port),o}}).call(t,function(){return this}())},function(e,t){var n=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,i=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];e.exports=function(e){var t=e,r=e.indexOf("["),o=e.indexOf("]");-1!=r&&-1!=o&&(e=e.substring(0,r)+e.substring(r,o).replace(/:/g,";")+e.substring(o,e.length));for(var a=n.exec(e||""),s={},u=14;u--;)s[i[u]]=a[u]||"";return-1!=r&&-1!=o&&(s.source=t,s.host=s.host.substring(1,s.host.length-1).replace(/;/g,":"),s.authority=s.authority.replace("[","").replace("]","").replace(/;/g,":"),s.ipv6uri=!0),s}},function(e,t){"use strict";e.exports=function(){return function(){}}},function(e,t,n){var i=n(3)("socket.io-parser"),r=n(5),o=(n(6),n(7)),a=n(8),s=n(9);function u(){}function c(e){var n="",o=!1;return n+=e.type,t.BINARY_EVENT!=e.type&&t.BINARY_ACK!=e.type||(n+=e.attachments,n+="-"),e.nsp&&"/"!=e.nsp&&(o=!0,n+=e.nsp),null!=e.id&&(o&&(n+=",",o=!1),n+=e.id),null!=e.data&&(o&&(n+=","),n+=r.stringify(e.data)),i("encoded %j as %s",e,n),n}function l(){this.reconstructor=null}function d(e){this.reconPack=e,this.buffers=[]}function p(e){return{type:t.ERROR,data:"parser error"}}t.protocol=4,t.types=["CONNECT","DISCONNECT","EVENT","ACK","ERROR","BINARY_EVENT","BINARY_ACK"],t.CONNECT=0,t.DISCONNECT=1,t.EVENT=2,t.ACK=3,t.ERROR=4,t.BINARY_EVENT=5,t.BINARY_ACK=6,t.Encoder=u,t.Decoder=l,u.prototype.encode=function(e,n){(i("encoding packet %j",e),t.BINARY_EVENT==e.type||t.BINARY_ACK==e.type)?function(e,t){a.removeBlobs(e,function(e){var n=a.deconstructPacket(e),i=c(n.packet),r=n.buffers;r.unshift(i),t(r)})}(e,n):n([c(e)])},o(l.prototype),l.prototype.add=function(e){var n;if("string"==typeof e)n=function(e){var n={},o=0;if(n.type=Number(e.charAt(0)),null==t.types[n.type])return p();if(t.BINARY_EVENT==n.type||t.BINARY_ACK==n.type){for(var a="";"-"!=e.charAt(++o)&&(a+=e.charAt(o),o!=e.length););if(a!=Number(a)||"-"!=e.charAt(o))throw new Error("Illegal attachments");n.attachments=Number(a)}if("/"==e.charAt(o+1))for(n.nsp="";++o;){var s=e.charAt(o);if(","==s)break;if(n.nsp+=s,o==e.length)break}else n.nsp="/";var u=e.charAt(o+1);if(""!==u&&Number(u)==u){for(n.id="";++o;){var s=e.charAt(o);if(null==s||Number(s)!=s){--o;break}if(n.id+=e.charAt(o),o==e.length)break}n.id=Number(n.id)}if(e.charAt(++o))try{n.data=r.parse(e.substr(o))}catch(e){return p()}return i("decoded %s as %j",e,n),n}(e),t.BINARY_EVENT==n.type||t.BINARY_ACK==n.type?(this.reconstructor=new d(n),0===this.reconstructor.reconPack.attachments&&this.emit("decoded",n)):this.emit("decoded",n);else{if(!s(e)&&!e.base64)throw new Error("Unknown type: "+e);if(!this.reconstructor)throw new Error("got binary data when not reconstructing a packet");(n=this.reconstructor.takeBinaryData(e))&&(this.reconstructor=null,this.emit("decoded",n))}},l.prototype.destroy=function(){this.reconstructor&&this.reconstructor.finishedReconstruction()},d.prototype.takeBinaryData=function(e){if(this.buffers.push(e),this.buffers.length==this.reconPack.attachments){var t=a.reconstructPacket(this.reconPack,this.buffers);return this.finishedReconstruction(),t}return null},d.prototype.finishedReconstruction=function(){this.reconPack=null,this.buffers=[]}},function(e,t){"use strict";e.exports=JSON},function(e,t){e.exports=Array.isArray||function(e){return"[object Array]"==Object.prototype.toString.call(e)}},function(e,t){function n(e){if(e)return function(e){for(var t in n.prototype)e[t]=n.prototype[t];return e}(e)}e.exports=n,n.prototype.on=n.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks[e]=this._callbacks[e]||[]).push(t),this},n.prototype.once=function(e,t){var n=this;function i(){n.off(e,i),t.apply(this,arguments)}return this._callbacks=this._callbacks||{},i.fn=t,this.on(e,i),this},n.prototype.off=n.prototype.removeListener=n.prototype.removeAllListeners=n.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var n,i=this._callbacks[e];if(!i)return this;if(1==arguments.length)return delete this._callbacks[e],this;for(var r=0;r<i.length;r++)if((n=i[r])===t||n.fn===t){i.splice(r,1);break}return this},n.prototype.emit=function(e){this._callbacks=this._callbacks||{};var t=[].slice.call(arguments,1),n=this._callbacks[e];if(n)for(var i=0,r=(n=n.slice(0)).length;i<r;++i)n[i].apply(this,t);return this},n.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks[e]||[]},n.prototype.hasListeners=function(e){return!!this.listeners(e).length}},function(e,t,n){(function(e){var i=n(6),r=n(9);t.deconstructPacket=function(e){var t=[],n=e.data;var o=e;return o.data=function e(n){if(!n)return n;if(r(n)){var o={_placeholder:!0,num:t.length};return t.push(n),o}if(i(n)){for(var a=new Array(n.length),s=0;s<n.length;s++)a[s]=e(n[s]);return a}if("object"==typeof n&&!(n instanceof Date)){for(var u in a={},n)a[u]=e(n[u]);return a}return n}(n),o.attachments=t.length,{packet:o,buffers:t}},t.reconstructPacket=function(e,t){return e.data=function e(n){if(n&&n._placeholder)return t[n.num];if(i(n)){for(var r=0;r<n.length;r++)n[r]=e(n[r]);return n}if(n&&"object"==typeof n){for(var o in n)n[o]=e(n[o]);return n}return n}(e.data),e.attachments=void 0,e},t.removeBlobs=function(t,n){var o=0,a=t;!function t(s,u,c){if(!s)return s;if(e.Blob&&s instanceof Blob||e.File&&s instanceof File){o++;var l=new FileReader;l.onload=function(){c?c[u]=this.result:a=this.result,--o||n(a)},l.readAsArrayBuffer(s)}else if(i(s))for(var d=0;d<s.length;d++)t(s[d],d,s);else if(s&&"object"==typeof s&&!r(s))for(var p in s)t(s[p],p,s)}(a),o||n(a)}}).call(t,function(){return this}())},function(e,t){(function(t){e.exports=function(e){return t.Buffer&&t.Buffer.isBuffer(e)||t.ArrayBuffer&&e instanceof ArrayBuffer}}).call(t,function(){return this}())},function(e,t,n){"use strict";var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e},r=n(11),o=n(37),a=n(38),s=n(4),u=n(40),c=n(41),l=n(3)("socket.io-client:manager"),d=n(35),p=n(43),f=Object.prototype.hasOwnProperty;function h(e,t){if(!(this instanceof h))return new h(e,t);e&&"object"==(void 0===e?"undefined":i(e))&&(t=e,e=void 0),(t=t||{}).path=t.path||"/socket.io",this.nsps={},this.subs=[],this.opts=t,this.reconnection(!1!==t.reconnection),this.reconnectionAttempts(t.reconnectionAttempts||1/0),this.reconnectionDelay(t.reconnectionDelay||1e3),this.reconnectionDelayMax(t.reconnectionDelayMax||5e3),this.randomizationFactor(t.randomizationFactor||.5),this.backoff=new p({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(null==t.timeout?2e4:t.timeout),this.readyState="closed",this.uri=e,this.connecting=[],this.lastPing=null,this.encoding=!1,this.packetBuffer=[],this.encoder=new s.Encoder,this.decoder=new s.Decoder,this.autoConnect=!1!==t.autoConnect,this.autoConnect&&this.open()}e.exports=h,h.prototype.emitAll=function(){for(var e in this.emit.apply(this,arguments),this.nsps)f.call(this.nsps,e)&&this.nsps[e].emit.apply(this.nsps[e],arguments)},h.prototype.updateSocketIds=function(){for(var e in this.nsps)f.call(this.nsps,e)&&(this.nsps[e].id=this.engine.id)},a(h.prototype),h.prototype.reconnection=function(e){return arguments.length?(this._reconnection=!!e,this):this._reconnection},h.prototype.reconnectionAttempts=function(e){return arguments.length?(this._reconnectionAttempts=e,this):this._reconnectionAttempts},h.prototype.reconnectionDelay=function(e){return arguments.length?(this._reconnectionDelay=e,this.backoff&&this.backoff.setMin(e),this):this._reconnectionDelay},h.prototype.randomizationFactor=function(e){return arguments.length?(this._randomizationFactor=e,this.backoff&&this.backoff.setJitter(e),this):this._randomizationFactor},h.prototype.reconnectionDelayMax=function(e){return arguments.length?(this._reconnectionDelayMax=e,this.backoff&&this.backoff.setMax(e),this):this._reconnectionDelayMax},h.prototype.timeout=function(e){return arguments.length?(this._timeout=e,this):this._timeout},h.prototype.maybeReconnectOnOpen=function(){!this.reconnecting&&this._reconnection&&0===this.backoff.attempts&&this.reconnect()},h.prototype.open=h.prototype.connect=function(e){if(l("readyState %s",this.readyState),~this.readyState.indexOf("open"))return this;l("opening %s",this.uri),this.engine=r(this.uri,this.opts);var t=this.engine,n=this;this.readyState="opening",this.skipReconnect=!1;var i=u(t,"open",function(){n.onopen(),e&&e()}),o=u(t,"error",function(t){if(l("connect_error"),n.cleanup(),n.readyState="closed",n.emitAll("connect_error",t),e){var i=new Error("Connection error");i.data=t,e(i)}else n.maybeReconnectOnOpen()});if(!1!==this._timeout){var a=this._timeout;l("connect attempt will timeout after %d",a);var s=setTimeout(function(){l("connect attempt timed out after %d",a),i.destroy(),t.close(),t.emit("error","timeout"),n.emitAll("connect_timeout",a)},a);this.subs.push({destroy:function(){clearTimeout(s)}})}return this.subs.push(i),this.subs.push(o),this},h.prototype.onopen=function(){l("open"),this.cleanup(),this.readyState="open",this.emit("open");var e=this.engine;this.subs.push(u(e,"data",c(this,"ondata"))),this.subs.push(u(e,"ping",c(this,"onping"))),this.subs.push(u(e,"pong",c(this,"onpong"))),this.subs.push(u(e,"error",c(this,"onerror"))),this.subs.push(u(e,"close",c(this,"onclose"))),this.subs.push(u(this.decoder,"decoded",c(this,"ondecoded")))},h.prototype.onping=function(){this.lastPing=new Date,this.emitAll("ping")},h.prototype.onpong=function(){this.emitAll("pong",new Date-this.lastPing)},h.prototype.ondata=function(e){this.decoder.add(e)},h.prototype.ondecoded=function(e){this.emit("packet",e)},h.prototype.onerror=function(e){l("error",e),this.emitAll("error",e)},h.prototype.socket=function(e){var t=this.nsps[e];if(!t){t=new o(this,e),this.nsps[e]=t;var n=this;t.on("connecting",i),t.on("connect",function(){t.id=n.engine.id}),this.autoConnect&&i()}function i(){~d(n.connecting,t)||n.connecting.push(t)}return t},h.prototype.destroy=function(e){var t=d(this.connecting,e);~t&&this.connecting.splice(t,1),this.connecting.length||this.close()},h.prototype.packet=function(e){l("writing packet %j",e);var t=this;t.encoding?t.packetBuffer.push(e):(t.encoding=!0,this.encoder.encode(e,function(n){for(var i=0;i<n.length;i++)t.engine.write(n[i],e.options);t.encoding=!1,t.processPacketQueue()}))},h.prototype.processPacketQueue=function(){if(this.packetBuffer.length>0&&!this.encoding){var e=this.packetBuffer.shift();this.packet(e)}},h.prototype.cleanup=function(){var e;for(l("cleanup");e=this.subs.shift();)e.destroy();this.packetBuffer=[],this.encoding=!1,this.lastPing=null,this.decoder.destroy()},h.prototype.close=h.prototype.disconnect=function(){l("disconnect"),this.skipReconnect=!0,this.reconnecting=!1,"opening"==this.readyState&&this.cleanup(),this.backoff.reset(),this.readyState="closed",this.engine&&this.engine.close()},h.prototype.onclose=function(e){l("onclose"),this.cleanup(),this.backoff.reset(),this.readyState="closed",this.emit("close",e),this._reconnection&&!this.skipReconnect&&this.reconnect()},h.prototype.reconnect=function(){if(this.reconnecting||this.skipReconnect)return this;var e=this;if(this.backoff.attempts>=this._reconnectionAttempts)l("reconnect failed"),this.backoff.reset(),this.emitAll("reconnect_failed"),this.reconnecting=!1;else{var t=this.backoff.duration();l("will wait %dms before reconnect attempt",t),this.reconnecting=!0;var n=setTimeout(function(){e.skipReconnect||(l("attempting reconnect"),e.emitAll("reconnect_attempt",e.backoff.attempts),e.emitAll("reconnecting",e.backoff.attempts),e.skipReconnect||e.open(function(t){t?(l("reconnect attempt error"),e.reconnecting=!1,e.reconnect(),e.emitAll("reconnect_error",t.data)):(l("reconnect success"),e.onreconnect())}))},t);this.subs.push({destroy:function(){clearTimeout(n)}})}},h.prototype.onreconnect=function(){var e=this.backoff.attempts;this.reconnecting=!1,this.backoff.reset(),this.updateSocketIds(),this.emitAll("reconnect",e)}},function(e,t,n){e.exports=n(12)},function(e,t,n){e.exports=n(13),e.exports.parser=n(21)},function(e,t,n){(function(t){var i=n(14),r=n(30),o=n(3)("engine.io-client:socket"),a=n(35),s=n(21),u=n(2),c=n(36),l=n(31);function d(e,n){if(!(this instanceof d))return new d(e,n);n=n||{},e&&"object"==typeof e&&(n=e,e=null),e?(e=u(e),n.hostname=e.host,n.secure="https"==e.protocol||"wss"==e.protocol,n.port=e.port,e.query&&(n.query=e.query)):n.host&&(n.hostname=u(n.host).host),this.secure=null!=n.secure?n.secure:t.location&&"https:"==location.protocol,n.hostname&&!n.port&&(n.port=this.secure?"443":"80"),this.agent=n.agent||!1,this.hostname=n.hostname||(t.location?location.hostname:"localhost"),this.port=n.port||(t.location&&location.port?location.port:this.secure?443:80),this.query=n.query||{},"string"==typeof this.query&&(this.query=l.decode(this.query)),this.upgrade=!1!==n.upgrade,this.path=(n.path||"/engine.io").replace(/\/$/,"")+"/",this.forceJSONP=!!n.forceJSONP,this.jsonp=!1!==n.jsonp,this.forceBase64=!!n.forceBase64,this.enablesXDR=!!n.enablesXDR,this.timestampParam=n.timestampParam||"t",this.timestampRequests=n.timestampRequests,this.transports=n.transports||["polling","websocket"],this.readyState="",this.writeBuffer=[],this.policyPort=n.policyPort||843,this.rememberUpgrade=n.rememberUpgrade||!1,this.binaryType=null,this.onlyBinaryUpgrades=n.onlyBinaryUpgrades,this.perMessageDeflate=!1!==n.perMessageDeflate&&(n.perMessageDeflate||{}),!0===this.perMessageDeflate&&(this.perMessageDeflate={}),this.perMessageDeflate&&null==this.perMessageDeflate.threshold&&(this.perMessageDeflate.threshold=1024),this.pfx=n.pfx||null,this.key=n.key||null,this.passphrase=n.passphrase||null,this.cert=n.cert||null,this.ca=n.ca||null,this.ciphers=n.ciphers||null,this.rejectUnauthorized=void 0===n.rejectUnauthorized?null:n.rejectUnauthorized;var i="object"==typeof t&&t;i.global===i&&n.extraHeaders&&Object.keys(n.extraHeaders).length>0&&(this.extraHeaders=n.extraHeaders),this.open()}e.exports=d,d.priorWebsocketSuccess=!1,r(d.prototype),d.protocol=s.protocol,d.Socket=d,d.Transport=n(20),d.transports=n(14),d.parser=n(21),d.prototype.createTransport=function(e){o('creating transport "%s"',e);var t=function(e){var t={};for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t}(this.query);return t.EIO=s.protocol,t.transport=e,this.id&&(t.sid=this.id),new i[e]({agent:this.agent,hostname:this.hostname,port:this.port,secure:this.secure,path:this.path,query:t,forceJSONP:this.forceJSONP,jsonp:this.jsonp,forceBase64:this.forceBase64,enablesXDR:this.enablesXDR,timestampRequests:this.timestampRequests,timestampParam:this.timestampParam,policyPort:this.policyPort,socket:this,pfx:this.pfx,key:this.key,passphrase:this.passphrase,cert:this.cert,ca:this.ca,ciphers:this.ciphers,rejectUnauthorized:this.rejectUnauthorized,perMessageDeflate:this.perMessageDeflate,extraHeaders:this.extraHeaders})},d.prototype.open=function(){var e;if(this.rememberUpgrade&&d.priorWebsocketSuccess&&-1!=this.transports.indexOf("websocket"))e="websocket";else{if(0===this.transports.length){var t=this;return void setTimeout(function(){t.emit("error","No transports available")},0)}e=this.transports[0]}this.readyState="opening";try{e=this.createTransport(e)}catch(e){return this.transports.shift(),void this.open()}e.open(),this.setTransport(e)},d.prototype.setTransport=function(e){o("setting transport %s",e.name);var t=this;this.transport&&(o("clearing existing transport %s",this.transport.name),this.transport.removeAllListeners()),this.transport=e,e.on("drain",function(){t.onDrain()}).on("packet",function(e){t.onPacket(e)}).on("error",function(e){t.onError(e)}).on("close",function(){t.onClose("transport close")})},d.prototype.probe=function(e){o('probing transport "%s"',e);var t=this.createTransport(e,{probe:1}),n=!1,i=this;function r(){if(i.onlyBinaryUpgrades){var r=!this.supportsBinary&&i.transport.supportsBinary;n=n||r}n||(o('probe transport "%s" opened',e),t.send([{type:"ping",data:"probe"}]),t.once("packet",function(r){if(!n)if("pong"==r.type&&"probe"==r.data){if(o('probe transport "%s" pong',e),i.upgrading=!0,i.emit("upgrading",t),!t)return;d.priorWebsocketSuccess="websocket"==t.name,o('pausing current transport "%s"',i.transport.name),i.transport.pause(function(){n||"closed"!=i.readyState&&(o("changing transport and sending upgrade packet"),p(),i.setTransport(t),t.send([{type:"upgrade"}]),i.emit("upgrade",t),t=null,i.upgrading=!1,i.flush())})}else{o('probe transport "%s" failed',e);var a=new Error("probe error");a.transport=t.name,i.emit("upgradeError",a)}}))}function a(){n||(n=!0,p(),t.close(),t=null)}function s(n){var r=new Error("probe error: "+n);r.transport=t.name,a(),o('probe transport "%s" failed because of error: %s',e,n),i.emit("upgradeError",r)}function u(){s("transport closed")}function c(){s("socket closed")}function l(e){t&&e.name!=t.name&&(o('"%s" works - aborting "%s"',e.name,t.name),a())}function p(){t.removeListener("open",r),t.removeListener("error",s),t.removeListener("close",u),i.removeListener("close",c),i.removeListener("upgrading",l)}d.priorWebsocketSuccess=!1,t.once("open",r),t.once("error",s),t.once("close",u),this.once("close",c),this.once("upgrading",l),t.open()},d.prototype.onOpen=function(){if(o("socket open"),this.readyState="open",d.priorWebsocketSuccess="websocket"==this.transport.name,this.emit("open"),this.flush(),"open"==this.readyState&&this.upgrade&&this.transport.pause){o("starting upgrade probes");for(var e=0,t=this.upgrades.length;e<t;e++)this.probe(this.upgrades[e])}},d.prototype.onPacket=function(e){if("opening"==this.readyState||"open"==this.readyState)switch(o('socket receive: type "%s", data "%s"',e.type,e.data),this.emit("packet",e),this.emit("heartbeat"),e.type){case"open":this.onHandshake(c(e.data));break;case"pong":this.setPing(),this.emit("pong");break;case"error":var t=new Error("server error");t.code=e.data,this.onError(t);break;case"message":this.emit("data",e.data),this.emit("message",e.data)}else o('packet received with socket readyState "%s"',this.readyState)},d.prototype.onHandshake=function(e){this.emit("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this.upgrades=this.filterUpgrades(e.upgrades),this.pingInterval=e.pingInterval,this.pingTimeout=e.pingTimeout,this.onOpen(),"closed"!=this.readyState&&(this.setPing(),this.removeListener("heartbeat",this.onHeartbeat),this.on("heartbeat",this.onHeartbeat))},d.prototype.onHeartbeat=function(e){clearTimeout(this.pingTimeoutTimer);var t=this;t.pingTimeoutTimer=setTimeout(function(){"closed"!=t.readyState&&t.onClose("ping timeout")},e||t.pingInterval+t.pingTimeout)},d.prototype.setPing=function(){var e=this;clearTimeout(e.pingIntervalTimer),e.pingIntervalTimer=setTimeout(function(){o("writing ping packet - expecting pong within %sms",e.pingTimeout),e.ping(),e.onHeartbeat(e.pingTimeout)},e.pingInterval)},d.prototype.ping=function(){var e=this;this.sendPacket("ping",function(){e.emit("ping")})},d.prototype.onDrain=function(){this.writeBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,0===this.writeBuffer.length?this.emit("drain"):this.flush()},d.prototype.flush=function(){"closed"!=this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length&&(o("flushing %d packets in socket",this.writeBuffer.length),this.transport.send(this.writeBuffer),this.prevBufferLen=this.writeBuffer.length,this.emit("flush"))},d.prototype.write=d.prototype.send=function(e,t,n){return this.sendPacket("message",e,t,n),this},d.prototype.sendPacket=function(e,t,n,i){if("function"==typeof t&&(i=t,t=void 0),"function"==typeof n&&(i=n,n=null),"closing"!=this.readyState&&"closed"!=this.readyState){(n=n||{}).compress=!1!==n.compress;var r={type:e,data:t,options:n};this.emit("packetCreate",r),this.writeBuffer.push(r),i&&this.once("flush",i),this.flush()}},d.prototype.close=function(){if("opening"==this.readyState||"open"==this.readyState){this.readyState="closing";var e=this;this.writeBuffer.length?this.once("drain",function(){this.upgrading?i():t()}):this.upgrading?i():t()}function t(){e.onClose("forced close"),o("socket closing - telling transport to close"),e.transport.close()}function n(){e.removeListener("upgrade",n),e.removeListener("upgradeError",n),t()}function i(){e.once("upgrade",n),e.once("upgradeError",n)}return this},d.prototype.onError=function(e){o("socket error %j",e),d.priorWebsocketSuccess=!1,this.emit("error",e),this.onClose("transport error",e)},d.prototype.onClose=function(e,t){if("opening"==this.readyState||"open"==this.readyState||"closing"==this.readyState){o('socket close with reason: "%s"',e);clearTimeout(this.pingIntervalTimer),clearTimeout(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),this.readyState="closed",this.id=null,this.emit("close",e,t),this.writeBuffer=[],this.prevBufferLen=0}},d.prototype.filterUpgrades=function(e){for(var t=[],n=0,i=e.length;n<i;n++)~a(this.transports,e[n])&&t.push(e[n]);return t}}).call(t,function(){return this}())},function(e,t,n){(function(e){var i=n(15),r=n(17),o=n(18),a=n(19);t.polling=function(t){var n=!1,a=!1,s=!1!==t.jsonp;if(e.location){var u="https:"==location.protocol,c=location.port;c||(c=u?443:80),n=t.hostname!=location.hostname||c!=t.port,a=t.secure!=u}if(t.xdomain=n,t.xscheme=a,"open"in new i(t)&&!t.forceJSONP)return new r(t);if(!s)throw new Error("JSONP disabled");return new o(t)},t.websocket=a}).call(t,function(){return this}())},function(e,t,n){var i=n(16);e.exports=function(e){var t=e.xdomain,n=e.xscheme,r=e.enablesXDR;try{if("undefined"!=typeof XMLHttpRequest&&(!t||i))return new XMLHttpRequest}catch(e){}try{if("undefined"!=typeof XDomainRequest&&!n&&r)return new XDomainRequest}catch(e){}if(!t)try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(e){}}},function(e,t){try{e.exports="undefined"!=typeof XMLHttpRequest&&"withCredentials"in new XMLHttpRequest}catch(t){e.exports=!1}},function(e,t){e.exports=function(){}},function(e,t){e.exports=function(){}},function(e,t,n){(function(t){var i=n(20),r=n(21),o=n(31),a=n(32),s=n(33),u=n(3)("engine.io-client:websocket"),c=t.WebSocket||t.MozWebSocket,l=c;if(!l&&"undefined"==typeof window)try{l=n(34)}catch(e){}function d(e){e&&e.forceBase64&&(this.supportsBinary=!1),this.perMessageDeflate=e.perMessageDeflate,i.call(this,e)}e.exports=d,a(d,i),d.prototype.name="websocket",d.prototype.supportsBinary=!0,d.prototype.doOpen=function(){if(this.check()){var e=this.uri(),t={agent:this.agent,perMessageDeflate:this.perMessageDeflate};t.pfx=this.pfx,t.key=this.key,t.passphrase=this.passphrase,t.cert=this.cert,t.ca=this.ca,t.ciphers=this.ciphers,t.rejectUnauthorized=this.rejectUnauthorized,this.extraHeaders&&(t.headers=this.extraHeaders),this.ws=c?new l(e):new l(e,void 0,t),void 0===this.ws.binaryType&&(this.supportsBinary=!1),this.ws.supports&&this.ws.supports.binary?(this.supportsBinary=!0,this.ws.binaryType="buffer"):this.ws.binaryType="arraybuffer",this.addEventListeners()}},d.prototype.addEventListeners=function(){var e=this;this.ws.onopen=function(){e.onOpen()},this.ws.onclose=function(){e.onClose()},this.ws.onmessage=function(t){e.onData(t.data)},this.ws.onerror=function(t){e.onError("websocket error",t)}},"undefined"!=typeof navigator&&/iPad|iPhone|iPod/i.test(navigator.userAgent)&&(d.prototype.onData=function(e){var t=this;setTimeout(function(){i.prototype.onData.call(t,e)},0)}),d.prototype.write=function(e){var n=this;this.writable=!1;for(var i=e.length,o=0,a=i;o<a;o++)!function(e){r.encodePacket(e,n.supportsBinary,function(r){if(!c){var o={};if(e.options&&(o.compress=e.options.compress),n.perMessageDeflate)("string"==typeof r?t.Buffer.byteLength(r):r.length)<n.perMessageDeflate.threshold&&(o.compress=!1)}try{c?n.ws.send(r):n.ws.send(r,o)}catch(e){u("websocket closed before onclose event")}--i||s()})}(e[o]);function s(){n.emit("flush"),setTimeout(function(){n.writable=!0,n.emit("drain")},0)}},d.prototype.onClose=function(){i.prototype.onClose.call(this)},d.prototype.doClose=function(){void 0!==this.ws&&this.ws.close()},d.prototype.uri=function(){var e=this.query||{},t=this.secure?"wss":"ws",n="";return this.port&&("wss"==t&&443!=this.port||"ws"==t&&80!=this.port)&&(n=":"+this.port),this.timestampRequests&&(e[this.timestampParam]=s()),this.supportsBinary||(e.b64=1),(e=o.encode(e)).length&&(e="?"+e),t+"://"+(-1!==this.hostname.indexOf(":")?"["+this.hostname+"]":this.hostname)+n+this.path+e},d.prototype.check=function(){return!(!l||"__initialize"in l&&this.name===d.prototype.name)}}).call(t,function(){return this}())},function(e,t,n){var i=n(21),r=n(30);function o(e){this.path=e.path,this.hostname=e.hostname,this.port=e.port,this.secure=e.secure,this.query=e.query,this.timestampParam=e.timestampParam,this.timestampRequests=e.timestampRequests,this.readyState="",this.agent=e.agent||!1,this.socket=e.socket,this.enablesXDR=e.enablesXDR,this.pfx=e.pfx,this.key=e.key,this.passphrase=e.passphrase,this.cert=e.cert,this.ca=e.ca,this.ciphers=e.ciphers,this.rejectUnauthorized=e.rejectUnauthorized,this.extraHeaders=e.extraHeaders}e.exports=o,r(o.prototype),o.prototype.onError=function(e,t){var n=new Error(e);return n.type="TransportError",n.description=t,this.emit("error",n),this},o.prototype.open=function(){return"closed"!=this.readyState&&""!=this.readyState||(this.readyState="opening",this.doOpen()),this},o.prototype.close=function(){return"opening"!=this.readyState&&"open"!=this.readyState||(this.doClose(),this.onClose()),this},o.prototype.send=function(e){if("open"!=this.readyState)throw new Error("Transport not open");this.write(e)},o.prototype.onOpen=function(){this.readyState="open",this.writable=!0,this.emit("open")},o.prototype.onData=function(e){var t=i.decodePacket(e,this.socket.binaryType);this.onPacket(t)},o.prototype.onPacket=function(e){this.emit("packet",e)},o.prototype.onClose=function(){this.readyState="closed",this.emit("close")}},function(e,t,n){(function(e){var i=n(22),r=n(23),o=n(24),a=n(25),s=n(26),u=n(27),c=navigator.userAgent.match(/Android/i),l=/PhantomJS/i.test(navigator.userAgent),d=c||l;t.protocol=3;var p=t.packets={open:0,close:1,ping:2,pong:3,message:4,upgrade:5,noop:6},f=i(p),h={type:"error",data:"parser error"},m=n(29);function g(e,t,n){for(var i=new Array(e.length),r=s(e.length,n),o=function(e,n,r){t(n,function(t,n){i[e]=n,r(t,i)})},a=0;a<e.length;a++)o(a,e[a],r)}t.encodePacket=function(n,i,r,o){"function"==typeof i&&(o=i,i=!1),"function"==typeof r&&(o=r,r=null);var a=void 0===n.data?void 0:n.data.buffer||n.data;if(e.ArrayBuffer&&a instanceof ArrayBuffer)return function(e,n,i){if(!n)return t.encodeBase64Packet(e,i);var r=e.data,o=new Uint8Array(r),a=new Uint8Array(1+r.byteLength);a[0]=p[e.type];for(var s=0;s<o.length;s++)a[s+1]=o[s];return i(a.buffer)}(n,i,o);if(m&&a instanceof e.Blob)return function(e,n,i){if(!n)return t.encodeBase64Packet(e,i);if(d)return function(e,n,i){if(!n)return t.encodeBase64Packet(e,i);var r=new FileReader;return r.onload=function(){e.data=r.result,t.encodePacket(e,n,!0,i)},r.readAsArrayBuffer(e.data)}(e,n,i);var r=new Uint8Array(1);r[0]=p[e.type];var o=new m([r.buffer,e.data]);return i(o)}(n,i,o);if(a&&a.base64)return function(e,n){var i="b"+t.packets[e.type]+e.data.data;return n(i)}(n,o);var s=p[n.type];return void 0!==n.data&&(s+=r?u.encode(String(n.data)):String(n.data)),o(""+s)},t.encodeBase64Packet=function(n,i){var r,o="b"+t.packets[n.type];if(m&&n.data instanceof e.Blob){var a=new FileReader;return a.onload=function(){var e=a.result.split(",")[1];i(o+e)},a.readAsDataURL(n.data)}try{r=String.fromCharCode.apply(null,new Uint8Array(n.data))}catch(e){for(var s=new Uint8Array(n.data),u=new Array(s.length),c=0;c<s.length;c++)u[c]=s[c];r=String.fromCharCode.apply(null,u)}return o+=e.btoa(r),i(o)},t.decodePacket=function(e,n,i){if("string"==typeof e||void 0===e){if("b"==e.charAt(0))return t.decodeBase64Packet(e.substr(1),n);if(i)try{e=u.decode(e)}catch(e){return h}var r=e.charAt(0);return Number(r)==r&&f[r]?e.length>1?{type:f[r],data:e.substring(1)}:{type:f[r]}:h}r=new Uint8Array(e)[0];var a=o(e,1);return m&&"blob"===n&&(a=new m([a])),{type:f[r],data:a}},t.decodeBase64Packet=function(t,n){var i=f[t.charAt(0)];if(!e.ArrayBuffer)return{type:i,data:{base64:!0,data:t.substr(1)}};var r=a.decode(t.substr(1));return"blob"===n&&m&&(r=new m([r])),{type:i,data:r}},t.encodePayload=function(e,n,i){"function"==typeof n&&(i=n,n=null);var o=r(e);if(n&&o)return m&&!d?t.encodePayloadAsBlob(e,i):t.encodePayloadAsArrayBuffer(e,i);if(!e.length)return i("0:");g(e,function(e,i){t.encodePacket(e,!!o&&n,!0,function(e){i(null,function(e){return e.length+":"+e}(e))})},function(e,t){return i(t.join(""))})},t.decodePayload=function(e,n,i){if("string"!=typeof e)return t.decodePayloadAsBinary(e,n,i);var r;if("function"==typeof n&&(i=n,n=null),""==e)return i(h,0,1);for(var o,a,s="",u=0,c=e.length;u<c;u++){var l=e.charAt(u);if(":"!=l)s+=l;else{if(""==s||s!=(o=Number(s)))return i(h,0,1);if(s!=(a=e.substr(u+1,o)).length)return i(h,0,1);if(a.length){if(r=t.decodePacket(a,n,!0),h.type==r.type&&h.data==r.data)return i(h,0,1);if(!1===i(r,u+o,c))return}u+=o,s=""}}return""!=s?i(h,0,1):void 0},t.encodePayloadAsArrayBuffer=function(e,n){if(!e.length)return n(new ArrayBuffer(0));g(e,function(e,n){t.encodePacket(e,!0,!0,function(e){return n(null,e)})},function(e,t){var i=t.reduce(function(e,t){var n;return e+(n="string"==typeof t?t.length:t.byteLength).toString().length+n+2},0),r=new Uint8Array(i),o=0;return t.forEach(function(e){var t="string"==typeof e,n=e;if(t){for(var i=new Uint8Array(e.length),a=0;a<e.length;a++)i[a]=e.charCodeAt(a);n=i.buffer}r[o++]=t?0:1;var s=n.byteLength.toString();for(a=0;a<s.length;a++)r[o++]=parseInt(s[a]);r[o++]=255;for(i=new Uint8Array(n),a=0;a<i.length;a++)r[o++]=i[a]}),n(r.buffer)})},t.encodePayloadAsBlob=function(e,n){g(e,function(e,n){t.encodePacket(e,!0,!0,function(e){var t=new Uint8Array(1);if(t[0]=1,"string"==typeof e){for(var i=new Uint8Array(e.length),r=0;r<e.length;r++)i[r]=e.charCodeAt(r);e=i.buffer,t[0]=0}var o=(e instanceof ArrayBuffer?e.byteLength:e.size).toString(),a=new Uint8Array(o.length+1);for(r=0;r<o.length;r++)a[r]=parseInt(o[r]);if(a[o.length]=255,m){var s=new m([t.buffer,a.buffer,e]);n(null,s)}})},function(e,t){return n(new m(t))})},t.decodePayloadAsBinary=function(e,n,i){"function"==typeof n&&(i=n,n=null);for(var r=e,a=[],s=!1;r.byteLength>0;){for(var u=new Uint8Array(r),c=0===u[0],l="",d=1;255!=u[d];d++){if(l.length>310){s=!0;break}l+=u[d]}if(s)return i(h,0,1);r=o(r,2+l.length),l=parseInt(l);var p=o(r,0,l);if(c)try{p=String.fromCharCode.apply(null,new Uint8Array(p))}catch(e){var f=new Uint8Array(p);p="";for(d=0;d<f.length;d++)p+=String.fromCharCode(f[d])}a.push(p),r=o(r,l)}var m=a.length;a.forEach(function(e,r){i(t.decodePacket(e,n,!0),r,m)})}}).call(t,function(){return this}())},function(e,t){e.exports=Object.keys||function(e){var t=[],n=Object.prototype.hasOwnProperty;for(var i in e)n.call(e,i)&&t.push(i);return t}},function(e,t,n){(function(t){var i=n(6);e.exports=function(e){return function e(n){if(!n)return!1;if(t.Buffer&&t.Buffer.isBuffer(n)||t.ArrayBuffer&&n instanceof ArrayBuffer||t.Blob&&n instanceof Blob||t.File&&n instanceof File)return!0;if(i(n)){for(var r=0;r<n.length;r++)if(e(n[r]))return!0}else if(n&&"object"==typeof n)for(var o in n.toJSON&&(n=n.toJSON()),n)if(Object.prototype.hasOwnProperty.call(n,o)&&e(n[o]))return!0;return!1}(e)}}).call(t,function(){return this}())},function(e,t){e.exports=function(e,t,n){var i=e.byteLength;if(t=t||0,n=n||i,e.slice)return e.slice(t,n);if(t<0&&(t+=i),n<0&&(n+=i),n>i&&(n=i),t>=i||t>=n||0===i)return new ArrayBuffer(0);for(var r=new Uint8Array(e),o=new Uint8Array(n-t),a=t,s=0;a<n;a++,s++)o[s]=r[a];return o.buffer}},function(e,t){!function(){"use strict";for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",n=new Uint8Array(256),i=0;i<e.length;i++)n[e.charCodeAt(i)]=i;t.encode=function(t){var n,i=new Uint8Array(t),r=i.length,o="";for(n=0;n<r;n+=3)o+=e[i[n]>>2],o+=e[(3&i[n])<<4|i[n+1]>>4],o+=e[(15&i[n+1])<<2|i[n+2]>>6],o+=e[63&i[n+2]];return r%3==2?o=o.substring(0,o.length-1)+"=":r%3==1&&(o=o.substring(0,o.length-2)+"=="),o},t.decode=function(e){var t,i,r,o,a,s=.75*e.length,u=e.length,c=0;"="===e[e.length-1]&&(s--,"="===e[e.length-2]&&s--);var l=new ArrayBuffer(s),d=new Uint8Array(l);for(t=0;t<u;t+=4)i=n[e.charCodeAt(t)],r=n[e.charCodeAt(t+1)],o=n[e.charCodeAt(t+2)],a=n[e.charCodeAt(t+3)],d[c++]=i<<2|r>>4,d[c++]=(15&r)<<4|o>>2,d[c++]=(3&o)<<6|63&a;return l}}()},function(e,t){function n(){}e.exports=function(e,t,i){var r=!1;return i=i||n,o.count=e,0===e?t():o;function o(e,n){if(o.count<=0)throw new Error("after called too many times");--o.count,e?(r=!0,t(e),t=i):0!==o.count||r||t(null,n)}}},function(e,t,n){var i;(function(e,r){!function(o){var a="object"==typeof t&&t,s=("object"==typeof e&&e&&e.exports,"object"==typeof r&&r);s.global!==s&&s.window;var u,c,l,d=String.fromCharCode;function p(e){for(var t,n,i=[],r=0,o=e.length;r<o;)(t=e.charCodeAt(r++))>=55296&&t<=56319&&r<o?56320==(64512&(n=e.charCodeAt(r++)))?i.push(((1023&t)<<10)+(1023&n)+65536):(i.push(t),r--):i.push(t);return i}function f(e){if(e>=55296&&e<=57343)throw Error("Lone surrogate U+"+e.toString(16).toUpperCase()+" is not a scalar value")}function h(e,t){return d(e>>t&63|128)}function m(e){if(0==(4294967168&e))return d(e);var t="";return 0==(4294965248&e)?t=d(e>>6&31|192):0==(4294901760&e)?(f(e),t=d(e>>12&15|224),t+=h(e,6)):0==(4292870144&e)&&(t=d(e>>18&7|240),t+=h(e,12),t+=h(e,6)),t+=d(63&e|128)}function g(){if(l>=c)throw Error("Invalid byte index");var e=255&u[l];if(l++,128==(192&e))return 63&e;throw Error("Invalid continuation byte")}function v(){var e,t;if(l>c)throw Error("Invalid byte index");if(l==c)return!1;if(e=255&u[l],l++,0==(128&e))return e;if(192==(224&e)){if((t=(31&e)<<6|g())>=128)return t;throw Error("Invalid continuation byte")}if(224==(240&e)){if((t=(15&e)<<12|g()<<6|g())>=2048)return f(t),t;throw Error("Invalid continuation byte")}if(240==(248&e)&&(t=(15&e)<<18|g()<<12|g()<<6|g())>=65536&&t<=1114111)return t;throw Error("Invalid UTF-8 detected")}var y={version:"2.0.0",encode:function(e){for(var t=p(e),n=t.length,i=-1,r="";++i<n;)r+=m(t[i]);return r},decode:function(e){u=p(e),c=u.length,l=0;for(var t,n=[];!1!==(t=v());)n.push(t);return function(e){for(var t,n=e.length,i=-1,r="";++i<n;)(t=e[i])>65535&&(r+=d((t-=65536)>>>10&1023|55296),t=56320|1023&t),r+=d(t);return r}(n)}};void 0===(i=function(){return y}.call(t,n,t,e))||(e.exports=i)}()}).call(t,n(28)(e),function(){return this}())},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children=[],e.webpackPolyfill=1),e}},function(e,t){(function(t){var n=t.BlobBuilder||t.WebKitBlobBuilder||t.MSBlobBuilder||t.MozBlobBuilder,i=function(){try{return 2===new Blob(["hi"]).size}catch(e){return!1}}(),r=i&&function(){try{return 2===new Blob([new Uint8Array([1,2])]).size}catch(e){return!1}}(),o=n&&n.prototype.append&&n.prototype.getBlob;function a(e){for(var t=0;t<e.length;t++){var n=e[t];if(n.buffer instanceof ArrayBuffer){var i=n.buffer;if(n.byteLength!==i.byteLength){var r=new Uint8Array(n.byteLength);r.set(new Uint8Array(i,n.byteOffset,n.byteLength)),i=r.buffer}e[t]=i}}}function s(e,t){t=t||{};var i=new n;a(e);for(var r=0;r<e.length;r++)i.append(e[r]);return t.type?i.getBlob(t.type):i.getBlob()}function u(e,t){return a(e),new Blob(e,t||{})}e.exports=i?r?t.Blob:u:o?s:void 0}).call(t,function(){return this}())},function(e,t){function n(e){if(e)return function(e){for(var t in n.prototype)e[t]=n.prototype[t];return e}(e)}e.exports=n,n.prototype.on=n.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks[e]=this._callbacks[e]||[]).push(t),this},n.prototype.once=function(e,t){var n=this;function i(){n.off(e,i),t.apply(this,arguments)}return this._callbacks=this._callbacks||{},i.fn=t,this.on(e,i),this},n.prototype.off=n.prototype.removeListener=n.prototype.removeAllListeners=n.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var n,i=this._callbacks[e];if(!i)return this;if(1==arguments.length)return delete this._callbacks[e],this;for(var r=0;r<i.length;r++)if((n=i[r])===t||n.fn===t){i.splice(r,1);break}return this},n.prototype.emit=function(e){this._callbacks=this._callbacks||{};var t=[].slice.call(arguments,1),n=this._callbacks[e];if(n)for(var i=0,r=(n=n.slice(0)).length;i<r;++i)n[i].apply(this,t);return this},n.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks[e]||[]},n.prototype.hasListeners=function(e){return!!this.listeners(e).length}},function(e,t){t.encode=function(e){var t="";for(var n in e)e.hasOwnProperty(n)&&(t.length&&(t+="&"),t+=encodeURIComponent(n)+"="+encodeURIComponent(e[n]));return t},t.decode=function(e){for(var t={},n=e.split("&"),i=0,r=n.length;i<r;i++){var o=n[i].split("=");t[decodeURIComponent(o[0])]=decodeURIComponent(o[1])}return t}},function(e,t){e.exports=function(e,t){var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}},function(e,t){"use strict";var n,i="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),r=64,o={},a=0,s=0;function u(e){var t="";do{t=i[e%r]+t,e=Math.floor(e/r)}while(e>0);return t}function c(){var e=u(+new Date);return e!==n?(a=0,n=e):e+"."+u(a++)}for(;s<r;s++)o[i[s]]=s;c.encode=u,c.decode=function(e){var t=0;for(s=0;s<e.length;s++)t=t*r+o[e.charAt(s)];return t},e.exports=c},function(e,t){},function(e,t){var n=[].indexOf;e.exports=function(e,t){if(n)return e.indexOf(t);for(var i=0;i<e.length;++i)if(e[i]===t)return i;return-1}},function(e,t){(function(t){var n=/^[\],:{}\s]*$/,i=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,r=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,o=/(?:^|:|,)(?:\s*\[)+/g,a=/^\s+/,s=/\s+$/;e.exports=function(e){return"string"==typeof e&&e?(e=e.replace(a,"").replace(s,""),t.JSON&&JSON.parse?JSON.parse(e):n.test(e.replace(i,"@").replace(r,"]").replace(o,""))?new Function("return "+e)():void 0):null}}).call(t,function(){return this}())},function(e,t,n){"use strict";var i=n(4),r=n(38),o=n(39),a=n(40),s=n(41),u=n(3)("socket.io-client:socket"),c=n(42);e.exports=p;var l={connect:1,connect_error:1,connect_timeout:1,connecting:1,disconnect:1,error:1,reconnect:1,reconnect_attempt:1,reconnect_failed:1,reconnect_error:1,reconnecting:1,ping:1,pong:1},d=r.prototype.emit;function p(e,t){this.io=e,this.nsp=t,this.json=this,this.ids=0,this.acks={},this.receiveBuffer=[],this.sendBuffer=[],this.connected=!1,this.disconnected=!0,this.io.autoConnect&&this.open()}r(p.prototype),p.prototype.subEvents=function(){if(!this.subs){var e=this.io;this.subs=[a(e,"open",s(this,"onopen")),a(e,"packet",s(this,"onpacket")),a(e,"close",s(this,"onclose"))]}},p.prototype.open=p.prototype.connect=function(){return this.connected?this:(this.subEvents(),this.io.open(),"open"==this.io.readyState&&this.onopen(),this.emit("connecting"),this)},p.prototype.send=function(){var e=o(arguments);return e.unshift("message"),this.emit.apply(this,e),this},p.prototype.emit=function(e){if(l.hasOwnProperty(e))return d.apply(this,arguments),this;var t=o(arguments),n=i.EVENT;c(t)&&(n=i.BINARY_EVENT);var r={type:n,data:t,options:{}};return r.options.compress=!this.flags||!1!==this.flags.compress,"function"==typeof t[t.length-1]&&(u("emitting packet with ack id %d",this.ids),this.acks[this.ids]=t.pop(),r.id=this.ids++),this.connected?this.packet(r):this.sendBuffer.push(r),delete this.flags,this},p.prototype.packet=function(e){e.nsp=this.nsp,this.io.packet(e)},p.prototype.onopen=function(){u("transport is open - connecting"),"/"!=this.nsp&&this.packet({type:i.CONNECT})},p.prototype.onclose=function(e){u("close (%s)",e),this.connected=!1,this.disconnected=!0,delete this.id,this.emit("disconnect",e)},p.prototype.onpacket=function(e){if(e.nsp==this.nsp)switch(e.type){case i.CONNECT:this.onconnect();break;case i.EVENT:case i.BINARY_EVENT:this.onevent(e);break;case i.ACK:case i.BINARY_ACK:this.onack(e);break;case i.DISCONNECT:this.ondisconnect();break;case i.ERROR:this.emit("error",e.data)}},p.prototype.onevent=function(e){var t=e.data||[];u("emitting event %j",t),null!=e.id&&(u("attaching ack callback to event"),t.push(this.ack(e.id))),this.connected?d.apply(this,t):this.receiveBuffer.push(t)},p.prototype.ack=function(e){var t=this,n=!1;return function(){if(!n){n=!0;var r=o(arguments);u("sending ack %j",r);var a=c(r)?i.BINARY_ACK:i.ACK;t.packet({type:a,id:e,data:r})}}},p.prototype.onack=function(e){var t=this.acks[e.id];"function"==typeof t?(u("calling ack %s with %j",e.id,e.data),t.apply(this,e.data),delete this.acks[e.id]):u("bad ack %s",e.id)},p.prototype.onconnect=function(){this.connected=!0,this.disconnected=!1,this.emit("connect"),this.emitBuffered()},p.prototype.emitBuffered=function(){var e;for(e=0;e<this.receiveBuffer.length;e++)d.apply(this,this.receiveBuffer[e]);for(this.receiveBuffer=[],e=0;e<this.sendBuffer.length;e++)this.packet(this.sendBuffer[e]);this.sendBuffer=[]},p.prototype.ondisconnect=function(){u("server disconnect (%s)",this.nsp),this.destroy(),this.onclose("io server disconnect")},p.prototype.destroy=function(){if(this.subs){for(var e=0;e<this.subs.length;e++)this.subs[e].destroy();this.subs=null}this.io.destroy(this)},p.prototype.close=p.prototype.disconnect=function(){return this.connected&&(u("performing disconnect (%s)",this.nsp),this.packet({type:i.DISCONNECT})),this.destroy(),this.connected&&this.onclose("io client disconnect"),this},p.prototype.compress=function(e){return this.flags=this.flags||{},this.flags.compress=e,this}},function(e,t){function n(e){if(e)return function(e){for(var t in n.prototype)e[t]=n.prototype[t];return e}(e)}e.exports=n,n.prototype.on=n.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks["$"+e]=this._callbacks["$"+e]||[]).push(t),this},n.prototype.once=function(e,t){function n(){this.off(e,n),t.apply(this,arguments)}return n.fn=t,this.on(e,n),this},n.prototype.off=n.prototype.removeListener=n.prototype.removeAllListeners=n.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var n,i=this._callbacks["$"+e];if(!i)return this;if(1==arguments.length)return delete this._callbacks["$"+e],this;for(var r=0;r<i.length;r++)if((n=i[r])===t||n.fn===t){i.splice(r,1);break}return this},n.prototype.emit=function(e){this._callbacks=this._callbacks||{};var t=[].slice.call(arguments,1),n=this._callbacks["$"+e];if(n)for(var i=0,r=(n=n.slice(0)).length;i<r;++i)n[i].apply(this,t);return this},n.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks["$"+e]||[]},n.prototype.hasListeners=function(e){return!!this.listeners(e).length}},function(e,t){e.exports=function(e,t){for(var n=[],i=(t=t||0)||0;i<e.length;i++)n[i-t]=e[i];return n}},function(e,t){"use strict";e.exports=function(e,t,n){return e.on(t,n),{destroy:function(){e.removeListener(t,n)}}}},function(e,t){var n=[].slice;e.exports=function(e,t){if("string"==typeof t&&(t=e[t]),"function"!=typeof t)throw new Error("bind() requires a function");var i=n.call(arguments,2);return function(){return t.apply(e,i.concat(n.call(arguments)))}}},function(e,t,n){(function(t){var i=n(6);e.exports=function(e){return function e(n){if(!n)return!1;if(t.Buffer&&t.Buffer.isBuffer&&t.Buffer.isBuffer(n)||t.ArrayBuffer&&n instanceof ArrayBuffer||t.Blob&&n instanceof Blob||t.File&&n instanceof File)return!0;if(i(n)){for(var r=0;r<n.length;r++)if(e(n[r]))return!0}else if(n&&"object"==typeof n)for(var o in n.toJSON&&"function"==typeof n.toJSON&&(n=n.toJSON()),n)if(Object.prototype.hasOwnProperty.call(n,o)&&e(n[o]))return!0;return!1}(e)}}).call(t,function(){return this}())},function(e,t){function n(e){e=e||{},this.ms=e.min||100,this.max=e.max||1e4,this.factor=e.factor||2,this.jitter=e.jitter>0&&e.jitter<=1?e.jitter:0,this.attempts=0}e.exports=n,n.prototype.duration=function(){var e=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var t=Math.random(),n=Math.floor(t*this.jitter*e);e=0==(1&Math.floor(10*t))?e-n:e+n}return 0|Math.min(e,this.max)},n.prototype.reset=function(){this.attempts=0},n.prototype.setMin=function(e){this.ms=e},n.prototype.setMax=function(e){this.max=e},n.prototype.setJitter=function(e){this.jitter=e}}])}),define("app/core/SocketSandbox",["underscore"],function(e){"use strict";function t(e){if(this.socket=e,this.listeners={destroy:[]},e instanceof t){var n=this;this.socket.on("destroy",function(){n.destroy()})}}return t.prototype.destroy=function(){var t=this.listeners;if(null!=t){var n=t.destroy;if(e.isArray(n))for(var i=0,r=n.length;i<r;++i)n[i].call(this);delete this.listeners.destroy;for(var o=Object.keys(t),a=0,s=o.length;a<s;++a)for(var u=o[a],c=t[u],l=0,d=c.length;l<d;++l)this.socket.off(u,c[l]);this.listeners=null,this.socket=null}},t.prototype.sandbox=function(){return new t(this)},t.prototype.getId=function(){return!!this.socket&&this.socket.getId()},t.prototype.isConnected=function(){return!!this.socket&&this.socket.isConnected()},t.prototype.on=function(t,n){var i=this.listeners[t];return e.isUndefined(i)&&(i=this.listeners[t]=[]),i.push(n),"destroy"!==t&&this.socket.on(t,n),this},t.prototype.off=function(t,n){var i=this.listeners[t];if(e.isUndefined(i))return this;if(e.isUndefined(n))delete this.listeners[t];else{var r=e.indexOf(i,n);if(-1===r)return this;i.splice(r,1),0===i.length&&delete this.listeners[t]}return"destroy"!==t&&this.socket.off(t,n),this},t.prototype.emit=function(){var e=Array.prototype.slice.call(arguments),t=e.length-1;return e[t]=this.wrapCallback(e[t]),this.socket.emit.apply(this.socket,e),this},t.prototype.send=function(e,t){return this.socket.send(e,this.wrapCallback(t)),this},t.prototype.wrapCallback=function(t){if(!e.isFunction(t))return t;var n=this;return function(){null!==n.socket&&t.apply(this,arguments)}},t}),define("app/core/Socket",["app/core/SocketSandbox"],function(e){"use strict";function t(e){this.sio=e}return t.prototype.sandbox=function(){return new e(this)},t.prototype.getId=function(){return this.sio.id||null},t.prototype.isConnected=function(){return"open"===this.sio.io.readyState},t.prototype.isConnecting=function(){return"opening"===this.sio.io.readyState},t.prototype.connect=function(){this.sio.open()},t.prototype.reconnect=function(){this.connect()},t.prototype.on=function(e,t){return this.sio.on(e,t),this},t.prototype.off=function(e,t){return void 0===t?this.sio.removeAllListeners(e):this.sio.off(e,t),this},t.prototype.emit=function(){return this.sio.json.emit.apply(this.sio.json,arguments),this},t.prototype.send=function(e,t){return this.sio.json.send(e,t),this},t}),define("app/socket",["underscore","socket.io","app/broker","app/core/Socket"],function(e,t,n,i){"use strict";var r={};window.ArrayBuffer&&window.Uint8Array&&(r.binary="1"),window.WMES_GET_COMMON_HEADERS&&Object.assign(r,window.WMES_GET_COMMON_HEADERS());var o=new i(t({path:"/sio",transports:["websocket"],timeout:1e4,reconnectionDelay:500,autoConnect:!1,query:r})),a=!1,s=!1;return o.on("connecting",function(){n.publish("socket.connecting",!1)}),o.on("connect",function(){a||(a=!0,n.publish("socket.connected",!1))}),o.on("connect_error",function(){a||n.publish("socket.connectFailed",!1)}),o.on("message",function(e){n.publish("socket.message",e)}),o.on("disconnect",function(){n.publish("socket.disconnected")}),o.on("reconnecting",function(){s=!0,n.publish("socket.connecting",!0)}),o.on("reconnect",function(){s=!1,n.publish("socket.connected",!0)}),o.on("reconnect_error",function(){s&&(s=!1,n.publish("socket.connectFailed",!0))}),o.on("error",function(){s&&n.publish("socket.connectFailed",!0)}),window.socket=o,o}),define("h5.rql/specialOperators",["require","exports","module"],function(e,t,n){"use strict";n.exports={eq:"=",ne:"=ne=",le:"=le=",ge:"=ge=",lt:"=lt=",gt:"=gt=",in:"=in=",nin:"=nin="}}),function(e){var t,n,i,r=String.fromCharCode;function o(e){for(var t,n,i=[],r=0,o=e.length;r<o;)(t=e.charCodeAt(r++))>=55296&&t<=56319&&r<o?56320==(64512&(n=e.charCodeAt(r++)))?i.push(((1023&t)<<10)+(1023&n)+65536):(i.push(t),r--):i.push(t);return i}function a(e){if(e>=55296&&e<=57343)throw Error("Lone surrogate U+"+e.toString(16).toUpperCase()+" is not a scalar value")}function s(e,t){return r(e>>t&63|128)}function u(e){if(0==(4294967168&e))return r(e);var t="";return 0==(4294965248&e)?t=r(e>>6&31|192):0==(4294901760&e)?(a(e),t=r(e>>12&15|224),t+=s(e,6)):0==(4292870144&e)&&(t=r(e>>18&7|240),t+=s(e,12),t+=s(e,6)),t+=r(63&e|128)}function c(){if(i>=n)throw Error("Invalid byte index");var e=255&t[i];if(i++,128==(192&e))return 63&e;throw Error("Invalid continuation byte")}function l(){var e,r;if(i>n)throw Error("Invalid byte index");if(i==n)return!1;if(e=255&t[i],i++,0==(128&e))return e;if(192==(224&e)){if((r=(31&e)<<6|c())>=128)return r;throw Error("Invalid continuation byte")}if(224==(240&e)){if((r=(15&e)<<12|c()<<6|c())>=2048)return a(r),r;throw Error("Invalid continuation byte")}if(240==(248&e)&&(r=(7&e)<<18|c()<<12|c()<<6|c())>=65536&&r<=1114111)return r;throw Error("Invalid UTF-8 detected")}e.version="3.0.0",e.encode=function(e){for(var t=o(e),n=t.length,i=-1,r="";++i<n;)r+=u(t[i]);return r},e.decode=function(e){t=o(e),n=t.length,i=0;for(var a,s=[];!1!==(a=l());)s.push(a);return function(e){for(var t,n=e.length,i=-1,o="";++i<n;)(t=e[i])>65535&&(o+=r((t-=65536)>>>10&1023|55296),t=56320|1023&t),o+=r(t);return o}(s)}}("undefined"==typeof exports?this.utf8={}:exports),define("utf8",function(e){return function(){return e.utf8}}(this)),define("app/pubsub",["underscore","utf8","h5.pubsub/MessageBroker","app/broker","app/socket"],function(e,t,n,i,r){"use strict";var o=new n,a={},s=[],u=null,c=null;function l(t,n,r){if(n)i.publish("pubsub.subscribeFailed",{err:n,topics:t});else{r.length>0&&i.publish("pubsub.subscribeNotAllowed",{topics:r});var o=e.difference(t,r);o.length>0&&i.publish("pubsub.subscribed",{topics:o})}}function d(){r.isConnected()&&r.emit("pubsub.subscribe",s,l.bind(null,s)),s=[],u=null}function p(){var e=Object.keys(a);r.isConnected()&&r.emit("pubsub.unsubscribe",e),a={},c=null,i.publish("pubsub.unsubscribed",{topics:e})}return o.on("new topic",function(e){void 0!==a[e]&&delete a[e],r.isConnected()&&(s.push(e),null===u&&(u=setTimeout(d,0)))}),o.on("empty topic",function(e){r.isConnected()&&(a[e]=!0,null===c&&(c=setTimeout(p,0)))}),o.on("message",function(e,t,n){!0!==n.remote&&r.emit("pubsub.publish",e,t,n,function(r){r?i.publish("pubsub.publishFailed",{err:r,topic:e,message:t,meta:n}):i.publish("pubsub.published",{topic:e,message:t,meta:n})})}),r.on("connect",function(){var e=Object.keys(o.count());e.length&&r.emit("pubsub.subscribe",e,l.bind(null,e))}),r.on("pubsub.message",function(e){try{e instanceof ArrayBuffer&&(e=t.decode(String.fromCharCode.apply(null,new Uint8Array(e)))),"string"==typeof e&&(e=JSON.parse(e)),e[2].remote=!0}catch(t){return console.error("[pubsub] Failed to parse remote message:",{message:e})}o.publish(e[0],e[1],e[2])}),window.pubsub=o,o}),define("app/core/util",["underscore"],function(e){"use strict";var t={inherits:function(t,n){e.assign(t,n);var i=function(){this.constructor=t};return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t},decodeUriComponent:function(e){return decodeURIComponent(e.replace(/\+/g," "))},defineSandboxedProperty:function(t,n,i){e.isObject(t._sandboxedProperties)||(t._sandboxedProperties={});var r=t._sandboxedProperties,o=t.options[n];if(e.isObject(o))return r[n]=o,t[n]=o,void delete t.options[n];r[n]=null,Object.defineProperty(t,n,{enumerable:!0,configurable:!0,get:function(){return null===r[n]&&(r[n]=i.sandbox()),r[n]},set:function(e){this[n]=e}})},cleanupSandboxedProperties:function(t){var n=t._sandboxedProperties;e.isObject(n)&&(Object.keys(n).forEach(function(t){var i=n[t];i&&e.isFunction(i.destroy)&&i.destroy()}),t._sandboxedProperties=null)},subscribeTopics:function(t,n,i,r){if(e.isFunction(i)&&(i=i.call(t)),e.isObject(i)&&e.size(i)){var o=t[n];e.each(i,function(n,i){e.isString(n)&&(n=t[n]),r&&(n=n.bind(t)),o.subscribe(i,n)})}},escapeRegExp:function(e,t){return e.replace(t?/([-[\]{}()*+!<=:?.\/\\^$|#\s,])/g:/([.*+?^=!:${}()|\[\]\/\\])/g,"\\$1")},unescapeRegExp:function(e,t){return e.replace(t?/\\([-[\]{}()*+!<=:?.\/\\^$|#\s,])/g:/\\([.*+?^=!:${}()|\[\]\/\\])/g,"$1")}};return t}),define("app/core/util/html",[],function(){"use strict";function e(e){var n="";return e?(Object.keys(e).forEach(function(i){var r=e[i];if(!1!==r){if("className"===i)i="class";else if("style"===i&&r&&"object"==typeof r){var o="";Object.keys(r).forEach(function(e){o+=e+":"+r[e]+";"}),r=o}else if("data"===i&&r&&"object"==typeof r)return void Object.keys(r).forEach(e=>{n+=" data-"+e+'="'+r[e]+'"'});n+=" "+i,null!=r&&!0!==r&&("class"===i&&"string"!=typeof r&&(r=t(r)),n+='="'+r+'"')}}),n):n}function t(){for(var e=[],t=0;t<arguments.length;++t){var n=arguments[t];n&&("string"==typeof n?e.push(n):Array.isArray(n)?e=e.concat(n):n&&Object.keys(n).forEach(function(t){n[t]&&e.push(t)}))}return e.join(" ")}return{tag:function(t,n,i){var r="<"+t+e(n)+">";return"string"==typeof i&&(r+=i+"</"+t+">"),r},attrs:e,className:t}}),define("app/core/util/forms/formGroup",["app/core/util/html"],function(e){"use strict";var t={select2:!0,static:!0};return function(n,i){if("string"==typeof i&&(i={name:i}),!1===i.visible||i.hidden)return"";!i.name&&i.id&&(i.name=i.id),i.type||(i.type="text");var r=n.idPrefix+"-"+(i.id||i.name.replace(/[\[\].]/g,"-")),o=Object.assign({className:e.className("form-group",i.groupClassName,i.required&&"select2"===i.type?"has-required-select2":null),style:i.groupStyle||!1},i.groupAttrs),a="",s="",u="input",c={id:r,name:i.name,type:"text",required:!0===i.required,disabled:!0===i.disabled,readonly:!0===i.readOnly,placeholder:i.placeholder||!1,style:i.inputStyle||!1},l="",d=[i.noFormControl||t[i.type]?"":"form-control"],p=i.label;if(!1!==p){/:$/.test(p)&&(p+=i.name);var f=p||i.name;n.t.has(f)&&(f=n.t(f));var h=[i.noControlLabel?"":"control-label"];i.required&&h.push("is-required");var m=Object.assign({for:r,className:e.className(h,i.labelClassName),style:i.labelStyle||!1},i.labelAttrs);a=e.tag("label",m,f)}if(i.helpBlock){var g=!0===i.helpBlock?p||i.name:i.helpBlock;n.t.has(g+":help")?g=n.t(g+":help"):n.t.has(g)&&(g=n.t(g));var v=Object.assign({className:e.className("help-block",i.helpBlockClassName),style:i.helpBlockStyle||!1},i.helpBlockAttrs);s=e.tag("span",v,g)}switch(i.type){case"number":case"date":case"month":c.type=i.type,c.min=null!=i.min&&i.min,c.max=null!=i.max&&i.max,c.step=null!=i.step&&i.step,c.value=i.value;break;case"textarea":u="textarea",c.type=!1,c.rows=null!=i.rows&&i.rows,c.cols=null!=i.cols&&i.cols,l=null==i.value?"":String(i.value);break;case"static":u="p",c.type=!1,c.name=!1,c.required=!1,c.disabled=!1,c.readonly=!1,l=null==i.value?"":String(i.value),d.push("form-control-static");break;case"text":c.pattern=i.pattern||!1,c.maxlength=i.maxLength>0&&i.maxLength;break;case"file":c.type=i.type,c.multiple=!0===i.multiple,c.accept=i.accept||!1;break;case"select":u="select",c.type=!1,c.multiple=!0===i.multiple,c.size=i.size||1,i.expandable&&(c.multiple=!0,/]$/.test(c.name)||(c.name+="[]"),d.push("is-expandable")),i.emptyOption&&(l=e.tag("option")),i.options.forEach(function(t){l+=e.tag("option",Object.assign({},t,{label:!1}),t.label)})}return c.className=e.className(d,i.inputClassName),Object.assign(c,i.inputAttrs),e.tag("div",o,a+s+e.tag(u,c,l))}}),define("app/core/View",["underscore","jquery","backbone","backbone.layout","app/broker","app/socket","app/pubsub","app/i18n","./util","./util/html","./util/forms/formGroup"],function(e,t,n,i,r,o,a,s,u,c,l){"use strict";function d(t){var n=this;n.idPrefix=e.uniqueId("v"),n.options=e.assign({},n.options,t),n.timers={},n.promises=[],e.forEach(n.sections,function(e,t){n.sections[t]="string"!=typeof e||"#"===e?"#"+n.idPrefix+"-"+t:e.replace("#-","#"+n.idPrefix+"-")}),u.defineSandboxedProperty(n,"broker",r),u.defineSandboxedProperty(n,"pubsub",a),u.defineSandboxedProperty(n,"socket",o),Object.defineProperty(n,"t",{enumerable:!0,configurable:!0,get:function(){return delete n.t,n.t=s.forDomain(n.getDefaultNlsDomain()),n.t}}),i.call(n,n.options),u.subscribeTopics(n,"broker",n.localTopics,!0),n.remoteTopicsAfterSync?(!0===n.remoteTopicsAfterSync&&(n.remoteTopicsAfterSync="model"),"string"==typeof n.remoteTopicsAfterSync&&n[n.remoteTopicsAfterSync]&&n.listenToOnce(n[n.remoteTopicsAfterSync],"sync",u.subscribeTopics.bind(u,n,"pubsub",n.remoteTopics,!0))):u.subscribeTopics(n,"pubsub",n.remoteTopics,!0)}return u.inherits(d,i),d.prototype.delegateEvents=function(t){if(t||(t=e.result(this,"events")),!t)return this;this.undelegateEvents(),Object.keys(t).forEach(function(n){var i=t[n];if(e.isFunction(i)||(i=this[i]),e.isFunction(i)){var r=n.match(/^(\S+)\s*(.*)$/),o=r[1]+".delegateEvents"+this.cid,a=r[2];""===a?this.$el.on(o,i.bind(this)):(e.isString(this.idPrefix)&&(a=a.replace(/#-/g,"#"+this.idPrefix+"-")),this.$el.on(o,a,i.bind(this)))}},this)},d.prototype.listenTo=function(e){if(e)return i.prototype.listenTo.apply(this,arguments)},d.prototype.listenToOnce=function(e){if(e)return i.prototype.listenToOnce.apply(this,arguments)},d.prototype.getViews=function(e){return"string"==typeof e&&/^#-/.test(e)&&(e=e.replace("#-","#"+this.idPrefix+"-")),i.prototype.getViews.call(this,e)},d.prototype.setView=function(e,t,r,o){return"string"==typeof e&&/^#-/.test(e)&&(e=e.replace("#-","#"+this.idPrefix+"-")),e instanceof n.View||t instanceof n.View?i.prototype.setView.call(this,e,t,r,o):null},d.prototype.cleanup=function(){this.destroy(),this.cleanupSelect2(),this.cleanupPopovers(),u.cleanupSandboxedProperties(this),e.isObject(this.timers)&&(e.forEach(this.timers,clearTimeout),this.timers={}),this.cancelRequests()},d.prototype.destroy=function(){},d.prototype.cleanupSelect2=function(){var e=this;e.$(".select2-container").each(function(){e.$("#"+this.id.replace("s2id_","")).select2("destroy")})},d.prototype.cleanupPopovers=function(){var e=this;e.$("[aria-describedby]").each(function(){var t=this.getAttribute("aria-describedby");/^popover/.test(t)?e.$(this).popover("destroy"):/^tooltip/.test(t)&&e.$(this).tooltip("destroy")})},d.prototype.beforeRender=function(){},d.prototype.serialize=function(){return e.assign(this.getCommonTemplateData(),this.getTemplateData())},d.prototype.getCommonTemplateData=function(){var e=this.getTemplateHelpers();return{idPrefix:this.idPrefix,helpers:e,t:e.t,id:e.id,cn:e.cn}},d.prototype.getTemplateData=function(){return{}},d.prototype.getTemplateHelpers=function(){var e=this.idPrefix,t=this.classPrefix;return{t:this.t,id:function(){return e+"-"+Array.prototype.slice.call(arguments).join("-")},cn:function(){return(t?t+"-":"")+Array.prototype.slice.call(arguments).join("-")},props:this.props.bind(this),formGroup:l.bind(null,this)}},d.prototype.renderPartial=function(e,n){return t(this.renderPartialHtml(e,n))},d.prototype.renderPartialHtml=function(t,n){return t(e.assign(this.getCommonTemplateData(),n))},d.prototype.afterRender=function(){},d.prototype.isRendered=function(){return!0===this.hasRendered},d.prototype.isDetached=function(){return!t.contains(document.documentElement,this.el)},d.prototype.ajax=function(e){return this.promised(t.ajax(e))},d.prototype.promised=function(t){if(!t||!e.isFunction(t.abort))return t;this.promises.push(t);var n=this;return t.always(function(){Array.isArray(n.promises)&&n.promises.splice(n.promises.indexOf(t),1)}),t},d.prototype.cancelRequests=function(){this.promises.forEach(function(e){e.abort()}),this.promises=[]},d.prototype.cancelAnimations=function(e,t){this.$el.stop(!1!==e,!1!==t),this.$(":animated").stop(!1!==e,!1!==t)},d.prototype.$id=function(n){var i="#";e.isString(this.idPrefix)&&(i+=this.idPrefix+"-"),i+=n;var r=this.$el.find(i);return r.length?r:t(i)},d.prototype.getDefaultModel=function(){return this[this.modelProperty]||this.model||this.collection},d.prototype.getDefaultNlsDomain=function(){if(this.nlsDomain)return e.result(this,"nlsDomain");var t=this.getDefaultModel();if(t){if(t.getNlsDomain)return t.getNlsDomain();if(t.nlsDomain)return t.nlsDomain}return"core"},d.prototype.props=function(t,n){var i=this;n||(t=(n=t).data);var r='<div class="props '+(n.first?"first":"")+'">',o=i.getDefaultNlsDomain();return[].concat(e.isArray(n)?n:n.props).forEach(function(a){"string"==typeof a&&(a={id:a});var u=!1!==a.escape&&"!"!==a.id.charAt(0),l=u?a.id:a.id.substring(1),d=a.nlsDomain||n.nlsDomain||o,p=a.label||s(d,"PROPERTY:"+l),f=e.isFunction(a.value)?a.value(t[l],a,i):e.isUndefined(a.value)?t[l]:a.value;if((!e.isFunction(a.visible)||a.visible(f,a,i))&&(null==a.visible||a.visible)){var h=Object.assign({"data-prop":l},a.attrs,{className:{prop:!0}});[a.className,a.attrs&&a.attrs.className].forEach(function(e){"string"==typeof e&&e.length&&(e=e.split(" ")),Array.isArray(e)?e.forEach(function(e){h.className[e]=!0}):e&&"object"==typeof e&&Object.assign(h.className,e)});var m=Object.assign({},a.nameAttrs,{className:{"prop-name":!0}});[a.nameClassName,a.nameAttrs&&a.nameAttrs.className].forEach(function(e){"string"==typeof e&&e.length&&(e=e.split(" ")),Array.isArray(e)?e.forEach(function(e){m.className[e]=!0}):e&&"object"==typeof e&&Object.assign(m.className,e)});var g=Object.assign({},a.valueAttrs,{className:{"prop-value":!0}});[a.valueClassName,a.valueAttrs&&a.valueAttrs.className].forEach(function(e){"string"==typeof e&&e.length&&(e=e.split(" ")),Array.isArray(e)?e.forEach(function(e){g.className[e]=!0}):e&&"object"==typeof e&&Object.assign(g.className,e)}),"string"!=typeof f&&(f=null==f?"":String(f)),u&&(f=e.escape(f));var v=c.tag("div",m,p),y=c.tag("div",g,f);r+=c.tag("div",h,v+y)}}),r+"</div>"},d}),function(e,t){"use strict";"object"==typeof module&&module.exports?module.exports=t(require("moment")):"function"==typeof define&&define.amd?define("moment-timezone",["moment"],t):t(e.moment)}(this,function(e){"use strict";void 0===e.version&&e.default&&(e=e.default);var t,n={},i={},r={},o={},a={};e&&"string"==typeof e.version||N("Moment Timezone requires Moment.js. See https://momentjs.com/timezone/docs/#/use-it/browser/");var s=e.version.split("."),u=+s[0],c=+s[1];function l(e){return e>96?e-87:e>64?e-29:e-48}function d(e){var t=0,n=e.split("."),i=n[0],r=n[1]||"",o=1,a=0,s=1;for(45===e.charCodeAt(0)&&(t=1,s=-1);t<i.length;t++)a=60*a+l(i.charCodeAt(t));for(t=0;t<r.length;t++)o/=60,a+=l(r.charCodeAt(t))*o;return a*s}function p(e){for(var t=0;t<e.length;t++)e[t]=d(e[t])}function f(e,t){var n,i=[];for(n=0;n<t.length;n++)i[n]=e[t[n]];return i}function h(e){var t=e.split("|"),n=t[2].split(" "),i=t[3].split(""),r=t[4].split(" ");return p(n),p(i),p(r),function(e,t){for(var n=0;n<t;n++)e[n]=Math.round((e[n-1]||0)+6e4*e[n]);e[t-1]=1/0}(r,i.length),{name:t[0],abbrs:f(t[1].split(" "),i),offsets:f(n,i),untils:r,population:0|t[5]}}function m(e){e&&this._set(h(e))}function g(e,t){this.name=e,this.zones=t}function v(e){var t=e.toTimeString(),n=t.match(/\([a-z ]+\)/i);"GMT"===(n=n&&n[0]?(n=n[0].match(/[A-Z]/g))?n.join(""):void 0:(n=t.match(/[A-Z]{3,5}/g))?n[0]:void 0)&&(n=void 0),this.at=+e,this.abbr=n,this.offset=e.getTimezoneOffset()}function y(e){this.zone=e,this.offsetScore=0,this.abbrScore=0}function _(e,t){for(var n,i;i=6e4*((t.at-e.at)/12e4|0);)(n=new v(new Date(e.at+i))).offset===e.offset?e=n:t=n;return e}function b(e,t){return e.offsetScore!==t.offsetScore?e.offsetScore-t.offsetScore:e.abbrScore!==t.abbrScore?e.abbrScore-t.abbrScore:e.zone.population!==t.zone.population?t.zone.population-e.zone.population:t.zone.name.localeCompare(e.zone.name)}function w(e,t){var n,i;for(p(t),n=0;n<t.length;n++)i=t[n],a[i]=a[i]||{},a[i][e]=!0}function A(e){var t,n,i,r=e.length,s={},u=[];for(t=0;t<r;t++)for(n in i=a[e[t].offset]||{})i.hasOwnProperty(n)&&(s[n]=!0);for(t in s)s.hasOwnProperty(t)&&u.push(o[t]);return u}function k(){try{var e=Intl.DateTimeFormat().resolvedOptions().timeZone;if(e&&e.length>3){var t=o[E(e)];if(t)return t;N("Moment Timezone found "+e+" from the Intl api, but did not have that data loaded.")}}catch(e){}var n,i,r,a=function(){var e,t,n,i=(new Date).getFullYear()-2,r=new v(new Date(i,0,1)),o=[r];for(n=1;n<48;n++)(t=new v(new Date(i,n,1))).offset!==r.offset&&(e=_(r,t),o.push(e),o.push(new v(new Date(e.at+6e4)))),r=t;for(n=0;n<4;n++)o.push(new v(new Date(i+n,0,1))),o.push(new v(new Date(i+n,6,1)));return o}(),s=a.length,u=A(a),c=[];for(i=0;i<u.length;i++){for(n=new y(S(u[i]),s),r=0;r<s;r++)n.scoreOffsetAt(a[r]);c.push(n)}return c.sort(b),c.length>0?c[0].zone.name:void 0}function E(e){return(e||"").toLowerCase().replace(/\//g,"_")}function T(e){var t,i,r,a;for("string"==typeof e&&(e=[e]),t=0;t<e.length;t++)a=E(i=(r=e[t].split("|"))[0]),n[a]=e[t],o[a]=i,w(a,r[2].split(" "))}function S(e,t){e=E(e);var r,a=n[e];return a instanceof m?a:"string"==typeof a?(a=new m(a),n[e]=a,a):i[e]&&t!==S&&(r=S(i[e],S))?((a=n[e]=new m)._set(r),a.name=o[e],a):null}function C(e){var t,n,r,a;for("string"==typeof e&&(e=[e]),t=0;t<e.length;t++)r=E((n=e[t].split("|"))[0]),a=E(n[1]),i[r]=a,o[r]=n[0],i[a]=r,o[a]=n[1]}function R(e){T(e.zones),C(e.links),function(e){var t,n,i,o;if(e&&e.length)for(t=0;t<e.length;t++)n=(o=e[t].split("|"))[0].toUpperCase(),i=o[1].split(" "),r[n]=new g(n,i)}(e.countries),O.dataVersion=e.version}function P(e){var t="X"===e._f||"x"===e._f;return!(!e._a||void 0!==e._tzm||t)}function N(e){"undefined"!=typeof console&&"function"==typeof console.error&&console.error(e)}function O(t){var n=Array.prototype.slice.call(arguments,0,-1),i=arguments[arguments.length-1],r=S(i),o=e.utc.apply(null,n);return r&&!e.isMoment(t)&&P(o)&&o.add(r.parse(o),"minutes"),o.tz(i),o}(u<2||2===u&&c<6)&&N("Moment Timezone requires Moment.js >= 2.6.0. You are using Moment.js "+e.version+". See momentjs.com"),m.prototype={_set:function(e){this.name=e.name,this.abbrs=e.abbrs,this.untils=e.untils,this.offsets=e.offsets,this.population=e.population},_index:function(e){var t,n=+e,i=this.untils;for(t=0;t<i.length;t++)if(n<i[t])return t},countries:function(){var e=this.name;return Object.keys(r).filter(function(t){return-1!==r[t].zones.indexOf(e)})},parse:function(e){var t,n,i,r,o=+e,a=this.offsets,s=this.untils,u=s.length-1;for(r=0;r<u;r++)if(t=a[r],n=a[r+1],i=a[r?r-1:r],t<n&&O.moveAmbiguousForward?t=n:t>i&&O.moveInvalidForward&&(t=i),o<s[r]-6e4*t)return a[r];return a[u]},abbr:function(e){return this.abbrs[this._index(e)]},offset:function(e){return N("zone.offset has been deprecated in favor of zone.utcOffset"),this.offsets[this._index(e)]},utcOffset:function(e){return this.offsets[this._index(e)]}},y.prototype.scoreOffsetAt=function(e){this.offsetScore+=Math.abs(this.zone.utcOffset(e.at)-e.offset),this.zone.abbr(e.at).replace(/[^A-Z]/g,"")!==e.abbr&&this.abbrScore++},O.version="0.5.33",O.dataVersion="",O._zones=n,O._links=i,O._names=o,O._countries=r,O.add=T,O.link=C,O.load=R,O.zone=S,O.zoneExists=function e(t){return e.didShowError||(e.didShowError=!0,N("moment.tz.zoneExists('"+t+"') has been deprecated in favor of !moment.tz.zone('"+t+"')")),!!S(t)},O.guess=function(e){return t&&!e||(t=k()),t},O.names=function(){var e,t=[];for(e in o)o.hasOwnProperty(e)&&(n[e]||n[i[e]])&&o[e]&&t.push(o[e]);return t.sort()},O.Zone=m,O.unpack=h,O.unpackBase60=d,O.needsOffset=P,O.moveInvalidForward=!0,O.moveAmbiguousForward=!1,O.countries=function(){return Object.keys(r)},O.zonesForCountry=function(e,t){var n;if(n=(n=e).toUpperCase(),!(e=r[n]||null))return null;var i=e.zones.sort();return t?i.map(function(e){return{name:e,offset:S(e).utcOffset(new Date)}}):i};var D,I=e.fn;function z(e){return function(){return this._z?this._z.abbr(this):e.call(this)}}function x(e){return function(){return this._z=null,e.apply(this,arguments)}}e.tz=O,e.defaultZone=null,e.updateOffset=function(t,n){var i,r=e.defaultZone;if(void 0===t._z&&(r&&P(t)&&!t._isUTC&&(t._d=e.utc(t._a)._d,t.utc().add(r.parse(t),"minutes")),t._z=r),t._z)if(i=t._z.utcOffset(t),Math.abs(i)<16&&(i/=60),void 0!==t.utcOffset){var o=t._z;t.utcOffset(-i,n),t._z=o}else t.zone(i,n)},I.tz=function(t,n){if(t){if("string"!=typeof t)throw new Error("Time zone name must be a string, got "+t+" ["+typeof t+"]");return this._z=S(t),this._z?e.updateOffset(this,n):N("Moment Timezone has no data for "+t+". See http://momentjs.com/timezone/docs/#/data-loading/."),this}if(this._z)return this._z.name},I.zoneName=z(I.zoneName),I.zoneAbbr=z(I.zoneAbbr),I.utc=x(I.utc),I.local=x(I.local),I.utcOffset=(D=I.utcOffset,function(){return arguments.length>0&&(this._z=null),D.apply(this,arguments)}),e.tz.setDefault=function(t){return(u<2||2===u&&c<9)&&N("Moment Timezone setDefault() requires Moment.js >= 2.9.0. You are using Moment.js "+e.version+"."),e.defaultZone=t?S(t):null,e};var L=e.momentProperties;return"[object Array]"===Object.prototype.toString.call(L)?(L.push("_z"),L.push("_a")):L&&(L._z=null),R({version:"2021a",zones:["Africa/Abidjan|GMT|0|0||48e5","Africa/Nairobi|EAT|-30|0||47e5","Africa/Algiers|CET|-10|0||26e5","Africa/Lagos|WAT|-10|0||17e6","Africa/Maputo|CAT|-20|0||26e5","Africa/Cairo|EET|-20|0||15e6","Africa/Casablanca|+00 +01|0 -10|0101010101010101010101010101|1QyO0 s00 e00 IM0 WM0 mo0 gM0 LA0 WM0 jA0 e00 28M0 e00 2600 gM0 2600 e00 2600 gM0 2600 gM0 2600 e00 2600 gM0 2600 e00|32e5","Europe/Paris|CET CEST|-10 -20|01010101010101010101010|1QyN0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00|11e6","Africa/Johannesburg|SAST|-20|0||84e5","Africa/Juba|EAT CAT|-30 -20|01|24nx0|","Africa/Khartoum|EAT CAT|-30 -20|01|1Usl0|51e5","Africa/Sao_Tome|GMT WAT|0 -10|010|1UQN0 2q00|","Africa/Windhoek|CAT WAT|-20 -10|01010|1QBA0 11B0 1nX0 11B0|32e4","America/Adak|HST HDT|a0 90|01010101010101010101010|1Qto0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|326","America/Anchorage|AKST AKDT|90 80|01010101010101010101010|1Qtn0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|30e4","America/Santo_Domingo|AST|40|0||29e5","America/Fortaleza|-03|30|0||34e5","America/Asuncion|-03 -04|30 40|01010101010101010101010|1QyP0 1fB0 19X0 1fB0 19X0 1ip0 17b0 1ip0 17b0 1ip0 19X0 1fB0 19X0 1fB0 19X0 1fB0 19X0 1ip0 17b0 1ip0 17b0 1ip0|28e5","America/Panama|EST|50|0||15e5","America/Mexico_City|CST CDT|60 50|01010101010101010101010|1QBI0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0|20e6","America/Managua|CST|60|0||22e5","America/La_Paz|-04|40|0||19e5","America/Lima|-05|50|0||11e6","America/Denver|MST MDT|70 60|01010101010101010101010|1Qtl0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|26e5","America/Campo_Grande|-03 -04|30 40|01010101|1QkP0 1zd0 On0 1zd0 On0 1HB0 FX0|77e4","America/Caracas|-0430 -04|4u 40|01|1QMT0|29e5","America/Chicago|CST CDT|60 50|01010101010101010101010|1Qtk0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|92e5","America/Chihuahua|MST MDT|70 60|01010101010101010101010|1QBJ0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0|81e4","America/Phoenix|MST|70|0||42e5","America/Whitehorse|PST PDT MST|80 70 70|01010101012|1Qtm0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1z90|23e3","America/New_York|EST EDT|50 40|01010101010101010101010|1Qtj0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|21e6","America/Los_Angeles|PST PDT|80 70|01010101010101010101010|1Qtm0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|15e6","America/Halifax|AST ADT|40 30|01010101010101010101010|1Qti0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|39e4","America/Godthab|-03 -02|30 20|01010101010101010101010|1QyN0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00|17e3","America/Grand_Turk|AST EDT EST|40 40 50|0121212121212121212|1Vkv0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|37e2","America/Havana|CST CDT|50 40|01010101010101010101010|1Qth0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Rc0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0|21e5","America/Metlakatla|AKST AKDT PST|90 80 80|010101201010101010101010|1Qtn0 1zb0 Op0 1zb0 Op0 1zb0 uM0 jB0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|14e2","America/Miquelon|-03 -02|30 20|01010101010101010101010|1Qth0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|61e2","America/Noronha|-02|20|0||30e2","America/Port-au-Prince|EST EDT|50 40|010101010101010101010|1SST0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|23e5","Antarctica/Palmer|-03 -04|30 40|010|1QSr0 Ap0|40","America/Santiago|-03 -04|30 40|01010101010101010101010|1QSr0 Ap0 1Nb0 Ap0 1Nb0 Ap0 1zb0 11B0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1qL0 11B0 1nX0 11B0 1nX0 11B0|62e5","America/Sao_Paulo|-02 -03|20 30|01010101|1QkO0 1zd0 On0 1zd0 On0 1HB0 FX0|20e6","Atlantic/Azores|-01 +00|10 0|01010101010101010101010|1QyN0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00|25e4","America/St_Johns|NST NDT|3u 2u|01010101010101010101010|1Qthu 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0|11e4","Antarctica/Casey|+08 +11|-80 -b0|01010101|1RWg0 3m10 1o30 14k0 1kr0 12l0 1o01|10","Asia/Bangkok|+07|-70|0||15e6","Asia/Vladivostok|+10|-a0|0||60e4","Australia/Sydney|AEDT AEST|-b0 -a0|01010101010101010101010|1QBs0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0|40e5","Asia/Tashkent|+05|-50|0||23e5","Pacific/Auckland|NZDT NZST|-d0 -c0|01010101010101010101010|1QBq0 1a00 1fA0 1a00 1fA0 1cM0 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1io0 1a00 1fA0 1a00 1fA0 1a00|14e5","Asia/Baghdad|+03|-30|0||66e5","Antarctica/Troll|+00 +02|0 -20|01010101010101010101010|1QyN0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00|40","Asia/Dhaka|+06|-60|0||16e6","Asia/Amman|EET EEST|-20 -30|01010101010101010101010|1QAK0 1o00 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0|25e5","Asia/Kamchatka|+12|-c0|0||18e4","Asia/Dubai|+04|-40|0||39e5","Asia/Barnaul|+06 +07|-60 -70|01|1QyI0|","Asia/Beirut|EET EEST|-20 -30|01010101010101010101010|1QyK0 1qL0 WN0 1qL0 WN0 1qL0 11B0 1nX0 11B0 1nX0 11B0 1qL0 WN0 1qL0 WN0 1qL0 11B0 1nX0 11B0 1nX0 11B0 1nX0|22e5","Asia/Kuala_Lumpur|+08|-80|0||71e5","Asia/Kolkata|IST|-5u|0||15e6","Asia/Chita|+08 +09|-80 -90|01|1QyG0|33e4","Asia/Ulaanbaatar|+08 +09|-80 -90|010|1Qyi0 1cJ0|12e5","Asia/Shanghai|CST|-80|0||23e6","Asia/Colombo|+0530|-5u|0||22e5","Asia/Damascus|EET EEST|-20 -30|01010101010101010101010|1QxW0 1qL0 11B0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1qL0 WN0 1qL0 WN0 1qL0 11B0 1nX0 11B0 1nX0 11B0 1qL0 WN0 1qL0|26e5","Asia/Yakutsk|+09|-90|0||28e4","Asia/Famagusta|EET EEST +03|-20 -30 -30|0120101010101010101010|1QyN0 15U0 2Ks0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00|","Asia/Gaza|EET EEST|-20 -30|01010101010101010101010|1Qyn0 1qL0 WN0 1qL0 WN0 1qL0 11c0 1on0 11B0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00|18e5","Asia/Hong_Kong|HKT|-80|0||73e5","Asia/Hovd|+07 +08|-70 -80|010|1Qyj0 1cJ0|81e3","Europe/Istanbul|EET EEST +03|-20 -30 -30|012|1QyN0 15w0|13e6","Asia/Jakarta|WIB|-70|0||31e6","Asia/Jayapura|WIT|-90|0||26e4","Asia/Jerusalem|IST IDT|-20 -30|01010101010101010101010|1Qy00 1rz0 W10 1rz0 W10 1rz0 10N0 1oL0 10N0 1oL0 10N0 1rz0 W10 1rz0 W10 1rz0 10N0 1oL0 10N0 1oL0 10N0 1oL0|81e4","Asia/Kabul|+0430|-4u|0||46e5","Asia/Karachi|PKT|-50|0||24e6","Asia/Kathmandu|+0545|-5J|0||12e5","Asia/Magadan|+10 +11|-a0 -b0|01|1QJQ0|95e3","Asia/Makassar|WITA|-80|0||15e5","Asia/Manila|PST|-80|0||24e6","Europe/Athens|EET EEST|-20 -30|01010101010101010101010|1QyN0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00|35e5","Asia/Novosibirsk|+06 +07|-60 -70|01|1Rmk0|15e5","Asia/Pyongyang|KST KST|-8u -90|01|1VGf0|29e5","Asia/Qyzylorda|+06 +05|-60 -50|01|1Xei0|73e4","Asia/Rangoon|+0630|-6u|0||48e5","Asia/Sakhalin|+10 +11|-a0 -b0|01|1QyE0|58e4","Asia/Seoul|KST|-90|0||23e6","Pacific/Bougainville|+11|-b0|0||18e4","Asia/Tehran|+0330 +0430|-3u -4u|01010101010101010101010|1Qwku 1dz0 1cN0 1dz0 1cp0 1dz0 1cp0 1dz0 1cp0 1dz0 1cN0 1dz0 1cp0 1dz0 1cp0 1dz0 1cp0 1dz0 1cN0 1dz0 1cp0 1dz0|14e6","Asia/Tokyo|JST|-90|0||38e6","Asia/Tomsk|+06 +07|-60 -70|01|1QXU0|10e5","Europe/Lisbon|WET WEST|0 -10|01010101010101010101010|1QyN0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00|27e5","Atlantic/Cape_Verde|-01|10|0||50e4","Australia/Adelaide|ACDT ACST|-au -9u|01010101010101010101010|1QBsu 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0|11e5","Australia/Brisbane|AEST|-a0|0||20e5","Australia/Darwin|ACST|-9u|0||12e4","Australia/Eucla|+0845|-8J|0||368","Australia/Lord_Howe|+11 +1030|-b0 -au|01010101010101010101010|1QBr0 1cMu 1cLu 1cMu 1cLu 1fAu 1cLu 1cMu 1cLu 1cMu 1cLu 1cMu 1cLu 1cMu 1cLu 1cMu 1fzu 1cMu 1cLu 1cMu 1cLu 1cMu|347","Australia/Perth|AWST|-80|0||18e5","Pacific/Easter|-05 -06|50 60|01010101010101010101010|1QSr0 Ap0 1Nb0 Ap0 1Nb0 Ap0 1zb0 11B0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1qL0 11B0 1nX0 11B0 1nX0 11B0|30e2","Europe/Dublin|GMT IST|0 -10|01010101010101010101010|1QyN0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00|12e5","Etc/GMT-1|+01|-10|0||","Pacific/Fakaofo|+13|-d0|0||483","Pacific/Kiritimati|+14|-e0|0||51e2","Etc/GMT-2|+02|-20|0||","Pacific/Tahiti|-10|a0|0||18e4","Pacific/Niue|-11|b0|0||12e2","Etc/GMT+12|-12|c0|0||","Pacific/Galapagos|-06|60|0||25e3","Etc/GMT+7|-07|70|0||","Pacific/Pitcairn|-08|80|0||56","Pacific/Gambier|-09|90|0||125","Etc/UTC|UTC|0|0||","Europe/Ulyanovsk|+03 +04|-30 -40|01|1QyL0|13e5","Europe/London|GMT BST|0 -10|01010101010101010101010|1QyN0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00|10e6","Europe/Chisinau|EET EEST|-20 -30|01010101010101010101010|1QyM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00|67e4","Europe/Moscow|MSK|-30|0||16e6","Europe/Saratov|+03 +04|-30 -40|01|1Sfz0|","Europe/Volgograd|+03 +04|-30 -40|010|1WQL0 5gn0|10e5","Pacific/Honolulu|HST|a0|0||37e4","MET|MET MEST|-10 -20|01010101010101010101010|1QyN0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00|","Pacific/Chatham|+1345 +1245|-dJ -cJ|01010101010101010101010|1QBq0 1a00 1fA0 1a00 1fA0 1cM0 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1io0 1a00 1fA0 1a00 1fA0 1a00|600","Pacific/Apia|+14 +13|-e0 -d0|01010101010101010101010|1QBq0 1a00 1fA0 1a00 1fA0 1cM0 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1io0 1a00 1fA0 1a00 1fA0 1a00|37e3","Pacific/Fiji|+13 +12|-d0 -c0|01010101010101010101010|1Q6C0 1VA0 s00 1VA0 s00 1VA0 s00 20o0 pc0 2hc0 bc0 20o0 pc0 20o0 pc0 20o0 pc0 20o0 pc0 20o0 s00 1VA0|88e4","Pacific/Guam|ChST|-a0|0||17e4","Pacific/Marquesas|-0930|9u|0||86e2","Pacific/Pago_Pago|SST|b0|0||37e2","Pacific/Norfolk|+11 +12|-b0 -c0|0101010101010101|219P0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0|25e4","Pacific/Tongatapu|+13 +14|-d0 -e0|010|1S4d0 s00|75e3"],links:["Africa/Abidjan|Africa/Accra","Africa/Abidjan|Africa/Bamako","Africa/Abidjan|Africa/Banjul","Africa/Abidjan|Africa/Bissau","Africa/Abidjan|Africa/Conakry","Africa/Abidjan|Africa/Dakar","Africa/Abidjan|Africa/Freetown","Africa/Abidjan|Africa/Lome","Africa/Abidjan|Africa/Monrovia","Africa/Abidjan|Africa/Nouakchott","Africa/Abidjan|Africa/Ouagadougou","Africa/Abidjan|Africa/Timbuktu","Africa/Abidjan|America/Danmarkshavn","Africa/Abidjan|Atlantic/Reykjavik","Africa/Abidjan|Atlantic/St_Helena","Africa/Abidjan|Etc/GMT","Africa/Abidjan|Etc/GMT+0","Africa/Abidjan|Etc/GMT-0","Africa/Abidjan|Etc/GMT0","Africa/Abidjan|Etc/Greenwich","Africa/Abidjan|GMT","Africa/Abidjan|GMT+0","Africa/Abidjan|GMT-0","Africa/Abidjan|GMT0","Africa/Abidjan|Greenwich","Africa/Abidjan|Iceland","Africa/Algiers|Africa/Tunis","Africa/Cairo|Africa/Tripoli","Africa/Cairo|Egypt","Africa/Cairo|Europe/Kaliningrad","Africa/Cairo|Libya","Africa/Casablanca|Africa/El_Aaiun","Africa/Johannesburg|Africa/Maseru","Africa/Johannesburg|Africa/Mbabane","Africa/Lagos|Africa/Bangui","Africa/Lagos|Africa/Brazzaville","Africa/Lagos|Africa/Douala","Africa/Lagos|Africa/Kinshasa","Africa/Lagos|Africa/Libreville","Africa/Lagos|Africa/Luanda","Africa/Lagos|Africa/Malabo","Africa/Lagos|Africa/Ndjamena","Africa/Lagos|Africa/Niamey","Africa/Lagos|Africa/Porto-Novo","Africa/Maputo|Africa/Blantyre","Africa/Maputo|Africa/Bujumbura","Africa/Maputo|Africa/Gaborone","Africa/Maputo|Africa/Harare","Africa/Maputo|Africa/Kigali","Africa/Maputo|Africa/Lubumbashi","Africa/Maputo|Africa/Lusaka","Africa/Nairobi|Africa/Addis_Ababa","Africa/Nairobi|Africa/Asmara","Africa/Nairobi|Africa/Asmera","Africa/Nairobi|Africa/Dar_es_Salaam","Africa/Nairobi|Africa/Djibouti","Africa/Nairobi|Africa/Kampala","Africa/Nairobi|Africa/Mogadishu","Africa/Nairobi|Indian/Antananarivo","Africa/Nairobi|Indian/Comoro","Africa/Nairobi|Indian/Mayotte","America/Adak|America/Atka","America/Adak|US/Aleutian","America/Anchorage|America/Juneau","America/Anchorage|America/Nome","America/Anchorage|America/Sitka","America/Anchorage|America/Yakutat","America/Anchorage|US/Alaska","America/Campo_Grande|America/Cuiaba","America/Chicago|America/Indiana/Knox","America/Chicago|America/Indiana/Tell_City","America/Chicago|America/Knox_IN","America/Chicago|America/Matamoros","America/Chicago|America/Menominee","America/Chicago|America/North_Dakota/Beulah","America/Chicago|America/North_Dakota/Center","America/Chicago|America/North_Dakota/New_Salem","America/Chicago|America/Rainy_River","America/Chicago|America/Rankin_Inlet","America/Chicago|America/Resolute","America/Chicago|America/Winnipeg","America/Chicago|CST6CDT","America/Chicago|Canada/Central","America/Chicago|US/Central","America/Chicago|US/Indiana-Starke","America/Chihuahua|America/Mazatlan","America/Chihuahua|Mexico/BajaSur","America/Denver|America/Boise","America/Denver|America/Cambridge_Bay","America/Denver|America/Edmonton","America/Denver|America/Inuvik","America/Denver|America/Ojinaga","America/Denver|America/Shiprock","America/Denver|America/Yellowknife","America/Denver|Canada/Mountain","America/Denver|MST7MDT","America/Denver|Navajo","America/Denver|US/Mountain","America/Fortaleza|America/Araguaina","America/Fortaleza|America/Argentina/Buenos_Aires","America/Fortaleza|America/Argentina/Catamarca","America/Fortaleza|America/Argentina/ComodRivadavia","America/Fortaleza|America/Argentina/Cordoba","America/Fortaleza|America/Argentina/Jujuy","America/Fortaleza|America/Argentina/La_Rioja","America/Fortaleza|America/Argentina/Mendoza","America/Fortaleza|America/Argentina/Rio_Gallegos","America/Fortaleza|America/Argentina/Salta","America/Fortaleza|America/Argentina/San_Juan","America/Fortaleza|America/Argentina/San_Luis","America/Fortaleza|America/Argentina/Tucuman","America/Fortaleza|America/Argentina/Ushuaia","America/Fortaleza|America/Bahia","America/Fortaleza|America/Belem","America/Fortaleza|America/Buenos_Aires","America/Fortaleza|America/Catamarca","America/Fortaleza|America/Cayenne","America/Fortaleza|America/Cordoba","America/Fortaleza|America/Jujuy","America/Fortaleza|America/Maceio","America/Fortaleza|America/Mendoza","America/Fortaleza|America/Montevideo","America/Fortaleza|America/Paramaribo","America/Fortaleza|America/Recife","America/Fortaleza|America/Rosario","America/Fortaleza|America/Santarem","America/Fortaleza|Antarctica/Rothera","America/Fortaleza|Atlantic/Stanley","America/Fortaleza|Etc/GMT+3","America/Godthab|America/Nuuk","America/Halifax|America/Glace_Bay","America/Halifax|America/Goose_Bay","America/Halifax|America/Moncton","America/Halifax|America/Thule","America/Halifax|Atlantic/Bermuda","America/Halifax|Canada/Atlantic","America/Havana|Cuba","America/La_Paz|America/Boa_Vista","America/La_Paz|America/Guyana","America/La_Paz|America/Manaus","America/La_Paz|America/Porto_Velho","America/La_Paz|Brazil/West","America/La_Paz|Etc/GMT+4","America/Lima|America/Bogota","America/Lima|America/Eirunepe","America/Lima|America/Guayaquil","America/Lima|America/Porto_Acre","America/Lima|America/Rio_Branco","America/Lima|Brazil/Acre","America/Lima|Etc/GMT+5","America/Los_Angeles|America/Ensenada","America/Los_Angeles|America/Santa_Isabel","America/Los_Angeles|America/Tijuana","America/Los_Angeles|America/Vancouver","America/Los_Angeles|Canada/Pacific","America/Los_Angeles|Mexico/BajaNorte","America/Los_Angeles|PST8PDT","America/Los_Angeles|US/Pacific","America/Managua|America/Belize","America/Managua|America/Costa_Rica","America/Managua|America/El_Salvador","America/Managua|America/Guatemala","America/Managua|America/Regina","America/Managua|America/Swift_Current","America/Managua|America/Tegucigalpa","America/Managua|Canada/Saskatchewan","America/Mexico_City|America/Bahia_Banderas","America/Mexico_City|America/Merida","America/Mexico_City|America/Monterrey","America/Mexico_City|Mexico/General","America/New_York|America/Detroit","America/New_York|America/Fort_Wayne","America/New_York|America/Indiana/Indianapolis","America/New_York|America/Indiana/Marengo","America/New_York|America/Indiana/Petersburg","America/New_York|America/Indiana/Vevay","America/New_York|America/Indiana/Vincennes","America/New_York|America/Indiana/Winamac","America/New_York|America/Indianapolis","America/New_York|America/Iqaluit","America/New_York|America/Kentucky/Louisville","America/New_York|America/Kentucky/Monticello","America/New_York|America/Louisville","America/New_York|America/Montreal","America/New_York|America/Nassau","America/New_York|America/Nipigon","America/New_York|America/Pangnirtung","America/New_York|America/Thunder_Bay","America/New_York|America/Toronto","America/New_York|Canada/Eastern","America/New_York|EST5EDT","America/New_York|US/East-Indiana","America/New_York|US/Eastern","America/New_York|US/Michigan","America/Noronha|Atlantic/South_Georgia","America/Noronha|Brazil/DeNoronha","America/Noronha|Etc/GMT+2","America/Panama|America/Atikokan","America/Panama|America/Cancun","America/Panama|America/Cayman","America/Panama|America/Coral_Harbour","America/Panama|America/Jamaica","America/Panama|EST","America/Panama|Jamaica","America/Phoenix|America/Creston","America/Phoenix|America/Dawson_Creek","America/Phoenix|America/Fort_Nelson","America/Phoenix|America/Hermosillo","America/Phoenix|MST","America/Phoenix|US/Arizona","America/Santiago|Chile/Continental","America/Santo_Domingo|America/Anguilla","America/Santo_Domingo|America/Antigua","America/Santo_Domingo|America/Aruba","America/Santo_Domingo|America/Barbados","America/Santo_Domingo|America/Blanc-Sablon","America/Santo_Domingo|America/Curacao","America/Santo_Domingo|America/Dominica","America/Santo_Domingo|America/Grenada","America/Santo_Domingo|America/Guadeloupe","America/Santo_Domingo|America/Kralendijk","America/Santo_Domingo|America/Lower_Princes","America/Santo_Domingo|America/Marigot","America/Santo_Domingo|America/Martinique","America/Santo_Domingo|America/Montserrat","America/Santo_Domingo|America/Port_of_Spain","America/Santo_Domingo|America/Puerto_Rico","America/Santo_Domingo|America/St_Barthelemy","America/Santo_Domingo|America/St_Kitts","America/Santo_Domingo|America/St_Lucia","America/Santo_Domingo|America/St_Thomas","America/Santo_Domingo|America/St_Vincent","America/Santo_Domingo|America/Tortola","America/Santo_Domingo|America/Virgin","America/Sao_Paulo|Brazil/East","America/St_Johns|Canada/Newfoundland","America/Whitehorse|America/Dawson","America/Whitehorse|Canada/Yukon","Antarctica/Palmer|America/Punta_Arenas","Asia/Baghdad|Antarctica/Syowa","Asia/Baghdad|Asia/Aden","Asia/Baghdad|Asia/Bahrain","Asia/Baghdad|Asia/Kuwait","Asia/Baghdad|Asia/Qatar","Asia/Baghdad|Asia/Riyadh","Asia/Baghdad|Etc/GMT-3","Asia/Baghdad|Europe/Kirov","Asia/Baghdad|Europe/Minsk","Asia/Bangkok|Antarctica/Davis","Asia/Bangkok|Asia/Ho_Chi_Minh","Asia/Bangkok|Asia/Krasnoyarsk","Asia/Bangkok|Asia/Novokuznetsk","Asia/Bangkok|Asia/Phnom_Penh","Asia/Bangkok|Asia/Saigon","Asia/Bangkok|Asia/Vientiane","Asia/Bangkok|Etc/GMT-7","Asia/Bangkok|Indian/Christmas","Asia/Dhaka|Antarctica/Vostok","Asia/Dhaka|Asia/Almaty","Asia/Dhaka|Asia/Bishkek","Asia/Dhaka|Asia/Dacca","Asia/Dhaka|Asia/Kashgar","Asia/Dhaka|Asia/Omsk","Asia/Dhaka|Asia/Qostanay","Asia/Dhaka|Asia/Thimbu","Asia/Dhaka|Asia/Thimphu","Asia/Dhaka|Asia/Urumqi","Asia/Dhaka|Etc/GMT-6","Asia/Dhaka|Indian/Chagos","Asia/Dubai|Asia/Baku","Asia/Dubai|Asia/Muscat","Asia/Dubai|Asia/Tbilisi","Asia/Dubai|Asia/Yerevan","Asia/Dubai|Etc/GMT-4","Asia/Dubai|Europe/Samara","Asia/Dubai|Indian/Mahe","Asia/Dubai|Indian/Mauritius","Asia/Dubai|Indian/Reunion","Asia/Gaza|Asia/Hebron","Asia/Hong_Kong|Hongkong","Asia/Jakarta|Asia/Pontianak","Asia/Jerusalem|Asia/Tel_Aviv","Asia/Jerusalem|Israel","Asia/Kamchatka|Asia/Anadyr","Asia/Kamchatka|Etc/GMT-12","Asia/Kamchatka|Kwajalein","Asia/Kamchatka|Pacific/Funafuti","Asia/Kamchatka|Pacific/Kwajalein","Asia/Kamchatka|Pacific/Majuro","Asia/Kamchatka|Pacific/Nauru","Asia/Kamchatka|Pacific/Tarawa","Asia/Kamchatka|Pacific/Wake","Asia/Kamchatka|Pacific/Wallis","Asia/Kathmandu|Asia/Katmandu","Asia/Kolkata|Asia/Calcutta","Asia/Kuala_Lumpur|Asia/Brunei","Asia/Kuala_Lumpur|Asia/Irkutsk","Asia/Kuala_Lumpur|Asia/Kuching","Asia/Kuala_Lumpur|Asia/Singapore","Asia/Kuala_Lumpur|Etc/GMT-8","Asia/Kuala_Lumpur|Singapore","Asia/Makassar|Asia/Ujung_Pandang","Asia/Rangoon|Asia/Yangon","Asia/Rangoon|Indian/Cocos","Asia/Seoul|ROK","Asia/Shanghai|Asia/Chongqing","Asia/Shanghai|Asia/Chungking","Asia/Shanghai|Asia/Harbin","Asia/Shanghai|Asia/Macao","Asia/Shanghai|Asia/Macau","Asia/Shanghai|Asia/Taipei","Asia/Shanghai|PRC","Asia/Shanghai|ROC","Asia/Tashkent|Antarctica/Mawson","Asia/Tashkent|Asia/Aqtau","Asia/Tashkent|Asia/Aqtobe","Asia/Tashkent|Asia/Ashgabat","Asia/Tashkent|Asia/Ashkhabad","Asia/Tashkent|Asia/Atyrau","Asia/Tashkent|Asia/Dushanbe","Asia/Tashkent|Asia/Oral","Asia/Tashkent|Asia/Samarkand","Asia/Tashkent|Asia/Yekaterinburg","Asia/Tashkent|Etc/GMT-5","Asia/Tashkent|Indian/Kerguelen","Asia/Tashkent|Indian/Maldives","Asia/Tehran|Iran","Asia/Tokyo|Japan","Asia/Ulaanbaatar|Asia/Choibalsan","Asia/Ulaanbaatar|Asia/Ulan_Bator","Asia/Vladivostok|Antarctica/DumontDUrville","Asia/Vladivostok|Asia/Ust-Nera","Asia/Vladivostok|Etc/GMT-10","Asia/Vladivostok|Pacific/Chuuk","Asia/Vladivostok|Pacific/Port_Moresby","Asia/Vladivostok|Pacific/Truk","Asia/Vladivostok|Pacific/Yap","Asia/Yakutsk|Asia/Dili","Asia/Yakutsk|Asia/Khandyga","Asia/Yakutsk|Etc/GMT-9","Asia/Yakutsk|Pacific/Palau","Atlantic/Azores|America/Scoresbysund","Atlantic/Cape_Verde|Etc/GMT+1","Australia/Adelaide|Australia/Broken_Hill","Australia/Adelaide|Australia/South","Australia/Adelaide|Australia/Yancowinna","Australia/Brisbane|Australia/Lindeman","Australia/Brisbane|Australia/Queensland","Australia/Darwin|Australia/North","Australia/Lord_Howe|Australia/LHI","Australia/Perth|Australia/West","Australia/Sydney|Antarctica/Macquarie","Australia/Sydney|Australia/ACT","Australia/Sydney|Australia/Canberra","Australia/Sydney|Australia/Currie","Australia/Sydney|Australia/Hobart","Australia/Sydney|Australia/Melbourne","Australia/Sydney|Australia/NSW","Australia/Sydney|Australia/Tasmania","Australia/Sydney|Australia/Victoria","Etc/UTC|Etc/UCT","Etc/UTC|Etc/Universal","Etc/UTC|Etc/Zulu","Etc/UTC|UCT","Etc/UTC|UTC","Etc/UTC|Universal","Etc/UTC|Zulu","Europe/Athens|Asia/Nicosia","Europe/Athens|EET","Europe/Athens|Europe/Bucharest","Europe/Athens|Europe/Helsinki","Europe/Athens|Europe/Kiev","Europe/Athens|Europe/Mariehamn","Europe/Athens|Europe/Nicosia","Europe/Athens|Europe/Riga","Europe/Athens|Europe/Sofia","Europe/Athens|Europe/Tallinn","Europe/Athens|Europe/Uzhgorod","Europe/Athens|Europe/Vilnius","Europe/Athens|Europe/Zaporozhye","Europe/Chisinau|Europe/Tiraspol","Europe/Dublin|Eire","Europe/Istanbul|Asia/Istanbul","Europe/Istanbul|Turkey","Europe/Lisbon|Atlantic/Canary","Europe/Lisbon|Atlantic/Faeroe","Europe/Lisbon|Atlantic/Faroe","Europe/Lisbon|Atlantic/Madeira","Europe/Lisbon|Portugal","Europe/Lisbon|WET","Europe/London|Europe/Belfast","Europe/London|Europe/Guernsey","Europe/London|Europe/Isle_of_Man","Europe/London|Europe/Jersey","Europe/London|GB","Europe/London|GB-Eire","Europe/Moscow|Europe/Simferopol","Europe/Moscow|W-SU","Europe/Paris|Africa/Ceuta","Europe/Paris|Arctic/Longyearbyen","Europe/Paris|Atlantic/Jan_Mayen","Europe/Paris|CET","Europe/Paris|Europe/Amsterdam","Europe/Paris|Europe/Andorra","Europe/Paris|Europe/Belgrade","Europe/Paris|Europe/Berlin","Europe/Paris|Europe/Bratislava","Europe/Paris|Europe/Brussels","Europe/Paris|Europe/Budapest","Europe/Paris|Europe/Busingen","Europe/Paris|Europe/Copenhagen","Europe/Paris|Europe/Gibraltar","Europe/Paris|Europe/Ljubljana","Europe/Paris|Europe/Luxembourg","Europe/Paris|Europe/Madrid","Europe/Paris|Europe/Malta","Europe/Paris|Europe/Monaco","Europe/Paris|Europe/Oslo","Europe/Paris|Europe/Podgorica","Europe/Paris|Europe/Prague","Europe/Paris|Europe/Rome","Europe/Paris|Europe/San_Marino","Europe/Paris|Europe/Sarajevo","Europe/Paris|Europe/Skopje","Europe/Paris|Europe/Stockholm","Europe/Paris|Europe/Tirane","Europe/Paris|Europe/Vaduz","Europe/Paris|Europe/Vatican","Europe/Paris|Europe/Vienna","Europe/Paris|Europe/Warsaw","Europe/Paris|Europe/Zagreb","Europe/Paris|Europe/Zurich","Europe/Paris|Poland","Europe/Ulyanovsk|Europe/Astrakhan","Pacific/Auckland|Antarctica/McMurdo","Pacific/Auckland|Antarctica/South_Pole","Pacific/Auckland|NZ","Pacific/Bougainville|Asia/Srednekolymsk","Pacific/Bougainville|Etc/GMT-11","Pacific/Bougainville|Pacific/Efate","Pacific/Bougainville|Pacific/Guadalcanal","Pacific/Bougainville|Pacific/Kosrae","Pacific/Bougainville|Pacific/Noumea","Pacific/Bougainville|Pacific/Pohnpei","Pacific/Bougainville|Pacific/Ponape","Pacific/Chatham|NZ-CHAT","Pacific/Easter|Chile/EasterIsland","Pacific/Fakaofo|Etc/GMT-13","Pacific/Fakaofo|Pacific/Enderbury","Pacific/Galapagos|Etc/GMT+6","Pacific/Gambier|Etc/GMT+9","Pacific/Guam|Pacific/Saipan","Pacific/Honolulu|HST","Pacific/Honolulu|Pacific/Johnston","Pacific/Honolulu|US/Hawaii","Pacific/Kiritimati|Etc/GMT-14","Pacific/Niue|Etc/GMT+11","Pacific/Pago_Pago|Pacific/Midway","Pacific/Pago_Pago|Pacific/Samoa","Pacific/Pago_Pago|US/Samoa","Pacific/Pitcairn|Etc/GMT+8","Pacific/Tahiti|Etc/GMT+10","Pacific/Tahiti|Pacific/Rarotonga"],countries:["AD|Europe/Andorra","AE|Asia/Dubai","AF|Asia/Kabul","AG|America/Port_of_Spain America/Antigua","AI|America/Port_of_Spain America/Anguilla","AL|Europe/Tirane","AM|Asia/Yerevan","AO|Africa/Lagos Africa/Luanda","AQ|Antarctica/Casey Antarctica/Davis Antarctica/DumontDUrville Antarctica/Mawson Antarctica/Palmer Antarctica/Rothera Antarctica/Syowa Antarctica/Troll Antarctica/Vostok Pacific/Auckland Antarctica/McMurdo","AR|America/Argentina/Buenos_Aires America/Argentina/Cordoba America/Argentina/Salta America/Argentina/Jujuy America/Argentina/Tucuman America/Argentina/Catamarca America/Argentina/La_Rioja America/Argentina/San_Juan America/Argentina/Mendoza America/Argentina/San_Luis America/Argentina/Rio_Gallegos America/Argentina/Ushuaia","AS|Pacific/Pago_Pago","AT|Europe/Vienna","AU|Australia/Lord_Howe Antarctica/Macquarie Australia/Hobart Australia/Currie Australia/Melbourne Australia/Sydney Australia/Broken_Hill Australia/Brisbane Australia/Lindeman Australia/Adelaide Australia/Darwin Australia/Perth Australia/Eucla","AW|America/Curacao America/Aruba","AX|Europe/Helsinki Europe/Mariehamn","AZ|Asia/Baku","BA|Europe/Belgrade Europe/Sarajevo","BB|America/Barbados","BD|Asia/Dhaka","BE|Europe/Brussels","BF|Africa/Abidjan Africa/Ouagadougou","BG|Europe/Sofia","BH|Asia/Qatar Asia/Bahrain","BI|Africa/Maputo Africa/Bujumbura","BJ|Africa/Lagos Africa/Porto-Novo","BL|America/Port_of_Spain America/St_Barthelemy","BM|Atlantic/Bermuda","BN|Asia/Brunei","BO|America/La_Paz","BQ|America/Curacao America/Kralendijk","BR|America/Noronha America/Belem America/Fortaleza America/Recife America/Araguaina America/Maceio America/Bahia America/Sao_Paulo America/Campo_Grande America/Cuiaba America/Santarem America/Porto_Velho America/Boa_Vista America/Manaus America/Eirunepe America/Rio_Branco","BS|America/Nassau","BT|Asia/Thimphu","BW|Africa/Maputo Africa/Gaborone","BY|Europe/Minsk","BZ|America/Belize","CA|America/St_Johns America/Halifax America/Glace_Bay America/Moncton America/Goose_Bay America/Blanc-Sablon America/Toronto America/Nipigon America/Thunder_Bay America/Iqaluit America/Pangnirtung America/Atikokan America/Winnipeg America/Rainy_River America/Resolute America/Rankin_Inlet America/Regina America/Swift_Current America/Edmonton America/Cambridge_Bay America/Yellowknife America/Inuvik America/Creston America/Dawson_Creek America/Fort_Nelson America/Vancouver America/Whitehorse America/Dawson","CC|Indian/Cocos","CD|Africa/Maputo Africa/Lagos Africa/Kinshasa Africa/Lubumbashi","CF|Africa/Lagos Africa/Bangui","CG|Africa/Lagos Africa/Brazzaville","CH|Europe/Zurich","CI|Africa/Abidjan","CK|Pacific/Rarotonga","CL|America/Santiago America/Punta_Arenas Pacific/Easter","CM|Africa/Lagos Africa/Douala","CN|Asia/Shanghai Asia/Urumqi","CO|America/Bogota","CR|America/Costa_Rica","CU|America/Havana","CV|Atlantic/Cape_Verde","CW|America/Curacao","CX|Indian/Christmas","CY|Asia/Nicosia Asia/Famagusta","CZ|Europe/Prague","DE|Europe/Zurich Europe/Berlin Europe/Busingen","DJ|Africa/Nairobi Africa/Djibouti","DK|Europe/Copenhagen","DM|America/Port_of_Spain America/Dominica","DO|America/Santo_Domingo","DZ|Africa/Algiers","EC|America/Guayaquil Pacific/Galapagos","EE|Europe/Tallinn","EG|Africa/Cairo","EH|Africa/El_Aaiun","ER|Africa/Nairobi Africa/Asmara","ES|Europe/Madrid Africa/Ceuta Atlantic/Canary","ET|Africa/Nairobi Africa/Addis_Ababa","FI|Europe/Helsinki","FJ|Pacific/Fiji","FK|Atlantic/Stanley","FM|Pacific/Chuuk Pacific/Pohnpei Pacific/Kosrae","FO|Atlantic/Faroe","FR|Europe/Paris","GA|Africa/Lagos Africa/Libreville","GB|Europe/London","GD|America/Port_of_Spain America/Grenada","GE|Asia/Tbilisi","GF|America/Cayenne","GG|Europe/London Europe/Guernsey","GH|Africa/Accra","GI|Europe/Gibraltar","GL|America/Nuuk America/Danmarkshavn America/Scoresbysund America/Thule","GM|Africa/Abidjan Africa/Banjul","GN|Africa/Abidjan Africa/Conakry","GP|America/Port_of_Spain America/Guadeloupe","GQ|Africa/Lagos Africa/Malabo","GR|Europe/Athens","GS|Atlantic/South_Georgia","GT|America/Guatemala","GU|Pacific/Guam","GW|Africa/Bissau","GY|America/Guyana","HK|Asia/Hong_Kong","HN|America/Tegucigalpa","HR|Europe/Belgrade Europe/Zagreb","HT|America/Port-au-Prince","HU|Europe/Budapest","ID|Asia/Jakarta Asia/Pontianak Asia/Makassar Asia/Jayapura","IE|Europe/Dublin","IL|Asia/Jerusalem","IM|Europe/London Europe/Isle_of_Man","IN|Asia/Kolkata","IO|Indian/Chagos","IQ|Asia/Baghdad","IR|Asia/Tehran","IS|Atlantic/Reykjavik","IT|Europe/Rome","JE|Europe/London Europe/Jersey","JM|America/Jamaica","JO|Asia/Amman","JP|Asia/Tokyo","KE|Africa/Nairobi","KG|Asia/Bishkek","KH|Asia/Bangkok Asia/Phnom_Penh","KI|Pacific/Tarawa Pacific/Enderbury Pacific/Kiritimati","KM|Africa/Nairobi Indian/Comoro","KN|America/Port_of_Spain America/St_Kitts","KP|Asia/Pyongyang","KR|Asia/Seoul","KW|Asia/Riyadh Asia/Kuwait","KY|America/Panama America/Cayman","KZ|Asia/Almaty Asia/Qyzylorda Asia/Qostanay Asia/Aqtobe Asia/Aqtau Asia/Atyrau Asia/Oral","LA|Asia/Bangkok Asia/Vientiane","LB|Asia/Beirut","LC|America/Port_of_Spain America/St_Lucia","LI|Europe/Zurich Europe/Vaduz","LK|Asia/Colombo","LR|Africa/Monrovia","LS|Africa/Johannesburg Africa/Maseru","LT|Europe/Vilnius","LU|Europe/Luxembourg","LV|Europe/Riga","LY|Africa/Tripoli","MA|Africa/Casablanca","MC|Europe/Monaco","MD|Europe/Chisinau","ME|Europe/Belgrade Europe/Podgorica","MF|America/Port_of_Spain America/Marigot","MG|Africa/Nairobi Indian/Antananarivo","MH|Pacific/Majuro Pacific/Kwajalein","MK|Europe/Belgrade Europe/Skopje","ML|Africa/Abidjan Africa/Bamako","MM|Asia/Yangon","MN|Asia/Ulaanbaatar Asia/Hovd Asia/Choibalsan","MO|Asia/Macau","MP|Pacific/Guam Pacific/Saipan","MQ|America/Martinique","MR|Africa/Abidjan Africa/Nouakchott","MS|America/Port_of_Spain America/Montserrat","MT|Europe/Malta","MU|Indian/Mauritius","MV|Indian/Maldives","MW|Africa/Maputo Africa/Blantyre","MX|America/Mexico_City America/Cancun America/Merida America/Monterrey America/Matamoros America/Mazatlan America/Chihuahua America/Ojinaga America/Hermosillo America/Tijuana America/Bahia_Banderas","MY|Asia/Kuala_Lumpur Asia/Kuching","MZ|Africa/Maputo","NA|Africa/Windhoek","NC|Pacific/Noumea","NE|Africa/Lagos Africa/Niamey","NF|Pacific/Norfolk","NG|Africa/Lagos","NI|America/Managua","NL|Europe/Amsterdam","NO|Europe/Oslo","NP|Asia/Kathmandu","NR|Pacific/Nauru","NU|Pacific/Niue","NZ|Pacific/Auckland Pacific/Chatham","OM|Asia/Dubai Asia/Muscat","PA|America/Panama","PE|America/Lima","PF|Pacific/Tahiti Pacific/Marquesas Pacific/Gambier","PG|Pacific/Port_Moresby Pacific/Bougainville","PH|Asia/Manila","PK|Asia/Karachi","PL|Europe/Warsaw","PM|America/Miquelon","PN|Pacific/Pitcairn","PR|America/Puerto_Rico","PS|Asia/Gaza Asia/Hebron","PT|Europe/Lisbon Atlantic/Madeira Atlantic/Azores","PW|Pacific/Palau","PY|America/Asuncion","QA|Asia/Qatar","RE|Indian/Reunion","RO|Europe/Bucharest","RS|Europe/Belgrade","RU|Europe/Kaliningrad Europe/Moscow Europe/Simferopol Europe/Kirov Europe/Astrakhan Europe/Volgograd Europe/Saratov Europe/Ulyanovsk Europe/Samara Asia/Yekaterinburg Asia/Omsk Asia/Novosibirsk Asia/Barnaul Asia/Tomsk Asia/Novokuznetsk Asia/Krasnoyarsk Asia/Irkutsk Asia/Chita Asia/Yakutsk Asia/Khandyga Asia/Vladivostok Asia/Ust-Nera Asia/Magadan Asia/Sakhalin Asia/Srednekolymsk Asia/Kamchatka Asia/Anadyr","RW|Africa/Maputo Africa/Kigali","SA|Asia/Riyadh","SB|Pacific/Guadalcanal","SC|Indian/Mahe","SD|Africa/Khartoum","SE|Europe/Stockholm","SG|Asia/Singapore","SH|Africa/Abidjan Atlantic/St_Helena","SI|Europe/Belgrade Europe/Ljubljana","SJ|Europe/Oslo Arctic/Longyearbyen","SK|Europe/Prague Europe/Bratislava","SL|Africa/Abidjan Africa/Freetown","SM|Europe/Rome Europe/San_Marino","SN|Africa/Abidjan Africa/Dakar","SO|Africa/Nairobi Africa/Mogadishu","SR|America/Paramaribo","SS|Africa/Juba","ST|Africa/Sao_Tome","SV|America/El_Salvador","SX|America/Curacao America/Lower_Princes","SY|Asia/Damascus","SZ|Africa/Johannesburg Africa/Mbabane","TC|America/Grand_Turk","TD|Africa/Ndjamena","TF|Indian/Reunion Indian/Kerguelen","TG|Africa/Abidjan Africa/Lome","TH|Asia/Bangkok","TJ|Asia/Dushanbe","TK|Pacific/Fakaofo","TL|Asia/Dili","TM|Asia/Ashgabat","TN|Africa/Tunis","TO|Pacific/Tongatapu","TR|Europe/Istanbul","TT|America/Port_of_Spain","TV|Pacific/Funafuti","TW|Asia/Taipei","TZ|Africa/Nairobi Africa/Dar_es_Salaam","UA|Europe/Simferopol Europe/Kiev Europe/Uzhgorod Europe/Zaporozhye","UG|Africa/Nairobi Africa/Kampala","UM|Pacific/Pago_Pago Pacific/Wake Pacific/Honolulu Pacific/Midway","US|America/New_York America/Detroit America/Kentucky/Louisville America/Kentucky/Monticello America/Indiana/Indianapolis America/Indiana/Vincennes America/Indiana/Winamac America/Indiana/Marengo America/Indiana/Petersburg America/Indiana/Vevay America/Chicago America/Indiana/Tell_City America/Indiana/Knox America/Menominee America/North_Dakota/Center America/North_Dakota/New_Salem America/North_Dakota/Beulah America/Denver America/Boise America/Phoenix America/Los_Angeles America/Anchorage America/Juneau America/Sitka America/Metlakatla America/Yakutat America/Nome America/Adak Pacific/Honolulu","UY|America/Montevideo","UZ|Asia/Samarkand Asia/Tashkent","VA|Europe/Rome Europe/Vatican","VC|America/Port_of_Spain America/St_Vincent","VE|America/Caracas","VG|America/Port_of_Spain America/Tortola","VI|America/Port_of_Spain America/St_Thomas","VN|Asia/Bangkok Asia/Ho_Chi_Minh","VU|Pacific/Efate","WF|Pacific/Wallis","WS|Pacific/Apia","YE|Asia/Riyadh Asia/Aden","YT|Africa/Nairobi Indian/Mayotte","ZA|Africa/Johannesburg","ZM|Africa/Maputo Africa/Lusaka","ZW|Africa/Maputo Africa/Harare"]}),e}),define("app/time",["moment-timezone","app/socket","app/data/localStorage"],function(e,t,n){"use strict";var i={synced:!1,offset:parseFloat(n.getItem("TIME:OFFSET"))||0,zone:n.getItem("TIME:ZONE")||"Europe/Warsaw",appData:window.TIME||0};function r(e,t){for(e=String(e);e.length<t;)e="0"+e;return e}return delete window.TIME,i.sync=function(){var e=Date.now();t.emit("time",function(t,r){i.offset=(t-e+(t-Date.now()))/2,i.zone=r,i.synced=!0,n.setItem("TIME:OFFSET",i.offset.toString()),n.setItem("TIME:ZONE",i.zone)})},i.getServerMoment=function(){return e.tz(Date.now()+i.offset,i.zone)},i.getMoment=function(t,n){return e.tz(t,n,i.zone)},i.format=function(e,t){var n=i.getMoment(e);return n.isValid()?n.format(t):null},i.utc={getMoment:function(t,n){return e.utc(t,n)},format:function(t,n){var i=e.utc(t);return i.isValid()?i.format(n):null}},i.toTagData=function(e,t){if(!e)return{iso:"?",long:"?",human:"?",daysAgo:0};var n=i.getMoment(e),r=n.valueOf(),o=Date.now();return{iso:n.toISOString(),long:n.format("LLLL"),human:!0===t?n.from(r>o?r:o):n.fromNow(),daysAgo:-n.diff(o,"days")}},i.toSeconds=function(e){if("number"==typeof e)return e;if("string"!=typeof e)return 0;var t={g:3600,h:3600,m:60,s:1,ms:.001},n=e.trim(),i=parseInt(n,10),r=n.match(/([0-9]+):([0-9]+)(?::([0-9]+))?/);if(r)return i=3600*parseInt(r[1],10),i+=60*parseInt(r[2],10),r[3]&&(i+=parseInt(r[3],10)),i;if(!1===/^[0-9]+\.?[0-9]*$/.test(n)){var o,a=/([0-9\.]+)\s*(h|ms|m|s)[a-z]*/gi;for(i=0;null!==(o=a.exec(n));)i+=parseFloat(o[1])*t[o[2].toLowerCase()]}return i},i.toString=function(e,t,n){if("number"!=typeof e||e<=0||isNaN(e))return t?"00:00:00":"0s";e=Math.round(1e3*e)/1e3;var i="",o=Math.floor(e/3600);o>0?(i+=t?r(o,2)+":":" "+o+"h",e%=3600):t&&(i+="00:");var a=Math.floor(e/60);a>0?(i+=t?r(a,2)+":":" "+a+"min",e%=60):t&&(i+="00:");var s=e;return s>=1?(i+=t?r(Math[n?"floor":"round"](s),2):" "+Math[n?"floor":"round"](s)+"s",n&&s%1!=0&&(i+=t?"."+r(Math.round(s%1*1e3),3):" "+Math.round(s%1*1e3)+"ms")):s>0&&""===i?i+=" "+1e3*s+"ms":t&&(i+="00"),t?i:i.substr(1)},t.on("connect",function(){i.sync()}),t.isConnected()&&i.sync(),window.time=i,i}),define("h5.rql/Term",["require","exports","module"],function(e,t,n){"use strict";n.exports=function(e,t){this.name=e||null,this.args=t||[]}}),define("h5.rql/specialTerms",["require","exports","module"],function(e,t,n){"use strict";function i(e,t,n){e.fields={};for(var i="select"===t,r=0,o=n.length;r<o;++r){var a=n[r];Array.isArray(a)&&(a=a.join(".")),e.fields[a]=i}}n.exports={select:i,exclude:i,sort:function(e,t,n){e.sort={};for(var i=0,r=n.length;i<r;++i){var o=n[i];Array.isArray(o)&&(o=o.join(".")),"-"===o[0]?e.sort[o.substr(1)]=-1:"+"===o[0]?e.sort[o.substr(1)]=1:e.sort[o]=1}},limit:function(e,t,n){var i=parseInt(n[0],10),r=0;n.length>1&&(r=parseInt(n[1],10));e.limit=isNaN(i)?-1:i,e.skip=isNaN(r)||r<0?0:r}}}),define("h5.rql/autoConvertedMap",["require","exports","module"],function(e,t,n){"use strict";n.exports={true:!0,false:!1,null:null,undefined:void 0,Infinity:1/0,"-Infinity":-1/0}}),define("h5.rql/serializers/stringSerializer",["require","exports","module","../specialTerms","../specialOperators","../autoConvertedMap"],function(e,t,n){var i=e("../specialTerms"),r=e("../specialOperators"),o=e("../autoConvertedMap");function a(e,t,n,i,s){if(Array.isArray(n))!function(e,t,n){e.push("(");for(var i=0,r=n.length;i<r;++i)a(e,t,n[i],r),i<r-1&&e.push(",");e.push(")")}(e,t,n);else if(null!==n&&"object"==typeof n&&"string"==typeof n.name&&Array.isArray(n.args)){if(r.hasOwnProperty(n.name)&&n.args.length>1)return a(e,t,n.args[0],0),e.push(r[n.name]),void a(e,t,n.args[1],0);var u=",";"and"===n.name?u="&":"or"===n.name&&!0!==s&&(u="|"),function(e,t,n,i,r){var o=i.args.length;","===n?e.push(i.name,"("):1!==r&&e.push("(");for(var s=0;s<o;++s)a(e,t,i.args[s],o),s<o-1&&e.push(n);","!==n&&1===r||e.push(")")}(e,t,u,n,i)}else!function(e,t,n){switch(typeof n){case"undefined":e.push("undefined");break;case"boolean":e.push(n?"true":"false");break;case"number":e.push(n.toString(10));break;case"object":!function(e,t,n){if(null===n)e.push("null");else if(n instanceof Date)e.push("epoch:",n.getTime().toString());else if(n instanceof RegExp){var i=n.toString(),r=i.lastIndexOf("/");""===i.substr(r+1)&&(i=i.substr(1,r-1)),e.push("re:",t.encode(i))}else"function"==typeof n.convertToRqlValue?e.push(n.convertToRqlValue(t.encode)):e.push(t.encode(n.toString()))}(e,t,n);break;default:0===n.length?e.push("string:"):isNaN(+n)?o.hasOwnProperty(n)?e.push("string:",n):e.push(t.encode(n)):e.push("string:",n.toString())}}(e,t,n)}function s(e){return e=encodeURIComponent(e),/[\(\)]/.test(e)&&(e=e.replace(/\(/g,"%28").replace(/\)/g,"%29")),e}function u(e){return s(s(e))}t.fromQuery=function(e,t){var n=[],r={encode:t&&t.doubleEncode?u:s};return function(e,t){var n=Object.keys(t);0!==n.length&&e.push(t[n[0]]?"&select(":"&exclude(",n.join(","),")")}(n,e.fields),function(e,t){var n=Object.keys(t),i=n.length;if(0!==i){e.push("&sort(");for(var r=0;r<i;++r){var o=n[r];-1===t[o]&&e.push("-"),e.push(o),r<i-1&&e.push(",")}e.push(")")}}(n,e.sort),function(e,t,n){-1!==t&&(e.push("&limit(",t),0!==n&&e.push(",",n),e.push(")"))}(n,e.limit,e.skip),function(e,t,n){var r=n.args.length;if(0!==r)if("and"===n.name)for(var o=0;o<r;++o){var s=n.args[o];i.hasOwnProperty(s.name)||(e.push("&"),a(e,t,s,r,!0))}else e.push("&"),a(e,t,n,r,!0)}(n,r,e.selector),n.join("").substr(1)}}),define("h5.rql/Query",["require","exports","module","./Term","./serializers/stringSerializer"],function(e,t,n){"use strict";var i=e("./Term"),r=e("./serializers/stringSerializer");function o(){this.selector=new i("and"),this.fields={},this.skip=0,this.limit=-1,this.sort={}}n.exports=o,o.fromObject=function(e){if(e instanceof o)return e;var t=new o;return e?(e.selector&&(t.selector=e.selector),e.fields&&(t.fields=e.fields),e.skip&&(t.skip=e.skip),e.limit&&(t.limit=e.limit),e.sort&&(t.sort=e.sort),t):t},o.prototype.toString=function(e){return r.fromQuery(this,e)},o.prototype.isEmpty=function(){return 0===this.skip&&-1===this.limit&&0===Object.keys(this.fields).length&&0===Object.keys(this.sort).length&&0===this.selector.args.length}}),define("h5.rql/valueConverters",["require","exports","module","./autoConvertedMap"],function(e,t,n){"use strict";var i=e("./autoConvertedMap");function r(e,t){if(i.hasOwnProperty(e))return i[e];var n=+e;return isNaN(n)||n.toString()!==e?(e=decodeURIComponent(e),t.options.jsonQueryCompatible&&"'"===e[0]&&"'"===e[e.length-1]?JSON.parse('"'+e.substring(1,e.length-1)+'"'):e):n}function o(e){e=decodeURIComponent(e);var t,n=/^(\d{4})-(\d{2})-(\d{2})T(\d{2}):(\d{2}):(\d{2}(?:\.\d*)?)Z$/.exec(e);if(t=null!==n?new Date(Date.UTC(+n[1],+n[2]-1,+n[3],+n[4],+n[5],+n[6])):new Date(e),isNaN(t.getTime()))throw new Error("Invalid date: "+e);return t}n.exports={default:r,auto:r,number:function(e){var t=+e;if(isNaN(t))throw new Error("Invalid number: "+e);return t},epoch:function(e){var t=new Date(+e);if(isNaN(t.getTime()))throw new Error("Invalid date: "+e);return t},isodate:function(e){return e=decodeURIComponent(e),e="0000".substr(0,4-e.length)+e,o(e+="0000-01-01T00:00:00Z".substring(e.length))},date:o,boolean:function(e){return!!e},string:function(e){return decodeURIComponent(e)},re:function(e){var t=e=decodeURIComponent(e),n="";if("/"===e[0]){var i=e.lastIndexOf("/");t=e.substr(1,i-1),n=e.substr(i+1)}return new RegExp(t,n)},glob:function(e){return e=".*"===(e=".*"===(e=decodeURIComponent(e).replace(/([\\\|\(\)\[\]\{\}\^\$\*\+\?\.<>])/g,"\\$1").replace(/\\\*/g,".*").replace(/\\\?/g,".?")).substr(0,2)?e.substr(2):"^"+e).substr(e.length-2)?e.substr(0,e.length-2):e+"$",new RegExp(e,"i")}}}),define("h5.rql/Parser",["require","exports","module","./Term","./valueConverters"],function(e,t,n){"use strict";var i=e("./Term"),r=e("./valueConverters");n.exports=c;var o=/^[\+\*\$\-:\w%\._!'~]$/,a=/[\+\*\$\-:\w%\._!'~]*\/[\+\*\$\-:\w%\._!'~\/]*/g,s=new RegExp("(\\([\\+\\*\\$\\-:\\w%\\._,]+\\)|[\\+\\*\\$\\-:\\w%\\._]*|)([<>!]?=(?:[\\w]*=)?|>|<)(\\([\\+\\*\\$\\-:\\w%\\._,!'~]*\\)|[\\+\\*\\$\\-:\\w%\\._!'~]*|)","g"),u={"=":"eq","==":"eq",">":"gt",">=":"ge","<":"lt","<=":"le","!=":"ne"};function c(e){this.options=e instanceof c.Options?e:new c.Options(e)}c.Options=function(e){"object"==typeof e&&null!==e||(e={}),this.jsonQueryCompatible=!0===e.jsonQueryCompatible,this.fiqlCompatible=!e.hasOwnProperty("fiqlCompatible")||!0===e.fiqlCompatible,this.allowSlashedArrays=!0===e.allowSlashedArrays,this.allowEmptyValues=!0===e.allowEmptyValues,this.defaultValueConverter="function"==typeof e.defaultValueConverter?e.defaultValueConverter:r.default,this.specialTerms=Array.isArray(e.specialTerms)?e.specialTerms:[],this.emptyValue=e.hasOwnProperty("emptyValue")?e.emptyValue:""},c.prototype.parse=function(e,t){var n="object"==typeof t&&null!==t,r=this.options.specialTerms,a=null,s=new i,u=[],c=!0;this.options.jsonQueryCompatible&&(e=this.makeJsonQueryCompatible(e)),this.options.allowSlashedArrays&&(e=this.convertSlashedArrays(e)),this.options.fiqlCompatible&&(e=this.convertFiql(e));for(var l=0,d=e.length;l<d;++l){var p=e[l];switch(p){case"(":u.push(s),s=new i(a),n&&null!==a&&-1!==r.indexOf(a)&&(delete t[a],t[a]=s.args),a=null,c=!0;break;case",":if(!1===c){if(!this.options.allowEmptyValues)throw new Error("Empty value at position "+l+" is not allowed.");a=this.options.emptyValue}null!==a&&(s.args.push(this.convertStringToValue(a)),a=null),c=!1;break;case")":null!==a&&(s.args.push(this.convertStringToValue(a)),a=null);var f=null===s.name?s.args:s;(s=u.pop()).args.push(f),c=!0;break;case"&":case"|":var h="&"===p?"and":"or";if(null!==s.name&&s.name!==h)throw new Error("Can not mix conjunctions within a group at position "+l+", use parenthesises around each set of the same conjunctions (& and |)");s.name="&"===p?"and":"or",null!==a&&(s.args.push(this.convertStringToValue(a)),a=null);break;default:if(!o.test(p))throw new Error("Invalid character at position "+l+": '"+p+"' ("+p.charCodeAt(0)+")");null===a?a=p:a+=p,c=!0}}return null!==a&&s.args.push(this.convertStringToValue(a)),null===s.name&&(s.name="and"),"and"===s.name&&1===s.args.length&&s.args[0]instanceof i&&"and"===s.args[0].name&&(s=s.args[0]),s},c.prototype.makeJsonQueryCompatible=function(e){return this.options.jsonQueryCompatible&&(e=e.replace(/%3C=/g,"=le=").replace(/%3E=/g,"=ge=").replace(/%3C/g,"=lt=").replace(/%3E/g,"=gt=")),e},c.prototype.convertSlashedArrays=function(e){return-1!==e.indexOf("/")?e.replace(a,function(e){return"("+e.replace(/\//g,",")+")"}):e},c.prototype.convertFiql=function(e){return e.replace(s,function(e,t,n,i){return(n=n.length<3?u[n]:n.substring(1,n.length-1))+"("+t+","+i+")"})},c.prototype.convertStringToValue=function(e){var t,n=e.indexOf(":");if(-1!==n){var i=e.substr(0,n);if(void 0===(t=r[i]))throw new Error("Unknown value converter: "+i);e=e.substr(n+1)}else t=this.options.defaultValueConverter;return t(e,this)}}),define("h5.rql/index",["require","exports","module","./Term","./Query","./Parser","./specialTerms","./valueConverters"],function(e,t,n){"use strict";var i=e("./Term"),r=e("./Query"),o=e("./Parser"),a=e("./specialTerms"),s=e("./valueConverters");t.Term=i,t.Query=r,t.Parser=o,t.specialTerms=a,t.valueConverters=s,t.parser=null,t.parse=function(e){null===t.parser&&(t.parser=new o({jsonQueryCompatible:!0,fiqlCompatible:!0,allowEmptyValues:!1,allowSlashedArrays:!0,specialTerms:Object.keys(a)}));var n=new r,i={};for(var s in n.selector=t.parser.parse(e,i),i)i.hasOwnProperty(s)&&a.hasOwnProperty(s)&&a[s](n,s,i[s]);return n}}),define("app/core/PaginationData",["underscore","backbone"],function(e,t){"use strict";return t.Model.extend({defaults:{totalCount:-1,urlTemplate:"?page=${page}&limit=${limit}",page:1,skip:0,limit:10},initialize:function(){this.on("change",this.recalcAttrs,this);var e=this.attributes;e.page<1&&(e.page=1),e.skip<0&&(e.skip=0),e.limit<1&&(e.limit=1),0!==e.skip?this.recalcPage():1!==e.page?this.recalcSkip():this.adjustSkipToLimit()},sync:function(){throw new Error("Not supported!")},recalcAttrs:function(){var t=this.changedAttributes();e.has(t,"total")||e.has(t,"skip")||e.has(t,"limit")?this.recalcPage():e.has(t,"page")&&this.recalcSkip()},recalcPage:function(){this.adjustSkipToLimit();var e=this.attributes;e.page=e.skip/e.limit+1},recalcSkip:function(){var e=this.attributes;e.skip=(e.page-1)*e.limit},adjustSkipToLimit:function(){var e=this.attributes;e.skip>=e.total&&(e.skip=e.total<2?1:e.total-1);var t=e.skip%e.limit;0!==t&&(e.skip-=t)}})}),define("app/core/Model",["underscore","backbone"],function(e,t){"use strict";return t.Model.extend({idAttribute:"_id",urlRoot:"/",clientUrlRoot:null,topicPrefix:null,privilegePrefix:null,nlsDomain:null,labelAttribute:null,genUrl:function(t,n){var i=e.result(this,"urlRoot");if(!i)throw new Error("'urlRoot' was not specified!");var r=i;return"base"===t?r:(!0!==n&&(r+="/",this.isNew()?r+=encodeURIComponent(this.cid):r+=encodeURIComponent(this.id)),"string"==typeof t&&(r+=";"+t),r)},genClientUrl:function(t){var n=e.result(this,"clientUrlRoot");if(!n)throw new Error("`clientUrlRoot` was not specified");var i=n;return"base"===t?i:(i+="/",this.isNew()?i+=encodeURIComponent(this.cid):i+=encodeURIComponent(this.id),"string"==typeof t&&(i+=";"+t),i)},getTopicPrefix:function(){return this.topicPrefix},getPrivilegePrefix:function(){return this.privilegePrefix},getNlsDomain:function(){return this.nlsDomain||"core"},getLabelAttribute:function(){return this.labelAttribute||this.idAttribute},getLabel:function(){return String(this.get(this.getLabelAttribute()))},sync:function(e,n,i){var r="read"===e;r&&this.cancelCurrentReadRequest(n);var o=t.Model.prototype.sync.call(this,e,n,i);return r&&this.setUpCurrentReadRequest(n,o),o},cancelCurrentReadRequest:function(e){e.currentReadRequest&&(e.currentReadRequest.abort(),e.currentReadRequest=null)},setUpCurrentReadRequest:function(e,t){t.always(function(){e.currentReadRequest===t&&(e.currentReadRequest=null)}),e.currentReadRequest=t},isSynced:function(){return null===this.currentReadRequest||!!this.collection&&!!this.collection.get(this)},findRqlTerm:function(t,n){return this.rqlQuery?e.find(this.rqlQuery.selector.args,function(e){return e.args[0]===t&&(Array.isArray(n)?-1!==n.indexOf(e.name):!n||e.name===n)}):null}})}),define("app/core/Collection",["underscore","backbone","h5.rql/index","./util","./PaginationData","./Model"],function(e,t,n,i,r,o){"use strict";function a(n,i){e.isObject(i)||(i={}),this.rqlQuery=this.createRqlQuery(i.rqlQuery||this.rqlQuery),-1337===this.rqlQuery.limit&&(this.rqlQuery.limit=this.getDefaultPageLimit()),this.paginationData=!1!==i.paginate&&!1!==this.paginate?new r:null,this.url||(this.url=this.model.prototype.urlRoot),t.Collection.call(this,n,i),this.paginationData&&this.listenTo(this.paginationData,"change:page",this.onPageChanged)}return i.inherits(a,t.Collection),a.prototype.model=o,a.prototype.parse=function(e){return e||(e={totalCount:0,collection:[]}),this.paginationData&&this.paginationData.set(this.getPaginationData(e)),Array.isArray(e.collection)?e.collection:[]},a.prototype.sync=function(e,n,i){return"read"!==e||i.data||(i.data=this.rqlQuery.toString()),t.Collection.prototype.sync.call(this,e,n,i)},a.prototype.genUrl=function(t){var n=e.result(this.model.prototype,"urlRoot");if(!n)throw new Error("'urlRoot' was not specified");var i=n;return"string"==typeof t&&(i+=";"+t),i},a.prototype.genClientUrl=function(t){var n=e.result(this.model.prototype,"clientUrlRoot");if(!n)throw new Error("'clientUrlRoot' was not specified");var i=n;return"string"==typeof t&&(i+=";"+t),i},a.prototype.getTopicPrefix=function(){return this.topicPrefix||this.model.prototype.topicPrefix},a.prototype.getPrivilegePrefix=function(){return this.privilegePrefix||this.model.prototype.privilegePrefix},a.prototype.getNlsDomain=function(){return this.nlsDomain||this.model.prototype.nlsDomain},a.prototype.getLabel=function(e,t){if(!e)return"";var n=this.get(e);return n?n.getLabel(t):String(e)},a.prototype.getLabels=function(e,t){return e.map(function(e){return this.getLabel(e,t)},this)},a.prototype.createRqlQuery=function(t){if(e.isString(t))t=n.parse(t);else if(e.isFunction(t)){if((t=t.call(this,n))&&!(t instanceof n.Query))return this.createRqlQuery(t)}else e.isObject(t)&&(t=n.Query.fromObject(t));return t&&!t.isEmpty()?t:e.isString(this.rqlQuery)?n.parse(this.rqlQuery):e.isFunction(this.rqlQuery)?(!(t=this.rqlQuery.call(this,n))||t instanceof n.Query||(t=this.createRqlQuery(t)),t):e.isObject(this.rqlQuery)?n.Query.fromObject(this.rqlQuery):new n.Query},a.prototype.getPaginationData=function(e){return{totalCount:e.totalCount||0,urlTemplate:this.genPaginationUrlTemplate(),skip:this.rqlQuery.skip,limit:this.rqlQuery.limit}},a.prototype.genPaginationUrlTemplate=function(){var e=this.rqlQuery,t=e.skip,n=e.limit;e.skip="${skip}",e.limit="${limit}";var i=this.genClientUrl()+"?"+e.toString();return e.skip=t,e.limit=n,i},a.prototype.onPageChanged=function(e,t){this.rqlQuery.skip=(t-1)*this.rqlQuery.limit,this.fetch({reset:!0})},a.prototype.getDefaultPageLimit=function(){var e=32,t=34;e=this.theadHeight>8?this.theadHeight:32+20*((this.theadHeight||1)-1),"number"==typeof this.rowHeight?t=this.rowHeight>8?this.rowHeight:31+20*(this.rowHeight-1):!1===this.rowHeight&&(t=31);var n=window.innerHeight-99-106-54-e;return Math.max(10,Math.floor(n/t))},a.prototype.findRqlTerm=function(t,n){return e.find(this.rqlQuery.selector.args,function(e){return e.args[0]===t&&(Array.isArray(n)?-1!==n.indexOf(e.name):!n||e.name===n)})},a}),define("app/divisions/Division",["../i18n","../time","../core/Model"],function(e,t,n){"use strict";return n.extend({urlRoot:"/divisions",clientUrlRoot:"#divisions",topicPrefix:"divisions",privilegePrefix:"DICTIONARIES",nlsDomain:"divisions",labelAttribute:"_id",defaults:{type:"prod"},serialize:function(){var n=this.toJSON();return n.type=e("divisions","TYPE:"+n.type),n.deactivatedAt=n.deactivatedAt?t.format(n.deactivatedAt,"LL"):"",n},isActive:function(e){var t=this.get("deactivatedAt");return!t||(e||Date.now())<Date.parse(t)}})}),define("app/divisions/DivisionCollection",["../core/Collection","./Division"],function(e,t){"use strict";return e.extend({model:t,rqlQuery:"sort(_id)",comparator:"_id"})}),define("app/data/createStorage",["app/time","app/broker","app/pubsub","./localStorage"],function(e,t,n,i){"use strict";return n.subscribe("dictionaries.updated",function(e){var n=e.topic,i=e.message,r=e.meta;r.remote=!0,r.json&&"string"==typeof i&&(i=JSON.parse(i)),t.publish(n,i,r)}),function(n,r,o){var a={time:e.appData,data:window[n]||null},s=JSON.parse(i.getItem(n)||'{"time":0,"data":null}'),u=s&&s.time>a.time||!a.data?s:a,c=new o(u.data);function l(){c.updatedAt=Date.now(),i.setItem(n,JSON.stringify({time:c.updatedAt,data:c.models})),t.publish(r+".synced")}return c.updatedAt=u.time,u!==a&&s.data||l(),c.on("add",l),c.on("remove",l),c.on("destroy",l),c.on("change",l),c.on("sync",l),c.on("reset",l),t.subscribe(r+".added",function(e){c.add(e.model)}),t.subscribe(r+".edited",function(e){var t=c.get(e.model._id);t?t.set(e.model):c.add(e.model)}),t.subscribe(r+".deleted",function(e){c.remove(e.model._id)}),c}}),define("app/data/divisions",["app/divisions/DivisionCollection","./createStorage"],function(e,t){"use strict";return t("DIVISIONS","divisions",e)}),define("app/core/util/colorLabel",[],function(){"use strict";var e={};function t(t){if(void 0!==e[t])return e[t];var n=0,i=0,r=0,o=t.match(/^#([a-fA-F0-9]{3,6})$/);if(o){var a=o[1];3===a.length?(n=a.substr(0,1),i=a.substr(1,1),r=a.substr(2,1),n+=n,i+=i,r+=r):(n=a.substr(0,2),i=a.substr(2,2),r=a.substr(4,2)),n=parseInt(n,16),i=parseInt(i,16),r=parseInt(r,16)}else(o=t.match(/([0-9]+).*?([0-9]+).*?([0-9]+)/))&&(n=parseInt(o[1],10),i=parseInt(o[2],10),r=parseInt(o[3],10));return e[t]=1-(.299*n+.587*i+.114*r)/255<.3,e[t]}function n(e){"string"==typeof e&&(e={color:e});var n=["label","color"];e.className&&(n=n.concat(e.className));var i=e.title||"",r=e.color.toUpperCase(),o=e.label||r;return t(r)&&n.push("is-contrast"),'<span class="'+n.join(" ")+'" title="'+i+'" style="background: '+r+'">'+o+"</span>"}return n.requiresContrast=t,n}),define("app/aors/Aor",["../core/Model","app/core/util/colorLabel"],function(e,t){"use strict";return e.extend({urlRoot:"/aors",clientUrlRoot:"#aors",topicPrefix:"aors",privilegePrefix:"DICTIONARIES",nlsDomain:"aors",labelAttribute:"name",defaults:{name:null,description:null,color:"#f08f44",refColor:"#ffa85c",refValue:0},serialize:function(){var e=this.toJSON();return e.color=t(e.color),e.refColor=t(e.refColor),e.refValue=e.refValue&&e.refValue.toLocaleString?e.refValue.toLocaleString():"0",e}})}),define("app/aors/AorCollection",["../core/Collection","./Aor"],function(e,t){"use strict";return e.extend({model:t,rqlQuery:"sort(name)",comparator:"name"})}),define("app/data/aors",["app/aors/AorCollection","./createStorage"],function(e,t){"use strict";return t("AORS","aors",e)}),define("app/downtimeReasons/DowntimeReason",["../i18n","../core/Model","../data/aors","app/core/util/colorLabel"],function(e,t,n,i){"use strict";var r=["assembly","press","paintShop","wh-pickup","wh-dist"];return t.extend({urlRoot:"/downtimeReasons",clientUrlRoot:"#downtimeReasons",topicPrefix:"downtimeReasons",privilegePrefix:"DICTIONARIES",nlsDomain:"downtimeReasons",labelAttribute:"label",defaults:function(){return{label:null,type:"other",subdivisionTypes:r,opticsPosition:-1,pressPosition:-1,auto:!1,scheduled:!1,color:"#ff0000",refColor:"#aa0000",refValue:0,aors:[],defaultAor:!1}},serialize:function(){var t=this.nlsDomain,r=this.toJSON();return r.scheduled=e("core","BOOL:"+r.scheduled),r.auto=e("core","BOOL:"+r.auto),r.type=e(t,"type:"+r.type),r.color=i(r.color),r.refColor=i(r.refColor),r.refValue=r.refValue&&r.refValue.toLocaleString?r.refValue.toLocaleString():"0",r.subdivisionTypes&&r.subdivisionTypes.length?r.subdivisionTypes=r.subdivisionTypes.map(function(n){return e(t,"subdivisionType:"+n)}).join("; "):r.subdivisionTypes=e(t,"subdivisionType:none"),r.aors=r.aors.map(function(e){var t=n.get(e);return t?t.getLabel():e}),r.defaultAor=e("core","BOOL:"+r.defaultAor),r},serializeRow:function(){var t=this.serialize();return t.aors=t.aors.length?t.aors.join("; "):e(this.nlsDomain,"aors:all"),t}},{SUBDIVISION_TYPES:r})}),define("app/downtimeReasons/DowntimeReasonCollection",["underscore","../core/Collection","./DowntimeReason"],function(e,t,n){"use strict";return t.extend({model:n,rqlQuery:"sort(_id)",comparator:"_id",findBySubdivisionType:function(t){return Array.isArray(t)?this.filter(function(n){return e.some(n.get("subdivisionTypes"),function(n){return e.includes(t,n)})}):this.filter(function(e){return-1!==e.get("subdivisionTypes").indexOf(t)})},findFirstBreakIdBySubdivisionType:function(e){var t=this.find(function(t){return"break"===t.get("type")&&-1!==t.get("subdivisionTypes").indexOf(e)});return t?t.id:null}})}),define("app/data/downtimeReasons",["app/downtimeReasons/DowntimeReasonCollection","./createStorage"],function(e,t){"use strict";return t("DOWNTIME_REASONS","downtimeReasons",e)}),define("app/subdivisions/Subdivision",["underscore","app/i18n","app/time","app/data/aors","app/data/downtimeReasons","app/data/divisions","app/core/Model"],function(e,t,n,i,r,o,a){"use strict";return a.extend({urlRoot:"/subdivisions",clientUrlRoot:"#subdivisions",topicPrefix:"subdivisions",privilegePrefix:"DICTIONARIES",nlsDomain:"subdivisions",labelAttribute:"name",defaults:function(){return{division:null,type:"assembly",name:null,prodTaskTags:null,aor:null,autoDowntimes:[],deactivatedAt:null}},serialize:function(a){var s=this.toJSON(),u=o.get(s.division);u&&(s.division=a&&a.renderOrgUnitPath?a.renderOrgUnitPath(u,!0,!1):u.getLabel()),s.deactivatedAt=s.deactivatedAt?n.format(s.deactivatedAt,"LL"):"",s.type=t("subdivisions","TYPE:"+s.type),s.prodTaskTags=s.prodTaskTags&&s.prodTaskTags.length?s.prodTaskTags.join("; "):null;var c=i.get(s.aor);return s.aor=c?c.getLabel():"",s.autoDowntimes=e.map(s.autoDowntimes,function(e){var t=r.get(e.reason);return t?{reason:t.getLabel(),when:e.when,time:(e.time||[]).map(function(e){return{d:e.d,h:(e.h<10?"0":"")+e.h,m:(e.m<10?"0":"")+e.m}})}:null}).filter(function(e){return!!e}),s},serializeRow:function(e){var t=this.serialize(e);return t.autoDowntimes=0===t.autoDowntimes.length?"":t.autoDowntimes.map(function(e){return e.reason}).join("; "),t},isActive:function(e){var t=this.get("deactivatedAt");return!t||(e||Date.now())<Date.parse(t)},getSubdivision:function(){return this}})}),define("app/subdivisions/SubdivisionCollection",["../core/Collection","./Subdivision"],function(e,t){"use strict";return e.extend({model:t,rqlQuery:"sort(division,name)",comparator:"division"})}),define("app/data/subdivisions",["app/subdivisions/SubdivisionCollection","./createStorage"],function(e,t){"use strict";return t("SUBDIVISIONS","subdivisions",e)}),define("app/core/views/DialogView",["underscore","../View"],function(e,t){"use strict";return t.extend({events:{"click .dialog-answer":function(t){var n=this.$(t.target).closest(".dialog-answer").attr("data-answer");e.isString(n)&&n.length>0&&(this.disableAnswers(),this.trigger("answered",n),!1!==this.options.autoHide&&e.isFunction(this.closeDialog)&&this.closeDialog())}},serialize:function(){return e.assign(t.prototype.serialize.apply(this,arguments),this.model)},onDialogShown:function(e){this.closeDialog=e.closeDialog.bind(e)},disableAnswers:function(){this.$(".btn[data-answer]").prop("disabled",!0)},enableAnswers:function(){this.$(".btn[data-answer]").prop("disabled",!1)},closeDialog:function(){}})}),define("app/core/util/getShiftStartInfo",["app/time"],function(e){"use strict";return function(t,n){var i=n&&n.shiftLength||8,r=n&&"number"==typeof n.startHour?n.startHour:6,o=(n&&n.utc?e.utc:e).getMoment(t),a=o.valueOf(),s=1,u=24/i;for(o.hours()<r&&o.subtract(24,"hours"),o.hours(r).startOf("hours");s<=u;++s){var c=o.valueOf(),l=o.hours()+i;l>=24&&(l-=24),o.add(i,"hours");var d=o.hours();d!==l&&o.add(l-d,"hours");var p=o.valueOf();if(a>=c&&a<p)return{moment:e.getMoment(c),no:s,startTime:c,endTime:p,startHour:r,length:i,count:u}}throw new Error("Could not resolve the shift start info!")}}),define("app/core/templates/forms/dateTimeRange",["underscore","jquery","app/i18n","app/time","app/user","app/core/util/forms"],function(_,$,t,time,user,forms){return function anonymous(locals,escapeFn,include,rethrow){escapeFn=escapeFn||function(e){return void 0==e?"":String(e).replace(_MATCH_HTML,encode_char)};var _ENCODE_HTML_RULES={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&#34;","'":"&#39;"},_MATCH_HTML=/[&<>'"]/g;function encode_char(e){return _ENCODE_HTML_RULES[e]||e}var __output="";function __append(e){void 0!==e&&null!==e&&(__output+=e)}with(locals||{})formGroup&&(__append('\n<div class="form-group '),__append(hidden?"hidden":""),__append('" data-filter="'),__append(property),__append('">\n')),__append('\n<div id="'),__append(idPrefix),__append("-dateTimeRange-"),__append(property),__append('" class="dateTimeRange" data-property="'),__append(property),__append('" data-utc="'),__append(utc),__append('" data-set-time="'),__append(setTime),__append('" data-type="'),__append(type),__append('" data-start-hour="'),__append(startHour),__append('" data-shift-length="'),__append(shiftLength),__append('">\n  <div class="dateTimeRange-labels '),__append(labels.length>maxLabels?"dateTimeRange-labels-overflow":""),__append('">\n    '),labels.forEach(function(e,n){__append('\n    <div class="dateTimeRange-label '),__append(e.dropdown||e.ranges?"dropdown":""),__append(" "),__append(e.value?"dateTimeRange-is-input":""),__append(" "),__append(labels.length>maxLabels&&n>0?"hidden":""),__append('">\n      <label\n        class="control-label '),__append(e.dropdown||e.ranges?"dropdown-toggle":""),__append('"\n        '),__append(e.dropdown||e.ranges?'data-toggle="dropdown"':""),__append("\n        "),e.value&&(__append('for="'),__append(idPrefix),__append("-"),__append(labelProperty),__append("-"),__append(e.value),__append('"')),__append("\n      >\n        "),e.value&&(__append('\n        <input id="'),__append(idPrefix),__append("-"),__append(labelProperty),__append("-"),__append(e.value),__append('" class="dateTimeRange-label-input" type="radio" name="'),__append(labelProperty),__append('" value="'),__append(e.value),__append('" data-utc="'),__append(e.utc?1:0),__append('">\n        ')),__append("\n        "),__append(e.text),__append("\n        "),(e.dropdown||e.ranges)&&__append('<span class="caret"></span>'),__append("\n      </label>\n      "),e.ranges?(__append("\n      "),ranges=Object.keys(e.ranges),__append('\n        <div class="dropdown-menu dateTimeRange-ranges">\n          '),labels.length>maxLabels&&(__append('\n          <div class="dateTimeRange-ranges-labels">\n            '),labels.forEach(function(t){__append("\n            <a "),t!==e&&__append('href="javascript:void(0)"'),__append(' data-label-value="'),__append(t.value),__append('">'),__append(t.text),__append("</a>\n            ")}),__append("\n          </div>\n          ")),__append('\n          <table class="dateTimeRange-ranges-table">\n            '),ranges.forEach(function(n,i){__append("\n            <tr>\n              <th>"),__append(t("core","dateTimeRange:"+n)),__append("</th>\n              "),e.ranges[n].forEach(function(e,i){__append("\n              <td>\n                "),e&&(__append('\n                <a href="javascript:void(0)" data-date-time-group="'),__append(n),__append('" data-date-time-range="'),__append(e),__append('">\n                  '),t.has("core","dateTimeRange:"+n+":"+e)?(__append("\n                  "),__append(t("core","dateTimeRange:"+n+":"+e)),__append("\n                  ")):t.has("core","dateTimeRange:"+e)?(__append("\n                  "),__append(t("core","dateTimeRange:"+e)),__append("\n                  ")):(__append("\n                  "),__append(e),__append("\n                  ")),__append("\n                </a>\n                ")),__append("\n              </td>\n              ")}),__append("\n            </tr>\n            ")}),__append('\n            <tr>\n              <td colspan="999" class="dateTimeRange-help">'),__append(t("core","dateTimeRange:help")),__append("</td>\n            </tr>\n          </table>\n        </div>\n      ")):e.dropdown&&(__append('\n      <ul class="dropdown-menu">\n        '),e.dropdown.forEach(function(e){__append("\n        <li><a "),__append(e.attrs),__append(">"),__append(e.text),__append("</a></li>\n        ")}),__append("\n      </ul>\n      ")),__append("\n    </div>\n    ")}),__append('\n  </div>\n  <div class="dateTimeRange-fields">\n    <div class="dateTimeRange-field dateTimeRange-from">\n      '),/date|month/.test(type)&&(__append('\n        <input id="'),__append(idPrefix),__append('-from-date" name="from-date" class="form-control" type="'),__append(/month/.test(type)?"month":"date"),__append('" placeholder="'),__append(t("core","dateTimeRange:placeholder:date")),__append('" min="'),__append(minDate),__append('" max="'),__append(maxDate),__append('" '),__append(required.date[0]?"required":""),__append(">\n      ")),__append("\n      "),/time/.test(type)&&(__append('\n      <input id="'),__append(idPrefix),__append('-from-time" name="from-time" class="form-control" type="time" placeholder="'),__append(t("core","dateTimeRange:placeholder:time")),__append('" '),__append(required.time[0]?"required":""),__append(">\n      ")),__append('\n    </div>\n    <div class="dateTimeRange-separator">'),__append(separator),__append('</div>\n    <div class="dateTimeRange-field dateTimeRange-to">\n      '),/date|month/.test(type)&&(__append('\n      <input id="'),__append(idPrefix),__append('-to-date" name="to-date" class="form-control" type="'),__append(/month/.test(type)?"month":"date"),__append('" placeholder="'),__append(t("core","dateTimeRange:placeholder:date")),__append('" min="'),__append(minDate),__append('" max="'),__append(maxDate),__append('" '),__append(required.date[1]?"required":""),__append(">\n      ")),__append("\n      "),/time/.test(type)&&(__append('\n      <input id="'),__append(idPrefix),__append('-to-time" name="to-time" class="form-control" type="time" placeholder="'),__append(t("core","dateTimeRange:placeholder:time")),__append('" '),__append(required.time[1]?"required":""),__append(">\n      ")),__append("\n    </div>\n  </div>\n</div>\n"),formGroup&&__append("\n</div>\n"),__append("\n");return __output}}),define("app/core/util/forms/dateTimeRange",["underscore","jquery","app/i18n","app/time","app/core/util/getShiftStartInfo","app/core/templates/forms/dateTimeRange"],function(e,t,n,i,r,o){"use strict";var a={date:"YYYY-MM-DD",month:"YYYY-MM","date+time":"YYYY-MM-DD",time:"HH:mm:ss"},s={shifts:["+0+1","-1+0","1","2","3"],days:["+0+1","-1+0","-7+0","-14+0","-28+0"],weeks:["+0+1","-1+0","-2+0","-3+0","-4+0"],months:["+0+1","-1+0","-2+0","-3+0","-6+0"],quarters:["+0+1","1","2","3","4",null],years:["+0+1","-1+0",null,null,null]},u=!1;function c(e){var n=e.currentTarget,i=document.getElementById(n.htmlFor);i&&requestAnimationFrame(function(){i.disabled||t(i).prop("checked",!0).trigger("change")})}function l(e){if("Escape"===e.key)return e.currentTarget.value="",!1}function d(r){u||(t(document).on("click",".dateTimeRange-is-input > .dropdown-toggle",c).on("keyup",".dateTimeRange-field > .form-control",l),u=!0);var f=r.type||"date",h={idPrefix:r.idPrefix||"v",property:r.property||"date",formGroup:!1!==r.formGroup,hidden:!0===r.hidden,utc:r.utc?1:0,setTime:!1!==r.setTime?1:0,type:f,startHour:r.startHour||0,shiftLength:r.shiftLength||8,minDate:r.minDate||window.PRODUCTION_DATA_START_DATE||"",maxDate:""===r.maxDate?"":r.maxDate||i.getMoment().add(1,"years").format(a[f]),labelProperty:r.labelProperty||"dateFilter",labels:[],maxLabels:2,separator:r.separator||"–",required:{date:[!1,!1],time:[!1,!1]}};if(r.required){var m=h.required;"boolean"==typeof r.required?(m.date=[r.required,r.required],m.time=[r.required,r.required]):Array.isArray(r.required)?(m.date=[!!r.required[0],!!r.required[1]],m.time=[!!r.required[0],!!r.required[1]]):(Array.isArray(r.required.date)?m.date=[!!r.required.date[0],!!r.required.date[1]]:m.date=[!!r.required.date,!!r.required.date],Array.isArray(r.required.time)?m.time=[!!r.required.time[0],!!r.required.time[1]]:m.time=[!!r.required.time,!!r.required.time])}if(r.labels?Array.isArray(r.labels)?h.labels=[].concat(r.labels):h.labels.push(r.labels):h.labels.push({ranges:!0}),h.labels=h.labels.map(function(t){return{text:t.text||n("core","dateTimeRange:label:"+h.type),dropdown:function(e){return Array.isArray(e.dropdown)?e.dropdown.map(function(e){return"object"==typeof e.attrs&&(e.attrs=Object.keys(e.attrs).map(function(t){return t+'="'+e.attrs[t]+'"'}).join(" ")),e}):null}(t),value:t.value||null,ranges:function(t){if(!0===t.ranges&&(t.ranges=""),"string"!=typeof t.ranges)return null;var n={shifts:!1,days:!0,weeks:!0,months:!0,quarters:!0,years:!0};t.ranges.split(" ").some(function(e){return/^[^+\-]/.test(e)})&&Object.keys(n).forEach(function(e){n[e]=!1});var i=e.assign({},s);return t.ranges.split(" ").forEach(function(e){var t="-"===e.charAt(0)?"-":"+",r=e.replace(/^[^a-z]+/,"").split(":"),o=r.shift(),a=r.length?r[0].split("_"):[];n[o]="+"===t,a.length&&(i[o]=a)}),Object.keys(n).forEach(function(e){i[e]&&n[e]?n[e]=i[e]:delete n[e]}),n}(t),utc:null==t.utc?r.utc:t.utc?1:0}}),h.labels.length>h.maxLabels){var g=h.idPrefix+"-dateTimeRange-"+h.property;requestAnimationFrame(function(){t("#"+g).on("click","a[data-label-value]",p),d.toggleLabel(g)})}return o(h)}function p(e){var n=t(e.currentTarget).closest(".dateTimeRange-labels"),i=e.currentTarget.dataset.labelValue,r=n.find('.dateTimeRange-label-input[value="'+i+'"]');return r.prop("checked",!0),d.toggleLabel(n.closest(".dateTimeRange").prop("id")),r.closest(".dropdown-toggle").click(),!1}return d.handleRangeEvent=function(e){var t=this.$(e.target).closest("a[data-date-time-range]"),n=t.closest(".dateTimeRange"),i=n[0].dataset.type,o="1"===n[0].dataset.utc,s=+n[0].dataset.startHour,u=+n[0].dataset.shiftLength,c=t[0].dataset.dateTimeGroup,l=t[0].dataset.dateTimeRange,d=c,p=1,f=r(Date.now(),{utc:o,startHour:s,shiftLength:u}),h=f.moment,m=null;if(h.hours()<s&&h.subtract(24,"hours"),"shifts"===c?(d="hours",p=u):h.startOf("day"),/^[0-9]+$/.test(l))"shifts"===c?(h.subtract((f.no-1)*f.length,"hours").add((+l-1)*f.length,"hours"),m=h.clone().add(f.length,"hours")):("0"===l?h.startOf(d):h.startOf("year").add(l-1,d),m=h.clone().add(1,d));else{var g=l.match(/^([+-])([0-9]+)([+-])([0-9]+)$/)||[0,"+","0","+","1"];m=h.startOf(d).clone()["+"===g[3]?"add":"subtract"](+g[4]*p,d),h=h["+"===g[1]?"add":"subtract"](+g[2]*p,d)}"shifts"!==c&&(h.hours(s),m.hours(s));var v=a[i];n.find('input[name="from-date"]').val(h.format(v)).trigger("change"),n.find('input[name="from-time"]').val(h.format("HH:mm:ss")).trigger("change"),n.find('input[name="to-date"]').val(m.format(v)).trigger("change"),n.find('input[name="to-time"]').val(m.format("HH:mm:ss")).trigger("change");var y=this.$('[name="interval"]');if(y.length){var _={},b=[];y.each(function(){this.disabled||this.parentNode.classList.contains("disabled")||(_[this.value]=this,b.push(this.value))});var w=function(e,t){var n=36e5;if(e<=8*n)return"hour";var i=24*n;if(e<=9e7)return"shift";if("weeks"===t&&e>11988e5&&e<=243e7)return"week";var r=31*i;return e<=26892e5?"day":e<2.5*r?"week":e>12*r?"year":"month"}(m.valueOf()-h.valueOf(),c);_[w]||(w=b[b.length-1]),w&&y.filter('[value="'+w+'"]').parent().click()}e.altKey&&this.$('[type="submit"]').click()},d.serialize=function(e){var t=e.$(".dateTimeRange"),n=t.find(".dateTimeRange-label-input:checked"),r=n.length?n.val():t[0].dataset.property,o=Object.assign({},t[0].dataset,n.prop("dataset")),s=o.type,u=a[s],c="1"===o.utc,l="1"===o.setTime,d=o.startHour,p=t.find('input[name="from-date"]'),f=t.find('input[name="from-time"]'),h=t.find('input[name="to-date"]'),m=t.find('input[name="to-time"]'),g=p.val(),v=f.val(),y=h.val(),_=m.val();(!p.length||g.length<7)&&(g="1970-01-01"),(!h.length||y.length<7)&&(y="1970-01-01"),7===g.length&&(g+="-01"),7===y.length&&(y+="-01");var b=l?(1===d.length?"0":"")+d+":00":"00:00:00";(!f.length||v.length<5)&&(v=b),(!m.length||_.length<5)&&(_=b),5===v.length&&(v+=":00"),5===_.length&&(_+=":00");var w=(c?i.utc:i).getMoment(g+" "+v,"YYYY-MM-DD HH:mm:ss"),A=(c?i.utc:i).getMoment(y+" "+_,"YYYY-MM-DD HH:mm:ss");return k(w)?(p.val(""),f.val(""),w=null):(p.val(w.format(u)),f.val(w.format("HH:mm:ss"))),k(A)?(h.val(""),m.val(""),A=null):(h.val(A.format(u)),m.val(A.format("HH:mm:ss"))),{property:r,from:w,to:A};function k(e){return!e.isValid()||"time"!==s&&1970===e.year()}},d.formToRql=function(e,t){var n=d.serialize(e);n.from&&t.push({name:"ge",args:[n.property,n.from.valueOf()]}),n.to&&t.push({name:"lt",args:[n.property,n.to.valueOf()]})},d.rqlToForm=function(e,t,n){var r,o=this.$(".dateTimeRange"),s=o.find(".dateTimeRange-label-input").first().prop("name"),u=o[0].dataset,c=this.$id(s+"-"+e).prop("dataset")||{},l=a[c.type||u.type],d=((null==c.utc?"1"===u.utc:"1"===c.utc)?i.utc:i).getMoment(t.args[1]);"ge"===t.name||"gt"===t.name?r="from":"le"!==t.name&&"lt"!==t.name||(r="to"),r&&d.isValid()&&(s&&(n[s]=e),n[r+"-date"]=d.format(l),n[r+"-time"]=d.format("HH:mm:ss"))},d.toggleLabel=function(e){var n=("string"==typeof e?t("#"+e):e.$(".dateTimeRange").first()).find(".dateTimeRange-labels");n.hasClass("dateTimeRange-labels-overflow")&&n.find(".dateTimeRange-label").each(function(){this.classList.toggle("hidden",!t(this).find(".dateTimeRange-label-input").prop("checked"))})},d}),define("app/core/util/forms",["./forms/dateTimeRange","./forms/formGroup"],function(e,t){"use strict";return{dateTimeRange:e,formGroup:t}}),define("app/core/templates/embedded/appsDialog",["underscore","jquery","app/i18n","app/time","app/user","app/core/util/forms"],function(_,$,t,time,user,forms){return function anonymous(locals,escapeFn,include,rethrow){escapeFn=escapeFn||function(e){return void 0==e?"":String(e).replace(_MATCH_HTML,encode_char)};var _ENCODE_HTML_RULES={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&#34;","'":"&#39;"},_MATCH_HTML=/[&<>'"]/g;function encode_char(e){return _ENCODE_HTML_RULES[e]||e}var __output="";function __append(e){void 0!==e&&null!==e&&(__output+=e)}with(locals||{})__append('<div class="embedded-appsDialog-apps" style="margin-top: -'),__append(71*apps.length/2),__append('px">\n  '),apps.forEach(function(e){__append('\n  <button data-app="'),__append(e),__append('" class="btn btn-default btn-block">'),__append(t("core","embedded:apps:"+e)),__append("</button>\n  ")}),__append("\n</div>\n");return __output}}),define("app/core/templates/embedded/confirmDialog",["underscore","jquery","app/i18n","app/time","app/user","app/core/util/forms"],function(_,$,t,time,user,forms){return function anonymous(locals,escapeFn,include,rethrow){escapeFn=escapeFn||function(e){return void 0==e?"":String(e).replace(_MATCH_HTML,encode_char)};var _ENCODE_HTML_RULES={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&#34;","'":"&#39;"},_MATCH_HTML=/[&<>'"]/g;function encode_char(e){return _ENCODE_HTML_RULES[e]||e}var __output="";function __append(e){void 0!==e&&null!==e&&(__output+=e)}with(locals||{})__append("<div>\n  "),__append(t("core","embedded:"+action+":message")),__append('\n  <div class="form-actions">\n    <button class="btn btn-lg btn-danger dialog-answer" type="button" autofocus data-answer="yes">'),__append(t("core","embedded:"+action+":yes")),__append('</button>\n    <button class="btn btn-lg btn-link cancel" type="button">'),__append(t("core","embedded:"+action+":no")),__append("</button>\n  </div>\n</div>\n");return __output}}),define("app/core/templates/embedded/uiLock",["underscore","jquery","app/i18n","app/time","app/user","app/core/util/forms"],function(_,$,t,time,user,forms){return function anonymous(locals,escapeFn,include,rethrow){escapeFn=escapeFn||function(e){return void 0==e?"":String(e).replace(_MATCH_HTML,encode_char)};var _ENCODE_HTML_RULES={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&#34;","'":"&#39;"},_MATCH_HTML=/[&<>'"]/g;function encode_char(e){return _ENCODE_HTML_RULES[e]||e}var __output="";function __append(e){void 0!==e&&null!==e&&(__output+=e)}with(locals||{})__append('<div class="embedded-uiLock">\n  <div class="embedded-uiLock-inner">\n    <i class="fa fa-unlock"></i>\n    <p>'),__append(t("core","embedded:lockUi:message")),__append("</p>\n  </div>\n</div>\n");return __output}}),define("app/core/templates/embedded/actions",["underscore","jquery","app/i18n","app/time","app/user","app/core/util/forms"],function(_,$,t,time,user,forms){return function anonymous(locals,escapeFn,include,rethrow){escapeFn=escapeFn||function(e){return void 0==e?"":String(e).replace(_MATCH_HTML,encode_char)};var _ENCODE_HTML_RULES={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&#34;","'":"&#39;"},_MATCH_HTML=/[&<>'"]/g;function encode_char(e){return _ENCODE_HTML_RULES[e]||e}var __output="";function __append(e){void 0!==e&&null!==e&&(__output+=e)}with(locals||{})__append('<div class="dropup embedded-actions '),__append(left?"embedded-left":"embedded-right"),__append('" data-app="'),__append(app),__append('">\n  '),_.forEach(actions,function(e,t){__append('\n  <button data-action="'),__append(t),__append('" class="btn btn-default btn-lg '),__append(e.separator?"embedded-separator":""),__append('" type="button" title="'),__append(e.title||""),__append('">\n    <i class="fa '),__append(e.icon||"fa-question"),__append('"></i>\n  </button>\n  ')}),__append('\n  <button data-action="switch" class="btn btn-default btn-lg" type="button" title="'),__append(t("core","embedded:actions:switch")),__append('">\n    <i class="fa fa-window-restore"></i>\n  </button>\n  <button class="btn btn-default btn-lg dropdown-toggle" type="button" data-toggle="dropdown">\n    <i class="fa fa-cogs"></i>\n  </button>\n  <ul class="dropdown-menu '),__append(left?"":"dropdown-menu-right"),__append('">\n    <li><a data-action="switch"><i class="fa fa-window-restore"></i><span>'),__append(t("core","embedded:actions:switch")),__append('</span></a></li>\n    <li><a data-action="refresh"><i class="fa fa-refresh"></i><span>'),__append(t("core","embedded:actions:refresh")),__append('</span></a></li>\n    <li><a data-action="config"><i class="fa fa-wrench"></i><span>'),__append(t("core","embedded:actions:config")),__append('</span></a></li>\n    <li><a data-action="reboot"><i class="fa fa-undo"></i><span>'),__append(t("core","embedded:actions:reboot")),__append('</span></a></li>\n    <li><a data-action="shutdown"><i class="fa fa-power-off"></i><span>'),__append(t("core","embedded:actions:shutdown")),__append('</span></a></li>\n    <li class="dev hidden"><a data-action="restartBrowser"><i class="fa"></i><span>'),__append(t("core","embedded:actions:restartBrowser")),__append('</span></a></li>\n    <li class="dev hidden"><a data-action="resetBrowser"><i class="fa"></i><span>'),__append(t("core","embedded:actions:resetBrowser")),__append('</span></a></li>\n    <li class="dev hidden"><a data-action="noKiosk"><i class="fa"></i><span>'),__append(t("core","embedded:actions:noKiosk")),__append("</span></a></li>\n  </ul>\n</div>\n");return __output}}),define("app/core/util/embedded",["require","jquery","app/i18n","app/viewport","app/data/localStorage","app/core/View","app/core/views/DialogView","app/core/templates/embedded/appsDialog","app/core/templates/embedded/confirmDialog","app/core/templates/embedded/uiLock","app/core/templates/embedded/actions"],function(e,t,n,i,r,o,a,s,u,c,l){"use strict";var d=window.IS_EMBEDDED||window.parent!==window||-1!==window.location.href.indexOf("_embedded=1"),p=null;return window.addEventListener("message",function(t){var n=t.data||{data:{}};switch(n.type){case"apps":i=n.data,clearTimeout(p),i&&Array.isArray(i.apps)&&0!==i.apps.length&&(1===i.apps.length?window.parent.postMessage({type:"switch",app:window.WMES_APP_ID},"*"):(r=i.apps,(a=e("app/viewport")).showDialog(new o({events:{"click [data-app]":function(e){a.closeAllDialogs(),window.parent.postMessage({type:"switch",app:window.WMES_APP_ID,newApp:e.currentTarget.dataset.app},"*")}},dialogClassName:"embedded-appsDialog",template:s,getTemplateData:function(){return{apps:r}}}))))}var i,r,a}),{actions:{switch:function(){window.parent.postMessage({type:"apps"},"*"),p&&clearTimeout(p),p=setTimeout(function(){window.parent.postMessage({type:"switch",app:window.WMES_APP_ID},"*")},250)},config:function(){window.parent.postMessage({type:"config"},"*")},refresh:function(){window.parent.postMessage({type:"refresh"},"*")},resetBrowser:function(){window.parent.postMessage({type:"resetBrowser"},"*")},restartBrowser:function(){window.parent.postMessage({type:"restartBrowser"},"*")},noKiosk:function(){window.parent.postMessage({type:"noKiosk"},"*")},reboot:function(){var t=new a({dialogClassName:"embedded-confirmDialog",template:u,model:{action:"reboot"}});t.once("answered",function(e){"yes"===e&&window.parent.postMessage({type:"reboot"},"*")}),e("app/viewport").showDialog(t,n("core","embedded:reboot:title"))},shutdown:function(){var t=new a({dialogClassName:"embedded-confirmDialog",template:u,model:{action:"shutdown"}});t.once("answered",function(e){"yes"===e&&window.parent.postMessage({type:"shutdown"},"*")}),e("app/viewport").showDialog(t,n("core","embedded:shutdown:title"))},lockUi:function(){var e=t(".embedded-uiLock");e.length||((e=t(c()).appendTo(document.body)).find("div").on("click",function(){r.removeItem("WMES_EMBEDDED_UI_LOCKED"),e.remove()}),e.on("touchstart",function(e){if(!t(e.target).closest(".embedded-uiLock-inner").length)return!1}),e.appendTo("body"),r.setItem("WMES_EMBEDDED_UI_LOCKED","1"))}},isEnabled:function(){return d},ready:function(e){d&&window.parent.postMessage({type:"ready",app:e||window.WMES_APP_ID},"*")},render:function(e,i){if(d){var o=0,a=null,s=Object.assign({},i&&i.actions);s.lockUi&&("object"!=typeof s.lockUi&&(s.lockUi={}),s.lockUi=Object.assign({icon:"fa-lock",handler:this.actions.lockUi,title:n("core","embedded:actions:lockUi")},s.lockUi),"1"===r.getItem("WMES_EMBEDDED_UI_LOCKED")&&(e.timers.lockUi=setTimeout(s.lockUi.handler,1)));var u=t(l({app:window.WMES_APP_ID,left:i&&!0===i.left,actions:s})),c=Object.assign({},this.actions,s);u.on("click","[data-action]",function(t){var n=c[t.currentTarget.dataset.action];n&&("function"==typeof n.handler?n.handler(e,n):"function"==typeof n&&n(e,n)),t.preventDefault()}),u.on("show.bs.dropdown",function(){o+=1,clearTimeout(a),a=setTimeout(function(){o=0},2e3),p(o<3)}),u.on("hidden.bs.dropdown",function(){p(!0)}),t(".embedded-actions").remove(),t(".modal.fade").removeClass("fade"),(i&&i.container||e.$el).append(u)}function p(e){u.find(".dev").toggleClass("hidden",e)}}}}),define("app/user",["underscore","app/i18n","app/broker","app/socket","app/data/divisions","app/data/subdivisions","app/core/util/embedded"],function(e,t,n,i,r,o,a){"use strict";var s=[],u=0,c={};i.on("user.reload",function(e){c.reload(e)}),i.on("user.deleted",function(){window.location.reload()});var l=e.assign(window.GUEST_USER||{},{name:t.bound("core","GUEST_USER_NAME")});return delete window.GUEST_USER,c.idProperty="id",c.data=l,c.lang=window.APP_LOCALE||window.appLocale||"pl",c.noReload=!1,c.isReloadLocked=function(){return s.length>0},c.lockReload=function(){return s.push(++u)},c.unlockReload=function(e){s=s.filter(function(t){return t!==e})},c.reload=function(i){i||(i={}),!1===i.loggedIn&&(i.name=t("core","GUEST_USER_NAME")),"unspecified"===i.orgUnitType&&(i.orgUnitType=null,i.orgUnitId=null);var r=e.omit(i,["privilegesMap","privilegesString"]),o=e.omit(c.data,["privilegesMap","privilegesString"]);if(!e.isEqual(r,o)){var a=c.isLoggedIn();Object.keys(i).length>0&&(c.data=i),c.data.privilegesMap=null,c.noReload?c.noReload=!1:n.publish("user.reloaded"),a&&!c.isLoggedIn()?n.publish("user.loggedOut"):!a&&c.isLoggedIn()&&n.publish("user.loggedIn")}},c.isLoggedIn=function(){return!0===c.data.loggedIn},c.getLabel=function(e){return c.data.name?String(c.data.name):c.data.lastName&&c.data.firstName?c.data.lastName===c.data.firstName?c.data.lastName:e?c.data.firstName+" "+c.data.lastName:c.data.lastName+" "+c.data.firstName:c.data.login},c.getInfo=function(){var e={};return e[c.idProperty]=c.data._id,e.ip=c.data.ip||c.data.ipAddress||"0.0.0.0",e.cname=window.COMPUTERNAME,e.label=c.getLabel(),c.getInfo.decorators.forEach(function(t){t(e,c.data)}),e},c.getInfo.decorators=[],c.isAllowedTo=function(e){if(!1===c.data.active)return!1;if(c.data.super)return!0;if(!c.data.privileges)return!1;var t=Array.prototype.slice.call(arguments),n=(1===t.length?[e]:t).map(function(e){return Array.isArray(e)?e:[e]}),i=c.isLoggedIn();if(!n.length)return i;for(var r=0,o=n.length;r<o;++r){for(var s=n[r],u=0,l=s.length,d=0;d<l;++d){var p=s[d],f=typeof p;if("function"===f)u+=p()?1:0;else if("string"!==f)l-=1;else if("USER"===p)u+=i?1:0;else if("LOCAL"===p)u+=c.data.local?1:0;else if("EMBEDDED"===p)u+=a.isEnabled()?1:0;else if(/^FN:/.test(p)){var h=p.substring(3);if(-1!==h.indexOf("*"))u+=new RegExp("^"+h.replace(/\*/g,".*?")+"$").test(c.data.prodFunction)?1:0;else u+=c.data.prodFunction===h?1:0}else u+=c.hasPrivilege(s[d])?1:0}if(u===l)return!0}return!1},c.hasAccessToAor=function(e){return!e||c.data.super||!c.data.aors||!c.data.aors.length||-1!==c.data.aors.indexOf(e)},c.hasAccessToSubdivision=function(e){if(!e)return!0;if("division"===c.data.orgUnitType){var t=o.get(e);return t&&c.data.orgUnitId===t.get("division")}return"subdivision"!==c.data.orgUnitType||c.data.orgUnitId===e},c.auth=function(){var e=Array.prototype.slice.call(arguments);return function(t,n,i){c.isAllowedTo.apply(c,e)?i():c.isLoggedIn()?require(["app/viewport","app/core/pages/ErrorPage"],function(e,i){e.showPage(new i({model:{code:403,req:t,previousUrl:n}}))}):require(["app/viewport","app/users/pages/LogInFormPage"],function(e,t){e.showPage(new t)})}},c.getDivision=function(){var e=null;switch(c.data.orgUnitType){case"division":e=c.data.orgUnitId;break;case"subdivision":var t=o.get(c.data.orgUnitId);t&&(e=t.get("division"))}return r.get(e)||null},c.getSubdivision=function(){return"subdivision"!==c.data.orgUnitType?null:o.get(c.data.orgUnitId)||null},c.hasPrivilege=function(t){return c.data.privilegesMap||(Array.isArray(c.data.privileges)||(c.data.privileges=[]),c.data.privilegesString="|"+c.data.privileges.join("|"),c.data.privilegesMap={},e.forEach(c.data.privileges,function(e){c.data.privilegesMap[e]=!0})),"*"===t.charAt(t.length-1)?-1!==c.data.privilegesString.indexOf("|"+t.substr(0,t.length-1)):!0===c.data.privilegesMap[t]},c.getGuestUserData=function(){return window.GUEST_USER||{id:null,login:"guest",name:t.bound("core","GUEST_USER_NAME"),loggedIn:!1,super:!1,privileges:[]}},c.getRootUserData=function(){return window.ROOT_USER||{id:null,login:"root",name:"root",loggedIn:!0,super:!0,privileges:[]}},c.can={viewOrders:function(){return c.isAllowedTo("LOCAL","ORDERS:VIEW")},commentOrders:function(){return c.isAllowedTo("ORDERS:MANAGE","ORDERS:COMMENT","PLANNING:PLANNER","PLANNING:WHMAN","PAINT_SHOP:PAINTER","WH:VIEW","FN:master","FN:leader")}},window.user=c,c}),define("app/core/templates/messages",["underscore","jquery","app/i18n","app/time","app/user","app/core/util/forms"],function(_,$,t,time,user,forms){return function anonymous(locals,escapeFn,include,rethrow){escapeFn=escapeFn||function(e){return void 0==e?"":String(e).replace(_MATCH_HTML,encode_char)};var _ENCODE_HTML_RULES={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&#34;","'":"&#39;"},_MATCH_HTML=/[&<>'"]/g;function encode_char(e){return _ENCODE_HTML_RULES[e]||e}var __output="";function __append(e){void 0!==e&&null!==e&&(__output+=e)}with(locals||{})__append('<ol class="messages"></ol>\n');return __output}}),define("app/core/templates/message",["underscore","jquery","app/i18n","app/time","app/user","app/core/util/forms"],function(_,$,t,time,user,forms){return function anonymous(locals,escapeFn,include,rethrow){escapeFn=escapeFn||function(e){return void 0==e?"":String(e).replace(_MATCH_HTML,encode_char)};var _ENCODE_HTML_RULES={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&#34;","'":"&#39;"},_MATCH_HTML=/[&<>'"]/g;function encode_char(e){return _ENCODE_HTML_RULES[e]||e}var __output="";function __append(e){void 0!==e&&null!==e&&(__output+=e)}with(locals||{})__append('<div class="message message-'),__append(type),__append(" "),__append(sticky?"message-sticky":""),__append(" "),__append(className),__append('">'),__append(text),__append("</div>\n");return __output}}),define("app/core/views/MessagesView",["underscore","jquery","app/i18n","../View","app/core/templates/messages","app/core/templates/message"],function(e,t,n,i,r,o){"use strict";var a=i.extend({template:r,events:{"click .message":function(e){e.currentTarget.parentNode===this.el&&e.currentTarget.getAttribute("data-view")===this.idPrefix&&this.hide(t(e.currentTarget))}},localTopics:{"router.executing":function(){this.hide()}}});return a.prototype.initialize=function(){this.$loadingMessage=null,this.$savingMessage=null,this.loadingTimer=null,this.loadingCounter=0,this.savingTimer=null,this.savingCounter=0,this.hideTimers=[],this.loading=this.loading.bind(this),this.loaded=this.loaded.bind(this),this.saving=this.saving.bind(this),this.saved=this.saved.bind(this)},a.prototype.destroy=function(){this.$loadingMessage=null,null!==this.loadingTimer&&(clearTimeout(this.loadingTimer),this.loadingTimer=null),this.$savingMessage=null,null!==this.savingTimer&&(clearTimeout(this.savingTimer),this.savingTimer=null),this.hideTimers.length>0&&(this.hideTimers.forEach(clearTimeout),this.hideTimers=null),this.$('.message[data-view="'+this.idPrefix+'"]').remove()},a.prototype.show=function(e){var n=t(o({className:e.className||"",type:e.type||"info",text:e.text,sticky:!!e.sticky}));return this.$el.append(n.attr("data-view",this.idPrefix)),this.moveDown(n),n.attr("data-top",n.position().top).css("margin-left",-n.width()/2+"px"),e.immediate?n.css("opacity",1):n.animate({opacity:1}),this.scheduleHiding(n,e.time),n},a.prototype.hide=function(e,t){if(e){if(e.hasClass("message-hiding"))return;e.addClass("message-hiding")}else e=this.$('.message[data-view="'+this.idPrefix+'"]:not(.message-sticky)'),this.$loadingMessage=null;1===e.length&&(this.moveUp(e),this.removeHideTimer(e)),t?e.remove():e.animate({opacity:0},function(){e.remove()})},a.prototype.loading=function(){this.loadingCounter+=1,null===this.loadingTimer&&(this.loadingTimer=setTimeout(this.showLoadingMessage.bind(this),0))},a.prototype.loaded=function(){this.hideLoadingMessage()},a.prototype.loadingFailed=function(t){this.hideLoadingMessage(),this.show({type:"error",time:1e4,text:e.isString(t)?t:n("core","MSG:LOADING_FAILURE")})},a.prototype.showLoadingMessage=function(){this.loadingTimer=null,null===this.$loadingMessage&&(this.$loadingMessage=this.show({type:"warning",text:n("core","MSG:LOADING"),immediate:!0}))},a.prototype.hideLoadingMessage=function(){this.loadingCounter>0&&--this.loadingCounter,0===this.loadingCounter&&(null!==this.loadingTimer&&(clearTimeout(this.loadingTimer),this.loadingTimer=null),null!==this.$loadingMessage&&(this.hide(this.$loadingMessage),this.$loadingMessage=null))},a.prototype.saving=function(){this.savingCounter+=1,null===this.savingTimer&&(this.savingTimer=setTimeout(this.showSavingMessage.bind(this),0))},a.prototype.saved=function(){this.hideSavingMessage()},a.prototype.savingFailed=function(t){this.hideSavingMessage(),this.show({type:"error",time:5e3,text:e.isString(t)?t:n("core","MSG:SAVING_FAILURE")})},a.prototype.showSavingMessage=function(){this.savingTimer=null,null===this.$savingMessage&&(this.$savingMessage=this.show({type:"warning",text:n("core","MSG:SAVING"),immediate:!0}))},a.prototype.hideSavingMessage=function(){this.savingCounter>0&&--this.savingCounter,0===this.savingCounter&&(null!==this.savingTimer&&(clearTimeout(this.savingTimer),this.savingTimer=null),null!==this.$savingMessage&&(this.hide(this.$savingMessage),this.$savingMessage=null))},a.prototype.moveDown=function(e){this.moveTopBy(this.$('.message[data-view="'+this.idPrefix+'"]'),e,this.getMoveOffset(e))},a.prototype.moveUp=function(e){this.moveTopBy(e.prevAll(".message"),e,-this.getMoveOffset(e))},a.prototype.moveTopBy=function(e,n,i){e.each(function(){if(this!==n[0]){var e=t(this),r=parseInt(e.attr("data-top"),10)+i;e.attr("data-top",r),e.animate({top:r+"px"})}})},a.prototype.getMoveOffset=function(e){return e.outerHeight()+8},a.prototype.scheduleHiding=function(t,n){if(e.isNumber(n)){n<1e3&&(n=1e3);var i=setTimeout(this.hide.bind(this,t),n);t.data("hideTimer",i),this.hideTimers.push(i)}},a.prototype.removeHideTimer=function(t){var n=t.data("hideTimer");e.isUndefined(n)||(clearTimeout(n),t.data("hideTimer",void 0),this.hideTimers.splice(this.hideTimers.indexOf(n),1))},a}),define("app/core/templates/dialogContainer",["underscore","jquery","app/i18n","app/time","app/user","app/core/util/forms"],function(_,$,t,time,user,forms){return function anonymous(locals,escapeFn,include,rethrow){escapeFn=escapeFn||function(e){return void 0==e?"":String(e).replace(_MATCH_HTML,encode_char)};var _ENCODE_HTML_RULES={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&#34;","'":"&#39;"},_MATCH_HTML=/[&<>'"]/g;function encode_char(e){return _ENCODE_HTML_RULES[e]||e}var __output="";function __append(e){void 0!==e&&null!==e&&(__output+=e)}with(locals||{})__append('<div class="modal fade viewport-dialog" tabindex="-1">\n  <div class="modal-dialog">\n    <div class="modal-content">\n      <div class="modal-header">\n        <button type="button" class="close cancel">×</button>\n        <h3 class="modal-title"></h3>\n      </div>\n      <div class="modal-body"></div>\n    </div>\n  </div>\n</div>\n');return __output}}),define("app/core/Viewport",["require","underscore","jquery","./View","./util","./views/MessagesView","app/core/templates/dialogContainer"],function(e,t,n,i,r,o,a){"use strict";var s=function(e){return new e};function u(e){i.call(this,e),this.msg=e.messagesView?e.messagesView:new o({el:this.el}),this.document=e.document||window.document,this.layouts={},this.currentLayout=null,this.currentLayoutName=null,this.defaultLayoutName=null,this.currentPage=null,this.$dialog=null,this.dialogQueue=[],this.currentDialog=null,this.pageCounter=0,this.closeDialog=this.closeDialog.bind(this),this.$el.on("click",".viewport-dialog .cancel",this.closeDialog)}return r.inherits(u,i),u.prototype.cleanup=function(){this.broker.destroy(),this.msg.remove(),this.$dialog.remove(),this.currentPage&&this.currentPage.remove(),this.currentLayout&&this.currentLayout.remove(),this.currentDialog&&this.currentDialog.remove(),t.invoke(this.dialogQueue.filter(t.isObject),"remove"),this.$el.off("click",".viewport-dialog .cancel",this.closeDialog),this.broker=null,this.msg=null,this.$dialog=null,this.currentLayout=null,this.currentDialog=null,this.dialogQueue=null,this.layouts=null},u.prototype.afterRender=function(){if(null!==this.$dialog)return this.closeDialog();this.$dialog=n(a()).appendTo(this.el).modal({show:!1,backdrop:!0}),this.$dialog.on("show.bs.modal",this.onDialogShowing.bind(this)),this.$dialog.on("shown.bs.modal",this.onDialogShown.bind(this)),this.$dialog.on("hide.bs.modal",this.onDialogHiding.bind(this)),this.$dialog.on("hidden.bs.modal",this.onDialogHidden.bind(this))},u.prototype.setDefaultLayout=function(e){return this.defaultLayoutName=e,this},u.prototype.registerLayout=function(e,t){return this.defaultLayoutName||(this.defaultLayoutName=e),this.layouts[e]=t,this},u.prototype.loadPage=function(n,i){this.msg.loading(),t.isFunction(i)||(i=s);var r=this,o=++this.pageCounter;e(t.flatten([].concat(n),!0),function(){o===r.pageCounter&&r.showPage(i.apply(null,arguments)),r.msg.loaded()},function(e){o===r.pageCounter&&(r.msg.loadingFailed(),r.broker.publish("viewport.page.loadingFailed",{page:null,xhr:{status:0,responseText:e.stack||e.message}}))})},u.prototype.showPage=function(i){var r=this,o=r.defaultLayoutName;if("string"==typeof i.layoutName?o=i.layoutName:"function"==typeof i.layoutName&&(o=i.layoutName(r)),!t.isObject(r.layouts[o]))throw new Error("Unknown layout: "+o);++r.pageCounter,r.broker.publish("viewport.page.loading",{page:i});var a=[],s=[],u=[],c=t.result(i,"requiredModules")||[];function l(){t.isFunction(i.load)?i.load(d).then(p,f):d().then(p,f)}function d(){for(var e=[],t=[],r=[],o=0;o<arguments.length;++o)e=e.concat(arguments[o]);return e.forEach(function(e){e&&("string"==typeof e?r.push(e):e.priority&&e.promise&&e.promise.then?t.push(i.promised(e.promise)):e.priority&&e.then?t.push(i.promised(e)):e.then&&u.push(i.promised(e)))}),r.length&&t.push(h(r)),t.length?n.when.apply(n,t).then(function(){return n.when.apply(n,u)}):n.when.apply(n,u)}function p(){r.broker.publish("viewport.page.loaded",{page:i}),i.trigger("afterLoad",i),null!==r.currentPage&&r.currentPage.remove(),r.currentPage=i;var e=r.setLayout(o);t.isFunction(e.setUpPage)&&e.setUpPage(i),t.isFunction(i.setUpLayout)&&i.setUpLayout(e),t.isObject(i.view)&&t.isEmpty(i.views)&&i.setView(i.view),e.setView(e.pageContainerSelector,i),r.isRendered()?e.isRendered()?i.render():e.render():r.render(),r.broker.publish("viewport.page.shown",i)}function f(e){i.remove(),r.broker.publish("viewport.page.loadingFailed",{page:i,xhr:e})}function h(t){var i=n.Deferred();return e(t,function(){i.resolve()},function(e){i.reject(e)}),i.promise()}i.trigger("beforeLoad",i,a),a.forEach(function(e){e&&("string"==typeof e?c.push(e):e.priority&&e.promise&&e.promise.then?s.push(i.promised(e.promise)):e.priority&&e.then?s.push(i.promised(e)):e.then&&u.push(i.promised(e)))}),c.length&&s.unshift(h(c)),s.length?d.apply(null,s).then(l,f):l()},u.prototype.showDialog=function(e,n){if(null!==this.currentDialog)return this.dialogQueue.push(e,n),this;var i=!0,r=e.afterRender,o=this;e.afterRender=function(){var n=o.$dialog.find(".modal-body");n.children()[0]!==e.el&&n.empty().append(e.el),i&&(i=!1,o.$dialog.modal("show")),t.isFunction(r)&&r.apply(e,arguments)},this.currentDialog=e;var a=this.$dialog.find(".modal-header");n?(a.find(".modal-title").html(n),a.show()):a.hide(),e.dialogClassName&&this.$dialog.addClass(t.result(e,"dialogClassName"));var s=t.result(e,"dialogBackdrop");return this.$dialog.data("bs.modal").options.backdrop=null==s||s,e.render(),this},u.prototype.closeDialog=function(e){return null===this.currentDialog?this:(this.$dialog.modal("hide"),e&&e.preventDefault&&e.preventDefault(),this)},u.prototype.closeDialogs=function(e,t){this.dialogQueue=this.dialogQueue.filter(t||e),"function"==typeof e&&this.currentDialog&&e(this.currentDialog)&&this.closeDialog()},u.prototype.closeAllDialogs=function(){this.dialogQueue=[],this.closeDialog()},u.prototype.adjustDialogBackdrop=function(){this.currentDialog&&this.$dialog.modal("adjustBackdrop")},u.prototype.setLayout=function(e){if(e===this.currentLayoutName)return t.isFunction(this.currentLayout.reset)&&this.currentLayout.reset(),this.currentLayout;var n=this.layouts[e],i=this.options.selector||"";return t.isObject(this.currentLayout)&&this.removeView(i),this.currentLayoutName=e,this.currentLayout=n(),this.setView(i,this.currentLayout),this.trigger("layout:change",this.currentLayoutName,this.currentLayout),this.currentLayout},u.prototype.onDialogShowing=function(){this.currentDialog&&(t.isFunction(this.currentDialog.onDialogShowing)&&this.currentDialog.onDialogShowing(this),this.broker.publish("viewport.dialog.showing",this.currentDialog),this.currentDialog.trigger("dialog:showing"))},u.prototype.onDialogShown=function(){this.currentDialog&&(this.currentDialog.$("[autofocus]").focus(),t.isFunction(this.currentDialog.onDialogShown)&&this.currentDialog.onDialogShown(this),this.broker.publish("viewport.dialog.shown",this.currentDialog),this.currentDialog.trigger("dialog:shown"))},u.prototype.onDialogHiding=function(){var e=this.currentDialog;e&&t.isFunction(e.remove)&&(e.trigger("dialog:hiding"),this.broker.publish("viewport.dialog.hiding",e))},u.prototype.onDialogHidden=function(){var e=this.currentDialog;e&&(this.currentDialog=null,e.dialogClassName&&this.$dialog.removeClass(t.result(e,"dialogClassName")),t.isFunction(e.remove)&&(e.trigger("dialog:hidden"),e.remove(),this.broker.publish("viewport.dialog.hidden",e)),this.dialogQueue.length&&this.showDialog(this.dialogQueue.shift(),this.dialogQueue.shift()))},u}),define("app/viewport",["underscore","app/broker","app/core/Viewport"],function(e,t,n){"use strict";var i=new n({el:document.body,selector:"#app-viewport"});return t.subscribe("router.executing",function(){window.scrollTo(0,0)}),t.subscribe("viewport.page.loaded",function(){window.parent!==window&&window.parent.postMessage({type:"viewport.page.embeddedLoaded",app:window.WMES_APP_ID,loaded:!0},"*")}),t.subscribe("viewport.page.loadingFailed",function(){window.parent!==window&&window.parent.postMessage({type:"viewport.page.embeddedLoaded",app:window.WMES_APP_ID,loaded:!1},"*")}),window.addEventListener("message",function(e){var n=e.data;switch(n.type){case"viewport.page.embeddedLoaded":t.publish("viewport.page.embeddedLoaded",{app:n.app,loaded:n.loaded})}}),window.addEventListener("resize",e.debounce(t.publish.bind(t,"viewport.resized"),1e3/30)),window.viewport=i,Object.defineProperty(window,"page",{get:function(){return i.currentPage}}),Object.defineProperty(window,"dialog",{get:function(){return i.currentDialog}}),Object.defineProperty(window,"model",{get:function(){var e=i.currentDialog||i.currentPage;return e&&e.model||e.collection}}),i}),define("app/core/Request",["h5.rql/index","./util"],function(e,t){"use strict";var n=/^\/(.*?)(?:\?(.*?))?(?:#(.*?))?$/;function i(e){"/"!==e[0]&&(e="/"+e);var t=e.match(n);this.url=e,this.path=("/"===t[1][0]?"":"/")+t[1],this.queryString=t[2]||"",this.fragment=t[3]||"",this.params={},this.query={},this.rql={},this.cancel=!1,this.defineGetters()}return i.prototype.defineGetters=function(){Object.defineProperty(this,"query",{enumerable:!0,configurable:!0,get:function(){return this.parseQueryString()},set:function(e){this.query=e}}),Object.defineProperty(this,"rql",{enumerable:!0,configurable:!0,get:function(){return this.parseRqlString()},set:function(e){this.rql=e}})},i.prototype.parseQueryString=function(){delete this.query;for(var e=this.queryString.split("&"),n={},i=0,r=e.length;i<r;++i){var o=e[i],a=o.indexOf("=");if(-1!==a){var s=t.decodeUriComponent(o.substr(0,a)),u=t.decodeUriComponent(o.substr(a+1));n[s]=u}}return this.query=n,n},i.prototype.parseRqlString=function(){return delete this.rql,this.rql=e.parse(this.queryString),this.rql},i}),define("app/core/Router",["underscore","./util","./Request"],function(e,t,n){"use strict";var i=/([:*])([\w\-]+)?/g,r=/[\-\[\]{}()+?.,\\\^$|#\s]/g;function o(e){this.broker=e,this.routes=[],this.dispatching=!1,this.dispatchQueue=[],this.currentRequest=null,this.previousUrl=null}function a(n,i){return function(r){var o=n.exec(r.path);if(null===o)return!1;var a=o.length;if(1===a)return!0;var s,u=e.isArray(i)?i.length:0;if(a===u+1)for(s=0;s<u;++s)r.params[i[s]]=t.decodeUriComponent(o[s+1]);else for(s=0;s<a;++s)r.params[s]=t.decodeUriComponent(o[s]);return!0}}return o.prototype.getCurrentRequest=function(){return this.currentRequest},o.prototype.setCurrentRequest=function(e){this.currentRequest=new n(e)},o.prototype.map=function(e){var t=Array.prototype.slice.call(arguments);t.shift(),this.routes.unshift(this.createMatcher(e),t)},o.prototype.navigate=function(t,n){this.broker.publish("router.navigate",e.assign({url:t},n))},o.prototype.replace=function(e){this.broker.publish("router.navigate",{url:e,trigger:!0,replace:!0})},o.prototype.update=function(e){this.broker.publish("router.navigate",{url:e,trigger:!1,replace:!0})},o.prototype.dispatch=function(t){if(!e.isUndefined(t))if(null===t&&(t="/"),this.dispatching)this.dispatchQueue.push(t);else{this.dispatching=!0;var i=new n(t);this.broker.publish("router.dispatching",i);var r=this.match(i);if(null===r){this.dispatching=!1;var o=this.dispatchQueue.shift();e.isUndefined(o)?this.broker.publish("router.404",{req:i}):this.dispatch(o)}else this.broker.publish("router.matched",{handlers:r,req:i}),e.defer(this.execute.bind(this,r,i))}},o.prototype.match=function(e){for(var t=this.routes,n=0,i=t.length;n<i;n+=2){if((0,t[n])(e))return t[n+1]}return null},o.prototype.execute=function(e,t){this.currentRequest=t,this.broker.publish("router.executing",{handlers:e,req:t});var n=this.previousUrl;!function i(r){r+1<e.length?e[r](t,n,i.bind(null,r+1)):e[r](t,n)}(0),this.previousUrl=t.url,this.dispatching=!1,this.dispatch(this.dispatchQueue.shift())},o.prototype.createMatcher=function(t){if(t instanceof RegExp)return a(t);if(""===(t=t.trim())||"/"===t)return function(e){return""===e.path||"/"===e.path};var n=[],o=!1,s=t.replace(r,"\\$&");return s=s.replace(i,function(t,i,r){return o=!0,e.isUndefined(r)?"*"===i?".*":t:(n.push(r),"*"===i?"(.*?)":"([^/#?;]*)")}),o?a(new RegExp("^"+s+"$"),n):function(e){return e.path===t}},o}),define("app/core/templates/error",["underscore","jquery","app/i18n","app/time","app/user","app/core/util/forms"],function(_,$,t,time,user,forms){return function anonymous(locals,escapeFn,include,rethrow){escapeFn=escapeFn||function(e){return void 0==e?"":String(e).replace(_MATCH_HTML,encode_char)};var _ENCODE_HTML_RULES={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&#34;","'":"&#39;"},_MATCH_HTML=/[&<>'"]/g;function encode_char(e){return _ENCODE_HTML_RULES[e]||e}var __output="";function __append(e){void 0!==e&&null!==e&&(__output+=e)}with(locals||{})__append('<div class="well">\n  <p>'),__append(message),__append("</p>\n  "),notify&&(__append('\n  <hr style="margin: 0 0 10px 0">\n  <form>\n    <textarea id="'),__append(id("comment")),__append('" class="form-control" rows="3" required placeholder="'),__append(t("core","ERROR:notify:placeholder")),__append('"></textarea>\n    <button id="'),__append(id("notify")),__append('" type="submit" class="btn btn-default" style="margin-top: -1px">\n      <i class="fa fa-envelope"></i><span>'),__append(t("core","ERROR:notify:message")),__append("</span>\n    </button>\n  </form>\n  ")),__append("\n</div>\n");return __output}}),define("app/core/pages/ErrorPage",["underscore","app/i18n","app/viewport","../View","app/core/templates/error","app/data/localStorage"],function(e,t,n,i,r,o){"use strict";return i.extend({pageId:"error",events:{"change #-comment":function(){var e=this.$id("comment"),t=e.val().trim();t.replace(/[^a-zA-Z]+/g,"").length<3&&(t=""),e.val(t)},"submit form":function(){var e=this,t=e.buildMail();return e.$id("comment").prop("disabled",!0),e.$id("notify").prop("disabled",!0).find(".fa").removeClass("fa-envelope").addClass("fa-spinner fa-spin"),e.trySendMail("/mail;send",t,function(n){n?e.trySendMail(e.senderUrl,t,e.handleMailSent.bind(e)):e.handleMailSent()}),!1},"click a[data-reload]":function(){return window.location.reload(),!1}},breadcrumbs:function(){return[t.bound("core","ERROR:"+this.resolveCode()+":title")]},initialize:function(){var e=this,n=e.resolveCode();try{e.adminEmail=atob(window.ADMIN_EMAIL),e.senderUrl=atob(window.REMOTE_MAIL_SENDER_URL),e.secretKey=atob(window.REMOTE_MAIL_SECRET_KEY),e.notify=0!==n}catch(t){e.notify=!1}e.view=new i({template:function(){var i=require("app/user");return 403!==n||i.isLoggedIn()||(n+=":guest"),e.renderPartialHtml(r,{message:t("core","ERROR:"+n+":message"),notify:e.notify})},afterRender:function(){403===n&&e.checkUser()}})},resolveCode:function(){var e=this.model.code;return t.has("core","ERROR:"+e+":title")?e:e>=400&&e<500?400:e>=500?500:0},trySendMail:function(e,n,i){var r=require("app/user");this.ajax({method:"POST",url:e,data:JSON.stringify({secretKey:this.secretKey,to:this.adminEmail,subject:t("core","ERROR:notify:subject",{APP_NAME:t("core","APP_NAME"),code:this.model.code,user:r.getLabel()}),html:n}),success:function(){i()},error:function(){i(!0)}})},handleMailSent:function(e){e?(n.msg.show({type:"error",time:2500,text:t("core","ERROR:notify:failure")}),this.$id("comment").prop("disabled",!0),this.$id("notify").prop("disabled",!1).find(".fa").removeClass("fa-spinner fa-spin").addClass("fa-envelope")):this.$("form").html("<p>"+t("core","ERROR:notify:success")+"</p>")},buildMail:function(){var t=require("app/user"),n=[],i=function(e){return JSON.stringify(e,null,2)},r=function(e,t){n.push("<b>"+e+"=</b><br>",'<pre style="margin-top: 0; margin-bottom: 10px">'+String(t).trim()+"</pre>")};return r("comment",this.$id("comment").val().trim()),r("date",(new Date).toLocaleString()),r("user",'<a href="'+window.location.origin+"/#users/"+t.data._id+'">'+t.getLabel()+"</a><br>"+i(e.assign({cname:window.COMPUTERNAME},e.omit(t.data,"privilegesMap")))),r("router.currentRequest",this.model.req?this.model.req.url:"?"),r("router.referrer",this.model.previousUrl||"?"),r("router.recent",i(JSON.parse(o.getItem("WMES_RECENT_LOCATIONS")||"[]"))),r("response.code",this.model.code),r("response.body",this.model.xhr?this.model.xhr.responseText:""),r("window.location.href",window.location.href),r("window.navigator",i(e.pick(window.navigator,["language","languages","cookieEnabled","onLine","platform","userAgent"]))),r("window.screen",i(e.assign(e.pick(window.screen,["availHeight","availWidth","width","height"])),(window.innerWidth,window.innerHeight))),n.join("")},checkUser:function(){var e=require("app/user");this.ajax({url:"/users/self"}).done(function(t){t._id!==e.data._id&&window.location.reload()})}})}),define("app/router",["backbone","h5.rql/specialOperators","app/broker","app/viewport","app/time","app/core/Router","app/core/pages/ErrorPage","app/data/localStorage"],function(e,t,n,i,r,o,a,s){"use strict";e.Router.prototype._extractParameters=function(e,t){return e.exec(t).slice(1)};var u=new o(n),c=new e.Router;c.route("*catchall","catchall",function(e){u.dispatch(e)}),n.subscribe("router.navigate",function(e){var t=e.url,n=t.charAt(0);"#"!==n&&"/"!==n||(t=t.substr(1));var i=!0===e.trigger,r=!0===e.replace;c.navigate(t,{trigger:i,replace:r}),!i&&r&&u.setCurrentRequest(t)});function l(){var e=JSON.parse(s.getItem("WMES_RECENT_LOCATIONS")||"[]");e.unshift({date:new Date,href:window.location.href}),e.length>10&&e.pop(),s.setItem("WMES_RECENT_LOCATIONS",JSON.stringify(e))}return n.subscribe("router.404",function(e){var t=e.req;"/404"===t.path?i.showPage(new a({model:{code:404,req:t,previousUrl:u.previousUrl}})):u.dispatch("/404")}),n.subscribe("viewport.page.loadingFailed",function(e){i.showPage(new a({model:{code:e.xhr?e.xhr.status:0,req:u.currentRequest,previousUrl:u.previousUrl,xhr:e.xhr}}))}),l(),window.addEventListener("hashchange",l),window.router=u,u}),define("app/updater/views/RestartMessageView",["app/core/View"],function(e){"use strict";return e.extend({destroy:function(){this.el.ownerDocument.body.style.marginBottom=""},afterRender:function(){this.el.ownerDocument.body.style.marginBottom=this.$el.outerHeight()+15+"px",this.rendered?this.el.style.display="block":this.rendered=!0}})}),define("app/updater/templates/browserUpdate",["underscore","jquery","app/i18n","app/time","app/user","app/core/util/forms"],function(_,$,t,time,user,forms){return function anonymous(locals,escapeFn,include,rethrow){escapeFn=escapeFn||function(e){return void 0==e?"":String(e).replace(_MATCH_HTML,encode_char)};var _ENCODE_HTML_RULES={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&#34;","'":"&#39;"},_MATCH_HTML=/[&<>'"]/g;function encode_char(e){return _ENCODE_HTML_RULES[e]||e}var __output="";function __append(e){void 0!==e&&null!==e&&(__output+=e)}with(locals||{})__append('<div class="updater-browserUpdate">\n  <p>'),__append(t("updater","browserUpdate:message")),__append("</p>\n  <p>"),__append(t("updater","browserUpdate:"+platform+":message")),__append("</p>\n  "),"windows"===platform&&(__append('\n  <p style="text-align: center">\n    <a id="'),__append(idPrefix),__append('-downloadUrl" class="btn btn-primary btn-block btn-lg" href="/files/ChromeStandaloneSetup64.exe">\n      '),__append(t("updater","browserUpdate:windows:download")),__append("\n    </a>\n  </p>\n  ")),__append("\n  "),"android"===platform&&(__append('\n  <p style="text-align: center">\n    <a class="btn btn-primary btn-block btn-lg" href="https://play.google.com/store/apps/details?id=com.android.chrome&hl=pl">\n      '),__append(t("updater","browserUpdate:android:download")),__append("\n    </a>\n  </p>\n  ")),__append("\n  <h3>"),__append(t("updater","browserUpdate:failure:header")),__append("</h3>\n  "),__append(t("updater","browserUpdate:failure:message")),__append("\n</div>\n");return __output}}),define("app/updater/views/BrowserUpdateDialogView",["app/viewport","app/core/View","app/updater/templates/browserUpdate"],function(e,t,n){"use strict";return t.extend({template:n,dialogClassName:"updater-browserUpdate-dialog",events:{"click a":function(){e.closeDialog()}},getTemplateData:function(){var e=window.navigator.userAgent;return{platform:-1!==e.indexOf("Android")?"android":-1!==e.indexOf("Mac OS")?"mac":-1!==e.indexOf("Linux")?"linux":"windows"}},afterRender:function(){var e=this,t=e.ajax({method:"HEAD",url:"https://test.wmes.pl/ping"});t.done(function(){200===t.statusCode&&e.$id("downloadUrl").prop("href","https://dl.google.com/tag/s/appguid%3D%7B8A69D345-D564-463C-AFF1-A69D9E530F96%7D%26iid%3D%7BB7F24988-6715-F843-972C-481E05CBA4B5%7D%26lang%3Dpl%26browser%3D4%26usagestats%3D0%26appname%3DGoogle%2520Chrome%26needsadmin%3Dprefers%26ap%3Dx64-stable-statsdef_1%26installdataindex%3Dempty/update2/installers/ChromeSetup.exe")}),window.sessionStorage.setItem("WMES_BROWSER_UPDATE","1")}})}),define("app/updater/templates/addressUpdate",["underscore","jquery","app/i18n","app/time","app/user","app/core/util/forms"],function(_,$,t,time,user,forms){return function anonymous(locals,escapeFn,include,rethrow){escapeFn=escapeFn||function(e){return void 0==e?"":String(e).replace(_MATCH_HTML,encode_char)};var _ENCODE_HTML_RULES={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&#34;","'":"&#39;"},_MATCH_HTML=/[&<>'"]/g;function encode_char(e){return _ENCODE_HTML_RULES[e]||e}var __output="";function __append(e){void 0!==e&&null!==e&&(__output+=e)}with(locals||{})__append('<div class="updater-addressUpdate">\n  '),__append(t("updater","addressUpdate:message",{network:network})),__append("\n  <p>"),__append(t("updater","addressUpdate:old",{oldAddress:oldAddress})),__append("</p>\n  <p>"),__append(t("updater","addressUpdate:new",{newAddress:newAddress})),__append('</p>\n  <p style="text-align: center">\n    <button id="'),__append(idPrefix),__append('-go" class="btn btn-primary btn-block btn-lg" type="button">\n      '),__append(t("updater","addressUpdate:go")),__append("\n    </button>\n  </p>\n</div>\n");return __output}}),define("app/updater/views/AddressUpdateDialogView",["app/user","app/viewport","app/core/View","app/updater/templates/addressUpdate"],function(e,t,n,i){"use strict";return n.extend({template:i,dialogClassName:"updater-addressUpdate-dialog",events:{"click #-go":function(){e.isLoggedIn()?window.location.href="/addressUpdate/redirect?hash="+encodeURIComponent(window.location.hash||"#"):window.location.href="https://ket.wmes.pl/"+window.location.hash}},getTemplateData:function(){var t="domain";return 0===(e.data.ipAddress||window.location.hostname).indexOf("192.168")&&(t="factory"),{network:t,oldAddress:window.location.origin,newAddress:"https://ket.wmes.pl"}},afterRender:function(){window.sessionStorage.setItem("WMES_ADDRESS_UPDATE","1")}})}),define("app/updater/templates/backendRestart",["underscore","jquery","app/i18n","app/time","app/user","app/core/util/forms"],function(_,$,t,time,user,forms){return function anonymous(locals,escapeFn,include,rethrow){escapeFn=escapeFn||function(e){return void 0==e?"":String(e).replace(_MATCH_HTML,encode_char)};var _ENCODE_HTML_RULES={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&#34;","'":"&#39;"},_MATCH_HTML=/[&<>'"]/g;function encode_char(e){return _ENCODE_HTML_RULES[e]||e}var __output="";function __append(e){void 0!==e&&null!==e&&(__output+=e)}with(locals||{})__append('<div class="updater-restart updater-restart-backend">\n  <i class="fa fa-exclamation-triangle updater-restart-icon"></i><span class="updater-restart-message">'),__append(t("updater","restart:backend")),__append("</span>\n</div>\n");return __output}}),define("app/updater/templates/frontendRestart",["underscore","jquery","app/i18n","app/time","app/user","app/core/util/forms"],function(_,$,t,time,user,forms){return function anonymous(locals,escapeFn,include,rethrow){escapeFn=escapeFn||function(e){return void 0==e?"":String(e).replace(_MATCH_HTML,encode_char)};var _ENCODE_HTML_RULES={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&#34;","'":"&#39;"},_MATCH_HTML=/[&<>'"]/g;function encode_char(e){return _ENCODE_HTML_RULES[e]||e}var __output="";function __append(e){void 0!==e&&null!==e&&(__output+=e)}with(locals||{})__append('<div class="updater-restart updater-restart-frontend">\n  <i class="fa fa-exclamation-circle updater-restart-icon"></i><span class="updater-restart-message">'),__append(t("updater","restart:frontend")),__append("</span>\n</div>\n");return __output}}),function(){"use strict";var e=/(^.*(^|\/)nls(\/|$))([^\/]*)\/?([^\/]*)/;function t(e,t,n,i,r,o){t[e]&&(n.push(e),!0!==t[e]&&1!==t[e]||i.push(r+e+"/"+o))}function n(e,t,n,i,r){var o=i+t+"/"+r;require._fileExists(e.toUrl(o+".js"))&&n.push(o)}function i(e,t,n){var r;for(r in t)!t.hasOwnProperty(r)||e.hasOwnProperty(r)&&!n?"object"==typeof t[r]&&(!e[r]&&t[r]&&(e[r]={}),i(e[r],t[r],n)):e[r]=t[r]}define("i18n",["module"],function(r){var o=r.config?r.config():{};return{version:"2.0.4",load:function(r,a,s,u){(u=u||{}).locale&&(o.locale=u.locale);var c,l,d,p=e.exec(r),f=p[1],h=p[4],m=p[5],g=h.split("-"),v=[],y={},_="";if(p[5]?c=(f=p[1])+m:(c=r,m=p[4],(h=o.locale)||(h=o.locale="undefined"==typeof navigator?"root":(navigator.language||navigator.userLanguage||"root").toLowerCase()),g=h.split("-")),u.isBuild){for(v.push(c),n(a,"root",v,f,m),l=0;l<g.length;l++)d=g[l],n(a,_+=(_?"-":"")+d,v,f,m);a(v,function(){s()})}else a([c],function(e){var n,r=[];for(t("root",e,r,v,f,m),l=0;l<g.length;l++)n=g[l],t(_+=(_?"-":"")+n,e,r,v,f,m);a(v,function(){var t,n,o;for(t=r.length-1;t>-1&&r[t];t--)!0!==(n=e[o=r[t]])&&1!==n||(n=a(f+o+"/"+m)),i(y,n);s(y)})})}}})}(),define("app/nls/locale/en",[],function(){return{}.en=function(e){return 1===e?"one":"other"}}),define("app/nls/updater",["app/nls/locale/en"],function(e){var t={lc:{pl:function(t){return e(t)},en:function(t){return e(t)}},c:function(e,t){if(!e)throw new Error("MessageFormat: Data required for '"+t+"'.")},n:function(e,t,n){if(isNaN(e[t]))throw new Error("MessageFormat: '"+t+"' isn't a number.");return e[t]-(n||0)},v:function(e,n){return t.c(e,n),e[n]},p:function(e,n,i,r,o){return t.c(e,n),e[n]in o?o[e[n]]:(n=t.lc[r](e[n]-i))in o?o[n]:o.other},s:function(e,n,i){return t.c(e,n),e[n]in i?i[e[n]]:i.other}};return{root:{"restart:backend":function(e){return"Application server is being restarted! Communication with the server might not work for a short while..."},"restart:frontend":function(e){return"A new version of the application is available! <a href='javascript:window.location.reload()'>Click here to reload the browser</a>..."},"browserUpdate:title":function(e){return"Browser out of date"},"browserUpdate:failure:header":function(e){return"I can't update my browser"},"browserUpdate:failure:message":function(e){return"<ul><li>If you can't change your browser because of compatibility issues, think about installing a second browser for browsing and keep the old one for compatibility.<li>Ask your admin to update your browser if you cannot install updates yourself.</ul>"},"browserUpdate:message":function(e){return"Your web browser is out of date. In the future, the version you are using will not be supported. Update your browser for more security, speed and the best experience on this site."},"browserUpdate:windows:message":function(e){return"Click the following button to download the installation file for the latest version of your browser:"},"browserUpdate:windows:download":function(e){return"DOWNLOAD THE INSTALLATION FILE"},"browserUpdate:android:message":function(e){return"Click the following button to go to the Google Chrome app in the Google Play store:"},"browserUpdate:android:download":function(e){return"GO TO GOOGLE PLAY"},"addressUpdate:title":function(e){return"Address out of date"},"addressUpdate:message":function(e){return"<p>You are currently in the "+t.s(e,"network",{factory:"factory",other:"domain"})+" network and you are using an out of date address to the WMES.</p><p>Consider using the new, easier to remember address and update all of your shortcuts and bookmarks!</p>"},"addressUpdate:old":function(e){return"Old address: "+t.v(e,"oldAddress")},"addressUpdate:new":function(e){return"New address: <a href='"+t.v(e,"newAddress")+"'>"+t.v(e,"newAddress")+"</a>"},"addressUpdate:go":function(e){return"GO TO THE NEW ADDRESS"}},pl:!0}}),define("app/nls/locale/pl",[],function(){return{}.pl=function(e){return 1==e?"one":e%10>=2&&e%10<=4&&(e%100<12||e%100>14)&&e==Math.floor(e)?"few":e%10==0||1!=e&&e%10==1||(e%10>=5&&e%10<=9||e%100>=12&&e%100<=14)&&e==Math.floor(e)?"many":"other"}}),define("app/nls/pl/updater",["app/nls/locale/pl"],function(e){var t={lc:{pl:function(t){return e(t)},en:function(t){return e(t)}},c:function(e,t){if(!e)throw new Error("MessageFormat: Data required for '"+t+"'.")},n:function(e,t,n){if(isNaN(e[t]))throw new Error("MessageFormat: '"+t+"' isn't a number.");return e[t]-(n||0)},v:function(e,n){return t.c(e,n),e[n]},p:function(e,n,i,r,o){return t.c(e,n),e[n]in o?o[e[n]]:(n=t.lc[r](e[n]-i))in o?o[n]:o.other},s:function(e,n,i){return t.c(e,n),e[n]in i?i[e[n]]:i.other}};return{"restart:backend":function(e){return"Serwer aplikacji jest restartowany! Komunikacja z serwerem może przez chwilę nie działać..."},"restart:frontend":function(e){return"Dostępna jest nowa wersja aplikacji! <a href='javascript:window.location.reload()'>Kliknij tutaj aby przeładować przeglądarkę</a>..."},"browserUpdate:title":function(e){return"Nieaktualna przeglądarka"},"browserUpdate:failure:header":function(e){return"Nie mogę zaktualizować przeglądarki"},"browserUpdate:failure:message":function(e){return"<ul><li>Jeśli nie możesz sobie pozwolić na zmianę przeglądarki ze względu na problemy ze zgodnością, rozważ zainstalowanie drugiej przeglądarki do codziennego użytku i zachowanie starej ze względu na zgodność.<li>Poproś administratora o zaktualizowanie twojej przeglądarki, jeśli nie możesz zrobić tego samodzielnie.</ul>"},"browserUpdate:message":function(e){return"Twoja przeglądarka jest nieaktualna. W przyszłości Twoja wersja przeglądarki przestanie być wspierana. Zaktualizuj przeglądarkę, by korzystać z tej strony bezpieczniej, szybciej i po prostu sprawniej."},"browserUpdate:windows:message":function(e){return"Kliknij poniższy przycisk, aby pobrać instalator najnowszej wersji przeglądarki:"},"browserUpdate:windows:download":function(e){return"POBIERZ INSTALATOR NA DYSK"},"browserUpdate:android:message":function(e){return"Kliknij poniższy przycisk, aby przejść do aplikacji Google Chrome w sklepie Google Play:"},"browserUpdate:android:download":function(e){return"PRZEJDŹ DO GOOGLE PLAY"},"addressUpdate:title":function(e){return"Nieaktualny adres"},"addressUpdate:message":function(e){return"<p>Jesteś w sieci "+t.s(e,"network",{factory:"fabrycznej",other:"domenowej"})+" i używasz nieaktualnego adresu do systemu WMES.</p><p>Rozważ korzystanie z nowego, łatwiejszego adresu i zaktualizuj wszystkie skróty i zakładki!</p>"},"addressUpdate:old":function(e){return"Stary adres: "+t.v(e,"oldAddress")},"addressUpdate:new":function(e){return"Nowy adres: <a href='"+t.v(e,"newAddress")+"'>"+t.v(e,"newAddress")+"</a>"},"addressUpdate:go":function(e){return"PRZEJDŹ DO NOWEGO ADRESU"}}}),define("app/updater/index",["underscore","jquery","../broker","../pubsub","../socket","../viewport","../time","../i18n","../data/localStorage","./views/RestartMessageView","./views/BrowserUpdateDialogView","./views/AddressUpdateDialogView","app/updater/templates/backendRestart","app/updater/templates/frontendRestart","i18n!app/nls/updater"],function(e,t,n,i,r,o,a,s,u,c,l,d,p,f){"use strict";var h=70,m="VERSIONS",g={},v=null,y=null,_=!1,b=!1,w=!1,A=!0,k=window.BACKEND_SERVICE||"backend",E=window.FRONTEND_SERVICE||"frontend",T=window[m],S=JSON.parse(u.getItem(m)||"null");function C(){g.versions.time=Date.now(),u.setItem(m,JSON.stringify(g.versions))}function R(){b||_||(b=!0,window.addEventListener("mousemove",P),window.addEventListener("keypress",P),A&&(y&&y.cancelAnimations(!0,!0),y&&y.remove(),y=new c({template:f,type:"frontend"}),o.insertView(y).render(),y.$el.slideDown()),n.publish("updater.frontendRestarting"),window.navigator.serviceWorker&&window.navigator.serviceWorker.getRegistrations&&window.navigator.serviceWorker.getRegistrations().then(function(t){t.forEach(function(t){t.unregister().catch(e.noop)})}).catch(e.noop),P())}function P(){clearTimeout(v),v=setTimeout(N,e.random(6e4,12e4))}function N(){r.isConnected()&&(w=!0,n.publish("updater.frontendReloading"),window.location.reload())}return delete window[m],delete window.FRONTEND_SERVICE,delete window.BACKEND_SERVICE,g.versions=S&&S.time>a.appData?S:T,g.isRestarting=function(){return _||b},g.isBackendRestarting=function(){return _},g.isFrontendRestarting=function(){return b},g.isFrontendReloading=function(){return w},g.enableViews=function(){A=!0},g.disableViews=function(){A=!1},g.pull=function(e){r.emit("updater.pull",e)},g.getCurrentVersionString=function(){return g.versions.package},C(),r.on("updater.versions",function(t){var n=g.versions;g.versions=t,e.isEqual(e.omit(t,"time"),e.omit(n,"time"))||C(),t.frontend!==n.frontend&&R()}),i.subscribe("updater.newVersion",function(e){n.publish("updater.newVersion",e),e.service===k?function(){if(_)return;_=!0,A&&(null!==y&&y.remove(),y=new c({template:p,type:"backend"}),o.insertView(y).render(),y.$el.slideDown());n.subscribe("socket.connected").setLimit(1).on("message",function(){if(_=!1,y){var e=y;e.$el.slideUp(function(){y===e&&(y.remove(),y=null)}),n.publish("updater.backendRestarted")}}),n.publish("updater.backendRestarting")}():e.service===E&&R()}),n.subscribe("viewport.page.shown",function(e){!1!==window.WMES_UPDATER_BROWSER&&function(e){if("dashboard"!==e.pageId||-1===window.navigator.vendor.toLowerCase().indexOf("google")||"1"===window.sessionStorage.getItem("WMES_BROWSER_UPDATE"))return;var t=window.navigator.userAgent.match(/Chrome\/([0-9]+)/);if(!t)return;if(+t[1]>=h)return;o.showDialog(new l,s("updater","browserUpdate:title"))}(e),!1!==window.WMES_UPDATER_ADDRESS&&function(){if(/\.wmes\.pl$/.test(window.location.hostname)||"localhost"===window.location.hostname||"1"===window.sessionStorage.getItem("WMES_ADDRESS_UPDATE")||window.document.body.classList.contains("is-embedded"))return;t.ajax({method:"GET",url:"https://ket.wmes.pl/ping",dataType:"text"}).done(function(e){"pong"===e&&o.showDialog(new d,s("updater","addressUpdate:title"))})}()}),window.updater=g,g}),define("app/data/loadedModules",[],function(){"use strict";for(var e=window.MODULES||[],t={},n=0;n<e.length;++n)t[e[n]]=!0;return{list:e,map:t,isLoaded:function(e){return!0===t[e]}}}),define("app/core/templates/blankLayout",["underscore","jquery","app/i18n","app/time","app/user","app/core/util/forms"],function(_,$,t,time,user,forms){return function anonymous(locals,escapeFn,include,rethrow){escapeFn=escapeFn||function(e){return void 0==e?"":String(e).replace(_MATCH_HTML,encode_char)};var _ENCODE_HTML_RULES={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&#34;","'":"&#39;"},_MATCH_HTML=/[&<>'"]/g;function encode_char(e){return _ENCODE_HTML_RULES[e]||e}var __output="";function __append(e){void 0!==e&&null!==e&&(__output+=e)}with(locals||{})__append('<div class="blankLayout">\n  <div class="blank-page-bd"></div>\n</div>\n');return __output}}),define("app/core/layouts/BlankLayout",["underscore","jquery","app/user","../View","app/core/templates/blankLayout"],function(e,t,n,i,r){"use strict";var o=i.extend({pageContainerSelector:".blank-page-bd",template:r});return o.prototype.initialize=function(){this.model={id:null,className:null,breadcrumbs:[],title:null}},o.prototype.afterRender=function(){this.changeTitle(),null!==this.model.id&&this.setId(this.model.id),null!==this.model.className&&this.setClassName(this.model.className)},o.prototype.reset=function(){this.setId(null),this.setClassName(null),this.model.title=null,this.model.breadcrumbs=[],this.removeView(this.pageContainerSelector)},o.prototype.setUpPage=function(e){e.pageId&&this.setId(e.pageId),e.pageClassName&&this.setClassName(e.pageClassName),e.title&&this.setTitle(e.title,e),e.breadcrumbs&&this.setBreadcrumbs(e.breadcrumbs,e),e.breadcrumbs||e.title||this.changeTitle()},o.prototype.setId=function(e){return this.isRendered()&&this.$el.attr("data-id",e),this.model.id=e,this},o.prototype.setClassName=function(e){return document.body&&(this.model.className&&document.body.classList.remove(this.model.className),this.isRendered()&&e&&document.body.classList.add(e)),this.model.className=e,this},o.prototype.setTitle=function(e,t){return null==e?this:("function"==typeof e&&(e=e.call(t,this)),Array.isArray(e)||(e=[e]),this.model.title=e,this.changeTitle(),this)},o.prototype.setBreadcrumbs=function(e,t){return null==e?this:("function"==typeof e&&(e=e.call(t)),Array.isArray(e)||(e=[e]),this.model.breadcrumbs=e.map(function(e){var t=typeof e;return"string"!==t&&"function"!==t||(e={label:e}),e}),this.model.title||this.changeTitle(),this)},o.prototype.changeTitle=function(){if(this.isRendered()){var t=Array.isArray(this.model.title)?[].concat(this.model.title):e.pluck(this.model.breadcrumbs,"label");this.broker.publish("page.titleChanged",t)}},o}),define("app/mrpControllers/MrpController",["require","../i18n","../time","../core/Model","app/data/subdivisions"],function(e,t,n,i,r){"use strict";return i.extend({urlRoot:"/mrpControllers",clientUrlRoot:"#mrpControllers",topicPrefix:"mrpControllers",privilegePrefix:"DICTIONARIES",nlsDomain:"mrpControllers",labelAttribute:"_id",defaults:{subdivision:null,description:null,deactivatedAt:null,replacedBy:null,inout:0},getSubdivision:function(){return r.get(this.get("subdivision"))||null},serialize:function(){var i=this.toJSON();return i.subdivision=e("app/orgUnits/util/renderOrgUnitPath")(this,!0),i.deactivatedAt=i.deactivatedAt?n.format(i.deactivatedAt,"LL"):"",i.inout=t("mrpControllers","inout:"+i.inout),i},serializeRow:function(){var e=this.serialize();return e.className=this.get("deactivatedAt")?"is-deactivated":"",e}})}),define("app/mrpControllers/MrpControllerCollection",["../user","../core/Collection","./MrpController"],function(e,t,n){"use strict";return t.extend({model:n,rqlQuery:"sort(_id)",comparator:"_id",getForCurrentUser:function(){var t=e.getDivision(),n=e.getSubdivision();return this.filter(function(i){if(e.data.super||!t||"prod"!==t.get("type"))return!0;var r=i.getSubdivision();if(!r)return!0;if(n)return r.id===n.id;var o=r.get("division");return!o||o===t.id})}})}),define("app/data/mrpControllers",["app/mrpControllers/MrpControllerCollection","./createStorage"],function(e,t){"use strict";return t("MRP_CONTROLLERS","mrpControllers",e)}),define("app/prodFlows/ProdFlow",["../core/Model","app/data/mrpControllers"],function(e,t){"use strict";return e.extend({urlRoot:"/prodFlows",clientUrlRoot:"#prodFlows",topicPrefix:"prodFlows",privilegePrefix:"DICTIONARIES",nlsDomain:"prodFlows",labelAttribute:"name",defaults:{mrpController:null,name:null,deactivatedAt:null},parse:function(e){return"string"==typeof e.mrpController?e.mrpController=[e.mrpController]:Array.isArray(e.mrpController)||(e.mrpController=[]),e},getSubdivision:function(){var e=this.get("mrpController");if(!Array.isArray(e)||!e.length)return null;var n=t.get(e[0]);return n?n.getSubdivision():null}})}),define("app/prodFlows/ProdFlowCollection",["../core/Collection","./ProdFlow"],function(e,t){"use strict";return e.extend({model:t,rqlQuery:"select(mrpController,name,deactivatedAt)&sort(name)",comparator:"name"})}),define("app/data/prodFlows",["app/prodFlows/ProdFlowCollection","./createStorage"],function(e,t){"use strict";return t("PROD_FLOWS","prodFlows",e)}),define("app/workCenters/WorkCenter",["../core/Model","app/data/mrpControllers","app/data/prodFlows"],function(e,t,n){"use strict";return e.extend({urlRoot:"/workCenters",clientUrlRoot:"#workCenters",topicPrefix:"workCenters",privilegePrefix:"DICTIONARIES",nlsDomain:"workCenters",labelAttribute:"_id",defaults:{mrpController:null,prodFlow:null,description:null,deactivatedAt:null},getSubdivision:function(){var e;if(this.get("mrpController"))e=t.get(this.get("mrpController"));else{var i=n.get(this.get("prodFlow"));i&&(e=t.get((i.get("mrpController")||[])[0]))}return e?e.getSubdivision():null}})}),define("app/workCenters/WorkCenterCollection",["../core/Collection","./WorkCenter"],function(e,t){"use strict";return e.extend({model:t,rqlQuery:"select(mrpController,prodFlow,description,deactivatedAt)&sort(_id)",comparator:"_id"})}),define("app/data/workCenters",["app/workCenters/WorkCenterCollection","./createStorage"],function(e,t){"use strict";return t("WORK_CENTERS","workCenters",e)}),define("app/prodLines/ProdLine",["../core/Model","../data/workCenters"],function(e,t){"use strict";return e.extend({urlRoot:"/prodLines",clientUrlRoot:"#prodLines",topicPrefix:"prodLines",privilegePrefix:"DICTIONARIES",nlsDomain:"prodLines",labelAttribute:"_id",defaults:{workCenter:null,description:null,inventoryNo:null,deactivatedAt:null},getSubdivision:function(){var e=t.get(this.get("workCenter"));return e?e.getSubdivision():null}})}),define("app/prodLines/ProdLineCollection",["../user","../core/Collection","./ProdLine"],function(e,t,n){"use strict";return t.extend({model:n,rqlQuery:"select(workCenter,description,inventoryNo,deactivatedAt)&sort(workCenter,_id)",getForCurrentUser:function(){var t=e.getDivision(),n=e.getSubdivision();return this.filter(function(i){if(e.data.super||!t||"prod"!==t.get("type"))return!0;var r=i.getSubdivision();if(!r)return!0;if(n)return r.id===n.id;var o=r.get("division");return!o||o===t.id})}})}),define("app/data/prodLines",["app/prodLines/ProdLineCollection","./createStorage"],function(e,t){"use strict";return t("PROD_LINES","prodLines",e)}),define("app/data/orgUnits",["./divisions","./subdivisions","./mrpControllers","./prodFlows","./workCenters","./prodLines"],function(e,t,n,i,r,o){"use strict";var a={division:"subdivision",subdivision:"mrpController",mrpController:"prodFlow",mrpControllers:"prodFlow",prodFlow:"workCenter",workCenter:"prodLine",prodLine:null},s={prodLine:"workCenter",workCenter:"prodFlow",prodFlow:"mrpController",mrpController:"subdivision",mrpControllers:"subdivision",subdivision:"division",division:null},u={division:e,subdivision:t,mrpController:n,mrpControllers:n,prodFlow:i,workCenter:r,prodLine:o};return{TYPES:{division:!0,subdivision:!0,mrpController:!0,mrpControllers:!0,prodFlow:!0,workCenter:!0,prodLine:!0},getCollection:function(e){return u[e]||null},getProdFlowsForSubdivision:function(e){return"string"==typeof e&&(e=t.get(e)),e?i.filter(function(t){return t.getSubdivision()===e}):[]},getAllByType:function(e){return u[e].models},getActiveByType:function(e,t){return t||(t=function(){return!0}),u[e].models.filter(function(e){return!e.get("deactivatedAt")&&t(e)})},getAllDivisions:function(){return e.models},getAllForProdLine:function(a){"string"==typeof a&&(a=o.get(a));var s={division:null,subdivision:null,mrpControllers:null,prodFlow:null,workCenter:null,prodLine:null};if(!a)return s;s.prodLine=a.id;var u=r.get(a.get("workCenter"));if(!u)return s;s.workCenter=u.id;var c=i.get(u.get("prodFlow"));if(!c)return s;s.prodFlow=c.id;var l=c.get("mrpController");if(!Array.isArray(l)||!l.length)return s;if(s.mrpControllers=l,!(l=n.get(l[0])))return s;var d=t.get(l.get("subdivision"));if(!d)return s;s.subdivision=d.id;var p=e.get(d.get("division"));return p?(s.division=p.id,s):s},getType:function(a){if(null===a)return null;if(a.constructor===o.model)return"prodLine";if(a.constructor===r.model)return"workCenter";if(a.constructor===i.model)return"prodFlow";if(a.constructor===n.model)return"mrpController";if(a.constructor===t.model)return"subdivision";if(a.constructor===e.model)return"division";throw new Error("Unknown org unit type!")},getChildType:function(e){return a[e]||"division"},getChildren:function(e){var t=this.getType(e),n=this.getChildType(t),i=u[n];return i?function(e,t,n){return e.filter(function(e){var i=e.get(t);return!!i&&(Array.isArray(i)?-1!==i.indexOf(n.id):i===n.id)})}(i,t,e):[]},getByTypeAndId:function(e,t){var n=u[e];return n&&n.get(t)||null},getParent:function(e){if(!e)return null;var t=this.getType(e),n=s[t],i=e.get(n);return!i||Array.isArray(i)&&!i.length?null:this.getByTypeAndId(n,Array.isArray(i)?i[0]:i)},RELATION_TYPES:{SIBLINGS:"siblings",TYPES:"types",CHILD:"child",DIFFERENT_CHILD:"differentChild",PARENT:"parent",DIFFERENT_PARENT:"differentParent",UNRELATED:"unrelated"},getRelationType:function(e,t,n,i){if(null===e&&"division"===n)return this.RELATION_TYPES.CHILD;if("division"===e&&null===n)return this.RELATION_TYPES.PARENT;var r=this.getByTypeAndId(e,t),o=this.getByTypeAndId(n,i);return e===n?this.getParent(r)===this.getParent(o)?this.RELATION_TYPES.SIBLINGS:this.RELATION_TYPES.TYPES:a[e]===n?this.getParent(o)===r?this.RELATION_TYPES.CHILD:this.RELATION_TYPES.DIFFERENT_PARENT:s[e]===n?this.getParent(r)===o?this.RELATION_TYPES.PARENT:this.RELATION_TYPES.DIFFERENT_CHILD:this.RELATION_TYPES.UNRELATED},getDivisionFor:function(n){return n?n.constructor===e.model?n:(n.constructor!==t.model&&(n=this.getSubdivisionFor(n)),this.getParent(n)):null},getSubdivisionFor:function(n){return n&&n.constructor!==e.model?n.constructor===t.model?n:this.getSubdivisionFor(this.getParent(n)):null},containsProdLine:function(e,t,n){if("prodLine"===e)return Array.isArray(t)?-1!==t.indexOf(n):t===n;for(var i=this.getByTypeAndId("prodLine",n);;){var r=this.getParent(i);if(!r)return!1;if(this.getType(r)===e)return Array.isArray(t)?-1!==t.indexOf(r.id):t===r.id;i=r}}}}),define("app/data/prodLog",["underscore","jquery","app/i18n","app/user","app/time","app/broker","app/socket","app/data/localStorage","app/updater/index"],function(e,t,n,i,r,o,a,s,u){"use strict";var c=window.INSTANCE_ID,l="PRODUCTION:LOG",d="PRODUCTION:LOG:SYNCING",p="PRODUCTION:LOCK",f=null,h=!1,m=null,g=null,v=e.debounce(y,33);function y(e){if(h&&null===f&&!u.isRestarting()&&null!==(f=s.getItem(l)||null)){var n=s.getItem(d)||null;null!==n&&(f=n+"\n"+f),s.setItem(d,f),s.setItem(l,""),s.removeItem(l),o.publish("production.syncing");var i=t.ajax({method:"POST",url:"/prodLogEntries",contentType:"text/plain; charset=UTF-8",data:f,timeout:1e4});i.fail(function(t){var n=s.getItem(l)||null;n=null===n?f:f+"\n"+n,s.setItem(l,n),s.setItem(d,""),s.removeItem(d),f=null,o.publish("production.synced",{message:t.responseText}),e=e?e+1:1,setTimeout(y,Math.min(1e3*e,2e4),e)}),i.done(function(e){s.setItem(d,""),s.removeItem(d),f=null,o.publish("production.synced",null),e&&e.lock&&o.publish("production.locked",e.lock),setTimeout(y,100)})}}function _(e,t){return e.getTime().toString(36)+function(e){for(var t=0,n=0,i=e.length;n<i;++n)t=(t<<5)-t+e.charCodeAt(n)|0;return t}(t||"").toString(36)+Math.round(1e16*Math.random()).toString(36)}function b(e,t,n,o){return o||(o=r.getMoment().toDate()),{_id:_(o,e.id),instanceId:c,secretKey:e.getSecretKey(),type:t,data:n||{},createdAt:o,creator:i.getInfo(),division:e.get("division"),subdivision:e.get("subdivision"),mrpControllers:e.get("mrpControllers"),prodFlow:e.get("prodFlow"),workCenter:e.get("workCenter"),prodLine:e.prodLine.id,station:e.prodLine.station,prodShift:e.id,prodShiftOrder:e.prodShiftOrder.id||null}}return o.subscribe("socket.connected",setTimeout.bind(null,y,1337)),window.addEventListener("unload",function(){if(null===f)return;var e=s.getItem(l);null===e?s.setItem(l,f):s.setItem(l,f+"\n"+e);f=null,s.setItem(d,""),s.removeItem(d),o.publish("production.synced",{message:"DISCONNECT"})}),{generateId:_,isEnabled:function(){return h},enable:function(e){if(h)e&&(m=setTimeout(function(){m=null,e.resolve()},1));else if(e){g&&clearInterval(g),m&&clearTimeout(m),window.removeEventListener("storage",n),window.addEventListener("storage",n);var t=window.parent!==window||"development"===window.ENV;g=setInterval(function(){s.setItem(p,JSON.stringify({instanceId:c,time:Date.now()}))},t?333333:333),m=setTimeout(function(){m=null,e&&"pending"===e.state()&&(h=!0,setTimeout(y,1e3),e.resolve())},t?1:2e3)}else h=!0;function n(t){if(t.key===p){var n=JSON.parse(t.newValue);n.instanceId!==c&&(e?(e.reject(),e=null):o.publish("production.duplicateDetected",{thisInstanceId:c,thatInstanceId:n.instanceId}))}}},disable:function(){h&&(m&&(clearTimeout(m),m=null),g&&(clearInterval(g),g=null),h=!1)},isSyncing:function(){return null!==f},create:b,record:function(e,t,n,i){if(!e.isLocked()){if(!h)throw new Error("Production log is disabled!");var r,o="object"==typeof t?t:b(e,t,n,i),a=s.getItem(l);r=null===a?JSON.stringify(o):a+"\n"+JSON.stringify(o),s.setItem(l,r),e.saveLocalData(),v()}}}}),define("app/core/util/getShiftEndDate",["app/time"],function(e){"use strict";return function(t,n){var i=e.getMoment(t);return 1===n?i.hours(6):2===n?i.hours(14):i.hours(22),i.add(8,"hours").subtract(1,"seconds"),i.toDate()}}),define("app/orgUnits/util/renderOrgUnitPath",["underscore","app/data/divisions","app/data/subdivisions","app/data/mrpControllers","app/data/workCenters","app/data/prodFlows","app/data/prodLines"],function(e,t,n,i,r,o,a){"use strict";return function(e,u,c){if(!e)return"?";var l=[],d="???";return(e.constructor!==a.model||(l.unshift(e),d=e.get("workCenter"),e=r.get(d)))&&(e.constructor!==r.model||(l.unshift(e),d=e.get("prodFlow")||e.get("mrpController"),e=e.get("prodFlow")?o.get(d):i.get(d)))?e.constructor!==o.model||(l.unshift(e),(e=(d=e.get("mrpController")||[]).map(function(e){return i.get(e)}).filter(function(e){return!!e})).length)?(!(e.constructor===i.model||e[0]&&e[0].constructor===i.model)||(l.unshift(e),d=(e[0]||e).get("subdivision"),e=n.get(d)))&&(e.constructor!==n.model||(l.unshift(e),d=e.get("division"),e=t.get(d)))?(e.constructor===t.model&&l.unshift(e),!1!==c&&l.pop(),0===l.length?"???":l.map(function(e){return Array.isArray(e)?e.map(function(e){return s(e,u)}).join("; "):s(e,u)}).join(" \\ ")):"???"+d+"???":"???"+d.join("; ")+"???":"???"+d+"???"};function s(t,n){var i=e.escape(t.getLabel());if(null===n)return i;var r=t.get("deactivatedAt")?"text-decoration: line-through!important":"";return n?'<a href="'+t.genClientUrl()+'" style="'+r+'">'+i+"</a>":'<span style="'+r+'">'+i+"</span>"}}),define("app/core/templates/userInfo",["underscore","app/core/util/html"],function(e,t){"use strict";return function(n,i){if(!n)return"";if(n.userInfo?n=(i=n).userInfo:i||(i={}),!n)return"";var r=t.tag("span",{className:"userInfo-label",title:n.title||""},e.escape(n.label)),o=n.cname||n.ip||"";return o=o&&!0!==i.noIp?"0.0.0.0"===o?"":" "+t.tag("span",{className:"userInfo-cname"},"("+e.escape(o)+")"):"",t.tag("span",{className:"userInfo","data-clickable":!1===i.clickable?"0":"1","data-user-id":n.id||""},r+o)}}),define("app/orders/util/resolveProductName",[],function(){"use strict";return function(e){return e?/^[A-Z]/.test(e.nc12)?(e.description||e.name||"").trim():(e.name||e.description||"").trim():""}}),define("app/prodDowntimes/util/decorateProdDowntimeChange",["underscore","app/time","app/i18n","app/data/aors","app/data/downtimeReasons","app/core/templates/userInfo"],function(e,t,n,i,r,o){"use strict";n=n.forDomain("prodDowntimes");var a={"WMES:ALERTS:START":function(e){var t=e.alert;return n("comments:alerts:start",{alertName:t.name,recipientCount:t.recipients.length,recipientList:t.recipients.join(", ")})},"WMES:ALERTS:NOTIFY":function(e){var t=e.alert;return n("comments:alerts:notify",{alertName:t.name,recipientCount:t.recipients.length,recipientList:t.recipients.join(", ")})},"WMES:ALERTS:FINISH":function(e){return n("comments:alerts:finish",{alertName:e.alert.name})},"WMES:SPIGOT:INITIAL":function(e){return n("comments:spigot:initial",{name:e.component.name,nc12:e.component.nc12})},"WMES:SPIGOT:FINAL":function(e){return n("comments:spigot:final",{name:e.component.name,nc12:e.component.nc12})}};function s(e,a){switch(e){case"startedAt":case"finishedAt":return t.format(a,"L, LTS");case"master":case"leader":case"operator":return o({userInfo:a});case"status":return n("PROPERTY:status:"+a);case"reason":var s=r.get(a);return s?s.getLabel():a;case"aor":var u=i.get(a);return u?u.getLabel():a;default:return a||""}}return function(i){var r=/^WMES:/.test(i.comment)?a[i.comment]:null;return{time:t.toTagData(i.date),user:o({userInfo:i.user}),changes:r?[]:e.map(i.data,function(e,t){return{label:n("PROPERTY:"+t),oldValue:s(t,e[0]),newValue:s(t,e[1])}}),comment:r?r(i.data):i.comment.trim()}}}),define("app/prodDowntimes/util/decorateProdDowntime",["underscore","app/time","app/i18n","app/user","app/data/aors","app/data/subdivisions","app/data/mrpControllers","app/data/prodFlows","app/data/prodLines","app/data/downtimeReasons","app/orgUnits/util/renderOrgUnitPath","app/core/templates/userInfo","app/orders/util/resolveProductName","./decorateProdDowntimeChange"],function(e,t,n,i,r,o,a,s,u,c,l,d,p,f){"use strict";return function(a,h){var m=i.isAllowedTo("PROD_DATA:VIEW"),g=h&&h.longDate?"LLLL":"L, LTS",v=a.toJSON();v.statusClassName=a.getCssClassName(),v.statusText=n("prodDowntimes","PROPERTY:status:"+v.status),v.className=v.statusClassName,v.reasonComment&&v.reasonComment.trim().length&&(v.className+=" is-withReasonComment");var y=r.get(v.aor);v.aor=y?y.getLabel():v.aor;var _=u.get(v.prodLine);_&&(v.prodLine=_.getLabel(),v.prodLinePath=l(_,!1,!1));var b=c.get(v.reason);v.reason=b?b.getLabel():v.reason,v.duration=a.getDurationString(h&&h.currentTime),v.startedAt=Date.parse(v.startedAt),v.startedAtDate=t.format(v.startedAt,"L"),v.startedAtTime=t.format(v.startedAt,"LTS"),v.startedAt=t.format(v.startedAt,g),v.autoIcon=v.auto?'<i class="fa fa-clock-o" title="'+n("prodDowntimes","auto")+'"></i>':"",v.autoIcon&&(v.startedAt+=" "+v.autoIcon),v.finishedAt=v.finishedAt?t.format(v.finishedAt,g):n("prodDowntimes","NO_DATA:finishedAt"),v.corroboratedAt=t.format(v.corroboratedAt,g)||"",v.order=v.prodShiftOrder?v.orderId+"; "+v.operationNo:n("prodDowntimes","NO_DATA:order"),m&&v.prodShiftOrder&&(v.order='<a href="#prodShiftOrders/'+(v.prodShiftOrder._id||v.prodShiftOrder)+'">'+v.order+"</a>");var w=o.get(v.subdivision),A=s.get(v.prodFlow);v.subdivision=w?w.getLabel():"",v.prodFlow=A?A.getLabel():"",v.mrpControllers=Array.isArray(v.mrpControllers)&&v.mrpControllers.length?v.mrpControllers.join("; "):"";var k=v.prodShiftOrder;if(v.orderData?(v.productName=v.orderData.name,v.productFamily=v.orderData.family,v.orderMrp='<span title="'+v.mrpControllers+'">'+(v.orderData.mrp||"")+"</span>"):v.orderMrp="<em>"+v.mrpControllers+"</em>",k&&k.orderData){var E=k.orderData;v.orderData||(v.productName=p(E),v.productFamily=v.productName.substring(0,6)),E.operations&&E.operations[v.operationNo]&&(v.operationName=E.operations[v.operationNo].name)}v.date=v.date?t.format(v.date,"L"):"?",v.shift=v.shift?n("core","SHIFT:"+v.shift):"?",v.prodShiftText=v.date+", "+v.shift,m&&v.prodShift&&(v.prodShiftText='<a href="#prodShifts/'+v.prodShift+'">'+v.prodShiftText+"</a>"),v.masterInfo=d({userInfo:v.master}),v.leaderInfo=d({userInfo:v.leader}),Array.isArray(v.operators)&&v.operators.length?v.operatorInfo=v.operators.map(function(e){return d({userInfo:e})}).join("; "):v.operatorInfo=d({userInfo:v.operator}),v.creatorInfo=d({userInfo:v.creator}),v.corroboratorInfo=d({userInfo:v.corroborator}),v.history=!Array.isArray(v.changes)||h&&!0===h.noHistory?[]:v.changes.map(f);var T=v.changesCount;return T&&h&&h.changesCount&&(T.reason&&(v.reason+=' <span title="'+n("prodDowntimes","changesCount:reason")+'" class="label label-'+(T.reason>=h.maxReasonChanges?"danger":"warning")+'">'+T.reason+"</span>"),T.aor&&(v.aor+=' <span title="'+n("prodDowntimes","changesCount:aor")+'" class="label label-'+(T.aor>=h.maxAorChanges?"danger":"warning")+'">'+T.aor+"</span>")),v.prodFlowText=v.prodFlow,h&&h.productFamily&&v.productFamily&&(v.prodFlow='<span class="label label-default" title="'+e.escape(v.productName)+'">'+e.escape(v.productFamily)+"</span> "+v.prodFlow),v}}),define("app/prodDowntimes/ProdDowntime",["../time","../user","../core/Model","../core/util/getShiftEndDate","../data/aors","../data/downtimeReasons","./util/decorateProdDowntime"],function(e,t,n,i,r,o,a){"use strict";var s={undecided:"warning",confirmed:"success",rejected:"danger",null:"primary"};return n.extend({urlRoot:"/prodDowntimes",clientUrlRoot:"#prodDowntimes",topicPrefix:"prodDowntimes",privilegePrefix:"PROD_DOWNTIMES",nlsDomain:"prodDowntimes",labelAttribute:"rid",defaults:{division:null,subdivision:null,mrpControllers:null,prodFlow:null,workCenter:null,prodLine:null,prodShift:null,prodShiftOrder:null,date:null,shift:null,aor:null,reason:null,reasonComment:null,decisionComment:null,status:null,startedAt:null,finishedAt:null,corroborator:null,corroboratedAt:null,creator:null,master:null,leader:null,operator:null,operators:null,mechOrder:null,orderId:null,operationNo:null},url:function(){var e=n.prototype.url.apply(this,arguments);return this.isNew()?e:e+"?populate(prodShiftOrder)"},serializeRow:function(e){return a(this,{changesCount:!0,currentTime:e})},serializeDetails:function(){return a(this,{longDate:!0})},getReasonLabel:function(){var e=this.get("reason"),t=o.get(e);return t?t.get("label"):e},getAorLabel:function(){var e=this.get("aor"),t=r.get(e);return t?t.get("name"):e},getCssClassName:function(e){return s[void 0===e?this.get("status"):e]},finish:function(){if(null!=this.get("finishedAt"))return null;var t=e.getMoment().toDate(),n=i(this.get("date"),this.get("shift"));return t>n&&(t=n),this.set("finishedAt",t),{_id:this.id,finishedAt:t}},isEditable:function(){return null!=this.get("finishedAt")&&null===this.get("pressWorksheet")},canCorroborate:function(){return t.isLoggedIn()&&null===this.get("pressWorksheet")},canChangeStatus:function(e){if(!this.get("finishedAt"))return 0;if(e.canManageProdData)return 2;var t=this.get("status");if(!e.canManageProdDowntimes||"confirmed"===t)return 0;var n=this.get("changesCount");return!n||n.rejected>=e.maxRejectedChanges||n.reason>=e.maxReasonChanges||n.aor>=e.maxAorChanges?0:e.hasAccessToAor(this.get("aor"))?1:0},getDuration:function(e){var t=Date.parse(this.get("startedAt"));return(Date.parse(this.get("finishedAt"))||e||Date.now())-t},getDurationString:function(t,n){var i=this.getDuration(t);return e.toString(Math.round(i/1e3),n)},isBreak:function(){var e=o.get(this.get("reason"));return e&&"break"===e.get("type")}},{STATUS:{UNDECIDED:"undecided",CONFIRMED:"confirmed",REJECTED:"rejected"},parse:function(e){return["date","startedAt","finishedAt","createdAt","corroboratedAt"].forEach(function(t){"string"==typeof e[t]&&(e[t]=new Date(e[t]))}),e}})}),define("app/core/util/matchesEquals",["underscore"],function(e){"use strict";return function(t,n,i){if(void 0===i)return!0;var r=e.find(t.selector.args,function(e){return("eq"===e.name||"in"===e.name)&&e.args[0]===n});return!r||("eq"===r.name?String(r.args[1])===String(i):Array.isArray(r.args[1])&&-1!==r.args[1].indexOf(i))}}),define("app/orgUnits/util/limitOrgUnits",["underscore","app/user"],function(e,t){"use strict";return function(n,i){i=e.assign({active:!0,division:!0,subdivision:!0,divisionType:null,subdivisionType:null},i);var r=t.getSubdivision();if(!i.subdivision||!r||i.active&&!r.isActive()||i.subdivisionType&&r.get("type")!==i.subdivisionType){var o=t.getDivision();return!i.division||!o||i.active&&!o.isActive()||i.divisionType&&o.get("type")!==i.divisionType||n.push({name:"eq",args:["division",o.id]}),n}n.push({name:"eq",args:["subdivision",r.id]})}}),define("app/prodDowntimes/ProdDowntimeCollection",["underscore","../time","../user","../data/prodLog","../core/Collection","../core/util/matchesEquals","../data/orgUnits","../orgUnits/util/limitOrgUnits","./ProdDowntime"],function(e,t,n,i,r,o,a,s,u){"use strict";var c={eq:!0,ne:!0,in:!0,nin:!0};return r.extend({model:u,rqlQuery:function(e){var i=[{name:"in",args:["status",["undecided","rejected"]]},{name:"ge",args:["startedAt",t.getMoment().subtract(2,"weeks").startOf("day").hours(6).valueOf()]}];n.isAllowedTo("PROD_DOWNTIMES:ALL")||s(i,{divisionType:"prod"});var r=n.data.aors;return Array.isArray(r)&&(1===r.length?i.push({name:"eq",args:["aor",r[0]]}):r.length>1&&i.push({name:"in",args:["aor",r]})),e.Query.fromObject({fields:{changes:0},sort:{startedAt:-1},limit:-1337,selector:{name:"and",args:i}})},findFirstUnfinished:function(){return this.find(function(e){return null==e.get("finishedAt")})},finish:function(){var e=this.findFirstUnfinished();return e?e.finish():null},addFromInfo:function(e,r){var o=e.get("date"),a=r.startedAt||t.getMoment().toDate();a<o&&(a=new Date(o.getTime()));var s=new u({division:e.get("division"),subdivision:e.get("subdivision"),subdivisionType:e.prodShiftOrder.get("subdivisionType"),mrpControllers:e.get("mrpControllers"),prodFlow:e.get("prodFlow"),workCenter:e.get("workCenter"),prodLine:e.prodLine.id,prodShift:e.id,prodShiftOrder:e.prodShiftOrder.id||null,date:o,shift:e.get("shift"),aor:r.aor,reason:r.reason,reasonComment:r.reasonComment,status:u.STATUS.UNDECIDED,startedAt:a,creator:n.getInfo(),master:e.get("master"),leader:e.get("leader"),operator:e.get("operator"),operators:e.get("operators"),mechOrder:e.prodShiftOrder.get("mechOrder"),orderId:e.prodShiftOrder.get("orderId"),operationNo:e.prodShiftOrder.get("operationNo"),auto:r.auto||null});s.set("_id",i.generateId(s.get("startedAt"),e.id+r.aor));for(var c=this.rqlQuery.limit<1?1/0:this.rqlQuery.limit;this.length>=c;)this.pop({silent:!0});return this.unshift(s),s},hasOrMatches:function(e){if(e._id&&this.get(e._id))return!0;return o(this.rqlQuery,"status",e.status)&&this.matchProp("aor",e)&&this.matchProp("reason",e)&&this.matchProp(a.TYPES,e)&&o(this.rqlQuery,"prodShift",e.prodShift)&&o(this.rqlQuery,"prodShiftOrder",e.prodShiftOrder)&&o(this.rqlQuery,"orderId",e.orderId)},matchProp:function(t,n){if("string"==typeof t){var i=t;(t={})[i]=!0}var r=e.find(this.rqlQuery.selector.args,function(e){return c[e.name]&&t[e.args[0]]});if(!r)return!0;var o=r.args[0],a=r.args[1],s=n[o];return"eq"===r.name?s===a:"ne"===r.name?s!==a:"in"===r.name?-1!==a.indexOf(s):"nin"!==r.name||-1===a.indexOf(s)},refresh:function(e){for(var t=this.toJSON(),n=(e=e.map(function(e){return u.parse(e)})).length?e[0].startedAt:Number.MAX_VALUE,i=t.length-1;i>=0;--i){var r=t[i];r.startedAt>n&&e.unshift(r)}for(;e.length>8;)e.pop();this.reset(e)}})}),define("app/prodShiftOrders/ProdShiftOrder",["underscore","app/i18n","app/user","app/time","app/data/prodLog","app/data/orgUnits","app/data/downtimeReasons","app/core/Model","app/core/util/getShiftStartInfo","app/core/util/getShiftEndDate","app/core/templates/userInfo","app/orders/util/resolveProductName"],function(e,t,n,i,r,o,a,s,u,c,l,d){"use strict";return s.extend({urlRoot:"/prodShiftOrders",clientUrlRoot:"#prodShiftOrders",topicPrefix:"prodShiftOrders",privilegePrefix:"PROD_DATA",nlsDomain:"prodShiftOrders",initialize:function(e,t){s.prototype.initialize.apply(this,arguments),this.settings=t?t.settings:null},getLabel:function(e){return(!1===e?"":this.get("prodLine")+": ")+this.get("orderId")+", "+this.get("operationNo")},serialize:function(e){var r=this.toJSON(),a=Date.parse(r.startedAt),s=Date.parse(r.finishedAt);if(r.date)r.date=i.format(r.date,"L");else{var c=u(r.startedAt);r.date=c.moment.format("L"),r.shift=c.no}if(e.details&&!s&&(s=Date.now()),r.shift=t("core","SHIFT:"+r.shift),r.startedAt=i.format(r.startedAt,"LTS"),r.finishedAt=i.format(r.finishedAt,"LTS"),r.duration=i.toString((s-a)/1e3,!e.details),r.creator=l(r.creator),e.orgUnits){var p=o.getByTypeAndId("subdivision",r.subdivision),f=o.getByTypeAndId("prodFlow",r.prodFlow);r.subdivision=p?p.getLabel():"?",r.prodFlow=f?f.getLabel():"?",r.mrpControllers=Array.isArray(r.mrpControllers)&&r.mrpControllers.length?r.mrpControllers.join(" "):""}if(r.prodShift=r.prodShift?'<a href="#prodShifts/'+r.prodShift+'">'+r.date+", "+r.shift+"</a>":r.date+", "+r.shift,r.orderData){var h=(r.orderData.operations||{})[r.operationNo]||{};r.productName=d(r.orderData),r.operationName=h.name||"",r.order=r.orderId,r.operation=r.operationNo,r.productName&&(r.order+=": "+r.productName),r.operationName&&(r.operation+=": "+r.operationName),r.planOrderGroup=r.orderData.planOrderGroup&&r.orderData.planOrderGroup.name||""}else r.productName="",r.operationName="",r.order=r.orderId,r.operation=r.operationNo,r.planOrderGroup="";n.isAllowedTo("ORDERS:VIEW")&&(r.orderUrl="#"+(r.mechOrder?"mechOrders":"orders")+"/"+encodeURIComponent(r.orderId)),r.mechOrder?(r.product=r.orderId+": "+r.productName,r.orderId=""):r.product=(r.orderData&&r.orderData.nc12?r.orderData.nc12+": ":"")+r.productName,r.taktTimeOk=this.isTaktTimeOk(),r.taktTimeSap=this.getTaktTime(),r.taktTime=this.getActualTaktTime(),r.taktTimeEff=this.getTaktTimeEfficiency(),r.workerCount=r.workerCount.toLocaleString(),r.workerCountSap=this.getWorkerCountSap(),r.eff=0,r.efficiency="";var m=this.getEfficiency(e);return m?(r.eff=m,r.efficiency=Math.round(100*m)+"%"):r.taktTimeEff&&(r.eff=r.taktTimeEff/100,r.efficiency=r.taktTimeEff+"%"),r},serializeRow:function(e){var t=this.serialize(e);t.eff&&this.get("sapTaktTime")&&(t.eff>=1?t.className="success":t.eff<.9?t.className="danger":t.className="warning");var n=this.get("mrpControllers")||[],i=this.get("orderData"),r=i&&i.mrp;return r&&-1===n.indexOf(r)?(t.mrpControllersText="+"+r+"\n-"+t.mrpControllers,t.mrpControllers=r+' <span style="text-decoration: line-through">'+t.mrpControllers+"</span>"):t.mrpControllersText=t.mrpControllers,t.orderUrl&&(t.orderId='<a href="'+t.orderUrl+'">'+t.orderId+"</a>"),t},serializeDetails:function(e){return this.serialize(Object.assign({orgUnits:!0,orderUrl:!0,details:!0},e))},onShiftChanged:function(){this.clear()},onOrderChanged:function(e,t,r,o){this.prepareOperations(t);var a=e.get("date"),s=i.getMoment().toDate();s<a&&(s=new Date(a.getTime())),this.set({prodShift:e.id,division:e.get("division"),subdivision:e.get("subdivision"),mrpControllers:e.get("mrpControllers"),prodFlow:e.get("prodFlow"),workCenter:e.get("workCenter"),prodLine:e.prodLine.id,date:a,shift:e.get("shift"),mechOrder:null===t.no,subdivisionType:e.getSubdivisionType(),orderId:t.no||t.nc12,operationNo:r,orderData:t,workerCount:o,totalQuantity:0,quantityDone:0,quantityLost:0,losses:null,creator:n.getInfo(),startedAt:s,finishedAt:null,master:e.get("master"),leader:e.get("leader"),operator:e.get("operator"),operators:e.get("operators"),spigot:null,sapTaktTime:null,lastTaktTime:null,avgTaktTime:null,totalQuantityDone:null}),this.set("sapTaktTime",this.getSapTaktTime()),this.generateId(e)},onOrderCorrected:function(e,t,i){var r=t.no||t.nc12;if(r===this.get("orderId")&&i===this.get("operationNo"))return null;this.prepareOperations(t);var o=this.get("spigot");o&&(o.forceCheck=!0);var a={mechOrder:null===t.no,orderId:r,operationNo:i,orderData:t,creator:n.getInfo()};return this.set(a),this.set("sapTaktTime",this.getSapTaktTime()),a.sapTaktTime=this.get("sapTaktTime"),this.get("workerCount")>this.getMaxWorkerCount()&&e.changeWorkerCount(0),this.get("quantityDone")>this.getMaxQuantityDone()&&e.changeQuantityDone(0),a},onOrderContinued:function(e){this.set({prodShift:e.id,division:e.get("division"),subdivision:e.get("subdivision"),mrpControllers:e.get("mrpControllers"),prodFlow:e.get("prodFlow"),workCenter:e.get("workCenter"),prodLine:e.prodLine.id,date:e.get("date"),shift:e.get("shift"),subdivisionType:e.getSubdivisionType(),workerCount:0,totalQuantity:0,quantityDone:0,quantityLost:0,losses:null,creator:n.getInfo(),startedAt:i.getMoment().toDate(),finishedAt:null,master:e.get("master"),leader:e.get("leader"),operator:e.get("operator"),operators:e.get("operators"),spigot:null,sapTaktTime:null,lastTaktTime:null,avgTaktTime:null,totalQuantityDone:null}),this.set("sapTaktTime",this.getSapTaktTime()),this.generateId(e)},generateId:function(e){this.set("_id",r.generateId(this.get("startedAt"),e.id+this.get("orderId")))},onWorkEnded:function(){this.clear()},isMechOrder:function(){return this.get("mechOrder")},getOrderNo:function(){var e=this.get("orderData");return e?e.no||"?":"-"},getNc12:function(){var e=this.get("orderData");return e?e.nc12||"?":"-"},getProductName:function(){var e=this.get("orderData");return e?d(e)||"?":"-"},getOperation:function(){var e=this.get("orderData"),t=this.get("operationNo");return e&&t&&e.operations&&e.operations[t]?e.operations[t]:null},getOperationName:function(){var e=this.getOperation(),t=this.get("operationNo");return(e?e.name:"")||t||"-"},getDurationString:function(e,t){var n=Date.parse(this.get("startedAt")),r=Date.parse(this.get("finishedAt"))||e||Date.now();return i.toString(Math.round((r-n)/1e3),t)},getEfficiencyClassName:function(e){var t=this.getEfficiency(e);return t>=1?"is-eff-high":t>=.9?"is-eff-mid":"is-eff-low"},getEfficiency:function(e){return this.constructor.getEfficiency(this.attributes,e)},getTaktTimeEfficiency:function(){var e=parseFloat(this.get("sapTaktTime")||this.getSapTaktTime())||0,t=parseFloat(this.getActualTaktTime())||0;return e&&t?Math.round(e/t*100):0},isTaktTimeOk:function(){return(Math.round(this.get("avgTaktTime")/1e3)||0)<=(this.get("sapTaktTime")||0)},getSapTaktTime:function(){var e=this.get("orderData"),t=this.get("operationNo");if(!e||!t)return 0;var n=e.operations?e.operations[t]:null;if(!n)return 0;var i=this.get("workerCount");if(i||(i=this.getWorkerCountSap()),"number"!=typeof i||0===i||n.laborTime<=0)return 0;var r=this.constructor.getTaktTimeCoeff(this.attributes);return Math.max(Math.round(n.laborTime*r/i*3600/100),1)},getIptTaktTime:function(){return Math.round((this.get("iptTaktTime")||0)/1e3)},getLastTaktTime:function(){return Math.round((this.get("lastTaktTime")||0)/1e3)},getAvgTaktTime:function(){return Math.round((this.get("avgTaktTime")||0)/1e3)},getTaktTime:function(){return this.get("orderData")&&this.get("operationNo")?this.getSapTaktTime()||"?":"-"},getActualTaktTime:function(){var e=this.getAvgTaktTime();if(e)return e;var t=i.getMoment(this.get("finishedAt"));if(!t.isValid())return"-";var n=t.diff(this.get("startedAt"),"seconds"),r=this.get("quantityDone");return r?Math.max(1,Math.round(n/r)):"?"},getWorkerCountSap:function(){var e=this.get("orderData"),t=this.get("operationNo");if(!e||!t)return"-";var n=e.operations?e.operations[t]:null;return!n||n.laborTime<=0||n.machineTime<=0?"?":Math.max(Math.round(n.laborTime/n.machineTime),1)},getWorkerCount:function(){return this.get("workerCount")||0},getWorkerCountForEdit:function(){var e=this.getWorkerCount();return 0!==e?e:"string"==typeof(e=this.getWorkerCountSap())||0===e?0:e},getMaxWorkerCount:function(){var e=this.getWorkerCountSap();return e>0?Math.ceil(1.25*e):15},getMaxQuantityDone:function(){var e=this.get("orderData");return e&&e.qty?Math.ceil(1.25*e.qty):9999},getStartedAt:function(){var e=this.get("startedAt");return e?i.format(e,"LTS"):"?"},getQuantityDone:function(){return this.get("quantityDone")||0},getSubdivisionType:function(){var e=o.getByTypeAndId("subdivision",this.get("subdivision"));return e?e.get("type"):null},getSpigotComponent:function(t,n){var i=this.get("orderData");if(e.isEmpty(t)||!i||!Array.isArray(i.bom))return null;t=t.split("\n").map(function(e){return new RegExp(e,"i")}),n=e.isEmpty(n)?[]:n.split("\n").map(function(e){return new RegExp(e,"i")});for(var r=i.bom,o=0;o<r.length;++o){var a=r[o];if(this.isValidSpigotComponent(a,t,n)){if(e.isEmpty(a.nc12)){var s=a.name.match(/([0-9]{12})/);if(!s)continue;a=e.assign({},a,{nc12:s[1]})}return a}}return null},isValidSpigotComponent:function(e,t,n){for(var i=0;i<n.length;++i)if(n[i].test(e.name))return!1;for(var r=0;r<t.length;++r)if(t[r].test(e.name))return!0;return!1},getSpigotInsertComponent:function(t){if(!t)return null;var n={};(t||"").split("\n").forEach(function(e){var t=e.split(":"),i=t[0].trim();t[1].split(", ").forEach(function(e){n[e.trim()]=i})});var i=this.getNc12(),r=n[i];return r?e.find(this.get("orderData").bom,function(e){return e.nc12===r}):null},getOrderIdType:function(){return"assembly"===this.getSubdivisionType()?"no":"nc12"},hasOrderData:function(){return!!this.get("orderId")&&!!this.get("operationNo")&&!!this.get("orderData")},isEditable:function(){return this.hasEnded()&&!this.isFromPressWorksheet()},hasEnded:function(){return null!=this.get("finishedAt")},isFromPressWorksheet:function(){return null!=this.get("pressWorksheet")},finish:function(){if(!this.id||this.hasEnded())return null;var e=i.getMoment().toDate(),t=c(this.get("date"),this.get("shift"));return e>t&&(e=t),this.set("finishedAt",e),{_id:this.id,finishedAt:e}},prepareOperations:function(t){if(Array.isArray(t.operations)){var n={};t.operations.forEach(function(e){""!==e.workCenter&&-1!==e.laborTime&&(n[e.no]=e)}),t.operations=n}else e.isObject(t.operations)||(t.operations={});return t}},{parse:function(e){return["date","startedAt","finishedAt","createdAt"].forEach(function(t){"string"==typeof e[t]&&(e[t]=new Date(e[t]))}),e},getEfficiency:function(e,t){var n=e.workDuration||t&&t.workDuration||0;if(!n&&t&&t.prodDowntimes){var i=Date.now(),r=Date.parse(e.startedAt),o=e.finishedAt?Date.parse(e.finishedAt):i;n=o-r,t.prodDowntimes.forEach(function(t){var r=t.get("prodShiftOrder"),o=r&&r._id||r;if(!e._id||e._id===o){var s=a.get(t.get("reason"));if(!s||"break"===s.get("type")){var u=Date.parse(t.get("startedAt")),c=t.get("finishedAt")?Date.parse(t.get("finishedAt")):i;n-=c-u}}}),n/=36e5}if(n<=0)return 0;var s=this.getTaktTimeCoeff(e),u=e.laborTime*s/100*e.quantityDone/(n*e.workerCount);return isNaN(u)||!isFinite(u)?0:u},getOperation:function(e){return e.orderData&&e.orderData.operations&&e.orderData.operations[e.operationNo]||null},getTaktTimeCoeff:function(e){return this.getWcTaktTimeCoeff(e.orderData&&e.orderData.taktTimeCoeff,this.getOperation(e))},getWcTaktTimeCoeff:function(e,t){return e&&t&&(e[t.workCenter+"/"+t.no]||e["*/"+t.no]||e[t.workCenter]||e["*"])||1}})}),define("app/core/util/matchesProdLine",["underscore","app/user","app/data/prodLines"],function(e,t,n){"use strict";return function(i,r){var o=e.find(i.selector.args,function(e){return"eq"===e.name&&"prodLine"===e.args[0]});if(o)return o.args[1]===r;if(t.data.super)return!0;var a=n.get(r);if(!a)return!0;var s=t.getDivision();if(!s)return!0;var u=t.getSubdivision(),c=a.getSubdivision();return u?u===c:s.id===c.get("division")}}),define("app/prodShiftOrders/ProdShiftOrderCollection",["../time","../data/prodLines","../core/Collection","../core/util/matchesEquals","../core/util/matchesProdLine","../orgUnits/util/limitOrgUnits","./ProdShiftOrder"],function(e,t,n,i,r,o,a){"use strict";return n.extend({model:a,theadHeight:2,rqlQuery:function(t){var n=[{name:"ge",args:["startedAt",e.getMoment().subtract(2,"weeks").valueOf()]},{name:"eq",args:["mechOrder",!1]}];return o(n,{divisionType:"prod"}),t.Query.fromObject({fields:{"orderData.bom":0,"orderData.documents":0},sort:{startedAt:-1},limit:-1337,selector:{name:"and",args:n}})},hasOrMatches:function(e){return!!this.get(e._id)||r(this.rqlQuery,e.prodLine)&&i(this.rqlQuery,"orderId",e.orderId)&&i(this.rqlQuery,"orderMrp",e.orderMrp)&&i(this.rqlQuery,"shift",e.shift)}})}),define("app/isaPalletKinds/IsaPalletKind",["../core/Model"],function(e){"use strict";return e.extend({urlRoot:"/isaPalletKinds",clientUrlRoot:"#isaPalletKinds",topicPrefix:"isaPalletKinds",privilegePrefix:"DICTIONARIES",nlsDomain:"isaPalletKinds",labelAttribute:"shortName"})}),define("app/isaPalletKinds/IsaPalletKindCollection",["../core/Collection","./IsaPalletKind"],function(e,t){"use strict";return e.extend({model:t,rqlQuery:"sort(shortName)",comparator:"shortName"})}),define("app/data/isaPalletKinds",["app/isaPalletKinds/IsaPalletKindCollection","./createStorage"],function(e,t){"use strict";return t("ISA_PALLET_KINDS","isaPalletKinds",e)}),define("app/isa/IsaRequest",["underscore","../time","../i18n","../core/Model","../data/orgUnits","../data/isaPalletKinds","app/core/templates/userInfo"],function(e,t,n,i,r,o,a){"use strict";var s={new:"debug",accepted:"warning",finished:"success",cancelled:"danger"};function u(t){var n=e.last(t);if(n&&"prodLine"===n.type)return n.id;var i=e.find(t,function(e){return"prodLine"===e.type});return i?i.id:null}function c(e){if(["requestedAt","respondedAt","finishedAt"].forEach(function(t){"string"==typeof e[t]&&(e[t]=new Date(e[t]))}),e.orgUnits&&!e.orgUnit){var t=u(e.orgUnits),n=r.getAllForProdLine(t),i=r.getByTypeAndId("prodLine",n.prodLine),o=r.getByTypeAndId("prodFlow",n.prodFlow);n.prodLine=i?r.getByTypeAndId("prodLine",n.prodLine).getLabel().toUpperCase().replace(/(_+|~.*?)$/,"").replace(/_/g," "):t,n.prodFlow=o?o.getLabel().replace(/\s+(;|,)/g,"$1"):"?",e.orgUnit=n}return e}return i.extend({urlRoot:"/isaRequests",clientUrlRoot:"#isa/requests",topicPrefix:"isaRequests",privilegePrefix:"ISA",nlsDomain:"isa",parse:c,initialize:function(){this.updateOrgUnits(),this.updateTime()},updateOrgUnits:function(e){var t=r.getAllForProdLine(this.getProdLineId()),n=r.getByTypeAndId("prodLine",t.prodLine),i=r.getByTypeAndId("prodFlow",t.prodFlow);t.prodLine=((n?n.getLabel():this.getProdLineId())||"").toUpperCase().replace(/(_+|~.*?)$/,"").replace(/_/g," "),t.prodFlow=i?i.getLabel().replace(/\s+(;|,)/g,"$1"):"?",this.set("orgUnit",t,{silent:e})},updateTime:function(e){this.set("time",t.toTagData(this.get("requestedAt"),!0),{silent:e})},serialize:function(){var e=this.toJSON();return e.qty=this.getQty(),e.palletKind=this.getPalletKind().label,e.palletKindFull=this.getFullPalletKind(),e.whman=this.getWhman().label,e},serializeRow:function(){var e=this.toJSON();return e.className=s[e.status],e.line=this.getProdLineId(),e.type=n("isa","requests:type:"+e.type,{qty:e.data.qty||8,palletKind:e.data.palletKind?e.data.palletKind.label:"?"}),e.status=n("isa","requests:status:"+e.status),e.requester=a({userInfo:e.requester}),e.responder=a({userInfo:e.responder}),e.finisher=a({userInfo:e.finisher}),e.requestedAt=t.format(e.requestedAt,"LL, LTS"),e.respondedAt=e.respondedAt?t.format(e.respondedAt,"LTS"):"-",e.finishedAt=e.finishedAt?t.format(e.finishedAt,"LTS"):"-",e.duration=t.toString(this.getDuration()),e.request=n("isa","requests:date+user",{date:e.requestedAt,user:e.requester}),e.response="-"===e.respondedAt?"-":n("isa","requests:time+user",{time:e.respondedAt,user:e.responder}),e.finish="-"===e.finishedAt?"-":n("isa","requests:time+user",{time:e.finishedAt,user:e.finisher}),e},getProdLineId:function(){return u(this.get("orgUnits"))},getPalletKind:function(){var e=this.get("data");return e&&e.palletKind||{id:"",label:""}},getQty:function(){var e=this.get("data");return e&&e.qty||8},getFullPalletKind:function(){var e=this.getPalletKind(),t=o.get(e.id);return t?t.get("fullName"):"?"},getWhman:function(){return this.get("responder")||{id:"",label:"?"}},isCompleted:function(){return"finished"===this.get("status")||"cancelled"===this.get("status")},getDuration:function(){return this.isCompleted()?this.get("duration"):(Date.now()-Date.parse(this.get("requestedAt")))/1e3},matchResponder:function(e){if(!e)return!0;var t=this.get("responder");return t&&t.id===e.id}},{parse:c})}),define("app/isa/IsaRequestCollection",["jquery","../core/Collection","./IsaRequest"],function(e,t,n){"use strict";return t.extend({model:n,rqlQuery:"sort(-requestedAt)&limit(-1337)",parse:function(e){return t.prototype.parse.call(this,e).map(n.parse)},getFirstPickup:function(){return this.find(function(e){return"pickup"===e.get("type")})},getFirstDelivery:function(){return this.find(function(e){return"delivery"===e.get("type")})},act:function(t,n){var i=this,r=i.url;t.requestId&&(r="/isaActiveRequests/"+this.get(t.requestId).getProdLineId());var o=e.ajax({method:"PATCH",url:r,data:JSON.stringify(t)});return i.trigger("request",this,o,{}),o.fail(function(e){var t=e.responseJSON?e.responseJSON.error:null;t||(t={message:e.statusText}),t.statusCode=e.status,n(t),i.trigger("error",o)}),o.done(function(e){n(null,e),i.trigger("sync",e,o)}),o},pickup:function(e,t){return this.act({action:"requestPickup",secretKey:e},t)},deliver:function(e,t,n,i){return this.act({action:"requestDelivery",secretKey:n,palletKind:e,qty:t},i)},cancel:function(e,t,n){return this.act({action:"cancelRequest",secretKey:t,requestId:e},n)},accept:function(e,t,n){return this.act({action:"acceptRequest",responder:t,requestId:e},n)},finish:function(e,t){return this.act({action:"finishRequest",requestId:e},t)}},{active:function(){return new this(null,{url:"/isaActiveRequests",comparator:function(e,t){return e=e.attributes,t=t.attributes,null===e.requestedAt?1:null===t.requestedAt?-1:e.type!==t.type?"delivery"===e.type?-1:1:e.requestedAt-t.requestedAt}})},activeForLine:function(e){return new this(null,{url:"/isaActiveRequests/"+e})}})}),define("app/core/util/bindLoadingMessage",["app/i18n","app/viewport"],function(e,t){"use strict";return function(n,i,r,o){return i.listenTo(n,"request",function(n,i,a){"read"===a.syncMethod&&(!1!==a.showLoadingMessage&&t.msg.loading(),i.done(function(e){!1!==e.showLoadingMessage&&t.msg.loaded()}.bind(null,a)),i.fail(function(n,i){var a=i.statusText;if("abort"===a)return void(!1!==n.showLoadingMessage&&t.msg.loaded());var s=i.responseJSON;s&&s.error&&(s.error.code?a=s.error.code:s.error.message&&(a=s.error.message));!1!==n.showLoadingMessage&&t.msg.loadingFailed(e(o||"core",r||"MSG:LOADING_FAILURE",{code:a}))}.bind(null,a)))}),n}}),define("app/data/createSettings",["app/pubsub","app/core/util/bindLoadingMessage"],function(e,t){"use strict";return function(n){var i=null,r=null,o=null;function a(){o=null,null!==r&&(i.destroy(),i=null,r=null)}return{bind:function(e,n){return e.settings=t(this.acquire(n),e),e.on("beforeLoad",function(t,n){n.unshift(e.settings.fetchIfEmpty())}),e.once("afterRender",this.acquire.bind(this,null)),e.once("remove",this.release.bind(this)),e.settings},acquire:function(t){return null!==o&&(clearTimeout(o),o=null),null===r&&(t||(t={}),t.pubsub=i=e.sandbox(),t.paginate=!1,r=new n(null,t)),r},release:function(){null!==o&&clearTimeout(o),o=setTimeout(a,3e4)}}}}),define("app/settings/Setting",["../core/Model"],function(e){"use strict";return e.extend({urlRoot:"/settings",clientUrlRoot:"#settings",topicPrefix:"settings",privilegePrefix:"SETTINGS",nlsDomain:"core",defaults:{value:null},getValue:function(){return this.get("value")}})}),define("app/settings/SettingCollection",["underscore","jquery","app/core/Collection","./Setting"],function(e,t,n,i){"use strict";return n.extend({model:i,rqlQuery:"select(value)",matchSettingId:null,topicSuffix:"**",initialize:function(e,t){t.pubsub&&this.setUpPubsub(t.pubsub)},setUpPubsub:function(t){var n=this,i=Array.isArray(n.topicSuffix)?n.topicSuffix:[n.topicSuffix];e.forEach(i,function(e){t.subscribe("settings.updated."+e,function(e){var t=n.get(e._id);t?t.set(e):n.add(e)})})},fetchIfEmpty:function(e,n){if(!this.isEmpty())return e?e.call(n):null;var i=t.Deferred(),r=this.fetch({reset:!0});return e?(r.done(function(){var r=[].concat(e.call(n));t.when.apply(t,r).then(function(){i.resolve()},function(){i.reject()})}),i.promise()):r},update:function(n,i){if(void 0===(i=this.prepareValue(n,"string"==typeof i?i.trim():i)))return t.Deferred().reject().promise();var r=this.get(n);if(r){if(e.isEqual(r.getValue(),i))return t.Deferred().resolve().promise()}else this.add({_id:n,value:null}),r=this.get(n);return r.save({value:i})},prepareValue:function(e,t){return t},prepareObjectIdValue:function(e){if(null===e||""===e)return null;var t=String(e).toLowerCase();return/^[a-f0-9]{24}$/.test(t)?t:void 0},prepareMultiObjectIdValue:function(e){return String(e).toLowerCase().split(",").filter(function(e){return/^[a-f0-9]{24}$/.test(e)})},prepareMultiSelect2Value:function(e){return String(e||"").split(",").filter(function(e){return e.length>0})},prepareNumericValue:function(e,t,n,i){var r=parseInt(e,10);return isNaN(r)?i:null!=t&&r<t?t:null!=n&&r>n?n:r},prepareFloatValue:function(e,t,n,i){var r=parseFloat(e);return isNaN(r)?i:null!=t&&r<t?t:null!=n&&r>n?n:r},prepareFormValue:function(e,t){return t||""},getValue:function(e,t){var n=this.get((this.idPrefix||"")+e);return n?n.getValue():null==t?null:t}})}),define("app/production/ProductionSetting",["../settings/Setting"],function(e){"use strict";return e.extend({urlRoot:"/production/settings"})}),define("app/production/ProductionSettingCollection",["underscore","jquery","../data/localStorage","../settings/SettingCollection","../prodShiftOrders/ProdShiftOrder","./ProductionSetting"],function(e,t,n,i,r,o){"use strict";return i.extend({model:o,topicSuffix:"production.**",nlsDomain:"production",initialize:function(e,t){i.prototype.initialize.apply(this,arguments),this.resetCache(),t.localStorage&&this.setUpLocalStorage(),this.on("reset change",this.resetCache)},resetCache:function(){this.cache={taktTimeEnabled:{}}},getValue:function(e){var t=this.get("production."+e);return t?t.getValue():null},prepareValue:function(t,n){return/rearmDowntimeReason$/.test(t)?e.isEmpty(n)?null:n:/spigot(Not)?Patterns$/.test(t)?this.prepareSpigotPatterns(n):/lines$/i.test(t)?this.prepareLines(n):/spigot.*?Groups$/.test(t)?this.prepareSpigotGroups(n):/(spigotFinish|enabled|last|avg|sap|smiley)$/.test(t)?!!n:/taktTime.coeffs$/.test(t)?this.mapTaktTimeCoeffs(n):/ignoredDowntimes$/i.test(t)?this.prepareMultiSelect2Value(n):/lineAutoDowntimes$/.test(t)&&Array.isArray(n)?n:this.prepareNumericValue(n,0,60)},prepareFormValue:function(e,t){return/taktTime.coeffs$/.test(e)?this.prepareTaktTimeCoeffs(t):i.prototype.prepareFormValue.apply(this,arguments)},prepareSpigotPatterns:function(e){return"string"!=typeof e?void 0:e.split("\n").filter(function(e){try{new RegExp(e)}catch(e){return!1}return!!e.trim().length}).join("\n")},prepareLines:function(e){return"string"!=typeof e?void 0:e.split(",").filter(function(e){return!!e.length}).join(",")},prepareSpigotGroups:function(e){return(e||"").split("\n").map(function(e){var t=e.split(/[^0-9]+/).filter(function(e){return e.length>0});return 0===t.length?"":t.shift()+": "+t.join(", ")}).join("\n").replace(/\n{2,}/g,"\n")},getAutoDowntimes:function(t){var n=e.find(this.getValue("lineAutoDowntimes"),function(n){return e.includes(n.lines,t)});return n?(n.downtimes.sort(function(e,t){return e.when===t.when?0:"initial"===e.when?-1:"initial"===t.when?1:"always"===e.when?-1:"always"===t.when?1:0}),n.downtimes):[]},isTaktTimeEnabled:function(t){var n=this.cache.taktTimeEnabled[t];return void 0!==n?n:(n=!!this.getValue("taktTime.enabled")&&(!t||!e.includes((this.getValue("taktTime.ignoredLines")||"").split(","),t)),this.cache.taktTimeEnabled[t]=n,n)},showLastTaktTime:function(){return!!this.getValue("taktTime.last")},showAvgTaktTime:function(){return!!this.getValue("taktTime.avg")},showSapTaktTime:function(){return!!this.getValue("taktTime.sap")},showSmiley:function(){return!!this.getValue("taktTime.smiley")},mapTaktTimeCoeffs:function(e){if(!e)return{};var t="",n=0,i={};return e.replace(/\s*:\s*/g,": ").replace(/\s*<\s*/g," <").replace(/\s*=\s*/g,"=").split(/\s+/).forEach(function(e){if(/^(\*|[A-Z0-9_]+):$/i.test(e))return t=e.substring(0,e.length-1).toUpperCase(),void(n=0);if(/^<(\*|[0-9]+)$/.test(e))n=parseInt(e.substring(1),10)||0;else{var r=e.match(/^(\*|[A-Z0-9_]+)(\/(?:\*|[0-9])+)?=([0-9]+(?:[.,][0-9]+)?)$/i);if(r){var o=r[1].toUpperCase(),a=r[2]&&"*"!==r[2]?r[2]:"",s=parseFloat(r[3].replace(",","."));i[t]||(i[t]={0:{}}),i[t][n]||(i[t][n]={}),i[t][n][o+a]=s}}}),Object.keys(i).forEach(function(e){var t=[];Object.keys(i[e]).sort(function(e,t){return"0"===e?-1:"0"===t?1:t-e}).forEach(function(n){t.push({qty:+n,wcs:i[e][n]})}),i[e]=t}),i},prepareTaktTimeCoeffs:function(e){return Object.keys(e||{}).sort(function(e,t){return e.localeCompare(t,void 0,{ignorePunctuation:!0,numeric:!0})}).map(function(t){var n=t+":",i="".padStart(n.length," "),r=e[t].reduce(function(e,t){return Math.max(e,t.qty.toString().length)},0);return e[t].forEach(function(e){var t=e.qty?e.qty.toString():"*",o=i+" <"+t+"".padEnd(r-t.length," "),a="".padStart(o.length," "),s=Object.keys(e.wcs);n+="\n"+o,s.sort(function(e,t){return e.localeCompare(t,void 0,{ignorePunctuation:!0,numeric:!0})}).forEach(function(t,i){n+=" "+t+"="+e.wcs[t],(i+1)%10==0&&i!==s.length-1&&(n+="\n"+a)})}),n}).join("\n")},setUpLocalStorage:function(){this.length||this.readLocalData(),this.on("reset change",this.saveLocalData.bind(this))},readLocalData:function(){try{this.reset(JSON.parse(n.getItem("PRODUCTION:SETTINGS")))}catch(e){}},saveLocalData:function(){n.setItem("PRODUCTION:SETTINGS",JSON.stringify(this.models))}})}),define("app/production/settings",["../data/createSettings","./ProductionSettingCollection"],function(e,t){"use strict";return e(t)}),define("app/production/templates/bomChecker",["underscore","jquery","app/i18n","app/time","app/user","app/core/util/forms"],function(_,$,t,time,user,forms){return function anonymous(locals,escapeFn,include,rethrow){escapeFn=escapeFn||function(e){return void 0==e?"":String(e).replace(_MATCH_HTML,encode_char)};var _ENCODE_HTML_RULES={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&#34;","'":"&#39;"},_MATCH_HTML=/[&<>'"]/g;function encode_char(e){return _ENCODE_HTML_RULES[e]||e}var __output="";function __append(e){void 0!==e&&null!==e&&(__output+=e)}with(locals||{})__append('<table class="production-bomChecker">\n  <tbody id="'),__append(id("components")),__append('"></tbody>\n</table>\n');return __output}}),define("app/production/templates/bomCheckerRow",["underscore","jquery","app/i18n","app/time","app/user","app/core/util/forms"],function(_,$,t,time,user,forms){return function anonymous(locals,escapeFn,include,rethrow){escapeFn=escapeFn||function(e){return void 0==e?"":String(e).replace(_MATCH_HTML,encode_char)};var _ENCODE_HTML_RULES={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&#34;","'":"&#39;"},_MATCH_HTML=/[&<>'"]/g;function encode_char(e){return _ENCODE_HTML_RULES[e]||e}var __output="";function __append(e){void 0!==e&&null!==e&&(__output+=e)}with(locals||{})__append('<tr class="production-bomChecker-component" data-id="'),__append(component._id),__append('" data-status="'),__append(component.status),__append('">\n  <td class="production-bomChecker-icon"><i class="fa '),__append(component.icon),__append('"></i></td>\n  <td>\n    '),"000000000000"!==component.nc12&&(__append('\n    <span class="production-bomChecker-nc12">'),__append(component.nc12),__append("</span>\n    ")),__append('\n    <span class="production-bomChecker-description">'),__append(escapeFn(component.description)),__append('</span>\n  </td>\n  <td>\n    <span class="production-bomChecker-scanBuffer">'),__append(escapeFn(component.scanInfo.raw)),__append('</span>\n    <span class="production-bomChecker-message">'),__append(component.message),__append('</span>\n    <a class="production-bomChecker-reset" href="#">×</a>\n  </td>\n</tr>\n');return __output}}),define("app/production/views/BomCheckerDialogView",["jquery","app/i18n","app/viewport","app/core/View","app/production/templates/bomChecker","app/production/templates/bomCheckerRow"],function(e,t,n,i,r,o){"use strict";return i.extend({snManagerMode:"bom",template:r,dialogClassName:"production-modal production-bomChecker-modal",events:{"click .production-bomChecker-reset":function(e){return this.updateComponent(this.components[this.$(e.target).closest("tr").attr("data-id")],"todo"),!1}},initialize:function(){var e=this.model.orderData,n=this.model.logEntry.data;this.components=[{_id:0,status:n.serialNo?"success":"todo",nc12:e.no,description:e.description,single:!0,unique:!0,patternInfo:{pattern:function(e){var t=e.match(/([A-Z0-9]{4}\.([0-9]{9})\.([0-9]{4}))$/);return t&&/^[A-Z0-9]+\.[0-9]+\.[0-9]+\.[A-Z0-9]+$/.test(e)&&(t=null),t},nc12:[2],sn:[3]},scanInfo:{raw:n.serialNo?n._id:"?",nc12:e.no,sn:n.serialNo},icon:n.serialNo?"fa-thumbs-up":"fa-question",message:t("production","bomChecker:message:"+(n.serialNo?"success":"todo")+":sn")}].concat(this.model.components.map(function(e,n){return{_id:n+1,status:"todo",nc12:e.nc12,description:e.description,single:e.single,unique:e.unique,patternInfo:{pattern:new RegExp(e.labelPattern),nc12:e.nc12Index,sn:e.snIndex},scanInfo:{raw:"?",nc12:"",sn:""},icon:"fa-question",message:t("production","bomChecker:message:todo")}}))},afterRender:function(){var e=this,t=[];e.components.forEach(function(n){t.push(e.renderPartial(o,{component:n}))}),e.$id("components").append(t)},onSnScanned:function(e){for(var t=e._id,n=0;n<this.components.length;++n){var i=this.components[n],r="function"==typeof i.patternInfo.pattern?i.patternInfo.pattern(t):t.match(i.patternInfo.pattern);if(r){if(i.unique&&i.scanInfo.raw===t)return this.updateComponent(i,"todo");if(i.single||"success"!==i.status&&"checking"!==i.status)return i.scanInfo.raw=t,0===i._id?(i.scanInfo.nc12=e.orderNo,i.scanInfo.sn=e.serialNo):(i.scanInfo.nc12=i.nc12,i.scanInfo.sn="",i.patternInfo.nc12.forEach(function(e){r[e]&&(i.scanInfo.nc12=r[e])}),i.patternInfo.sn.forEach(function(e){r[e]&&(i.scanInfo.sn=r[e])})),this.handleComponent(i)}}this.snMessage.show(e,"error","BOM_CHECKER:NO_MATCH")},handleComponent:function(e){var n=this;if(e.scanInfo.nc12!==e.nc12)return n.updateComponent(e,"failure",t("production","bomChecker:message:nc12",{nc12:e.nc12}));if(e.unique){n.updateComponent(e,"checking");var i=n.ajax({method:"POST",url:"/production/checkAnySerialNumber",data:JSON.stringify({sn:0===e._id?e.scanInfo.raw:e.scanInfo.nc12+":"+e.scanInfo.sn}),timeout:2e4});i.fail(function(){n.updateComponent(e,"failure")}),i.done(function(i){i?n.updateComponent(e,"failure",t("production","bomChecker:message:used"+(0===e._id?":sn":""),{psn:i})):r()})}else r();function r(){n.updateComponent(e,"success"),n.timers&&(clearTimeout(n.timers.checkAll),n.timers.checkAll=setTimeout(n.checkAll.bind(n),333))}},checkAll:function(){if(!this.components.filter(function(e){return"success"!==e.status}).length){var e=this.model.logEntry.data;e.scannedAt=new Date,e.bom=[],this.components.forEach(function(t){0===t._id?(e.orderNo=t.scanInfo.nc12,e.serialNo=t.scanInfo.sn):e.bom.push(t.scanInfo.nc12+":"+t.scanInfo.sn)}),this.trigger("checked",this.model.logEntry)}},updateComponent:function(e,n,i){switch(n&&(e.status=n),e.status){case"checking":e.icon="fa-spinner fa-spin";break;case"failure":e.icon="fa-thumbs-down";break;case"success":e.icon="fa-thumbs-up";break;case"todo":e.icon="fa-question",e.scanInfo.raw="?"}e.message=i||t("production","bomChecker:message:"+e.status+(0===e._id?":sn":"")),0===e._id&&(this.model.logEntry.data._id=e.scanInfo.raw,this.model.logEntry.data.serialNo=e.scanInfo.sn),this.$('tr[data-id="'+e._id+'"]').replaceWith(this.renderPartial(o,{component:e}))}})}),define("app/production/templates/snMessage",["underscore","jquery","app/i18n","app/time","app/user","app/core/util/forms"],function(_,$,t,time,user,forms){return function anonymous(locals,escapeFn,include,rethrow){escapeFn=escapeFn||function(e){return void 0==e?"":String(e).replace(_MATCH_HTML,encode_char)};var _ENCODE_HTML_RULES={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&#34;","'":"&#39;"},_MATCH_HTML=/[&<>'"]/g;function encode_char(e){return _ENCODE_HTML_RULES[e]||e}var __output="";function __append(e){void 0!==e&&null!==e&&(__output+=e)}with(locals||{})__append('<div id="snMessage" class="production-snMessage hidden">\n  <div class="production-snMessage-outer">\n    <div class="production-snMessage-inner">\n      <p id="snMessage-text" class="production-snMessage-text"></p>\n      <div class="production-snMessage-props">\n        '),["scannedValue","orderNo","serialNo"].forEach(function(e){__append('\n        <p class="production-snMessage-prop">\n          <span class="production-snMessage-prop-name">'),__append(t("production","snMessage:"+e)),__append('</span>\n          <span id="snMessage-'),__append(e),__append('" class="production-snMessage-prop-value">?</span>\n        </p>\n        ')}),__append("\n      </div>\n    </div>\n  </div>\n</div>\n");return __output}}),define("app/nls/production",["app/nls/locale/en"],function(e){var t={lc:{pl:function(t){return e(t)},en:function(t){return e(t)}},c:function(e,t){if(!e)throw new Error("MessageFormat: Data required for '"+t+"'.")},n:function(e,t,n){if(isNaN(e[t]))throw new Error("MessageFormat: '"+t+"' isn't a number.");return e[t]-(n||0)},v:function(e,n){return t.c(e,n),e[n]},p:function(e,n,i,r,o){return t.c(e,n),e[n]in o?o[e[n]]:(n=t.lc[r](e[n]-i))in o?o[n]:o.other},s:function(e,n,i){return t.c(e,n),e[n]in i?i[e[n]]:i.other}};return{root:{"breadcrumbs:base":function(e){return"Operator"},"breadcrumbs:settings":function(e){return"Settings"},"duplicate:title":function(e){return"Duplicate operator form"},"duplicate:message":function(e){return"Detected another operator form already running.<br>Close all other operator forms and click the button below to reload the form in the current window."},"duplicate:button":function(e){return"Reload operator form"},"msg:shiftChange":function(e){return"New shift!"},"msg:locked":function(e){return"Production line was deactivated!"},userLabel:function(e){return"Operator"},"controls:dashboard":function(e){return"Go to dashboard"},"controls:lock":function(e){return"Lock the line"},"controls:unlock":function(e){return"Unlock the line"},"controls:locked":function(e){return"Line locked"},"controls:unlocked":function(e){return"Line unlocked"},"controls:sync":function(e){return"Server communication indicator"},"controls:addNearMiss":function(e){return"Add near miss"},"controls:addSuggestion":function(e){return"Add suggestion"},"controls:addObservation":function(e){return"Add observation"},"controls:msg:sync:noConnection":function(e){return"Cannot unlock: no connection to the server."},"controls:msg:sync:remoteError":function(e){return"Cannot unlock: failed to get the key."},"controls:msg:sync:success":function(e){return"Line unlocked successfully."},"controls:msg:popup":function(e){return"The popup window has been blocked."},"controls:mor":function(e){return"Matrix of responsibility"},"controls:componentLabels":function(e){return"Component label printing"},"controls:extraPsn":function(e){return"Extra serial number scanning"},"unlockDialog:title:unlock":function(e){return"Production line activation"},"unlockDialog:title:lock":function(e){return"Production line deactivation"},"unlockDialog:message:unlock":function(e){return"To activate the <em>"+t.v(e,"prodLine")+"</em> production line, enter login and password of a user with the <em>WMES Operator client activation</em> privilege. Production line cannot be activated, if it is currently connected to the server from another computer."},"unlockDialog:message:lock":function(e){return"To deactivate the <em>"+t.v(e,"prodLine")+"</em> production line, enter login and password of a user with the <em>WMES Operator client activation</em> privilege."},"unlockDialog:login":function(e){return"Login"},"unlockDialog:password":function(e){return"Password"},"unlockDialog:prodLine":function(e){return"Production line"},"unlockDialog:station":function(e){return"Workstation number"},"unlockDialog:unlock":function(e){return"Activate production line"},"unlockDialog:lock":function(e){return"Deactivate production line"},"unlockDialog:error:UNLOCK_FAILURE":function(e){return"Production line activation failed."},"unlockDialog:error:LOCK_FAILURE":function(e){return"Production line deactivation failed."},"unlockDialog:error:INVALID_PROD_LINE":function(e){return"Invalid production line."},"unlockDialog:error:NO_PRIVILEGES":function(e){return"Insufficient privileges."},"unlockDialog:error:INPUT":function(e){return"Invalid credentials."},"unlockDialog:error:MANY_MATCHES":function(e){return"Found many users with the same login."},"unlockDialog:error:UNSAFE_PASSWORD":function(e){return"Password cannot be equal to the login. Change your password."},"unlockDialog:error:ALREADY_UNLOCKED":function(e){return"Production line is currently running on a different computer."},"unlockDialog:error:DEACTIVATED":function(e){return"Production line is deactivated."},"section:data":function(e){return"Production data"},"section:history":function(e){return"History"},"section:quantities":function(e){return"Quantities done"},"section:downtimes":function(e){return"Downtimes"},"section:isa":function(e){return"Storage area"},"section:taktTime":function(e){return"Cycle time"},"section:sequence":function(e){return"Sequence"},"property:currentTime":function(e){return"Current time"},"property:shift":function(e){return"Shift"},"property:orgUnit":function(e){return"Subdivision"},"property:master":function(e){return"Master"},"property:master:change":function(e){return"(change)"},"property:master:noData:locked":function(e){return"none"},"property:master:noData:unlocked":function(e){return"(change master)"},"property:leader":function(e){return"Leader"},"property:leader:change":function(e){return"(change)"},"property:leader:noData:locked":function(e){return"none"},"property:leader:noData:unlocked":function(e){return"(change leader)"},"property:operator":function(e){return"Operator"},"property:operator:change":function(e){return"(change)"},"property:operator:noData:locked":function(e){return"none"},"property:operator:noData:unlocked":function(e){return"(change operator)"},"property:orderNo":function(e){return"Order no"},"property:orderNo:change":function(e){return"(change)"},"property:nc12":function(e){return"12NC"},"property:nc12:change":function(e){return"(change)"},"property:productName":function(e){return"Product name"},"property:operationName":function(e){return"Operation name"},"property:taktTime":function(e){return"Takt [s]"},"property:taktTime:checkSn":function(e){return"(check SN)"},"property:lastTaktTime":function(e){return"Cycle [s]"},"property:avgTaktTime":function(e){return"Avg. Cycle [s]"},"property:workerCountSap":function(e){return"Worker count as per SAP"},"property:createdAt":function(e){return"Started at"},"property:totalQuantityDone":function(e){return"Qty done in order"},"property:quantityDone":function(e){return"Quantity done"},"property:quantityDone:change":function(e){return"(change quantity)"},"property:workerCount":function(e){return"Worker count"},"property:workerCount:change:data":function(e){return"(change count)"},"property:workerCount:change:noData":function(e){return"(set count)"},"action:newOrder":function(e){return"New order"},"action:nextOrder":function(e){return"<i class='fa fa-forward' title='Order queue'></i>"},"action:continueOrder":function(e){return"Continue order"},"action:startDowntime":function(e){return"Downtime"},"action:startBreak":function(e){return"Break"},"action:endDowntime":function(e){return"End downtime"},"action:endWork":function(e){return"End work"},"action:emptyPallet":function(e){return"Empty pallet"},"action:fullPallet":function(e){return"Pallet"},"quantities:column:time":function(e){return"Time"},"quantities:column:planned":function(e){return"Planned"},"quantities:column:actual":function(e){return"Actual"},"quantities:unit":function(e){return"PCE"},"quantities:change":function(e){return"(change)"},"quantities:newValuePlaceholder":function(e){return"New quantity..."},"quantityEditor:title":function(e){return"Quantity done in an hour"},"quantityEditor:label:hour":function(e){return"Time:"},"quantityEditor:label:value":function(e){return"Quantity done:"},"quantityEditor:submit":function(e){return"Set quantity done"},"quantityEditor:cancel":function(e){return"Cancel"},"quantityEditor:maxQuantity":function(e){return"Value cannot be greater than "+t.v(e,"max")+"."},"personnelPicker:title:master":function(e){return"Changing master"},"personnelPicker:title:leader":function(e){return"Changing leader"},"personnelPicker:title:operator":function(e){return"Changing operator"},"personnelPicker:submit":function(e){return"Set employee"},"personnelPicker:cancel":function(e){return"Cancel"},"personnelPicker:recent":function(e){return"Employees working on this shift recently:"},"personnelPicker:matching":function(e){return"Matching employees:"},"personnelPicker:tooShort":function(e){return"Enter at least three initial letters of the employee's last name."},"personnelPicker:notFound":function(e){return"No matching employees were found."},"personnelPicker:online:label":function(e){return"Employee:"},"personnelPicker:offline:label":function(e){return"Employee:"},"personnelPicker:offline:warning":function(e){return"No connection to the server. You can only enter the employee's personnel ID."},"personnelPicker:embedded:label":function(e){return"Search employees by last name:"},"multiPersonnelPicker:title:operator":function(e){return"Changing operators"},"multiPersonnelPicker:submit":function(e){return"Set employees"},"multiPersonnelPicker:cancel":function(e){return"Cancel"},"multiPersonnelPicker:pick":function(e){return"Add employee"},"multiPersonnelPicker:back":function(e){return"Back to list"},"multiPersonnelPicker:recent":function(e){return"Employees working on this shift recently:"},"multiPersonnelPicker:matches":function(e){return"Matching employees:"},"multiPersonnelPicker:tooShort":function(e){return"Enter at least three initial letters of the employee's last name."},"multiPersonnelPicker:notFound":function(e){return"No matching employees were found."},"multiPersonnelPicker:empty":function(e){return"No employees were set for the current shift yet."},"multiPersonnelPicker:picked":function(e){return"Selected employees:"},"multiPersonnelPicker:online:label":function(e){return"New employee:"},"multiPersonnelPicker:offline:label":function(e){return"New employee's personnel ID:"},"multiPersonnelPicker:offline:warning":function(e){return"No connection to the server. You can only enter the employee's personnel ID."},"multiPersonnelPicker:embedded:label":function(e){return"Search employees by last name:"},"orderQueue:title":function(e){return"Setting orders queue"},"orderQueue:message:order":function(e){return"Enter an order number and select an operation to enqueue a next order."},"orderQueue:message:queue":function(e){return"Below is the current orders queue."},"orderQueue:message:empty":function(e){return"The orders queue is empty."},"orderQueue:submit":function(e){return"Set orders queue"},"orderQueue:enqueue":function(e){return"Add to queue"},"orderQueue:clear":function(e){return"Clear queue"},"orderQueue:cancel":function(e){return"Cancel"},"orderQueue:order:label":function(e){return"Order"},"orderQueue:order:placeholder":function(e){return"Search the order by its number..."},"orderQueue:operation:label":function(e){return"Operation"},"orderQueue:operation:placeholder":function(e){return"Choose the operation..."},"newOrderPicker:title":function(e){return"Starting a new order"},"newOrderPicker:title:replacing":function(e){return"Ending the current order"},"newOrderPicker:title:correcting":function(e){return"Correcting the current order"},"newOrderPicker:order:label:no":function(e){return"New order's number:"},"newOrderPicker:order:label:nc12":function(e){return"New order's 12NC:"},"newOrderPicker:order:placeholder:no":function(e){return"Enter the new order's no..."},"newOrderPicker:order:placeholder:nc12":function(e){return"Enter the new order's 12NC..."},"newOrderPicker:order:tooShort":function(e){return"Enter a full, 9-digit order number."},"newOrderPicker:order:notFound":function(e){return"The specified order doesn't exist."},"newOrderPicker:operation:label:online":function(e){return"Operation:"},"newOrderPicker:operation:label:offline":function(e){return"Operation number:"},"newOrderPicker:operation:placeholder":function(e){return"Choose the new order's operation..."},"newOrderPicker:submit":function(e){return"Start order"},"newOrderPicker:submit:replacing":function(e){return"Start order"},"newOrderPicker:submit:correcting":function(e){return"Correct order"},"newOrderPicker:cancel":function(e){return"Cancel"},"newOrderPicker:msg:invalidOrderId:no":function(e){return"Invalid order no."},"newOrderPicker:msg:invalidOrderId:nc12":function(e){return"Invalid 12NC."},"newOrderPicker:msg:invalidOperationNo":function(e){return"Invalid operation no."},"newOrderPicker:msg:searchFailure":function(e){return"Searching orders failed."},"newOrderPicker:msg:emptyOrder":function(e){return"Order is required."},"newOrderPicker:msg:emptyOperation":function(e){return"Operation is required."},"newOrderPicker:msg:noOperations":function(e){return"The selected order doesn't have any operations. You can manually enter a 4-digit operation no."},"newOrderPicker:msg:orderDeleted":function(e){return"Order deleted."},"newOrderPicker:msg:orderCompleted":function(e){return"Order completed."},"newOrderPicker:online:info:no":function(e){return"Enter the order no and choose an operation from the list to start a new order."},"newOrderPicker:online:info:nc12":function(e){return"Enter the order's 12NC and choose an operation from the list to start a new order."},"newOrderPicker:offline:warning:no":function(e){return"Enter the order no and operation no to start a new order."},"newOrderPicker:offline:warning:nc12":function(e){return"Enter the order's 12NC and operation no to start a new order."},"newOrderPicker:checkData:warning":function(e){return"Starting a new order will finish the current order. Make sure that the <em>Quantity done</em> and <em>Worker count</em> of the current order have correct values, because after starting a new order, you won't be able to change them."},"newOrderPicker:quantityDone":function(e){return"Quantity done in the finished order:"},"newOrderPicker:workerCount":function(e){return"Worker count in the finished order:"},"newOrderPicker:newWorkerCount":function(e){return"Worker count:"},"newOrderPicker:spigot:nc12":function(e){return"Spigot component 12NC"},"newOrderPicker:spigot:placeholder":function(e){return"Scan the component's bar code..."},"newOrderPicker:spigot:invalid":function(e){return"Invalid component 12NC!"},"error:min":function(e){return"Value cannot be less than "+t.v(e,"min")+"."},"error:max":function(e){return"Value cannot be greater than "+t.v(e,"max")+"."},"downtimePicker:title:start":function(e){return"Starting a new downtime"},"downtimePicker:title:edit":function(e){return"Correcting a downtime"},"downtimePicker:submit:start":function(e){return"Start downtime"},"downtimePicker:submit:edit":function(e){return"Correct downtime"},"downtimePicker:cancel":function(e){return"Cancel"},"downtimePicker:reason:label":function(e){return"Downtime reason:"},"downtimePicker:reason:placeholder":function(e){return"Choose a downtime reason..."},"downtimePicker:reasonFilter:placeholder":function(e){return"Downtime reason..."},"downtimePicker:reasonComment:label":function(e){return"Comment:"},"downtimePicker:reasonComment:placeholder":function(e){return"Optional, additional info..."},"downtimePicker:aor:label":function(e){return"Area of responsibility:"},"downtimePicker:aor:placeholder":function(e){return"Choose an area of responsibility..."},"downtimePicker:aorFilter:placeholder":function(e){return"Area of responsibility..."},"downtimePicker:msg:emptyReason":function(e){return"Downtime reason is required."},"downtimePicker:msg:emptyAor":function(e){return"Area of responsibility is required."},"downtimePicker:startedAt":function(e){return"Started at"},"downtimePicker:startedAt:now":function(e){return"Now"},"prodDowntime:time":function(e){return"Time"},"prodDowntime:reason":function(e){return"Downtime reason"},"prodDowntime:aor":function(e){return"Area of responsibility"},"endDowntimeDialog:title":function(e){return"Ending downtime confirmation"},"endDowntimeDialog:message":function(e){return"<p>Are you sure you want to end the current downtime?</p>"},"endDowntimeDialog:yes":function(e){return"End the downtime"},"endDowntimeDialog:no":function(e){return"Do not end the downtime"},"continueOrderDialog:title":function(e){return"Order continuation confirmation"},"continueOrderDialog:message":function(e){return"<p>Are you sure you want to start the currently chosen order?</p>"},"continueOrderDialog:yes":function(e){return"Continue the order"},"continueOrderDialog:no":function(e){return"Do not continue the order"},"endWorkDialog:title":function(e){return"Ending work confirmation"},"endWorkDialog:warning":function(e){return"Ending work will finish "+t.s(e,"downtime",{true:"the current downtime and order",other:"the current order"})+". Make sure that the following fields have correct values, because after ending the work, you won't be able to change them."},"endWorkDialog:quantitiesDone":function(e){return"Quantity done in the "+t.v(e,"hourRange")+" hour:"},"endWorkDialog:quantityDone":function(e){return"Quantity done in the current order:"},"endWorkDialog:workerCount":function(e){return"Worker count in the current order:"},"endWorkDialog:yes":function(e){return"End work"},"endWorkDialog:no":function(e){return"Do not end work"},"endWorkDialog:spigot:nc12":function(e){return"Spigot component 12NC"},"endWorkDialog:spigot:placeholder":function(e){return"Scan the component's bar code..."},"endWorkDialog:spigot:invalid":function(e){return"Invalid component 12NC!"},"propertyEditorDialog:title:quantityDone":function(e){return"Changing quantity done"},"propertyEditorDialog:label:quantityDone":function(e){return"Quantity done in the current order"},"propertyEditorDialog:title:workerCount":function(e){return"Changing worker count"},"propertyEditorDialog:label:workerCount":function(e){return"Worker count in the current order"},"propertyEditorDialog:yes":function(e){return"Set value"},"propertyEditorDialog:no":function(e){return"Cancel"},"unload:downtime":function(e){return"Are you sure you want to close the browser leaving the production line in a state of downtime?\n\nIf you close the browser without Ending work, then the current downtime will be finished at the end of the current shift!"},"unload:order":function(e){return"Are you sure you want to close the browser leaving the production line in a state of working?\n\nIf you close the browser without Ending work, then the current order will be finished at the end of the current shift!"},"isa:header":function(e){return"ISA"},"isa:pickup":function(e){return"Pallet<br>pickup"},"isa:deliver":function(e){return"Pallet<br>delivery"},"isa:deliver:specific":function(e){return"Delivery <span class='production-isa-selectedQty'>"+t.v(e,"qty")+"x</span><span class='production-isa-selectedPalletKind'>"+t.v(e,"palletKind")+"</span>"},"isa:deliver:title":function(e){return"Pallet delivery"},"isa:deliver:qty":function(e){return"Pallet quantity"},"isa:deliver:palletKind":function(e){return"Pallet kind"},"isa:deliver:submit":function(e){return"Request delivery"},"isa:deliver:cancel":function(e){return"Cancel"},"isa:cancel:title":function(e){return"Request cancel confirmation"},"isa:cancel:message":function(e){return"<p>Are you sure you want to cancel the chosen pallet "+t.v(e,"requestType")+" request?</p>"},"isa:cancel:yes":function(e){return"Cancel request"},"isa:cancel:no":function(e){return"Leave active"},"isa:status:idle":function(e){return"No request"},"isa:status:new":function(e){return"Waiting for acceptance"},"isa:status:accepted":function(e){return"In progress"},"spigotChecker:title":function(e){return"Checking the Spigot component"},"spigotChecker:name:label":function(e){return"Component name:"},"spigotChecker:nc12:label":function(e){return"Component 12NC:"},"spigotChecker:nc12:placeholder":function(e){return"Scan the component's bar code..."},"spigotChecker:nc12:invalid":function(e){return"Invalid component 12NC!"},"spigotChecker:submit":function(e){return"Check component"},"spigotChecker:endWork":function(e){return"Close order"},"spigotChecker:success":function(e){return"The scanned component is valid."},"autoDowntimes:remainingTime":function(e){return"starts in "+t.v(e,"time")},"snMessage:scannedValue":function(e){return"Scanned value"},"snMessage:orderNo":function(e){return"Order no"},"snMessage:serialNo":function(e){return"Serial no"},"snMessage:UNKNOWN_CODE":function(e){return"The scanned code does not contain a serial number."},"snMessage:INVALID_LINE":function(e){return"Invalid production line."},"snMessage:INVALID_LINE_STATE":function(e){return"Invalid production shift or order."},"snMessage:INVALID_STATE:null":function(e){return"Invalid production shift."},"snMessage:INVALID_STATE:idle":function(e){return"Begin an order to enable the SN scanning."},"snMessage:INVALID_STATE:downtime":function(e){return"Finish the downtime to enable SN scanningthe ."},"snMessage:INVALID_ORDER":function(e){return"Scanned SN from a wrong order."},"snMessage:ALREADY_USED":function(e){return"Scanned SN is already registered."},"snMessage:CHECKING":function(e){return"<span class='fa fa-spinner fa-spin'></span><br>Checking the serial number..."},"snMessage:SERVER_FAILURE":function(e){return"Remote server error while checking the serial number."},"snMessage:OFFLINE":function(e){return"Failed to connect to the server."},"snMessage:SHIFT_NOT_FOUND":function(e){return"Line shift not found."},"snMessage:ORDER_NOT_FOUND":function(e){return"Line order not found."},"snMessage:SAP_ORDER_NOT_FOUND":function(e){return"Production order not found."},"snMessage:STANDARD_LABEL":function(e){return"The virtual SN cannot be used in this order."},"snMessage:SUCCESS":function(e){return"Serial number successfully registered."},"snMessage:MAX_TOTAL":function(e){return"Order completed."},"snMessage:MAX_LINE":function(e){return"Line order completed."},"snMessage:ORDER_NO_REQUIRED":function(e){return"Order no in the serial no is required."},"snMessage:extraPsn:scan":function(e){return"Scan additional serial number..."},"bomChecker:title":function(e){return"Checking components"},"bomChecker:message:todo":function(e){return"Scan the component label."},"bomChecker:message:checking":function(e){return"Checking the component..."},"bomChecker:message:success":function(e){return"Correct component!"},"bomChecker:message:failure":function(e){return"Failed to check the component."},"bomChecker:message:todo:sn":function(e){return"Scan the product label."},"bomChecker:message:checking:sn":function(e){return"Checking the serial number..."},"bomChecker:message:success:sn":function(e){return"Correct serial number!"},"bomChecker:message:failure:sn":function(e){return"Failed to check the serial number."},"bomChecker:message:nc12":function(e){return"12NC mismatch: "+t.v(e,"nc12")},"bomChecker:message:used":function(e){return"Code already used in: "+t.v(e,"psn")},"bomChecker:message:used:sn":function(e){return"Serial number already used."},"snMessage:BOM_CHECKER:NO_MATCH":function(e){return"Code does not match any component."},"taktTime:check:button":function(e){return"Check<br>serial number"},"taktTime:check:title":function(e){return"Serial number checking"},"taktTime:check:orderNo":function(e){return"Order no"},"taktTime:check:serialNo":function(e){return"Item no"},"taktTime:check:submit":function(e){return"Check serial number"},"taktTime:check:list":function(e){return"Show serial number list"},"taktTime:check:help":function(e){return"Specify an order no and an item no of the serial number you would like to check. The serial number to check may also be scanned."},"taktTime:check:checking":function(e){return"<i class='fa fa-spinner fa-spin'></i> Checking the serial number..."},"taktTime:check:local":function(e){return"The specified serial number was already scanned on this production line."},"taktTime:check:remote":function(e){return"The specified serial number was already scanned on line: "+t.v(e,"prodLine")},"taktTime:check:notFound":function(e){return"The specified serial number was not scanned yet."},"taktTime:list:title":function(e){return"List of scanned serial numbers"},"execution:todo":function(e){return"Plan"},"execution:done":function(e){return"Done"},"execution:order:label":function(e){return t.v(e,"orderId")+", "+t.v(e,"quantityDone")+" PCE"},"execution:order:orderNo":function(e){return"Order"},"execution:order:operationNo":function(e){return"Operation"},"execution:order:startedAt":function(e){return"Started at"},"execution:order:finishedAt":function(e){return"Finished at"},"execution:order:quantityDone":function(e){return"Quantity"},"execution:order:workerCount":function(e){return"Worker count"},"execution:downtime:label":function(e){return t.v(e,"reason")},"execution:downtime:reason":function(e){return"Reason"},"execution:downtime:aor":function(e){return"AOR"},"execution:downtime:startedAt":function(e){return"Started at"},"execution:downtime:finishedAt":function(e){return"Finished at"},"ft:warning":function(e){return"Order can be finished only by an authorized person, because all frame tests have not been performed. Inform your supervisor."},"ft:login":function(e){return"Login"},"ft:password":function(e){return"Password"},"ft:invalidCredentials":function(e){return"Invalid credentials."},"ft:noPrivileges":function(e){return"User doesn't have the required privileges."},"ft:requestFailure":function(e){return"Failed to check the authorization."},"componentLabels:title":function(e){return"Component label printing"},"componentLabels:orderNo":function(e){return"Order number"},"componentLabels:operationNo":function(e){return"Operation number"},"componentLabels:labelQty":function(e){return"Label quantity"},"componentLabels:shiftX":function(e){return"X shift"},"componentLabels:shiftY":function(e){return"Y shift"},"componentLabels:componentCode":function(e){return"Component"},"componentLabels:noComponents":function(e){return"No matching components."},"componentLabels:submit":function(e){return"Print labels"},"componentLabels:test":function(e){return"Print test label"},"componentLabels:cancel":function(e){return"Cancel"},"componentLabels:error":function(e){return"Printing failed."},"componentLabels:error:PRINTER_NOT_FOUND":function(e){return"Printer not found."},"componentLabels:error:INVALID_PRINTER":function(e){return"Invalid printer."},"sequence:shift":function(e){return"Shift"},"sequence:order":function(e){return"Order"},"sequence:name":function(e){return"Product name"},"sequence:quantity":function(e){return"Quantity"},"sequence:faps":function(e){return"Problems"},"sequence:empty":function(e){return"No data."},"settings:tab:operator":function(e){return"Operator"},"settings:tab:downtimes":function(e){return"Downtimes"},"settings:tab:spigot":function(e){return"Spigot check"},"settings:tab:bomChecker":function(e){return"Component checking"},"settings:tab:componentLabels":function(e){return"Component labels"},"settings:tab:taktTime":function(e){return"Takt Time"},"settings:initialDowntimeWindow":function(e){return"Time to start the initial downtime on a shift [min]"},"settings:rearmDowntimeReason":function(e){return"Downtime reason with Spigot check"},"settings:spigotLines":function(e){return"Production lines with Spigot check"},"settings:spigotPatterns":function(e){return"Select Spigot component matching one of the following patterns"},"settings:spigotNotPatterns":function(e){return"Ignore the selected component, if it also matches any of the following patterns"},"settings:spigotFinish":function(e){return"Force checking of the Spigot during order finish"},"settings:spigotGroups":function(e){return"12NC groups of Spigots"},"settings:spigotGroups:help":function(e){return"Assignment of Spigot component 12NCs to 12NCs scanned by the Operators. Required format: <code>$scanned_12NC: $spigot_12NC_1, $spigot_12NC_2, ...</code> (each scanned 12NC must be on a separate line)."},"settings:spigotInsertGroups":function(e){return"12NC groups of Inserts"},"settings:spigotInsertGroups:help":function(e){return"Assignment of product 12NCs to 12NCs scanned by the Operators. Required format: <code>$scanned_12NC: $product_NC12_1, $product_NC12_2, ...</code> (each scanned 12NC must be on a separate line)."},"settings:taktTime:enabled":function(e){return"Serial number scanning"},"settings:taktTime:ignoredLines":function(e){return"Ignore scanning on the following lines:"},"settings:taktTime:ignoredDowntimes":function(e){return"Ignore the following downtime reasons:"},"settings:taktTime:last":function(e){return"Show Cycle Time of the last PCE"},"settings:taktTime:avg":function(e){return"Show average Cycle Time for the current order"},"settings:taktTime:sap":function(e){return"Show Takt Time for the current order"},"settings:taktTime:smiley":function(e){return"Show smiley"},"settings:taktTime:coeffs":function(e){return"Operation coefficients"},"settings:taktTime:coeffs:help":function(e){return"Each line should contain order's MRP for which the Takt Time coefficients should be adjusted, followed by names of the operation WorkCenters, operation numbers and values of the coefficients. For example:<br><code class='multiline text-mono'>*:      *=1.053 */0010=1.1 PIVATIC5=0.9<br>KE6:    *=1 OUTDOOR5=1.1 OUTDOOR5/0025=0.9<br>XYZ: <* *=1 FOO=0.9 BAR=1.1</code>"},"settings:lineAutoDowntimes":function(e){return"Automatic downtimes"},"settings:lineAutoDowntimes:groups:placeholder":function(e){return"Choose an existing production line group to change its auto downtimes."},"settings:lineAutoDowntimes:groups:label":function(e){return"Auto downtime groups"},"settings:lineAutoDowntimes:group:label":function(e){return"Group name"},"settings:lineAutoDowntimes:reasons:placeholder":function(e){return"Choose a new auto downtime reason"},"settings:lineAutoDowntimes:lines:label":function(e){return"Production lines in the group"},"settings:lineAutoDowntimes:reason":function(e){return"Auto downtime reason"},"settings:lineAutoDowntimes:init":function(e){return"Initialization"},"settings:lineAutoDowntimes:when:initial":function(e){return"at shift start"},"settings:lineAutoDowntimes:when:always":function(e){return"always"},"settings:lineAutoDowntimes:when:time":function(e){return"at"},"settings:lineAutoDowntimes:when:after":function(e){return"after"},"settings:lineAutoDowntimes:when:after:placeholder":function(e){return"choose another reason..."}},pl:!0}}),define("app/nls/pl/production",["app/nls/locale/pl"],function(e){var t={lc:{pl:function(t){return e(t)},en:function(t){return e(t)}},c:function(e,t){if(!e)throw new Error("MessageFormat: Data required for '"+t+"'.")},n:function(e,t,n){if(isNaN(e[t]))throw new Error("MessageFormat: '"+t+"' isn't a number.");return e[t]-(n||0)},v:function(e,n){return t.c(e,n),e[n]},p:function(e,n,i,r,o){return t.c(e,n),e[n]in o?o[e[n]]:(n=t.lc[r](e[n]-i))in o?o[n]:o.other},s:function(e,n,i){return t.c(e,n),e[n]in i?i[e[n]]:i.other}};return{"breadcrumbs:base":function(e){return"Operator"},"breadcrumbs:settings":function(e){return"Ustawienia"},"duplicate:title":function(e){return"Podwójne uruchomienie formatki"},"duplicate:message":function(e){return"Wykryto podwójne uruchomienie przeglądarki z formatką operatora.<br>Zamknij wszystkie inne formatki i wciśnij poniższy przycisk, aby ponownie załadować formatkę w tym oknie."},"duplicate:button":function(e){return"Przeładuj formatkę"},"msg:shiftChange":function(e){return"Nowa zmiana!"},"msg:locked":function(e){return"Linia produkcyjna została dezaktywowana!"},userLabel:function(e){return"Operator"},"controls:dashboard":function(e){return"Przejdź do pulpitu"},"controls:lock":function(e){return"Dezaktywuj linię"},"controls:unlock":function(e){return"Aktywuj linię"},"controls:locked":function(e){return"Linia dezaktywowana"},"controls:unlocked":function(e){return"Linia aktywna"},"controls:sync":function(e){return"Wskaźnik komunikacji z serwerem"},"controls:addNearMiss":function(e){return"Dodaj ZPW"},"controls:addSuggestion":function(e){return"Dodaj sugestię"},"controls:addObservation":function(e){return"Dodaj obserwację"},"controls:msg:sync:noConnection":function(e){return"Nie można aktywować edycji: brak połączenia z serwerem."},"controls:msg:sync:remoteError":function(e){return"Nie można aktywować edycji: nieudane pobranie klucza."},"controls:msg:sync:success":function(e){return"Pomyślnie aktywowano linię."},"controls:msg:popup":function(e){return"Wyskakujące okienko zostało zablokowane."},"controls:mor":function(e){return"Matryca odpowiedzialności"},"controls:componentLabels":function(e){return"Drukowanie etykiet komponentów"},"controls:extraPsn":function(e){return"Doskanowywanie numerów seryjnych"},"unlockDialog:title:unlock":function(e){return"Aktywacja Formatki operatora"},"unlockDialog:title:lock":function(e){return"Dezaktywacja Formatki operatora"},"unlockDialog:login":function(e){return"Login"},"unlockDialog:password":function(e){return"Hasło"},"unlockDialog:prodLine":function(e){return"Linia produkcyjna"},"unlockDialog:station":function(e){return"Numer stanowiska pracy"},"unlockDialog:unlock":function(e){return"Aktywuj Formatkę operatora"},"unlockDialog:lock":function(e){return"Dezaktywuj Formatkę operatora"},"unlockDialog:error:UNLOCK_FAILURE":function(e){return"Nie udało się aktywować linii produkcyjnej."},"unlockDialog:error:LOCK_FAILURE":function(e){return"Nie udało się dezaktywować linii produkcyjnej."},"unlockDialog:error:INVALID_PROD_LINE":function(e){return"Nieprawidłowa linia produkcyjna."},"unlockDialog:error:NO_PRIVILEGES":function(e){return"Brak wymaganych uprawnień."},"unlockDialog:error:INPUT":function(e){return"Nieprawidłowy login i/lub hasło."},"unlockDialog:error:MANY_MATCHES":function(e){return"Kilku użytkowników z podanym loginem."},"unlockDialog:error:UNSAFE_PASSWORD":function(e){return"Hasło nie może być takie jak login. Zmień hasło."},"unlockDialog:error:ALREADY_UNLOCKED":function(e){return"Linia produkcyjna jest aktualnie uruchomiona na innym komputerze."},"unlockDialog:error:DEACTIVATED":function(e){return"Linia produkcyjna jest już nieaktywna."},"section:data":function(e){return"Dane produkcyjne"},"section:history":function(e){return"Historia"},"section:quantities":function(e){return"Wykonane ilości"},"section:downtimes":function(e){return"Przestoje"},"section:isa":function(e){return"Pole odkładcze"},"section:taktTime":function(e){return"Czas cyklu"},"section:sequence":function(e){return"Sekwencja"},"property:currentTime":function(e){return"Aktualny czas"},"property:shift":function(e){return"Zmiana"},"property:orgUnit":function(e){return"Dział"},"property:master":function(e){return"Mistrz"},"property:master:change":function(e){return"(zmień)"},"property:master:noData:locked":function(e){return"nie wybrany"},"property:master:noData:unlocked":function(e){return"(wybierz mistrza)"},"property:leader":function(e){return"Lider"},"property:leader:change":function(e){return"(zmień)"},"property:leader:noData:locked":function(e){return"nie wybrany"},"property:leader:noData:unlocked":function(e){return"(wybierz lidera)"},"property:operator":function(e){return"Operator"},"property:operator:change":function(e){return"(zmień)"},"property:operator:noData:locked":function(e){return"nie wybrany"},"property:operator:noData:unlocked":function(e){return"(wybierz operatora)"},"property:orderNo":function(e){return"Nr zlecenia"},"property:orderNo:change":function(e){return"(popraw)"},"property:nc12":function(e){return"12NC"},"property:nc12:change":function(e){return"(popraw)"},"property:productName":function(e){return"Nazwa rodziny/detalu"},"property:operationName":function(e){return"Nazwa operacji"},"property:taktTime":function(e){return"Takt [s]"},"property:taktTime:checkSn":function(e){return"(sprawdź)"},"property:lastTaktTime":function(e){return"Cykl [s]"},"property:avgTaktTime":function(e){return"Śr. cykl [s]"},"property:workerCountSap":function(e){return"Osoby wg SAP"},"property:createdAt":function(e){return"Czas rozpoczęcia"},"property:totalQuantityDone":function(e){return"Ilość w zleceniu"},"property:quantityDone":function(e){return"Wykonana ilość"},"property:quantityDone:change":function(e){return"(zmień ilość)"},"property:workerCount":function(e){return"Osoby pracujące"},"property:workerCount:change:data":function(e){return"(zmień ilość)"},"property:workerCount:change:noData":function(e){return"(ustaw ilość)"},"action:newOrder":function(e){return"Nowe zlecenie"},"action:nextOrder":function(e){return"<i class='fa fa-forward' title='Kolejka zleceń'></i>"},"action:continueOrder":function(e){return"Kontynuuj zlecenie"},"action:startDowntime":function(e){return"Przestój"},"action:startBreak":function(e){return"Przerwa"},"action:endDowntime":function(e){return"Koniec przestoju"},"action:endWork":function(e){return"Koniec pracy"},"action:emptyPallet":function(e){return"Pusta paleta"},"action:fullPallet":function(e){return"Paleta"},"quantities:column:time":function(e){return"Godzina"},"quantities:column:planned":function(e){return"Plan"},"quantities:column:actual":function(e){return"Wykonane"},"quantities:unit":function(e){return"szt."},"quantities:change":function(e){return"(zmień)"},"quantities:newValuePlaceholder":function(e){return"Nowa ilość..."},"quantityEditor:title":function(e){return"Wykonana ilość w przedziale godzinowym"},"quantityEditor:label:hour":function(e){return"Przedział godzinowy:"},"quantityEditor:label:value":function(e){return"Ilość wykonana:"},"quantityEditor:submit":function(e){return"Ustaw ilość"},"quantityEditor:cancel":function(e){return"Anuluj ustawianie"},"quantityEditor:maxQuantity":function(e){return"Wartość nie może być większa niż "+t.v(e,"max")+"."},"personnelPicker:title:master":function(e){return"Wybieranie mistrza"},"personnelPicker:title:leader":function(e){return"Wybieranie lidera"},"personnelPicker:title:operator":function(e){return"Wybieranie operatora"},"personnelPicker:submit":function(e){return"Zapisz pracownika"},"personnelPicker:cancel":function(e){return"Anuluj wybieranie"},"personnelPicker:recent":function(e){return"Pracownicy ostatnio pracujący na tej zmianie:"},"personnelPicker:matches":function(e){return"Znalezieni pracownicy:"},"personnelPicker:tooShort":function(e){return"Podaj przynajmniej trzy początkowe znaki nazwiska."},"personnelPicker:notFound":function(e){return"Nie znaleziono żadnych pasujących pracowników."},"personnelPicker:online:label":function(e){return"Wybrany pracownik:"},"personnelPicker:offline:label":function(e){return"Nr kadrowy pracownika:"},"personnelPicker:offline:warning":function(e){return"Brak połączenia z serwerem. Możesz wpisać tylko numer kadrowy pracownika."},"personnelPicker:embedded:label":function(e){return"Szukaj pracowników po nazwisku:"},"multiPersonnelPicker:title:operator":function(e){return"Wybieranie operatorów"},"multiPersonnelPicker:submit":function(e){return"Zapisz pracowników"},"multiPersonnelPicker:cancel":function(e){return"Anuluj wybieranie"},"multiPersonnelPicker:pick":function(e){return"Dodaj pracownika"},"multiPersonnelPicker:back":function(e){return"Wróć do listy"},"multiPersonnelPicker:recent":function(e){return"Pracownicy ostatnio pracujący na tej zmianie:"},"multiPersonnelPicker:matches":function(e){return"Znalezieni pracownicy:"},"multiPersonnelPicker:tooShort":function(e){return"Podaj przynajmniej trzy początkowe znaki nazwiska."},"multiPersonnelPicker:notFound":function(e){return"Nie znaleziono żadnych pasujących pracowników."},"multiPersonnelPicker:empty":function(e){return"Nie wybrano jeszcze pracowników aktualnej zmiany."},"multiPersonnelPicker:picked":function(e){return"Wybrani pracownicy:"},"multiPersonnelPicker:online:label":function(e){return"Nowy pracownik:"},"multiPersonnelPicker:offline:label":function(e){return"Nr kadrowy nowego pracownika:"},"multiPersonnelPicker:offline:warning":function(e){return"Brak połączenia z serwerem. Możesz wpisać tylko numer kadrowy pracownika."},"multiPersonnelPicker:embedded:label":function(e){return"Szukaj pracowników po nazwisku:"},"orderQueue:title":function(e){return"Ustawianie kolejki zleceń"},"orderQueue:message:order":function(e){return"Wpisz numer zlecenia i wybierz z listy operację, aby dodać następne zlecenie do kolejki."},"orderQueue:message:queue":function(e){return"Poniżej znajduje się aktualna kolejka zleceń."},"orderQueue:message:empty":function(e){return"Kolejka zleceń jest pusta."},"orderQueue:submit":function(e){return"Ustaw kolejkę zleceń"},"orderQueue:enqueue":function(e){return"Dodaj do kolejki"},"orderQueue:clear":function(e){return"Wyczyść kolejkę"},"orderQueue:cancel":function(e){return"Anuluj"},"orderQueue:order:label":function(e){return"Zlecenie"},"orderQueue:order:placeholder":function(e){return"Szukaj zlecenia po numerze..."},"orderQueue:operation:label":function(e){return"Operacja"},"orderQueue:operation:placeholder":function(e){return"Wybierz operację..."},"newOrderPicker:title":function(e){return"Rozpoczynanie nowego zlecenia"},"newOrderPicker:title:replacing":function(e){return"Kończenie aktualnego zlecenia"},"newOrderPicker:title:correcting":function(e){return"Poprawianie aktualnego zlecenia"},"newOrderPicker:order:label:no":function(e){return"Nr nowego zlecenia:"},"newOrderPicker:order:label:nc12":function(e){return"12NC nowego zlecenia:"},"newOrderPicker:order:placeholder:no":function(e){return"Wpisz numer nowego zlecenia..."},"newOrderPicker:order:placeholder:nc12":function(e){return"Wpisz 12NC nowego zlecenia..."},"newOrderPicker:order:tooShort":function(e){return"Podaj pełny, 9-cyfrowy numer zlecenia."},"newOrderPicker:order:notFound":function(e){return"Podane zlecenie nie istnieje."},"newOrderPicker:operation:label:online":function(e){return"Operacja:"},"newOrderPicker:operation:label:offline":function(e){return"Numer operacji:"},"newOrderPicker:operation:placeholder":function(e){return"Wybierz operację nowego zlecenia..."},"newOrderPicker:submit":function(e){return"Rozpocznij nowe zlecenie"},"newOrderPicker:submit:replacing":function(e){return"Zakończ aktualne zlecenie i rozpocznij nowe"},"newOrderPicker:submit:correcting":function(e){return"Popraw aktualne zlecenie"},"newOrderPicker:cancel":function(e){return"Anuluj"},"newOrderPicker:msg:invalidOrderId:no":function(e){return"Nieprawidłowy numer zlecenia."},"newOrderPicker:msg:invalidOrderId:nc12":function(e){return"Nieprawidłowe 12NC zlecenia."},"newOrderPicker:msg:invalidOperationNo":function(e){return"Nieprawidłowy numer operacji."},"newOrderPicker:msg:searchFailure":function(e){return"Wyszukiwanie zlecenia nie powiodło się."},"newOrderPicker:msg:emptyOrder":function(e){return"Prawidłowe zlecenie jest wymagane."},"newOrderPicker:msg:emptyOperation":function(e){return"Operacja jest wymagana."},"newOrderPicker:msg:noOperations":function(e){return"Wybrane zlecenie nie ma zdefiniowanych żadnych operacji.<br>Możesz ręcznie wpisać czterocyfrowy nr operacji."},"newOrderPicker:msg:orderDeleted":function(e){return"Zlecenie zostało skasowane."},"newOrderPicker:msg:orderCompleted":function(e){return"Zlecenie zostało zrobione."},"newOrderPicker:online:info:no":function(e){return"Wpisz numer zlecenia i wybierz z listy operację, aby rozpocząć nowe zlecenie."},"newOrderPicker:online:info:nc12":function(e){return"Wpisz 12NC zlecenia i wybierz z listy operację, aby rozpocząć nowe zlecenie."},"newOrderPicker:offline:warning:no":function(e){return"Wpisz numer zlecenia oraz numer operacji aby rozpocząć nowe zlecenie."},"newOrderPicker:offline:warning:nc12":function(e){return"Wpisz 12NC zlecenia oraz numer operacji aby rozpocząć nowe zlecenie."},"newOrderPicker:checkData:warning":function(e){return"Wybranie nowego zlecenia ukończy aktualnie wybrane zlecenie. Sprawdź czy pola <em>Ilość wykonana</em> i <em>Osoby pracujące</em> aktualnego zlecenia mają prawidłowe wartości, gdyż po wybraniu nowego zlecenia nie będzie można ich zmienić."},"newOrderPicker:quantityDone":function(e){return"Ilość wykonana w kończonym zleceniu:"},"newOrderPicker:workerCount":function(e){return"Osoby pracujące przy kończonym zleceniu:"},"newOrderPicker:newWorkerCount":function(e){return"Ilość osób:"},"newOrderPicker:spigot:nc12":function(e){return"12NC komponentu Spigot"},"newOrderPicker:spigot:placeholder":function(e){return"Zeskanuj kod kreskowy komponentu..."},"newOrderPicker:spigot:invalid":function(e){return"Nieprawidłowe 12NC komponentu!"},"error:min":function(e){return"Wartość nie może być mniejsza niż "+t.v(e,"min")+"."},"error:max":function(e){return"Wartość nie może być większa niż "+t.v(e,"max")+"."},"downtimePicker:title:start":function(e){return"Rozpoczynanie przestoju"},"downtimePicker:title:edit":function(e){return"Poprawianie przestoju"},"downtimePicker:submit:start":function(e){return"Rozpocznij przestój"},"downtimePicker:submit:edit":function(e){return"Popraw przestój"},"downtimePicker:cancel":function(e){return"Anuluj"},"downtimePicker:reason:label":function(e){return"Powód przestoju:"},"downtimePicker:reason:placeholder":function(e){return"Wybierz powód przestoju..."},"downtimePicker:reasonFilter:placeholder":function(e){return"Powód przestoju..."},"downtimePicker:reasonComment:label":function(e){return"Komentarz:"},"downtimePicker:reasonComment:placeholder":function(e){return"Opcjonalne, dodatkowe informacje..."},"downtimePicker:aor:label":function(e){return"Obszar odpowiedzialności:"},"downtimePicker:aor:placeholder":function(e){return"Wybierz obszar odpowiedzialności..."},"downtimePicker:aorFilter:placeholder":function(e){return"Obszar odpowiedzialności..."},"downtimePicker:msg:emptyReason":function(e){return"Powód przestoju jest wymagany."},"downtimePicker:msg:emptyAor":function(e){return"Obszar odpowiedzialności jest wymagany."},"downtimePicker:startedAt":function(e){return"Czas rozpoczęcia"},"downtimePicker:startedAt:now":function(e){return"Teraz"},"prodDowntime:time":function(e){return"Czas"},"prodDowntime:reason":function(e){return"Powód przestoju"},"prodDowntime:aor":function(e){return"Obszar odpowiedzialności"},"endDowntimeDialog:title":function(e){return"Potwierdzenie zakończenia przestoju"},"endDowntimeDialog:message":function(e){return"<p>Czy na pewno chcesz zakończyć aktualny przestój?</p>"},"endDowntimeDialog:yes":function(e){return"Zakończ przestój"},"endDowntimeDialog:no":function(e){return"Nie kończ przestoju"},"continueOrderDialog:title":function(e){return"Potwierdzenie kontynuacji zlecenia"},"continueOrderDialog:message":function(e){return"<p>Czy na pewno chcesz rozpocząć aktualnie wybrane zlecenie?</p>"},"continueOrderDialog:yes":function(e){return"Kontynuuj zlecenie"},"continueOrderDialog:no":function(e){return"Nie kontynuuj zlecenia"},"endWorkDialog:title":function(e){return"Potwierdzenie zakończenia pracy"},"endWorkDialog:warning":function(e){return"Zakończenie pracy ukończy "+t.s(e,"downtime",{true:"aktualnie wybrany przestój i zlecenie",other:"aktualnie wybrane zlecenie"})+". Sprawdź czy poniższe pola mają prawidłowe wartości, gdyż po zakończeniu pracy nie będzie można ich zmienić."},"endWorkDialog:quantitiesDone":function(e){return"Wykonana ilość w przedziale godzinowym "+t.v(e,"hourRange")+":"},"endWorkDialog:quantityDone":function(e){return"Wykonana ilość aktualnego zlecenia:"},"endWorkDialog:workerCount":function(e){return"Osoby pracujące przy aktualnym zleceniu:"},"endWorkDialog:yes":function(e){return"Zakończ pracę"},"endWorkDialog:no":function(e){return"Anuluj"},"endWorkDialog:spigot:nc12":function(e){return"12NC komponentu Spigot"},"endWorkDialog:spigot:placeholder":function(e){return"Zeskanuj kod kreskowy komponentu..."},"endWorkDialog:spigot:invalid":function(e){return"Nieprawidłowe 12NC komponentu!"},"propertyEditorDialog:title:quantityDone":function(e){return"Ustawianie ilości wykonanej"},"propertyEditorDialog:label:quantityDone":function(e){return"Ilość wykonana w zleceniu"},"propertyEditorDialog:title:workerCount":function(e){return"Ustawianie ilości osób pracujących"},"propertyEditorDialog:label:workerCount":function(e){return"Ilość osób pracujących przy zleceniu"},"propertyEditorDialog:yes":function(e){return"Ustaw ilość"},"propertyEditorDialog:no":function(e){return"Anuluj"},"unload:downtime":function(e){return"Czy na pewno chcesz zamknąć przeglądarkę pozostawiając linię produkcyjną w stanie przestoju?\n\nJeżeli zamkniesz przeglądarkę nie wciskając przycisku Koniec pracy, to czas trwania przestoju będzie się naliczał do końca zmiany!"},"unload:order":function(e){return"Czy na pewno chcesz zamknąć przeglądarkę pozostawiając linię produkcyjną w stanie wykonywania zlecenia?\n\nJeżeli zamkniesz przeglądarkę nie wciskając przycisku Koniec pracy, to czas trwania zlecenia będzie się naliczał do końca zmiany!"},"isa:header":function(e){return"Pole odkładcze"},"isa:pickup":function(e){return"Odbiór<br>palety"},"isa:deliver":function(e){return"Dostawa<br>palety"},"isa:deliver:specific":function(e){return"Dostawa <span class='production-isa-selectedQty'>"+t.v(e,"qty")+"x</span><span class='production-isa-selectedPalletKind'>"+t.v(e,"palletKind")+"</span>"},"isa:deliver:title":function(e){return"Dostawa palety"},"isa:deliver:qty":function(e){return"Ilość palet"},"isa:deliver:palletKind":function(e){return"Rodzaj palety"},"isa:deliver:submit":function(e){return"Dostawa palety"},"isa:deliver:cancel":function(e){return"Anuluj"},"isa:cancel:title":function(e){return"Potwierdzenie anulowania żądania"},"isa:cancel:message":function(e){return"<p>Czy na pewno chcesz anulować wybrane żądanie "+t.s(e,"requestType",{delivery:"dostawy palety",other:"odbioru palety"})+"?</p>"},"isa:cancel:yes":function(e){return"Anuluj żądanie"},"isa:cancel:no":function(e){return"Pozostaw aktywne"},"isa:status:idle":function(e){return"Brak żądania"},"isa:status:new":function(e){return"Oczekiwanie na przyjęcie żądania"},"isa:status:accepted":function(e){return"Żądanie w realizacji"},"spigotChecker:title":function(e){return"Sprawdzanie komponentu Spigot"},"spigotChecker:name:label":function(e){return"Nazwa komponentu:"},"spigotChecker:nc12:label":function(e){return"12NC komponentu:"},"spigotChecker:nc12:placeholder":function(e){return"Zeskanuj kod kreskowy komponentu..."},"spigotChecker:nc12:invalid":function(e){return"Nieprawidłowe 12NC komponentu!"},"spigotChecker:submit":function(e){return"Sprawdź komponent"},"spigotChecker:endWork":function(e){return"Zakończ zlecenie"},"spigotChecker:success":function(e){return"Zeskanowano prawidłowy komponent."},"autoDowntimes:remainingTime":function(e){return"rozpocznie się za "+t.v(e,"time")},"snMessage:scannedValue":function(e){return"Zeskanowana wartość"},"snMessage:orderNo":function(e){return"Zlecenie"},"snMessage:serialNo":function(e){return"Numer"},"snMessage:UNKNOWN_CODE":function(e){return"Zeskanowany kod nie zawiera numeru seryjnego."},"snMessage:INVALID_LINE":function(e){return"Nieprawidłowa linia produkcyjna."},"snMessage:INVALID_LINE_STATE":function(e){return"Nieprawidłowa zmiana produkcyjna lub zlecenie."},"snMessage:INVALID_STATE:null":function(e){return"Nieprawidłowa zmiana produkcyjna."},"snMessage:INVALID_STATE:idle":function(e){return"Rozpocznij zlecenie, aby móc skanować numery seryjne."},"snMessage:INVALID_STATE:downtime":function(e){return"Zakończ przestój, aby móc skanować numery seryjne."},"snMessage:INVALID_ORDER":function(e){return"Zeskanowano numer seryjny z nieprawidłowego zlecenia."},"snMessage:ALREADY_USED":function(e){return"Zeskanowany numer seryjny został już użyty."},"snMessage:CHECKING":function(e){return"<span class='fa fa-spinner fa-spin'></span><br>Sprawdzanie numeru seryjnego..."},"snMessage:SERVER_FAILURE":function(e){return"Błąd podczas sprawdzania numeru seryjnego."},"snMessage:OFFLINE":function(e){return"Błąd połączenia z serwerem."},"snMessage:SHIFT_NOT_FOUND":function(e){return"Nie znaleziono zmiany z linii."},"snMessage:ORDER_NOT_FOUND":function(e){return"Nie znaleziono zlecenia z linii."},"snMessage:SAP_ORDER_NOT_FOUND":function(e){return"Nie znaleziono zlecenia produkcyjnego."},"snMessage:STANDARD_LABEL":function(e){return"Nie można używać wirtualnego numeru seryjnego w tym zleceniu."},"snMessage:SUCCESS":function(e){return"Numer seryjny został pomyślnie zarejestrowany."},"snMessage:MAX_TOTAL":function(e){return"Wykonano już wszystkie sztuki w zleceniu."},"snMessage:MAX_LINE":function(e){return"Wykonano już wszystkie sztuki zaplanowane dla linii."},"snMessage:ORDER_NO_REQUIRED":function(e){return"Nr zlecenia w nr seryjnym jest wymagany."},"snMessage:extraPsn:scan":function(e){return"Zeskanuj dodatkowy numer seryjny..."},"bomChecker:title":function(e){return"Sprawdzanie komponentów"},"bomChecker:message:todo":function(e){return"Zeskanuj etykietę komponentu."},"bomChecker:message:checking":function(e){return"Sprawdzanie komponentu..."},"bomChecker:message:success":function(e){return"Prawidłowy komponent!"},"bomChecker:message:failure":function(e){return"Nie udało się sprawdzić komponentu."},"bomChecker:message:todo:sn":function(e){return"Zeskanuj etykietę produktu."},"bomChecker:message:checking:sn":function(e){return"Sprawdzanie numeru seryjnego..."},"bomChecker:message:success:sn":function(e){return"Prawidłowy numer seryjny!"},"bomChecker:message:failure:sn":function(e){return"Nie udało się sprawdzić numeru seryjnego."},"bomChecker:message:nc12":function(e){return"Niepasujące 12NC: "+t.v(e,"nc12")},"bomChecker:message:used":function(e){return"Kod wykorzystany w: "+t.v(e,"psn")},"bomChecker:message:used:sn":function(e){return"Numer seryjny jest już wykorzystany."},"snMessage:BOM_CHECKER:NO_MATCH":function(e){return"Kod nie pasuje do żadnego z komponentów."},"taktTime:check:button":function(e){return"Sprawdź<br>numer seryjny"},"taktTime:check:title":function(e){return"Sprawdzanie nr seryjnych"},"taktTime:check:orderNo":function(e){return"Nr zlecenia"},"taktTime:check:serialNo":function(e){return"Nr sztuki"},"taktTime:check:submit":function(e){return"Sprawdź nr seryjny"},"taktTime:check:list":function(e){return"Pokaż listę nr seryjnych"},"taktTime:check:help":function(e){return"Podaj nr zlecenia oraz nr sztuki składające się na nr seryjny, który chcesz sprawdzić. Nr seryjny do sprawdzenia możesz także zeskanować."},"taktTime:check:checking":function(e){return"<i class='fa fa-spinner fa-spin'></i> Sprawdzanie nr seryjnego..."},"taktTime:check:local":function(e){return"Dany nr seryjny został zeskanowany na tej linii produkcyjnej."},"taktTime:check:remote":function(e){return"Dany nr seryjny został już zeskanowany na linii produkcyjnej: "+t.v(e,"prodLine")},"taktTime:check:notFound":function(e){return"Dany nr seryjny nie był jeszcze zeskanowany."},"taktTime:list:title":function(e){return"Lista zeskanowanych nr seryjnych"},"execution:todo":function(e){return"Plan"},"execution:done":function(e){return"Wykonane"},"execution:order:label":function(e){return t.v(e,"orderId")+", "+t.v(e,"quantityDone")+" szt."},"execution:order:orderNo":function(e){return"Nr zlecenia"},"execution:order:operationNo":function(e){return"Nr operacji"},"execution:order:startedAt":function(e){return"Czas rozpoczęcia"},"execution:order:finishedAt":function(e){return"Czas zakończenia"},"execution:order:quantityDone":function(e){return"Ilość sztuk"},"execution:order:workerCount":function(e){return"Ilość osób"},"execution:downtime:label":function(e){return t.v(e,"reason")},"execution:downtime:reason":function(e){return"Powód"},"execution:downtime:aor":function(e){return"Obszar"},"execution:downtime:startedAt":function(e){return"Czas rozpoczęcia"},"execution:downtime:finishedAt":function(e){return"Czas zakończenia"},"ft:warning":function(e){return"Zlecenie zakończyć może tylko osoba uprawniona, ponieważ nie wykonano wszystkich testów ramki. Poinformuj swojego przełożonego."},"ft:login":function(e){return"Login"},"ft:password":function(e){return"Hasło"},"ft:invalidCredentials":function(e){return"Nieprawidłowy login i/lub hasło."},"ft:noPrivileges":function(e){return"Użytkownik nie ma odpowiednich uprawnień."},"ft:requestFailure":function(e){return"Sprawdzanie uprawnień nie powiodło się."},"componentLabels:title":function(e){return"Drukowanie etykiet komponentów"},"componentLabels:orderNo":function(e){return"Numer zlecenia"},"componentLabels:operationNo":function(e){return"Numer operacji"},"componentLabels:labelQty":function(e){return"Ilość etykiet"},"componentLabels:shiftX":function(e){return"Przesunięcie X"},"componentLabels:shiftY":function(e){return"Przesunięcie Y"},"componentLabels:componentCode":function(e){return"Komponent"},"componentLabels:noComponents":function(e){return"Brak pasujących komponentów."},"componentLabels:submit":function(e){return"Drukuj etykiety"},"componentLabels:test":function(e){return"Drukuj etykietę testową"},"componentLabels:cancel":function(e){return"Anuluj"},"componentLabels:error":function(e){return"Drukowanie nie powiodło się."},"componentLabels:error:PRINTER_NOT_FOUND":function(e){return"Nie znaleziono drukarki."},"componentLabels:error:INVALID_PRINTER":function(e){return"Nieprawidłowa drukarka."},"sequence:shift":function(e){return"Zm."},"sequence:order":function(e){return"Zlecenie"},"sequence:name":function(e){return"Nazwa wyrobu"},"sequence:quantity":function(e){return"Ilość"},"sequence:faps":function(e){return"Problemy"},"sequence:empty":function(e){return"Brak danych."},"settings:tab:operator":function(e){return"Formatka operatora"},"settings:tab:downtimes":function(e){return"Przestoje"},"settings:tab:spigot":function(e){return"Sprawdzanie Spigota"},"settings:tab:bomChecker":function(e){return"Sprawdzanie komponentów"},"settings:tab:componentLabels":function(e){return"Etykiety komponentów"},"settings:tab:taktTime":function(e){return"Takt Time"},"settings:initialDowntimeWindow":function(e){return"Czas na rozpoczęcie początkowego przestoju na zmianie [min]"},"settings:rearmDowntimeReason":function(e){return"Przestój ze sprawdzaniem Spigota"},"settings:spigotLines":function(e){return"Linie ze sprawdzaniem Spigota"},"settings:spigotPatterns":function(e){return"Wybierz komponent Spigot pasujący do jednego z poniższych wzorców"},"settings:spigotNotPatterns":function(e){return"Zignoruj wybrany komponent, jeżeli pasuje do jednego z poniższych wzorców"},"settings:spigotFinish":function(e){return"Wymuś sprawdzanie Spigota na koniec zlecenia"},"settings:spigotGroups":function(e){return"Grupy 12NC Spigotów"},"settings:spigotGroups:help":function(e){return"Przypisanie 12NC komponentów Spigot do 12NC skanowanych przez Operatora. Wymagany format: <code>$12NC_skanowane: $12NC_spigota_1, $12NC_spigota_2, ...</code> (każde skanowane 12NC w oddzielnej linii)."},"settings:spigotInsertGroups":function(e){return"Grupy 12NC Insertów"},"settings:spigotInsertGroups:help":function(e){return"Przypisanie 12NC opraw do 12NC skanowanych przez Operatora. Wymagany format: <code>$12NC_skanowane: $12NC_oprawy_1, $12NC_oprawy_2, ...</code> (każde skanowane 12NC w oddzielnej linii)."},"settings:taktTime:enabled":function(e){return"Skanowanie numerów seryjnych"},"settings:taktTime:ignoredLines":function(e){return"Wyłącz skanowanie na następujących liniach:"},"settings:taktTime:ignoredDowntimes":function(e){return"Ignoruj czas trwania następujących przestojów:"},"settings:taktTime:last":function(e){return"Pokazuj czas cyklu dla ostatniej sztuki"},"settings:taktTime:avg":function(e){return"Pokazuj średni czas cyklu dla aktualnego zlecenia"},"settings:taktTime:sap":function(e){return"Pokazuj czas taktu SAP dla aktualnego zlecenia"},"settings:taktTime:smiley":function(e){return"Pokazuj buźkę"},"settings:taktTime:coeffs":function(e){return"Współczynniki operacji"},"settings:taktTime:coeffs:help":function(e){return"W każdej linii należy podać MRP zlecenia, dla którego współczynniki Takt Time mają być zmienione, a następnie WorkCenter operacji, numer operacji i wartości współczynników. W miejsce MRP i WorkCenter można użyć znaku <code>*</code> (domyślne). Numer operacji jest opcjonalny. Na przykład:<br><code class='multiline text-mono'>*:      *=1.053 */0010=1.1 PIVATIC5=0.9<br>KE6:    *=1 OUTDOOR5=1.1 OUTDOOR5/0025=0.9<br>XYZ: <* *=1 FOO=0.9 BAR=1.1</code>"},"settings:lineAutoDowntimes":function(e){return"Automatyczne przestoje"},"settings:lineAutoDowntimes:groups:placeholder":function(e){return"Wybierz istniejącą grupę linii, aby zmienić automatyczne przestoje."},"settings:lineAutoDowntimes:groups:label":function(e){return"Grupy automatycznych przestojów"},"settings:lineAutoDowntimes:group:label":function(e){return"Nazwa grupy"},"settings:lineAutoDowntimes:reasons:placeholder":function(e){return"Wybierz nowy automatyczny przestój"},"settings:lineAutoDowntimes:lines:label":function(e){return"Linie produkcyjne w grupie"},"settings:lineAutoDowntimes:reason":function(e){return"Automatyczny powód przestoju"},"settings:lineAutoDowntimes:init":function(e){return"Inicjalizacja"},"settings:lineAutoDowntimes:when:initial":function(e){return"na początku zmiany"},"settings:lineAutoDowntimes:when:always":function(e){return"zawsze"},"settings:lineAutoDowntimes:when:time":function(e){return"o godzinie"},"settings:lineAutoDowntimes:when:after":function(e){return"po innym"},"settings:lineAutoDowntimes:when:after:placeholder":function(e){return"wybierz inny przestój..."}}}),define("app/production/snManager",["underscore","jquery","app/broker","app/viewport","app/i18n","app/time","app/user","app/data/prodLog","app/data/localStorage","app/production/views/BomCheckerDialogView","app/production/templates/snMessage","i18n!app/nls/production"],function(e,t,n,i,r,o,a,s,u,c,l){"use strict";var d=/[A-Z0-9]{4}\.000000000\.0000/,p=null,f="",h=JSON.parse(u.getItem("PRODUCTION:SN")||"{}"),m={_id:"",count:0,time:0},g=null,v=!1;function y(e){if(e&&(f=e),e=f.trim(),f="","<ESC>"===e||"1337000027"===e)return i.closeAllDialogs();var t=e.match(/P0*([0-9]{9})([0-9]{4})/);t||(t=e.match(/([A-Z0-9]{4}\.([0-9]{9})\.([0-9]{4}))$/))&&/^[A-Z0-9]+\.[0-9]+\.[0-9]+\.[A-Z0-9]+$/.test(e)&&(t=null),t?n.publish("production.taktTime.snScanned",{_id:t[1],scannedAt:new Date,orderNo:t[2],serialNo:+t[3]}):e.length>5&&n.publish("production.taktTime.snScanned",{_id:e,scannedAt:new Date,orderNo:null,serialNo:null})}return window.fakeSN=y,{contains:function(e){return!d.test(e)&&!!h[e]},add:function(e){d.test(e)||(h[e._id]=[Date.parse(e.scannedAt),e.prodShiftOrder,e.prodLine],u.setItem("PRODUCTION:SN",JSON.stringify(h)))},clear:function(){h={},u.removeItem("PRODUCTION:SN")},getLocalTaktTime:function(t,n,i){var r=1,o=1,a=t.scannedAt.getTime(),s=new Date(n.get("startedAt")).getTime(),u=(new Date).getHours(),c=n.get("prodLine");Object.keys(h).forEach(function(e){var t=h[e];t[1]===n.id&&(r+=1,s=t[0]),t[2]===c&&new Date(t[0]).getHours()===u&&(o+=1)});var l=a-s;return{result:"SUCCESS",serialNumber:e.assign({taktTime:l,prodShiftOrder:n.id,prodLine:c},t),quantityDone:r,lastTaktTime:l,avgTaktTime:0,hourlyQuantityDone:{index:i,value:o}}},showMessage:function(n,i,o,a){if(this.view){n||(n={_id:""});var s=t("#snMessage");s.length||(s=t(l()).appendTo("body")).on("click",this.hideMessage.bind(this));var u=n._id.length>43?n._id.substring(0,40)+"...":n._id;!a&&e.includes(["MAX_TOTAL","MAX_LINE"],o)&&(a=18e3),t("#snMessage-text").html("function"==typeof o?o():r("production","snMessage:"+o));var c=0===u.length,d=0===(n.orderNo||"").length,p=0===(n.serialNo||"").length;s.find(".production-snMessage-props").toggleClass("hidden",c&&d&&p),t("#snMessage-scannedValue").text(u).closest(".production-snMessage-prop").toggleClass("hidden",c),t("#snMessage-orderNo").text(n.orderNo||"-").closest(".production-snMessage-prop").toggleClass("hidden",d),t("#snMessage-serialNo").text(n.serialNo||"-").closest(".production-snMessage-prop").toggleClass("hidden",p),s.removeClass("hidden is-info is-success is-error is-warning").addClass("is-"+i),document.body.classList.add("production-snMessage-active"),this.view.timers.hideSnMessage&&clearTimeout(this.view.timers.hideSnMessage),this.view.timers.hideSnMessage=setTimeout(this.hideMessage.bind(this),a||6e3)}},hideMessage:function(){this.view&&(this.view.timers.hideSnMessage&&clearTimeout(this.view.timers.hideSnMessage),this.view.timers.hideSnMessage=null,t("#snMessage").addClass("hidden"),document.body.classList.remove("production-snMessage-active"))},createDynamicLogEntry:function(e){var t={_id:null,instanceId:window.INSTANCE_ID,type:"checkSerialNumber",data:e,createdAt:o.getMoment().toDate(),creator:a.getInfo(),prodLine:window.WMES_LINE_ID,station:window.WMES_STATION||0};return e.sapTaktTime=-1,e.extraPsn=v,t},bind:function(e){var n=this;if(n.view)throw new Error("snManager already bound!");n.view=e;var o=e.destroy;function a(e){var t=e.target.tagName,n="INPUT"===t&&"BUTTON"!==e.target.type||"SELECT"===t||"TEXTAREA"===t;8!==e.keyCode||n&&!e.target.readOnly&&!e.target.disabled||e.preventDefault(),e.target.classList.contains("form-control")&&void 0===e.target.dataset.snAccept||e.key&&1===e.key.length&&(f+=e.key.toUpperCase(),clearTimeout(p),p=setTimeout(y,50))}function u(e){if(e){if(i.currentDialog){if(!(i.currentDialog instanceof c))return;return void(e.orderNo?function(e){var t=i.currentDialog.model.logEntry.data;if(e._id===t._id)return void u();0===e.serialNo&&/^0+$/.test(e.orderNo)||e.orderNo!==t.orderNo?(i.closeAllDialogs(),l(e)):(i.currentDialog.onSnScanned(e),u())}(e):(i.currentDialog.onSnScanned(e),u()))}e.orderNo?l(e):l({_id:"0000.000000000.0000",orderNo:"000000000",serialNo:0,scannedAt:(t=e).scannedAt},t)}else{var t;g&&(g.length?u(g.shift()):g=null)}}function l(t,i){if(e.createCheckSn)e.createCheckSn(t,i,d);else{var r=n.contains(t._id)?"ALREADY_USED":null;r&&n.showMessage(t,"error",r),d(r,n.createDynamicLogEntry(t),i)}}function d(t,o,a){if(t)u();else{var l=e.model,p=l&&l.updateTaktTime&&l.updateTaktTimeLocally;n.showMessage(o.data,"warning","CHECKING"),m._id===o.data._id&&m.count>=2&&o.data.scannedAt-m.time<3e3&&(o.data.skipMaxCheck=!0);var f=e.ajax({method:"POST",url:"/production/checkSerialNumber?bomCheck="+(a?1:0),data:JSON.stringify(o),timeout:6e3});f.fail(function(e){if(e.status<200)return p&&l.updateTaktTimeLocally(o),n.showMessage(o.data,"success","SUCCESS"),void u();p&&o._id&&(o.data.error="SERVER_FAILURE",s.record(l,o)),n.showMessage(o.data,"error","SERVER_FAILURE"),u()}),f.done(function(t){"MAX_TOTAL"===t.result||"MAX_LINE"===t.result?(m._id===o.data._id&&o.data.scannedAt-m.time<3e3?m.count+=1:(m._id=o.data._id,m.count=1),m.time=o.data.scannedAt.getTime()):m._id="","CHECK_BOM"===t.result?function(t,o){n.hideMessage(),o&&(t.logEntry.data._id="0000.000000000.0000",t.logEntry.data.serialNo=0);var a=!1,s=new c({model:t,snMessage:{show:n.showMessage.bind(n),hide:n.hideMessage.bind(n)}});e.listenToOnce(s,"dialog:hidden",function(){a||(a=!0,u())}),e.listenToOnce(s,"dialog:shown",function(){o&&s.onSnScanned(o),a||(a=!0,u())}),e.listenToOnce(s,"checked",function(e){a=!0,i.closeAllDialogs(),d(null,e)}),i.showDialog(s,r("production","bomChecker:title"))}(t,a):"SUCCESS"===t.result?(p&&l.updateTaktTime(t),n.showMessage(t.serialNumber,"success","SUCCESS"),u()):("ALREADY_USED"===t.result&&n.add(t.serialNumber),p&&o._id&&(o.data.error=t.result,s.record(l,o)),n.showMessage(o.data,"error",t.result),u())})}}e.destroy=function(){t(window).off("keydown",a),o.apply(e,arguments)},e.broker.subscribe("production.taktTime.snScanned",function(e){if(n.view&&n.view.onSnScanned)return void n.view.onSnScanned(e);if(g)return void g.push(e);g=[],u(e)}),t(window).on("keydown",a)},isExtraPsnEnabled:function(){return v},toggleExtraPsn:function(){v=!v}}}),define("app/production/Execution",["underscore","app/core/Model"],function(e,t){"use strict";return t.extend({nlsDomain:"production",initialize:function(e,t){this.prodLineId=t.prodLineId},url:function(){return"/production/planExecution/"+this.prodLineId+"?queue=0"},parse:function(e){return e.execution},startDowntime:function(e){var t=this.get("doneDowntimes")||[],n=this.serializeDowntime(e),i=t.concat(n);this.set("doneDowntimes",i)},updateDowntime:function(t){var n=this.get("doneDowntimes")||[],i=n[n.length-1];i&&(e.assign(i,this.serializeDowntime(t)),this.trigger("change:lastDowntime",i))},startOrder:function(e){var t=this.get("doneOrders")||[],n=this.serializeOrder(e),i=t.concat(n);this.set("doneOrders",i)},updateOrder:function(t){var n=this.get("doneOrders")||[],i=n[n.length-1];i&&(e.assign(i,this.serializeOrder(t)),this.trigger("change:lastOrder",i))},serializeDowntime:function(e){var t=e.get("finishedAt");return{shift:e.get("shift"),reason:e.get("reason"),aor:e.get("aor"),startedAt:e.get("startedAt").getTime(),finishedAt:t?t.getTime():0}},serializeOrder:function(e){var t=e.get("finishedAt");return{shift:e.get("shift"),orderId:e.get("orderId"),operationNo:e.get("operationNo"),quantityDone:e.get("quantityDone"),workerCount:e.get("workerCount"),startedAt:e.get("startedAt").getTime(),finishedAt:t?t.getTime():0,taktTime:e.get("avgTaktTime")&&e.get("sapTaktTime")?e.isTaktTimeOk()?"ok":"nok":"na"}}})}),define("app/prodShifts/ProdShift",["underscore","jquery","../i18n","../user","../time","../socket","../viewport","../core/Model","../core/util/getShiftStartInfo","../data/downtimeReasons","../data/subdivisions","../data/workCenters","../data/prodFlows","../data/prodLines","../data/prodLog","../data/localStorage","../prodLines/ProdLine","../prodDowntimes/ProdDowntime","../prodDowntimes/ProdDowntimeCollection","../prodShiftOrders/ProdShiftOrder","../prodShiftOrders/ProdShiftOrderCollection","../isa/IsaRequestCollection","../production/settings","../production/snManager","../production/Execution","app/core/templates/userInfo"],function(e,t,n,i,r,o,a,s,u,c,l,d,p,f,h,m,g,v,y,_,b,w,A,k,E,T){"use strict";return s.extend({urlRoot:"/prodShifts",clientUrlRoot:"#prodShifts",topicPrefix:"prodShifts",privilegePrefix:"PROD_DATA",nlsDomain:"prodShifts",defaults:function(){return{division:null,subdivision:null,mrpControllers:null,prodFlow:null,workCenter:null,prodLine:null,date:null,shift:null,state:null,quantitiesDone:[{planned:0,actual:0},{planned:0,actual:0},{planned:0,actual:0},{planned:0,actual:0},{planned:0,actual:0},{planned:0,actual:0},{planned:0,actual:0},{planned:0,actual:0}],comments:[null,null,null,null,null,null,null,null],creator:null,createdAt:null,master:null,leader:null,operator:null,operators:null}},initialize:function(e,t){t&&t.production&&(this.nlsDomain="production",window.WMES_LINE_ID=this.get("prodLine"),window.WMES_STATION=this.get("station")||0,this.prodLine=f.get(window.WMES_LINE_ID),this.prodLine||(this.prodLine=new g({_id:null})),this.prodLine.station=window.WMES_STATION,this.shiftChangeTimer=null,this.settings=A.acquire({localStorage:!0}),this.prodShiftOrder=new _(null,{settings:this.settings}),this.prodDowntimes=new y(null,{paginate:!1,rqlQuery:"sort(-startedAt)&limit(8)&prodLine="+encodeURIComponent(this.prodLine.id)}),this.isaRequests=w.activeForLine(this.prodLine.id),this.execution=new E(null,{prodLineId:this.prodLine.id}))},serialize:function(t){var i=this.toJSON();if(i.createdAt=r.format(i.createdAt,"LL, LTS"),i.creator=T({userInfo:i.creator}),i.date=r.format(i.date,"L"),i.shift=i.shift?n("core","SHIFT:"+i.shift):"?",t.orgUnits){var o=l.get(i.subdivision),a=p.get(i.prodFlow),s={};e.forEach(i.orderMrp,function(e){s[e]=1}),e.forEach(i.mrpControllers,function(e){s[e]=1}),i.subdivision=o?o.getLabel():"?",i.prodFlow=a?a.getLabel():"?",i.mrpControllers=e.map(s,function(t,n){return i.orderMrp&&i.orderMrp.length&&!e.includes(i.orderMrp,n)?'<span style="text-decoration: line-through">'+n+"</span>":n}).join("; ")}if(t.personnel&&(i.master=T({userInfo:i.master}),i.leader=T({userInfo:i.leader}),Array.isArray(i.operators)&&i.operators.length?i.operator=i.operators.map(function(e){return T({userInfo:e})}).join("; "):i.operator=T({userInfo:i.operator})),t.totalQuantityDone){var u={planned:0,actual:0};e.forEach(i.quantitiesDone,function(e){u.planned+=e.planned,u.actual+=e.actual}),i.totalQuantityDone=n("prodShifts","totalQuantityDone",u)}return i.efficiency=Math.round(100*i.efficiency)+"%",i.orderMrp=Array.isArray(i.orderMrp)?i.orderMrp.join("; "):"",i},serializeDetails:function(){return this.serialize({orgUnits:!0,personnel:!0,totalQuantityDone:!0})},serializeRow:function(){var e=this.serialize({orgUnits:!0,totalQuantityDone:!0}),t=this.get("efficiency");return this.get("working")&&(e.className=t>=1?"success":t<.9?"danger":"warning"),e},startShiftChangeMonitor:function(){this.stopShiftChangeMonitor(),this.shiftChangeTimer=setTimeout(function(e){e.shiftChangeTimer=null,e.changeShift(),e.trigger("second")},1e3,this)},stopShiftChangeMonitor:function(){null!==this.shiftChangeTimer&&(clearTimeout(this.shiftChangeTimer),this.shiftChangeTimer=null)},readLocalData:function(t){if(!this.isLocked()){var n=null;try{n=this.constructor.parse(t||JSON.parse(m.getItem(this.getDataStorageKey()))),this.prodShiftOrder.clear(),n.prodShiftOrder&&this.prodShiftOrder.set(_.parse(n.prodShiftOrder)),this.prodDowntimes.reset((n.prodDowntimes||[]).map(v.parse),{silent:!0}),delete n.prodShiftOrder,delete n.prodDowntimes}catch(e){}e.isEmpty(n)||(this.prodDowntimes.findFirstUnfinished()?n.state="downtime":this.prodShiftOrder.id?n.state="working":n.state="idle",this.set(n)),t&&this.saveLocalData(),this.prodDowntimes.length&&this.prodDowntimes.trigger("reset"),this.changeShift()}},saveLocalData:function(){if(!this.isLocked()){var e=this.toJSON();delete e.division,delete e.subdivision,delete e.mrpControllers,delete e.prodFlow,delete e.workCenter,delete e.prodLine,e.prodShiftOrder=this.prodShiftOrder.toJSON(),e.prodDowntimes=this.prodDowntimes.toJSON(),m.setItem(this.getDataStorageKey(),JSON.stringify(e))}},changeShift:function(){var e=this.getCurrentShiftMoment().toDate(),t=this.get("date");return t&&e.getTime()<=t.getTime()?this.startShiftChangeMonitor():o.isConnected()?this.startNewShiftIfNecessary(e):void this.startNewShift(e)},startNewShiftIfNecessary:function(e){var t=this;this.findExistingShift(e,function(n){n?t.readLocalData(n):t.startNewShift(e)})},findExistingShift:function(e,n){var i=t.ajax({url:"/prodShifts?prodLine="+this.get("prodLine")+"&date="+e.getTime()});i.fail(function(){n(null)}),i.done(function(e){if(!e||!e.totalCount||!Array.isArray(e.collection))return n(null);var r=e.collection[0];r.nextOrder=null;var o=t.ajax({url:"/prodShiftOrders?prodShift="+r._id+"&finishedAt=null&sort(-startedAt)"}),a=t.ajax({url:"/prodDowntimes?prodLine="+r.prodLine+"&sort(-startedAt)&limit(8)"});(i=t.when(o,a)).fail(function(){n(null)}),i.done(function(e,t){var i=e[0].collection,o=t[0].collection;r.prodShiftOrder=i&&i[0]?i[0]:null,r.prodDowntimes=Array.isArray(o)?o:[],n(r)})})},startNewShift:function(e){k.clear();var t=this.id||null;this.finishDowntime(!1),this.finishOrder(),this.prodShiftOrder.onShiftChanged(),this.set({date:e,shift:this.getCurrentShift(),state:"idle",quantitiesDone:[{planned:0,actual:0},{planned:0,actual:0},{planned:0,actual:0},{planned:0,actual:0},{planned:0,actual:0},{planned:0,actual:0},{planned:0,actual:0},{planned:0,actual:0}],comments:[null,null,null,null,null,null,null,null],creator:i.getInfo(),createdAt:new Date,master:null,leader:null,operator:null,operators:null,nextOrder:null}),this.set("_id",h.generateId(this.get("createdAt"),this.prodLine.id)),h.record(this,"changeShift",{finishedProdShiftId:t,startedProdShift:this.toJSON()}),this.startShiftChangeMonitor()},changeMaster:function(e){this.changePersonnel("changeMaster","master",e)},changeLeader:function(e){this.changePersonnel("changeLeader","leader",e)},changeOperators:function(t){var n=this.get("operators");e.isEqual(t,n)||(this.set({operator:t.length?t[0]:null,operators:t}),this.onPersonnelChanged("operator"),h.record(this,"changeOperators",{personnel:t}))},changePersonnel:function(e,t,n){var i=this.get(t);i===n||i&&n&&i.id===n.id||(this.set(t,n),this.onPersonnelChanged(t),h.record(this,e,n))},onPersonnelChanged:function(e){var t={};t[e]=this.get(e),"operator"===e&&(t.operators=this.get("operators")),this.prodShiftOrder.id&&this.prodShiftOrder.set(t);var n=this.prodDowntimes.findFirstUnfinished();n&&n.set(t)},changeCurrentQuantitiesDone:function(e){this.changeQuantitiesDone(this.getCurrentQuantityDoneHourIndex(),e)},changeQuantitiesDone:function(e,t,n){("number"!=typeof t||isNaN(t))&&(t=0);var i=this.get("quantitiesDone");if(!i[e])throw new Error("Invalid hour: "+e);i[e].actual!==t&&(i[e].actual=t,this.trigger("change:quantitiesDone",this,i,n||{}),n&&!1===n.record||h.record(this,"changeQuantitiesDone",{hour:e,newValue:t}))},changeOrder:function(e,t,n){var i=Date.now();this.finishOrder(new Date(i-1)),this.set({state:"working",nextOrder:this.getNextOrders().filter(function(t){return t.order.no!==e.no})});var r=this.prodShiftOrder.get("orderId");this.prodShiftOrder.onOrderChanged(this,e,t,n>0?n:0),h.record(this,"changeOrder",this.prodShiftOrder.toJSON(),new Date(i)),this.execution.startOrder(this.prodShiftOrder),!r&&this.isCrossShiftContinuation()||r!==this.prodShiftOrder.get("orderId")&&this.autoStartDowntime()},isCrossShiftContinuation:function(){var e=(new Date).getHours();if(e<22||e>22)return!1;var t=this.execution.get("doneOrders"),n=t[t.length-1],i=t[t.length-2];return!!i&&(!(u(n.startedAt).startTime>u(i.startedAt))&&n.orderId===i.orderId)},correctOrder:function(e,t){if(!this.hasOrder())throw new Error("Cannot correct the order: no order is started!");var n=this.prodShiftOrder.onOrderCorrected(this,e,t);n&&(h.record(this,"correctOrder",n),this.execution.updateOrder(this.prodShiftOrder),this.trigger("orderCorrected"))},setNextOrder:function(t){var n=this.get("nextOrder"),i=e.isEmpty(t);if(!i||!e.isEmpty(n)){var r=n?n.map(a).filter(s):[],o=t?t.map(a).filter(s):[];e.isEqual(o,r)||(i&&(t=[],o=[]),this.set("nextOrder",t),h.record(this,"setNextOrder",{orders:o}))}function a(e){return{orderNo:e.order&&e.order.no||e.orderNo,operationNo:e.operationNo,workerCount:e.workerCount||0}}function s(e){return"string"==typeof e.orderNo}},continueOrder:function(){if(this.hasOrder())throw new Error("Cannot continue the order: an order is already started!");if(!this.prodShiftOrder.hasOrderData())throw new Error("Cannot continue the order: no order data!");this.set("state","working"),this.prodShiftOrder.onOrderContinued(this),h.record(this,"changeOrder",this.prodShiftOrder.toJSON()),this.execution.startOrder(this.prodShiftOrder)},changeQuantityDone:function(e){if(!this.hasOrder())throw new Error("Cannot change the quantity done: no prod shift order!");("number"!=typeof e||isNaN(e))&&(e=0),e!==this.prodShiftOrder.get("quantityDone")&&(this.prodShiftOrder.set("quantityDone",e),h.record(this,"changeQuantityDone",{newValue:e}),this.execution.updateOrder(this.prodShiftOrder))},changeWorkerCount:function(e){if(!this.hasOrder())throw new Error("Cannot change the worker count: no prod shift order!");("number"!=typeof e||isNaN(e))&&(e=0),e!==this.prodShiftOrder.get("workerCount")&&(this.prodShiftOrder.set("workerCount",e),this.prodShiftOrder.set("sapTaktTime",this.prodShiftOrder.getSapTaktTime()),h.record(this,"changeWorkerCount",{newValue:e,sapTaktTime:this.prodShiftOrder.get("sapTaktTime")}),this.execution.updateOrder(this.prodShiftOrder))},endDowntime:function(){this.hasOrder()?this.set("state","working"):this.set("state","idle");var e=this.prodDowntimes.findFirstUnfinished();this.finishDowntime()?this.startNextAutoDowntime(e):this.saveLocalData()},endWork:function(){this.finishDowntime(),this.finishOrder(),this.set("state","idle"),this.prodShiftOrder.onWorkEnded(),h.record(this,"endWork",{})},startDowntime:function(e){if("working"===this.get("state")){var t=this.prodDowntimes.addFromInfo(this,e);this.set("state","downtime"),h.record(this,"startDowntime",t.toJSON()),this.execution.startDowntime(t)}},finishOrder:function(e){var t=this.prodShiftOrder.finish();return!!t&&(h.record(this,"finishOrder",t,e),this.execution.updateOrder(this.prodShiftOrder),!0)},finishDowntime:function(){var e=this.prodDowntimes.finish();return e&&(h.record(this,"finishDowntime",e),this.execution.updateDowntime(this.prodDowntimes.first())),!!e},editDowntime:function(e,t){e.set(t),(t=e.changedAttributes())&&(t._id=e.id,h.record(this,"editDowntime",t),this.execution.updateDowntime(e))},isTaktTimeEnabled:function(){return!this.isLocked()&&this.settings.isTaktTimeEnabled(this.prodLine.id)},updateTaktTimeLocally:function(e){this.updateTaktTime(k.getLocalTaktTime(e.data,this.prodShiftOrder,this.getCurrentQuantityDoneHourIndex())),h.record(this,e)},updateTaktTime:function(e){var t=e.serialNumber;if(k.add(t),e.hourlyQuantityDone){var n=this.get("quantitiesDone");n||(n=this.attributes.quantitiesDone=[{planned:0,actual:0},{planned:0,actual:0},{planned:0,actual:0},{planned:0,actual:0},{planned:0,actual:0},{planned:0,actual:0},{planned:0,actual:0},{planned:0,actual:0}]),n[e.hourlyQuantityDone.index].actual=e.hourlyQuantityDone.value,this.trigger("change:quantitiesDone",this,n,{})}e.quantityDone>=0&&(!t.prodShiftOrder||t.prodShiftOrder===this.prodShiftOrder.id)&&(this.prodShiftOrder.set({quantityDone:e.quantityDone,lastTaktTime:e.lastTaktTime,avgTaktTime:e.avgTaktTime}),this.execution.updateOrder(this.prodShiftOrder)),this.saveLocalData()},checkSpigot:function(e,t){var n,i=this.prodShiftOrder.get("spigot"),r=!1;if(e)i?n=i.prodDowntime:(n=this.prodDowntimes.findFirstUnfinished()||this.prodDowntimes.first()||null)&&(n=n.id);else{if(!i)return!0;n=i.prodDowntime,e=i.component,r=!0}var o=this.checkSpigotValidity(t,e.nc12);return o&&this.prodShiftOrder.set("spigot",{prodDowntime:n,component:e,initial:!0,final:r}),h.record(this,"checkSpigot",{final:r,valid:o,nc12:t,component:e,prodDowntime:n}),o},checkSpigotValidity:function(e,t){if(e===t)return!0;var n={};return(this.settings.getValue("spigotGroups")||"").split("\n").forEach(function(e){var t=e.split(":"),i=t[0].trim();t[1].split(", ").forEach(function(e){n[e.trim()]=i})}),e===n[t]},hasOrder:function(){return!!this.prodShiftOrder.id},getLabel:function(){var e=this.get("prodLine")||"?",t=this.get("date"),i=this.get("shift");return t&&i&&(e+=": "+r.format(this.get("date"),"L"),e+=", "+n("core","SHIFT:"+this.get("shift"))),e},getCurrentTime:function(){return r.getMoment().format("L, LTS")},getCurrentShift:function(){var e=r.getMoment().hour();return e>=6&&e<14?1:e>=14&&e<22?2:3},getCurrentShiftMoment:function(){return u(Date.now()).moment},getTimeToNextShift:function(){return this.getCurrentShiftMoment().add(8,"hours").diff(r.getMoment())},getCurrentQuantityDoneHourIndex:function(){var e=r.getMoment().hours();return e>=6&&e<14?e-6:e>=14&&e<22?e-14:22===e?0:23===e?1:e+2},getCurrentQuantityDoneHourRange:function(){var e=r.getMoment().minutes(0).seconds(0);return e.format("LTS")+"-"+e.minutes(59).seconds(59).format("LTS")},getQuantityDoneInCurrentHour:function(){var e=this.get("quantitiesDone");if(!Array.isArray(e))return 0;var t=this.getCurrentQuantityDoneHourIndex();return t>=e.length?0:e[t].actual},getOrderIdType:function(){return"press"===this.getSubdivisionType()?"nc12":"no"},isIdle:function(){return"idle"===this.get("state")},isDowntime:function(){return"downtime"===this.get("state")},isWorking:function(){return"working"===this.get("state")},getMaxQuantitiesDone:function(){return 150},getSubdivisionType:function(){var e=l.get(this.get("subdivision"));return e?e.get("type"):null},getDowntimeReasons:function(){return c.findBySubdivisionType(this.getSubdivisionType())},getBreakReason:function(){return c.findFirstBreakIdBySubdivisionType(this.getSubdivisionType())},getDefaultAor:function(){var e=this.prodLine.getSubdivision();return e?e.get("aor"):null},isSpigotLine:function(){return-1!==(this.settings.getValue("spigotLines")||"").split(",").indexOf(this.prodLine.id)},getSpigotComponent:function(){return this.prodShiftOrder.getSpigotComponent(this.settings.getValue("spigotPatterns"),this.settings.getValue("spigotNotPatterns"))},getSpigotInsertComponent:function(){return this.prodShiftOrder.getSpigotInsertComponent(this.settings.getValue("spigotInsertGroups"))},getNextOrders:function(){var t=this.get("nextOrder")||[];return Array.isArray(t)||e.isEmpty(t)||(t=[{order:t.orderInfo,operationNo:t.operationNo}]),t},hasOrderQueue:function(){return!e.isEmpty(this.get("nextOrder"))},hasEnded:function(){return r.getMoment(this.get("date")).valueOf()<u(new Date).moment.valueOf()},updateQuantities:function(e,t){var n=this.attributes.quantitiesDone;if(Array.isArray(e)&&8===e.length&&Array.isArray(n)){for(var i=0;i<8;++i)n[i].planned=e[i],n[i].actual=t[i];this.saveLocalData(),this.trigger("change:quantitiesDone",this,this.attributes.quantitiesDone,{})}},updatePlannedQuantities:function(e){if(Array.isArray(e)&&8===e.length&&Array.isArray(this.attributes.quantitiesDone)){for(var t=0;t<8;++t)this.attributes.quantitiesDone[t].planned=e[t];this.saveLocalData(),this.trigger("change:quantitiesDone",this,this.attributes.quantitiesDone,{})}},isLocked:function(){return!h.isEnabled()||!this.prodLine||null===this.getSecretKey()},getSecretKey:function(){var e=m.getItem(this.getSecretKeyStorageKey());return"string"==typeof e?e:null},setSecretKey:function(e,t,n){null===e?(m.removeItem(this.getSecretKeyStorageKey()),m.removeItem(this.getDataStorageKey()),m.removeItem("PRODUCTION:LINE"),this.prodShiftOrder.clear(),this.prodDowntimes.reset(),this.stopShiftChangeMonitor(),this.set({prodLine:null,station:null,date:null,shift:null,state:null,quantitiesDone:null,creator:null,createdAt:null,master:null,leader:null,operator:null,operators:null}),this.trigger("locked")):(m.setItem(this.getSecretKeyStorageKey(t.prodLine),e),t.prodLine&&m.setItem("PRODUCTION:LINE",t.prodLine),m.setItem("PRODUCTION:STATION",t.station||0),n||this.trigger("unlocked"),this.readLocalData(t),n&&window.location.reload())},getSecretKeyStorageKey:function(e){return"PRODUCTION:SECRET_KEY:"+(e||this.prodLine.id)},getDataStorageKey:function(e){return"PRODUCTION:DATA:"+(e||this.prodLine.id)},autoStartDowntime:function(){var t=this.getDefaultAor(),n=l.get(this.get("subdivision"));if(t&&n){var i,r=this.settings.getAutoDowntimes(this.prodLine.id);if(e.isEmpty(r)&&(r=n.get("autoDowntimes")),!e.isEmpty(r))if(this.isBetweenInitialDowntimeWindow(Date.now())&&(i=e.find(r,function(e){return"initial"===e.when})),i||(i=e.find(r,function(e){return"always"===e.when})),i){var o=c.get(i.reason);o&&this.startDowntime({aor:t,reason:o.id,reasonComment:"",auto:{d:0,when:i.when}})}}},startNextAutoDowntime:function(t){if(t){var n=this.getDefaultAor(),i=l.get(this.get("subdivision"));if(n&&i){var r=this.settings.getAutoDowntimes(this.prodLine.id);if(e.isEmpty(r)&&(r=i.get("autoDowntimes")),!e.isEmpty(r)){var o,a=!!t.get("auto"),s=t.get("reason"),u=this.prodShiftOrder.id,d={},p=[],f=[];if(this.prodDowntimes.forEach(function(e){e.get("prodShiftOrder")===u&&(d[e.get("reason")]=!0)}),r.forEach(function(e){d[e.reason]||(a&&"always"===e.when&&p.push(e),"after"===e.when&&e.after===s&&f.push(e))}),f.length?o=f[0]:p.length&&(o=p[0]),o){var h=c.get(o.reason);if(h){if("after"===o.when){var m=h.get("aors");Array.isArray(m)&&1===m.length&&(n=m[0])}this.startDowntime({aor:n,reason:h.id,reasonComment:"",auto:{d:0,when:o.when}})}}}}}},isBetweenInitialDowntimeWindow:function(e){var t=parseInt(this.settings.getValue("initialDowntimeWindow"),10),n=this.get("date");if(isNaN(t)||t<1||!n)return!1;var i=n.getTime();return e>=i&&e<=i+60*t*1e3},shouldStartTimedAutoDowntime:function(e){return"working"===this.get("state")&&!this.prodDowntimes.some(function(t){return t.get("reason")===e&&Date.now()-Date.parse(t.get("finishedAt"))<6e5})},startTimedAutoDowntime:function(e,t){if(this.shouldStartTimedAutoDowntime(e)){var n=this.getDefaultAor();n&&(a.closeAllDialogs(),this.startDowntime({aor:n,reason:e,reasonComment:"",auto:{d:t,when:"time"}}))}}},{STATE:{IDLE:"idle",WORKING:"working",DOWNTIME:"downtime"},LINE_STORAGE_KEY:"PRODUCTION:LINE",STATION_STORAGE_KEY:"PRODUCTION:STATION",parse:function(e){return"string"==typeof e.date&&(e.date=new Date(e.date)),"string"==typeof e.createdAt&&(e.createdAt=new Date(e.createdAt)),e},calcEfficiency:function(e,t){if(!e||!t)return-1;var n=0,i=0,r={},o=Date.now();t.forEach(function(e){var t=c.get(e.get("reason"));if(t&&"break"===t.get("type")){var n=e.get("prodShiftOrder");if(n){r[n._id]||(r[n._id]=0);var i=Date.parse(e.get("startedAt")),a=Date.parse(e.get("finishedAt"))||o;r[n._id]+=a-i}}}),e.forEach(function(e){var t=e.get("workDuration"),a=_.getTaktTimeCoeff(e.attributes);t||e.get("finishedAt")||(t=(o-Date.parse(e.get("startedAt"))-(r[e.id]||0))/36e5),n+=e.get("laborTime")*a/100*e.get("quantityDone"),i+=t*e.get("workerCount")});var a=Math.min(999,Math.round(n/i*100));return a>0?a:0}})}),define("app/companies/Company",["../core/Model","app/core/util/colorLabel"],function(e,t){"use strict";return e.extend({urlRoot:"/companies",clientUrlRoot:"#companies",topicPrefix:"companies",privilegePrefix:"DICTIONARIES",nlsDomain:"companies",labelAttribute:"name",defaults:{name:"",shortName:"",color:"#000000"},serialize:function(){var e=this.toJSON();return e.color=t(e.color),e}})}),define("app/companies/CompanyCollection",["../core/Collection","./Company"],function(e,t){"use strict";return e.extend({model:t,rqlQuery:"sort(_id)"})}),define("app/data/companies",["app/companies/CompanyCollection","./createStorage"],function(e,t){"use strict";return t("COMPANIES","companies",e)}),define("app/orderStatuses/OrderStatus",["../core/Model","app/core/util/colorLabel"],function(e,t){"use strict";return e.extend({urlRoot:"/orderStatuses",clientUrlRoot:"#orderStatuses",topicPrefix:"orderStatuses",privilegePrefix:"DICTIONARIES",nlsDomain:"orderStatuses",labelAttribute:"_id",defaults:{label:null,color:"#999999"},toJSON:function(){var t=e.prototype.toJSON.call(this);return t.label||(t.label=t._id),t},serialize:function(){var e=this.toJSON();return e.color=t(e.color),e}})}),define("app/orderStatuses/OrderStatusCollection",["../core/Collection","./OrderStatus"],function(e,t){"use strict";return e.extend({model:t,rqlQuery:"select(label,color)&sort(_id)",findAndFill:function(e){var n=this;return Array.isArray(e)?e.map(function(e){var i=n.get(e);return i||(i=new t({_id:e})),i.toJSON()}):[]}})}),define("app/data/orderStatuses",["app/orderStatuses/OrderStatusCollection","./createStorage"],function(e,t){"use strict";return t("ORDER_STATUSES","orderStatuses",e)}),define("app/prodFunctions/ProdFunction",["../i18n","../data/companies","../core/Model","app/core/util/colorLabel"],function(e,t,n,i){"use strict";return n.extend({urlRoot:"/prodFunctions",clientUrlRoot:"#prodFunctions",topicPrefix:"prodFunctions",privilegePrefix:"DICTIONARIES",nlsDomain:"prodFunctions",labelAttribute:"label",defaults:function(){return{label:"",direct:!1,dirIndirRatio:100,color:"#000000"}},serialize:function(){var t=this.toJSON();return t.label||(t.label=t._id),t.dirIndirRatio=t.direct?t.dirIndirRatio.toLocaleString()+" / "+(100-t.dirIndirRatio).toLocaleString():"-",t.direct=e("prodFunctions","direct:"+t.direct),t.color=i(t.color),t}})}),define("app/prodFunctions/ProdFunctionCollection",["../core/Collection","./ProdFunction"],function(e,t){"use strict";return e.extend({model:t,rqlQuery:"sort(label)",comparator:"label"})}),define("app/data/prodFunctions",["app/prodFunctions/ProdFunctionCollection","./createStorage"],function(e,t){"use strict";return t("PROD_FUNCTIONS","prodFunctions",e)}),define("app/data/dictionaries",["./aors","./companies","./downtimeReasons","./isaPalletKinds","./orderStatuses","./prodFunctions","./divisions","./subdivisions","./mrpControllers","./prodFlows","./workCenters","./prodLines"],function(e,t,n,i,r,o,a,s,u,c,l,d){"use strict";return{aors:e,AORS:e,companies:t,COMPANIES:t,downtimeReasons:n,DOWNTIME_REASONS:n,isaPalletKinds:i,ISA_PALLET_KINDS:i,orderStatuses:r,ORDER_STATUSES:r,prodFunctions:o,PROD_FUNCTIONS:o,divisions:a,DIVISIONS:a,subdivisions:s,SUBDIVISIONS:s,mrpControllers:u,MRP_CONTROLLERS:u,prodFlows:c,PROD_FLOWS:c,workCenters:l,WORK_CENTERS:l,prodLines:d,PROD_LINES:d}}),define("app/core/util/decimalSeparator",[],function(){"use strict";return 1.1.toLocaleString().substr(1,1)}),define("app/production/templates/vkb",["underscore","jquery","app/i18n","app/time","app/user","app/core/util/forms"],function(_,$,t,time,user,forms){return function anonymous(locals,escapeFn,include,rethrow){escapeFn=escapeFn||function(e){return void 0==e?"":String(e).replace(_MATCH_HTML,encode_char)};var _ENCODE_HTML_RULES={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&#34;","'":"&#39;"},_MATCH_HTML=/[&<>'"]/g;function encode_char(e){return _ENCODE_HTML_RULES[e]||e}var __output="";function __append(e){void 0!==e&&null!==e&&(__output+=e)}with(locals||{})__append('<div class="production-vkb hidden '),__append(mode.alpha?"is-alpha":""),__append(" "),__append(mode.numeric?"is-numeric":""),__append(" "),__append(mode.multiline?"is-multiline":""),__append(" "),__append(mode.extended?"is-extended":""),__append(" "),__append(extended?"is-vkb-extended":""),__append('">\n  '),mode.alpha?(__append("\n  "),mode.extended&&(__append('\n  <div class="production-vkb-row">\n    <button class="btn btn-default" type="button" tabindex="-1" data-key="`" data-extended-key="~">`</button>\n    <button class="btn btn-default" type="button" tabindex="-1" data-key="[" data-extended-key="{">[</button>\n    <button class="btn btn-default" type="button" tabindex="-1" data-key="]" data-extended-key="}">]</button>\n    <button class="btn btn-default" type="button" tabindex="-1" data-key="\\" data-extended-key="|">\\</button>\n    <button class="btn btn-default" type="button" tabindex="-1" data-key=";" data-extended-key=":">;</button>\n    <button class="btn btn-default" type="button" tabindex="-1" data-key="\'" data-extended-key="&quot;">\'</button>\n    <button class="btn btn-default" type="button" tabindex="-1" data-key="," data-extended-key="<">,</button>\n    <button class="btn btn-default" type="button" tabindex="-1" data-key="." data-extended-key=">">.</button>\n    <button class="btn btn-default" type="button" tabindex="-1" data-key="/" data-extended-key="?">/</button>\n    <button class="btn btn-default '),__append(extended?"active":""),__append('" type="button" tabindex="-1" data-key="EXTENDED">Shift</button>\n  </div>\n  ')),__append("\n  "),mode.numeric&&__append('\n  <div class="production-vkb-row">\n    <button class="btn btn-default" type="button" tabindex="-1" data-key="1" data-extended-key="!">1</button>\n    <button class="btn btn-default" type="button" tabindex="-1" data-key="2" data-extended-key="@">2</button>\n    <button class="btn btn-default" type="button" tabindex="-1" data-key="3" data-extended-key="#">3</button>\n    <button class="btn btn-default" type="button" tabindex="-1" data-key="4" data-extended-key="$">4</button>\n    <button class="btn btn-default" type="button" tabindex="-1" data-key="5" data-extended-key="%">5</button>\n    <button class="btn btn-default" type="button" tabindex="-1" data-key="6" data-extended-key="^">6</button>\n    <button class="btn btn-default" type="button" tabindex="-1" data-key="7" data-extended-key="&">7</button>\n    <button class="btn btn-default" type="button" tabindex="-1" data-key="8" data-extended-key="*">8</button>\n    <button class="btn btn-default" type="button" tabindex="-1" data-key="9" data-extended-key="(">9</button>\n    <button class="btn btn-default" type="button" tabindex="-1" data-key="0" data-extended-key=")">0</button>\n  </div>\n  '),__append('\n  <div class="production-vkb-row">\n    <button class="btn btn-default" type="button" tabindex="-1" data-key="Q" data-extended-key="q">Q</button>\n    <button class="btn btn-default" type="button" tabindex="-1" data-key="W" data-extended-key="w">W</button>\n    <button class="btn btn-default" type="button" tabindex="-1" data-key="E" data-extended-key="e">E</button>\n    <button class="btn btn-default" type="button" tabindex="-1" data-key="R" data-extended-key="r">R</button>\n    <button class="btn btn-default" type="button" tabindex="-1" data-key="T" data-extended-key="t">T</button>\n    <button class="btn btn-default" type="button" tabindex="-1" data-key="Y" data-extended-key="y">Y</button>\n    <button class="btn btn-default" type="button" tabindex="-1" data-key="U" data-extended-key="u">U</button>\n    <button class="btn btn-default" type="button" tabindex="-1" data-key="I" data-extended-key="i">I</button>\n    <button class="btn btn-default" type="button" tabindex="-1" data-key="O" data-extended-key="o">O</button>\n    <button class="btn btn-default" type="button" tabindex="-1" data-key="P" data-extended-key="p">P</button>\n  </div>\n  <div class="production-vkb-row">\n    <button class="btn btn-default" type="button" tabindex="-1" data-key="A" data-extended-key="a">A</button>\n    <button class="btn btn-default" type="button" tabindex="-1" data-key="S" data-extended-key="s">S</button>\n    <button class="btn btn-default" type="button" tabindex="-1" data-key="D" data-extended-key="d">D</button>\n    <button class="btn btn-default" type="button" tabindex="-1" data-key="F" data-extended-key="f">F</button>\n    <button class="btn btn-default" type="button" tabindex="-1" data-key="G" data-extended-key="g">G</button>\n    <button class="btn btn-default" type="button" tabindex="-1" data-key="H" data-extended-key="h">H</button>\n    <button class="btn btn-default" type="button" tabindex="-1" data-key="J" data-extended-key="j">J</button>\n    <button class="btn btn-default" type="button" tabindex="-1" data-key="K" data-extended-key="k">K</button>\n    <button class="btn btn-default" type="button" tabindex="-1" data-key="L" data-extended-key="l">L</button>\n    <button class="btn btn-default" type="button" tabindex="-1" data-key="BACKSPACE" data-extended-key="="></button>\n  </div>\n  <div class="production-vkb-row">\n    <button class="btn btn-default" type="button" tabindex="-1" data-key="Z" data-extended-key="z">Z</button>\n    <button class="btn btn-default" type="button" tabindex="-1" data-key="X" data-extended-key="x">X</button>\n    <button class="btn btn-default" type="button" tabindex="-1" data-key="C" data-extended-key="c">C</button>\n    <button class="btn btn-default" type="button" tabindex="-1" data-key="V" data-extended-key="v">V</button>\n    <button class="btn btn-default" type="button" tabindex="-1" data-key="B" data-extended-key="b">B</button>\n    <button class="btn btn-default" type="button" tabindex="-1" data-key="N" data-extended-key="n">N</button>\n    <button class="btn btn-default" type="button" tabindex="-1" data-key="M" data-extended-key="m">M</button>\n    <button class="btn btn-default" type="button" tabindex="-1" data-key="LEFT" data-extended-key="-">&lt</button>\n    <button class="btn btn-default" type="button" tabindex="-1" data-key="RIGHT" data-extended-key="_">&gt</button>\n    <button class="btn btn-default" type="button" tabindex="-1" data-key="CLEAR" data-extended-key="+"></button>\n  </div>\n  '),mode.multiline&&__append('\n  <div class="production-vkb-row">\n    <button class="btn btn-default" type="button" tabindex="-1" data-key=",">,</button>\n    <button class="btn btn-default" type="button" tabindex="-1" data-key=".">.</button>\n    <button class="btn btn-default" type="button" tabindex="-1" data-key="?">?</button>\n    <button class="btn btn-default" type="button" tabindex="-1" data-key="(">(</button>\n    <button class="btn btn-default" type="button" tabindex="-1" data-key=")">)</button>\n    <button class="btn btn-default" type="button" tabindex="-1" data-key=":">:</button>\n    <button class="btn btn-default" type="button" tabindex="-1" data-key="&quot;">&quot;</button>\n    <button class="btn btn-default" type="button" tabindex="-1" data-key="SPACE">____</button>\n    <button class="btn btn-default" type="button" tabindex="-1" data-key="ENTER"><i class="fa fa-level-down fa-rotate-90"></i></button>\n  </div>\n  '),__append("\n  ")):mode.numeric&&(__append('\n  <div class="production-vkb-row">\n    <button class="btn btn-default" type="button" tabindex="-1" data-key="1">1</button>\n    <button class="btn btn-default" type="button" tabindex="-1" data-key="2">2</button>\n    <button class="btn btn-default" type="button" tabindex="-1" data-key="3">3</button>\n  </div>\n  <div class="production-vkb-row">\n    <button class="btn btn-default" type="button" tabindex="-1" data-key="4">4</button>\n    <button class="btn btn-default" type="button" tabindex="-1" data-key="5">5</button>\n    <button class="btn btn-default" type="button" tabindex="-1" data-key="6">6</button>\n  </div>\n  <div class="production-vkb-row">\n    <button class="btn btn-default" type="button" tabindex="-1" data-key="7">7</button>\n    <button class="btn btn-default" type="button" tabindex="-1" data-key="8">8</button>\n    <button class="btn btn-default" type="button" tabindex="-1" data-key="9">9</button>\n  </div>\n  <div class="production-vkb-row">\n    <button class="btn btn-default" type="button" tabindex="-1" data-key="LEFT">&lt;</button>\n    <button class="btn btn-default" type="button" tabindex="-1" data-key="0">0</button>\n    <button class="btn btn-default" type="button" tabindex="-1" data-key="RIGHT">&gt;</button>\n  </div>\n  <div class="production-vkb-row">\n    <button class="btn btn-default" type="button" tabindex="-1" data-key="BACKSPACE"><i class="fa fa-long-arrow-left"></i></button>\n    '),mode.negative?__append('\n    <button class="btn btn-default" type="button" tabindex="-1" data-key="-">-</button>\n    '):mode.decimal?(__append('\n    <button class="btn btn-default" type="button" tabindex="-1" data-key="'),__append(decimalSeparator),__append('">'),__append(decimalSeparator),__append("</button>\n    ")):__append('\n    <button class="btn btn-default" type="button" tabindex="-1" disabled>&nbsp;</button>\n    '),__append('\n    <button class="btn btn-default" type="button" tabindex="-1" data-key="CLEAR"><i class="fa fa-eraser"></i></button>\n  </div>\n  ')),__append("\n</div>\n");return __output}}),define("app/production/views/VkbView",["underscore","jquery","app/core/View","app/core/util/decimalSeparator","app/production/templates/vkb"],function(e,t,n,i,r){"use strict";var o={BACKSPACE:'<i class="fa fa-long-arrow-left"></i>',LEFT:"<",RIGHT:">",CLEAR:'<i class="fa fa-eraser"></i>'};return n.extend({template:r,events:{"focus .btn[data-key]":function(e){this.trigger("keyFocused",e.currentTarget.dataset.key)},"click .btn[data-key]":function(e){var t=e.currentTarget.dataset.key,n=e.currentTarget.dataset.extendedKey;this.pressKey(n&&this.extended&&this.mode.extended?n:t)}},initialize:function(){this.fieldEl=null,this.positioner=null,this.adjustOverlap=!1,this.onValueChange=null,this.onKeyPress=null,this.extended=!1,this.mode={alpha:!1,numeric:!0,negative:!1,multiline:!1,extended:!1},t(window).on("resize."+this.idPrefix,e.debounce(this.reposition.bind(this),30))},destroy:function(){t(window).off("."+this.idPrefix),this.fieldEl=null,this.onValueChange=null},getTemplateData:function(){return{mode:this.mode,extended:this.extended,decimalSeparator:i}},reposition:function(){if(this.fieldEl){var e={top:"",right:"",bottom:"",left:""},n={marginLeft:""},i=this.$el,r=t(".modal-dialog");i.css(e),r.css(n);var o=r.offset(),a=r.outerWidth(),s=r.outerHeight(),u=i.offset(),c=i.outerWidth(),l=this.adjustOverlap&&o.top+s+30>u.top,d=this.adjustOverlap&&o.left+a+30>u.left;l&&this.mode.numeric&&!this.mode.alpha?(e.top=this.fieldEl.getBoundingClientRect().top+"px",e.left=o.left+a+30,e.bottom="auto",e.right="auto"):l&&d&&this.mode.alpha&&window.innerWidth>800&&(n.marginLeft=Math.max(30,window.innerWidth-30-c-30-a)+"px"),this.positioner?this.positioner(e,n):(i.toggleClass("is-repositioned",l).css(e),r.css(n))}},show:function(n,i){var r=this;return i?"function"==typeof i&&(i={onValueChange:i}):i={},e.defaults(i,{onValueChange:null,onKeyPress:null,positioner:null}),(r.fieldEl!==n||r.onValueChange!==i.onValueChange||r.onKeyPress!==i.onKeyPress)&&(Object.keys(this.mode).forEach(function(e){r.mode[e]=!1}),(n.dataset.vkb||"").split(" ").forEach(function(e){r.mode[e]=!0}),r.render(),r.$el.removeClass("is-repositioned hidden"),t(".is-vkb-focused").removeClass("is-vkb-focused"),n.classList.add("is-vkb-focused"),r.fieldEl=n,r.positioner=i.positioner,r.adjustOverlap=!1!==i.adjustOverlap,r.onValueChange=i.onValueChange,r.onKeyPress=i.onKeyPress,r.updateExtended(),r.reposition(),!0)},hide:function(){t(".modal-dialog").css("margin-left",""),this.$el.addClass("hidden"),this.fieldEl&&this.fieldEl.classList.remove("is-vkb-focused"),this.fieldEl=null,this.positioner=null,this.onValueChange=null,this.onKeyPress=null},isVisible:function(){return!this.$el.hasClass("hidden")},enableKeys:function(){this.$(".btn[data-key][disabled]").each(function(){this.disabled=!1})},disableKeys:function(e,t){null==t&&(t=!1),this.$(".btn[data-key]").each(function(){var n=e[this.dataset.key];t&&void 0===n||1===this.dataset.key.length&&(this.disabled=!0!==n)})},pressKey:function(e){var t=this.fieldEl;if(t&&(!this.onKeyPress||!1!==this.onKeyPress(e,t))){if("EXTENDED"===e)return this.toggleExtended();var n=t.value,i=t.selectionStart,r=t.selectionEnd;"ENTER"===e?e="\n":"SPACE"===e&&(e=" "),"CLEAR"===e?(i=0,n=""):"BACKSPACE"===e?(i-=1,n=n.substring(0,i)+n.substring(r)):"LEFT"===e?i-=1:"RIGHT"===e?i+=1:(!t.maxLength||-1===t.maxLength||n.length<t.maxLength)&&(n=n.substring(0,i)+e+n.substring(r),i+=1);var o=t.value!==n;t.value=n,t.focus(),t.setSelectionRange(i,i),o&&this.onValueChange&&this.onValueChange(t)}},toggleExtended:function(){this.extended=!this.extended,this.updateExtended()},updateExtended:function(){var e=this.mode.extended&&this.extended;this.$el.toggleClass("is-vkb-extended",e),this.$('.btn[data-key="EXTENDED"]').toggleClass("active",e),this.$(".btn[data-extended-key]").each(function(){var t=this.dataset[e?"extendedKey":"key"];this.innerHTML=o[t]||t})}})}),define("app/users/User",["require","underscore","app/i18n","app/core/Model","app/data/loadedModules","app/data/aors","app/data/companies","app/data/prodFunctions","app/data/orgUnits","app/orgUnits/util/renderOrgUnitPath"],function(e,t,n,i,r,o,a,s,u,c){"use strict";var l=[];function d(e){var t=e.split(":"),n=parseInt(t[0],10),i=parseInt(t[1],10);return{hours:n,minutes:i,value:1e3*n+i}}return r.isLoaded("wmes-fap")&&l.push("fap_sms"),r.isLoaded("kaizen")&&l.push("fm24_sms","fm24_email"),i.extend({urlRoot:"/users",clientUrlRoot:"#users",topicPrefix:"users",privilegePrefix:"USERS",nlsDomain:"users",labelAttribute:"login",getLabel:function(){var e=this.get("lastName")||"",t=this.get("firstName")||"";return e.length&&t.length?e+" "+t:this.get("login")},url:function(){var e=i.prototype.url.apply(this,arguments);return this.isNew()||!r.isLoaded("vendors")?e:e+"?populate(vendor)"},serialize:function(){var e=this.toJSON(),t=a.get(e.company);e.name="",e.lastName&&(e.name=e.lastName),e.firstName&&(e.name&&(e.name+=" "),e.name+=e.firstName),e.company=t?t.getLabel():"",e.active=n("users","active:"+e.active),Array.isArray(e.aors)?e.aors=e.aors.map(function(e){var t=o.get(e);return t?t.getLabel():null}).filter(function(e){return!!e}):e.aors=[];var i=s.get(e.prodFunction);if(e.prodFunction=i?i.getLabel():"",e.orgUnitType&&e.orgUnitId){var r=u.getByTypeAndId(e.orgUnitType,e.orgUnitId);r&&(e.prodOrgUnit=c(r,!1,!1))}else e.prodOrgUnit="";return e.vendor&&(e.vendor.name?e.vendor=e.vendor.name+" ("+e.vendor._id+")":e.vendor._id&&(e.vendor=e.vendor._id)),e},serializeRow:function(){var t=this.serialize();if(this.get("active")||(t.className="danger"),r.isLoaded("wmes-osh")){var n=e("app/wmes-osh-common/dictionaries");t.oshDivision=n.getLabel("division",t.oshDivision),t.oshWorkplace=n.getLabel("workplace",t.oshWorkplace),t.oshDepartment=n.getLabel("department",t.oshDepartment),!t.oshWorkplace&&t.syncData.workplace&&(t.oshWorkplace=`<em>${t.syncData.workplace}</em>`),!t.oshDepartment&&t.syncData.department&&(t.oshDepartment=`<em>${t.syncData.department}</em>`)}return!t.company&&t.syncData.company&&(t.company=`<em>${t.syncData.company}</em>`),t},serializeDetails:function(){var n=this.serialize();if(n.notifications=[],l.forEach(function(e){n.preferences&&n.preferences[e]&&n.notifications.push(e)}),n.mrps=t.isEmpty(n.mrps)?"":n.mrps.join("; "),r.isLoaded("wmes-osh")){var i=e("app/wmes-osh-common/dictionaries");n.oshDivision=i.getLabel("division",n.oshDivision,{long:!0}),n.oshWorkplace=i.getLabel("workplace",n.oshWorkplace,{long:!0}),n.oshDepartment=i.getLabel("department",n.oshDepartment,{long:!0})}return n},getMobile:function(){var e=new Date,n=1e3*e.getHours()+e.getMinutes(),i=this.get("mobile")||[],r=i.length?i[0].number:"";return i.length>1&&t.forEach(i,function(e){var t=!0,i=d(e.fromTime),o=d("00:00"===e.toTime?"24:00":e.toTime);return o.value<i.value?t=n<o.value||n>=i.value:i.value<o.value&&(t=n>=i.value&&n<o.value),t&&(r=e.number),t}),12===r.length?r.substr(0,3)+" "+r.substr(3,3)+" "+r.substr(6,3)+" "+r.substr(9,3):10===r.length?r.substr(0,3)+" "+r.substr(3,3)+" "+r.substr(6,2)+" "+r.substr(8,2):r}},{NOTIFICATIONS:l})}),define("app/users/UserCollection",["../core/Collection","./User"],function(e,t){"use strict";return e.extend({model:t,rqlQuery:"&sort(searchName)&limit(-1337)"})}),define("app/mor/Mor",["underscore","jquery","app/user","app/core/Model","app/data/orgUnits","app/data/prodFunctions","app/data/localStorage","app/users/UserCollection"],function(e,t,n,i,r,o,a,s){"use strict";function u(){return t.Deferred().resolve().promise()}function c(){return t.Deferred().reject().promise()}return i.extend({defaults:function(){return{users:[],settings:{},globalProdFunctions:[],sections:[]}},initialize:function(){this.collapsedSections=JSON.parse(a.getItem("MOR_COLLAPSED_SECTIONS")||"{}"),this.users=new s(this.attributes.users,{paginate:!1}),this.on("reset change:users",function(){this.users.reset(this.attributes.users)})},url:function(){return"/mor"},subscribe:function(e){var t=this;e.subscribe("mor.updated",t.onMorUpdated.bind(t)),e.subscribe("users.added",t.onUserEdited.bind(t)),e.subscribe("users.edited",t.onUserEdited.bind(t)),e.subscribe("users.deleted",t.onUserDeleted.bind(t)),e.subscribe("users.presence.updated",t.onPresenceUpdated.bind(t)),e.subscribe("settings.updated.mor.**",t.onSettingUpdated.bind(t))},getSection:function(t){return e.findWhere(this.get("sections"),{_id:t})||null},getWatch:function(t,n){var i=this.getSection(t);return i?e.findWhere(i.watch,{user:n}):null},getMrp:function(t,n){var i=this.getSection(t);return i?e.findWhere(i.mrps,{_id:n}):null},getUsers:function(t,n,i){var r;r=this.isGlobalProdFunction(i)?this.get("globalProdFunctions"):this.isCommonProdFunction(i)?(this.getSection(t)||{}).commonProdFunctions:(this.getMrp(t,n)||{}).prodFunctions;var o=e.findWhere(r,{_id:i});return o?o.users:[]},toggleSection:function(e,t){t?this.collapsedSections[e]=!0:delete this.collapsedSections[e],a.setItem("MOR_COLLAPSED_SECTIONS",JSON.stringify(this.collapsedSections))},isSectionCollapsed:function(e){return!!this.collapsedSections[e]},isGlobalProdFunction:function(t){return e.contains((this.get("settings")||{}).globalProdFunctions,t)},isCommonProdFunction:function(t){return e.contains((this.get("settings")||{}).commonProdFunctions,t)},reload:function(){this.fetch()},act:function(e,n){return t.ajax({method:"POST",url:"/mor",data:JSON.stringify({instanceId:window.INSTANCE_ID,action:e,params:n})})},addSection:function(t,n){var i=this,r=i.getSection(t._id);return r?u():(r=e.assign({},t,{watch:[],commonProdFunctions:[],mrps:[]}),i.attributes.sections.push(r),i.trigger("update"),!1===n?u():i.act("addSection",t).fail(function(){i.attributes.sections=e.without(i.attributes.sections,r),i.trigger("update")}))},removeSection:function(t,n){var i=this,r=i.getSection(t.section);if(!r)return u();var o=[].concat(i.attributes.sections);return i.attributes.sections=e.without(o,r),i.trigger("update"),!1===n?u():i.act("removeSection",t).done(function(){delete i.collapsedSections[r.id]}).fail(function(){i.attributes.sections=o,i.trigger("update")})},editSection:function(t,n){var i=this,r=i.getSection(t._id);if(!r)return c();var o=e.clone(r);return e.assign(r,t),i.trigger("update"),!1===n?u():i.act("editSection",t).fail(function(){e.assign(r,o),i.trigger("update")})},moveSection:function(e,t){var n=this,i=n.getSection(e.source),r=n.getSection(e.target);if(i===r)return u();if(!i||!r)return c();var o=n.get("sections"),a=[].concat(o);return o.splice(o.indexOf(i),1),o.splice(o.indexOf(r)+("after"===e.position?1:0),0,i),n.trigger("update"),!1===t?u():n.act("moveSection",e).fail(function(){n.attributes.sections=a,n.trigger("update")})},addWatch:function(t,n){var i=this,r=i.getWatch(t.section,t.user);if(r)return u();var o=i.getSection(t.section);return o?(r=e.pick(t,["user","days","from","to"]),o.watch.push(r),i.trigger("update"),!1===n?u():i.act("addWatch",t).fail(function(){o.watch=e.without(o.watch,r),i.trigger("update")})):c()},removeWatch:function(t,n){var i=this,r=i.getWatch(t.section,t.user);if(!r)return u();var o=i.getSection(t.section);return o.watch=e.without(o.watch,r),i.trigger("update"),!1===n?u():i.act("removeWatch",t).fail(function(){o.watch.push(r),i.trigger("update")})},editWatch:function(t,n){var i=this,r=i.getWatch(t.section,t.user);if(!r)return c();var o=e.clone(r);return e.assign(r,e.pick(t,["user","days","from","to"])),i.trigger("update"),!1===n?u():i.act("editWatch",t).fail(function(){e.assign(r,o),i.trigger("update")})},addMrp:function(t,n){var i=this,r=i.getSection(t.section);if(!r)return c();var o=e.findWhere(r.mrps,{_id:t.mrp});return o?c():(o={_id:t.mrp,description:"",iptCheck:!1,iptCheckRecipients:[],prodFunctions:[]},e.assign(o,e.pick(t,["description","iptCheck"]),{iptCheckRecipients:e.pluck(t.iptCheckRecipients,"_id")}),i.users.add(t.iptCheckRecipients),r.mrps.push(o),i.trigger("update"),!1===n?u():i.act("addMrp",e.assign({},t,{iptCheckRecipients:e.pluck(t.iptCheckRecipients,"_id")})).fail(function(){r.mrps=e.without(r.mrps,o),i.trigger("update")}))},removeMrp:function(t,n){var i=this,r=i.getSection(t.section);if(!r)return u();var o=e.findWhere(r.mrps,{_id:t.mrp});return o?(r.mrps=e.without(r.mrps,o),i.trigger("update"),!1===n?u():i.act("removeMrp",t).fail(function(){r.mrps.push(o),i.trigger("update")})):u()},editMrp:function(t,n){var i=this,r=i.getSection(t.section);if(!r)return c();var o=e.findWhere(r.mrps,{_id:t.mrp});if(!o)return c();var a=e.clone(o);return e.assign(o,e.pick(t,["description","iptCheck"]),{iptCheckRecipients:e.pluck(t.iptCheckRecipients,"_id")}),i.users.add(t.iptCheckRecipients),i.trigger("update"),!1===n?u():i.act("editMrp",e.assign({},t,{iptCheckRecipients:e.pluck(t.iptCheckRecipients,"_id")})).fail(function(){e.assign(o,a),i.trigger("update")})},editProdFunction:function(t,n){var i,r=this;if(r.isGlobalProdFunction(t.prodFunction))t.section=null,t.mrp=null,i=this.get("globalProdFunctions");else if(r.isCommonProdFunction(t.prodFunction)){t.mrp=null;var o=this.getSection(t.section);if(!o)return c();i=o.commonProdFunctions}else{var a=r.getMrp(t.section,t.mrp);if(!a)return c();i=a.prodFunctions}var s=e.findWhere(i,{_id:t.prodFunction});s||(s={_id:t.prodFunction,users:[]},i.push(s));var l=[].concat(s.users);return s.users=t.users.map(function(e){return e._id}),r.users.add(t.users),r.trigger("update"),!1===n?u():r.act("editProdFunction",e.assign({},t,{users:s.users})).fail(function(){s.users=l,r.trigger("update")})},onMorUpdated:function(e){this[e.action]&&e.instanceId!==window.INSTANCE_ID&&this[e.action](e.params,!1)},onUserEdited:function(e){var t=this.users.get(e.model._id);t&&(t.set(e.model),this.trigger("update")),"manager"===e.model.prodFunction&&this.reload()},onUserDeleted:function(e){var t=this.users.get(e.model._id);t&&(this.users.remove(t),this.trigger("update")),"manager"===e.model.prodFunction&&this.reload()},onPresenceUpdated:function(t){var n=this.users,i={};e.forEach(t,function(e,t){var r=n.get(t);r&&(r.attributes.presence=e,i[t]=e)}),this.trigger("update:presence",i)},onSettingUpdated:function(e){this.attributes.settings[e._id.replace("mor.","")]=e.value,this.trigger("update")}})}),function(e){"use strict";"function"==typeof define&&define.amd?define("Sortable",e):"undefined"!=typeof module&&void 0!==module.exports?module.exports=e():window.Sortable=e()}(function(){"use strict";var e,t,n,i,r,o,a,s,u,c,l="Sortable"+(new Date).getTime(),d=window,p=d.document,f=d.parseInt,h=!!p.createElement("div").dragDrop,m=!1,g=function(e,t){var n=p.createEvent("Event");return n.initEvent(e,!0,!0),n.item=t,n},v=function(e,t,n){e.dispatchEvent(g(t,n||e))},y="onAdd onUpdate onRemove onStart onEnd onFilter".split(" "),_=function(){},b=[].slice,w=[];function A(e,t){this.el=e,this.options=t=t||{};var n={group:Math.random(),store:null,handle:null,draggable:e.children[0]&&e.children[0].nodeName||(/[uo]l/i.test(e.nodeName)?"li":"*"),ghostClass:"sortable-ghost",ignore:"a, img",filter:null};for(var i in n)t[i]=t[i]||n[i];for(var r in y.forEach(function(n){t[n]=k(this,t[n]||_),S(e,n.substr(2).toLowerCase(),t[n])}),e[l]=t.group,this)"_"===r.charAt(0)&&(this[r]=k(this,this[r]));S(e,"mousedown",this._onTapStart),S(e,"touchstart",this._onTapStart),h&&S(e,"selectstart",this._onTapStart),S(e,"dragover",this._onDragOver),S(e,"dragenter",this._onDragOver),w.push(this._onDragOver),t.store&&this.sort(t.store.get(this))}function k(e,t){var n=b.call(arguments,2);return t.bind?t.bind.apply(t,[e].concat(n)):function(){return t.apply(e,n.concat(b.call(arguments)))}}function E(e,t,n){if("*"===t)return e;if(e){n=n||p;var i=(t=t.split(".")).shift().toUpperCase(),r=new RegExp("\\s("+t.join("|")+")\\s","g");do{if(!(""!==i&&e.nodeName!=i||t.length&&((" "+e.className+" ").match(r)||[]).length!=t.length))return e}while(e!==n&&(e=e.parentNode))}return null}function T(e){e.dataTransfer.dropEffect="move",e.preventDefault()}function S(e,t,n){e.addEventListener(t,n,!1)}function C(e,t,n){e.removeEventListener(t,n,!1)}function R(e,t,n){if(e)if(e.classList)e.classList[n?"add":"remove"](t);else{var i=(" "+e.className+" ").replace(/\s+/g," ").replace(" "+t+" ","");e.className=i+(n?" "+t:"")}}function P(e,t,n){if(e&&e.style){if(void 0===n)return p.defaultView&&p.defaultView.getComputedStyle?n=p.defaultView.getComputedStyle(e,""):e.currentStyle&&(n=e.currentStyle),void 0===t?n:n[t];e.style[t]=n+("string"==typeof n?"":"px")}}function N(e,t,n){if(e){var i=e.getElementsByTagName(t),r=0,o=i.length;if(n)for(;r<o;r++)n(i[r],r);return i}return[]}function O(e){return e.draggable=!1}function D(){m=!1}function I(e){for(var t=e.tagName+e.className+e.src+e.href+e.textContent,n=t.length,i=0;n--;)i+=t.charCodeAt(n);return i.toString(36)}return A.prototype={constructor:A,_applyEffects:function(){R(e,this.options.ghostClass,!0)},_onTapStart:function(t){var r=t.touches&&t.touches[0],o=(r||t).target,a=this.options,c=this.el,l=a.filter;if("function"==typeof l&&l.call(this,o,this))v(c,"filter",o);else if(l&&(l=l.split(",").filter(function(e){return E(o,e.trim(),c)})).length)v(c,"filter",o);else if(a.handle&&(o=E(o,a.handle,c)),(o=E(o,a.draggable,c))&&"selectstart"==t.type&&"A"!=o.tagName&&"IMG"!=o.tagName&&o.dragDrop(),o&&!e&&o.parentNode===c){u=t,n=this.el,i=(e=o).nextSibling,s=this.options.group,e.draggable=!0,a.ignore.split(",").forEach(function(e){N(o,e.trim(),O)}),r&&(u={target:o,clientX:r.clientX,clientY:r.clientY},this._onDragStart(u,!0),t.preventDefault()),S(p,"mouseup",this._onDrop),S(p,"touchend",this._onDrop),S(p,"touchcancel",this._onDrop),S(this.el,"dragstart",this._onDragStart),S(this.el,"dragend",this._onDrop),S(p,"dragover",T);try{p.selection?p.selection.empty():window.getSelection().removeAllRanges()}catch(e){}v(e,"start")}},_emulateDragOver:function(){if(c){P(t,"display","none");var e=p.elementFromPoint(c.clientX,c.clientY),n=e,i=this.options.group,r=w.length;if(n)do{if(n[l]===i){for(;r--;)w[r]({clientX:c.clientX,clientY:c.clientY,target:e,rootEl:n});break}e=n}while(n=n.parentNode);P(t,"display","")}},_onTouchMove:function(e){if(u){var n=e.touches[0],i="translate3d("+(n.clientX-u.clientX)+"px,"+(n.clientY-u.clientY)+"px,0)";c=n,P(t,"webkitTransform",i),P(t,"mozTransform",i),P(t,"msTransform",i),P(t,"transform",i),e.preventDefault()}},_onDragStart:function(i,r){var o=i.dataTransfer;if(this._offUpEvents(),r){var a,s=e.getBoundingClientRect(),u=P(e);P(t=e.cloneNode(!0),"top",s.top-f(u.marginTop,10)),P(t,"left",s.left-f(u.marginLeft,10)),P(t,"width",s.width),P(t,"height",s.height),P(t,"opacity","0.8"),P(t,"position","fixed"),P(t,"zIndex","100000"),n.appendChild(t),a=t.getBoundingClientRect(),P(t,"width",2*s.width-a.width),P(t,"height",2*s.height-a.height),S(p,"touchmove",this._onTouchMove),S(p,"touchend",this._onDrop),S(p,"touchcancel",this._onDrop),this._loopId=setInterval(this._emulateDragOver,150)}else o.effectAllowed="move",o.setData("Text",e.textContent),S(p,"drop",this._onDrop);setTimeout(this._applyEffects)},_onDragOver:function(n){if(!m&&s===this.options.group&&(void 0===n.rootEl||n.rootEl===this.el)){var i=this.el,u=E(n.target,this.options.draggable,i);if(0===i.children.length||i.children[0]===t||i===n.target&&function(e,t){var n=e.lastElementChild.getBoundingClientRect();return t.clientY-(n.top+n.height)>5}(i,n))i.appendChild(e);else if(u&&u!==e&&void 0!==u.parentNode[l]){r!==u&&(r=u,o=P(u),a=u.getBoundingClientRect());var c,d=a,p=d.right-d.left,f=d.bottom-d.top,h=/left|right|inline/.test(o.cssFloat+o.display),g=u.offsetWidth>e.offsetWidth,v=u.offsetHeight>e.offsetHeight,y=(h?(n.clientX-d.left)/p:(n.clientY-d.top)/f)>.5,_=u.nextElementSibling;m=!0,setTimeout(D,30),(c=h?u.previousElementSibling===e&&!g||y&&g:_!==e&&!v||y&&v)&&!_?i.appendChild(e):u.parentNode.insertBefore(e,c?_:u)}}},_offUpEvents:function(){C(p,"mouseup",this._onDrop),C(p,"touchmove",this._onTouchMove),C(p,"touchend",this._onDrop),C(p,"touchcancel",this._onDrop)},_onDrop:function(a){clearInterval(this._loopId),C(p,"drop",this._onDrop),C(p,"dragover",T),C(this.el,"dragend",this._onDrop),C(this.el,"dragstart",this._onDragStart),C(this.el,"selectstart",this._onTapStart),this._offUpEvents(),a&&(a.preventDefault(),a.stopPropagation(),t&&t.parentNode.removeChild(t),e&&(O(e),R(e,this.options.ghostClass,!1),n.contains(e)?e.nextSibling!==i&&v(e,"update"):(v(n,"remove",e),v(e,"add")),v(e,"end")),n=e=t=i=u=c=r=o=s=null,this.options.store&&this.options.store.set(this))},toArray:function(){for(var e,t=[],n=this.el.children,i=0,r=n.length;i<r;i++)e=n[i],t.push(e.getAttribute("data-id")||I(e));return t},sort:function(e){var t={},n=this.el;this.toArray().forEach(function(e,i){t[e]=n.children[i]}),e.forEach(function(e){t[e]&&(n.removeChild(t[e]),n.appendChild(t[e]))})},closest:function(e,t){return E(e,t||this.options.draggable,this.el)},destroy:function(){var e=this.el,t=this.options;this.el&&(y.forEach(function(n){C(e,n.substr(2).toLowerCase(),t[n])}),C(e,"mousedown",this._onTapStart),C(e,"touchstart",this._onTapStart),C(e,"selectstart",this._onTapStart),C(e,"dragover",this._onDragOver),C(e,"dragenter",this._onDragOver),Array.prototype.forEach.call(e.querySelectorAll("[draggable]"),function(e){e.removeAttribute("draggable")}),w.splice(w.indexOf(this._onDragOver),1),this._onDrop(),this.el=null)}},A.utils={on:S,off:C,css:P,find:N,bind:k,closest:E,toggleClass:R,createEvent:g,dispatchEvent:v},A.version="0.5.0",A}),define("app/core/util/idAndLabel",["underscore"],function(e){"use strict";return function(t,n){var i={id:t.id,text:t.getLabel()};return n&&e.assign(i,n),i}}),define("app/core/util/uuid",[],function(){"use strict";for(var e=[],t=0;t<256;++t)e[t]=(t<16?"0":"")+t.toString(16).toUpperCase();return function(){var t=4294967295*Math.random()|0,n=4294967295*Math.random()|0,i=4294967295*Math.random()|0,r=4294967295*Math.random()|0;return e[255&t]+e[t>>8&255]+e[t>>16&255]+e[t>>24&255]+"-"+e[255&n]+e[n>>8&255]+"-"+e[n>>16&15|64]+e[n>>24&255]+"-"+e[63&i|128]+e[i>>8&255]+"-"+e[i>>16&255]+e[i>>24&255]+e[255&r]+e[r>>8&255]+e[r>>16&255]+e[r>>24&255]}}),define("app/mor/templates/sectionForm",["underscore","jquery","app/i18n","app/time","app/user","app/core/util/forms"],function(_,$,t,time,user,forms){return function anonymous(locals,escapeFn,include,rethrow){escapeFn=escapeFn||function(e){return void 0==e?"":String(e).replace(_MATCH_HTML,encode_char)};var _ENCODE_HTML_RULES={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&#34;","'":"&#39;"},_MATCH_HTML=/[&<>'"]/g;function encode_char(e){return _ENCODE_HTML_RULES[e]||e}var __output="";function __append(e){void 0!==e&&null!==e&&(__output+=e)}with(locals||{})__append('<form class="action-form">\n  <div class="form-group">\n    <label for="'),__append(idPrefix),__append('-name" class="control-label">'),__append(t("mor","sectionForm:name")),__append('</label>\n    <input id="'),__append(idPrefix),__append('-name" class="form-control" value="'),__append(section?section.name:""),__append('" type="text" autocomplete="new-password" required>\n  </div>\n  <div class="checkbox">\n    <label>\n      <input id="'),__append(idPrefix),__append('-watchEnabled" value="1" type="checkbox" '),__append(section&&section.watchEnabled?"checked":""),__append(">\n      "),__append(t("mor","sectionForm:watchEnabled")),__append('\n    </label>\n  </div>\n  <div class="checkbox">\n    <label>\n      <input id="'),__append(idPrefix),__append('-mrpsEnabled" value="1" type="checkbox" '),__append(section&&section.mrpsEnabled?"checked":""),__append(">\n      "),__append(t("mor","sectionForm:mrpsEnabled")),__append('\n    </label>\n  </div>\n  <div class="form-group">\n    <label for="'),__append(idPrefix),__append('-subdivisions">'),__append(t("mor","sectionForm:subdivisions")),__append('</label>\n    <input id="'),__append(idPrefix),__append('-subdivisions" type="text" autocomplete="new-password" value="'),__append(section?section.subdivisions.join(","):""),__append('">\n  </div>\n  <div class="form-group">\n    <label for="'),__append(idPrefix),__append('-prodFunctions">'),__append(t("mor","sectionForm:prodFunctions")),__append('</label>\n    <input id="'),__append(idPrefix),__append('-prodFunctions" type="text" autocomplete="new-password" value="'),__append(section?section.prodFunctions.join(","):""),__append('">\n  </div>\n  <div class="form-actions">\n    <button type="submit" class="btn btn-primary">'),__append(t("mor","sectionForm:submit:"+nlsSuffix)),__append('</button>\n    <button type="button" class="cancel btn btn-link">'),__append(t("mor","sectionForm:cancel")),__append("</button>\n  </div>\n</form>\n");return __output}}),define("app/mor/views/SectionFormView",["underscore","Sortable","app/i18n","app/viewport","app/core/View","app/core/util/idAndLabel","app/core/util/uuid","app/data/orgUnits","app/data/prodFunctions","app/mor/templates/sectionForm"],function(e,t,n,i,r,o,a,s,u,c){"use strict";return r.extend({template:c,events:{submit:function(){var e=this,t=e.$id("submit").prop("disabled",!0),r={_id:this.model.section?this.model.section._id:a(),name:e.$id("name").val().trim(),watchEnabled:e.$id("watchEnabled").prop("checked"),mrpsEnabled:e.$id("mrpsEnabled").prop("checked"),subdivisions:e.$id("subdivisions").val().split(",").filter(function(e){return""!==e}),prodFunctions:e.$id("prodFunctions").val().split(",").filter(function(e){return""!==e})};return e.model.mor[e.model.section?"editSection":"addSection"](r).fail(function(){i.msg.show({type:"error",time:3e3,text:n("mor","sectionForm:failure:"+e.model.nlsSuffix)}),t.prop("disabled",!1)}).done(function(){e.closeDialog()}),!1}},initialize:function(){this.sortable=null},destroy:function(){this.sortable.destroy(),this.sortable=null},serialize:function(){return{idPrefix:this.idPrefix,nlsSuffix:this.model.nlsSuffix,section:this.model.section}},afterRender:function(){this.$id("subdivisions").select2({allowClear:!0,multiple:!0,data:s.getAllByType("division").map(function(e){var t=e.getLabel();return{text:t,children:s.getChildren(e).map(function(e){return{id:e.id,text:e.getLabel(),divisionText:t}})}}),formatSelection:function(e,t,n){return n(e.divisionText+" \\ "+e.text)}});var e=this.$id("prodFunctions").select2({allowClear:!0,multiple:!0,data:u.map(o)});this.sortable=new t(e.select2("container").find(".select2-choices")[0],{draggable:".select2-search-choice",filter:".select2-search-choice-close",onStart:function(){e.select2("onSortStart")},onEnd:function(){e.select2("onSortEnd").select2("focus")}})},onDialogShown:function(){this.closeDialog=i.closeDialog.bind(i),this.$id("name").focus()},closeDialog:function(){}})}),define("app/mor/templates/watchForm",["underscore","jquery","app/i18n","app/time","app/user","app/core/util/forms"],function(_,$,t,time,user,forms){return function anonymous(locals,escapeFn,include,rethrow){escapeFn=escapeFn||function(e){return void 0==e?"":String(e).replace(_MATCH_HTML,encode_char)};var _ENCODE_HTML_RULES={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&#34;","'":"&#39;"},_MATCH_HTML=/[&<>'"]/g;function encode_char(e){return _ENCODE_HTML_RULES[e]||e}var __output="";function __append(e){void 0!==e&&null!==e&&(__output+=e)}with(locals||{})__append('<form class="action-form">\n  <div class="form-group">\n    <label class="control-label">'),__append(t("mor","watchForm:section")),__append('</label>\n    <p class="form-control-static">'),__append(escapeFn(section)),__append('</p>\n  </div>\n  <div class="form-group has-required-select2">\n    <label for="'),__append(idPrefix),__append('-user" class="control-label">'),__append(t("mor","watchForm:user")),__append('</label>\n    <input id="'),__append(idPrefix),__append('-user" type="text" autocomplete="new-password" required value="'),__append(watch?watch.user:""),__append('">\n  </div>\n  <div class="form-group">\n    <label class="control-label">'),__append(t("mor","watchForm:days")),__append("</label>\n    <br>\n    "),[1,2,3,4,5,6,7].forEach(function(e){__append('\n    <label class="checkbox-inline">\n      <input type="checkbox" name="days" value="'),__append(e),__append('" '),__append(watch&&-1!==watch.days.indexOf(e)?"checked":""),__append(">"),__append(time.getMoment().startOf("week").day(e).format("ddd")),__append("\n    </label>\n    ")}),__append('\n  </div>\n  <div class="form-group">\n    <label for="'),__append(idPrefix),__append('-from" class="control-label">'),__append(t("mor","watchForm:from")),__append('</label>\n    <input id="'),__append(idPrefix),__append('-from" class="form-control mor-watch-time" value="'),__append(watch?watch.from:"06:00"),__append('" type="text" autocomplete="new-password" required placeholder="00:00" pattern="^[0-9]{2}:[0-9]{2}$">\n  </div>\n  <div class="form-group">\n    <label for="'),__append(idPrefix),__append('-to" class="control-label">'),__append(t("mor","watchForm:to")),__append('</label>\n    <input id="'),__append(idPrefix),__append('-to" class="form-control mor-watch-time" value="'),__append(watch?watch.to:"06:00"),__append('" type="text" autocomplete="new-password" required placeholder="00:00" pattern="^[0-9]{2}:[0-9]{2}$">\n  </div>\n  <div class="form-actions">\n    <button type="submit" class="btn btn-primary">'),__append(t("mor","watchForm:submit:"+mode)),__append('</button>\n    <button type="button" class="cancel btn btn-link">'),__append(t("mor","watchForm:cancel")),__append("</button>\n  </div>\n</form>\n");return __output}}),define("app/mor/views/WatchFormView",["underscore","app/i18n","app/viewport","app/core/View","app/core/util/idAndLabel","app/mor/templates/watchForm"],function(e,t,n,i,r,o){"use strict";return i.extend({template:o,events:{submit:function(){var e=this,i=e.$id("submit").prop("disabled",!0),r={section:e.model.section._id,user:e.model.watch?e.model.watch.user:e.$id("user").val(),days:e.$('input[name="days"]:checked').map(function(){return+this.value}).get(),from:e.$id("from").val(),to:e.$id("to").val()};return e.model.mor[e.model.watch?"editWatch":"addWatch"](r).fail(function(){n.msg.show({type:"error",time:3e3,text:t("mor","watchForm:failure:"+e.model.mode)}),i.prop("disabled",!1)}).done(function(){e.closeDialog()}),!1}},serialize:function(){return{idPrefix:this.idPrefix,mode:this.model.mode,section:this.model.section.name,watch:this.model.watch}},afterRender:function(){var t=e.pluck(this.model.mor.get("watch"),"user");this.$id("user").select2({data:this.model.mor.users.filter(function(n){return!e.contains(t,n.id)}).map(r)}),"edit"===this.model.mode&&this.$id("user").select2("disable",!0).select2("data",{id:this.model.watch.user,text:this.model.mor.users.get(this.model.watch.user).getLabel()})},onDialogShown:function(){this.closeDialog=n.closeDialog.bind(n),this.$id("edit"===this.model.mode?"from":"user").focus()},closeDialog:function(){}})}),define("app/core/util/formatResultWithDescription",["underscore"],function(e){"use strict";return function(t,n,i){if(e.isEmpty(i[n]))return e.escape(i[t]);var r='<div class="select2-result-with-description">';return r+="<h3>"+e.escape(i[t])+"</h3>",r+="<p>"+e.escape(i[n])+"</p>",r+="</div>"}}),define("app/core/util/transliterate",[],function(){"use strict";var e={"Ę":"E","ę":"e","Ó":"O","ó":"o","Ą":"A","ą":"a","Ś":"S","ś":"s","Ł":"L","ł":"l","Ż":"Z","ż":"z","Ź":"Z","ź":"z","Ć":"C","ć":"c","Ń":"N","ń":"n"},t=new RegExp(Object.keys(e).join("|"),"g");return function(n){return String(n).replace(t,function(t){return e[t]})}}),define("app/users/util/setUpUserSelect2",["require","underscore","h5.rql/index","app/core/util/transliterate","app/i18n","app/user","app/data/companies","app/data/loadedModules"],function(e,t,n,i,r,o,a,s){"use strict";function u(e){if(t.isEmpty(e.description))return e.header;var n='<div class="select2-result-with-description">';return n+="<h3>"+e.header+"</h3>",n+="<p>"+e.description+"</p>",n+="</div>"}function c(n,i,r){if(n.id&&n.text)return n;n.name=n.lastName||n.firstName?(n.lastName+" "+n.firstName).trim():n.name||n.login||n._id;var o=i?i(n,n.name,r):n.name,u=t.escape(o),c="";if(n.duplicate){n.personnelId&&(u+=" ("+t.escape(n.personnelId)+")"),n.syncData.jobTitle&&(c=t.escape(n.syncData.jobTitle));var l=a.get(n.company);l?l=l.get("shortName"):n.syncData.company&&(l=n.syncData.company),l&&(c&&(c+=" @ "),c+=t.escape(l));var d="",p="";if(s.isLoaded("wmes-osh")&&n.oshWorkplace){var f=e("app/wmes-osh-common/dictionaries"),h=f.workplaces.get(n.oshWorkplace),m=f.departments.get(n.oshDepartment);h&&(d=h.getLabel({long:!1}),m&&(p=m.getLabel({long:!1})))}!d&&n.syncData.workplace&&(d=n.syncData.workplace),!p&&n.syncData.department&&(p=n.syncData.department),d&&(c&&(c+="<br>"),c+=t.escape(d)),p&&(d?c+=" \\ ":c&&(c+="<br>"),c+=t.escape(p))}return n.active||(u="<del>"+u+"</del>"),{id:n._id,text:o,header:u,description:c,user:n}}function l(){return{id:"$SYSTEM",text:r("users","select2:users:system"),user:null}}function d(){var e=o.getRootUserData();return{id:e._id,text:e.name||e.login,user:e}}function p(e){var n={};e.forEach(function(e){n[e.searchName]||(n[e.searchName]=[]);var t=0;e.active||(t-=10),e.email&&(t+=1),e.mobile&&e.mobile.length&&(t+=1),e.privileges&&e.privileges.length&&(t+=1),e.personnelId&&(t+=1),e.syncData&&/PHILIPS|SIGNIFY/i.test(e.syncData.company)&&(t+=1),e.orgUnitId&&(t+=1),e.oshDepartment&&(t+=1),e.duplicate=!1,e.score=t,n[e.searchName].push(e)});var i=[];return t.values(n).forEach(function(e){e.forEach(function(t){t.duplicate=e.length>1,i.push(t)})}),i}function f(e,t,n){t=t.trim();var i=/^[0-9]+$/.test(t)?"personnelId":"searchName";"searchName"===i&&(t=g.transliterate(t));var r={fields:{},sort:{},limit:20,skip:0,selector:{name:"and",args:[{name:"regex",args:[i,"^"+t]}]}};return n.activeOnly&&r.selector.args.push({name:"eq",args:["active",!0]}),r.sort[i]=1,n.rqlQueryDecorator&&n.rqlQueryDecorator(r,t,n),e.Query.fromObject(r)}function h(e){return e.textFormatter||function(e,t,n,i){return!e&&t.personnelId&&(n+=" ("+t.personnelId+")"),n}.bind(null,!1!==e.noPersonnelId)}function m(e,t){var n=(e.user&&e.user.searchName||e.text).localeCompare(t.user&&t.user.searchName||t.text,void 0,{ignorePunctuation:!0,sensitivity:"base"});return 0===n&&(n=(t.user&&t.user.score||0)-(e.user&&e.user.score||0)),n}function g(e,i){if(!e.length)return e;i||(i={});var a=h(i),s={openOnEnter:null,allowClear:!0,minimumInputLength:3,placeholder:r("users","select2:placeholder"),formatResult:u};if(i.collection)i.minimumInputLength=0,i.placeholder=" ",i.data=function(e){var t=h(e),n=[];return(e.currentUserInfo||[]).forEach(function(t){e.collection.get(t[o.idProperty])||n.push({id:t[o.idProperty],text:t.label,user:t})}),e.collection.forEach(function(e){n.push(c(e.toJSON(),t))}),n.sort(m),n}(i);else{var v=i.rqlQueryProvider?i.rqlQueryProvider:f,y=i.userFilter?i.userFilter:null;s.ajax={cache:!0,quietMillis:300,url:function(e){return"/users?"+v(n,e,i)},results:function(e,t,n){var i=[l(),d()].filter(function(e){return-1!==e.text.toLowerCase().indexOf(n.term.toLowerCase())}).concat(p(e.collection||[]));return y&&(i=i.filter(y)),{results:i.map(function(e){return c(e,a,n)}).sort(m)}}}}if(e.select2(t.assign(s,i)),i.collection){var _=e.data("select2"),b=_.destroy;_.destroy=function(){i.collection.off(null,null,e),b.apply(_,arguments)},i.collection.once("reset add change remove",function(){g(e,i)})}var w=e.val(),A=d(),k=i.currentUserInfo;if(k)Array.isArray(k)?e.select2("data",k.map(function(e){return{id:e.id,text:e.label,user:e}})):e.select2("data",{id:k.id,text:k.label,user:k});else if(w===A.id)e.select2("data",A);else if("$SYSTEM"===w)e.select2("data",l());else if(w&&i.view){i.view.ajax({type:"GET",url:"/users?_id=in=("+w+")"}).done(function(t){if(t.collection&&t.collection.length){var n=t.collection.map(function(e){return c(e,a)});e.select2("data",i.multiple?n:n[0]),i.onDataLoaded&&i.onDataLoaded()}})}return e}return g.userToData=c,g.defaultRqlQueryProvider=f,g.filterDuplicates=p,g.transliterate=function(e){return i(e.toUpperCase()).replace(/[^A-Z0-9]+/g,"")},g.getUserInfo=function(e){var t=e.select2("data"),n=e.data("select2"),i=o.getInfo.decorators.concat(n&&n.opts.userInfoDecorators||[]);if(Array.isArray(t))return t.map(function(e){var t={},n=e.user||{};return t[o.idProperty]=e.id,t.label=e.text,i.forEach(function(e){e(t,n)}),t});if(t){var r={},a=t.user||{};return r[o.idProperty]=t.id,r.label=t.text,i.forEach(function(e){e(r,a)}),r}return null},g}),define("app/mor/templates/mrpForm",["underscore","jquery","app/i18n","app/time","app/user","app/core/util/forms"],function(_,$,t,time,user,forms){return function anonymous(locals,escapeFn,include,rethrow){escapeFn=escapeFn||function(e){return void 0==e?"":String(e).replace(_MATCH_HTML,encode_char)};var _ENCODE_HTML_RULES={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&#34;","'":"&#39;"},_MATCH_HTML=/[&<>'"]/g;function encode_char(e){return _ENCODE_HTML_RULES[e]||e}var __output="";function __append(e){void 0!==e&&null!==e&&(__output+=e)}with(locals||{})__append('<form class="action-form">\n  <div class="form-group">\n    <label class="control-label">'),__append(t("mor","mrpForm:section")),__append('</label>\n    <p class="form-control-static">'),__append(escapeFn(section)),__append('</p>\n  </div>\n  <div class="form-group">\n    <label for="'),__append(idPrefix),__append('-mrp" class="control-label">'),__append(t("mor","mrpForm:mrp")),__append('</label>\n    <input id="'),__append(idPrefix),__append('-mrp" class="form-control" type="text" autocomplete="new-password" required value="'),__append(escapeFn(mrp?mrp._id:"")),__append('">\n  </div>\n  <div class="form-group">\n    <label for="'),__append(idPrefix),__append('-description" class="control-label">'),__append(t("mor","mrpForm:description")),__append('</label>\n    <input id="'),__append(idPrefix),__append('-description" class="form-control" type="text" autocomplete="new-password" value="'),__append(escapeFn(mrp?mrp.description:"")),__append('">\n  </div>\n  <div class="form-group">\n    <label for="'),__append(idPrefix),__append('-iptCheckRecipients" class="control-label">'),__append(t("mor","mrpForm:iptCheckRecipients")),__append('</label>\n    <input id="'),__append(idPrefix),__append('-iptCheckRecipients" type="text" autocomplete="new-password" value="'),__append(mrp?mrp.iptCheckRecipients.join(","):""),__append('">\n  </div>\n  <div class="form-actions">\n    <button type="submit" class="btn btn-primary">'),__append(t("mor","mrpForm:submit:"+mode)),__append('</button>\n    <button type="button" class="cancel btn btn-link">'),__append(t("mor","mrpForm:cancel")),__append("</button>\n  </div>\n</form>\n");return __output}}),define("app/mor/views/MrpFormView",["app/i18n","app/viewport","app/core/View","app/core/util/formatResultWithDescription","app/data/orgUnits","app/users/util/setUpUserSelect2","app/mor/templates/mrpForm"],function(e,t,n,i,r,o,a){"use strict";return n.extend({template:a,events:{"change #-mrp":function(){var e=r.getByTypeAndId("mrpController",this.$id("mrp").val());e&&this.$id("description").val(e.get("description"))},submit:function(){var n=this,i=n.$id("submit").prop("disabled",!0),r={section:n.model.section._id,mrp:n.model.mrp?n.model.mrp._id:n.$id("mrp").val(),iptCheck:!!n.$id("iptCheck").prop("checked"),iptCheckRecipients:(n.$id("iptCheckRecipients").select2("data")||[]).map(function(e){return e.user}),description:n.$id("description").val()};return n.model.mor[n.model.mrp?"editMrp":"addMrp"](r).fail(function(){t.msg.show({type:"error",time:3e3,text:e("mor","mrpForm:failure:"+n.model.mode)}),i.prop("disabled",!1)}).done(function(){n.closeDialog()}),!1}},serialize:function(){return{idPrefix:this.idPrefix,mode:this.model.mode,section:this.model.section.name,mrp:this.model.mrp}},afterRender:function(){"edit"===this.model.mode&&this.$id("mrp").prop("disabled",!0),o(this.$id("iptCheckRecipients"),{view:this,multiple:!0})},onDialogShown:function(){this.closeDialog=t.closeDialog.bind(t),this.$id("edit"===this.model.mode?"description":"mrp").focus()},closeDialog:function(){}})}),define("app/mor/templates/editProdFunctionForm",["underscore","jquery","app/i18n","app/time","app/user","app/core/util/forms"],function(_,$,t,time,user,forms){return function anonymous(locals,escapeFn,include,rethrow){escapeFn=escapeFn||function(e){return void 0==e?"":String(e).replace(_MATCH_HTML,encode_char)};var _ENCODE_HTML_RULES={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&#34;","'":"&#39;"},_MATCH_HTML=/[&<>'"]/g;function encode_char(e){return _ENCODE_HTML_RULES[e]||e}var __output="";function __append(e){void 0!==e&&null!==e&&(__output+=e)}with(locals||{})__append('<form class="action-form">\n  <div class="form-group">\n    <label class="control-label">'),__append(t("mor","editProdFunction:section")),__append('</label>\n    <p class="form-control-static">'),__append(escapeFn(section)),__append('</p>\n  </div>\n  <div class="form-group">\n    <label class="control-label">'),__append(t("mor","editProdFunction:mrp")),__append('</label>\n    <p class="form-control-static">'),__append(escapeFn(mrp)),__append('</p>\n  </div>\n  <div class="form-group">\n    <label class="control-label">'),__append(t("mor","editProdFunction:prodFunction")),__append('</label>\n    <p class="form-control-static">'),__append(escapeFn(prodFunction)),__append('</p>\n  </div>\n  <div class="form-group">\n    <label for="'),__append(idPrefix),__append('-users" class="control-label">'),__append(t("mor","editProdFunction:users")),__append('</label>\n    <input id="'),__append(idPrefix),__append('-users" type="text" autocomplete="new-password">\n  </div>\n  <div class="form-actions">\n    <button type="submit" class="btn btn-primary">'),__append(t("mor","editProdFunction:submit")),__append('</button>\n    <button type="button" class="cancel btn btn-link">'),__append(t("mor","editProdFunction:cancel")),__append("</button>\n  </div>\n</form>\n");return __output}}),define("app/mor/views/EditProdFunctionFormView",["underscore","jquery","Sortable","app/i18n","app/viewport","app/core/View","app/core/util/idAndLabel","app/data/orgUnits","app/data/prodFunctions","app/users/User","app/mor/templates/editProdFunctionForm"],function(e,t,n,i,r,o,a,s,u,c,l){"use strict";return o.extend({template:l,events:{submit:function(){var e=this,t=e.$id("submit").prop("disabled",!0),n={section:e.model.section._id,mrp:e.model.mrp._id,prodFunction:e.model.prodFunction.id,users:e.$id("users").val().split(",").map(function(t){return e.users[t]}).filter(function(e){return!!e})};return e.model.mor.editProdFunction(n).fail(function(){r.msg.show({type:"error",time:3e3,text:i("mor","editProdFunction:failure")}),t.prop("disabled",!1)}).done(function(){e.closeDialog()}),!1}},initialize:function(){this.users={}},destroy:function(){this.sortable.destroy(),this.sortable=null},serialize:function(){var e=this.model,t=e.prodFunction,n=e.mor.isGlobalProdFunction(t.id),r=e.mor.isCommonProdFunction(t.id);return{idPrefix:this.idPrefix,section:n?i("mor","editProdFunction:section:all"):e.section.name,mrp:n||r?i("mor","editProdFunction:mrp:all"):e.mrp._id,prodFunction:t.getLabel()}},afterRender:function(){var t=this,n=t.model,i=n.mor,r=i.getUsers(n.section._id,n.mrp._id,n.prodFunction.id).map(function(e){return i.users.get(e)}).filter(function(e){return!!e}),o=r.map(function(e){return e.id}),s=r.map(a),u=t.$id("users");r.forEach(function(e){t.users[e.id]=e.toJSON()}),u.val(o.join(",")),t.setUpUsersSelect2(s),t.ajax({url:"/users?exclude(privileges)&sort(searchName)&limit(999)&prodFunction="+n.prodFunction.id}).done(function(n){e.forEach(n.collection,function(n){t.users[n._id]=n,e.contains(o,n._id)||s.push(a(new c(n)))}),s.length>o.length&&t.setUpUsersSelect2(s)})},setUpUsersSelect2:function(e){this.sortable&&this.sortable.destroy();var t=this.$id("users").select2({allowClear:!0,multiple:!0,data:e});this.sortable=new n(t.select2("container").find(".select2-choices")[0],{draggable:".select2-search-choice",filter:".select2-search-choice-close",onStart:function(){t.select2("onSortStart")},onEnd:function(){t.select2("onSortEnd").select2("focus")}}),t.select2("focus")},onDialogShown:function(){this.closeDialog=r.closeDialog.bind(r),this.$id("users").select2("focus")},closeDialog:function(){}})}),define("app/mor/templates/mor",["underscore","jquery","app/i18n","app/time","app/user","app/core/util/forms"],function(_,$,t,time,user,forms){return function anonymous(locals,escapeFn,include,rethrow){escapeFn=escapeFn||function(e){return void 0==e?"":String(e).replace(_MATCH_HTML,encode_char)};var _ENCODE_HTML_RULES={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&#34;","'":"&#39;"},_MATCH_HTML=/[&<>'"]/g;function encode_char(e){return _ENCODE_HTML_RULES[e]||e}var __output="";function __append(e){void 0!==e&&null!==e&&(__output+=e)}with(locals||{})__append('<div class="mor">\n  '),sections.forEach(function(e){__append('\n  <div class="mor-section '),__append(e.collapsed?"is-collapsed":""),__append('" data-section-id="'),__append(e._id),__append('">\n    <h3>\n      <i class="fa fa-caret-right"></i><i class="fa fa-caret-down"></i><span class="mor-section-name" draggable="'),__append(draggable),__append('">'),__append(escapeFn(e.label)),__append('</span>\n      <div class="btn-group">\n        '),watchActionsVisible&&e.addWatchVisible&&(__append('\n        <button class="btn btn-default" data-action="addWatch" title="'),__append(t("mor","action:addWatch")),__append('"><i class="fa fa-plus"></i></button>\n        ')),__append("\n        "),sectionActionsVisible&&(__append('\n        <button class="btn btn-default" data-action="editSection" title="'),__append(t("mor","action:editSection")),__append('"><i class="fa fa-edit"></i></button>\n        <button class="btn btn-default" data-action="removeSection" title="'),__append(t("mor","action:removeSection")),__append('"><i class="fa fa-remove"></i></button>\n        ')),__append("\n      </div>\n    </h3>\n    "),e.watchVisible&&(__append('\n    <table class="mor-watch">\n      <tbody>\n      '),e.watch.forEach(function(t){__append('\n      <tr data-user-id="'),__append(t.user._id),__append('">\n        <td><i class="fa fa-user-circle-o mor-user-presence '),__append(t.user.presence?"mor-user-present":"mor-user-notPresent"),__append('" data-user-id="'),__append(t.user._id),__append('"></i><span>'),__append(t.user.label),__append('</span></td>\n        <td><i class="fa fa-wrench"></i><span>'),__append(t.user.prodFunction),__append("</span></td>\n        "),e.watchDaysVisible&&(__append('\n        <td><i class="fa fa-calendar"></i><span>'),__append(t.user.days),__append("</span></td>\n        ")),__append("\n        "),e.watchHoursVisible&&(__append('\n        <td><i class="fa fa-clock-o"></i><span>'),__append(t.user.hours||"06:00-06:00"),__append("</span></td>\n        ")),__append('\n        <td><i class="fa fa-phone"></i><span>'),__append(t.user.mobile),__append("</span></td>\n        <td>\n          "),linkEmails?(__append('\n          <a href="mailto:'),__append(escapeFn(t.user.email)),__append('"><i class="fa fa-envelope"></i><span>'),__append(escapeFn(t.user.email)),__append("</span></a>\n          ")):(__append('\n          <i class="fa fa-envelope"></i><span>'),__append(escapeFn(t.user.email)),__append("</span>\n          ")),__append("\n        </td>\n        "),watchActionsVisible&&__append('\n        <td class="actions">\n          <div class="btn-group">\n            <button class="btn btn-default" data-action="editWatch"><i class="fa fa-edit"></i></button>\n            <button class="btn btn-default" data-action="removeWatch"><i class="fa fa-remove"></i></button>\n          </div>\n        </td>\n        '),__append("\n      </tr>\n      ")}),__append("\n      </tbody>\n    </table>\n    ")),__append("\n    "),e.mrpsVisible&&(__append('\n    <table class="table table-bordered table-condensed table-hover mor-mrps">\n      <thead>\n      <tr>\n        '),e.mrpColumnVisible&&(__append('\n        <th class="is-min mor-is-editable">\n          MRP\n          '),mrpActionsVisible&&__append('\n          <div class="btn-group">\n            <button class="btn btn-default" data-action="addMrp"><i class="fa fa-plus"></i></button>\n          </div>\n          '),__append("\n        </th>\n        ")),__append("\n        "),e.prodFunctions.forEach(function(e){__append('\n        <th class="is-min">'),__append(escapeFn(e.label)),__append("</th>\n        ")}),__append("\n      </tr>\n      </thead>\n      <tbody>\n      "),e.mrps.forEach(function(t){__append('\n      <tr data-mrp-id="'),__append(t._id),__append('">\n        '),e.mrpColumnVisible&&(__append('\n        <td class="mor-mrp mor-is-editable">\n          <span class="mor-mrp-name">'),__append(escapeFn(t.name)),__append('</span>\n          <span class="mor-mrp-desc">'),__append(escapeFn(t.description)),__append("</span>\n          "),mrpActionsVisible&&__append('\n          <div class="btn-group">\n            <button class="btn btn-default" data-action="editMrp"><i class="fa fa-edit"></i></button>\n            <button class="btn btn-default" data-action="removeMrp"><i class="fa fa-remove"></i></button>\n          </div>\n          '),__append("\n        </td>\n        ")),__append("\n        "),t.prodFunctions.forEach(function(e){__append('\n        <td class="is-min mor-is-editable '),__append(e.common?"mor-is-common":""),__append('" data-prod-function-id="'),__append(e._id),__append('" rowspan="'),__append(escapeFn(e.rowspan)),__append('">\n          '),e.users.forEach(function(e){__append("\n          "),__append(e.no),__append('<span class="mor-user mor-user-presence '),__append(e.presence?"mor-user-present":"mor-user-notPresent"),__append('" data-user-id="'),__append(e._id),__append('">'),__append(escapeFn(e.label)),__append("</span><br>\n          ")}),__append('\n          <div class="btn-group">\n            <button class="btn btn-default" data-action="editProdFunction"><i class="fa fa-edit"></i></button>\n          </div>\n        </td>\n        ')}),__append("\n      </tr>\n      ")}),__append("\n      </tbody>\n    </table>\n    ")),__append("\n  </div>\n  ")}),__append('\n  <div id="'),__append(idPrefix),__append('-jumpList" class="list-group mor-jumpList">\n    '),sections.forEach(function(e){__append('\n    <a href="#" data-section-id="'),__append(e._id),__append('" class="list-group-item">'),__append(escapeFn(e.label)),__append("</a>\n    ")}),__append("\n  </div>\n  "),editModeVisible&&(__append('\n  <button id="'),__append(idPrefix),__append('-editMode" class="btn btn-default mor-btn-editMode" type="button"><i class="fa fa-edit"></i><span>'),__append(t.bound("mor","PAGE_ACTION:editMode")),__append("</span></button>\n  ")),__append("\n</div>\n");return __output}}),define("app/mor/templates/removeSection",["underscore","jquery","app/i18n","app/time","app/user","app/core/util/forms"],function(_,$,t,time,user,forms){return function anonymous(locals,escapeFn,include,rethrow){escapeFn=escapeFn||function(e){return void 0==e?"":String(e).replace(_MATCH_HTML,encode_char)};var _ENCODE_HTML_RULES={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&#34;","'":"&#39;"},_MATCH_HTML=/[&<>'"]/g;function encode_char(e){return _ENCODE_HTML_RULES[e]||e}var __output="";function __append(e){void 0!==e&&null!==e&&(__output+=e)}with(locals||{})__append("<div>\n  <p>"),__append(t("mor","removeSection:message",{section:section})),__append('</p>\n  <div class="form-actions">\n    <button class="btn btn-danger dialog-answer" type="button" autofocus data-answer="yes">'),__append(t("mor","removeSection:yes")),__append('</button>\n    <button class="btn btn-link cancel" type="button">'),__append(t("mor","removeSection:no")),__append("</button>\n  </div>\n</div>\n");return __output}}),define("app/mor/templates/removeWatch",["underscore","jquery","app/i18n","app/time","app/user","app/core/util/forms"],function(_,$,t,time,user,forms){return function anonymous(locals,escapeFn,include,rethrow){escapeFn=escapeFn||function(e){return void 0==e?"":String(e).replace(_MATCH_HTML,encode_char)};var _ENCODE_HTML_RULES={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&#34;","'":"&#39;"},_MATCH_HTML=/[&<>'"]/g;function encode_char(e){return _ENCODE_HTML_RULES[e]||e}var __output="";function __append(e){void 0!==e&&null!==e&&(__output+=e)}with(locals||{})__append("<div>\n  <p>"),__append(t("mor","removeWatch:message",{user:user})),__append('</p>\n  <div class="form-actions">\n    <button class="btn btn-danger dialog-answer" type="button" autofocus data-answer="yes">'),__append(t("mor","removeWatch:yes")),__append('</button>\n    <button class="btn btn-link cancel" type="button">'),__append(t("mor","removeWatch:no")),__append("</button>\n  </div>\n</div>\n");return __output}}),define("app/mor/templates/removeMrp",["underscore","jquery","app/i18n","app/time","app/user","app/core/util/forms"],function(_,$,t,time,user,forms){return function anonymous(locals,escapeFn,include,rethrow){escapeFn=escapeFn||function(e){return void 0==e?"":String(e).replace(_MATCH_HTML,encode_char)};var _ENCODE_HTML_RULES={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&#34;","'":"&#39;"},_MATCH_HTML=/[&<>'"]/g;function encode_char(e){return _ENCODE_HTML_RULES[e]||e}var __output="";function __append(e){void 0!==e&&null!==e&&(__output+=e)}with(locals||{})__append("<div>\n  <p>"),__append(t("mor","removeMrp:message",{section:section,mrp:mrp})),__append('</p>\n  <div class="form-actions">\n    <button class="btn btn-danger dialog-answer" type="button" autofocus data-answer="yes">'),__append(t("mor","removeMrp:yes")),__append('</button>\n    <button class="btn btn-link cancel" type="button">'),__append(t("mor","removeMrp:no")),__append("</button>\n  </div>\n</div>\n");return __output}}),define("app/mor/templates/userPopover",["underscore","jquery","app/i18n","app/time","app/user","app/core/util/forms"],function(_,$,t,time,user,forms){return function anonymous(locals,escapeFn,include,rethrow){escapeFn=escapeFn||function(e){return void 0==e?"":String(e).replace(_MATCH_HTML,encode_char)};var _ENCODE_HTML_RULES={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&#34;","'":"&#39;"},_MATCH_HTML=/[&<>'"]/g;function encode_char(e){return _ENCODE_HTML_RULES[e]||e}var __output="";function __append(e){void 0!==e&&null!==e&&(__output+=e)}with(locals||{})__append('<dl class="mor-userPopover">\n  '),user.prodFunction&&(__append("\n  <dt>"),__append(t("mor","prop:prodFunction")),__append("</dt>\n  <dd>"),__append(escapeFn(user.prodFunction)),__append("</dd>\n  ")),__append("\n  "),user.email&&(__append("\n  <dt>"),__append(t("mor","prop:email")),__append("</dt>\n  <dd>\n    "),editable?(__append('\n    <a href="mailto:'),__append(escapeFn(user.email)),__append('">'),__append(escapeFn(user.email)),__append("</a>\n    ")):(__append("\n    "),__append(escapeFn(user.email)),__append("\n    ")),__append("\n  </dd>\n  ")),__append("\n  "),user.mobile&&(__append("\n  <dt>"),__append(t("mor","prop:mobile")),__append("</dt>\n  <dd>"),__append(escapeFn(user.mobile)),__append("</dd>\n  ")),__append("\n</dl>\n");return __output}}),define("app/mor/views/MorView",["underscore","jquery","app/broker","app/i18n","app/user","app/time","app/viewport","app/core/View","app/core/views/DialogView","app/data/prodFunctions","./SectionFormView","./WatchFormView","./MrpFormView","./EditProdFunctionFormView","app/mor/templates/mor","app/mor/templates/removeSection","app/mor/templates/removeWatch","app/mor/templates/removeMrp","app/mor/templates/userPopover"],function(e,t,n,i,r,o,a,s,u,c,l,d,p,f,h,m,g,v,y){"use strict";return s.extend({template:h,dialogClassName:"mor-dialog",events:{"click h3":function(e){if("I"===e.target.tagName||"SPAN"===e.target.tagName){var t=this.$(e.target).closest(".mor-section").toggleClass("is-collapsed");this.model.toggleSection(t[0].dataset.sectionId,t.hasClass("is-collapsed"))}},"click .mor-user":function(e){return this.toggleUserPopover(this.$(e.currentTarget)),!1},"click .btn[data-action]":function(e){var t=this.$(e.currentTarget),n=t[0].dataset.action,i=[],r=function(e){return t.closest("[data-"+e+"]").attr("data-"+e)};switch(n){case"addSection":i.push();break;case"removeSection":case"editSection":case"addWatch":i.push(r("section-id"));break;case"removeWatch":case"editWatch":i.push(r("section-id"),r("user-id"));break;case"addMrp":i.push(r("section-id"));break;case"removeMrp":case"editMrp":i.push(r("section-id"),r("mrp-id"));break;case"editProdFunction":i.push(r("section-id"),r("mrp-id"),r("prod-function-id"))}e.currentTarget.blur(),e.preventDefault(),e.stopPropagation(),this.redirectIfNeeded(n,i)||this[n].apply(this,i)},"mouseenter tr[data-mrp-id]":function(e){this.$(e.currentTarget).closest("tbody").find(".mor-is-common").addClass("mor-mrps-highlight")},"mouseleave tr[data-mrp-id]":function(e){this.$(e.currentTarget).closest("tbody").find(".mor-is-common").removeClass("mor-mrps-highlight")},"dragenter .mor-section":function(e){this.hoveredSectionId=e.currentTarget.dataset.sectionId},"click #-editMode":function(){a.closeDialog(),this.broker.publish("router.navigate",{url:"/mor?edit=1",trigger:!0,replace:!1})}},initialize:function(){this.editing=String(!!this.options.editing),this.$userPopover=null,this.$dndIndicator=null,this.draggedSectionId=null,this.hoveredSectionId=null,this.week=o.getMoment().startOf("week"),this.model.subscribe(this.pubsub),this.listenTo(this.model,"update:presence",this.onPresenceUpdated),t(window).on("click."+this.idPrefix,this.onClick.bind(this)).on("keydown."+this.idPrefix,this.onKeyDown.bind(this)),t(document).on("dragstart."+this.idPrefix,this.onDragStart.bind(this)).on("dragend."+this.idPrefix,this.onDragEnd.bind(this)).on("dragenter."+this.idPrefix,this.onDragEnter.bind(this)).on("dragover."+this.idPrefix,this.onDragOver.bind(this)).on("drop."+this.idPrefix,this.onDrop.bind(this))},destroy:function(){t(window).off("."+this.idPrefix),t(document).off("."+this.idPrefix),this.hideUserPopover(),this.$id("jumpList").remove()},serialize:function(){var e=this.serializeProdFunctions(),t=r.isAllowedTo("FN:manager"),n=r.isAllowedTo("MOR:MANAGE"),i=r.isAllowedTo("MOR:MANAGE:USERS");return{idPrefix:this.idPrefix,draggable:this.editing,editModeVisible:!1!==this.options.editable&&a.currentDialog===this&&(t||n||i),linkEmails:!1!==this.options.editable,sectionActionsVisible:n,watchActionsVisible:t||n,mrpActionsVisible:n,sections:this.serializeSections(e),prodFunctions:e}},serializeSections:function(e){return(this.model.get("sections")||[]).map(this.serializeSection.bind(this,e))},serializeSection:function(t,n){n.prodFunctions.length&&(t=this.serializeProdFunctions(n.prodFunctions));var i=this.model,o=this.serializeWatches(n),a=this.serializeMrps(t,n),s=e.some(o,function(e){return""!==e.user.days});if(s){var u=this.week;o.forEach(function(e){""===e.user.days&&(e.user.days=u.day(1).format("ddd")+"-"+u.day(7).format("ddd"))})}return{_id:n._id,collapsed:i.isSectionCollapsed(n._id),label:n.name,addWatchVisible:n.watchEnabled,watchVisible:n.watchEnabled&&o.length>0,watchDaysVisible:s,watchHoursVisible:e.some(o,function(e){return""!==e.user.hours}),watch:o,mrpsVisible:n.mrpsEnabled&&(a.length>0||!1!==this.options.editable&&r.isAllowedTo("MOR:MANAGE")),mrpColumnVisible:!0,mrps:a,prodFunctions:t}},serializeWatches:function(e){var t=this.model;return e.watch.filter(function(e){return!!t.users.get(e.user)}).sort(function(e,n){return e=t.users.get(e.user),n=t.users.get(n.user),e.get("prodFunction")===n.get("prodFunction")?e.getLabel().localeCompare(n.getLabel()):"manager"===e.get("prodFunction")?-1:"manager"===n.get("prodFunction")?1:e.getLabel().localeCompare(n.getLabel())}).map(this.serializeWatch,this)},serializeWatch:function(e){return{user:this.serializeUser(e,e.user,-1)}},serializeMrps:function(t,n){var i={};return n.commonProdFunctions.forEach(function(e){i[e._id]=e.users}),e.forEach(this.model.get("globalProdFunctions"),function(e){i[e._id]=e.users}),n.mrps.sort(function(e,t){return e._id.localeCompare(t._id)}).map(this.serializeMrp.bind(this,t,i,n.mrps.length))},serializeMrp:function(e,t,n,i,r){return{_id:i._id,name:/^[A-Za-z0-9]/.test(i._id)?i._id:"",description:i.description,prodFunctions:this.serializeMrpProdFunctions(e,i.prodFunctions,0===r?t:{},0===r,n)}},serializeMrpProdFunctions:function(e,t,n,i,r){var o=this,a={};return t.forEach(function(e){a[e._id]=e}),e.map(function(e){var t=a[e._id]||{_id:e._id,users:[]},s=(n[e._id]||t.users).map(function(t,n){var i=o.serializeUser(null,t,n);return e.ordered||(i.no=""),i});return e.ordered||s.sort(function(e,t){return e.label.localeCompare(t.label)}),{_id:e._id,common:e.common||e.global,users:s,rowspan:(e.common||e.global)&&i?r:1}}).filter(function(e){return i||!e.common})},serializeUser:function(e,t,n){var i=this.model.users.get(t),r="",o="";if(e&&(e.days.length&&(r=this.formatDayRange(e.days)),e.from&&e.to&&e.from!==e.to&&(o=e.from+"-"+e.to)),!i)return{_id:t,no:n+1+". ",label:t,prodFunction:"?",email:"?",mobile:"?",presence:!1,days:r,hours:o};var a=c.get(i.get("prodFunction"));return{_id:i.id,no:n+1+". ",label:i.getLabel(),prodFunction:a?a.getLabel():"?",email:i.get("email")||"?",mobile:i.getMobile()||"?",presence:i.get("presence"),days:r,hours:o}},formatDayRange:function(e){for(var t=[],n=0;n<e.length;++n){var i=e[n];if(0!==n){var r=t[t.length-1];i-r[1]!=1?t.push([i,i]):r[1]+=1}else t.push([i,i])}var o=this.week;return t.map(function(e){var t=o.day(e[0]).format("ddd");return e[0]===e[1]?t:t+"-"+o.day(e[1]).format("ddd")}).join(", ")},serializeProdFunctions:function(t){var n=this.model.get("settings")||{},i=n.globalProdFunctions||[],r=n.commonProdFunctions||[],o=n.orderedProdFunctions||[];return t||(t=n.prodFunctions||[]),e.map(t,function(t){var n=c.get(t);return{_id:n?n.id:t,label:n?n.getLabel():t,global:e.contains(i,t),common:e.contains(r,t),ordered:e.contains(o,t)}})},beforeRender:function(){this.stopListening(this.model,"change update",this.render),this.$id("jumpList").remove()},afterRender:function(){this.listenTo(this.model,"change update",this.render),this.$id("jumpList").on("click","a",this.onJumpListClick.bind(this)),a.currentDialog===this&&this.$id("jumpList").addClass("hidden mor-jumpList-modal")},onDialogShown:function(){this.$id("jumpList").appendTo(document.body).removeClass("hidden")},onJumpListClick:function(e){var n=this.$id("jumpList").hasClass("mor-jumpList-modal"),i=e.currentTarget.dataset.sectionId,r=this.$('.mor-section[data-section-id="'+i+'"]');this.model.isSectionCollapsed(i)&&r.find(".mor-section-name").click();var o=0;if(n)o=r.position().top+30;else{o=r.offset().top-14;var a=t(".navbar-fixed-top");a.length&&(o-=a.outerHeight())}return t(n?".modal":"html, body").stop(!0,!1).animate({scrollTop:o}),!1},toggleEditing:function(e){this.editing=String(e),this.$("[draggable]").attr("draggable",this.editing)},onDragStart:function(e){e.target.draggable&&e.target.classList.contains("mor-section-name")&&r.isAllowedTo("MOR:MANAGE")&&(e.originalEvent.dataTransfer.dropEffect="move",this.draggedSectionId=this.$(e.target).closest("[data-section-id]").attr("data-section-id"),this.hoveredSectionId=this.draggedSectionId,this.$dndIndicator=t('<hr class="mor-dnd-indicator">'),this.positionDndIndicator(e),this.$dndIndicator.appendTo(document.body))},onDragEnter:function(e){this.draggedSectionId&&e.preventDefault()},onDragEnd:function(){this.$dndIndicator&&(this.$dndIndicator.remove(),this.$dndIndicator=null),this.draggedSectionId=null},onDragOver:function(e){this.draggedSectionId&&this.hoveredSectionId&&(e.preventDefault(),this.positionDndIndicator(e))},onDrop:function(){if(this.draggedSectionId){var e={source:this.draggedSectionId,target:this.hoveredSectionId,position:this.$dndIndicator.attr("data-position")};this.draggedSectionId=null,this.hoveredSectionId=null,setTimeout(this.model.moveSection.bind(this.model,e),1)}},positionDndIndicator:function(e){var t=this.$('.mor-section[data-section-id="'+this.hoveredSectionId+'"]'),n=e.originalEvent.pageY,i=t.offset().top,r=t.outerHeight(!0),o="before";if(n>i+r/2){o="after";var a=t.next();a.length?i=a.offset().top:i+=r+8}else t.prev().length||(i-=10);this.$dndIndicator.css("top",i+"px").attr("data-position",o)},redirectIfNeeded:function(e,t){return!!a.currentDialog&&(n.subscribe("viewport.dialog.hidden").setLimit(1).on("message",function(){n.subscribe("viewport.page.shown").setLimit(1).on("message",function(){"mor"===a.currentPage.pageId&&a.currentPage.view[e].apply(a.currentPage.view,t)}),n.publish("router.navigate",{url:"/mor",trigger:!0,replace:!1})}),a.closeAllDialogs(),!0)},addSection:function(){a.showDialog(new l({model:{nlsSuffix:"add",mor:this.model,section:null}}),i("mor","sectionForm:title:add"))},removeSection:function(e){var t=new u({template:m,autoHide:!1,model:{section:this.model.getSection(e).name}});this.listenTo(t,"answered",function(){this.model.removeSection({section:e}).fail(function(){a.msg.show({type:"error",time:3e3,text:i("mor","removeSection:failure")})}).done(function(){a.closeDialog()}).always(function(){t.enableAnswers()})}),a.showDialog(t,i("mor","removeSection:title"))},editSection:function(e){a.showDialog(new l({model:{nlsSuffix:"edit",mor:this.model,section:this.model.getSection(e)}}),i("mor","sectionForm:title:edit"))},addWatch:function(e){a.showDialog(new d({model:{mode:"add",mor:this.model,section:this.model.getSection(e),watch:null}}),i("mor","watchForm:title:add"))},removeWatch:function(e,t){var n=new u({template:g,autoHide:!1,model:{user:this.model.users.get(t).getLabel()}});this.listenTo(n,"answered",function(){this.model.removeWatch({section:e,user:t}).fail(function(){a.msg.show({type:"error",time:3e3,text:i("mor","removeWatch:failure")})}).done(function(){a.closeDialog()}).always(function(){n.enableAnswers()})}),a.showDialog(n,i("mor","removeWatch:title"))},editWatch:function(e,t){a.showDialog(new d({model:{mode:"edit",mor:this.model,section:this.model.getSection(e),watch:this.model.getWatch(e,t)}}),i("mor","watchForm:title:edit"))},addMrp:function(e){a.showDialog(new p({model:{mode:"add",mor:this.model,section:this.model.getSection(e),mrp:null}}),i("mor","mrpForm:title:add"))},removeMrp:function(e,t){var n=new u({template:v,autoHide:!1,model:{section:this.model.getSection(e).name,mrp:t}});this.listenTo(n,"answered",function(){this.model.removeMrp({section:e,mrp:t}).fail(function(){a.msg.show({type:"error",time:3e3,text:i("mor","removeMrp:failure")})}).done(function(){a.closeDialog()}).always(function(){n.enableAnswers()})}),a.showDialog(n,i("mor","removeMrp:title"))},editMrp:function(e,t){a.showDialog(new p({model:{mode:"edit",mor:this.model,section:this.model.getSection(e),mrp:this.model.getMrp(e,t)}}),i("mor","mrpForm:title:edit"))},editProdFunction:function(e,t,n){a.showDialog(new f({model:{mor:this.model,section:this.model.getSection(e),mrp:this.model.getMrp(e,t),prodFunction:c.get(n)}}),i("mor","editProdFunction:title"))},toggleUserPopover:function(e){this.$userPopover?this.$userPopover[0]===e[0]?this.hideUserPopover():(this.hideUserPopover(),this.showUserPopover(e)):this.showUserPopover(e)},hideUserPopover:function(){this.$userPopover&&(this.$userPopover.popover("destroy"),this.$userPopover=null)},showUserPopover:function(e){if(!this.$userPopover){var t=this.model.users.get(e[0].dataset.userId);t&&(this.$userPopover=e.popover({placement:"right",trigger:"manual",html:!0,title:t.getLabel(),content:this.getUserPopoverContent(t)}).popover("show"))}},getUserPopoverContent:function(e){var t=c.get(e.get("prodFunction"));return y({editable:!1!==this.options.editable,user:{name:e.getLabel(),prodFunction:t?t.getLabel():"",email:e.get("email"),mobile:e.getMobile()}})},onClick:function(e){t(e.target).closest(".popover").length||this.hideUserPopover()},onKeyDown:function(e){27===e.keyCode&&this.hideUserPopover()},onPresenceUpdated:function(t){var n=this;e.forEach(t,function(e,t){n.$('.mor-user-presence[data-user-id="'+t+'"]').removeClass("mor-user-present mor-user-notPresent").addClass("mor-user-"+(e?"present":"notPresent"))})}})}),define("app/production/templates/unlockDialog",["underscore","jquery","app/i18n","app/time","app/user","app/core/util/forms"],function(_,$,t,time,user,forms){return function anonymous(locals,escapeFn,include,rethrow){escapeFn=escapeFn||function(e){return void 0==e?"":String(e).replace(_MATCH_HTML,encode_char)};var _ENCODE_HTML_RULES={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&#34;","'":"&#39;"},_MATCH_HTML=/[&<>'"]/g;function encode_char(e){return _ENCODE_HTML_RULES[e]||e}var __output="";function __append(e){void 0!==e&&null!==e&&(__output+=e)}with(locals||{})__append('<form class="production-'),__append(type),__append('Dialog" autocomplete="off">\n  <input id="'),__append(id("apiKey")),__append('" type="hidden" value="'),__append(apiKey),__append('">\n  '),"unlock"===type&&(__append('\n  <div class="production-form-btn-group">\n    <label class="control-label is-required">'),__append(t("unlockDialog:prodLine")),__append('</label>\n    <div id="'),__append(id("list")),__append('" class="btn-group-vertical">\n      <p>\n        <i class="fa fa-spinner fa-spin"></i>\n      </p>\n    </div>\n  </div>\n  <div class="form-group">\n    <label class="control-label is-required">'),__append(t("unlockDialog:station")),__append('</label>\n    <br>\n    <div class="btn-group production-unlockDialog-stations" data-toggle="buttons">\n      '),[1,2,3,4,5,6,7].forEach(function(e){__append('\n      <label class="btn btn-default">\n        <input type="radio" name="station" value="'),__append(e),__append('"> '),__append(e),__append("\n      </label>\n      ")}),__append("\n    </div>\n  </div>\n  ")),__append("\n  "),apiKey||(__append('\n  <div class="form-group">\n    <label for="'),__append(id("login")),__append('" class="control-label is-required">'),__append(t("unlockDialog:login")),__append('</label>\n    <input id="'),__append(id("login")),__append('" class="form-control is-embedded" type="text" autocomplete="new-password" required data-vkb="alpha numeric">\n  </div>\n  <div class="form-group">\n    <label for="'),__append(id("password")),__append('" class="control-label is-required">'),__append(t("unlockDialog:password")),__append('</label>\n    <input id="'),__append(id("password")),__append('" class="form-control is-embedded" type="password" autocomplete="new-password" required data-vkb="alpha numeric extended">\n  </div>\n  ')),__append('\n  <div class="form-actions">\n    <button id="'),__append(id("submit")),__append('" class="btn btn-lg btn-primary" type="submit">'),__append(t("unlockDialog:"+type)),__append('</button>\n    <button class="btn btn-lg btn-link cancel" type="button">'),__append(t("core","ACTION_FORM:BUTTON:cancel")),__append("</button>\n  </div>\n</form>\n");return __output}}),define("app/production/views/UnlockDialogView",["underscore","app/i18n","app/user","app/viewport","app/core/View","app/data/dictionaries","app/data/orgUnits","app/prodLines/ProdLineCollection","app/production/templates/unlockDialog"],function(e,t,n,i,r,o,a,s,u){"use strict";return r.extend({template:u,dialogClassName:"production-modal",events:{submit:function(e){e.preventDefault();var t=this.$id("list").find(".active").text().trim(),n=this.$('input[name="station"]:checked').val();if(t&&n){var i=this.$id("submit")[0];if(!i.disabled){i.disabled=!0;var r={prodLine:t,station:+n,apiKey:this.$id("apiKey").val(),login:this.$id("login").val(),password:this.$id("password").val()};this.socket.emit("production.unlock",r,this.handleUnlockResponse.bind(this))}}},"click #-list .btn":function(e){this.$id("list").find(".active").removeClass("active"),this.$(e.currentTarget).addClass("active")},"click .btn":function(){this.options.vkb&&this.options.vkb.hide()},"focus [data-vkb]":function(e){this.options.embedded&&this.options.vkb&&this.options.vkb.show(e.target)}},destroy:function(){this.options.vkb&&this.options.vkb.hide()},getTemplateData:function(){var e="";return"development"===window.ENV&&n.isAllowedTo("SUPER")?e="SUPER":window.WMES_CLIENT&&window.WMES_CLIENT.apiKey&&(e=window.WMES_CLIENT.apiKey),{type:"unlock",apiKey:e,prodLine:""}},afterRender:function(){this.loadLines(),this.$('input[name="station"][value="1"]').click()},selectActiveLine:function(){var e=this.$id("list").find(".active");e.length&&e[0].scrollIntoView({block:"center"})},loadLines:function(){var t=this;t.$id("submit").prop("disabled",!0);var n=t.ajax({url:"/production/getActiveLines?subdivisionType=assembly"});n.fail(function(){t.$(".fa-spin").removeClass("fa-spin")}),n.done(function(n){var i="",r=window.WMES_CLIENT&&window.WMES_CLIENT.config||{};e.forEach(n.collection,function(t){var n="btn btn-lg btn-default";t._id===r.line&&(n+=" active"),i+='<button type="button" class="'+n+'">'+e.escape(t._id)+"</button>"}),t.$id("list").html(i),t.$id("submit").prop("disabled",!1),t.options.vkb&&t.options.vkb.reposition();var o=t.$id("list").find(".active")[0];o&&r.station&&(o.scrollIntoView(),t.$('input[name="station"][value="'+r.station+'"]').click(),t.$id("submit").click())})},onDialogShown:function(e){this.closeDialog=e.closeDialog.bind(e)},closeDialog:function(){},handleUnlockResponse:function(t,n){if(t){this.$id("password").val(""),"INVALID_PASSWORD"===t.message?this.$id("password").focus():this.$id("login").val("").focus();var r=t.code||t.message;return i.msg.show({type:"error",time:3e3,text:this.t.has("unlockDialog:error:"+r)?this.t("unlockDialog:error:"+r):this.t("unlockDialog:error:UNLOCK_FAILURE")}),this.$id("submit").prop("disabled",!1)}this.model.get("prodLine")||e.forEach(n.dictionaries,function(e,t){var n=o[t];n&&n.reset(e)}),delete n.dictionaries;var s=n.prodShift;if(s?(s.prodShiftOrder=n.prodShiftOrder,s.prodDowntimes=n.prodDowntimes):s={},!this.model.get("prodLine")){var u=a.getByTypeAndId("prodLine",n.prodLine);if(null===u)return this.closeDialog();s=e.assign(s,a.getAllForProdLine(u))}s.station=n.station>=1&&n.station<=7?n.station:0,this.model.setSecretKey(n.secretKey,s,!0),this.closeDialog()}})}),define("app/production/views/LockDialogView",["app/i18n","app/user","app/viewport","app/core/View","app/production/templates/unlockDialog"],function(e,t,n,i,r){"use strict";return i.extend({template:r,dialogClassName:"production-modal",events:{submit:function(e){e.preventDefault();var t=this.$id("submit")[0];if(!t.disabled){t.disabled=!0;var n={prodLine:this.model.prodLine.id,secretKey:this.model.getSecretKey(),login:this.$id("login").val(),password:this.$id("password").val()};this.socket.emit("production.lock",n,this.handleLockResponse.bind(this))}},"focus [data-vkb]":function(e){this.options.embedded&&this.options.vkb&&this.options.vkb.show(e.target)}},destroy:function(){this.options.vkb&&this.options.vkb.hide()},getTemplateData:function(){return{type:"lock",apiKey:"development"===window.ENV&&t.isAllowedTo("SUPER")?"SUPER":"",prodLine:this.model.prodLine.id}},onDialogShown:function(e){this.closeDialog=e.closeDialog.bind(e),this.$id("login").focus()},closeDialog:function(){},handleLockResponse:function(e){if(e)return this.$id("password").val(""),"INVALID_PASSWORD"===e.message?this.$id("password").focus():this.$id("login").val("").focus(),n.msg.show({type:"error",time:3e3,text:this.t.has("unlockDialog:error:"+e.message)?this.t("unlockDialog:error:"+e.message):this.t("unlockDialog:error:LOCK_FAILURE")}),this.$id("submit").prop("disabled",!1);this.model.setSecretKey(null),this.closeDialog()}})}),define("app/componentLabels/ComponentLabel",["../i18n","../core/Model"],function(e,t){"use strict";return t.extend({urlRoot:"/componentLabels",clientUrlRoot:"#componentLabels",topicPrefix:"componentLabels",privilegePrefix:"PROD_DATA",nlsDomain:"componentLabels",getLabel:function(){return this.get("description")||this.get("componentCode")+", "+this.get("operationNo")},serialize:function(){var t=this.toJSON();return t.global=e("core","BOOL:"+!!t.global),t.lines=t.lines.join("; "),t}},{TEMPLATES:["32x16","104x42"]})}),define("app/componentLabels/ComponentLabelCollection",["../core/Collection","./ComponentLabel"],function(e,t){"use strict";return e.extend({model:t,rqlQuery:"sort(componentCode)&limit(-1337)"})}),define("app/production/templates/componentLabels",["underscore","jquery","app/i18n","app/time","app/user","app/core/util/forms"],function(_,$,t,time,user,forms){return function anonymous(locals,escapeFn,include,rethrow){escapeFn=escapeFn||function(e){return void 0==e?"":String(e).replace(_MATCH_HTML,encode_char)};var _ENCODE_HTML_RULES={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&#34;","'":"&#39;"},_MATCH_HTML=/[&<>'"]/g;function encode_char(e){return _ENCODE_HTML_RULES[e]||e}var __output="";function __append(e){void 0!==e&&null!==e&&(__output+=e)}with(locals||{})__append('<form class="production-componentLabels-form" autocomplete="off">\n  <div class="form-group">\n    <label class="control-label">'),__append(t("componentLabels:orderNo")),__append('</label>\n    <p class="form-control-static">'),__append(orderNo||"-"),__append('</p>\n  </div>\n  <div class="form-group">\n    <label class="control-label">'),__append(t("componentLabels:operationNo")),__append('</label>\n    <p class="form-static">'),__append(operationNo||"-"),__append('</p>\n  </div>\n  <div style="display: flex">\n    <div class="form-group" style="margin-top: 0">\n      <label for="'),__append(id("labelQty")),__append('" class="control-label">'),__append(t("componentLabels:labelQty")),__append('</label>\n      <input id="'),__append(id("labelQty")),__append('" class="form-control small is-embedded" type="text" autocomplete="new-password" value="1" min="1" max="9999" data-vkb="numeric">\n    </div>\n    <div class="form-group">\n      <label for="'),__append(id("shiftX")),__append('" class="control-label">'),__append(t("componentLabels:shiftX")),__append('</label>\n      <input id="'),__append(id("shiftX")),__append('" class="form-control small is-embedded" type="text" autocomplete="new-password" value="'),__append(shiftX),__append('" min="-9999" max="9999" data-vkb="numeric negative">\n    </div>\n    <div class="form-group">\n      <label for="'),__append(id("shiftY")),__append('" class="control-label">'),__append(t("componentLabels:shiftY")),__append('</label>\n      <input id="'),__append(id("shiftY")),__append('" class="form-control small is-embedded" type="text" autocomplete="new-password" value="'),__append(shiftY),__append('" min="-120" max="120" data-vkb="numeric negative">\n    </div>\n  </div>\n  <div id="'),__append(id("componentsGroup")),__append('" class="production-form-btn-group">\n    <label class="control-label">'),__append(t("componentLabels:componentCode")),__append('</label>\n    <p id="'),__append(id("componentsMessage")),__append('" style="padding: 0 15px"><i class="fa fa-spinner fa-spin"></i></p>\n    <div id="'),__append(id("componentsList")),__append('" class="btn-group-vertical hidden"></div>\n  </div>\n  <div class="form-actions" style="display: flex">\n    <button id="'),__append(id("submit")),__append('" class="btn btn-lg btn-primary" type="submit" disabled>\n      <i class="fa fa-spinner fa-spin hidden"></i>\n      <span>'),__append(t("componentLabels:submit")),__append('</span>\n    </button>\n    <button class="btn btn-lg btn-link cancel" type="button">'),__append(t("componentLabels:cancel")),__append('</button>\n    <button id="'),__append(id("test")),__append('" class="btn btn-lg btn-default" type="button" disabled style="margin-left: auto">\n      <i class="fa fa-spinner fa-spin hidden"></i>\n      <span>'),__append(t("componentLabels:test")),__append("</span>\n    </button>\n  </div>\n</form>\n");return __output}}),define("app/production/views/ComponentLabelsDialogView",["underscore","app/viewport","app/core/View","app/data/localStorage","app/componentLabels/ComponentLabel","app/componentLabels/ComponentLabelCollection","app/production/templates/componentLabels"],function(e,t,n,i,r,o,a){"use strict";return n.extend({template:a,dialogClassName:"production-modal production-componentLabels-modal",events:{"focus [data-vkb]":function(e){this.options.embedded&&this.options.vkb&&this.options.vkb.show(e.target)},"click .btn-default[value]":function(e){this.$(".btn.active[value]").removeClass("active"),e.currentTarget.classList.add("active")},"click #-test":function(){this.submitForm(!0)},submit:function(){return this.submitForm(!1),!1}},initialize:function(){this.selected=null,this.labelShift=JSON.parse(i.getItem("WMES_OPERATOR_COMPONENT_LABEL_SHIFT")||"[0, 0]");var e=this.model.prodShiftOrder.get("orderId");this.componentLabels=new o(null,{url:"/orders/"+e+"/componentLabels/"+this.model.prodShiftOrder.get("operationNo")}),this.once("afterRender",function(){e?this.promised(this.componentLabels.fetch({reset:!0})):this.componentLabels.reset([])}),this.listenTo(this.componentLabels,"reset",this.renderComponentLabels)},destroy:function(){this.options.vkb&&this.options.vkb.hide()},getTemplateData:function(){return{orderNo:this.model.prodShiftOrder.get("orderId"),operationNo:this.model.prodShiftOrder.get("operationNo"),shiftX:this.labelShift[0],shiftY:this.labelShift[1]}},renderComponentLabels:function(){var e=this.$id("componentsList"),t=this.$id("componentsMessage"),n=this.$id("submit"),i=this.$id("test");if(!this.componentLabels.length)return e.addClass("hidden").empty(),t.html(this.t("componentLabels:noComponents")).removeClass("hidden"),n.prop("disabled",!0),void i.prop("disabled",!0);var r="";this.componentLabels.forEach(function(e){r+='<button type="button" class="btn btn-lg btn-default" value="'+e.id+'"><em>'+e.get("componentCode")+"</em><span>"+e.get("description")+"</span></button>"}),t.addClass("hidden"),e.html(r).removeClass("hidden"),n.prop("disabled",!1),i.prop("disabled",!1),1===this.componentLabels.length&&e.children().first().click()},submitForm:function(n){var r=this,o=+r.$id("labelQty").val().replace(/[^0-9]+/g,""),a=r.componentLabels.get(r.$(".btn.active[value]").val());if(o)if(a){var s=r.model.prodShiftOrder.get("orderData"),u=s&&s.bom||[],c=e.find(u,function(e){return e.nc12===a.get("componentCode")}),l=c&&c.qty||50;o>l&&(o=l),r.$id("labelQty").val(o),r.$id("submit").prop("disabled",!0),r.$id("test").prop("disabled",!0),r.$id(n?"test":"submit").find(".fa-spin").removeClass("hidden");var d=Math.max(Math.min(parseInt(r.$id("shiftX").val(),10)||0,9999),-9999),p=Math.max(Math.min(parseInt(r.$id("shiftY").val(),10)||0,120),-120);r.$id("shiftX").val(d),r.$id("shiftY").val(p),this.labelShift[0]===d&&this.labelShift[1]===p||(this.labelShift=[d,p],i.setItem("WMES_OPERATOR_COMPONENT_LABEL_SHIFT",JSON.stringify(this.labelShift)));var f=r.ajax({method:"POST",url:"/componentLabels/"+a.id+";print",data:JSON.stringify({test:n,labelQty:o,shiftX:d,shiftY:p,orderNo:this.model.prodShiftOrder.get("orderId"),prodLine:r.model.prodLine.id,secretKey:r.model.getSecretKey()})});f.fail(function(){var e=f.responseJSON&&f.responseJSON.error&&f.responseJSON.error.code||"";t.msg.show({type:"error",time:3e3,text:r.t.has("componentLabels:error:"+e)?r.t("componentLabels:error:"+e):r.t("componentLabels:error")}),r.$id("submit").prop("disabled",!1),r.$id("test").prop("disabled",!1),r.$id(n?"test":"submit").find(".fa-spin").addClass("hidden")}),f.done(function(){n||t.closeDialog()})}else r.$id("componentsList").find(".btn").first().focus();else r.$id("labelQty").focus()}})}),define("app/production/templates/controls",["underscore","jquery","app/i18n","app/time","app/user","app/core/util/forms"],function(_,$,t,time,user,forms){return function anonymous(locals,escapeFn,include,rethrow){escapeFn=escapeFn||function(e){return void 0==e?"":String(e).replace(_MATCH_HTML,encode_char)};var _ENCODE_HTML_RULES={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&#34;","'":"&#39;"},_MATCH_HTML=/[&<>'"]/g;function encode_char(e){return _ENCODE_HTML_RULES[e]||e}var __output="";function __append(e){void 0!==e&&null!==e&&(__output+=e)}with(locals||{})__append('<div class="production-controls">\n  <div class="production-controls-group">\n    <a id="'),__append(id("extraPsn")),__append('" class="fa fa-barcode" title="'),__append(t("controls:extraPsn")),__append('"></a>\n    <a id="'),__append(id("componentLabels")),__append('" class="fa fa-print" title="'),__append(t("controls:componentLabels")),__append('"></a>\n  </div>\n  <div class="production-controls-group">\n    <a id="'),__append(id("mor")),__append('" class="fa fa-group" title="'),__append(t("controls:mor")),__append('"></a>\n    <a class="fa fa-warning production-controls-addNearMiss" title="'),__append(t("controls:addNearMiss")),__append('"></a>\n    <a class="fa fa-lightbulb-o production-controls-addSuggestion" title="'),__append(t("controls:addSuggestion")),__append('"></a>\n    <a class="fa fa-eye production-controls-addObservation" title="'),__append(t("controls:addObservation")),__append('"></a>\n    <a class="fa fa-unlock production-controls-lock" title="'),__append(t("controls:lock")),__append('"></a>\n    <a class="fa fa-lock production-controls-unlock" title="'),__append(t("controls:unlock")),__append('" accesskey="a"></a>\n    <i class="fa fa-signal production-controls-sync" title="'),__append(t("controls:sync")),__append('"></i>\n  </div>\n</div>\n');return __output}}),define("app/production/views/ProductionControlsView",["app/i18n","app/user","app/viewport","app/core/View","app/core/util/embedded","app/mor/Mor","app/mor/views/MorView","../snManager","./UnlockDialogView","./LockDialogView","./ComponentLabelsDialogView","app/production/templates/controls"],function(e,t,n,i,r,o,a,s,u,c,l,d){"use strict";var p={"socket.connected":"#5BB75B","socket.disconnected":"#DA4F49","socket.connectFailed":"#DA4F49","socket.connecting":"#F0AD4E"};return i.extend({template:d,localTopics:{"socket.connected":function(){this.mor&&this.promised(this.mor.fetch())},"socket.*":function(e,t){var n=p[t];n&&this.$syncControl&&this.$syncControl.css("color",n)},"production.syncing":function(){this.$syncControl&&this.$syncControl.addClass("is-syncing")},"production.synced":function(){this.$syncControl&&this.$syncControl.removeClass("is-syncing")}},events:{"click #-mor":"showMor","click #-componentLabels":"showComponentLabels","click #-extraPsn":"toggleExtraPsn","click a.production-controls-addNearMiss":"addNearMiss","click a.production-controls-addSuggestion":"addSuggestion","click a.production-controls-addObservation":"addObservation","click a.production-controls-lock":function(){window.WMES_CLIENT?r.isEnabled()&&r.actions.config():this.lock()},"click a.production-controls-unlock":function(){window.WMES_CLIENT?r.isEnabled()&&r.actions.config():this.unlock()},"mouseover a.production-controls-lock":function(e){this.$(e.target).removeClass("fa-unlock").addClass("fa-lock")},"mouseout a.production-controls-lock":function(e){this.$(e.target).removeClass("fa-lock").addClass("fa-unlock")},"mouseover a.production-controls-unlock":function(e){this.$(e.target).removeClass("fa-lock").addClass("fa-unlock")},"mouseout a.production-controls-unlock":function(e){this.$(e.target).removeClass("fa-unlock").addClass("fa-lock")}},initialize:function(){this.mor=null,this.extraPsn=!1},afterRender:function(){this.$syncControl=this.$(".production-controls-sync"),this.$syncControl.css("color",p[this.socket.isConnected()?"socket.connected":"socket.disconnected"])},addNearMiss:function(){this.addImprovement("/#kaizenOrders;add")},addSuggestion:function(){this.addImprovement("/#suggestions;add")},addObservation:function(){this.addImprovement("/#behaviorObsCards;add")},addImprovement:function(e){var t=this.model.get("operator");t=t&&t.id?{id:t.id,text:t.label.replace(/\s+\(.*?\)$/,"")}:null,e+="?standalone=1&operator="+btoa(encodeURIComponent(JSON.stringify(t)));var i=window.screen,r=i.availWidth>1350?1300:.7*i.availWidth,o=.8*i.availHeight,a=Math.floor((i.availWidth-r)/2),s="resizable,scrollbars,location=no,top="+Math.min(100,Math.floor((i.availHeight-o)/2))+",left="+a+",width="+Math.floor(r)+",height="+Math.floor(o);window.open(e,"WMES_IMPROVEMENT",s)||n.msg.show({type:"error",time:3e3,text:this.t("controls:msg:popup")})},unlock:function(){if(this.model.isLocked()){if(!this.socket.isConnected())return n.msg.show({type:"warning",time:2e3,text:this.t("controls:msg:sync:noConnection")});var e=new u({model:this.model,embedded:this.options.embedded,vkb:this.options.vkb});n.showDialog(e,this.t("unlockDialog:title:unlock"))}},lock:function(){if(!this.socket.isConnected())return n.msg.show({type:"warning",time:2e3,text:this.t("controls:msg:sync:noConnection")});if(!this.model.isLocked()){var e=new c({model:this.model,embedded:this.options.embedded,vkb:this.options.vkb});n.showDialog(e,this.t("unlockDialog:title:lock"))}},showMor:function(){var e=this.mor||new o,t=new a({editable:!1,model:e});if(e.users.length)return n.showDialog(t);var i=this.$id("mor").addClass("disabled");i.find(".fa").removeClass("fa-group").addClass("fa-spinner fa-spin"),this.promised(e.fetch()).done(function(){n.showDialog(t)}).always(function(){i.removeClass("disabled").find(".fa").removeClass("fa-spinner fa-spin").addClass("fa-group")}),this.mor=e},showComponentLabels:function(){var e=new l({model:this.model,vkb:this.options.vkb,embedded:this.options.embedded});n.showDialog(e,this.t("componentLabels:title"))},toggleExtraPsn:function(){s.toggleExtraPsn(),this.model.trigger("message:show",{type:"info",text:this.t("snMessage:extraPsn:scan"),time:-1}),this.listenToOnce(this.model,"message:hidden",function(){s.toggleExtraPsn()})}})}),define("app/production/templates/personnelPicker",["underscore","jquery","app/i18n","app/time","app/user","app/core/util/forms"],function(_,$,t,time,user,forms){return function anonymous(locals,escapeFn,include,rethrow){escapeFn=escapeFn||function(e){return void 0==e?"":String(e).replace(_MATCH_HTML,encode_char)};var _ENCODE_HTML_RULES={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&#34;","'":"&#39;"},_MATCH_HTML=/[&<>'"]/g;function encode_char(e){return _ENCODE_HTML_RULES[e]||e}var __output="";function __append(e){void 0!==e&&null!==e&&(__output+=e)}with(locals||{})__append('<form class="production-personnelPicker">\n  '),offline&&(__append('\n  <p class="message message-inline message-warning">'),__append(t("personnelPicker:offline:warning")),__append("</p>\n  ")),__append('\n  <div class="form-group">\n    <label for="'),__append(id("user")),__append('">'),__append(escapeFn(label)),__append('</label>\n    <input id="'),__append(id("user")),__append('" class="form-control" type="text" autocomplete="new-password" data-vkb="'),__append(offline?"numeric":"alpha"),__append('">\n  </div>\n  <div id="'),__append(id("list")),__append('" class="production-form-btn-group">\n    <label>'),__append(t("personnelPicker:recent")),__append('</label>\n    <div class="btn-group-vertical"><p><i class="fa fa-spinner fa-spin"></i></p></div>\n  </div>\n  <div class="form-actions">\n    <button type="submit" class="btn btn-lg btn-primary">'),__append(t("personnelPicker:submit")),__append('</button>\n    <button type="button" class="cancel btn btn-lg btn-link">'),__append(t("personnelPicker:cancel")),__append("</button>\n  </div>\n</form>\n");return __output}}),define("app/production/views/PersonnelPickerView",["underscore","app/i18n","app/viewport","app/core/View","app/users/util/setUpUserSelect2","app/production/templates/personnelPicker"],function(e,t,n,i,r,o){"use strict";return i.extend({template:o,dialogClassName:"production-modal",localTopics:{"socket.connected":"render","socket.disconnected":"render"},events:{"keypress .select2-container":function(e){13===e.which&&(this.$el.submit(),e.preventDefault())},"click .btn[data-id]":function(e){this.trigger("userPicked",{id:e.currentTarget.dataset.id,label:e.currentTarget.textContent.trim()})},"input #-user":function(){this.options.embedded&&this.onVkbValueChange()},submit:function(e){e.preventDefault();var t=this.$(".btn-primary")[0];if(!t.disabled){t.disabled=!0;var n={id:null,label:null};if(this.socket.isConnected()){if(this.options.embedded)return void this.$(".btn[data-id]").first().click();var i=this.$id("user").select2("data");i&&(n.id=i.id,n.label=i.text)}else n.label=this.$id("user").val().trim().replace(/[^0-9]+/g,"");this.trigger("userPicked",null!==n.label&&n.label.length?n:null)}}},initialize:function(){this.lastPhrase="",this.lastUsers=[],this.searchReq=null},destroy:function(){this.options.vkb&&this.options.vkb.hide()},getTemplateData:function(){var e=!this.socket.isConnected(),t=e?"offline":this.options.embedded?"embedded":"online";return{offline:e,label:this.t("personnelPicker:"+t+":label")}},afterRender:function(){this.setUpField(),this.setUpList()},onDialogShown:function(){this.$id("user").focus().select2("focus")},setUpField:function(){if(this.options.embedded)return this.setUpEmbeddedField();var e=this.$id("user");this.socket.isConnected()?(r(e.removeClass("form-control"),{dropdownCssClass:"production-dropdown"}),e.select2("focus")):e.focus()},setUpEmbeddedField:function(){this.options.vkb.show(this.$id("user").addClass("is-embedded")[0],this.onVkbValueChange.bind(this))},onVkbValueChange:function(){var e=!this.socket.isConnected(),n=this.$id("user").val();n=e?n.replace(/[^0-9]+/g,""):r.transliterate(n);var i=this.$id("list"),o="",a="";(!i.length||n.length<3&&this.options.vkb)&&this.options.vkb.enableKeys(),i.length&&(n.length?(o="matches",(a=this.buildPersonnelList(n)).length||(a='<p><i class="fa fa-spinner fa-spin"></i></p>')):(o="recent",a=this.recentHtml||"<p>"+t("production","personnelPicker:notFound")+"</p>"),i.find("label").html(t("production","personnelPicker:"+o)),i.find("div").html(a),i.removeClass("hidden"))},setUpList:function(){var n=this,i=n.$id("list");if(!this.socket.isConnected())return i.remove();n.recentHtml="",this.ajax({url:"/production/getRecentPersonnel",data:{type:this.options.type,prodLine:this.model.prodLine.id,shift:this.model.get("shift")}}).success(function(t){var r="";t.forEach(function(t){r+='<button type="button" class="btn btn-lg btn-default" data-id="'+t._id+'">'+e.escape(t.label)+"</button>"}),r.length&&(i.find(".btn-group-vertical").html(r),n.recentHtml=r,n.options.vkb&&n.options.vkb.reposition())}).always(function(){var e=i.find(".fa-spinner");e.length&&e.replaceWith(t("production","personnelPicker:notFound"))})},buildPersonnelList:function(e){var n=this;if(e.length<3)return"<p>"+t("production","personnelPicker:tooShort")+"</p>";var i=e.substring(0,3);return i===n.lastPhrase?n.searchReq?"":this.buildFilteredPersonnelList():(n.searchReq&&n.searchReq.abort(),n.searchReq=this.ajax({url:"/users?select(firstName,lastName,searchName,personnelId)&sort(searchName)&limit(999)&searchName=regex="+encodeURIComponent("^"+e)}),n.searchReq.fail(function(){n.$(".fa-spin").removeClass("fa-spin")}),n.searchReq.done(function(e){n.lastUsers=e.collection||[],n.$id("list").removeClass("hidden").find("div").html(n.buildFilteredPersonnelList()),n.options.vkb&&n.options.vkb.reposition()}),n.searchReq.always(function(){n.searchReq=null}),n.lastPhrase=i,"")},buildFilteredPersonnelList:function(){var n=r.transliterate(this.$id("user").val()||""),i={},o="";return this.lastUsers.filter(function(e){return 0===e.searchName.indexOf(n)}).forEach(function(t){var r=t.lastName||"";t.firstName.length&&(r.length&&(r+=" "),r+=t.firstName),t.personnelId&&(r.length?r+=" ("+t.personnelId+")":r=t.personnelId),o+='<button type="button" class="btn btn-lg btn-default" data-id="'+t._id+'">'+e.escape(r)+"</button>";var a=t.searchName.substr(n.length,1);a&&(i[a]=!0)}),this.options.vkb&&this.options.vkb.disableKeys(i),o.length?o:"<p>"+t("production","personnelPicker:notFound")+"</p>"}})}),define("app/production/templates/multiPersonnelPicker",["underscore","jquery","app/i18n","app/time","app/user","app/core/util/forms"],function(_,$,t,time,user,forms){return function anonymous(locals,escapeFn,include,rethrow){escapeFn=escapeFn||function(e){return void 0==e?"":String(e).replace(_MATCH_HTML,encode_char)};var _ENCODE_HTML_RULES={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&#34;","'":"&#39;"},_MATCH_HTML=/[&<>'"]/g;function encode_char(e){return _ENCODE_HTML_RULES[e]||e}var __output="";function __append(e){void 0!==e&&null!==e&&(__output+=e)}with(locals||{})__append('<form class="production-multiPersonnelPicker">\n  <div class="production-multiPersonnelPicker-picked">\n    <div class="production-form-btn-group">\n      <label>'),__append(t("multiPersonnelPicker:picked")),__append('</label>\n      <div id="'),__append(id("picked-list")),__append('" class="btn-group-vertical"><p>'),__append(t("multiPersonnelPicker:empty")),__append('</p></div>\n    </div>\n    <div class="form-actions" style="display: flex">\n      <button id="'),__append(id("picked-submit")),__append('" type="submit" class="btn btn-lg btn-primary">'),__append(t("multiPersonnelPicker:submit")),__append('</button>\n      <button type="button" class="cancel btn btn-lg btn-link">'),__append(t("multiPersonnelPicker:cancel")),__append('</button>\n      <button id="'),__append(id("picked-switch")),__append('" type="button" class="btn btn-lg btn-default" style="margin-left: auto"><i class="fa fa-plus"></i></button>\n    </div>\n  </div>\n  <div class="production-multiPersonnelPicker-picker">\n    '),offline&&(__append('\n    <p class="message message-inline message-warning">'),__append(t("multiPersonnelPicker:offline:warning")),__append("</p>\n    ")),__append('\n    <div class="form-group">\n      <label for="'),__append(id("picker-user")),__append('">'),__append(escapeFn(label)),__append('</label>\n      <input id="'),__append(id("picker-user")),__append('" class="form-control" type="text" autocomplete="new-password" data-vkb="'),__append(offline?"numeric":"alpha"),__append('">\n    </div>\n    <div id="'),__append(id("picker-list")),__append('" class="production-form-btn-group">\n      <label>'),__append(t("multiPersonnelPicker:recent")),__append('</label>\n      <div class="btn-group-vertical"><p><i class="fa fa-spinner fa-spin"></i></p></div>\n    </div>\n    <div class="form-actions">\n      <button id="'),__append(id("picker-submit")),__append('" type="button" class="btn btn-lg btn-default">'),__append(t("multiPersonnelPicker:pick")),__append('</button>\n      <button id="'),__append(id("picker-switch")),__append('" type="button" class="btn btn-lg btn-link">'),__append(t("multiPersonnelPicker:back")),__append("</button>\n    </div>\n  </div>\n</form>\n");return __output}}),define("app/production/views/MultiPersonnelPickerView",["underscore","app/i18n","app/viewport","app/core/View","app/users/util/setUpUserSelect2","app/production/templates/multiPersonnelPicker"],function(e,t,n,i,r,o){"use strict";return i.extend({template:o,dialogClassName:"production-modal production-multiPersonnelPicker-modal",localTopics:{"socket.connected":"render","socket.disconnected":"render"},events:{"keypress .select2-container":function(e){13===e.which&&(this.$el.submit(),e.preventDefault())},"focus #-picker-user":function(){this.setUpEmbeddedField()},"click #-picked-switch":function(){var e=this.$id("picker-user");e.val("").select2("data",[]),this.options.embedded?this.onVkbValueChange():this.setUpList(),this.$el.addClass("is-picking"),e.focus().select2("focus")},"click #-picker-switch":function(){this.switchToPicked()},"click #-picker-submit":function(){var e=this;if(e.socket.isConnected())if(e.options.embedded){var t=e.$id("picker-list").find(".active");t.length&&e.addUser({id:t[0].dataset.id,label:t.text().trim()})}else(e.$id("picker-user").select2("data")||[]).forEach(function(t){e.addUser({id:t.id,label:t.text})});else{var n=e.$id("picker-user").val().replace(/[^0-9]+/g,"");n.length&&e.addUser({id:null,label:n})}e.switchToPicked()},'click .btn[data-action="removeUser"]':function(e){this.$(e.currentTarget).parent().remove(),this.togglePickedSwitch();var n=this.$id("picked-list");n[0].childElementCount||n.html("<p>"+t("production","multiPersonnelPicker:empty")+"</p>")},"click .btn[data-id]":function(e){var t=this.$(e.currentTarget);t.parent().find(".active").removeClass("active"),t.addClass("active")},"input #-picker-user":function(){this.options.embedded&&this.onVkbValueChange()},"click .btn[value]":function(e){var t=this.$(e.currentTarget).parent().detach();this.$id("picked-list").prepend(t)},submit:function(e){e.preventDefault();var t=this.$id("picked-submit")[0];if(!t.disabled){t.disabled=!0;var n=[];this.$(".btn[value]").each(function(){var e=this.value,t=this.textContent.trim();n.push({id:e===t?null:e,label:t})}),this.trigger("usersPicked",n)}}},initialize:function(){this.lastPhrase="",this.lastUsers=[],this.searchReq=null},destroy:function(){this.options.vkb&&this.options.vkb.hide()},getTemplateData:function(){var e=!this.socket.isConnected(),n=e?"offline":this.options.embedded?"embedded":"online";return{offline:e,label:t("production","multiPersonnelPicker:"+n+":label")}},afterRender:function(){this.setUpField(),this.setUpList();var e=this.model.get(this.options.type),t=this.model.get(this.options.type+"s");Array.isArray(t)||(t=[]),e&&!t.length&&(this.model[this.options.type+"s"]=t=[e]),t.forEach(this.addUser,this),0===t.length&&this.$id("picked-switch").click()},setUpField:function(){if(!this.options.embedded){var e=this.$id("picker-user");if(this.socket.isConnected()){var t=this.$id("picked-list");r(e.removeClass("form-control"),{multiple:!0,sortable:!0,dropdownCssClass:"production-dropdown",userFilter:function(e){return 0===t.find('.btn[value="'+e._id+'"]').length}}),e.select2("focus")}else e.focus()}},setUpEmbeddedField:function(){this.options.vkb&&this.options.vkb.show(this.$id("picker-user").addClass("is-embedded")[0],this.onVkbValueChange.bind(this))},onVkbValueChange:function(){var e=!this.socket.isConnected(),n=this.$id("picker-user").val();n=e?n.replace(/[^0-9]+/g,""):r.transliterate(n);var i=this.$id("picker-list"),o="",a="";(!i.length||n.length<3&&this.options.vkb)&&this.options.vkb.enableKeys(),i.length&&(n.length?(o="matches",(a=this.buildPersonnelList(n)).length||(a='<p><i class="fa fa-spinner fa-spin"></i></p>')):(o="recent",a=this.recentHtml||"<p>"+t("production","multiPersonnelPicker:notFound")+"</p>"),i.find("label").html(t("production","multiPersonnelPicker:"+o)),i.find("div").html(a).find(".btn").first().click(),i.removeClass("hidden"),this.options.vkb&&this.options.vkb.reposition())},setUpList:function(){var n=this,i=n.$id("picker-list");if(!n.socket.isConnected())return i.remove();if(void 0===n.recentHtml)n.recentHtml="",n.ajax({url:"/production/getRecentPersonnel",data:{type:n.options.type+"s",prodLine:n.model.prodLine.id,shift:n.model.get("shift")}}).success(function(t){t.sort(function(e,t){return e.label.localeCompare(t.label,void 0,{numeric:!0,ignorePunctuation:!0})}),t.forEach(function(t){n.recentHtml+='<button type="button" class="btn btn-lg btn-default" data-id="'+t._id+'">'+e.escape(t.label)+"</button>"})}).always(function(){n.setUpList()});else if(n.recentHtml.length){var r=n.$id("pickedList");i.find(".btn-group-vertical").html(n.recentHtml).children().each(function(){r.find('.btn[value="'+this.dataset.id+'"]').length&&this.parentNode.removeChild(this)}),n.options.vkb&&n.options.vkb.reposition()}else{var o=i.find(".fa-spinner");o.length&&o.replaceWith(t("production","multiPersonnelPicker:notFound"))}},buildPersonnelList:function(e){var n=this;if(e.length<3)return"<p>"+t("production","multiPersonnelPicker:tooShort")+"</p>";var i=e.substring(0,3);return i===n.lastPhrase?n.searchReq?"":this.buildFilteredPersonnelList():(n.searchReq&&n.searchReq.abort(),n.searchReq=this.ajax({url:"/users?select(firstName,lastName,searchName,personnelId)&sort(searchName)&limit(999)&active=true&searchName=regex="+encodeURIComponent("^"+e)}),n.searchReq.fail(function(){n.$(".fa-spin").removeClass("fa-spin")}),n.searchReq.done(function(e){n.lastUsers=e.collection||[];var t=n.$id("picker-list").removeClass("hidden").find("div").html(n.buildFilteredPersonnelList());n.options.vkb&&n.options.vkb.reposition(),t.first().click()}),n.searchReq.always(function(){n.searchReq=null}),n.lastPhrase=i,"")},buildFilteredPersonnelList:function(){var n=r.transliterate(this.$id("picker-user").val()||""),i={};this.$id("picked-list").find(".btn[value]").each(function(){i[this.value]=!0});var o={},a="";return this.lastUsers.filter(function(e){return!i[e._id]&&0===e.searchName.indexOf(n)}).forEach(function(t){var i=t.lastName||"";t.firstName.length&&(i.length&&(i+=" "),i+=t.firstName),t.personnelId&&(i.length?i+=" ("+t.personnelId+")":i=t.personnelId),a+='<button type="button" class="btn btn-lg btn-default" data-id="'+t._id+'">'+e.escape(i)+"</button>";var r=t.searchName.substr(n.length,1);r&&(o[r]=!0)}),this.options.vkb&&this.options.vkb.disableKeys(o),a.length?a:"<p>"+t("production","multiPersonnelPicker:notFound")+"</p>"},addUser:function(t){var n=this.$id("picked-list"),i=t.id||t.label;if(!n.find('.btn[value="'+i+'"]').length){var r='<div class="production-form-btn-group-item"><button type="button" class="btn btn-default btn-lg" value="'+i+'">'+e.escape(t.label)+'</button><button type="button" class="btn btn-default btn-lg" data-action="removeUser"><i class="fa fa-times"></i></button></div>';"P"===n[0].firstElementChild.tagName&&n.html(""),n.append(r),this.togglePickedSwitch(),this.options.vkb&&this.options.vkb.reposition()}},togglePickedSwitch:function(){this.$id("picked-switch").prop("disabled",7===this.$id("picked-list")[0].childElementCount)},switchToPicked:function(){this.options.vkb&&this.options.vkb.hide(),this.$el.removeClass("is-picking")}})}),define("app/production/templates/header",["underscore","jquery","app/i18n","app/time","app/user","app/core/util/forms"],function(_,$,t,time,user,forms){return function anonymous(locals,escapeFn,include,rethrow){escapeFn=escapeFn||function(e){return void 0==e?"":String(e).replace(_MATCH_HTML,encode_char)};var _ENCODE_HTML_RULES={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&#34;","'":"&#39;"},_MATCH_HTML=/[&<>'"]/g;function encode_char(e){return _ENCODE_HTML_RULES[e]||e}var __output="";function __append(e){void 0!==e&&null!==e&&(__output+=e)}with(locals||{})__append('<div class="production-header">\n  <h1 class="production-pageHeader"></h1>\n  <div class="production-properties">\n    '),["currentTime","shift","orgUnit"].forEach(function(e){__append('\n    <div class="production-property production-property-'),__append(e),__append('">\n      <div class="production-property-name">'),__append(t("property:"+e)),__append('</div>\n      <div class="production-property-value"></div>\n    </div>\n    ')}),__append("\n    "),["master","leader","operator"].forEach(function(e){__append('\n    <div id="'),__append(id(e)),__append('" class="production-property production-property-'),__append(e),__append('">\n      <div class="production-property-name">'),__append(t("property:"+e)),__append('</div>\n      <div class="production-property-value is-editable"></div>\n    </div>\n    ')}),__append("\n  </div>\n</div>\n");return __output}}),define("app/production/views/ProductionHeaderView",["app/i18n","app/viewport","app/core/View","app/data/prodLog","app/orgUnits/util/renderOrgUnitPath","app/users/UserCollection","./PersonnelPickerView","./MultiPersonnelPickerView","app/production/templates/header"],function(e,t,n,i,r,o,a,s,u){"use strict";return n.extend({template:u,localTopics:{"divisions.synced":"updateOrgUnit","subdivisions.synced":"updateOrgUnit","mrpControllers.synced":"updateOrgUnit","prodFlows.synced":"updateOrgUnit","workCenters.synced":"updateOrgUnit","prodLines.synced":"updateOrgUnit","socket.connected":"fillPersonnelData"},events:{"click #-master":"showMasterPickerDialog","click #-leader":"showLeaderPickerDialog","click #-operator":"showOperatorPickerDialog"},initialize:function(){var e=this.model;this.listenTo(e.prodLine,"change:description",this.updatePageHeader),this.listenTo(e,"second",this.updateCurrentTime),this.listenTo(e,"change:shift",this.updateShift),this.listenTo(e,"change:master",this.updateMaster),this.listenTo(e,"change:leader",this.updateLeader),this.listenTo(e,"change:operator",this.updateOperator),this.listenTo(e,"locked unlocked",function(){this.updateMaster(),this.updateLeader(),this.updateOperator()})},afterRender:function(){this.$currentTime=this.$property("currentTime"),this.updatePageHeader(),this.updateCurrentTime(),this.updateShift(),this.updateOrgUnit(),this.updateMaster(),this.updateLeader(),this.updateOperator(),this.socket.isConnected()&&this.fillPersonnelData()},updatePageHeader:function(){this.$(".production-pageHeader").text(this.model.prodLine.get("description")||this.model.prodLine.id||"?")},updateCurrentTime:function(){this.$currentTime&&this.$currentTime.text(this.model.getCurrentTime())},updateShift:function(){var t=this.model.get("shift");t="number"==typeof t?e("core","SHIFT:"+t):"?",this.$property("shift").text(t)},updateOrgUnit:function(){this.$property("orgUnit").html(r(this.model.prodLine.getSubdivision(),!1,!1)||"?")},updateMaster:function(){this.updatePersonnel("master")},updateLeader:function(){this.updatePersonnel("leader")},updateOperator:function(){this.updatePersonnel("operator")},updatePersonnel:function(t){var n;if(!this.model.isLocked()){var i=this.model.get(t),r=i&&i.label?i.label:null;if(r){var o=r.match(/^(.*?) \(.*?\)$/);if(o&&(r=o[1]),"operator"===t){var a=this.model.get("operators");Array.isArray(a)&&a.length>1&&(r+=" +"+(a.length-1))}n=r+' <button class="btn btn-link">'+e("production","property:"+t+":change")+"</button>"}else n='<button class="btn btn-link">'+e("production","property:"+t+":noData:unlocked")+"</a>"}else n="?";this.$property(t).html(n)},$property:function(e){return this.$(".production-property-"+e+" .production-property-value")},showMasterPickerDialog:function(e){e&&(e.preventDefault(),e.target.blur()),t.currentDialog||this.showPickerDialog("master",this.model.changeMaster.bind(this.model))},showLeaderPickerDialog:function(e){e&&(e.preventDefault(),e.target.blur()),t.currentDialog||this.showPickerDialog("leader",this.model.changeLeader.bind(this.model))},showOperatorPickerDialog:function(e){e&&(e.preventDefault(),e.target.blur()),t.currentDialog||this.showMultiPickerDialog("operator",this.model.changeOperators.bind(this.model))},showPickerDialog:function(n,i){if(!this.model.isLocked()){var r=new a({type:n,embedded:this.options.embedded,vkb:this.options.vkb,model:this.model});this.listenTo(r,"userPicked",function(e){t.closeDialog();var r=this.model.get(n);null===r?null!==e&&i(e):(r!==e||e&&(e.id!==r.id||e.label!==r.label))&&i(e),this.$(".production-property-"+n+" .btn-link").focus()}),t.showDialog(r,e("production","personnelPicker:title:"+n))}},showMultiPickerDialog:function(n,i){if(!this.model.isLocked()){var r=new s({type:n,embedded:this.options.embedded,vkb:this.options.vkb,model:this.model});this.listenTo(r,"usersPicked",function(e){t.closeDialog(),i(e),this.$(".production-property-"+n+" .btn-link").focus()}),t.showDialog(r,e("production","multiPersonnelPicker:title:"+n))}},fillPersonnelData:function(){var e=[],t=[],n=this.model;["master","leader","operator"].forEach(function(i){var r=n.get(i);r&&null===r.id&&r.label.trim().length>0&&(e.push(r.label),t.push(i))}),e.length>0&&this.fillUserInfo(e,t)},fillUserInfo:function(e,t){if(i.isSyncing())return this.broker.subscribe("production.synced",this.fillPersonnelData.bind(this)).setLimit(1);var n=new o(null,{rqlQuery:{fields:{firstName:1,lastName:1,personnelId:1},selector:{name:e.length>1?"in":"eq",args:["personnelId",e.length>1?e:e[0]]}}}),r=this.model;this.promised(n.fetch()).then(function(){e.forEach(function(e,i){var o=n.findWhere({personnelId:e});o&&r.set(t[i],{id:o.id,label:o.get("firstName")+" "+o.get("lastName")})})})}})}),define("app/production/util/orderPickerHelpers",["underscore","jquery","app/viewport","app/i18n"],function(e,t,n,i){"use strict";return{createGetOrdersUrl:function(e,t){return function(n){var i=e.getOrderIdType();return t.attr("data-type",i),"/production/orders?"+i+"="+encodeURIComponent(n)}},setUpOrderSelect2:function(r,o,a,s){var u=this;function c(e){return-1!==e.laborTime&&""!==e.workCenter}r.removeClass("form-control").select2(e.assign({openOnEnter:null,allowClear:!1,minimumInputLength:6,ajax:{cache:!0,quietMillis:300,url:u.createGetOrdersUrl(a,r),results:function(e){return{results:(Array.isArray(e)?e:[]).map(function(e){return e.id=e._id,e.text=e._id+" - "+(e.description||e.name||"?"),e})}},transport:function(e){return t.ajax.apply(t,arguments).fail(function(){n.msg.show({type:"error",time:2e3,text:i("production","newOrderPicker:msg:searchFailure")}),e.success({collection:[]})})}}},s)),r.on("change",function(t){var n;n=Array.isArray(t.operations)?t.operations.filter(c):t.added&&Array.isArray(t.added.operations)?t.added.operations.filter(c):[],u.setUpOperationSelect2(o,n.map(function(e){return{id:e.no,text:e.no+" - "+e.name}}),s,!t.removed),n.length?o.select2("val",t.selectedOperationNo||u.getBestDefaultOperationNo(n)).select2("focus"):(t.selectedOperationNo&&o.val(t.selectedOperationNo),e.defer(function(){o.focus()}))})},setUpOperationSelect2:function(n,r,o,a){if(n.prev(".message-warning").remove(),a&&!r.length)return n.select2("destroy").addClass("form-control").val("").attr("title",""),void t('<p class="message message-inline message-warning"></p>').html(i("production","newOrderPicker:msg:noOperations")).insertBefore(n);n.removeClass("form-control").select2(e.assign({width:"100%",placeholder:" ",openOnEnter:null,allowClear:!1,minimumResultsForSearch:-1,data:r||[],shouldFocusInput:function(){return!0}},o))},selectOrder:function(t,n){if(n){var i=n.get("orderId"),r=n.get("orderData");i&&r&&(t.select2("data",{id:i,text:i+" - "+(r.description||r.name||"?"),sameOrder:!0}),t.trigger({type:"change",operations:e.values(r.operations),selectedOperationNo:n.get("operationNo")}))}},prepareOrderInfo:function(e,t){return delete t.__v,delete t.id,delete t.text,t._id&&("no"===e.getOrderIdType()?t.no=t._id:(t.no=null,t.nc12=t._id),delete t._id),t.operations=this.prepareOperations(t.operations),t},prepareOperations:function(t){if(Array.isArray(t)){var n={};return t.forEach(function(e){""===e.workCenter||-1===e.laborTime||n[e.no]||(n[e.no]=e)}),n}return e.isObject(t)?t:{}},getBestDefaultOperationNo:function(e){var t=this.getBestDefaultOperation(e);return t?t.no:null},getBestDefaultOperation:function(e){return Array.isArray(e)&&0!==e.length?1===e.length?e[0]:e.map(function(e){var t=0;return e.laborTime>0&&(t+=1),e.workCenter&&(t+=1),/^monta/i.test(e.name)&&(t+=1),/monta/i.test(e.name)&&(t+=2),/g..wn/i.test(e.name)&&(t+=1),/pak/i.test(e.name)&&(t+=1),/kj/i.test(e.name)&&(t+=1),/opra/i.test(e.name)&&(t+=1),/z.o.en/i.test(e.name)&&(t+=1),{op:e,rank:t}}).sort(function(e,t){return t.rank-e.rank}).shift().op:null}}}),define("app/production/util/limitQuantityDone",["underscore","jquery","app/socket","app/i18n","app/viewport"],function(e,t,n,i,r){"use strict";var o={};return function(u,c){if(u.ft={checkCredentials:null},c.id&&n.isConnected()){var l=u.$id("submit").prop("disabled",!0),d=[function(e,t){var n="/xiconf/orders/"+t.get("orderId");return e.ajax({url:n,timeout:1e4})}(u,c),function(e,t){var n="/prodSerialNumbers?limit(1)&prodShiftOrder="+t.id;return e.ajax({url:n,timeout:1e4}).done(function(t){t&&t.totalCount&&a(e,t.totalCount,null)})}(u,c)];c.get("orderId")&&!o[c.get("prodLine")]&&d.push(function(t,n){var i="/orders/"+n.get("orderId")+"?select(qty,qtyMax,qtyDone)";return t.ajax({url:i,timeout:1e4}).done(function(i){var r=n.getOperation()||{no:n.get("operationNo"),qty:i.qty};e.isEmpty(i.qtyDone)&&(i.qtyDone={total:0,byLine:{},byOperation:{}}),i.qtyDone.byOperation[r.no]||(i.qtyDone.byOperation[r.no]=0),e.isEmpty(i.qtyMax)&&(i.qtyMax={}),i.qtyMax[r.no]||(i.qtyMax[r.no]=i.qty);var o=n.get("quantityDone"),s=i.qtyDone.byOperation[r.no],u=s-(s>=o?o:0),c=i.qtyMax[r.no],l=Math.max(0,c-u);a(t,0,l)})}(u,c)),t.when.apply(t,d).always(function(t){!function(t,o){if(!o)return s(t);var a=e.find(o.items,function(e){return"ft"===e.kind});if(!a||a.quantityDone>=a.quantityTodo)return s(t);var u=t.$id("ft").removeClass("hidden");u.on("input",c),u.on("change",c),t.options.vkb&&t.options.vkb.reposition();function c(){t.ft.checkCredentials=function(t){var o=t.$id("ft-login").val(),a=t.$id("ft-password").val(),u=t.ajax({method:"POST",url:"/login?login=0",data:JSON.stringify({login:o,password:a})});u.fail(function(){var e=t.$id("ft-login");e.length&&(u.status>=400&&u.status<500?(t.ft.checkCredentials=null,e[0].setCustomValidity(i("production","ft:invalidCredentials"))):n.isConnected()?r.msg.show({type:"error",time:5e3,text:i("production","ft:requestFailure")}):(t.ft.checkCredentials=null,s(t)))}),u.done(function(n){n.super||/(engineer|leader)/i.test(n.prodFunction)||e.includes(n.privileges,"OPERATOR:ORDER_UNLOCK")?t.ft.checkCredentials=null:t.$id("ft-login")[0].setCustomValidity(i("production","ft:noPrivileges"))}),u.always(function(){t.$id("submit").prop("disabled",!1).click()})}.bind(null,t),u.find("input").each(function(){this.setCustomValidity("")})}}(u,t&&t[0]),l.prop("disabled",!1)})}else s(u)};function a(e,t,n){var i=e.$id("quantityDone"),r=parseInt(i.attr("min"),10),o=parseInt(i.attr("max"),10);isNaN(r)&&(r=0),isNaN(o)&&(o=9999),null===n&&(n=o),null===t&&(t=r),t>n&&(t=n),i.attr("min",t).attr("max",n).trigger("input")}function s(e){e.$id("ft").remove()}}),define("app/production/templates/newOrderPicker",["underscore","jquery","app/i18n","app/time","app/user","app/core/util/forms"],function(_,$,t,time,user,forms){return function anonymous(locals,escapeFn,include,rethrow){escapeFn=escapeFn||function(e){return void 0==e?"":String(e).replace(_MATCH_HTML,encode_char)};var _ENCODE_HTML_RULES={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&#34;","'":"&#39;"},_MATCH_HTML=/[&<>'"]/g;function encode_char(e){return _ENCODE_HTML_RULES[e]||e}var __output="";function __append(e){void 0!==e&&null!==e&&(__output+=e)}with(locals||{})__append('<form class="production-newOrderPicker" autocomplete="off">\n  '),replacingOrder&&(__append('\n  <p class="message message-inline message-warning">'),__append(t("newOrderPicker:checkData:warning")),__append("</p>\n  "),spigot&&(__append('\n  <div id="'),__append(id("spigot")),__append('" class="form-group">\n    <label for="'),__append(id("spigot-nc12")),__append('">'),__append(t("endWorkDialog:spigot:nc12")),__append('</label>\n    <input id="'),__append(id("spigot-nc12")),__append('" class="form-control production-spigot-nc12 '),__append(embedded?"is-embedded":""),__append('" type="text" autocomplete="new-password" value="" placeholder="'),__append(t("endWorkDialog:spigot:placeholder")),__append('" required>\n  </div>\n  ')),__append('\n  <div class="form-group">\n    <label for="'),__append(id("quantityDone")),__append('">'),__append(t("newOrderPicker:quantityDone")),__append('</label>\n    <input id="'),__append(id("quantityDone")),__append('" class="form-control small '),__append(embedded?"is-embedded":""),__append('" type="'),__append(embedded?"text":"number"),__append('" value="'),__append(quantityDone),__append('"min="0" max="'),__append(maxQuantityDone),__append('" pattern="^[0-9]{1,3}$" data-ignore-key="1" data-vkb="numeric">\n  </div>\n  <div class="form-group">\n    <label for="'),__append(id("workerCount")),__append('">'),__append(t("newOrderPicker:workerCount")),__append('</label>\n    <input id="'),__append(id("workerCount")),__append('" class="form-control small '),__append(embedded?"is-embedded":""),__append('" type="'),__append(embedded?"text":"number"),__append('" value="'),__append(workerCount.toLocaleString()),__append('" min="1" max="'),__append(maxWorkerCount),__append('" pattern="^[0-9]{1,2}([,.][0-9]{1})?$" data-ignore-key="1" data-vkb="numeric decimal">\n  </div>\n  <div id="'),__append(id("ft")),__append('" class="hidden" style="margin-bottom: 15px">\n    <p class="message message-inline message-error">'),__append(t("ft:warning")),__append('</p>\n    <div class="form-group">\n      <label for="'),__append(id("ft-login")),__append('">'),__append(t("ft:login")),__append('</label>\n      <input id="'),__append(id("ft-login")),__append('" class="form-control is-embedded" type="text" required data-ignore-key="1" data-vkb="alpha numeric">\n    </div>\n    <div class="form-group">\n      <label for="'),__append(id("ft-password")),__append('">'),__append(t("ft:password")),__append('</label>\n      <input id="'),__append(id("ft-password")),__append('" class="form-control is-embedded" type="password" required autocomplete="new-password" data-ignore-key="1" data-vkb="alpha numeric extended">\n    </div>\n  </div>\n  <div class="modal-header">\n    <h3 class="modal-title">'),__append(t("newOrderPicker:title")),__append("</h3>\n  </div>\n  ")),__append("\n  "),correctingOrder||(__append("\n  "),offline?(__append('\n  <p class="message message-inline message-warning">'),__append(t("newOrderPicker:offline:warning:"+orderIdType)),__append("</p>\n  ")):(__append('\n  <p class="message message-inline message-info">'),__append(t("newOrderPicker:online:info:"+orderIdType)),__append("</p>\n  ")),__append("\n  ")),__append("\n  "),correctingOrder||!embedded?(__append('\n  <div class="form-group">\n    <label for="'),__append(id("order")),__append('">'),__append(t("newOrderPicker:order:label:"+orderIdType)),__append('</label>\n    <input id="'),__append(id("order")),__append('" class="form-control '),__append(embedded?"is-embedded":""),__append('" type="text" autocomplete="new-password" placeholder="'),__append(orderPlaceholder),__append('" maxlength="'),__append(orderMaxLength),__append('" data-ignore-key="1" data-vkb="numeric" '),__append(embedded||offline?"required":""),__append(">\n  </div>\n  ")):(__append('\n  <div class="production-newOrderPicker-row">\n    <div class="form-group">\n      <label for="'),__append(id("order")),__append('">'),__append(t("newOrderPicker:order:label:"+orderIdType)),__append('</label>\n      <input id="'),__append(id("order")),__append('" class="form-control '),__append(embedded?"is-embedded":""),__append('" type="text" autocomplete="new-password" placeholder="'),__append(orderPlaceholder),__append('" maxlength="'),__append(orderMaxLength),__append('" data-ignore-key="1" data-vkb="numeric" '),__append(embedded||offline?"required":""),__append('>\n    </div>\n    <div class="form-group">\n      <label for="'),__append(id("newWorkerCount")),__append('">'),__append(t("newOrderPicker:newWorkerCount")),__append('</label>\n      <input id="'),__append(id("newWorkerCount")),__append('" class="form-control '),__append(embedded?"is-embedded":""),__append('" type="text" autocomplete="new-password" maxlength="3" min="1" max="15" pattern="^[0-9]{1,2}([,.][0-9]{1})?$" data-ignore-key="1" data-vkb="numeric decimal" required>\n    </div>\n  </div>\n  ')),__append("\n  "),!offline&&embedded?(__append('\n  <div id="'),__append(id("operationGroup")),__append('" class="production-form-btn-group">\n    <label>'),__append(t("newOrderPicker:operation:label:online")),__append('</label>\n    <div class="btn-group-vertical"><p>'),__append(t("newOrderPicker:order:tooShort")),__append("</p></div>\n  </div>\n  ")):(__append('\n  <div id="'),__append(id("operationGroup")),__append('" class="form-group">\n    <label for="'),__append(id("operation")),__append('">'),__append(t("newOrderPicker:operation:label:"+(offline?"offline":"online"))),__append('</label>\n    <input id="'),__append(id("operation")),__append('" class="form-control '),__append(embedded?"is-embedded":""),__append('" type="text" autocomplete="new-password" placeholder="'),__append(operationPlaceholder),__append('" maxlength="4" pattern="^[0-9]+$" data-ignore-key="1" data-vkb="numeric">\n  </div>\n  ')),__append('\n  <div class="form-actions">\n    <button id="'),__append(id("submit")),__append('" type="submit" class="btn btn-lg btn-success">\n      '),__append(submitLabel),__append('\n    </button>\n    <button type="button" class="cancel btn btn-lg btn-link">'),__append(t("newOrderPicker:cancel")),__append("</button>\n  </div>\n</form>\n");return __output}}),define("app/production/views/NewOrderPickerView",["underscore","jquery","app/i18n","app/viewport","app/core/View","app/orders/util/resolveProductName","../util/orderPickerHelpers","../util/limitQuantityDone","app/production/templates/newOrderPicker"],function(e,t,n,i,r,o,a,s,u){"use strict";return r.extend({template:u,dialogClassName:function(){var e="production-modal production-newOrderPickerDialog";return this.options.correctingOrder?e+=" is-correcting":this.model.hasOrder()&&(e+=" is-replacing"),e},localTopics:{"socket.connected":"render","socket.disconnected":"render"},remoteTopics:function(){var e={};return e["production.spigotCheck.scanned."+this.model.prodLine.id]="onSpigotScanned",e},events:{"focus [data-vkb]":function(e){this.options.embedded&&this.options.vkb&&this.options.vkb.show(e.target,this.onVkbValueChange)},"focus #-spigot-nc12":function(){this.options.embedded&&this.options.vkb&&this.options.vkb.hide()},"click .btn[data-operation]":function(e){e.currentTarget.classList.contains("active")||(this.$(".active[data-operation]").removeClass("active"),e.currentTarget.classList.add("active"),this.updateNewWorkerCount())},"input #-order":function(e){this.options.embedded&&this.onVkbValueChange(e.target)},'input input[type="text"][max]':"checkMinMaxValidity",'blur input[type="text"][max]':"checkMinMaxValidity","keypress .select2-container":function(e){if(13===e.which)return this.$el.submit(),!1},submit:function(e){e.preventDefault();var t=this.$id("submit")[0];if(!t.disabled){t.disabled=!0;var n=this.$id("spigot-nc12");if(n.length){var i=n.val().match(/([0-9]{12})/),r=i?i[1]:"";if(!r.length||!this.model.checkSpigot(null,r))return n[0].setCustomValidity(this.t("newOrderPicker:spigot:invalid")),void(this.timers.submit=setTimeout(function(){t.disabled=!1,t.click()},1,this))}if(this.ft&&this.ft.checkCredentials)return this.ft.checkCredentials();this.socket.isConnected()?this.options.embedded?this.handleEmbeddedPick(t):this.handleOnlinePick(t):this.handleOfflinePick(t)}}},initialize:function(){this.onVkbValueChange=this.onVkbValueChange.bind(this),this.lastKeyPressAt=0,this.lastPhrase="",this.lastOrders=[],this.searchReq=null,this.options.correctingOrder&&this.lastOrders.push(this.model.prodShiftOrder.get("orderData")),this.listenTo(this.model.prodShiftOrder,"qtyMaxChanged",this.limitQuantityDone),t(window).on("keydown."+this.idPrefix,this.onKeyDown.bind(this)).on("keypress."+this.idPrefix,this.onKeyPress.bind(this))},destroy:function(){t(window).off("."+this.idPrefix),this.options.vkb&&this.options.vkb.hide(),this.$id("spigot-nc12").length&&this.pubsub.publish("production.spigotCheck.aborted."+this.model.prodLine.id,{prodLineId:this.model.prodLine.id})},getTemplateData:function(){var e=this.model,t=e.prodShiftOrder,n=e.getOrderIdType(),i=!this.options.correctingOrder&&e.hasOrder(),r=!!this.options.correctingOrder,o=i?":replacing":r?":correcting":"";return{embedded:this.options.embedded,spigot:e.settings.getValue("spigotFinish")&&!!t.get("spigot"),offline:!this.socket.isConnected(),replacingOrder:i,correctingOrder:r,quantityDone:t.get("quantityDone")||0,workerCount:t.getWorkerCountForEdit(),orderIdType:n,maxQuantityDone:t.getMaxQuantityDone(),maxWorkerCount:t.getMaxWorkerCount(),orderPlaceholder:this.options.embedded?"no"===n?"000000000":"000000000000":this.t("newOrderPicker:order:placeholder:"+n),orderMaxLength:"no"===n?9:12,operationPlaceholder:this.options.embedded?"0000":this.t("newOrderPicker:operation:placeholder"),submitLabel:this.t("newOrderPicker:submit"+o)}},afterRender:function(){this.socket.isConnected()?(this.setUpOrderSelect2(),this.setUpOperationSelect2(),this.options.correctingOrder?this.selectCurrentOrder():this.options.order?(this.selectSpecifiedOrder(),this.limitQuantityDone()):(this.selectNextOrder(),this.limitQuantityDone())):this.options.correctingOrder&&(this.$id("order").val(this.model.prodShiftOrder.get("orderId")),this.$id("operation").val(this.model.prodShiftOrder.get("operationNo"))),this.notifySpigotCheckRequest()},notifySpigotCheckRequest:function(){this.$id("spigot-nc12").length&&(clearTimeout(this.timers.notifySpigotCheckRequest),this.timers.notifySpigotCheckRequest=setTimeout(this.notifySpigotCheckRequest.bind(this),5e3),this.pubsub.publish("production.spigotCheck.requested."+this.model.prodLine.id,{prodLine:this.model.prodLine.id,component:this.model.prodShiftOrder.get("spigot").component,orderNo:this.model.prodShiftOrder.get("orderId"),source:"newOrder"}))},onSpigotScanned:function(e){var t=this.$id("spigot-nc12").val(e.nc12);if(t.length){t[0].setCustomValidity("");var n=this.model.prodLine.id,i=this.model.prodShiftOrder,r=i.get("spigot");r&&(this.model.checkSpigotValidity(e.nc12,r.component.nc12)?this.pubsub.publish("production.spigotCheck.success."+n,{prodLine:n,component:r.component,orderNo:i.get("orderId"),input:e.nc12,nc12:r.component.nc12,source:"newOrder"}):this.pubsub.publish("production.spigotCheck.failure."+n,{prodLine:n,component:r.component,orderNo:i.get("orderId"),input:e.nc12,source:"newOrder"}))}},limitQuantityDone:function(){s(this,this.model.prodShiftOrder)},onDialogShown:function(e){this.closeDialog=e.closeDialog.bind(e),this.focusFirstInput()},closeDialog:function(){},focusFirstInput:function(){this.$id("spigot-nc12").length?this.$id("spigot-nc12").focus():!this.options.embedded&&this.socket.isConnected()?this.$id("order").select2("focus"):this.$id("order").select()},setUpOrderSelect2:function(){if(!this.options.embedded)return a.setUpOrderSelect2(this.$id("order"),this.$id("operation"),this.model,{dropdownCssClass:"production-dropdown"})},setUpOperationSelect2:function(){if(!this.options.embedded)return a.setUpOperationSelect2(this.$id("operation"),[],{dropdownCssClass:"production-dropdown"})},selectCurrentOrder:function(){if(this.options.embedded){var e=this.model.prodShiftOrder;this.$id("order").val(e.get("orderId")),this.$id("operationGroup").find("div").html(this.buildOrderOperationList(e.get("orderData"),e.get("operationNo"))),i.adjustDialogBackdrop()}else a.selectOrder(this.$id("order"),this.model.prodShiftOrder)},selectNextOrder:function(){var t=this.model.get("nextOrder");if(!e.isEmpty(t)){var n=t[0],r=n.order;if(r&&r.no){var a=this.$id("order");if(this.options.embedded)return this.lastOrders=[r],a.val(r.no||r.nc12),this.$id("operationGroup").find("div").html(this.buildOrderOperationList(r,n.operationNo)),this.updateNewWorkerCount(n.workerCount),void i.adjustDialogBackdrop();a.select2("data",e.assign({},r,{id:r.no,text:r.no+" - "+(o(r)||"?"),sameOrder:!1})),a.trigger({type:"change",operations:e.values(r.operations),selectedOperationNo:n.operationNo})}else window.WMES_LOG_BROWSER_ERROR&&window.WMES_LOG_BROWSER_ERROR("Invalid nextOrder!?! "+JSON.stringify(t))}},selectSpecifiedOrder:function(){var e=this,t=e.options.order;t&&(e.$id("order").val(t.orderId),this.handleOrderChange(function(){e.$id("operationGroup").find('[data-operation="'+t.operationNo+'"]').click(),e.$id("newWorkerCount").val(t.workerCount.toLocaleString())}))},handleEmbeddedPick:function(t){var n=this.$id("order").val(),r=this.lastOrders[0];if(!n||!r||n!==(r._id||r.no))return this.$id("order").select2("focus"),t.disabled=!1,i.msg.show({type:"error",time:2e3,text:this.t("newOrderPicker:msg:emptyOrder")});var o=this.$id("operationGroup").find(".active").first().attr("data-operation")||"0000",s=e.clone(r);a.prepareOrderInfo(this.model,s),this.pickOrder(s,o)},handleOnlinePick:function(e){var t=this.$id("order").select2("data"),n=this.$id("operation"),r=n.hasClass("form-control")?n.val():this.$id("operation").select2("val");return t?r?(t.sameOrder?t=this.model.prodShiftOrder.get("orderData"):a.prepareOrderInfo(this.model,t),void this.pickOrder(t,r)):(n.focus(),e.disabled=!1,i.msg.show({type:"error",time:2e3,text:this.t("newOrderPicker:msg:emptyOperation")})):(this.$id("order").select2("focus"),e.disabled=!1,i.msg.show({type:"error",time:2e3,text:this.t("newOrderPicker:msg:emptyOrder")}))},handleOfflinePick:function(e){var t=this.model.getOrderIdType(),n={no:null,nc12:null},r=this.$id("order").val().trim().replace(/[^a-zA-Z0-9]+/g,""),o=this.$id("operation").val().trim().replace(/[^0-9]+/g,"");if("no"===t&&/^[0-9]{9,}$/.test(r))n.no=r;else{if("nc12"!==t||!(12===r.length||r.length<9&&/^[a-zA-Z]+[a-zA-Z0-9]*$/.test(r)))return this.$id("order").select(),e.disabled=!1,i.msg.show({type:"error",time:2e3,text:this.t(""===r?"newOrderPicker:msg:emptyOrder":"newOrderPicker:msg:invalidOrderId:"+t)});n.nc12=r}if(!/^[0-9]{1,4}$/.test(o))return this.$id("operation").select(),e.disabled=!1,i.msg.show({type:"error",time:2e3,text:this.t(""===r?"newOrderPicker:msg:emptyOrder":"newOrderPicker:msg:invalidOperationNo")});this.pickOrder(n,o)},pickOrder:function(t,n){for(;n.length<4;)n="0"+n;var r=t.statuses;if(Array.isArray(r)&&r.length&&"development"!==window.ENV){if(e.intersection(r,["TECO","DLT","DLFL"]).length)return this.$id("order").select(),this.$id("submit").prop("disabled",!1),i.msg.show({type:"error",time:2e3,text:this.t("newOrderPicker:msg:orderDeleted")});var o=t.qtyDone&&t.qtyDone.byOperation&&t.qtyDone.byOperation[n]||0,a=t.qtyMax&&t.qtyMax[n]||t.qty;if(a&&o>=a&&e.intersection(r,["CNF","DLV"]).length)return this.$id("order").select(),this.$id("submit").prop("disabled",!1),i.msg.show({type:"error",time:2e3,text:this.t("newOrderPicker:msg:orderCompleted")})}!this.options.correctingOrder&&this.model.hasOrder()&&(this.model.changeQuantityDone(this.parseInt("quantityDone")),this.model.changeWorkerCount(this.parseFloat("workerCount"))),this.options.correctingOrder?this.model.correctOrder(t,n):this.model.changeOrder(t,n,this.parseFloat("newWorkerCount")),this.closeDialog()},parseInt:function(e){var t=parseInt(this.$id(e).val(),10);return isNaN(t)||t<0?0:t},parseFloat:function(e){var t=Math.round(10*parseFloat(this.$id(e).val().replace(",",".")))/10;return isNaN(t)||t<0?0:t},isIgnoredTarget:function(e){return"number"===e.type||-1!==e.className.indexOf("select2")||"1"===e.dataset.ignoreKey},onKeyDown:function(e){if(8===e.keyCode&&!this.isIgnoredTarget(e.target)){this.lastKeyPressAt=Date.now();var t=this.$id("spigot-nc12");return t.length&&t.val("")[0].setCustomValidity(""),!1}},onKeyPress:function(e){var t=this.$id("spigot-nc12");if(t.length){var n=e.target,i=e.keyCode;if(13===i)return t[0]!==n;if(!(i<32||i>126||this.isIgnoredTarget(n))){var r=Date.now(),o=r-this.lastKeyPressAt>333?"":t.val(),a=String.fromCharCode(i);return t.val(o+a)[0].setCustomValidity(""),t.focus(),this.lastKeyPressAt=r,!1}}},onVkbValueChange:function(e){this.socket.isConnected()&&e===this.$id("order")[0]&&this.handleOrderChange()},handleOrderChange:function(t){t||(t=e.noop);var n=this.$id("order").val().replace(/[^0-9]+/g,""),i=this.$id("operationGroup"),r=this.buildOperationList(n,t);r.length?t():r='<p><i class="fa fa-spinner fa-spin"></i></p>';var o=i.find("div").html(r).find(".active");o.length&&o[0].scrollIntoView(),this.options.vkb&&this.options.vkb.reposition()},buildOperationList:function(e,t){var n=this;return 9!==e.length?(t(),"<p>"+n.t("newOrderPicker:order:tooShort")+"</p>"):(n.searchReq&&n.searchReq.abort(),n.searchReq=n.ajax({url:"/production/orders?"+this.model.getOrderIdType()+"="+e}),n.searchReq.fail(function(){n.$(".fa-spin").removeClass("fa-spin")}),n.searchReq.done(function(e){n.lastOrders=e||[];var t="";t=n.lastOrders.length?n.buildOrderOperationList(n.lastOrders[0]):"<p>"+n.t("newOrderPicker:order:notFound")+"</p>";var r=n.$id("operationGroup").find("div").html(t).find(".active");r.length&&r[0].scrollIntoView(),n.updateNewWorkerCount(),n.options.vkb&&n.options.vkb.reposition(),i.adjustDialogBackdrop()}),n.searchReq.always(function(){n.searchReq=null,t()}),n.lastPhrase=e,"")},buildOrderOperationList:function(t,n){var i="";return n||(n=a.getBestDefaultOperationNo(t.operations)),e.forEach(a.prepareOperations(t.operations),function(t){if(t.name){var r="btn btn-lg btn-default "+(t.no===n?"active":"");i+='<button type="button" class="'+r+'" data-operation="'+t.no+'"><em>'+e.escape(t.no)+"</em><span>"+e.escape(t.name||"?")+"</span></button>"}}),i.length?i:"<p>"+this.t("newOrderPicker:order:notFound")+"</p>"},updateNewWorkerCount:function(t){var n=this.$id("newWorkerCount").val("");if(n.length)if(t>0)n.val(t.toString());else{var i=this.$id("order").val(),r=this.$id("operationGroup").find(".active").attr("data-operation"),o=e.findWhere(this.lastOrders,{_id:i})||e.findWhere(this.lastOrders,{no:i});if(o){var a=e.findWhere(o.operations,{no:r});!a||a.laborTime<=0||a.machineTime<=0||n.val(Math.max(Math.round(a.laborTime/a.machineTime),1))}}},checkMinMaxValidity:function(e){var t=e.target,n=parseInt(t.value,10)||0,i=parseInt(t.getAttribute("min"),10)||0,r=parseInt(t.getAttribute("max"),10),o="";n<i?o=this.t("error:min",{min:i}):n>r&&(o=this.t("error:max",{max:r})),t.setCustomValidity(o)}})}),define("app/prodDowntimes/util/reasonAndAor",["underscore","app/data/downtimeReasons","app/data/aors","app/data/subdivisions"],function(e,t,n,i){"use strict";return{reasons:t,aors:n,initialize:function(e){e.reasonsToAorsMap={},e.reasonsList=[],e.aorsList={}},destroy:function(e){e.reasonsToAorsMap=null,e.reasonsList=null,e.aorsList=null},setUpReasons:function(n,r,o){var a={},s=[],u=i.get(o),c=u?u.get("aor"):null,l=r;l||(l=u?t.findBySubdivisionType(u.get("type")):t),l.forEach(function(t){var n={},i=!1;t.get("defaultAor")&&c?(n[c]=!0,i=!0):e.forEach(t.get("aors"),function(e){n[e]=!0,i=!0}),i||(n=null),a[t.id]=n,s.push({id:t.id,text:t.id+" - "+t.get("label"),reason:t,aors:n})}),n.reasonsToAorsMap=a,n.reasonsList=s},setUpAors:function(e){var t=[];n.forEach(function(e){t.push({id:e.id,text:e.get("name"),aor:e})}),e.aorsList=t},getReasonsForAor:function(e,t){if(!t)return e.reasonsList;for(var n=[],i=0;i<e.reasonsList.length;++i){var r=e.reasonsList[i];r.aors&&!r.aors[t]||n.push(r)}return n},getAorsForReason:function(t,i){if(!i)return t.aorsList;var r=t.reasonsToAorsMap[i];if(void 0===r)return[];if(null===r)return t.aorsList;var o=[];return e.forEach(Object.keys(r),function(e){var t=n.get(e);o.push({id:e,text:t.get("name"),aor:t})}),o},setUpReasonSelect2:function(t,n,i){var r=t.$id("reason"),o=this.getReasonsForAor(t,n);r.select2(e.assign({openOnEnter:null,data:o},i)),null===r.select2("data")&&r.select2("val",1===o.length?o[0].id:"")},setUpAorSelect2:function(t,n,i){var r=t.$id("aor"),o=this.getAorsForReason(t,n);r.select2(e.assign({openOnEnter:null,data:o},i)),null===r.select2("data")&&r.select2("val",1===o.length?o[0].id:"")}}}),define("app/production/templates/downtimePicker",["underscore","jquery","app/i18n","app/time","app/user","app/core/util/forms"],function(_,$,t,time,user,forms){return function anonymous(locals,escapeFn,include,rethrow){escapeFn=escapeFn||function(e){return void 0==e?"":String(e).replace(_MATCH_HTML,encode_char)};var _ENCODE_HTML_RULES={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&#34;","'":"&#39;"},_MATCH_HTML=/[&<>'"]/g;function encode_char(e){return _ENCODE_HTML_RULES[e]||e}var __output="";function __append(e){void 0!==e&&null!==e&&(__output+=e)}with(locals||{})__append('<form class="production-downtimePicker">\n  <div id="'),__append(id("startedAtGroup")),__append('" class="form-group">\n    <label for="'),__append(id("startedAt")),__append('">'),__append(t("downtimePicker:startedAt")),__append("</label>\n    "),"start"===mode?(__append('\n    <div class="input-group">\n      <input id="'),__append(id("startedAt")),__append('" class="form-control" type="text" autocomplete="new-password" value="'),__append(time.format(startedAt,"YYYY-MM-DD, HH:mm:ss")),__append('" readonly data-time="'),__append(startedAt.getTime()),__append('">\n      <span class="input-group-btn">\n        <button class="btn btn-default production-downtimePicker-now" type="button">'),__append(t("downtimePicker:startedAt:now")),__append("</button>\n      </span>\n    </div>\n    ")):(__append('\n    <input id="'),__append(id("startedAt")),__append('" class="form-control" type="text" autocomplete="new-password" value="'),__append(time.format(startedAt,"YYYY-MM-DD, HH:mm:ss")),__append('" readonly data-time="'),__append(startedAt.getTime()),__append('">\n    ')),__append('\n  </div>\n  <div id="'),__append(id("reasonGroup")),__append('" class="form-group production-form-btn-group">\n    <label for="'),__append(id("reason")),__append('">'),__append(t("downtimePicker:reason:label")),__append("</label>\n    "),embedded?(__append('\n    <div class="production-downtimePicker-btn-group">\n      <button id="'),__append(id("selectedReason")),__append('" class="btn btn-lg btn-block btn-default" type="button"><span>'),__append(t("downtimePicker:reason:placeholder")),__append('</span></button>\n      <button id="'),__append(id("clearReason")),__append('" class="btn btn-lg btn-block btn-default" type="button"><i class="fa fa-eraser"></i></button>\n    </div>\n    <input id="'),__append(id("reasonFilter")),__append('" class="form-control is-embedded is-vkb-focused hidden" type="text" autocomplete="new-password" placeholder="'),__append(t("downtimePicker:reasonFilter:placeholder")),__append('" data-ignore-key="1" data-vkb="alpha numeric">\n    <div class="btn-group-vertical hidden"></div>\n    ')):(__append('\n    <input id="'),__append(id("reason")),__append('" type="text" autocomplete="new-password" placeholder="'),__append(t("downtimePicker:reason:placeholder")),__append('">\n    ')),__append('\n  </div>\n  <div id="'),__append(id("aorGroup")),__append('" class="form-group production-form-btn-group">\n    <label for="'),__append(id("aor")),__append('">'),__append(t("downtimePicker:aor:label")),__append("</label>\n    "),embedded?(__append('\n    <div class="production-downtimePicker-btn-group">\n      <button id="'),__append(id("selectedAor")),__append('" class="btn btn-lg btn-block btn-default" type="button"><span>'),__append(t("downtimePicker:aor:placeholder")),__append('</span></button>\n      <button id="'),__append(id("clearAor")),__append('" class="btn btn-lg btn-block btn-default" type="button"><i class="fa fa-eraser"></i></button>\n    </div>\n    <input id="'),__append(id("aorFilter")),__append('" class="form-control is-embedded is-vkb-focused hidden" type="text" autocomplete="new-password" placeholder="'),__append(t("downtimePicker:aorFilter:placeholder")),__append('" data-ignore-key="1" data-vkb="alpha numeric">\n    <div class="btn-group-vertical hidden"></div>\n    ')):(__append('\n    <input id="'),__append(id("aor")),__append('" type="text" autocomplete="new-password" placeholder="'),__append(t("downtimePicker:aor:placeholder")),__append('">\n    ')),__append('\n  </div>\n  <div id="'),__append(id("commentGroup")),__append('" class="form-group">\n    <label for="'),__append(id("reasonComment")),__append('">'),__append(t("downtimePicker:reasonComment:label")),__append('</label>\n    <textarea id="'),__append(id("reasonComment")),__append('" class="form-control" rows="'),__append(embedded?"2":"4"),__append('" placeholder="'),__append(t("downtimePicker:reasonComment:placeholder")),__append('" data-vkb="alpha numeric multiline"></textarea>\n  </div>\n  <div class="form-actions">\n    <button id="'),__append(id("submit")),__append('" type="submit" class="btn btn-lg btn-'),__append("start"===mode?"danger":"primary"),__append('">'),__append(t("downtimePicker:submit:"+mode)),__append('</button>\n    <button type="button" class="cancel btn btn-lg btn-link">'),__append(t("downtimePicker:cancel")),__append("</button>\n  </div>\n</form>\n");return __output}}),define("app/production/views/DowntimePickerView",["underscore","jquery","app/i18n","app/time","app/viewport","app/data/aors","app/core/View","app/core/util/transliterate","app/prodDowntimes/util/reasonAndAor","app/production/templates/downtimePicker"],function(e,t,n,i,r,o,a,s,u,c){"use strict";return a.extend({template:c,dialogClassName:"production-modal",nlsDomain:"production",events:{"keypress .select2-container":function(e){13===e.which&&(e.preventDefault(),this.$el.submit())},"keypress textarea":function(e){13===e.which&&""===e.target.value.trim()&&(e.preventDefault(),this.$el.submit())},submit:function(e){e.preventDefault();var t=this.$('.btn[type="submit"]')[0];t.disabled||(t.disabled=!0,this.options.embedded?this.handleEmbeddedPick(t):this.handlePick(t))},"click .production-downtimePicker-now":function(){var e=Date.now();this.$id("startedAt").val(i.format(e,"YYYY-MM-DD, HH:mm:ss")).attr("data-time",e)},"select2-removed #-reason, #-aor":function(){this.$id("reason").val(""),this.$id("aor").val(""),this.model.reason=null,this.model.aor=null,this.timers.clearSelect2=setTimeout(function(e){e.setUpReasonSelect2(),e.setUpAorSelect2(),e.$id("reason").select2("focus")},1,this)},"change #-reason":function(e){this.model.reason=e.target.value,this.setUpAorSelect2(),this.$id("aor").select2("focus")},"change #-aor":function(e){this.model.aor=e.target.value,this.setUpReasonSelect2(),null===this.$id("reason").select2("data")?this.$id("reason").select2("focus"):this.$id("reasonComment").focus()},"focus [data-vkb]":function(e){this.options.embedded&&this.options.vkb&&this.options.vkb.show(e.target,this.onVkbValueChange)},"click #-clearReason":function(){this.selectEmbeddedReason(null)},"click #-clearAor":function(){this.selectEmbeddedAor(null)},"click #-selectedReason":function(){this.options.vkb&&this.options.vkb.hide(),this.$id("startedAtGroup").addClass("hidden"),this.$id("aorGroup").addClass("hidden"),this.$id("commentGroup").addClass("hidden"),this.$id("submit").prop("disabled",!0);var t=this.$id("reasonFilter"),n=this.$id("reasonGroup").css("margin-top","15px"),i=n.find(".btn-group-vertical"),r=this.model.reason,o="";u.getReasonsForAor(this,this.model.aor).sort(function(e,t){return e.reason.getLabel().localeCompare(t.reason.getLabel())}).forEach(function(t){var n="btn btn-lg btn-default "+(t.reason.id===r?"active":""),i=s(t.reason.id+t.reason.getLabel()).toUpperCase().replace(/[^A-Z0-9]+/g,"");o+='<button type="button" class="'+n+'" data-reason="'+t.reason.id+'" data-filter="'+i+'"><strong>'+t.reason.id+"</strong>"+e.escape(t.reason.getLabel())+"</button>"}),n.find(".production-downtimePicker-btn-group").addClass("hidden"),n.find("label").addClass("hidden"),t.removeClass("hidden"),i.html(o).removeClass("hidden"),t.focus();var a=i.find(".active")[0];a&&a.scrollIntoView(),this.selectingOption=!0},"click #-selectedAor":function(){this.options.vkb&&this.options.vkb.hide(),this.$id("startedAtGroup").addClass("hidden"),this.$id("reasonGroup").addClass("hidden"),this.$id("commentGroup").addClass("hidden"),this.$id("submit").prop("disabled",!0);var t=this.$id("aorFilter"),n=this.$id("aorGroup").css("margin-top","15px"),i=n.find(".btn-group-vertical"),r=this.model.aor,o="";u.getAorsForReason(this,this.model.reason).sort(function(e,t){return e.aor.getLabel().localeCompare(t.aor.getLabel())}).forEach(function(t){var n="btn btn-lg btn-default "+(t.aor.id===r?"active":""),i=s(t.aor.getLabel()).toUpperCase().replace(/[^A-Z0-9]+/g,"");o+='<button type="button" class="'+n+'" data-aor="'+t.aor.id+'" data-filter="'+i+'">'+e.escape(t.aor.getLabel())+"</button>"}),n.find(".production-downtimePicker-btn-group").addClass("hidden"),n.find("label").addClass("hidden"),t.removeClass("hidden"),i.html(o).removeClass("hidden"),t.focus();var a=i.find(".active")[0];a&&a.scrollIntoView(),this.selectingOption=!0},"click .btn[data-reason]":function(e){if(this.selectEmbeddedReason(e.currentTarget.dataset.reason),!this.model.aor&&this.model.reason){var t=u.getAorsForReason(this,this.model.reason);1===t.length&&this.selectEmbeddedAor(t[0].id)}},"click .btn[data-aor]":function(e){this.selectEmbeddedAor(e.currentTarget.dataset.aor)},"input #-reasonFilter":"filterReasons","input #-aorFilter":"filterAors","keyup #-reasonFilter, #-aorFilter":function(e){if(13===e.keyCode){var t=this.$(e.target).next().find(".btn:not(.hidden)");1===t.length&&t.first().click()}}},initialize:function(){this.onVkbValueChange=this.onVkbValueChange.bind(this),this.selectingOption=!1,u.initialize(this),t(window).on("keyup."+this.idPrefix,this.onKeyUp.bind(this))},destroy:function(){t(window).off("."+this.idPrefix),u.destroy(this),this.options.vkb&&this.options.vkb.hide()},getTemplateData:function(){return{startedAt:this.model.startedAt,mode:this.model.mode,embedded:this.options.embedded}},afterRender:function(){var e=this.model.prodShift.getDowntimeReasons().sort(function(e,t){return e.id.localeCompare(t.id)});if(u.setUpReasons(this,e,this.model.prodShift.get("subdivision")),u.setUpAors(this),this.model.reasonComment&&this.$id("reasonComment").val(this.model.reasonComment),this.options.embedded)return this.setUpEmbeddedFields();this.model.reason&&this.$id("reason").val(this.model.reason),this.model.aor&&this.$id("aor").val(this.model.aor),this.setUpReasonSelect2(),this.setUpAorSelect2(),this.focusControl()},setUpEmbeddedFields:function(){this.selectEmbeddedReason(this.model.reason),this.selectEmbeddedAor(this.model.aor)},selectEmbeddedReason:function(e){var t="<span>"+((e=u.reasons.get(e))?e.getLabel():n("production","downtimePicker:reason:placeholder"))+"</span>";this.$id("selectedReason").html(t).val(e?e.id:""),this.$id("reasonFilter").val("").addClass("hidden");var i=this.$id("reasonGroup");i.find(".btn-group-vertical").addClass("hidden"),i.find("label").removeClass("hidden"),i.find(".production-downtimePicker-btn-group").removeClass("hidden"),this.$id("startedAtGroup").removeClass("hidden"),this.$id("aorGroup").removeClass("hidden"),this.$id("commentGroup").removeClass("hidden"),this.$id("submit").prop("disabled",!1),this.model.reason=e?e.id:null,this.selectingOption=!1},selectEmbeddedAor:function(e){var t="<span>"+((e=u.aors.get(e))?e.getLabel():n("production","downtimePicker:aor:placeholder"))+"</span>";this.$id("selectedAor").html(t).val(e?e.id:""),this.$id("aorFilter").val("").addClass("hidden");var i=this.$id("aorGroup");i.find(".btn-group-vertical").addClass("hidden"),i.find("label").removeClass("hidden"),i.find(".production-downtimePicker-btn-group").removeClass("hidden"),this.$id("startedAtGroup").removeClass("hidden"),this.$id("reasonGroup").removeClass("hidden"),this.$id("commentGroup").removeClass("hidden"),this.$id("submit").prop("disabled",!1),this.model.aor=e?e.id:null,this.selectingOption=!1},onVkbValueChange:function(e){/reasonFilter/.test(e.id)?this.filterReasons():/aorFilter/.test(e.id)&&this.filterAors()},onDialogShown:function(){this.focusControl()},onKeyUp:function(e){if(!(!this.selectingOption||document.activeElement&&document.activeElement.dataset.vkb)){var n=t(".production-vkb");n.length&&!n.hasClass("hidden")&&n.find('.btn[data-key="'+e.originalEvent.key.toUpperCase()+'"]').click()}},filterReasons:function(){var e=this.$id("reasonGroup").find(".btn-group-vertical").find(".btn"),t=s(this.$id("reasonFilter").val()).toUpperCase().replace(/[^A-Z0-9]+/g,"");u.reasons.get(t)?e.addClass("hidden").filter('.btn[data-reason="'+t+'"]').removeClass("hidden"):t.length?e.addClass("hidden").filter('.btn[data-filter*="'+t+'"]').removeClass("hidden"):e.removeClass("hidden")},filterAors:function(){var e=this.$id("aorGroup").find(".btn-group-vertical").find(".btn"),t=s(this.$id("aorFilter").val()).toUpperCase().replace(/[^A-Z0-9]+/g,"");t.length?e.addClass("hidden").filter('.btn[data-filter*="'+t+'"]').removeClass("hidden"):e.removeClass("hidden")},focusControl:function(){this.options.embedded||(this.model.reason?this.model.aor?"edit"===this.model.mode?this.$id("reasonComment").focus():this.$(".btn-danger").focus():this.$id("aor").select2("focus"):this.$id("reason").select2("focus"))},setUpReasonSelect2:function(){u.setUpReasonSelect2(this,this.model.aor,{allowClear:!0,dropdownCssClass:"production-dropdown"})},setUpAorSelect2:function(){u.setUpAorSelect2(this,this.model.reason,{allowClear:!0,dropdownCssClass:"production-dropdown"})},handleEmbeddedPick:function(e){var t=this.$id("selectedReason").val(),i=this.$id("selectedAor").val(),o=this.$id("reasonComment").val();return t?i?void this.trigger("downtimePicked",{reason:t,reasonComment:o,aor:i,startedAt:new Date(parseInt(this.$id("startedAt").attr("data-time"),10))}):(this.$id("selectedAor").focus(),e.disabled=!1,r.msg.show({type:"error",time:2e3,text:n("production","downtimePicker:msg:emptyAor")})):(this.$id("selectedReason").focus(),e.disabled=!1,r.msg.show({type:"error",time:2e3,text:n("production","downtimePicker:msg:emptyReason")}))},handlePick:function(e){var t=this.$id("reason").select2("val"),i=this.$id("aor").select2("val"),o=this.$id("reasonComment").val();return t?i?void this.trigger("downtimePicked",{reason:t,reasonComment:o,aor:i,startedAt:new Date(parseInt(this.$id("startedAt").attr("data-time"),10))}):(this.$id("aor").select2("focus"),e.disabled=!1,r.msg.show({type:"error",time:2e3,text:n("production","downtimePicker:msg:emptyAor")})):(this.$id("reason").select2("focus"),e.disabled=!1,r.msg.show({type:"error",time:2e3,text:n("production","downtimePicker:msg:emptyReason")}))}})}),define("app/production/templates/endWorkDialog",["underscore","jquery","app/i18n","app/time","app/user","app/core/util/forms"],function(_,$,t,time,user,forms){return function anonymous(locals,escapeFn,include,rethrow){escapeFn=escapeFn||function(e){return void 0==e?"":String(e).replace(_MATCH_HTML,encode_char)};var _ENCODE_HTML_RULES={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&#34;","'":"&#39;"},_MATCH_HTML=/[&<>'"]/g;function encode_char(e){return _ENCODE_HTML_RULES[e]||e}var __output="";function __append(e){void 0!==e&&null!==e&&(__output+=e)}with(locals||{})__append('<form class="production-endWorkDialog" autocomplete="off">\n  <p class="message message-inline message-warning">'),__append(t("endWorkDialog:warning",{downtime:downtime})),__append("</p>\n  "),spigot&&(__append('\n  <div id="'),__append(id("spigot")),__append('" class="form-group">\n    <label for="'),__append(id("spigot-nc12")),__append('">'),__append(t("endWorkDialog:spigot:nc12")),__append('</label>\n    <input id="'),__append(id("spigot-nc12")),__append('" class="form-control production-spigot-nc12 '),__append(embedded?"is-embedded":""),__append('" type="text" autocomplete="new-password" value="" placeholder="'),__append(t("endWorkDialog:spigot:placeholder")),__append('" required>\n  </div>\n  ')),__append('\n  <div class="form-group">\n    <label for="'),__append(id("quantitiesDone")),__append('">'),__append(t("endWorkDialog:quantitiesDone",{hourRange:hourRange})),__append('</label>\n    <input id="'),__append(id("quantitiesDone")),__append('" class="form-control small '),__append(embedded?"is-embedded":""),__append('" type="'),__append(embedded?"text":"number"),__append('" value="'),__append(quantitiesDone),__append('" min="0" max="'),__append(maxQuantitiesDone),__append('" data-ignore-key="1" data-vkb="numeric">\n  </div>\n  <div class="form-group">\n    <label for="'),__append(id("quantityDone")),__append('">'),__append(t("endWorkDialog:quantityDone")),__append('</label>\n    <input id="'),__append(id("quantityDone")),__append('" class="form-control small '),__append(embedded?"is-embedded":""),__append('" type="'),__append(embedded?"text":"number"),__append('" value="'),__append(quantityDone),__append('" max="'),__append(maxQuantityDone),__append('" data-ignore-key="1" data-vkb="numeric">\n  </div>\n  <div class="form-group">\n    <label for="'),__append(id("workerCount")),__append('">'),__append(t("endWorkDialog:workerCount")),__append('</label>\n    <input id="'),__append(id("workerCount")),__append('" class="form-control small '),__append(embedded?"is-embedded":""),__append('" type="'),__append(embedded?"text":"number"),__append('" value="'),__append(workerCount.toLocaleString()),__append('" min="1" max="'),__append(maxWorkerCount),__append('" pattern="^[0-9]{1,2}([,.][0-9]{1})?$" data-ignore-key="1" data-vkb="numeric decimal">\n  </div>\n  <div id="'),__append(id("ft")),__append('" class="hidden" style="margin-bottom: 15px">\n    <p class="message message-inline message-error">'),__append(t("ft:warning")),__append('</p>\n    <div class="form-group">\n      <label for="'),__append(id("ft-login")),__append('">'),__append(t("ft:login")),__append('</label>\n      <input id="'),__append(id("ft-login")),__append('" class="form-control is-embedded" type="text" required data-ignore-key="1" data-vkb="alpha numeric">\n    </div>\n    <div class="form-group">\n      <label for="'),__append(id("ft-password")),__append('">'),__append(t("ft:password")),__append('</label>\n      <input id="'),__append(id("ft-password")),__append('" class="form-control is-embedded" type="password" required autocomplete="new-password" data-ignore-key="1" data-vkb="alpha numeric extended">\n    </div>\n  </div>\n  <div class="form-actions">\n    <button id="'),__append(id("submit")),__append('" class="btn btn-lg btn-warning" type="submit">'),__append(t("endWorkDialog:yes")),__append('</button>\n    <button class="btn btn-lg btn-link cancel" type="button">'),__append(t("endWorkDialog:no")),__append("</button>\n  </div>\n</form>\n");return __output}}),define("app/production/views/EndWorkDialogView",["jquery","app/i18n","app/core/View","../util/limitQuantityDone","app/production/templates/endWorkDialog"],function(e,t,n,i,r){"use strict";return n.extend({template:r,dialogClassName:"production-modal",remoteTopics:function(){var e={};return e["production.spigotCheck.scanned."+this.model.prodLine.id]="onSpigotScanned",e},events:{"focus [data-vkb]":function(e){this.options.embedded&&this.options.vkb&&this.options.vkb.show(e.target,this.onVkbValueChange)},"focus #-spigot-nc12":function(){this.options.embedded&&this.options.vkb&&this.options.vkb.hide()},'input input[type="text"][max]':"checkMinMaxValidity",'blur input[type="text"][max]':"checkMinMaxValidity",submit:function(e){e.preventDefault();var n=this.$(".btn-warning")[0];if(!n.disabled){n.disabled=!0;var i=this.$id("spigot-nc12");if(i.length){var r=i.val().match(/([0-9]{12})/),o=r?r[1]:"";if(!o.length||!this.model.checkSpigot(null,o))return i[0].setCustomValidity(t("production","endWorkDialog:spigot:invalid")),void(this.timers.submit=setTimeout(function(){n.disabled=!1,n.click()},1,this))}if(this.ft.checkCredentials)return this.ft.checkCredentials();var a=this.parseInt("quantitiesDone"),s=this.parseInt("quantityDone"),u=this.parseFloat("workerCount");this.model.changeCurrentQuantitiesDone(a),s!==this.model.prodShiftOrder.get("quantityDone")&&this.model.changeQuantityDone(s),u!==this.model.prodShiftOrder.get("workerCount")&&this.model.changeWorkerCount(u),this.model.endWork(),this.closeDialog()}}},initialize:function(){this.onVkbValueChange=this.onVkbValueChange.bind(this),this.lastKeyPressAt=0,this.listenTo(this.model.prodShiftOrder,"qtyMaxChanged",this.limitQuantityDone),e(window).on("keydown."+this.idPrefix,this.onKeyDown.bind(this)).on("keypress."+this.idPrefix,this.onKeyPress.bind(this))},destroy:function(){e(window).off("."+this.idPrefix),this.options.vkb&&this.options.vkb.hide(),this.$id("spigot-nc12").length&&this.pubsub.publish("production.spigotCheck.aborted."+this.model.prodLine.id,{prodLineId:this.model.prodLine.id})},getTemplateData:function(){var e=this.model,t=e.prodShiftOrder;return{spigot:e.settings.getValue("spigotFinish")&&!!t.get("spigot"),downtime:e.isDowntime(),hourRange:e.getCurrentQuantityDoneHourRange(),quantitiesDone:e.getQuantityDoneInCurrentHour(),quantityDone:t.get("quantityDone")||0,workerCount:t.getWorkerCountForEdit(),maxQuantitiesDone:e.getMaxQuantitiesDone(),maxQuantityDone:t.getMaxQuantityDone(),maxWorkerCount:t.getMaxWorkerCount(),embedded:this.options.embedded}},afterRender:function(){this.limitQuantityDone(),this.notifySpigotCheckRequest(),this.focusFirstInput()},focusFirstInput:function(){this.$("input:not([disabled])").select()},notifySpigotCheckRequest:function(){this.$id("spigot-nc12").length&&(clearTimeout(this.timers.notifySpigotCheckRequest),this.timers.notifySpigotCheckRequest=setTimeout(this.notifySpigotCheckRequest.bind(this),5e3),this.pubsub.publish("production.spigotCheck.requested."+this.model.prodLine.id,{prodLine:this.model.prodLine.id,component:this.model.prodShiftOrder.get("spigot").component,orderNo:this.model.prodShiftOrder.get("orderId"),source:"endWork"}))},onSpigotScanned:function(e){var t=this.$id("spigot-nc12").val(e.nc12);if(t.length){t[0].setCustomValidity("");var n=this.model.prodLine.id,i=this.model.prodShiftOrder,r=i.get("spigot");r&&(this.model.checkSpigotValidity(e.nc12,r.component.nc12)?this.pubsub.publish("production.spigotCheck.success."+n,{prodLine:n,component:r.component,orderNo:i.get("orderId"),input:e.nc12,nc12:r.component.nc12,source:"endWork"}):this.pubsub.publish("production.spigotCheck.failure."+n,{prodLine:n,component:r.component,orderNo:i.get("orderId"),input:e.nc12,source:"endWork"}))}},limitQuantityDone:function(){i(this,this.model.prodShiftOrder)},onDialogShown:function(e){this.closeDialog=e.closeDialog.bind(e)},closeDialog:function(){},parseFloat:function(e){var t=Math.round(10*parseFloat(this.$id(e).val().replace(",",".")))/10;return isNaN(t)||t<0?0:t},parseInt:function(e){var t=parseInt(this.$id(e).val(),10);return isNaN(t)||t<0?0:t},isIgnoredTarget:function(e){return"number"===e.type||-1!==e.className.indexOf("select2")||"1"===e.dataset.ignoreKey},onVkbValueChange:function(e){this.checkMinMaxValidity({target:e})},onKeyDown:function(e){if(8===e.keyCode&&!this.isIgnoredTarget(e.target)){this.lastKeyPressAt=Date.now();var t=this.$id("spigot-nc12");return t.length&&t.val("")[0].setCustomValidity(""),!1}},onKeyPress:function(e){var t=this.$id("spigot-nc12");if(t.length){if(13===e.keyCode)return t[0]!==e.target;if(!(e.keyCode<32||e.keyCode>126||this.isIgnoredTarget(e.target))){var n=Date.now(),i=n-this.lastKeyPressAt>333?"":t.val(),r=String.fromCharCode(e.keyCode);return t.val(i+r)[0].setCustomValidity(""),t.focus(),this.lastKeyPressAt=n,!1}}},checkMinMaxValidity:function(e){var n=e.target,i=parseInt(n.getAttribute("max"),10);if(!isNaN(i)){var r=parseInt(n.getAttribute("min"),10)||0,o=parseInt(n.value,10)||0,a="";o<r?a=t("production","error:min",{min:r}):o>i&&(a=t("production","error:max",{max:i})),n.setCustomValidity(a)}}})}),define("app/production/templates/orderQueue",["underscore","jquery","app/i18n","app/time","app/user","app/core/util/forms"],function(_,$,t,time,user,forms){return function anonymous(locals,escapeFn,include,rethrow){escapeFn=escapeFn||function(e){return void 0==e?"":String(e).replace(_MATCH_HTML,encode_char)};var _ENCODE_HTML_RULES={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&#34;","'":"&#39;"},_MATCH_HTML=/[&<>'"]/g;function encode_char(e){return _ENCODE_HTML_RULES[e]||e}var __output="";function __append(e){void 0!==e&&null!==e&&(__output+=e)}with(locals||{})__append('<form class="production-orderQueue">\n  <p class="message message-inline message-info">'),__append(t("orderQueue:message:order")),__append('</p>\n  <div class="form-group">\n    <label for="'),__append(id("order")),__append('">'),__append(t("orderQueue:order:label")),__append('</label>\n    <input id="'),__append(id("order")),__append('" class="form-control" type="text" autocomplete="new-password" placeholder="'),__append(t("orderQueue:order:placeholder")),__append('" data-ignore-key="1">\n  </div>\n  <div class="form-group">\n    <label for="'),__append(id("operation")),__append('">'),__append(t("orderQueue:operation:label")),__append('</label>\n    <input id="'),__append(id("operation")),__append('" class="form-control" type="text" autocomplete="new-password" placeholder="'),__append(t("orderQueue:operation:placeholder")),__append('" maxlength="4" pattern="^[0-9]+$" data-ignore-key="1">\n  </div>\n  <div class="form-group">\n    <button id="'),__append(id("enqueue")),__append('" type="button" class="btn btn-lg btn-default">'),__append(t("orderQueue:enqueue")),__append('</button>\n    <button id="'),__append(id("clear")),__append('" type="button" class="btn btn-lg btn-link">'),__append(t("orderQueue:clear")),__append('</button>\n  </div>\n  <p id="'),__append(id("empty")),__append('" class="message message-inline message-info">'),__append(t("orderQueue:message:empty")),__append('</p>\n  <div class="form-group hidden" id="'),__append(id("queue")),__append('">\n    <table class="table table-condensed table-bordered table-hover">\n      <tbody id="'),__append(id("rows")),__append('"></tbody>\n    </table>\n  </div>\n  <div class="form-actions">\n    <button id="'),__append(id("submit")),__append('" type="button" class="btn btn-lg btn-primary">'),__append(t("orderQueue:submit")),__append('</button>\n    <button type="button" class="cancel btn btn-lg btn-link">'),__append(t("orderQueue:cancel")),__append("</button>\n  </div>\n</form>\n");return __output}}),define("app/production/templates/orderQueueRow",["underscore","jquery","app/i18n","app/time","app/user","app/core/util/forms"],function(_,$,t,time,user,forms){return function anonymous(locals,escapeFn,include,rethrow){escapeFn=escapeFn||function(e){return void 0==e?"":String(e).replace(_MATCH_HTML,encode_char)};var _ENCODE_HTML_RULES={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&#34;","'":"&#39;"},_MATCH_HTML=/[&<>'"]/g;function encode_char(e){return _ENCODE_HTML_RULES[e]||e}var __output="";function __append(e){void 0!==e&&null!==e&&(__output+=e)}with(locals||{})__append('<tr data-order="'),__append(order.no),__append('" data-operation="'),__append(operation.no),__append('">\n  <td class="is-min production-orderQueue-no">'),__append(no),__append('.</td>\n  <td class="production-orderQueue-order">\n    '),__append(order.no),__append(": "),__append(productName||"?"),__append("<br>\n    "),__append(operation.no),__append(": "),__append(operation.name||"?"),__append('</td>\n  <td class="actions">\n    <div class="actions-group">\n      <button type="button" class="btn btn-lg btn-default" data-action="moveUp"><i class="fa fa-arrow-up"></i></button>\n      <button type="button" class="btn btn-lg btn-default" data-action="moveDown"><i class="fa fa-arrow-down"></i></button>\n      <button type="button" class="btn btn-lg btn-default" data-action="remove"><i class="fa fa-remove"></i></button>\n    </div>\n  </td>\n</tr>\n');return __output}}),define("app/production/views/OrderQueueView",["underscore","jquery","app/i18n","app/viewport","app/core/View","app/orders/util/resolveProductName","../util/orderPickerHelpers","app/production/templates/orderQueue","app/production/templates/orderQueueRow"],function(e,t,n,i,r,o,a,s,u){"use strict";return r.extend({template:s,dialogClassName:"production-modal production-orderQueueDialog",localTopics:{"socket.disconnected":"closeDialog"},events:{"click #-enqueue":function(){var e=this.$id("order"),t=this.$id("operation"),n=e.select2("data"),r=t.val();n?r?(this.addRow(a.prepareOrderInfo(this.model,n),r),t.hasClass("form-control")?t.val(""):t.select2("val","",!0),e.select2("val","",!0).select2("focus"),i.adjustDialogBackdrop()):t.focus():e.focus()},"click #-clear":function(){this.$id("rows").empty(),this.$id("queue").addClass("hidden"),this.$id("empty").html(n("production","orderQueue:message:empty")),i.adjustDialogBackdrop()},'click .btn[data-action="remove"]':function(e){this.$(e.target).closest("tr").remove(),this.$id("rows").children().length||(this.$id("queue").addClass("hidden"),this.$id("empty").html(n("production","orderQueue:message:empty"))),i.adjustDialogBackdrop()},'click .btn[data-action="moveDown"]':function(e){var t=this.$id("rows").children(),n=this.$(e.target).closest("tr"),i=n.next();1!==t.length&&(i.length?n.insertAfter(i):n.insertBefore(t.first()),this.recountRows())},'click .btn[data-action="moveUp"]':function(e){var t=this.$id("rows").children(),n=this.$(e.target).closest("tr"),i=n.prev();1!==t.length&&(i.length?n.insertBefore(i):n.insertAfter(t.last()),this.recountRows())},"click #-submit":function(){var e=this.orderCache,t=[];this.$("tr[data-order]").each(function(){t.push({order:e[this.dataset.order],operationNo:this.dataset.operation})}),this.model.setNextOrder(t),this.closeDialog()}},initialize:function(){this.orderCache={}},afterRender:function(){e.forEach(this.model.getNextOrders(),function(e){this.addRow(e.order,e.operationNo)},this),this.setUpOrderSelect2(),this.setUpOperationSelect2(),this.focusFirstInput(),i.adjustDialogBackdrop()},addRow:function(e,t){this.orderCache[e.no]=e,delete e.bom,delete e.documents,delete e.statusesSetAt;var i=this.$id("rows");i.append(u({no:i[0].childElementCount+1,order:e,operation:e.operations[t]||{no:t},productName:o(e)})),this.$id("empty").html(n("production","orderQueue:message:queue")),this.$id("queue").removeClass("hidden")},recountRows:function(){this.$id("rows").children().each(function(e){this.children[0].textContent=e+1+"."})},onDialogShown:function(e){this.closeDialog=e.closeDialog.bind(e),this.focusFirstInput()},closeDialog:function(){},focusFirstInput:function(){this.$id("order").select2("focus")},setUpOrderSelect2:function(){a.setUpOrderSelect2(this.$id("order"),this.$id("operation"),this.model,{dropdownCssClass:"production-dropdown",allowClear:!0})},setUpOperationSelect2:function(){a.setUpOperationSelect2(this.$id("operation"),[],{dropdownCssClass:"production-dropdown"})}})}),define("app/core/util/matchesDate",[],function(){"use strict";return function(e,t,n){if(null==n)return!0;var i=null,r=null;if(e.selector.args.forEach(function(e){e.args[0]===t&&("ge"===e.name||"gt"===e.name?i=e:"lt"!==e.name&&"le"!==e.name||(r=e))}),!i&&!r)return!0;n instanceof Date||(n=new Date(n));var o=n.getTime();if(isNaN(o))return!0;if(i){var a=i.args[0]instanceof Date?i.args[0]:new Date(i.args[0]);if("gt"===i.name&&o<=a)return!1;if("ge"===i.name&&o<a)return!1}if(r){var s=r.args[0]instanceof Date?r.args[0]:new Date(r.args[0]);if("lt"===r.name&&o>=s)return!1;if("le"===r.name&&o>s)return!1}return!0}}),define("app/prodSerialNumbers/ProdSerialNumber",["../time","../user","../core/Model"],function(e,t,n){"use strict";return n.extend({urlRoot:"/prodSerialNumbers",clientUrlRoot:"#prodSerialNumbers",topicPrefix:"prodSerialNumbers",privilegePrefix:"PROD_DATA",nlsDomain:"prodSerialNumbers",serialize:function(){var n=this.toJSON();return n.className=n.taktTime>1e3*n.sapTaktTime?"warning":"success",n.orderNo=n.prodShiftOrder&&t.isAllowedTo("PROD_DATA:VIEW")?`<a href="#prodShiftOrders/${n.prodShiftOrder}">${n.orderNo}</a>`:n.orderNo,n.scannedAt=e.format(n.scannedAt,"L, LTS"),n.iptAt=n.iptAt?e.format(n.iptAt,"L, LTS"):null,n.taktTime=n.taktTime?e.toString(Math.round(n.taktTime/1e3)):"",n.iptTaktTime=n.iptTaktTime?e.toString(Math.round(n.iptTaktTime/1e3)):"",n.sapTaktTime=n.sapTaktTime?e.toString(n.sapTaktTime):"",n.bom=Array.isArray(n.bom)?n.bom.map(function(e){return e.split(":")[0]}).join(", "):"",n}})}),define("app/prodSerialNumbers/ProdSerialNumberCollection",["../time","../core/Collection","../core/util/matchesDate","../core/util/matchesEquals","./ProdSerialNumber"],function(e,t,n,i,r){"use strict";return t.extend({model:r,rowHeight:!1,rqlQuery:function(t){return t.Query.fromObject({fields:{},sort:{scannedAt:-1},limit:-1337,selector:{name:"and",args:[{name:"ge",args:["scannedAt",e.getMoment().subtract(1,"week").startOf("day").valueOf()]}]}})},matches:function(e){var t=this.rqlQuery;return n(t,"scannedAt",e.scannedAt)&&i(t,"serialNo",e.serialNo)&&i(t,"orderNo",e.orderNo)&&i(t,"prodLine",e.prodLine)}})}),define("app/core/util/scrollbarSize",[],function(){"use strict";var e=document.createElement("div"),t=document.createElement("div");e.style.position="absolute",e.style.top="-9999px",e.style.width="100px",e.style.height="100px",e.style.overflow="scroll",t.style.width="200px",t.style.height="200px",e.appendChild(t),document.body.appendChild(e);var n=e.offsetWidth-e.clientWidth,i=e.offsetHeight-e.clientHeight;return document.body.removeChild(e),{width:n,height:i}}),define("app/orders/templates/commentPopover",["underscore","jquery","app/i18n","app/time","app/user","app/core/util/forms"],function(_,$,t,time,user,forms){return function anonymous(locals,escapeFn,include,rethrow){escapeFn=escapeFn||function(e){return void 0==e?"":String(e).replace(_MATCH_HTML,encode_char)};var _ENCODE_HTML_RULES={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&#34;","'":"&#39;"},_MATCH_HTML=/[&<>'"]/g;function encode_char(e){return _ENCODE_HTML_RULES[e]||e}var __output="";function __append(e){void 0!==e&&null!==e&&(__output+=e)}with(locals||{})__append('<form class="orders-commentPopover">\n  <textarea class="form-control"></textarea>\n  <button type="submit" class="btn btn-primary"><i class="fa fa-comment"></i></button>\n</form>\n');return __output}}),define("require-css/normalize",[],function(){var e=/([^:])\/+/g,t=function(t){return t.replace(e,"$1/")},n=/[^\:\/]*:\/\/([^\/])*/,r=/^(\/|data:)/;function o(e){return t(e).split("/").reduce(function(e,t,n){return 0===e.length||".."!==t?e.push(t):e.pop(),e},[]).join("/")}function a(e,t,i){if(t=o(t),i=o(i),e.match(r)||e.match(n))return e;e=o(e);var a=i.match(n),c=t.match(n);return!c||a&&a[1]==c[1]&&a[2]==c[2]?u(s(e,t),i):s(e,t)}function s(e,t){if("./"==e.substr(0,2)&&(e=e.substr(2)),e.match(r)||e.match(n))return e;var i=t.split("/"),o=e.split("/");for(i.pop();curPart=o.shift();)".."==curPart?i.pop():i.push(curPart);return i.join("/")}function u(e,t){var n=t.split("/");for(n.pop(),t=n.join("/")+"/",i=0;t.substr(i,1)==e.substr(i,1);)i++;for(;"/"!=t.substr(i,1);)i--;t=t.substr(i+1),e=e.substr(i+1),n=t.split("/");var r=e.split("/");for(out="";n.shift();)out+="../";for(;curPart=r.shift();)out+=curPart+"/";return out.substr(0,out.length-1)}var c=function(e,t,n){for(var i,r,o=/@import\s*((?:"([^"]*)")|(?:'([^']*)'))|url\s*\(\s*(\s*(?:"([^"]*)")|(?:'([^']*)')|[^\)]*\s*)\s*\)/gi;i=o.exec(e);){var s;s=a(r=i[3]||i[2]||i[5]||i[6]||i[4],t,n);var u=i[5]||i[6]?1:0;e=e.substr(0,o.lastIndex-r.length-u-1)+s+e.substr(o.lastIndex-u-1),o.lastIndex=o.lastIndex+(s.length-r.length)}return e};return c.convertURIBase=a,c.absoluteURI=s,c.relativeURI=u,c}),define("css",[],function(){if("undefined"==typeof window)return{load:function(e,t,n){n()}};var e=document.getElementsByTagName("head")[0],t=window.navigator.userAgent.match(/Trident\/([^ ;]*)|AppleWebKit\/([^ ;]*)|Opera\/([^ ;]*)|rv\:([^ ;]*)(.*?)Gecko\/([^ ;]*)|MSIE\s([^ ;]*)|AndroidWebKit\/([^ ;]*)/)||0,n=!1,i=!0;t[1]||t[7]?n=parseInt(t[1])<6||parseInt(t[7])<=9:t[2]||t[8]||"WebkitAppearance"in document.documentElement.style?i=!1:t[4]&&(n=parseInt(t[4])<18);var r,o,a={};a.pluginBuilder="require-css/css-builder";var s,u=function(){r=document.createElement("style"),e.appendChild(r),o=r.styleSheet||r.sheet},c=0,l=[],d=function(e){o.addImport(e),r.onload=function(){p()},31==++c&&(u(),c=0)},p=function(){s();var e=l.shift();e?(s=e[1],d(e[0])):s=null};return a.normalize=function(e,t){return".css"==e.substr(e.length-4,4)&&(e=e.substr(0,e.length-4)),t(e)},a.load=function(t,a,c,p){(n?function(e,t){if(o&&o.addImport||u(),o&&o.addImport)s?l.push([e,t]):(d(e),s=t);else{r.textContent='@import "'+e+'";';var n=setInterval(function(){try{r.sheet.cssRules,clearInterval(n),t()}catch(e){}},10)}}:function(t,n){var r=document.createElement("link");if(r.type="text/css",r.rel="stylesheet",i)r.onload=function(){r.onload=function(){},setTimeout(n,7)};else var o=setInterval(function(){for(var e=0;e<document.styleSheets.length;e++)if(document.styleSheets[e].href==r.href)return clearInterval(o),n()},10);r.href=t,e.appendChild(r)})(a.toUrl(t+".css"),c)},a}),define("css!app/orders/assets/commentPopover",[],function(){}),define("app/orders/util/commentPopover",["underscore","jquery","app/i18n","app/broker","app/viewport","app/orders/templates/commentPopover","css!app/orders/assets/commentPopover.css"],function(e,t,n,i,r,o){"use strict";return{isVisible:function(e){return!!e.$commentPopover},hide:function(e,n){var r=e.$commentPopover;if(r){t(document.body).click(),i.publish("orders.commentPopover.hiding",{$menu:r});var o=r.data("options");t(window).off(".commentPopover."+e.idPrefix),t(document.body).off(".commentPopover."+e.idPrefix),r.data("backdrop").remove(),r.removeData("backdrop"),r.removeData("options"),!1===o.animate||!1===n?r.remove():r.fadeOut("fast",function(){r.remove()}),e.$commentPopover=null,i.publish("orders.commentPopover.hidden")}},show:function(e,n,a,s,u){u||(u={});var c=this.hide.bind(this,e);c(!1);var l=t(o({className:u.className||"",top:a}));l.on("mousedown",function(e){if(1!==e.which)return!1;e.stopPropagation()}),l.on("mouseup",function(e){if(1!==e.which)return!1}),l.on("contextmenu",!1),l.on("submit",function(){var t=l.find(".form-control").val().trim();if(!t.length)return c(),!1;if(!t.replace(/[^0-9a-zA-Z]+/g,"").length)return l.find(".form-control").val("").focus(),!1;r.msg.saving();var i=l.find(".btn-primary").prop("disabled",!0),o=e.ajax({method:"POST",url:"/orders/"+n,data:JSON.stringify({comment:t,source:u.source||"other"})});return o.fail(function(){r.msg.savingFailed(),i.prop("disabled",!1)}),o.done(function(){r.msg.saved(),c()}),!1}),l.find(".btn-link").on("click",c),l.find(".form-control").on("keyup",function(e){if(e.ctrlKey&&"Enter"===e.key)return l.find(".btn-primary").click(),!1});var d=t('<div class="planning-menu-backdrop"></div>').one("mousedown",c);l.data("backdrop",d),l.data("options",u),t(window).on("keydown.commentPopover."+e.idPrefix,function(e){if("Escape"===e.key)return c(),!1}),t(document.body).one("mousedown.commentPopover."+e.idPrefix,function(e){u.hideFilter&&!u.hideFilter(e)||c()}).append(d).append(l),e.$commentPopover=l,this.position(e,a,s),!1!==u.autoFocus&&l.find("textarea").focus(),i.publish("orders.commentPopover.shown",{$menu:l})},position:function(t,n,i){if(t.$commentPopover){var r=t.$commentPopover,o=r.outerWidth(),a=r.outerHeight();i+o>=document.body.clientWidth&&(i-=i+o-document.body.clientWidth+5);var s=window.innerHeight+window.pageYOffset;n+a>=s&&(n-=n+a-s+5),r.css({top:n+"px",left:i+"px"}),e.assign(r.data("options"),{top:n,left:i})}}}}),define("app/planning/templates/contextMenu",["underscore","jquery","app/i18n","app/time","app/user","app/core/util/forms"],function(_,$,t,time,user,forms){return function anonymous(locals,escapeFn,include,rethrow){escapeFn=escapeFn||function(e){return void 0==e?"":String(e).replace(_MATCH_HTML,encode_char)};var _ENCODE_HTML_RULES={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&#34;","'":"&#39;"},_MATCH_HTML=/[&<>'"]/g;function encode_char(e){return _ENCODE_HTML_RULES[e]||e}var __output="";function __append(e){void 0!==e&&null!==e&&(__output+=e)}with(locals||{})__append('<ul class="dropdown-menu planning-menu '),__append(className),__append('" style="top: '),__append(top),__append('px; left: -1000px">\n  '),menu.forEach(function(e,t){__append("\n  "),"header"===e.type?(__append('\n  <li class="dropdown-header">'),__append(e.label),__append("</li>\n  ")):"divider"===e.type?__append('\n  <li class="divider"></li>\n  '):(__append('\n  <li data-action="'),__append(t),__append('">\n    '),e.template?(__append("\n    "),__append(e.template({i:t,item:e})),__append("\n    ")):(__append('\n    <a data-action="'),__append(t),__append('" class="'),__append(e.disabled?"planning-menu-disabled":""),__append('" '),__append(e.disabled?"":'tabindex="100000"'),__append(">\n      "),icons?(__append('\n      <i class="fa '),__append(e.icon||"fa-blank"),__append('"></i><span>'),__append(e.label),__append("</span>\n      ")):(__append("\n      "),__append(e.label),__append("\n      ")),__append("\n    </a>\n    ")),__append("\n  </li>\n  ")),__append("\n  ")}),__append("\n</ul>\n");return __output}}),define("app/nls/planning",["app/nls/locale/en"],function(e){var t={lc:{pl:function(t){return e(t)},en:function(t){return e(t)}},c:function(e,t){if(!e)throw new Error("MessageFormat: Data required for '"+t+"'.")},n:function(e,t,n){if(isNaN(e[t]))throw new Error("MessageFormat: '"+t+"' isn't a number.");return e[t]-(n||0)},v:function(e,n){return t.c(e,n),e[n]},p:function(e,n,i,r,o){return t.c(e,n),e[n]in o?o[e[n]]:(n=t.lc[r](e[n]-i))in o?o[n]:o.other},s:function(e,n,i){return t.c(e,n),e[n]in i?i[e[n]]:i.other}};return{root:{"BREADCRUMB:base":function(e){return"Daily plans"},"BREADCRUMB:wh":function(e){return"WH (old)"},"BREADCRUMB:settings":function(e){return"Settings"},"BREADCRUMB:changes":function(e){return"Change history"},"MSG:GENERATING":function(e){return"<i class='fa fa-spinner fa-spin'></i><span>Generating the plan...</span>"},"MSG:export:started":function(e){return"Exporting..."},"MSG:export:failure":function(e){return"Exporting failed."},"PAGE_ACTION:hourlyPlans":function(e){return"Hourly plans"},"PAGE_ACTION:dailyPlan":function(e){return"Daily plan"},"PAGE_ACTION:paintShop":function(e){return"Paint shop"},"PAGE_ACTION:wh":function(e){return"WH"},"PAGE_ACTION:wh:old":function(e){return"Old module"},"PAGE_ACTION:wh:new":function(e){return"New module"},"PAGE_ACTION:wh:problems":function(e){return"Problem list"},"PAGE_ACTION:legend":function(e){return"Legend"},"PAGE_ACTION:changes":function(e){return"Change history"},"PAGE_ACTION:settings":function(e){return"Settings"},"PAGE_ACTION:settings:copy":function(e){return"Copy line settings"},"PAGE_ACTION:settings:orderGroups":function(e){return"Order groups"},"PAGE_ACTION:toggleChanges:expand":function(e){return"Expand"},"PAGE_ACTION:toggleChanges:collapse":function(e){return"Collapse"},"filter:date":function(e){return"Plan date"},"filter:division":function(e){return"Division"},"filter:mrps":function(e){return"All MRP"},"filter:mrps:1":function(e){return"Selected MRP"},"filter:mrps:0":function(e){return"Ignored MRP"},"filter:mrps:mine":function(e){return"Mine"},"filter:mrps:wh":function(e){return"WH"},"filter:mrps:placeholder":function(e){return"All"},"filter:lines":function(e){return"Production lines"},"filter:lines:placeholder":function(e){return"All lines"},"filter:whStatuses":function(e){return"Stage"},"filter:psStatuses":function(e){return"Paint-shop status"},"filter:wrapLists":function(e){return"List wrapping"},"filter:lineOrdersList":function(e){return"Order list"},"filter:useLatestOrderData":function(e){return"Latest order data"},"filter:useDarkerTheme":function(e){return"High contrast"},"filter:copyOrderList":function(e){return"Copy order list"},"filter:export":function(e){return"Export..."},"filter:export:stats":function(e){return"...stats"},"filter:export:transport":function(e){return"...transport plan"},"filter:stats:quantity":function(e){return"Quantity:"},"filter:stats:manHours":function(e){return"Man-hours:"},"filter:stats:orders":function(e){return"Orders:"},"filter:stats:tooltip:todo":function(e){return"Total of all orders\nin selected MRPs"},"filter:stats:tooltip:late":function(e){return"Total of all\nlate orders\nin selected MRPs"},"filter:stats:tooltip:plan":function(e){return"Total of all\nplanned orders\nin selected MRPs"},"filter:stats:tooltip:remaining":function(e){return"Total of remaining\nin selected MRPs"},"filter:stats:todo":function(e){return"Todo"},"filter:stats:late":function(e){return"Late"},"filter:stats:plan":function(e){return"Plan"},"filter:stats:remaining":function(e){return"Remaining"},"filter:stats:executed":function(e){return"Executed"},"filter:stats:execution":function(e){return"Sequence execution"},"filter:startTime":function(e){return"Start"},"toolbar:printPlan":function(e){return"Print line plan"},"toolbar:printPlan:all":function(e){return"All lines"},"toolbar:showTimes":function(e){return"Show times"},"toolbar:copyOrderList":function(e){return"Copy list of planned orders\nto clipboard"},"toolbar:copyOrderList:0":function(e){return"All shifts"},"toolbar:copyOrderList:1":function(e){return"I shift"},"toolbar:copyOrderList:2":function(e){return"II shift"},"toolbar:copyOrderList:3":function(e){return"III shift"},"toolbar:copyOrderList:success":function(e){return"List copied to clipboard."},"toolbar:toggleLock:true":function(e){return"Unlock MRP"},"toolbar:toggleLock:false":function(e){return"Lock MRP"},"toolbar:stats:quantity":function(e){return"Quantity:"},"toolbar:stats:manHours":function(e){return"Man-hours:"},"toolbar:stats:orders":function(e){return"Orders:"},"toolbar:stats:tooltip:todo":function(e){return"Total of all orders\nin MRP"},"toolbar:stats:tooltip:late":function(e){return"Total of all\nlate orders\nin MRP"},"toolbar:stats:tooltip:plan":function(e){return"Total of all\nplanned orders\nin MRP"},"toolbar:stats:tooltip:remaining":function(e){return"Total of remaining\nin MRP"},"toolbar:stats:tooltip:execution:percent":function(e){return"Percent of execution\nof the planned sequence\nin the whole day"},"toolbar:stats:tooltip:execution:percent:shift":function(e){return"Percent of execution\nof the planned sequence\non shift "+t.v(e,"shiftNo")},"print:workerCount":function(e){return t.v(e,"count")+" "+t.p(e,"count",0,"en",{one:"person",other:"people"})},"print:workerCounts":function(e){return t.v(e,"from")+"-"+t.v(e,"to")+" "+t.p(e,"to",0,"en",{one:"person",other:"people"})},"list:generate":function(e){return"Force<br>plan<br>creation"},"list:mrpCount":function(e){return t.v(e,"str")+" "+t.p(e,"num",0,"en",{one:"family",other:"families"})},"list:lineCount":function(e){return t.v(e,"str")+" "+t.p(e,"num",0,"en",{one:"line",other:"lines"})},"list:orderCount":function(e){return t.v(e,"str")+" "+t.p(e,"num",0,"en",{one:"order",other:"orders"})},"list:quantity":function(e){return t.v(e,"str")+" pce"},"list:manHours":function(e){return t.v(e,"str")+" mh"},"list:from":function(e){return"from "+t.v(e,"time")},"list:to":function(e){return"to "+t.v(e,"time")},empty:function(e){return"No plan for the specified filters."},locked:function(e){return"MRP is locked!"},"toggleLock:title:true":function(e){return"MRP unlocking"},"toggleLock:title:false":function(e){return"MRP locking"},"toggleLock:message:true":function(e){return"<p>Are you sure you want to unlock MRP <em>"+t.v(e,"mrp")+"</em>?</p><p>Unlocking will resume the plan recalculation for that MRP and might change the plan for Warehouse.</p>"},"toggleLock:message:false":function(e){return"<p>Are you sure you want to lock MRP <em>"+t.v(e,"mrp")+"</em>?</p><p>Locking will disable any changes to that MRP and will stop plan recalculation of all lines in the MRP.</p>"},"toggleLock:message:warning":function(e){return"Orders with the specified MRP were already picked up by the warehouse."},"toggleLock:yes:true":function(e){return"Unlock MRP"},"toggleLock:yes:false":function(e){return"Lock MRP"},"toggleLock:no:true":function(e){return"Leave locked"},"toggleLock:no:false":function(e){return"Leave unlocked"},"lines:hd":function(e){return"Lines"},"lines:division":function(e){return"Division"},"lines:prodFlow":function(e){return"Prod. flow"},"lines:prodLine":function(e){return"Line"},"lines:activeFrom":function(e){return"Active from"},"lines:activeTo":function(e){return"Active to"},"lines:activeTime":function(e){return"Activity time"},"lines:workerCount":function(e){return"Worker count"},"lines:orderPriority":function(e){return"Order priority"},"lines:frozenOrders":function(e){return"Frozen orders"},"lines:redirLine":function(e){return"Line redirection"},"lines:wh:pickup:started":function(e){return"Picking"},"lines:wh:pickup:finished":function(e){return"Picked"},"lines:wh:available":function(e){return"Available"},"lines:wh:sets":function(e){return"sets"},"lines:wh:qty":function(e){return"pce"},"lines:wh:time":function(e){return"time"},"lines:mrpPriority":function(e){return"MRP priority"},"lines:menu:header":function(e){return"Line "+t.v(e,"line")},"lines:menu:settings":function(e){return"Change line settings"},"lines:menu:remove":function(e){return"Remove line from MRP"},"lines:menu:remove:title":function(e){return"Removing line from MRP"},"lines:menu:remove:message":function(e){return"<p>Are you sure you want to remove line <em>"+t.v(e,"line")+"</em> from MRP<em>"+t.v(e,"mrp")+"</em>?</p><p>Change will affect only the plan for "+t.v(e,"plan")+".</p>"},"lines:menu:remove:yes":function(e){return"Remove line"},"lines:menu:remove:failure":function(e){return"Failed to remove line from MRP."},"lines:menu:settings:title":function(e){return"Changing line settings"},"lines:menu:settings:submit":function(e){return"Save settings"},"lines:menu:settings:line":function(e){return"Production line"},"lines:menu:settings:applyToAllMrps":function(e){return"Set the same <em>Worker count</em> and <em>Order priority</em> for line "+t.v(e,"line")+" in all assigned MRPs, and not only for "+t.v(e,"mrp")+"."},"lines:menu:mrpPriority":function(e){return"Change available lines"},"lines:menu:mrpPriority:title":function(e){return"Changing available lines on "+t.v(e,"mrp")},"lines:menu:mrpPriority:submit":function(e){return"Save line priority"},"lines:menu:mrpPriority:mrp":function(e){return"MRP"},"lines:menu:mrpPriority:line":function(e){return"Line"},"lines:menu:mrpPriority:line:placeholder":function(e){return"Add a new production line..."},"lines:menu:workerCount":function(e){return"Change worker count"},"lines:menu:workerCount:title":function(e){return"Changing worker count"},"lines:menu:workerCount:submit":function(e){return"Save worker count"},"lines:menu:workerCount:copy":function(e){return"Copy worker count"},"lines:menu:workerCount:paste":function(e){return"Paste worker count"},"lines:menu:workerCount:zero":function(e){return"Zero out worker count"},"lines:menu:orderPriority":function(e){return"Change order priority"},"lines:menu:orderPriority:title":function(e){return"Changing order priority"},"lines:menu:orderPriority:submit":function(e){return"Save order priority"},"lines:menu:orderPriority:copy":function(e){return"Copy priorities"},"lines:menu:orderPriority:paste":function(e){return"Paste priorities"},"lines:menu:orderGroupPriority":function(e){return"Change order group priority"},"lines:menu:orderGroupPriority:title":function(e){return"Changing order group priority"},"lines:menu:orderGroupPriority:submit":function(e){return"Save order group priority"},"lines:menu:orderGroupPriority:copy":function(e){return"Copy groups"},"lines:menu:orderGroupPriority:paste":function(e){return"Paste groups"},"lines:menu:freezeOrders":function(e){return"Freeze orders"},"lines:menu:freezeOrders:title":function(e){return"Freezing orders"},"lines:menu:freezeOrders:line":function(e){return"Lines"},"lines:menu:freezeOrders:availableOrders":function(e){return"Available orders"},"lines:menu:freezeOrders:frozenOrders":function(e){return"Frozen orders"},"lines:menu:freezeOrders:no":function(e){return"#"},"lines:menu:freezeOrders:order":function(e){return"Order"},"lines:menu:freezeOrders:quantity":function(e){return"Quantity"},"lines:menu:freezeOrders:actions":function(e){return"Actions"},"lines:menu:freezeOrders:submit":function(e){return"Freeze orders"},"lines:menu:freezeOrders:failure":function(e){return"Failed to freeze orders."},"lines:menu:freezeOrders:shift:1":function(e){return"I shift"},"lines:menu:freezeOrders:shift:2":function(e){return"I and II shifts"},"lines:menu:freezeOrders:shift:3":function(e){return"all shifts"},"lines:menu:redirLine:start":function(e){return"Redirect line"},"lines:menu:redirLine:stop":function(e){return"Stop redirection"},"lines:menu:deliveredOrders":function(e){return"Open delivered orders"},"orders:hd":function(e){return"Orders"},"orders:_id":function(e){return"Order no"},"orders:date":function(e){return"Date"},"orders:delayReason":function(e){return"Reason"},"orders:kind":function(e){return"Kind"},"orders:quantityDone":function(e){return"Quantity done"},"orders:quantityTodo":function(e){return"Quantity todo"},"orders:quantityPlan":function(e){return"Quantity to plan"},"orders:incomplete":function(e){return"Incomplete quantity"},"orders:hardComponent":function(e){return"Difficult component"},"orders:nc12":function(e){return"12NC"},"orders:name":function(e){return"Name"},"orders:operation":function(e){return"Operation"},"orders:machineTime":function(e){return"Machine Time"},"orders:laborTime":function(e){return"Labor Time"},"orders:manHours":function(e){return"Man-hours"},"orders:qty":function(e){return"Quantity"},"orders:mrp":function(e){return"MRP"},"orders:statuses":function(e){return"Status"},"orders:ignored":function(e){return"Ignored"},"orders:urgent":function(e){return"Urgent"},"orders:pinned":function(e){return"Pinned"},"orders:eto":function(e){return"ETO"},"orders:priority":function(e){return t.s(e,"priority",{E:"ETO Pilot",E:"ETO Pilot continuation",other:"Order priority"})},"orders:lines":function(e){return"Line"},"orders:source":function(e){return"Source"},"orders:source:plan":function(e){return"Planned"},"orders:source:added":function(e){return"Added"},"orders:source:incomplete":function(e){return"Incomplete"},"orders:source:late":function(e){return"Late"},"orders:psStatus:unknown":function(e){return"Not painted"},"orders:psStatus:new":function(e){return"Painting pending"},"orders:psStatus:started":function(e){return"Painting started"},"orders:psStatus:startedMsp":function(e){return"Painting started (MSP)"},"orders:psStatus:partial":function(e){return"Painted partially"},"orders:psStatus:finished":function(e){return"Painting finished"},"orders:psStatus:aside":function(e){return"Painting set aside"},"orders:psStatus:cancelled":function(e){return"Painting cancelled"},"orders:drillStatus:unknown":function(e){return"Not drilled"},"orders:drillStatus:new":function(e){return"Drilling pending"},"orders:drillStatus:started":function(e){return"Drilling started"},"orders:drillStatus:partial":function(e){return"Drilled partially"},"orders:drillStatus:finished":function(e){return"Drilling finished"},"orders:drillStatus:aside":function(e){return"Drilling set aside"},"orders:drillStatus:cancelled":function(e){return"Drilling cancelled"},"orders:whStatus:unknown":function(e){return"Unspecified"},"orders:whStatus:todo":function(e){return"Todo"},"orders:whStatus:done":function(e){return"Done"},"orders:dropZone":function(e){return t.v(e,"group")+" on "+t.v(e,"time")},"orders:qty:incomplete":function(e){return"("+t.v(e,"qty")+" incomplete)"},"orders:late":function(e){return"Late"},"orders:resized":function(e){return"Changed quantity"},"orders:comment":function(e){return"Last comment"},"orders:menu:header":function(e){return"Order "+t.v(e,"order")},"orders:menu:sapOrder":function(e){return"Open SAP order details"},"orders:menu:shiftOrder":function(e){return"Open line order details"},"orders:menu:comment":function(e){return"Comment order"},"orders:menu:urgent":function(e){return"Mark order as urgent"},"orders:menu:urgent:title":function(e){return"Urgent order"},"orders:menu:urgent:message":function(e){return"<p>Are you sure you want to mark the order <em>"+t.v(e,"order")+"</em> as <strong>urgent</strong>?</p><p>Urgent orders are planned at the beginning of the plan, ignoring the order priority.</p>"},"orders:menu:urgent:yes":function(e){return"Mark as urgent"},"orders:menu:urgent:failure":function(e){return"Failed to mark the order as urgent."},"orders:menu:unurgent":function(e){return"Mark as not urgent"},"orders:menu:unurgent:message":function(e){return"<p>Are you sure you want to mark the order <em>"+t.v(e,"order")+"</em> as <strong>not urgent</strong>?</p><p>Not urgent orders are planned according to the order priority.</p>"},"orders:menu:unurgent:yes":function(e){return"Mark as not urgent"},"orders:menu:ignore":function(e){return"Ignore order"},"orders:menu:ignore:title":function(e){return"Ignoring order"},"orders:menu:ignore:message":function(e){return"<p>Are you sure you want to ignore order <em>"+t.v(e,"order")+"</em>?</p><p>Ignored orders are not taken into consideration during planning.</p>"},"orders:menu:ignore:yes":function(e){return"Ignore order"},"orders:menu:ignore:failure":function(e){return"Failed to ignore order."},"orders:menu:unignore":function(e){return"Stop ignoring order"},"orders:menu:unignore:message":function(e){return"<p>Are you sure you want to stop ignoring order <em>"+t.v(e,"order")+"</em>?</p><p>Order will return to the planning queue.</p>"},"orders:menu:unignore:yes":function(e){return"Stop ignoring order"},"orders:menu:quantity":function(e){return"Change order quantity"},"orders:menu:quantity:title":function(e){return"Changing order quantity"},"orders:menu:quantity:quantityTodo":function(e){return"Quantity todo:"},"orders:menu:quantity:quantityDone":function(e){return"Quantity done:"},"orders:menu:quantity:quantityRemaining":function(e){return"Quantity remaining:"},"orders:menu:quantity:quantityPlan":function(e){return"Quantity to plan:"},"orders:menu:quantity:help":function(e){return"Be default, <em>Quantity to plan</em> is equal to <em>Quantity todo</em> or <em>Quantity remaining</em>, if the <em>Plan according to the remaining quantity</em> setting is enabled. This value can be overwritten here."},"orders:menu:quantity:submit":function(e){return"Save quantity to plan"},"orders:menu:quantity:failure":function(e){return"Failed to change the quantity"},"orders:menu:lines":function(e){return"Change pin to line"},"orders:menu:lines:title":function(e){return"Changing pin to line"},"orders:menu:lines:submit":function(e){return"Save pin to line"},"orders:menu:lines:failure":function(e){return"Failed to pin to line."},"orders:menu:lines:urgent":function(e){return"Urgent"},"orders:menu:lines:urgent:help":function(e){return"Urgent order can be pinned to any line ignoring the Order priority."},"orders:menu:add":function(e){return"Add order"},"orders:menu:remove":function(e){return"Remove order"},"orders:menu:remove:title":function(e){return"Removing order"},"orders:menu:remove:message":function(e){return"<p>Are you sure you want to remove the order <em>"+t.v(e,"order")+"</em> from the queue of the current plan?</p>"},"orders:menu:remove:yes":function(e){return"Remove order"},"orders:menu:remove:failure":function(e){return"Failed to remove order."},"orders:menu:dropZone":function(e){return"Set drop zone"},"orders:menu:dropZone:title":function(e){return"Setting drop zone"},"orders:menu:dropZone:submit":function(e){return"Set drop zone"},"orders:menu:dropZone:failure":function(e){return"Failed to set the drop zone."},"orders:menu:dropZone:dropZone":function(e){return"Drop zone group"},"orders:menu:dropZone:time":function(e){return"Time"},"orders:menu:dropZone:status":function(e){return"Status"},"orders:menu:dropZone:orders":function(e){return"Orders to change"},"orders:menu:dropZone:comment":function(e){return"Optional WH comment"},"orders:add":function(e){return"Add order"},"orders:add:title":function(e){return"Adding order"},"orders:add:submit":function(e){return"Add order"},"orders:add:failure":function(e){return"Failed to add order."},"orders:add:invalidOrderNo":function(e){return"Enter a valid, 9-digit order number."},"orders:add:searching":function(e){return"<i class='fa fa-spinner fa-spin'></i><span>Looking for order...</span>"},"orders:add:searchFailed":function(e){return"<i class='fa fa-spinner'></i><span>Failed searching for order.</span>"},"orders:add:ORDER_NOT_FOUND":function(e){return"Order doesn't exist."},"orders:add:alreadyExists":function(e){return"Order already exists in the current plan."},"orders:add:future":function(e){return"Order is planned for the future."},"orders:add:undefinedMrp":function(e){return"Order MRP is not defined in the current plan."},"orders:add:requiredStatus":function(e){return"Order doesn't have the required statuses."},"orders:add:ignoredStatus":function(e){return"Order has ignored statuses."},"orders:add:orderNo":function(e){return"Order no"},"orders:add:urgent":function(e){return"Urgent"},"orders:add:plans":function(e){return"Planned on"},"lateOrders:hd":function(e){return"Late"},"lateOrders:action":function(e){return"Add late orders"},"lateOrders:add:title":function(e){return"Adding late orders"},"lateOrders:add:failure":function(e){return"Failed to add late orders."},"lateOrders:add:orders":function(e){return"Late orders:"},"lateOrders:add:submit":function(e){return"Add late orders"},"lineOrders:orderNo":function(e){return"Order no"},"lineOrders:unit":function(e){return"PCE"},"lineOrders:qty:planned":function(e){return"Quantity planned"},"lineOrders:qty:done":function(e){return"Quantity done"},"lineOrders:qty:remaining":function(e){return"Quantity remaining"},"lineOrders:qty:total":function(e){return"Total quantity"},"lineOrders:qty:incomplete":function(e){return"Incomplete quantity"},"lineOrders:pceTime":function(e){return"PCE time"},"lineOrders:manHours":function(e){return"Man-hours"},"lineOrders:time":function(e){return"Start-end time"},"lineOrders:duration":function(e){return"Duration"},"lineOrders:incomplete":function(e){return"("+t.v(e,"qty")+" incomplete)"},"lineOrders:downtimeReason":function(e){return"Downtime reason"},"lineOrders:comment":function(e){return"Last comment"},"lineOrders:list:group":function(e){return"Gr."},"lineOrders:list:no":function(e){return"No"},"lineOrders:list:shift":function(e){return"Sh."},"lineOrders:list:mrp":function(e){return"MRP"},"lineOrders:list:orderNo":function(e){return"Order"},"lineOrders:list:nc12":function(e){return"12NC"},"lineOrders:list:name":function(e){return"Product name"},"lineOrders:list:qtyPlan":function(e){return"Quantity planned"},"lineOrders:list:qtyTodo":function(e){return"Quantity todo"},"lineOrders:list:qty:header":function(e){return"Quantity"},"lineOrders:list:qty:value":function(e){return t.v(e,"plan")+" of "+t.v(e,"todo")},"lineOrders:list:startTime":function(e){return"Start"},"lineOrders:list:finishTime":function(e){return"Finish"},"lineOrders:list:status":function(e){return"Status"},"lineOrders:list:lines":function(e){return"Lines"},"lineOrders:list:line":function(e){return"Line"},"lineOrders:list:dropZone":function(e){return"Drop zone"},"lineOrders:list:whStatus":function(e){return"Stage"},"lineOrders:list:comment":function(e){return"Last comment"},"lineOrders:list:orderGroup":function(e){return"Order group"},"lineOrders:menu:copy":function(e){return"Copy order list"},"lineOrders:menu:copy:success":function(e){return"Order list copied to clipboard."},"wh:menu:copy:lineGroup":function(e){return"Copy order list <em>"+t.v(e,"group")+". "+t.v(e,"line")+"</em>"},"wh:menu:copy:lineGroupNo":function(e){return"Copy order numbers <em>"+t.v(e,"group")+". "+t.v(e,"line")+"</em>"},"wh:menu:export":function(e){return"Export orders"},"wh:status:all":function(e){return"All"},"wh:status:0":function(e){return"Unspecified"},"wh:status:1":function(e){return"List"},"wh:status:2":function(e){return"Buffer"},"wh:status:3":function(e){return t.p(e,"qtySent",0,"en",{0:"Distribution",other:"Sent "+t.v(e,"qtySent")+" szt."})},"wh:sent:comment":function(e){return"Sent "+t.v(e,"qtySent")+" PCE to line "+t.v(e,"line")+" "+t.v(e,"date")+" at "+t.v(e,"time")+"."},"wh:sent:label":function(e){return"Quantity<br>Sent:"},"wh:export:fileName":function(e){return"WMES_PLAN_WH_"+t.v(e,"date")},"wh:export:sheetName":function(e){return"WH plan "+t.v(e,"date")},"stats:export:title":function(e){return"Exporting stats"},"stats:export:mrps":function(e){return"MRP"},"stats:export:lines":function(e){return"Lines"},"stats:export:submit":function(e){return"Export stats"},"stats:export:fileName":function(e){return"WMES_Plan_Execution_"+t.v(e,"from")+"_"+t.v(e,"to")},"stats:export:sheetName":function(e){return"Plan exec. "+t.v(e,"from")+"-"+t.v(e,"to")},"stats:date":function(e){return"Date"},"stats:division":function(e){return"Division"},"stats:mrp":function(e){return"MRP"},"stats:line":function(e){return"Line"},"stats:orderCount":function(e){return"Order count"},"stats:quantity":function(e){return"Quantity"},"stats:manHours":function(e){return"Man-hours"},"stats:hourlyPlan":function(e){return"Hourly plan"},"transport:export:title":function(e){return"Exporting transport plan"},"transport:export:mrps":function(e){return"MRP"},"transport:export:lines":function(e){return"Lines"},"transport:export:submit":function(e){return"Export transport plan"},"transport:export:fileName":function(e){return"WMES_Plan_Transport"},"transport:export:sheetName":function(e){return"Plan trans. "+t.v(e,"from")+"-"+t.v(e,"to")},"transport:date":function(e){return"Date"},"transport:time":function(e){return"Time"},"transport:shiftNo":function(e){return"Shift"},"transport:line":function(e){return"Line"},"transport:mrp":function(e){return"MRP"},"transport:orderNo":function(e){return"Production order"},"transport:salesOrderNo":function(e){return"Sales order"},"transport:salesOrderItem":function(e){return"Sales order item"},"transport:quantity":function(e){return"Quantity"},"orderStatus:planned":function(e){return"Planned"},"orderStatus:unplanned":function(e){return"Not planned"},"orderStatus:incomplete":function(e){return"Incomplete"},"orderStatus:started":function(e){return"Started"},"orderStatus:completed":function(e){return"Completed"},"orderStatus:surplus":function(e){return"Surplus"},"orderPriority:unclassified":function(e){return"Unclassified"},"orderPriority:small":function(e){return"Small"},"orderPriority:medium":function(e){return"Medium"},"orderPriority:big":function(e){return"Big"},"orderPriority:easy":function(e){return"Easy"},"orderPriority:hard":function(e){return"Difficult"},"settings:title":function(e){return"Plan settings edit form"},"settings:msg:success":function(e){return"Settings saved successfully."},"settings:msg:failure":function(e){return"Failed to save the settings!"},"settings:submit":function(e){return"Save settings"},"settings:common":function(e){return"Common settings"},"settings:forceWorkDay":function(e){return"Force work day"},"settings:forceWorkDay:help":function(e){return"Treat this date as a working day (plan will be generated even if there are no orders for the specified date)."},"settings:freezeHour":function(e){return"Order freeze hour"},"settings:freezeHour:help":function(e){return"Hour after which the planned orders will be automatically frozen. Orders are frozen after the first SAP order import up to 30 minutes before the specified hour (if the import occurs), or after the first plan recalculation after the specified hour. For example, given a plan for 2018-01-12 with Freeze hour set to 23, the orders will be frozen 2018-01-11 at 22:45, if at 22:45 SAP orders will be imported or after the first manual plan change after hour 23:00."},"settings:lateHour":function(e){return"Late order start hour"},"settings:lateHour:help":function(e){return"Hour from which the manually added, urgent orders (late) can be planned."},"settings:etoPilotHour":function(e){return"ETO pilot start hour"},"settings:etoPilotHour:help":function(e){return"Hour from which orders with the <em>E</em> priority (ETO pilot) can be planned."},"settings:minIncompleteDuration":function(e){return"Min. duration of last order [min]"},"settings:minIncompleteDuration:help":function(e){return"Order will not be planned on line if it would be the last order, incomplete and the duration of the part that fits is shorter than the specified number of minutes."},"settings:schedulingRate":function(e){return"Scheduling rate"},"settings:schedulingRate:help":function(e){return"Coefficient that changes the time required to do a single PCE: <code>OrderLaborTime / 100 / LineWorkerCount * 3600 * SchedulingRate</code>"},"settings:requiredStatuses":function(e){return"Required statuses"},"settings:requiredStatuses:help":function(e){return"List of all statuses that an order must have to be taken into consideration during planning."},"settings:ignoredStatuses":function(e){return"Ignored statuses"},"settings:ignoredStatuses:help":function(e){return"List of statuses that an order must not have to be taken into consideration during planning."},"settings:completedStatuses":function(e){return"Completed order statuses"},"settings:completedStatuses:help":function(e){return"List of ignored statuses that determine whether an order is completed. Order with these statuses will remain in the plan, but won't be planned on lines."},"settings:ignoredWorkCenters":function(e){return"Ignored WorkCenters"},"settings:ignoredWorkCenters:help":function(e){return"List of WorkCenters that the chosen order's operation must not have to be taken into consideration during planning."},"settings:ignoreCompleted":function(e){return"Ignore completed orders"},"settings:ignoreCompleted:help":function(e){return"Orders with <em>Total quantity done</em> greater or equal to <em>Total quantity todo</em> will not be taken into consideration during planning."},"settings:useRemainingQuantity":function(e){return"Plan according to the remaining quantity"},"settings:useRemainingQuantity:help":function(e){return"Use the order's <em>Remaining quantity</em> instead of <em>Total quantity todo</em>. Remaining quantity is equal to <em>Total quantity todo</em> minus <em>Total quantity done</em>."},"settings:hardComponents":function(e){return"Difficult components"},"settings:hardComponents:help":function(e){return"An order will be classified as <em>Difficult</em> if it contains one of the following components. Quantity and man-hours don't matter."},"settings:hardBigComponents:help":function(e){return"A <em>Big</em> order will be classified as <em>Difficult</em> if it contains one of the following components."},"settings:line":function(e){return"Line settings"},"settings:line:placeholder":function(e){return"Production line..."},"settings:mrpPriority":function(e){return"MRP priority"},"settings:mrpPriority1:help":function(e){return"List of production order MRPs that can be done on this line. Order matters."},"settings:mrpPriority2:help":function(e){return"List of production order MRPs that can be done on this line."},"settings:mrpPriority:placeholder":function(e){return"MRP controllers..."},"settings:orderGroupPriority":function(e){return"Order group priority"},"settings:orderGroupPriority:help":function(e){return"List of order groups that can be done on this line. Order matters."},"settings:orderGroupPriority:placeholder":function(e){return"Order groups..."},"settings:activeTime":function(e){return"Activity time"},"settings:activeTime:help":function(e){return"Time of line availability on a given day. The value applies to all assigned MRP controllers."},"settings:extraCapacity":function(e){return"Extra capacity"},"settings:extraCapacity:help":function(e){return"Last order may exceed the available activity time, if it will fully fit within the additional capacity. Minutes or a percentage of the total available time may be entered."},"settings:mrp":function(e){return"MRP controller settings"},"settings:mrp:help":function(e){return"Select an MRP controller for which you want to define settings"},"settings:mrp:placeholder":function(e){return"MRP controller..."},"settings:limitSmallOrders":function(e){return"Limit small orders"},"settings:limitSmallOrders:help":function(e){return"During the first planning pass, the number of small orders that can be placed on a single line is limited by the number of lines that accept small orders. For example, MRP has 30 small orders and 5 lines that accept small orders. If the option is disabled, the first line will be completely filled with small orders. If the option is enabled, then each line will have 30/5=6 small orders."},"settings:extraOrderSeconds":function(e){return"Extra order duration"},"settings:extraOrderSeconds:help":function(e){return"Number of seconds added to each planned order except the one stared at the beginning of the production shift."},"settings:extraShiftSeconds":function(e){return"Time to start the shift"},"settings:extraShiftSeconds:1":function(e){return"Time to start the I shift"},"settings:extraShiftSeconds:2":function(e){return"Time to start the II shift"},"settings:extraShiftSeconds:3":function(e){return"Time to start the III shift"},"settings:extraShiftSeconds:help":function(e){return"Number of seconds added to the first order at the beginning of the production shift."},"settings:bigOrderQuantity":function(e){return"Big order"},"settings:bigOrderQuantity:help":function(e){return"Minimum quantity todo, after which the order is classified as <em>Big</em>. Big orders can be <em>Easy</em> or <em>Difficult</em>."},"settings:hardOrderManHours":function(e){return"Difficult order"},"settings:hardOrderManHours:help":function(e){return"Minimum number of man-hours, after which a <em>Big</em> order is classified as <em>Difficult</em>."},"settings:splitOrderQuantity":function(e){return"Order split quantity"},"settings:splitOrderQuantity:help":function(e){return"Minimum quantity todo, after which a <em>Big</em> order is split into multiple parts."},"settings:maxSplitLineCount":function(e){return"Order parts"},"settings:maxSplitLineCount:help":function(e){return"Maximum number of lines for which a <em>Big</em> order can be split. Zero - maximum available number of lines."},"settings:mrpLine":function(e){return"Line in MRP settings"},"settings:mrpLine:help":function(e){return"Select a line for which you want to define settings in the context of the selected MRP controller."},"settings:mrpLine:placeholder":function(e){return"Production line..."},"settings:workerCount":function(e){return"Worker count"},"settings:workerCount:shift":function(e){return"shift "+t.v(e,"shiftNo")+":"},"settings:orderPriority":function(e){return"Order priority"},"settings:orderPriority1:help":function(e){return"Order of production orders based on their classification: small, easy, difficult. Easy and difficult orders are also big."},"settings:orderPriority2:help":function(e){return"Order of production orders based on their classification: small, medium, big."},"settings:orderPriority:placeholder":function(e){return"Order kinds..."},"settings:linePriority":function(e){return"Line priority"},"settings:linePriority:help":function(e){return"Order of production lines during planning."},"settings:groups":function(e){return"Groups"},"settings:groups:no":function(e){return"No"},"settings:groups:splitOrderQuantity":function(e){return"Split quantity"},"settings:groups:lines":function(e){return"Lines"},"settings:groups:components":function(e){return"Components"},"settings:groups:add":function(e){return"Add group"},"settings:groups:remove":function(e){return"Remove group"},"settings:locked":function(e){return"Locked"},"settings:tab:wh":function(e){return"Warehouse"},"settings:wh:groupDuration":function(e){return"Order group duration [h]"},"settings:wh:groupExtraItems":function(e){return"Minimum quantity in group"},"settings:wh:groupExtraItems:help":function(e){return"If quantity of an order in the first/last group of a given line is lower or equal to the specified value, then that group will be merged with the next/previous group."},"settings:wh:sortByLines":function(e){return"Sort orders in groups by line"},"settings:wh:ignoredMrps":function(e){return"Ignored MRP (in the old module)"},"settings:wh:newIncludedMrps":function(e){return"Disabled MRP"},"changes:hd":function(e){return"<span class='planning-change-when'>"+t.v(e,"when")+"</span> by <span class='planning-change-who'>"+t.v(e,"who")+"</span>: <span class='planning-change-what'>"+t.v(e,"what")+"</span>"},"changes:what:settings":function(e){return t.v(e,"count")+" setting "+t.p(e,"count",0,"en",{one:"change",other:"changes"})},"changes:what:addedOrders":function(e){return t.v(e,"count")+" added "+t.p(e,"count",0,"en",{one:"order",other:"orders"})},"changes:what:changedOrders":function(e){return t.v(e,"count")+" changed "+t.p(e,"count",0,"en",{one:"order",other:"orders"})},"changes:what:removedOrders":function(e){return t.v(e,"count")+" deleted "+t.p(e,"count",0,"en",{one:"order",other:"orders"})},"changes:what:changedLines":function(e){return t.v(e,"count")+" changed "+t.p(e,"count",0,"en",{one:"line plan",other:"line plans"})},"changes:removedOrders:REQUIRED_STATUS":function(e){return"No required status: "+t.v(e,"requiredStatus")+"."},"changes:removedOrders:IGNORED_STATUS":function(e){return"Ignored status: "+t.v(e,"ignoredStatus")+"."},"changes:removedOrders:MISSING_ORDER":function(e){return"Missing SAP order for the given day."},"changes:removedOrders:INCOMPLETE_DONE":function(e){return"Incomplete order from the previous day was completed."},"changes:settings:lines:remove":function(e){return"Removed line <em>"+t.v(e,"line")+"</em>"},"changes:settings:mrps:remove":function(e){return"Removed MRP <em>"+t.v(e,"mrp")+"</em>"},"changes:settings:mrpLines:remove":function(e){return"Removed line <em>"+t.v(e,"line")+"</em> from MRP <em>"+t.v(e,"mrp")+"</em>"},"changes:settings:lines:change":function(e){return"Changed line <em>"+t.v(e,"line")+"</em>: <em>"+t.v(e,"property")+"</em>: "},"changes:settings:mrps:change":function(e){return"Changed MRP <em>"+t.v(e,"mrp")+"</em>: <em>"+t.v(e,"property")+"</em>: "},"changes:settings:mrpLines:change":function(e){return"Changed line <em>"+t.v(e,"line")+"</em> in MRP <em>"+t.v(e,"mrp")+"</em>: <em>"+t.v(e,"property")+"</em>: "},"changes:settings:lines:add":function(e){return"Added line <em>"+t.v(e,"line")+"</em>"},"changes:settings:mrps:add":function(e){return"Added MRP <em>"+t.v(e,"mrp")+"</em>"},"changes:settings:mrpLines:add":function(e){return"Added line <em>"+t.v(e,"line")+"</em> to MRP <em>"+t.v(e,"mrp")+"</em>"},"copySettings:title":function(e){return"Copying line settings"},"copySettings:submit":function(e){return"Copy settings"},"copySettings:source":function(e){return"Source plan"},"copySettings:target":function(e){return"Target plans"},"copySettings:target:all":function(e){return"All"},"copySettings:target:empty":function(e){return"No target plans."},"copySettings:mrps":function(e){return"MRP to copy"},"copySettings:mrps:all":function(e){return"All"},"copySettings:mrps:empty":function(e){return"No MRPs to copy are selected."},"copySettings:what":function(e){return"Copy"},"copySettings:what:empty":function(e){return"No settings to copy are selected."},"copySettings:what:workerCount":function(e){return"Worker count"},"copySettings:what:activeTime":function(e){return"Activity time"},"copySettings:what:orderPriority":function(e){return"Order priority"},"copySettings:what:linePriority":function(e){return"Line priority"},"copySettings:what:orderGroupPriority":function(e){return"Order group priority"},"copySettings:what:extraCapacity":function(e){return"Extra capacity"},"copySettings:what:mrpPriority":function(e){return"MRP priority"},"copySettings:what:lineGroups":function(e){return"Line groups"},"copySettings:what:mrpSettings":function(e){return"MRP settings (small order, extra order time...)"},"copySettings:failure:fetchSettings":function(e){return"Failed to fetch settings for "+t.v(e,"plan")+"."},"lockReason:mrp":function(e){return"MRP "+t.v(e,"mrp")+" is locked directly."},"lockReason:line":function(e){return"Line "+t.v(e,"line")+" is assigned to a locked MRP: "+t.v(e,"mrps")},"planExecution:title:all":function(e){return"Plan execution"},"planExecution:title:mrp":function(e){return"Plan execution for "+t.v(e,"mrp")}},pl:!0}}),define("app/nls/pl/planning",["app/nls/locale/pl"],function(e){var t={lc:{pl:function(t){return e(t)},en:function(t){return e(t)}},c:function(e,t){if(!e)throw new Error("MessageFormat: Data required for '"+t+"'.")},n:function(e,t,n){if(isNaN(e[t]))throw new Error("MessageFormat: '"+t+"' isn't a number.");return e[t]-(n||0)},v:function(e,n){return t.c(e,n),e[n]},p:function(e,n,i,r,o){return t.c(e,n),e[n]in o?o[e[n]]:(n=t.lc[r](e[n]-i))in o?o[n]:o.other},s:function(e,n,i){return t.c(e,n),e[n]in i?i[e[n]]:i.other}};return{"BREADCRUMB:base":function(e){return"Plany dzienne"},"BREADCRUMB:wh":function(e){return"Magazyn (stary)"},"BREADCRUMB:settings":function(e){return"Ustawienia"},"BREADCRUMB:changes":function(e){return"Historia zmian"},"MSG:GENERATING":function(e){return"<i class='fa fa-spinner fa-spin'></i><span>Generowanie planu...</span>"},"MSG:export:started":function(e){return"Eksportowanie..."},"MSG:export:failure":function(e){return"Eksportowanie nie powiodło się."},"PAGE_ACTION:hourlyPlans":function(e){return"Plany godzinowe"},"PAGE_ACTION:dailyPlan":function(e){return"Plan dzienny"},"PAGE_ACTION:paintShop":function(e){return"Malarnia"},"PAGE_ACTION:wh":function(e){return"Magazyn"},"PAGE_ACTION:wh:old":function(e){return"Stary moduł"},"PAGE_ACTION:wh:new":function(e){return"Nowy moduł"},"PAGE_ACTION:wh:problems":function(e){return"Lista problemów"},"PAGE_ACTION:legend":function(e){return"Legenda"},"PAGE_ACTION:changes":function(e){return"Historia zmian"},"PAGE_ACTION:settings":function(e){return"Ustawienia"},"PAGE_ACTION:settings:copy":function(e){return"Kopiuj ustawienia linii"},"PAGE_ACTION:settings:orderGroups":function(e){return"Grupy zleceń"},"PAGE_ACTION:toggleChanges:expand":function(e){return"Rozwiń"},"PAGE_ACTION:toggleChanges:collapse":function(e){return"Zwiń"},"filter:date":function(e){return"Data planu"},"filter:division":function(e){return"Wydział"},"filter:mrps":function(e){return"MRP"},"filter:mrps:1":function(e){return"Wybrane MRP"},"filter:mrps:0":function(e){return"Ignorowane MRP"},"filter:mrps:mine":function(e){return"Moje"},"filter:mrps:wh":function(e){return"Magazyn"},"filter:mrps:placeholder":function(e){return"Wszystkie MRP"},"filter:lines":function(e){return"Linie produkcyjne"},"filter:lines:placeholder":function(e){return"Wszystkie linie"},"filter:whStatuses":function(e){return"Etap"},"filter:psStatuses":function(e){return"Status malarnii"},"filter:wrapLists":function(e){return"Przewijanie list"},"filter:lineOrdersList":function(e){return"Lista zleceń"},"filter:useLatestOrderData":function(e){return"Najnowsze zlecenia"},"filter:useDarkerTheme":function(e){return"Wysoki kontrast"},"filter:copyOrderList":function(e){return"Kopiuj listę zleceń"},"filter:export":function(e){return"Eksportuj..."},"filter:export:stats":function(e){return"...statystyki"},"filter:export:transport":function(e){return"...plan transportu"},"filter:stats:quantity":function(e){return"Sztuki:"},"filter:stats:manHours":function(e){return"RBH:"},"filter:stats:orders":function(e){return"Zlecenia:"},"filter:stats:tooltip:todo":function(e){return"Suma wszystkich zleceń\nw wybranych MRP"},"filter:stats:tooltip:late":function(e){return"Suma wszystkich\nopóźnionych zleceń\nw wybranych MRP"},"filter:stats:tooltip:plan":function(e){return"Suma wszystkich zleceń\nrozplanowanych na liniach\nw wybranych MRP"},"filter:stats:tooltip:remaining":function(e){return"Suma do zrobienia\nw wybranych MRP"},"filter:stats:todo":function(e){return"Wszystkie"},"filter:stats:late":function(e){return"Opóźnione"},"filter:stats:plan":function(e){return"Rozplanowane"},"filter:stats:remaining":function(e){return"Do zrobienia"},"filter:stats:executed":function(e){return"Wykonane"},"filter:stats:execution":function(e){return"Realizacja sekwencji"},"filter:startTime":function(e){return"Początek"},"toolbar:printPlan":function(e){return"Drukuj plan linii"},"toolbar:printPlan:all":function(e){return"Wszystkie linie"},"toolbar:showTimes":function(e){return"Pokazuj czasy"},"toolbar:copyOrderList":function(e){return"Kopiuj listę zaplanowanych\nzleceń do schowka"},"toolbar:copyOrderList:0":function(e){return"Wszystkie zmiany"},"toolbar:copyOrderList:1":function(e){return"I zmiana"},"toolbar:copyOrderList:2":function(e){return"II zmiana"},"toolbar:copyOrderList:3":function(e){return"III zmiana"},"toolbar:copyOrderList:success":function(e){return"Lista skopiowana do schowka."},"toolbar:toggleLock:true":function(e){return"Wyłącz blokowanie MRP"},"toolbar:toggleLock:false":function(e){return"Włącz blokowanie MRP"},"toolbar:stats:quantity":function(e){return"Sztuki:"},"toolbar:stats:manHours":function(e){return"RBH:"},"toolbar:stats:orders":function(e){return"Zlecenia:"},"toolbar:stats:tooltip:todo":function(e){return"Suma wszystkich zleceń\nw MRP"},"toolbar:stats:tooltip:late":function(e){return"Suma wszystkich\nopóźnionych zleceń\nw MRP"},"toolbar:stats:tooltip:plan":function(e){return"Suma wszystkich zleceń\nrozplanowanych na liniach\nw MRP"},"toolbar:stats:tooltip:remaining":function(e){return"Suma do zrobienia\nw MRP"},"toolbar:stats:tooltip:execution:percent":function(e){return"Procent realizacji\nzaplanowanej sekwencji\nw całym dniu"},"toolbar:stats:tooltip:execution:percent:shift":function(e){return"Procent realizacji\nzaplanowanej sekwencji\nna zmianie "+t.v(e,"shiftNo")},"print:workerCount":function(e){return t.v(e,"count")+" "+t.p(e,"count",0,"pl",{one:"osoba",few:"osoby",other:"osób"})},"print:workerCounts":function(e){return t.v(e,"from")+"-"+t.v(e,"to")+" "+t.p(e,"to",0,"pl",{one:"osoba",few:"osoby",other:"osób"})},"list:generate":function(e){return"Wymuś<br>utworzenie<br>planu"},"list:mrpCount":function(e){return t.v(e,"str")+" "+t.p(e,"num",0,"pl",{one:"rodzina",few:"rodziny",other:"rodzin"})},"list:lineCount":function(e){return t.v(e,"str")+" "+t.p(e,"num",0,"pl",{one:"linia",few:"linie",other:"linii"})},"list:orderCount":function(e){return t.v(e,"str")+" "+t.p(e,"num",0,"pl",{one:"zlecenie",few:"zlecenia",other:"zleceń"})},"list:quantity":function(e){return t.v(e,"str")+" "+t.p(e,"num",0,"pl",{one:"sztuka",few:"sztuki",other:"sztuk"})},"list:manHours":function(e){return t.v(e,"str")+" rbh"},"list:from":function(e){return"od "+t.v(e,"time")},"list:to":function(e){return"do "+t.v(e,"time")},empty:function(e){return"Brak planu dla wybranych filtrów."},locked:function(e){return"MRP jest zablokowane!"},"toggleLock:title:true":function(e){return"Odblokowywanie MRP"},"toggleLock:title:false":function(e){return"Blokowanie MRP"},"toggleLock:message:true":function(e){return"<p>Czy na pewno chcesz odblokować MRP <em>"+t.v(e,"mrp")+"</em>?</p><p>Odblokowanie wznowi przeliczanie planu dla danego MRP i może zmienić plan magazynu.</p>"},"toggleLock:message:false":function(e){return"<p>Czy na pewno chcesz zablokować MRP <em>"+t.v(e,"mrp")+"</em>?</p><p>Zablokowanie uniemożliwi zmianę ustawień dla danego MRP oraz sprawi, że plan linii nie będzie przeliczany (tzn. pozostanie taki jak w momencie zablokowania, nawet bez względu na zmiany statusów zleceń w SAP).</p>"},"toggleLock:message:warning":function(e){return"Zlecenia z danym MRP zostały już skompletowane na magazynie."},"toggleLock:yes:true":function(e){return"Odblokuj MRP"},"toggleLock:yes:false":function(e){return"Zablokuj MRP"},"toggleLock:no:true":function(e){return"Pozostaw zablokowane"},"toggleLock:no:false":function(e){return"Pozostaw odblokowane"},"lines:hd":function(e){return"Linie"},"lines:division":function(e){return"Wydział"},"lines:prodFlow":function(e){return"Przepływ"},"lines:prodLine":function(e){return"Linia"},"lines:activeFrom":function(e){return"Aktywna od"},"lines:activeTo":function(e){return"Aktywna do"},"lines:activeTime":function(e){return"Aktywność"},"lines:workerCount":function(e){return"Ilość osób"},"lines:orderPriority":function(e){return"Priorytet zleceń"},"lines:frozenOrders":function(e){return"Zamrożone zlecenia"},"lines:redirLine":function(e){return"Przekierowanie linii"},"lines:wh:pickup:started":function(e){return"Kompletowane"},"lines:wh:pickup:finished":function(e){return"Skompletowane"},"lines:wh:available":function(e){return"Dostępne"},"lines:wh:sets":function(e){return"sety"},"lines:wh:qty":function(e){return"sztuki"},"lines:wh:time":function(e){return"czas"},"lines:mrpPriority":function(e){return"Priorytet MRP"},"lines:menu:header":function(e){return"Linia "+t.v(e,"line")},"lines:menu:settings":function(e){return"Zmień ustawienia linii"},"lines:menu:remove":function(e){return"Usuń linię z MRP"},"lines:menu:remove:title":function(e){return"Usuwanie linii z MRP"},"lines:menu:remove:message":function(e){return"<p>Czy na pewno chcesz usunąć przypisanie MRP <em>"+t.v(e,"mrp")+"</em> do linii <em>"+t.v(e,"line")+"</em>?</p><p>Zmiana będzie miała wpływ tylko na plan dla dnia "+t.v(e,"plan")+".</p>"},"lines:menu:remove:yes":function(e){return"Usuń przypisanie"},"lines:menu:remove:failure":function(e){return"Usunięcie linii nie powiodło się."},"lines:menu:settings:title":function(e){return"Zmiana ustawień linii w MRP"},"lines:menu:settings:submit":function(e){return"Zapisz ustawienia"},"lines:menu:settings:line":function(e){return"Linia produkcyjna"},"lines:menu:settings:applyToAllMrps":function(e){return"Ustaw taką samą <em>Ilość pracowników</em> oraz <em>Priorytet zleceń</em> dla linii "+t.v(e,"line")+" we wszystkich przypisanych MRP, a nie tylko dla "+t.v(e,"mrp")+"."},"lines:menu:mrpPriority":function(e){return"Ustaw dostępne linie"},"lines:menu:mrpPriority:title":function(e){return"Ustawianie dostępnych linii na "+t.v(e,"mrp")},"lines:menu:mrpPriority:submit":function(e){return"Ustaw priorytet linii"},"lines:menu:mrpPriority:mrp":function(e){return"MRP"},"lines:menu:mrpPriority:line":function(e){return"Linia"},"lines:menu:mrpPriority:line:placeholder":function(e){return"Dodaj nową linię produkcyjną..."},"lines:menu:workerCount":function(e){return"Ustaw ilość pracowników"},"lines:menu:workerCount:title":function(e){return"Ustawianie ilości pracowników"},"lines:menu:workerCount:submit":function(e){return"Ustaw ilości pracowników"},"lines:menu:workerCount:copy":function(e){return"Kopiuj ilości pracowników"},"lines:menu:workerCount:paste":function(e){return"Wklej ilości pracowników"},"lines:menu:workerCount:zero":function(e){return"Wyzeruj ilości pracowników"},"lines:menu:orderPriority":function(e){return"Ustaw priorytety zleceń"},"lines:menu:orderPriority:title":function(e){return"Ustawianie priorytetów zleceń"},"lines:menu:orderPriority:submit":function(e){return"Ustaw priorytety zleceń"},"lines:menu:orderPriority:copy":function(e){return"Kopiuj priorytety"},"lines:menu:orderPriority:paste":function(e){return"Wklej priorytety"},"lines:menu:orderGroupPriority":function(e){return"Ustaw priorytety grup zleceń"},"lines:menu:orderGroupPriority:title":function(e){return"Ustawianie priorytetów grup zleceń"},"lines:menu:orderGroupPriority:submit":function(e){return"Ustaw priorytety grup zleceń"},"lines:menu:orderGroupPriority:copy":function(e){return"Kopiuj grupy"},"lines:menu:orderGroupPriority:paste":function(e){return"Wklej grupy"},"lines:menu:orderGroupPriority:newGroup":function(e){return"Dodaj grupę do linii "+t.v(e,"line")},"lines:menu:orderGroupPriority:matchingMrps":function(e){return"Tylko pasujące MRP"},"lines:menu:freezeOrders":function(e){return"Zamroź zlecenia"},"lines:menu:freezeOrders:title":function(e){return"Zamrażanie zleceń"},"lines:menu:freezeOrders:line":function(e){return"Linia"},"lines:menu:freezeOrders:availableOrders":function(e){return"Dostępne zlecenia"},"lines:menu:freezeOrders:frozenOrders":function(e){return"Zamrożone zlecenia"},"lines:menu:freezeOrders:no":function(e){return"Lp."},"lines:menu:freezeOrders:order":function(e){return"Zlecenie"},"lines:menu:freezeOrders:quantity":function(e){return"Ilość"},"lines:menu:freezeOrders:actions":function(e){return"Akcje"},"lines:menu:freezeOrders:submit":function(e){return"Zamroź zlecenia"},"lines:menu:freezeOrders:failure":function(e){return"Zamrażanie zleceń nie powiodło się."},"lines:menu:freezeOrders:shift:1":function(e){return"I zmiana"},"lines:menu:freezeOrders:shift:2":function(e){return"I i II zmiana"},"lines:menu:freezeOrders:shift:3":function(e){return"wszystkie zmiany"},"lines:menu:redirLine:start":function(e){return"Przekieruj linię"},"lines:menu:redirLine:stop":function(e){return"Zakończ przekierowanie"},"lines:menu:deliveredOrders":function(e){return"Otwórz dostarczone zlecenia"},"orders:hd":function(e){return"Zlecenia"},"orders:_id":function(e){return"Nr zlecenia"},"orders:date":function(e){return"Data"},"orders:delayReason":function(e){return"Powód"},"orders:kind":function(e){return"Klasyfikacja"},"orders:quantityDone":function(e){return"Ilość zrobiona"},"orders:quantityTodo":function(e){return"Ilość do zrobienia"},"orders:quantityPlan":function(e){return"Ilość do rozplanowania"},"orders:incomplete":function(e){return"Ilość nierozplanowana"},"orders:hardComponent":function(e){return"Trudny komponent"},"orders:nc12":function(e){return"12NC"},"orders:name":function(e){return"Wyrób"},"orders:operation":function(e){return"Operacja"},"orders:machineTime":function(e){return"Czas Machine"},"orders:laborTime":function(e){return"Czas Labor"},"orders:manHours":function(e){return"RBH"},"orders:qty":function(e){return"Ilość"},"orders:mrp":function(e){return"MRP"},"orders:statuses":function(e){return"Status"},"orders:ignored":function(e){return"Ignorowane"},"orders:urgent":function(e){return"Pilne"},"orders:pinned":function(e){return"Przypięte"},"orders:eto":function(e){return"ETO"},"orders:priority":function(e){return t.s(e,"priority",{E:"Pilot ETO",EK:"Kontynuacja pilota ETO",other:"Priorytet zlecenia"})},"orders:lines":function(e){return"Linia"},"orders:source":function(e){return"Źródło"},"orders:source:plan":function(e){return"Zaplanowane"},"orders:source:added":function(e){return"Dodane"},"orders:source:incomplete":function(e){return"Niekompletne"},"orders:source:late":function(e){return"Opóźnione"},"orders:psStatus:unknown":function(e){return"Brak malowania"},"orders:psStatus:new":function(e){return"Oczekuje na malowanie"},"orders:psStatus:started":function(e){return"W trakcie malowania"},"orders:psStatus:startedMsp":function(e){return"W trakcie malowania (MSP)"},"orders:psStatus:partial":function(e){return"Niekompletne malowanie"},"orders:psStatus:finished":function(e){return"Malowanie zakończone"},"orders:psStatus:aside":function(e){return"Malowanie odstawione"},"orders:psStatus:cancelled":function(e){return"Malowanie anulowane"},"orders:drillStatus:unknown":function(e){return"Brak wiercenia"},"orders:drillStatus:new":function(e){return"Oczekuje na wiercenie"},"orders:drillStatus:started":function(e){return"W trakcie wiercenia"},"orders:drillStatus:partial":function(e){return"Niekompletne wiercenie"},"orders:drillStatus:finished":function(e){return"Wiercenie zakończone"},"orders:drillStatus:aside":function(e){return"Wiercenie odstawione"},"orders:drillStatus:cancelled":function(e){return"Wiercenie anulowane"},"orders:whStatus:unknown":function(e){return"Nieokreślony"},"orders:whStatus:todo":function(e){return"Do zrobienia"},"orders:whStatus:done":function(e){return"Zrobione"},"orders:dropZone":function(e){return t.v(e,"group")+" na "+t.v(e,"time")},"orders:qty:incomplete":function(e){return"("+t.v(e,"qty")+" "+t.p(e,"qty",0,"pl",{one:"nierozplanowana",few:"nierozplanowane",other:"nierozplanowanych"})+")"},"orders:late":function(e){return"Opóźnione"},"orders:resized":function(e){return"Zmieniona ilość"},"orders:comment":function(e){return"Ostatni komentarz"},"orders:menu:header":function(e){return"Zlecenie "+t.v(e,"order")},"orders:menu:sapOrder":function(e){return"Otwórz szczegóły zlecenia SAP"},"orders:menu:shiftOrder":function(e){return"Otwórz szczegóły zlecenia z linii"},"orders:menu:comment":function(e){return"Komentuj zlecenie"},"orders:menu:urgent":function(e){return"Oznacz zlecenie jako pilne"},"orders:menu:urgent:title":function(e){return"Pilne zlecenie"},"orders:menu:urgent:message":function(e){return"<p>Czy na pewno chcesz oznaczyć zlecenie <em>"+t.v(e,"order")+"</em> jako pilne?</p><p>Pilne zlecenia planowane są na początku pracy linii, poza kolejnością priorytetów zleceń.</p>"},"orders:menu:urgent:yes":function(e){return"Oznacz jako pilne"},"orders:menu:urgent:failure":function(e){return"Nie udało się oznaczyć zlecenia jako pilne."},"orders:menu:unurgent":function(e){return"Oznacz zlecenie jako niepilne"},"orders:menu:unurgent:message":function(e){return"<p>Czy na pewno chcesz oznaczyć zlecenie  <em>"+t.v(e,"order")+"</em> jako niepilne?</p><p>Niepilne zlecenia planowane są w kolejności priorytetów zleceń.</p>"},"orders:menu:unurgent:yes":function(e){return"Oznacz jako niepilne"},"orders:menu:ignore":function(e){return"Ignoruj zlecenie"},"orders:menu:ignore:title":function(e){return"Ignorowane zlecenie"},"orders:menu:ignore:message":function(e){return"<p>Czy na pewno chcesz zignorować zlecenie <em>"+t.v(e,"order")+"</em>?</p><p>Ignorowane zlecenia nie są brane pod uwagę podczas planowania.</p>"},"orders:menu:ignore:yes":function(e){return"Ignoruj zlecenie"},"orders:menu:ignore:failure":function(e){return"Ignorowanie zlecenia nie powiodło się."},"orders:menu:unignore":function(e){return"Przestań ignorować zlecenie"},"orders:menu:unignore:message":function(e){return"<p>Czy na pewno chcesz przestać ignorować zlecenie <em>"+t.v(e,"order")+"</em>?</p><p>Zlecenie ponownie będzie brane pod uwagę podczas planowania.</p>"},"orders:menu:unignore:yes":function(e){return"Przestań ignorować zlecenie"},"orders:menu:quantity":function(e){return"Zmień ilość w zleceniu"},"orders:menu:quantity:title":function(e){return"Zmiana ilości"},"orders:menu:quantity:quantityTodo":function(e){return"Ilość do zrobienia:"},"orders:menu:quantity:quantityDone":function(e){return"Ilość zrobiona:"},"orders:menu:quantity:quantityRemaining":function(e){return"Ilość pozostała do zrobienia:"},"orders:menu:quantity:quantityPlan":function(e){return"Ilość do rozplanowania:"},"orders:menu:quantity:help":function(e){return"Domyślnie, <em>Ilość do rozplanowania</em> równa jest <em>Ilości do zrobienia</em> lub <em>Ilości pozostałej do zrobienia</em>, jeżeli włączona jest opcja <em>Planuj wg ilości pozostałej do zrobienia</em>. W tym polu można nadpisać tę wartość."},"orders:menu:quantity:submit":function(e){return"Zmień ilość"},"orders:menu:quantity:failure":function(e){return"Zmiana ilości nie powiodła się."},"orders:menu:lines":function(e){return"Zmień przypięcie do linii"},"orders:menu:lines:title":function(e){return"Zmiana przypięcia do linii"},"orders:menu:lines:submit":function(e){return"Zmień przypięcie"},"orders:menu:lines:failure":function(e){return"Przypinanie nie powiodło się."},"orders:menu:lines:urgent":function(e){return"Pilne"},"orders:menu:lines:urgent:help":function(e){return"Pilne zlecenie może być przypięte do każdej linii bez względu na Priorytet zleceń."},"orders:menu:add":function(e){return"Dodaj zlecenie"},"orders:menu:remove":function(e){return"Usuń zlecenie"},"orders:menu:remove:title":function(e){return"Usuwanie zlecenia"},"orders:menu:remove:message":function(e){return"<p>Czy na pewno chcesz usunąć zlecenie <em>"+t.v(e,"order")+"</em> z kolejki aktualnego planu?</p>"},"orders:menu:remove:yes":function(e){return"Usuń zlecenie"},"orders:menu:remove:failure":function(e){return"Usuwanie zlecenia nie powiodło się."},"orders:menu:dropZone":function(e){return"Ustaw drop zone"},"orders:menu:dropZone:title":function(e){return"Ustawianie drop zone"},"orders:menu:dropZone:submit":function(e){return"Ustaw drop zone"},"orders:menu:dropZone:failure":function(e){return"Ustawianie drop zone nie powiodło się."},"orders:menu:dropZone:dropZone":function(e){return"Grupa drop zone"},"orders:menu:dropZone:time":function(e){return"Czas"},"orders:menu:dropZone:status":function(e){return"Status"},"orders:menu:dropZone:orders":function(e){return"Zlecenia do zmiany"},"orders:menu:dropZone:comment":function(e){return"Opcjonalny komentarz magazynu"},"orders:add":function(e){return"Dodaj zlecenie"},"orders:add:title":function(e){return"Dodawanie zlecenia"},"orders:add:submit":function(e){return"Dodaj zlecenie"},"orders:add:failure":function(e){return"Dodawanie zlecenia nie powiodło się."},"orders:add:invalidOrderNo":function(e){return"Podaj prawidłowy, 9-cyfrowy nr zlecenia."},"orders:add:searching":function(e){return"<i class='fa fa-spinner fa-spin'></i><span>Wyszukiwanie zlecenia...</span>"},"orders:add:searchFailed":function(e){return"<i class='fa fa-spinner'></i><span>Wyszukiwanie zlecenia nie powiodło się.</span>"},"orders:add:ORDER_NOT_FOUND":function(e){return"Podane zlecenie nie istnieje."},"orders:add:alreadyExists":function(e){return"Zlecenie jest już w aktualnym planie."},"orders:add:future":function(e){return"Zlecenie jest zaplanowane na przyszłość."},"orders:add:undefinedMrp":function(e){return"MRP zlecenia nie jest zdefiniowane w tym planie."},"orders:add:requiredStatus":function(e){return"Zlecenie nie ma wymaganego statusu."},"orders:add:ignoredStatus":function(e){return"Zlecenie ma ignorowany status."},"orders:add:orderNo":function(e){return"Nr zlecenia"},"orders:add:urgent":function(e){return"Pilne"},"orders:add:plans":function(e){return"Zaplanowane w dniach"},"lateOrders:hd":function(e){return"Opóźnione"},"lateOrders:action":function(e){return"Dodaj opóźnione zlecenia"},"lateOrders:add:title":function(e){return"Dodawanie opóźnionych zleceń"},"lateOrders:add:failure":function(e){return"Dodawanie zleceń nie powiodło się."},"lateOrders:add:orders":function(e){return"Opóźnione zlecenia:"},"lateOrders:add:submit":function(e){return"Dodaj opóźnione zlecenia"},"lineOrders:orderNo":function(e){return"Nr zlecenia"},"lineOrders:unit":function(e){return"szt."},"lineOrders:qty:planned":function(e){return"Ilość zaplanowana"},"lineOrders:qty:done":function(e){return"Ilość zrobiona"},"lineOrders:qty:remaining":function(e){return"Ilość pozostała"},"lineOrders:qty:total":function(e){return"Ilość całkowita"},"lineOrders:qty:incomplete":function(e){return"Ilość brakująca"},"lineOrders:pceTime":function(e){return"Czas 1 szt."},"lineOrders:manHours":function(e){return"RBH"},"lineOrders:time":function(e){return"Czas rozp.-zak."},"lineOrders:duration":function(e){return"Czas trwania"},"lineOrders:incomplete":function(e){return"("+t.v(e,"qty")+" "+t.p(e,"qty",0,"pl",{one:"brakująca",few:"brakujące",other:"brakujących"})+")"},"lineOrders:downtimeReason":function(e){return"Powód przestoju"},"lineOrders:comment":function(e){return"Ostatni komentarz"},"lineOrders:list:group":function(e){return"Gr."},"lineOrders:list:no":function(e){return"Lp."},"lineOrders:list:shift":function(e){return"Zm."},"lineOrders:list:mrp":function(e){return"MRP"},"lineOrders:list:orderNo":function(e){return"Zlecenie"},"lineOrders:list:nc12":function(e){return"12NC"},"lineOrders:list:name":function(e){return"Nazwa wyrobu"},"lineOrders:list:qtyPlan":function(e){return"Ilość zaplanowana"},"lineOrders:list:qtyTodo":function(e){return"Ilość do zrobienia"},"lineOrders:list:qty:header":function(e){return"Ilość"},"lineOrders:list:qty:value":function(e){return t.v(e,"plan")+" z "+t.v(e,"todo")},"lineOrders:list:startTime":function(e){return"Początek"},"lineOrders:list:finishTime":function(e){return"Koniec"},"lineOrders:list:status":function(e){return"Status"},"lineOrders:list:lines":function(e){return"Linie"},"lineOrders:list:line":function(e){return"Linia"},"lineOrders:list:dropZone":function(e){return"Drop zone"},"lineOrders:list:whStatus":function(e){return"Etap"},"lineOrders:list:comment":function(e){return"Ostatni komentarz"},"lineOrders:list:orderGroup":function(e){return"Grupa zleceń"},"lineOrders:menu:copy":function(e){return"Kopiuj listę zleceń"},"lineOrders:menu:copy:success":function(e){return"Lista zleceń została skopiowana do schowka."},"wh:menu:copy:lineGroup":function(e){return"Kopiuj listę zleceń <em>"+t.v(e,"group")+". "+t.v(e,"line")+"</em>"},"wh:menu:copy:lineGroupNo":function(e){return"Kopiuj nry zleceń <em>"+t.v(e,"group")+". "+t.v(e,"line")+"</em>"},"wh:menu:export":function(e){return"Eksportuj zlecenia"},"wh:status:all":function(e){return"Wszystkie"},"wh:status:0":function(e){return"Nieokreślony"},"wh:status:1":function(e){return"Lista"},"wh:status:2":function(e){return"Buffor"},"wh:status:3":function(e){return t.p(e,"qtySent",0,"pl",{0:"Wysyłka",other:"Wysłano "+t.v(e,"qtySent")+" szt."})},"wh:sent:comment":function(e){return"Wysłano "+t.p(e,"qtySent",0,"pl",{one:"1 sztukę",few:t.v(e,"qtySent")+" sztuki",other:t.v(e,"qtySent")+" sztuk"})+" na linię "+t.v(e,"line")+" "+t.v(e,"date")+" o "+t.v(e,"time")+"."},"wh:sent:label":function(e){return"Wysyłana<br>ilość:"},"wh:export:fileName":function(e){return"WMES_PLAN_MAGAZYN_"+t.v(e,"date")},"wh:export:sheetName":function(e){return"Plan magazynu "+t.v(e,"date")},"stats:export:title":function(e){return"Eksportowanie statystyk"},"stats:export:mrps":function(e){return"MRP"},"stats:export:lines":function(e){return"Linie"},"stats:export:submit":function(e){return"Eksportuj statystyki"},"stats:export:fileName":function(e){return"WMES_Plan_Wykonanie_"+t.v(e,"from")+"_"+t.v(e,"to")},"stats:export:sheetName":function(e){return"Wyk. planu "+t.v(e,"from")+"-"+t.v(e,"to")},"stats:date":function(e){return"Data"},"stats:division":function(e){return"Wydział"},"stats:mrp":function(e){return"MRP"},"stats:line":function(e){return"Linia"},"stats:orderCount":function(e){return"Ilość zleceń"},"stats:quantity":function(e){return"Ilość sztuk"},"stats:manHours":function(e){return"RBH"},"stats:hourlyPlan":function(e){return"Plan godzinowy"},"transport:export:title":function(e){return"Eksportowanie planu transportu"},"transport:export:mrps":function(e){return"MRP"},"transport:export:lines":function(e){return"Linie"},"transport:export:submit":function(e){return"Eksportuj plan transportu"},"transport:export:fileName":function(e){return"WMES_Plan_Transportu"},"transport:export:sheetName":function(e){return"Plan trans. "+t.v(e,"from")+"-"+t.v(e,"to")},"transport:date":function(e){return"Data"},"transport:time":function(e){return"Czas"},"transport:shiftNo":function(e){return"Zmiana"},"transport:line":function(e){return"Linia"},"transport:mrp":function(e){return"MRP"},"transport:orderNo":function(e){return"Zlecenie produkcyjne"},"transport:salesOrderNo":function(e){return"Zlecenie sprzedaży"},"transport:salesOrderItem":function(e){return"Poz. zlecenia sprzedaży"},"transport:quantity":function(e){return"Ilość sztuk"},"orderStatus:planned":function(e){return"Zaplanowane"},"orderStatus:unplanned":function(e){return"Niezaplanowane"},"orderStatus:incomplete":function(e){return"Niekompletne"},"orderStatus:started":function(e){return"Rozpoczęte"},"orderStatus:completed":function(e){return"Zakończone"},"orderStatus:surplus":function(e){return"Nadwyżka"},"orderPriority:unclassified":function(e){return"Niesklasyfikowane"},"orderPriority:small":function(e){return"Małe"},"orderPriority:medium":function(e){return"Średnie"},"orderPriority:big":function(e){return"Duże"},"orderPriority:easy":function(e){return"Łatwe"},"orderPriority:hard":function(e){return"Trudne"},"settings:title":function(e){return"Formularz edycji ustawień planu"},"settings:msg:success":function(e){return"Ustawienia zostały zapisane."},"settings:msg:failure":function(e){return"Nie udało się zapisać ustawień!"},"settings:submit":function(e){return"Zapisz ustawienia"},"settings:common":function(e){return"Ustawienia ogólne"},"settings:forceWorkDay":function(e){return"Wymuś pracujący dzień"},"settings:forceWorkDay:help":function(e){return"Dzień zostanie potraktowany jako pracujący nawet gdy nie ma żadnych zleceń z daną datą. Dzięki temu niekompletne zlecenia z poprzedniego dnia zostaną rozplanowane w tym dniu (np. zlecenia, które nie zmieściły się w piątku trafią do soboty a nie do poniedziałku)."},"settings:freezeHour":function(e){return"Godzina zamrożenia kolejki zleceń"},"settings:freezeHour:help":function(e){return"Godzina, po której rozplanowane zlecenia zostaną automatycznie zamrożone. Zlecenia są zamrażane po pierwszym imporcie zleceń do 30 minut przed podaną godziną (jeżeli wystąpi), lub po pierwszym przeliczeniu planu po podanej godzinie. Np. W planie na 12.01.2018 z godziną zamrożenia równą 23, zlecenia zostaną zamrożone 11.01.2018 o 22:45, jeżeli o 22:45 zostaną zaimportowane zlecenia z SAP lub po pierwszej ręcznej zmianie w planie po 23:00."},"settings:lateHour":function(e){return"Godzina rozpoczęcia opóźnionych zleceń"},"settings:lateHour:help":function(e){return"Godzina, od której rozplanowywane są ręcznie dodane pilne zlecenia (opóźnione)."},"settings:etoPilotHour":function(e){return"Godzina rozpoczęcia ETO pilotów"},"settings:etoPilotHour:help":function(e){return"Godzina, od której rozplanowywane są zlecenia z priorytetem <em>E</em> - ETO pilot."},"settings:minIncompleteDuration":function(e){return"Min. czas ostatniego zlecenia [min]"},"settings:minIncompleteDuration:help":function(e){return"Zlecenie nie trafi na linię, jeżeli byłoby ostatnie, nie mieściłoby się w całości oraz czas trwania części jaka się mieści na linii jest poniżej podanej ilości minut."},"settings:schedulingRate":function(e){return"Szybkość planowania"},"settings:schedulingRate:help":function(e){return"Współczynnik zmieniający czas wykonania jednej sztuki danego zlecenia: <code>OrderLaborTime / 100 / LineWorkerCount * 3600 * SchedulingRate</code>"},"settings:requiredStatuses":function(e){return"Wymagane statusy"},"settings:requiredStatuses:help":function(e){return"Lista wszystkich statusów jakie zlecenie musi mieć, aby było brane pod uwagę podczas generowania planu."},"settings:ignoredStatuses":function(e){return"Ignorowane statusy"},"settings:ignoredStatuses:help":function(e){return"Lista statusów jakie zlecenie nie może mieć, aby było brane pod uwagę podczas generowania planu."},"settings:completedStatuses":function(e){return"Statusy zrobionego zlecenia"},"settings:completedStatuses:help":function(e){return"Lista ignorowanych statusów określających zakończenie wykonywania zlecenia. Zlecenia z tymi statusami pozostaną w planie, ale nie będą rozplanowywane na liniach produkcyjnych."},"settings:ignoredWorkCenters":function(e){return"Ignorowane WorkCentra"},"settings:ignoredWorkCenters:help":function(e){return"Lista WorkCenterów jakie wybrana operacja zlecenia nie może mieć, aby dane zlecenie było brane pod uwagę podczas generowania planu."},"settings:ignoreCompleted":function(e){return"Ignoruj ukończone zlecenia"},"settings:ignoreCompleted:help":function(e){return"Podczas planowania pod uwagę nie będą brane zlecenie, których <em>Całkowita ilość zrobiona</em> jest większa lub równa <em>Całkowitej ilości do zrobienia</em>."},"settings:useRemainingQuantity":function(e){return"Planuj wg ilości pozostałej do zrobienia"},"settings:useRemainingQuantity:help":function(e){return"Podczas planowania pod uwagę brana będzie <em>Ilość pozostała do zrobienia</em>, a nie <em>Całkowita ilość do zrobienia</em>. Pozostała ilość to <em>Całkowita ilość do zrobienia</em> pomniejszona o <em>Całkowitą zrobioną ilość</em>."},"settings:hardComponents":function(e){return"Trudne komponenty"},"settings:hardComponents:help":function(e){return"Jeżeli zlecenie będzie zawierało jeden z komponentów na tej liście, to zostanie zaklasyfikowane jako <em>Trudne</em>. Bez względu na ilość sztuk oraz roboczogodzin."},"settings:hardBigComponents:help":function(e){return"Jeżeli <em>Duże</em> zlecenie będzie zawierało jeden z komponentów na tej liście, to zostanie zaklasyfikowane jako <em>Trudne</em>."},"settings:line":function(e){return"Ustawienia linii"},"settings:line:placeholder":function(e){return"Wybierz linię produkcyjną..."},"settings:mrpPriority":function(e){return"Priorytet MRP"},"settings:mrpPriority1:help":function(e){return"Lista MRP zleceń, które mogą być robione na danej linii. Kolejność ma znaczenie."},"settings:mrpPriority2:help":function(e){return"Lista MRP zleceń, które mogą być robione na danej linii."},"settings:mrpPriority:placeholder":function(e){return"Wybierz kontrolery MRP..."},"settings:orderGroupPriority":function(e){return"Priorytet grup zleceń"},"settings:orderGroupPriority:help":function(e){return"Lista grup zleceń, które mogą być robione na danej linii. Kolejność ma znaczenie."},"settings:orderGroupPriority:placeholder":function(e){return"Wybierz grupy zleceń..."},"settings:activeTime":function(e){return"Czas aktywności"},"settings:activeTime:help":function(e){return"Czas dostępności linii w danym dniu. Wartość dotyczy wszystkich przypisanych kontrolerów MRP."},"settings:extraCapacity":function(e){return"Dodatkowa pojemność"},"settings:extraCapacity:help":function(e){return"Ostatnie zlecenie może przekroczyć dostępny czas aktywności, jeżeli w całości zmieści się w dodatkowej pojemności. Można podać dodatkową liczbę minut lub procent całkowitego dostępnego czasu."},"settings:mrp":function(e){return"Ustawienia kontrolera MRP"},"settings:mrp:help":function(e){return"Wybierz kontroler MRP, dla którego chcesz zdefiniować ustawienia."},"settings:mrp:placeholder":function(e){return"Wybierz kontroler MRP..."},"settings:limitSmallOrders":function(e){return"Ogranicz małe zlecenia"},"settings:limitSmallOrders:help":function(e){return"W pierwszym przejściu planowania, ilość małych zleceń rozplanowywanych na jednej linii zostanie ograniczona do ilości dostępnych linii. Na przykład, MRP ma 30 małych zleceń i 5 linii akceptujących małe zlecenia. Jeżeli opcja nie będzie włączona, to pierwsza linia zostanie zapełniona małymi zleceniami. Jeżeli opcja zostanie włączona, to na każdą linię trafi po 30/5=6 małych zleceń."},"settings:extraOrderSeconds":function(e){return"Dodatkowy czas zlecenia"},"settings:extraOrderSeconds:help":function(e){return"Ilość sekund dodawana do każdego zlecenia oprócz zlecenia rozpoczętego na początku zmiany produkcyjnej."},"settings:extraShiftSeconds":function(e){return"Czas na rozpoczęcie zmian"},"settings:extraShiftSeconds:1":function(e){return"Czas na rozpoczęcie I zmiany"},"settings:extraShiftSeconds:2":function(e){return"Czas na rozpoczęcie II zmiany"},"settings:extraShiftSeconds:3":function(e){return"Czas na rozpoczęcie III zmiany"},"settings:extraShiftSeconds:help":function(e){return"Ilość sekund dodawana do pierwszego zlecenia na początku zmiany produkcyjnej."},"settings:smallOrderQuantity":function(e){return"Małe zlecenie"},"settings:smallOrderQuantity:help":function(e){return"Ilość sztuk do zrobienia, poniżej której zlecenie klasyfikowane jest jako <em>Małe</em>."},"settings:bigOrderQuantity":function(e){return"Duże zlecenie"},"settings:bigOrderQuantity1:help":function(e){return"Ilość sztuk do zrobienia, po przekroczeniu której zlecenie klasyfikowane jest jako <em>Duże</em>. Duże zlecenia dzielą się na <em>Łatwe</em> i <em>Trudne</em>."},"settings:bigOrderQuantity2:help":function(e){return"Ilość sztuk do zrobienia, po przekroczeniu której zlecenie klasyfikowane jest jako <em>Duże</em>."},"settings:hardOrderManHours":function(e){return"Trudne zlecenie"},"settings:hardOrderManHours:help":function(e){return"Minimalna ilość roboczogodzin, po przekroczeniu której <em>Duże</em> zlecenie klasyfikowane jest jako <em>Trudne</em>."},"settings:splitOrderQuantity":function(e){return"Dzielenie zlecenia"},"settings:splitOrderQuantity:help":function(e){return"Minimalna ilość sztuk do zrobienia, po przekroczeniu której <em>Duże</em> zlecenie jest dzielone na części."},"settings:maxSplitLineCount":function(e){return"Ilość części zlecenia"},"settings:maxSplitLineCount:help":function(e){return"Maksymalna ilość linii na jaką <em>Duże</em> zlecenie może być podzielone. Zero - maksymalna dostępna ilość linii."},"settings:mrpLine":function(e){return"Ustawienia linii w MRP"},"settings:mrpLine:help":function(e){return"Wybierz linię produkcyjną, dla której chcesz zdefiniować ustawienia w zakresie wybranego kontrolera MRP."},"settings:mrpLine:placeholder":function(e){return"Wybierz linię produkcyjną..."},"settings:workerCount":function(e){return"Ilość pracowników"},"settings:workerCount:shift":function(e){return"zm. "+t.v(e,"shiftNo")+":"},"settings:orderPriority":function(e){return"Priorytet zleceń"},"settings:orderPriority1:help":function(e){return"Kolejność wykonywania zleceń na danej linii wg klasyfikacji: małe, łatwe, trudne. Łatwe i trudne zlecenia są jednocześnie duże."},"settings:orderPriority2:help":function(e){return"Kolejność wykonywania zleceń na danej linii wg klasyfikacji: małe, średnie, duże."},"settings:orderPriority:placeholder":function(e){return"Wybierz rodzaje zleceń..."},"settings:linePriority":function(e){return"Priorytet linii"},"settings:linePriority:help":function(e){return"Kolejność linii podczas rozplanowywania zleceń."},"settings:groups":function(e){return"Grupy"},"settings:groups:no":function(e){return"Nr"},"settings:groups:splitOrderQuantity":function(e){return"Dzielenie zlecenia"},"settings:groups:lines":function(e){return"Linie"},"settings:groups:components":function(e){return"Komponenty"},"settings:groups:add":function(e){return"Dodaj grupę"},"settings:groups:remove":function(e){return"Usuń grupę"},"settings:locked":function(e){return"Zablokowane"},"settings:tab:wh":function(e){return"Magazyn"},"settings:wh:groupDuration":function(e){return"Czas trwania grupy zleceń [h]"},"settings:wh:groupExtraItems":function(e){return"Minimalna ilość sztuk w grupie"},"settings:wh:groupExtraItems:help":function(e){return"Jeżeli ilość sztuk zlecenia w pierwszej/ostatniej grupie danej linii będzie mniejsza lub równa podanej wartości, to grupa ta zostanie scalona z następną/poprzednią grupą."},"settings:wh:sortByLines":function(e){return"Sortuj zlecenia w grupach wg linii"},"settings:wh:ignoredMrps":function(e){return"Ignorowane MRP (w starym module)"},"settings:wh:newIncludedMrps":function(e){return"Zablokowane MRP"},"changes:hd":function(e){return"<span class='planning-change-when'>"+t.v(e,"when")+"</span> przez <span class='planning-change-who'>"+t.v(e,"who")+"</span>: <span class='planning-change-what'>"+t.v(e,"what")+"</span>"},"changes:what:settings":function(e){return t.v(e,"count")+" "+t.p(e,"count",0,"pl",{one:"zmiana",few:"zmiany",other:"zmian"})+" ustawień"},"changes:what:addedOrders":function(e){return t.v(e,"count")+" "+t.p(e,"count",0,"pl",{one:"dodane zlecenie",few:"dodane zlecenia",other:"dodanych zleceń"})},"changes:what:changedOrders":function(e){return t.v(e,"count")+" "+t.p(e,"count",0,"pl",{one:"zmienione zlecenie",few:"zmienione zlecenia",other:"zmienionych zleceń"})},"changes:what:removedOrders":function(e){return t.v(e,"count")+" "+t.p(e,"count",0,"pl",{one:"usunięte zlecenie",few:"usunięte zlecenia",other:"usuniętych zleceń"})},"changes:what:changedLines":function(e){return t.v(e,"count")+" "+t.p(e,"count",0,"pl",{one:"zmieniony plan linii",few:"zmienione plany linii",other:"zmienionych planów linii"})},"changes:removedOrders:REQUIRED_STATUS":function(e){return"Brak wymaganego statusu: "+t.v(e,"requiredStatus")+"."},"changes:removedOrders:IGNORED_STATUS":function(e){return"Ignorowany status: "+t.v(e,"ignoredStatus")+"."},"changes:removedOrders:MISSING_ORDER":function(e){return"Brak zlecenia SAP dla danego dnia."},"changes:removedOrders:INCOMPLETE_DONE":function(e){return"Zlecenie niekompletne z poprzedniego dnia zostało zrobione."},"changes:settings:lines:remove":function(e){return"Usunięto linię <em>"+t.v(e,"line")+"</em>"},"changes:settings:mrps:remove":function(e){return"Usunięto MRP <em>"+t.v(e,"mrp")+"</em>"},"changes:settings:mrpLines:remove":function(e){return"Usunięto linię <em>"+t.v(e,"line")+"</em> z MRP <em>"+t.v(e,"mrp")+"</em>"},"changes:settings:lines:change":function(e){return"Zmieniono linię <em>"+t.v(e,"line")+"</em>: <em>"+t.v(e,"property")+"</em>: "},"changes:settings:mrps:change":function(e){return"Zmieniono MRP <em>"+t.v(e,"mrp")+"</em>: <em>"+t.v(e,"property")+"</em>: "},"changes:settings:mrpLines:change":function(e){return"Zmieniono linię <em>"+t.v(e,"line")+"</em> w MRP <em>"+t.v(e,"mrp")+"</em>: <em>"+t.v(e,"property")+"</em>: "},"changes:settings:lines:add":function(e){return"Dodano linię <em>"+t.v(e,"line")+"</em>"},"changes:settings:mrps:add":function(e){return"Dodano MRP <em>"+t.v(e,"mrp")+"</em>"},"changes:settings:mrpLines:add":function(e){return"Dodano linię <em>"+t.v(e,"line")+"</em> do MRP <em>"+t.v(e,"mrp")+"</em>"},"copySettings:title":function(e){return"Kopiowanie ustawień linii"},"copySettings:submit":function(e){return"Kopiuj ustawienia"},"copySettings:source":function(e){return"Plan źródłowy"},"copySettings:target":function(e){return"Plany docelowe"},"copySettings:target:placeholder":function(e){return"Wszystkie"},"copySettings:target:empty":function(e){return"Brak docelowych planów."},"copySettings:mrps":function(e){return"MRP do skopiowania"},"copySettings:mrps:placeholder":function(e){return"Wybierz..."},"copySettings:mrps:all":function(e){return"wszystkie"},"copySettings:what":function(e){return"Kopiuj"},"copySettings:what:empty":function(e){return"Nie wybrano ustawień do skopiowania."},"copySettings:what:workerCount":function(e){return"Ilość pracowników"},"copySettings:what:activeTime":function(e){return"Czas dostępności"},"copySettings:what:orderPriority":function(e){return"Priorytet zleceń"},"copySettings:what:linePriority":function(e){return"Priorytet linii"},"copySettings:what:orderGroupPriority":function(e){return"Priorytet grup zleceń"},"copySettings:what:extraCapacity":function(e){return"Dodatkowa pojemność"},"copySettings:what:mrpPriority":function(e){return"Priorytet MRP"},"copySettings:what:lineGroups":function(e){return"Grupy linii"},"copySettings:what:mrpSettings":function(e){return"Ustawienia MRP (małe zlecenie, dodatkowy czas...)"},"copySettings:failure:fetchSettings":function(e){return"Nie udało się pobrać ustawień dla planu "+t.v(e,"plan")+"."},"lockReason:mrp":function(e){return"MRP "+t.v(e,"mrp")+" zablokowane bezpośrednio."},"lockReason:line":function(e){return"Linia "+t.v(e,"line")+" znajduje się w zablokowanym MRP: "+t.v(e,"mrps")},"planExecution:title:all":function(e){return"Realizacja sekwencji"},"planExecution:title:mrp":function(e){return"Realizacja sekwencji dla "+t.v(e,"mrp")}}}),define("app/planning/util/contextMenu",["underscore","jquery","app/i18n","app/broker","app/core/util/scrollbarSize","app/orders/util/commentPopover","app/planning/templates/contextMenu","i18n!app/nls/planning"],function(e,t,n,i,r,o,a){"use strict";function s(e){var n=t(e.currentTarget).closest(".planning-menu").find("[tabindex]:not(.planning-menu-disabled)").toArray(),i=n.indexOf(e.currentTarget)-1;return-1===i&&(i=n.length-1),n[i].focus(),!1}function u(e){var n=t(e.currentTarget).closest(".planning-menu").find("[tabindex]:not(.planning-menu-disabled)").toArray(),i=n.indexOf(e.currentTarget)+1;return i>=n.length&&(i=0),n[i].focus(),!1}return{isVisible:function(e){return!!e.$contextMenu},hide:function(e,n){var r=e.$contextMenu;if(r){t(document.body).click(),i.publish("planning.contextMenu.hiding",{$menu:r});var o=r.data("options");t(window).off(".contextMenu."+e.idPrefix),t(document.body).off(".contextMenu."+e.idPrefix),r.data("backdrop").remove(),r.removeData("backdrop"),r.removeData("options"),!1===o.animate||!1===n?r.remove():r.fadeOut("fast",function(){r.remove()}),e.$contextMenu=null,i.publish("planning.contextMenu.hidden")}},show:function(n,r,o,c){var l,d=this.hide.bind(this,n),p=this.show.bind(this,n,r,o,c);l=c.menu?c.menu:(c={menu:c}).menu,d(!1),l=(l=l.map(function(e){return"-"===e?{type:"divider"}:"string"==typeof e?{type:"header",label:e}:(e.type||(e.type="item"),e)}).filter(function(e){return!1!==e.visible})).filter(function(e,t){var n=l[t+1];return"header"!==e.type||"header"===e.type&&n&&"item"===n.type});var f=t(a({className:c.className||"",top:r,icons:e.some(l,function(e){return!!e.icon}),menu:l}));f.on("mousedown",function(e){if(1!==e.which)return!1;e.stopPropagation()}),f.on("mouseup",function(e){if(1!==e.which)return!1}),f.on("contextmenu",!1),f.on("click","a[data-action]",function(e){var t=e.currentTarget;if(!t.classList.contains("planning-menu-disabled")&&!t.classList.contains("planning-menu-loading")){var i=t.dataset.action,r=l[i];f.find("a").addClass("planning-menu-loading"),e.contextMenu={hide:!0,action:i,item:r,view:n,top:c.top,left:c.left,menu:l,restore:p},r&&r.handler&&r.handler(e),e.contextMenu.hide?d():f.find(t).find(".fa").attr("class","fa fa-spinner fa-spin")}}),f.on("keydown","[tabindex]",function(e){var n=e.currentTarget.tagName,i="SELECT"===n||"TEXTAREA"===n||"INPUT"===n,r="SELECT"!==n&&"TEXTAREA"!==n,o=r&&"INPUT"!==n;switch(e.originalEvent.key){case"ArrowUp":return r?s(e):void 0;case"ArrowDown":return r?u(e):void 0;case"Tab":return e.shiftKey?s(e):u(e);case" ":case"Enter":if(o){var a=new t.Event("click");return a.pageY=c.top,a.pageX=c.left,t(e.currentTarget).trigger(a),!1}break;case"Delete":case"Backspace":if(!i)return d(),!1;break;case"Escape":return d(),!1}});var h=t('<div class="planning-menu-backdrop"></div>').one("mousedown",d);f.data("backdrop",h),f.data("options",c),t(window).one("scroll.contextMenu."+n.idPrefix,d).one("resize.contextMenu."+n.idPrefix,d),t(document.body).one("mousedown.contextMenu."+n.idPrefix,function(e){c.hideFilter&&!c.hideFilter(e)||d()}).append(h).append(f),n.$contextMenu=f,this.position(n,r,o),l.forEach(function(e,t){e.template&&e.handler&&e.handler(f.find('li[data-action="'+t+'"]'))}),!1!==c.autoFocus&&(f.find("[autofocus]").length?f.find("[autofocus]").first().focus().select():f.find("[tabindex]:not(.planning-menu-disabled)").first().focus()),i.publish("planning.contextMenu.shown",{$menu:f})},position:function(t,n,i){if(t.$contextMenu){var r=t.$contextMenu;!function t(o){var a=r.outerWidth();var s=r.outerHeight();i+a>=document.body.clientWidth&&(i-=i+a-document.body.clientWidth+5);var u=window.innerHeight+window.pageYOffset;n+s>=u&&(n-=n+s-u+5);r.css({top:n+"px",left:i+"px"});e.assign(r.data("options"),{top:n,left:i});!o&&r[0].scrollHeight>r[0].offsetHeight&&t(!0)}(!1)}},actions:{sapOrder:function(e){return{icon:"fa-file-o",label:n.bound("planning","orders:menu:sapOrder"),handler:function(){window.open("/#orders/"+e)}}},comment:function(e){return{icon:"fa-comment-o",label:n("planning","orders:menu:comment"),handler:function(){var t=Math.min(window.screen.availWidth-200,1400),n=Math.min(window.screen.availHeight-160,800),i=window.screen.availWidth-t-80,r=window.open("/#orders/"+e,"WMES_ORDER_DETAILS","top=80,left="+i+",width="+t+",height="+n);r&&(r.onPageShown=function(){if(r){r.focus();var e=r.document.querySelector('textarea[name="comment"]');e&&e.focus(),setTimeout(function(){r.scrollTo(0,r.document.body.scrollHeight)},1)}})}}},commentPopover:function(e,t){return{icon:"fa-comment-o",label:n("planning","orders:menu:comment"),handler:function(n){o.show(n.contextMenu.view,e,n.contextMenu.top,n.contextMenu.left,{source:t||"other"})}}}}}}),define("app/core/templates/actionForm",["underscore","jquery","app/i18n","app/time","app/user","app/core/util/forms"],function(_,$,t,time,user,forms){return function anonymous(locals,escapeFn,include,rethrow){escapeFn=escapeFn||function(e){return void 0==e?"":String(e).replace(_MATCH_HTML,encode_char)};var _ENCODE_HTML_RULES={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&#34;","'":"&#39;"},_MATCH_HTML=/[&<>'"]/g;function encode_char(e){return _ENCODE_HTML_RULES[e]||e}var __output="";function __append(e){void 0!==e&&null!==e&&(__output+=e)}with(locals||{})__append('<form class="action-form" method="post" action="'),__append(formAction),__append('">\n  <input type="hidden" name="_method" value="'),__append(formMethod),__append('">\n  <p>'),__append("function"==typeof messageText?messageText():messageText),__append('</p>\n  <div class="form-actions">\n    <button type="submit" class="btn btn-'),__append(formActionSeverity),__append('">'),__append("function"==typeof formActionText?formActionText():formActionText),__append("</button>\n    "),"#"===cancelUrl?(__append('\n    <button type="button" class="cancel btn btn-link">'),__append(t("core","ACTION_FORM:BUTTON:cancel")),__append("</button>\n    ")):(__append('\n    <a class="cancel" href="'),__append(cancelUrl),__append('">'),__append(t("core","ACTION_FORM:BUTTON:cancel")),__append("</a>\n    ")),__append("\n  </div>\n</form>\n");return __output}}),define("app/core/views/ActionFormView",["underscore","app/i18n","app/viewport","app/router","../View","app/core/templates/actionForm"],function(e,t,n,i,r,o){"use strict";function a(e,n,i){return t.bound(t.has(e.nlsDomain,n)?e.nlsDomain:"core",n,i||{})}var s={formMethod:"POST",formAction:"/",formActionText:t.bound("core","ACTION_FORM:BUTTON"),formActionSeverity:"primary",messageText:t.bound("core","ACTION_FORM:MESSAGE"),successUrl:null,cancelUrl:"#",failureText:t.bound("core","ACTION_FORM:MESSAGE_FAILURE"),requestData:null},u=r.extend({template:o,events:{submit:"submitForm"},$errorMessage:null,initialize:function(){e.defaults(this.options,s),this.$errorMessage=null},destroy:function(){this.hideErrorMessage()},serialize:function(){return{formMethod:this.options.formMethod,formAction:this.options.formAction,formActionText:this.options.formActionText,formActionSeverity:this.options.formActionSeverity,messageText:this.options.messageText,cancelUrl:this.options.cancelUrl,model:this.model}},afterRender:function(){this.model&&this.listenToOnce(this.model,"change",this.render)},submitForm:function(){this.hideErrorMessage();var i=this.$('[type="submit"]').attr("disabled",!0),r=this.options,o=r.requestData;o=null==o?void 0:e.isFunction(o)?o.call(this):JSON.stringify(o);var a=this.ajax({type:r.formMethod,url:r.formAction,data:o}),s=this;return a.done(function(t){s.trigger("success",t),e.isString(r.successUrl)&&s.broker.publish("router.navigate",{url:r.successUrl,trigger:!0,replace:!0})}),a.fail(function(e){s.trigger("failure",e);var i=e.responseJSON&&e.responseJSON.error&&e.responseJSON.error.code||"?",o="ACTION_FORM:"+r.actionKey+":"+i,a=t.has(s.options.nlsDomain,o)?t(s.options.nlsDomain,o):r.failureText;a&&(s.$errorMessage=n.msg.show({type:"error",time:3e3,text:a}))}),a.always(function(){i.attr("disabled",!1)}),!1},hideErrorMessage:function(){null!==this.$errorMessage&&(n.msg.hide(this.$errorMessage),this.$errorMessage=null)},onDialogShown:function(){this.$(".form-actions").find(".btn").first().focus()}},{showDialog:function(t){var i=null;if(t.nlsDomain||(t.nlsDomain=t.model.getNlsDomain()),t.nlsDomain){i=a(t,"ACTION_FORM:DIALOG_TITLE:"+t.actionKey);var r=t.labelAttribute?t.model.get(t.labelAttribute):t.model.getLabel();t.messageText||(t.messageText=r?a(t,"ACTION_FORM:MESSAGE_SPECIFIC:"+t.actionKey,{label:r}):a(t,"ACTION_FORM:MESSAGE:"+t.actionKey)),t.formActionText||(t.formActionText=a(t,"ACTION_FORM:BUTTON:"+t.actionKey)),t.failureText||(t.failureText=a(t,"ACTION_FORM:MESSAGE_FAILURE:"+t.actionKey))}!t.formAction&&e.isFunction(t.model.url)&&(t.formAction=t.model.url()),e.isObject(t.requestData)||(t.requestData={}),e.isString(t.requestData.action)||(t.requestData.action=t.actionKey);var o=new u(t);return o.on("success",function(){n.closeDialog()}),n.showDialog(o,i),o},showDeleteDialog:function(e){return e.actionKey="delete",e.formMethod="DELETE",e.formActionSeverity="danger",u.showDialog(e)}});return u}),define("app/core/templates/pagination",["underscore","jquery","app/i18n","app/time","app/user","app/core/util/forms"],function(_,$,t,time,user,forms){return function anonymous(locals,escapeFn,include,rethrow){escapeFn=escapeFn||function(e){return void 0==e?"":String(e).replace(_MATCH_HTML,encode_char)};var _ENCODE_HTML_RULES={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&#34;","'":"&#39;"},_MATCH_HTML=/[&<>'"]/g;function encode_char(e){return _ENCODE_HTML_RULES[e]||e}var __output="";function __append(e){void 0!==e&&null!==e&&(__output+=e)}with(locals||{})__append('<ul class="pagination">\n\n  '),firstLastLinksVisible&&(__append("\n    "),firstPageLinkAvailable?(__append('\n    <li class="pagination-firstPage"><a href="'),__append(firstPageHref),__append('" title="'),__append(t("core","PAGINATION:FIRST_PAGE")),__append('" data-page="1">&laquo;</a>\n    ')):__append('\n    <li class="pagination-firstPage disabled"><span>&laquo;</span>\n    '),__append("\n  ")),__append("\n\n  "),prevNextLinksVisible&&(__append("\n    "),prevPageLinkAvailable?(__append('\n    <li class="pagination-prevPage"><a href="'),__append(prevPageHref),__append('" title="'),__append(t("core","PAGINATION:PREV_PAGE")),__append('" data-page="'),__append(page-1),__append('">&lsaquo;</a>\n    ')):__append('\n    <li class="pagination-prevPage disabled"><span>&lsaquo;</span>\n    '),__append("\n  ")),__append("\n\n  "),leftDotsVisible&&__append('\n  <li class="disabled pagination-leftDots"><span class="pagination-dots">...</span>\n  '),__append("\n\n  "),pages.forEach(function(e){__append('\n  <li class="pagination-page '),__append(e.active?"active":""),__append('"><a href="'),__append(e.href),__append('" data-page="'),__append(e.no),__append('">'),__append(e.no),__append("</a>\n  ")}),__append("\n\n  "),rightDotsVisible&&__append('\n  <li class="disabled pagination-rightDots"><span class="pagination-dots">...</span>\n  '),__append("\n\n  "),prevNextLinksVisible&&(__append("\n    "),nextPageLinkAvailable?(__append('\n    <li><a class="pagination-nextPage" href="'),__append(nextPageHref),__append('" title="'),__append(t("core","PAGINATION:NEXT_PAGE")),__append('" data-page="'),__append(page+1),__append('">&rsaquo;</a>\n    ')):__append('\n    <li class="pagination-nextPage disabled"><span>&rsaquo;</span>\n    '),__append("\n  ")),__append("\n\n  "),firstLastLinksVisible&&(__append("\n    "),lastPageLinkAvailable?(__append('\n    <li><a class="pagination-lastPage" href="'),__append(lastPageHref),__append('" title="'),__append(t("core","PAGINATION:LAST_PAGE")),__append('" data-page="'),__append(pageCount),__append('">&raquo;</a>\n    ')):__append('\n    <li class="pagination-lastPage disabled"><span>&raquo;</span>\n    '),__append("\n  ")),__append("\n\n</ul>\n");return __output}}),define("app/core/views/PaginationView",["underscore","../View","app/core/templates/pagination"],function(e,t,n){"use strict";var i={pageNumbers:3,firstLastLinksVisible:!0,prevNextLinksVisible:!0,dotsVisible:!0,replaceUrl:!1,navigate:!0},r=t.extend({template:n,events:{"click a":function(e){if(0===e.button){e.preventDefault();var t=e.currentTarget;this.changePage(+t.getAttribute("data-page"),t.getAttribute("href"))}}}});return r.prototype.initialize=function(){e.defaults(this.options,i),this.listenTo(this.model,"change:urlTemplate",this.render)},r.prototype.afterRender=function(){var e=this.model.get("limit");(e<=0||this.model.get("totalCount")<=e)&&this.$el.hide()},r.prototype.changePage=function(e,t){this.model.set({page:e}),t&&this.options.navigate&&this.broker.publish("router.navigate",{url:t,replace:this.options.replaceUrl})},r.prototype.serialize=function(){var e=this.options,t=this.model,n=t.get("page"),i=Math.ceil(t.get("totalCount")/t.get("limit")),r=(e.pageNumbers-1)/2;e.dotsVisible&&(r+=1);var o=n,a=o+r,s=!0,u=!1;o-r<1?o=1:(o-=r,u=e.dotsVisible&&1!==o),u&&(o+=1),a>i&&(a=i,s=!1),n<r+1?(a+=r+1-n)>i&&(a=i):n>i-r&&(o-=r-(i-n))<1&&(o=1);var c=e.dotsVisible&&s&&a!==i;return c&&(a-=1),1===o&&(u=!1),{pageCount:i,page:n,skip:t.get("skip"),limit:t.get("limit"),visible:i>1,firstLastLinksVisible:e.firstLastLinksVisible,prevNextLinksVisible:e.prevNextLinksVisible,leftDotsVisible:u,rightDotsVisible:c,firstPageLinkAvailable:n>1,lastPageLinkAvailable:n<i,prevPageLinkAvailable:n>1,nextPageLinkAvailable:n<i,firstPageHref:this.genPageHref(1),lastPageHref:this.genPageHref(i),prevPageHref:this.genPageHref(n-1),nextPageHref:this.genPageHref(n+1),pages:this.genPages(o,a)}},r.prototype.genPageHref=function(e){var t=this.model.get("urlTemplate"),n=this.model.get("limit");return t.replace("${page}",e).replace("${skip}",(e-1)*n).replace("${limit}",n)},r.prototype.genPages=function(e,t){for(var n=[],i=this.model.get("page"),r=e;r<=t;++r)n.push({no:r,active:r===i,href:this.genPageHref(r)});return n},r}),define("app/core/templates/list",["underscore","jquery","app/i18n","app/time","app/user","app/core/util/forms"],function(_,$,t,time,user,forms){return function anonymous(locals,escapeFn,include,rethrow){escapeFn=escapeFn||function(e){return void 0==e?"":String(e).replace(_MATCH_HTML,encode_char)};var _ENCODE_HTML_RULES={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&#34;","'":"&#39;"},_MATCH_HTML=/[&<>'"]/g;function encode_char(e){return _ENCODE_HTML_RULES[e]||e}var __output="";function __append(e){void 0!==e&&null!==e&&(__output+=e)}with(locals||{})panel&&(__append('\n<div class="panel panel-'),__append(panel.type||"default"),__append(" "),__append(panel.className||""),__append(" "),__append(panel.hideEmpty&&0===rows.length?"hidden":""),__append('">\n  <div class="panel-heading">'),__append(panel.title||""),__append("</div>\n")),__append('\n<div class="list '),__append("undefined"==typeof className?"":className),__append('">\n  <div class="table-responsive"><table class="table '),__append(tableClassName),__append('">\n      <thead>\n      <tr>\n        '),columns.forEach(function(e){__append('\n        <th data-column-id="'),__append(e.id),__append('" '),__append("function"==typeof e.thAttrs?e.thAttrs(e):e.thAttrs||""),__append(">"),__append(e.label),__append("</th>\n        ")}),__append("\n        "),"function"==typeof actions&&(__append('\n        <th class="actions">'),__append(t("core","LIST:COLUMN:actions")),__append("</th>\n        ")),__append("\n      </tr>\n      </thead>\n      <tbody>\n        "),rows.length||(__append('\n        <tr>\n          <td colspan="'),__append(columns.length+1),__append('">'),__append(noData),__append("</td>\n        </tr>\n        ")),__append("\n        "),rows.forEach(function(e){__append('\n        <tr class="list-item '),__append(e.className?e.className:""),__append('"\n          '),e.dataAttrs&&(__append("\n          "),Object.keys(e.dataAttrs).forEach(function(t){__append("\n          data-"),__append(t),__append('="'),__append(escapeFn(e.dataAttrs[t])),__append('"\n          ')}),__append("\n          ")),__append("\n          "),e._id&&(__append('data-id="'),__append(e._id),__append('"')),__append("\n        >\n          "),columns.forEach(function(t){__append("\n          <td\n            "),__append("function"==typeof t.tdAttrs?t.tdAttrs(e,t):t.tdAttrs||""),__append('\n            data-id="'),__append(t.id),__append('"\n            '),t.titleProperty&&e[t.titleProperty]&&(__append('title="'),__append(escapeFn(e[t.titleProperty])),__append('"')),__append("\n          >"),__append(renderValue(t,e)),__append("</td>\n          ")}),__append("\n          "),"function"==typeof actions&&(__append('\n          <td class="actions">\n            <div class="actions-group">\n              '),actions(e).forEach(function(e){__append("\n              "),e.href?(__append('\n              <a href="'),__append(e.href),__append('" class="btn btn-'),__append(e.type||"default"),__append(" "),__append(e.id?"action-"+e.id:""),__append(" "),__append(e.className||""),__append('" title="'),__append(escapeFn(e.label)),__append('"><i class="fa fa-'),__append(e.icon),__append('"></i>'),__append(e.text||""),__append("</a>\n              ")):(__append('\n              <button type="button" class="btn btn-'),__append(e.type||"default"),__append(" "),__append(e.id?"action-"+e.id:""),__append(" "),__append(e.className||""),__append('" title="'),__append(escapeFn(e.label)),__append('" data-id="'),__append(e.id||""),__append('"><i class="fa fa-'),__append(e.icon),__append('"></i>'),__append(e.text||""),__append("</button>\n              ")),__append("\n              ")}),__append("\n            </div>\n          </td>\n          ")),__append("\n        </tr>\n        ")}),__append('\n      </tbody>\n    </table></div>\n  <div class="pagination-container"></div>\n</div>\n'),panel&&__append("\n</div>\n"),__append("\n");return __output}}),define("app/core/views/ListView",["underscore","jquery","app/i18n","app/user","app/planning/util/contextMenu","../View","./ActionFormView","./PaginationView","app/core/templates/list"],function(e,t,n,i,r,o,a,s,u){"use strict";var c=o.extend({template:u,tableClassName:"table-bordered table-hover table-condensed",paginationOptions:{},refreshDelay:5e3,crudTopics:"separate",remoteTopics:function(){var e={},t=this.collection.getTopicPrefix();return t&&("separate"===this.crudTopics?(e[t+".added"]="onModelAdded",e[t+".edited"]="onModelEdited",e[t+".deleted"]="onModelDeleted"):"updated"===this.crudTopics&&(e[t+".updated"]="onModelsUpdated")),e},events:{"click .list-item[data-id]":function(e){if(e.target.classList.contains("actions-group"))return!1;if(!this.isNotClickable(e)){var t=this.collection.get(e.currentTarget.dataset.id).genClientUrl();e.ctrlKey?window.open(t):e.altKey||this.broker.publish("router.navigate",{url:t,trigger:!0,replace:!1})}},"mousedown .list-item[data-id]":function(e){this.isNotClickable(e)||1!==e.button||this.isScrollable()||e.preventDefault()},"mouseup .list-item[data-id]":function(e){if(!this.isNotClickable(e)&&1===e.button&&!this.isScrollable())return window.open(this.collection.get(e.currentTarget.dataset.id).genClientUrl()),!1},"click .action-delete":function(e){e.preventDefault(),a.showDeleteDialog({model:this.getModelFromEvent(e)})},"click .is-filter":function(e){this.trigger("showFilter",e.currentTarget.dataset.columnId)},"contextmenu .list-item[data-id]":function(e){e.currentTarget.querySelector(".actions")&&(e.preventDefault(),this.showContextMenu(e.currentTarget.dataset.id,e.pageY,e.pageX))}},initialize:function(){this.refreshReq=null,this.lastRefreshAt=0,this.listenTo(this.collection,"sync",function(){this.lastRefreshAt=Date.now()}),this.once("afterRender",function(){this.listenTo(this.collection,"reset",this.onReset)}),this.collection.paginationData&&(this.paginationView=new s(e.assign({replaceUrl:!!this.options.replaceUrl},this.paginationOptions,this.options.pagination,{model:this.collection.paginationData})),this.setView(".pagination-container",this.paginationView),this.listenTo(this.collection.paginationData,"change:page",this.scrollTop))},destroy:function(){this.paginationView=null},serialize:function(){return e.assign(o.prototype.serialize.apply(this,arguments),{columns:this.decorateColumns(this.serializeColumns()),actions:this.serializeActions(),rows:this.serializeRows(),className:e.result(this,"className"),tableClassName:e.result(this,"tableClassName"),noData:this.options.noData||n("core","LIST:NO_DATA"),panel:this.options.panel,renderValue:function(e,t){return null==t[e.valueProperty]?null==e.noData?"<em>"+n("core","LIST:NO_DATA:cell")+"</em>":e.noData:"function"==typeof e.tdDecorator?e.tdDecorator(e.id,t[e.valueProperty],t,e):t[e.valueProperty]}})},serializeColumns:function(){var e=this.options.columns||this.columns;return"function"==typeof e&&(e=e.call(this)),Array.isArray(e)||(e=[]),e},decorateColumns:function(t){var i=this,r=i.collection.getNlsDomain();return t.map(function(t){if(!t)return null;if("-"===t?t={id:"filler",label:""}:"string"==typeof t&&(t={id:t}),!1===t.visible)return null;if(t.valueProperty||(t.valueProperty=t.id),!t.label&&""!==t.label){var o="LIST:COLUMN:"+t.id;n.has(r,o)||(o="PROPERTY:"+t.id),t.label=n.bound(r,o)}return["th","td"].forEach(function(n){var r=n+"Attrs",o="_"+r,a=t[o]||t[r];e.isFunction(a)||e.isObject(a)&&!e.isArray(a)||(a={}),t[o]||(t[o]=a),t[r]=i.decorateAttrs.bind(i,n,t[o])}),t}).filter(function(e){return null!==e})},decorateAttrs:function(t,n,i,r){"th"===t&&(r=i,i={}),e.isFunction(n)&&(n="th"===t?n(r):n(i,r));var o=[];e.isArray(n.className)?o=o.concat(n.className):e.isString(n.className)&&o.push(n.className),o.push(e.result(r,"className"),e.result(r,t+"ClassName")),r.min&&o.push("is-min");var a=[];return(o=o.filter(function(e){return!!e}).join(" ")).length&&a.push('class="'+o+'"'),r.titleProperty||"td"!==t||-1===o.indexOf("is-overflow")||(r.titleProperty=r.id),r.titleProperty&&(n.title="function"==typeof r.titleProperty?i[r.titleProperty(i,r)]:i[r.titleProperty]),n.title&&(n.title=String(n.title).replace(/<\/?[a-z].*?>/g,"")),r.width&&(n.style||(n.style={}),n.style.width=r.width),Object.keys(n).forEach(function(t){if("className"!==t){var o=n[t];if(e.isFunction(o)&&(o=o(t,n,i,r)),e.isArray(o))o=o.join(" ");else if("style"===t&&e.isObject(o)){var s=[];Object.keys(o).forEach(function(e){s.push(e+": "+o[e])}),o=s.join("; ")}"!"===t.charAt(0)?t=t.substring(1):o=e.escape(o),a.push(t+'="'+o+'"')}}),a.join(" ")},serializeActions:function(){return void 0!==this.actions?e.result(this,"actions"):c.actions.viewEditDelete(this.collection)},serializeRows:function(){return this.collection.map(this.options.serializeRow||this.serializeRow,this)},serializeRow:function(e){return"function"==typeof e.serializeRow?e.serializeRow():"function"==typeof e.serialize?e.serialize():e.toJSON()},onModelAdded:function(e){this.refreshCollection(e)},onModelEdited:function(e){this.refreshCollection(e)},onModelDeleted:function(e){if(e){var t=new(0,this.collection.model)(e.model||e,{parse:!0});t.id&&(this.$('.list-item[data-id="'+t.id+'"]').addClass("is-deleted"),this.refreshCollection(t))}},onModelsUpdated:function(e){if(e){var t=this;(e.deleted||[]).forEach(function(n){t.onModelDeleted({model:n,user:e.user})}),(e.added||[]).forEach(function(n){t.onModelAdded({model:n,user:e.user})}),(e.updated||[]).forEach(function(n){t.onModelEdited({model:n,user:e.user})})}},onReset:function(){this.render()},$row:function(e){return this.$('tr[data-id="'+e+'"]')},$cell:function(e,t){return this.$('tr[data-id="'+e+'"] > td[data-id="'+t+'"]')},refreshCollection:function(e){if(!e||!this.timers.refreshCollection){var t=Date.now();t-this.lastRefreshAt>this.refreshDelay?(this.lastRefreshAt=t,this.refreshCollectionNow()):this.timers.refreshCollection=setTimeout(this.refreshCollectionNow.bind(this),this.refreshDelay)}},refreshCollectionNow:function(t){if(this.timers){this.timers.refreshCollection&&clearTimeout(this.timers.refreshCollection),delete this.timers.refreshCollection,this.refreshReq&&this.refreshReq.abort();var n=this,i=this.promised(this.collection.fetch(e.isObject(t)?t:{reset:!0}));i.always(function(){n.refreshReq===i&&(n.refreshReq.abort(),n.refreshReq=null)}),this.refreshReq=i}},scrollTop:function(){var e=this.$el.offset().top-14,n=t(".navbar-fixed-top");n.length&&(e-=n.outerHeight()),window.scrollY>e&&t("html, body").stop(!0,!1).animate({scrollTop:e})},getModelFromEvent:function(e){return this.collection.get(this.$(e.target).closest(".list-item").attr("data-id"))},isNotClickable:function(e){var t=this.el.classList.contains("list")?this.el:this.el.querySelector(".list"),n=e.target,i=n.tagName;return!t.classList.contains("is-clickable")||"A"===i||"INPUT"===i||"BUTTON"===i||n.classList.contains("actions")||""!==window.getSelection().toString()||"TD"!==i&&this.$(n).closest("a, input, button").length},isScrollable:function(){var e=this.el.querySelector(".table-responsive");return!!e&&e.scrollWidth>e.offsetWidth},showContextMenu:function(e,t,n){var i=this,o=this.collection.get(e);if(o&&i.serializeActions)try{var a=i.serializeRow(o),s=i.serializeActions(),u=(s?s(a):[]).filter(function(e){return!(!e||e.disabled||e.className&&-1!==e.className.indexOf("disabled"))}).map(function(t){return{icon:"fa-"+t.icon,label:t.label,handler:function(){setTimeout(function(){var n=i.$row(e).find(".action-"+t.id);n.length&&n[0].click()},1)}}});u.length&&r.show(i,t,n,u)}catch(e){console.error(e)}}});function l(e,t,i){return t||(t=e.getNlsDomain()),n.has(t,i)?n(t,i):n("core",i)}return c.actions={viewDetails:function(e,t){return{id:"viewDetails",icon:"file-text-o",label:l(e,t,"LIST:ACTION:viewDetails"),href:e.genClientUrl()}},edit:function(e,t){return{id:"edit",icon:"edit",label:l(e,t,"LIST:ACTION:edit"),href:e.genClientUrl("edit")}},delete:function(e,t){return{id:"delete",icon:"times",label:l(e,t,"LIST:ACTION:delete"),href:e.genClientUrl("delete")}},viewEditDelete:function(e,t,n){var r=e.model,o=r.can&&(r.can.edit||r.can.manage),a=r.can&&(r.can.delete||r.can.manage);return function(s){var u=e.get(s._id),l=[c.actions.viewDetails(u,n)],d=i.isAllowedTo((t||u.getPrivilegePrefix())+":MANAGE");return(o&&o.call(r,u,"edit")||!o&&d)&&l.push(c.actions.edit(u,n)),(a&&a.call(r,u,"delete")||!a&&d)&&l.push(c.actions.delete(u,n)),l}}},c}),define("app/production/views/SnListView",["jquery","app/i18n","app/viewport","app/core/views/ListView"],function(e,t,n,i){"use strict";return i.extend({className:"is-colored",dialogClassName:"production-modal production-snList-modal",paginationOptions:{navigate:!1},columns:[{id:"_id",className:"is-min"},{id:"orderNo",className:"is-min"},{id:"serialNo",className:"is-min"},{id:"taktTime",className:"is-min"},"scannedAt"],serializeActions:function(){return null},onDialogShown:function(){this.ajax(this.collection.fetch({reset:!0}))}})}),define("app/production/templates/snChecker",["underscore","jquery","app/i18n","app/time","app/user","app/core/util/forms"],function(_,$,t,time,user,forms){return function anonymous(locals,escapeFn,include,rethrow){escapeFn=escapeFn||function(e){return void 0==e?"":String(e).replace(_MATCH_HTML,encode_char)};var _ENCODE_HTML_RULES={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&#34;","'":"&#39;"},_MATCH_HTML=/[&<>'"]/g;function encode_char(e){return _ENCODE_HTML_RULES[e]||e}var __output="";function __append(e){void 0!==e&&null!==e&&(__output+=e)}with(locals||{})__append('<form class="production-snChecker" autocomplete="off">\n  <div class="row">\n    <div class="col-lg-8">\n      <div class="form-group">\n        <label for="'),__append(id("orderNo")),__append('">'),__append(t("taktTime:check:orderNo")),__append('</label>\n        <input id="'),__append(id("orderNo")),__append('" class="form-control" type="text" autocomplete="new-password" value="'),__append(orderNo),__append('" required pattern="^[0-9]{9}$" data-sn-accept>\n      </div>\n    </div>\n    <div class="col-lg-4">\n      <div class="form-group">\n        <label for="'),__append(id("serialNo")),__append('">'),__append(t("taktTime:check:serialNo")),__append('</label>\n        <input id="'),__append(id("serialNo")),__append('" class="form-control" type="number" min="1" max="9999" required data-sn-accept>\n      </div>\n    </div>\n  </div>\n  <div id="'),__append(id("message")),__append('" class="message message-inline message-warning">\n    '),__append(t("taktTime:check:help")),__append('\n  </div>\n  <div class="form-actions">\n    <button id="'),__append(id("submit")),__append('" type="submit" class="btn btn-lg btn-primary">'),__append(t("taktTime:check:submit")),__append('</button>\n    <button id="'),__append(id("list")),__append('" type="button" class="btn btn-lg btn-link">'),__append(t("taktTime:check:list")),__append("</button>\n  </div>\n</form>\n");return __output}}),define("app/production/views/SnCheckerView",["jquery","app/i18n","app/viewport","app/core/View","app/prodSerialNumbers/ProdSerialNumberCollection","../snManager","./SnListView","app/production/templates/snChecker"],function(e,t,n,i,r,o,a,s){"use strict";return i.extend({template:s,dialogClassName:"production-modal production-snChecker-modal",localTopics:{"production.taktTime.snScanned":function(e){this.$id("orderNo").val(e.orderNo||""),this.$id("serialNo").val(e.serialNo||""),this.$id("submit").click()}},events:{"click #-list":function(){n.closeDialog();var e=new a({collection:new r(null,{rqlQuery:"sort(-scannedAt)&limit(15)&prodLine=string:"+(this.model.get("prodLine")||"")})});n.showDialog(e,t("production","taktTime:list:title"))},submit:function(){for(var e=this.$id("message").removeClass("message-info message-error message-success").addClass("message-warning").html(t("production","taktTime:check:checking")),n=parseInt(this.$id("orderNo").val(),10),i=parseInt(this.$id("serialNo").val(),10),r=i.toString();r.length<4;)r="0"+r;for(var a="PL04."+n+"."+r,s=n+r;s.length<17;)s="0"+s;if(s="P"+s,o.contains(a)||o.contains(s))return e.removeClass("message-warning").addClass("message-info").html(t("production","taktTime:check:local")),!1;var u=this.ajax({url:"/prodSerialNumbers?orderNo="+n+"&serialNo="+i+"&limit(1)"}),c=this.model.get("prodLine")||null;return u.fail(function(){e.removeClass("message-warning").addClass("message-danger").html(t("production","taktTime:check:error"))}),u.done(function(n){e.removeClass("message-warning");var i=(n.collection||[])[0];i?e.addClass("message-info").html(t("production","taktTime:check:"+(i.prodLine===c?"local":"remote"),{prodLine:i.prodLine})):e.addClass("message-success").html(t("production","taktTime:check:notFound"))}),!1}},getTemplateData:function(){return{orderNo:this.model.prodShiftOrder.get("orderId")||""}},onDialogShown:function(e){this.closeDialog=e.closeDialog.bind(e),this.$id("orderNo").focus()},closeDialog:function(){}})}),define("app/production/templates/propertyEditorDialog",["underscore","jquery","app/i18n","app/time","app/user","app/core/util/forms"],function(_,$,t,time,user,forms){return function anonymous(locals,escapeFn,include,rethrow){escapeFn=escapeFn||function(e){return void 0==e?"":String(e).replace(_MATCH_HTML,encode_char)};var _ENCODE_HTML_RULES={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&#34;","'":"&#39;"},_MATCH_HTML=/[&<>'"]/g;function encode_char(e){return _ENCODE_HTML_RULES[e]||e}var __output="";function __append(e){void 0!==e&&null!==e&&(__output+=e)}with(locals||{})__append('<form class="production-propertyEditorDialog">\n  <div class="form-group">\n    <label for="'),__append(id("value")),__append('">'),__append(t("propertyEditorDialog:label:"+property)),__append('</label>\n    <input id="'),__append(id("value")),__append('" class="form-control small is-embedded" type="text" autocomplete="new-password" value="'),__append(value),__append('" min="'),__append(min),__append('" max="'),__append(max),__append('" data-vkb="numeric '),__append(float?"decimal":""),__append('">\n  </div>\n  <div class="form-actions">\n    <button id="'),__append(id("submit")),__append('" class="btn btn-lg btn-primary" type="submit">'),__append(t("propertyEditorDialog:yes")),__append('</button>\n    <button class="btn btn-lg btn-link cancel" type="button">'),__append(t("propertyEditorDialog:no")),__append("</button>\n  </div>\n</form>\n");return __output}}),define("app/production/views/PropertyEditorDialogView",["jquery","app/i18n","app/core/View","app/production/templates/propertyEditorDialog"],function(e,t,n,i){"use strict";return n.extend({template:i,dialogClassName:"production-modal",events:{"focus #-value":function(e){this.options.vkb&&this.options.vkb.show(e.target,this.onVkbValueChange)},"input #-value":"checkMinMaxValidity","blur #-value":"checkMinMaxValidity",submit:function(e){e.preventDefault();var t=this[this.options.float?"parseFloat":"parseInt"]("value");t!==this.options.getValue()&&this.options.setValue(t),this.closeDialog()}},initialize:function(){this.onVkbValueChange=this.onVkbValueChange.bind(this)},destroy:function(){this.options.vkb&&this.options.vkb.hide()},getTemplateData:function(){return{property:this.options.property,value:(this.options.value||0).toLocaleString(),min:this.options.min||0,max:this.options.max,pattern:this.options.pattern||"",float:this.options.float}},onDialogShown:function(e){this.closeDialog=e.closeDialog.bind(e),this.$id("value").select()},closeDialog:function(){},parseFloat:function(e){var t=Math.round(10*parseFloat(this.$id(e).val().replace(",",".")))/10;return isNaN(t)||t<0?0:t},parseInt:function(e){var t=parseInt(this.$id(e).val(),10);return isNaN(t)||t<0?0:t},onVkbValueChange:function(e){this.checkMinMaxValidity({target:e})},checkMinMaxValidity:function(e){var n=e.target,i=parseInt(n.getAttribute("max"),10);if(!isNaN(i)){var r=parseInt(n.getAttribute("min"),10)||0,o=this[this.options.float?"parseFloat":"parseInt"]("value"),a="";o<r?a=t("production","error:min",{min:r}):o>i&&(a=t("production","error:max",{max:i})),n.setCustomValidity(a)}}})}),define("app/production/templates/data",["underscore","jquery","app/i18n","app/time","app/user","app/core/util/forms"],function(_,$,t,time,user,forms){return function anonymous(locals,escapeFn,include,rethrow){escapeFn=escapeFn||function(e){return void 0==e?"":String(e).replace(_MATCH_HTML,encode_char)};var _ENCODE_HTML_RULES={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&#34;","'":"&#39;"},_MATCH_HTML=/[&<>'"]/g;function encode_char(e){return _ENCODE_HTML_RULES[e]||e}var __output="";function __append(e){void 0!==e&&null!==e&&(__output+=e)}with(locals||{})__append('<div class="production-data">\n  <h2 class="production-sectionHeader">'),__append(t("section:data")),__append('</h2>\n  <div class="production-properties production-properties-orderInfo">\n    '),["orderNo","nc12","productName","operationName"].forEach(function(e){__append('\n    <div id="'),__append(id(e)),__append('" class="production-property production-property-'),__append(e),__append('">\n      <div class="production-property-name">'),__append(t("property:"+e)),__append('</div>\n      <div class="production-property-value"></div>\n    </div>\n    ')}),__append('\n  </div>\n  <div class="production-properties production-properties-orderData">\n    '),["createdAt","totalQuantityDone","quantityDone","workerCount","workerCountSap","taktTime","lastTaktTime","avgTaktTime"].forEach(function(e){__append('\n    <div id="'),__append(id(e)),__append('" class="production-property production-property-'),__append(e),__append('">\n      <div class="production-property-name">'),__append(t("property:"+e)),__append('</div>\n      <div class="production-property-value"></div>\n    </div>\n    ')}),__append('\n  </div>\n  <div class="production-actions"></div>\n</div>\n');return __output}}),define("app/production/templates/endDowntimeDialog",["underscore","jquery","app/i18n","app/time","app/user","app/core/util/forms"],function(_,$,t,time,user,forms){return function anonymous(locals,escapeFn,include,rethrow){escapeFn=escapeFn||function(e){return void 0==e?"":String(e).replace(_MATCH_HTML,encode_char)};var _ENCODE_HTML_RULES={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&#34;","'":"&#39;"},_MATCH_HTML=/[&<>'"]/g;function encode_char(e){return _ENCODE_HTML_RULES[e]||e}var __output="";function __append(e){void 0!==e&&null!==e&&(__output+=e)}with(locals||{})__append('<div class="production-question">\n  '),__append(t("endDowntimeDialog:message")),__append('\n  <div class="form-actions">\n    <button class="btn btn-lg btn-'),__append(yesSeverity),__append(' dialog-answer" type="button" autofocus data-answer="yes">'),__append(t("endDowntimeDialog:yes")),__append('</button>\n    <button class="btn btn-lg btn-link cancel" type="button">'),__append(t("endDowntimeDialog:no")),__append("</button>\n  </div>\n</div>\n");return __output}}),define("app/production/templates/continueOrderDialog",["underscore","jquery","app/i18n","app/time","app/user","app/core/util/forms"],function(_,$,t,time,user,forms){return function anonymous(locals,escapeFn,include,rethrow){escapeFn=escapeFn||function(e){return void 0==e?"":String(e).replace(_MATCH_HTML,encode_char)};var _ENCODE_HTML_RULES={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&#34;","'":"&#39;"},_MATCH_HTML=/[&<>'"]/g;function encode_char(e){return _ENCODE_HTML_RULES[e]||e}var __output="";function __append(e){void 0!==e&&null!==e&&(__output+=e)}with(locals||{})__append('<div class="production-question">\n  '),__append(t("continueOrderDialog:message")),__append('\n  <div class="form-actions">\n    <button class="btn btn-lg btn-success dialog-answer" type="button" autofocus data-answer="yes">'),__append(t("continueOrderDialog:yes")),__append('</button>\n    <button class="btn btn-lg btn-link cancel" type="button">'),__append(t("continueOrderDialog:no")),__append("</button>\n  </div>\n</div>\n");return __output}}),define("app/production/views/ProductionDataView",["underscore","jquery","app/i18n","app/time","app/viewport","app/core/View","app/core/views/DialogView","app/data/prodLog","./NewOrderPickerView","./DowntimePickerView","./EndWorkDialogView","./OrderQueueView","./SnCheckerView","./PropertyEditorDialogView","app/production/templates/data","app/production/templates/endDowntimeDialog","app/production/templates/continueOrderDialog"],function(e,t,n,i,r,o,a,s,u,c,l,d,p,f,h,m,g){"use strict";return o.extend({template:h,localTopics:{"socket.connected":function(){this.toggleNextOrderAction(),this.fillOrderData()},"socket.disconnected":"toggleNextOrderAction"},events:{"click .production-newOrder":"newOrder","click .production-nextOrder":"nextOrder","click .production-continueOrder":"continueOrder","click .production-startDowntime":"startDowntime","click .production-startBreak":"startBreak","click .production-endDowntime":"endDowntime","click .production-endWork":"endWork","click #-orderNo":"correctOrder","click #-nc12":"correctOrder","click #-quantityDone":"showQuantityDoneEditor","click #-workerCount":"showWorkerCountEditor","click #-checkSn":function(){r.showDialog(new p({model:this.model}),n("production","taktTime:check:title"))}},initialize:function(){this.listenTo(this.model,"locked unlocked",function(){this.updateWorkerCount(),this.updateTotalQuantityDone(),this.updateQuantityDone(),this.toggleActions()}),this.listenTo(this.model,"change:state",this.toggleActions),this.listenTo(this.model,"newOrderRequested",function(e){this.newOrder(null,e)});var t=this.model.prodShiftOrder;this.listenTo(t,"change:_id change:orderId change:operationNo",e.debounce(function(){this.updateOrderData(),this.updateOrderInfo()},1)),this.listenTo(t,"change:totalQuantityDone change:orderData",e.debounce(function(){this.updateTotalQuantityDone()},1)),this.listenTo(t,"change:quantityDone",e.debounce(function(){this.updateQuantityDone(),this.updateTaktTime()},1)),this.listenTo(t,"change:workerCount",e.debounce(function(){this.updateTaktTime(),this.updateWorkerCount()},1)),this.listenTo(this.model.settings,"reset change",function(e){e&&!/taktTime/.test(e.id)||(this.updateQuantityDone(),this.updateTaktTime())})},destroy:function(){document.body.classList.remove("is-tt-ok","is-tt-nok")},afterRender:function(){this.$actions=this.$(".production-actions"),this.updateOrderData(),this.updateOrderInfo(),this.updateTotalQuantityDone(),this.updateQuantityDone(),this.toggleActions(),this.socket.isConnected()&&this.fillOrderData()},updateOrderInfo:function(){var e=this.model.prodShiftOrder;this.updateOrderNo(),this.updateNc12(),this.$property("productName").text(e.getProductName()),this.$property("operationName").text(e.getOperationName())},updateOrderData:function(){this.$el.toggleClass("has-order",this.model.hasOrder()),this.updateTaktTime(),this.updateWorkerCount(),this.$property("createdAt").text(this.model.prodShiftOrder.getStartedAt())},updateOrderNo:function(){var e=this.model.prodShiftOrder.getOrderNo();this.model.isLocked()||!this.model.hasOrder()||this.model.prodShiftOrder.isMechOrder()||(e+=' <button class="btn btn-link">'+n("production","property:orderNo:change")+"</button>"),this.$property("orderNo").html(e)},updateNc12:function(){var e=this.model.prodShiftOrder.getNc12();!this.model.isLocked()&&this.model.hasOrder()&&this.model.prodShiftOrder.isMechOrder()&&(e+=' <button class="btn btn-link">'+n("production","property:nc12:change")+"</button>"),this.$property("nc12").html(e)},updateWorkerCount:function(){this.$property("workerCountSap").text(this.model.prodShiftOrder.getWorkerCountSap());var e=this.model.prodShiftOrder.getWorkerCount(),t="";if(this.model.isIdle())t="-";else if(this.model.isLocked())t="number"==typeof e?e.toLocaleString():"-";else{var i="property:workerCount:change:noData";e>0&&(i="property:workerCount:change:data",t+=e.toLocaleString()+" "),t+='<button class="btn btn-link">'+n("production",i)+"</button>"}this.$property("workerCount").html(t)},updateTaktTime:function(){var e=this.model,i=e.isTaktTimeEnabled(),r=e.settings.showLastTaktTime(),o=e.settings.showAvgTaktTime(),a=e.settings.showSapTaktTime(),s=e.settings.showSmiley(),u=e.prodShiftOrder,c=this.$property("lastTaktTime"),l=this.$property("avgTaktTime"),d=this.$property("taktTime"),p=u.getAvgTaktTime(),f=u.getLastTaktTime(),h=u.getSapTaktTime();i&&r&&f?c.parent().removeClass("is-tt-sap").addClass("is-tt-last"):c.parent().addClass("is-tt-sap").removeClass("is-tt-last");var m,g=!i||!r,v=!i||!o||!(u.get("quantityDone")>1&&p>0);if(d.text(h||"-").parent().toggleClass("hidden",!a),c.text(f||"-").parent().toggleClass("hidden",g).removeClass("is-ok is-nok").addClass(f<=h?"is-ok":"is-nok"),l.text(p||"-").parent().toggleClass("hidden",v).removeClass("is-ok is-nok").addClass(p<=h?"is-ok":"is-nok"),m=v?g?t("<div></div>"):c:l,s||m.append(' <button id="'+this.idPrefix+'-checkSn" class="btn btn-link">'+n("production","property:taktTime:checkSn")+"</button>"),document.body.classList.remove("is-tt-ok","is-tt-nok"),i&&h){var y=p?p<=h:f<=h;document.body.classList.add(y?"is-tt-ok":"is-tt-nok")}},updateTotalQuantityDone:function(){var e="",t=this.model,n=t.prodShiftOrder;if(t.isIdle())e="-";else{var i,r,o=n.getOperation(),a=n.get("totalQuantityDone")||{total:0,byOperation:{}};o?(i=o.qty,r=a.byOperation?a.byOperation[o.no]||0:-1):i=(n.get("orderData")||{}).qty||-1,e+=r>=0?r.toLocaleString():"?",e+="/",e+=i>=0?i.toLocaleString():"?"}this.$property("totalQuantityDone").html(e)},updateQuantityDone:function(){var e;this.model.isIdle()?e="-":(e=String(this.model.prodShiftOrder.getQuantityDone()),this.model.isLocked()||this.model.isTaktTimeEnabled()||(e+=' <button class="btn btn-link">'+n("production","property:quantityDone:change")+"</button>")),this.$property("quantityDone").html(e)},toggleActions:function(){this.$actions&&this.$actions.empty(),this.model.isLocked()||(this.model.isIdle()?this.toggleIdleActions():this.model.isWorking()?this.toggleWorkingActions():this.toggleDowntimeActions())},toggleIdleActions:function(){e.defer(function(e){e.model.prodShiftOrder.hasOrderData()&&e.appendAction("success","continueOrder"),e.appendAction("success","newOrder"),e.appendAction("success","nextOrder")},this)},toggleWorkingActions:function(){this.appendAction("danger","startDowntime"),this.model.getDefaultAor()&&this.appendAction("danger","startBreak"),this.appendAction("success","newOrder"),this.appendAction("success","nextOrder"),this.appendAction("warning","endWork"),this.toggleNextOrderAction()},toggleDowntimeActions:function(){this.model.hasOrder()?(this.appendAction("success","endDowntime"),this.appendAction("warning","endWork")):this.appendAction("warning","endDowntime")},appendAction:function(e,t){var i=["btn","btn-"+e,"production-action","production-"+t],r=n("production","action:"+t);this.$actions.append('<button class="'+i.join(" ")+'">'+r+"</button>")},$property:function(e){return this.$(".production-property-"+e+" .production-property-value")},newOrder:function(e,t){e&&e.target.blur(),r.currentDialog||r.showDialog(new u({model:this.model,embedded:this.options.embedded,vkb:this.options.vkb,order:t}),n("production","newOrderPicker:title"+(this.model.hasOrder()?":replacing":"")))},nextOrder:function(e){e&&e.target.blur(),r.currentDialog||r.showDialog(new d({model:this.model,embedded:this.options.embedded,vkb:this.options.vkb}),n("production","orderQueue:title"))},continueOrder:function(e){if(e&&e.target.blur(),!r.currentDialog){var t=new a({dialogClassName:"production-modal",template:g});this.listenTo(t,"answered",function(e){"yes"===e&&this.model.continueOrder()}),r.showDialog(t,n("production","continueOrderDialog:title"))}},correctOrder:function(e){e&&e.target.blur(),r.currentDialog||this.model.isLocked()||"idle"===this.model.get("state")||r.showDialog(new u({model:this.model,correctingOrder:!0,embedded:this.options.embedded,vkb:this.options.vkb}),n("production","newOrderPicker:title:correcting"))},startDowntime:function(t,o){if(t&&t.target.blur(),!r.currentDialog){o||(o={}),o.embedded=this.options.embedded,o.vkb=this.options.vkb,o.model=e.defaults(o.model||{},{mode:"start",prodShift:this.model,startedAt:i.getMoment().toDate(),reason:null,aor:null,reasonComment:null});var a=new c(o);this.listenTo(a,"downtimePicked",function(e){r.closeDialog(),this.model.startDowntime(e)}),r.showDialog(a,n("production","downtimePicker:title:start"))}},startBreak:function(e){this.startDowntime(e,{model:{prodShift:this.model,reason:this.model.getBreakReason(),aor:this.model.getDefaultAor()}})},endDowntime:function(e){if(e&&e.target.blur(),!r.currentDialog){var t=new a({dialogClassName:"production-modal",template:m,nlsDomain:"production",model:{yesSeverity:this.model.hasOrder()?"success":"warning"}});this.listenTo(t,"answered",function(e){"yes"===e&&this.model.endDowntime()}),r.showDialog(t,n("production","endDowntimeDialog:title"))}},endWork:function(e){e&&e.target.blur(),r.currentDialog||r.showDialog(new l({model:this.model,embedded:this.options.embedded,vkb:this.options.vkb}),n("production","endWorkDialog:title"))},showEditor:function(n,i,r,o,a){if(n.find(".btn").length&&!this.model.isLocked()){var s=n.find(".production-property-value"),u=this,c=t("<form></form>").submit(function(){return p(),!1}),l=t('<input class="form-control input-lg" type="number">').val(i).attr("min",r).attr("max",o).on("keydown",function(t){27===t.which&&e.defer(d)}).css({position:"absolute",width:s.width()+"px"}).appendTo(c);c.appendTo(s),e.defer(function(){l.select().on("blur",function(){e.defer(p)})})}function d(){c.remove()}function p(){var e=parseInt(l.val(),10);d(),!isNaN(e)&&e>=r&&e<=o&&u.model[a](e)}},showQuantityDoneEditor:function(){var e=this,t=e.model.prodShiftOrder;if(e.options.embedded)return r.showDialog(new f({model:e.model,vkb:e.options.vkb,property:"quantityDone",value:t.getQuantityDone(),max:t.getMaxQuantityDone(),getValue:function(){return t.get("quantityDone")||0},setValue:function(t){e.model.changeQuantityDone(t)}}),n("production","propertyEditorDialog:title:quantityDone"));e.showEditor(e.$(".production-property-quantityDone"),t.getQuantityDone(),0,t.getMaxQuantityDone(),"changeQuantityDone")},showWorkerCountEditor:function(){var e=this,t=e.model.prodShiftOrder;if(e.options.embedded)return r.showDialog(new f({model:e.model,vkb:e.options.vkb,property:"workerCount",float:!0,value:t.getWorkerCountForEdit(),min:1,max:t.getMaxWorkerCount(),getValue:function(){return t.get("workerCount")||0},setValue:function(t){e.model.changeWorkerCount(t)}}),e.t("propertyEditorDialog:title:workerCount"));this.showEditor(e.$(".production-property-workerCount"),t.getWorkerCountForEdit(),1,t.getMaxWorkerCount(),"changeWorkerCount")},fillOrderData:function(){var t=this.model.prodShiftOrder.get("orderId"),n=this.model.prodShiftOrder.get("orderData");if(t&&(!n||e.isEmpty(n.operations))){if(s.isSyncing())return this.broker.subscribe("production.synced",this.fillOrderData.bind(this)).setLimit(1);this.fetchOrderData()}},fetchOrderData:function(){var e=this,n=this.model,i=n.prodShiftOrder.get("mechOrder")?"nc12":"no",r=n.prodShiftOrder.get("orderId"),o=t.ajax({type:"GET",url:"/production/orders?"+i+"="+encodeURIComponent(r)});this.promised(o).then(function(t){if(Array.isArray(t)&&t.length){var r=t[0];"no"===i?r.no=r._id:(r.nc12=r._id,r.no=null),delete r._id,n.prodShiftOrder.set("orderData",n.prodShiftOrder.prepareOperations(r)),n.saveLocalData(),e.updateOrderData(),e.updateOrderInfo()}})},toggleNextOrderAction:function(){this.$(".production-nextOrder").toggleClass("hidden",!this.socket.isConnected())}})}),define("app/production/views/ProdDowntimeListView",["app/i18n","app/time","app/viewport","app/data/aors","app/data/downtimeReasons","app/core/views/ListView","./DowntimePickerView"],function(e,t,n,i,r,o,a){"use strict";return o.extend({localTopics:{"downtimeReasons.synced":"render","aors.synced":"render"},remoteTopics:function(){var e={};return this.model.prodLine&&(e["prodDowntimes.corroborated."+this.model.prodLine.id+".*"]="onCorroborated"),e},events:{"click .warning":function(e){this.showEditDialog(e.currentTarget.dataset.id)}},initialize:function(){this.collection=this.model.prodDowntimes,o.prototype.initialize.apply(this,arguments),this.listenTo(this.collection,"add",this.render),this.listenTo(this.collection,"change",this.render),this.listenTo(this.collection,"remove",this.render)},destroy:function(){this.$el.popover("destroy")},serializeColumns:function(){return[{id:"time",label:e("production","prodDowntime:time"),className:"is-min"},{id:"reason",label:e("production","prodDowntime:reason"),className:"is-min"},{id:"aor",label:e("production","prodDowntime:aor")}]},serializeRows:function(){var e=this.model.id;return this.model.prodDowntimes.filter(function(t){return t.get("prodShift")===e}).map(function(e){var n=e.toJSON(),o=i.get(n.aor),a=r.get(n.reason);return n.className=e.getCssClassName(),n.time=t.format(n.startedAt,"LTS"),n.finishedAt&&(n.time+="-"+t.format(n.finishedAt,"LTS")),o&&(n.aor=o.get("name")),a&&(n.reason=a.get("label")),n.reasonComment&&(n.className+=" has-comment",n.reason+=' <i class="fa fa-info-circle"></i>'),n})},serializeActions:function(){return[]},afterRender:function(){o.prototype.afterRender.call(this);var e=this;this.$el.popover({selector:".has-comment",trigger:"hover",placement:"top",container:this.el.ownerDocument.body,content:function(){return e.model.prodDowntimes.get(this.dataset.id).get("reasonComment")}}).on("shown.bs.popover",function(t){e.$(t.target).data("bs.popover").tip().addClass("production-downtimes-popover")})},onCorroborated:function(e){var t=this.model.prodDowntimes.get(e._id);t&&(delete e.changes,t.set(e),this.trigger("corroborated",e._id))},showEditDialog:function(t){var i=this.model,r=i.prodDowntimes.get(t);if(r){var o=new a({embedded:this.options.embedded,vkb:this.options.vkb,model:{mode:"edit",prodShift:i,startedAt:new Date(r.get("startedAt")),reason:r.get("reason"),aor:r.get("aor"),reasonComment:r.get("reasonComment")}});this.listenTo(o,"downtimePicked",function(e){delete e.startedAt,i.editDowntime(r,e),n.closeDialog()}),n.showDialog(o,e("production","downtimePicker:title:edit"))}}})}),define("app/production/templates/quantityEditor",["underscore","jquery","app/i18n","app/time","app/user","app/core/util/forms"],function(_,$,t,time,user,forms){return function anonymous(locals,escapeFn,include,rethrow){escapeFn=escapeFn||function(e){return void 0==e?"":String(e).replace(_MATCH_HTML,encode_char)};var _ENCODE_HTML_RULES={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&#34;","'":"&#39;"},_MATCH_HTML=/[&<>'"]/g;function encode_char(e){return _ENCODE_HTML_RULES[e]||e}var __output="";function __append(e){void 0!==e&&null!==e&&(__output+=e)}with(locals||{})__append('<form class="production-quantityEditor">\n  <div class="form-group">\n    <label for="'),__append(id("quantity")),__append('">'),__append(escapeFn(t("quantityEditor:label:hour"))),__append('</label>\n    <div class="btn-group" data-toggle="buttons">\n      '),hours.forEach(function(e){__append('\n      <label class="btn btn-default '),__append(e.disabled?"disabled":""),__append('">\n        <input type="radio" autocomplete="off" name="hour" value="'),__append(e.index),__append('" data-value="'),__append(e.value),__append('">\n        '),__append(e.from),__append("<br>"),__append(e.to),__append("\n      </label>\n      ")}),__append('\n    </div>\n  </div>\n  <div class="form-group">\n    <label for="'),__append(id("value")),__append('">'),__append(escapeFn(t("quantityEditor:label:value"))),__append('</label>\n    <input id="'),__append(id("value")),__append('" class="form-control input-lg small '),__append(embedded?"is-embedded":""),__append('" type="'),__append(embedded?"text":"number"),__append('" min="0" max="'),__append(maxQuantity),__append('" data-vkb="numeric">\n  </div>\n  <div class="form-actions">\n    <button type="submit" class="btn btn-lg btn-primary">'),__append(t("quantityEditor:submit")),__append('</button>\n    <button type="button" class="cancel btn btn-lg btn-link">'),__append(t("quantityEditor:cancel")),__append("</button>\n  </div>\n</form>\n");return __output}}),define("app/production/views/QuantityEditorView",["underscore","app/i18n","app/viewport","app/core/View","app/production/templates/quantityEditor"],function(e,t,n,i,r){"use strict";return i.extend({template:r,events:{'change input[name="hour"]':function(t){var n=this.$id("value").val(this.model.hours[t.target.value].value);this.checkValidity(),e.defer(function(){n.select()})},"input #-value":"checkValidity",submit:function(e){e.preventDefault();var t=parseInt(this.$('input[name="hour"]:checked').val(),10),n=parseInt(this.$id("value").val(),10),i=this.model.hours[t];i&&((isNaN(n)||n===i.value||n<0)&&(n=null),this.trigger("quantityChanged",t,n))}},destroy:function(){this.options.vkb&&this.options.vkb.hide()},getTemplateData:function(){return{hours:this.model.hours,maxQuantity:this.model.maxQuantity,embedded:this.options.embedded}},afterRender:function(){this.$id("value").select()},onDialogShown:function(){this.options.vkb&&this.options.vkb.show(this.$id("value")[0],this.checkValidity.bind(this)),this.$('input[name="hour"][value="'+this.model.selected+'"]').click()},checkValidity:function(){var e=this.$id("value"),n=parseInt(e.val(),10);isNaN(n)||n<0?e.val("")[0].setCustomValidity(""):n>this.model.maxQuantity?e[0].setCustomValidity(t("production","quantityEditor:maxQuantity",{max:this.model.maxQuantity})):e[0].setCustomValidity("")}})}),define("app/production/templates/quantities",["underscore","jquery","app/i18n","app/time","app/user","app/core/util/forms"],function(_,$,t,time,user,forms){return function anonymous(locals,escapeFn,include,rethrow){escapeFn=escapeFn||function(e){return void 0==e?"":String(e).replace(_MATCH_HTML,encode_char)};var _ENCODE_HTML_RULES={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&#34;","'":"&#39;"},_MATCH_HTML=/[&<>'"]/g;function encode_char(e){return _ENCODE_HTML_RULES[e]||e}var __output="";function __append(e){void 0!==e&&null!==e&&(__output+=e)}with(locals||{})__append('<table class="table table-bordered table-hover table-condensed">\n  <thead>\n    <tr>\n      <th class="is-min">'),__append(t("quantities:column:time")),__append('</th>\n      <th class="is-min">'),__append(t("quantities:column:planned")),__append("</th>\n      <th>"),__append(t("quantities:column:actual")),__append("</th>\n    </tr>\n  </thead>\n  <tbody>\n    "),quantityRows.forEach(function(e,n){__append('\n    <tr>\n      <td class="is-min">'),__append(e.time),__append('</td>\n      <td class="is-min">'),__append(e.planned),__append(" "),__append(t("quantities:unit")),__append('</td>\n      <td class="production-quantities-actual" data-hour="'),__append(n),__append('">\n        <span>'),__append(e.actual),__append(" "),__append(t("quantities:unit")),__append("</span>\n        "),e.editable&&(__append('\n        <button class="btn btn-link">'),__append(t("quantities:change")),__append("</button>\n        ")),__append("\n      </td>\n    </tr>\n    ")}),__append("\n  </tbody>\n</table>\n");return __output}}),define("app/production/views/ProductionQuantitiesView",["underscore","jquery","app/time","app/i18n","app/viewport","app/core/View","./QuantityEditorView","app/production/templates/quantities"],function(e,t,n,i,r,o,a,s){"use strict";return o.extend({template:s,events:{"click .production-quantities-actual":"showQuantityEditor","mousedown .production-quantities-actual":"showQuantityEditor"},initialize:function(){this.onQuantitiesDoneChanged=this.onQuantitiesDoneChanged.bind(this),this.listenTo(this.model,"change:shift locked unlocked",this.render),this.listenTo(this.model.settings,"reset change",function(e){e&&!/taktTime/.test(e.id)||this.render()})},getTemplateData:function(){var e=n.getMoment().valueOf(),t=this.model.getCurrentShiftMoment(),i=!this.model.isLocked(),r=this.model.isTaktTimeEnabled();return{quantityRows:(this.model.get("quantitiesDone")||[]).map(function(n,o){var a=i,s=t.format("HH:00");return t.add(59,"minutes").add(59,"seconds"),a=7===o?a&&e>t.valueOf()-6e5:a&&e>t.valueOf(),{time:s+="-"+t.add(1,"seconds").format("HH:00"),planned:n.planned,actual:n.actual,editable:(a||n.actual>0)&&!r}})}},beforeRender:function(){this.stopListening(this.model,"change:quantitiesDone",this.onQuantitiesDoneChanged)},afterRender:function(){this.listenTo(this.model,"change:quantitiesDone",this.onQuantitiesDoneChanged),this.timers.nextRender&&clearTimeout(this.timers.nextRender),this.model.isLocked()||this.scheduleNextRender(),window.qv=this},scheduleNextRender:function(){var e=this.model.getCurrentShiftMoment().add(7,"hours").hours(),t=n.getMoment(),i=t.valueOf(),r=t.hours(),o=t.minutes(0).seconds(0).milliseconds(0).add(1,"hours").valueOf(),a=(r===e?o-6e5:o)+1e3-i;a>0?this.timers.nextRender=setTimeout(function(e){e.render(),e.showEditorDialog()},a,this):delete this.timers.nextRender},showQuantityEditor:function(n){var r=this.$(n.target).closest("td");if(!(r.find("input").length||this.model.isLocked()||this.model.isTaktTimeEnabled()))if(this.options.embedded)this.showEditorDialog(r);else if(r.find(".btn-link").length){var o=this,a=this.model.getMaxQuantitiesDone(),s=r.find(".btn-link").hide(),u=r.find("span").hide(),c=parseInt(u.text(),10),l=t("<form></form>").submit(function(){return f(),!1}),d=t('<input class="form-control production-quantities-editor" type="number" min="0">').attr({placeholder:i("production","quantities:newValuePlaceholder"),max:a,value:c}).on("keydown",function(t){27===t.which&&e.defer(p)}).appendTo(l);l.appendTo(r),e.defer(function(){d.select().on("blur",function(){e.defer(f)})})}function p(){l.remove(),s.show(),u.show()}function f(){var e=parseInt(d.val(),10);p();var t=r.attr("data-hour");e!==c&&e>=0&&e<=a&&(u.text(e+" "+i("production","quantities:unit")),o.model.changeQuantitiesDone(parseInt(t,10),e,{render:!1}))}},showEditorDialog:function(e){if(!(this.model.isTaktTimeEnabled()||r.currentDialog&&r.currentDialog instanceof a)){var n=this.$(".btn-link");if(e&&e.length&&e.find(".btn-link").length||(e=n.last().closest("td")),e.length){var o={hours:[],maxQuantity:this.model.getMaxQuantitiesDone(),selected:parseInt(e.attr("data-hour"),10)};this.$(".production-quantities-actual").each(function(){var e=t(this),n=e.parent().find("td:first-child").text().trim().split("-"),i=parseInt(e.attr("data-hour"),10);o.hours.push({from:n[0],to:n[1],index:i,value:parseInt(e.find("span").text(),10),disabled:0===e.find(".btn-link").length})});var s=new a({model:o,embedded:this.options.embedded,vkb:this.options.vkb});this.listenTo(s,"quantityChanged",function(e,t){r.closeDialog(),null!==t&&this.model.changeQuantitiesDone(e,t,{render:!0})}),r.closeDialogs(function(e){return!(e instanceof a)}),r.showDialog(s,i("production","quantityEditor:title"))}}},onQuantitiesDoneChanged:function(e,t,n){!1!==n.render&&this.render()}})}),define("app/production/templates/isaPalletDeliveryDialog",["underscore","jquery","app/i18n","app/time","app/user","app/core/util/forms"],function(_,$,t,time,user,forms){return function anonymous(locals,escapeFn,include,rethrow){escapeFn=escapeFn||function(e){return void 0==e?"":String(e).replace(_MATCH_HTML,encode_char)};var _ENCODE_HTML_RULES={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&#34;","'":"&#39;"},_MATCH_HTML=/[&<>'"]/g;function encode_char(e){return _ENCODE_HTML_RULES[e]||e}var __output="";function __append(e){void 0!==e&&null!==e&&(__output+=e)}with(locals||{})__append('<form class="production-isa-palletDelivery">\n  <div class="form-group">\n    <label for="'),__append(id("qty")),__append('">'),__append(t("isa:deliver:qty")),__append('</label>\n    <input id="'),__append(id("qty")),__append('" class="form-control" type="text" autocomplete="new-password" data-vkb="numeric" required>\n  </div>\n  <div id="'),__append(id("palletKind")),__append('" class="production-form-btn-group">\n    <label>'),__append(t("isa:deliver:palletKind")),__append('</label>\n    <div class="btn-group-vertical">\n      '),palletKinds.forEach(function(e){__append('\n      <button type="button" class="btn btn-lg btn-default" data-id="'),__append(e.id),__append('">'),__append(escapeFn(e.text)),__append("</button>\n      ")}),__append('\n    </div>\n  </div>\n  <div class="form-actions">\n    <button id="'),__append(id("submit")),__append('" type="submit" class="btn btn-lg btn-primary" disabled>'),__append(t("isa:deliver:submit")),__append('</button>\n    <button type="button" class="cancel btn btn-lg btn-link">'),__append(t("isa:deliver:cancel")),__append("</button>\n  </div>\n</form>\n");return __output}}),define("app/production/views/IsaPalletDeliveryDialogView",["app/i18n","app/core/View","app/data/localStorage","app/data/isaPalletKinds","app/production/templates/isaPalletDeliveryDialog"],function(e,t,n,i,r){"use strict";return t.extend({template:r,dialogClassName:"production-modal",nlsDomain:"production",events:{"input #-qty":"checkQtyValidity","click .btn[data-id]":function(e){this.$id("palletKind").find(".active").removeClass("active"),this.$(e.currentTarget).addClass("active").blur(),this.toggleSubmit()},submit:function(e){e.preventDefault();var t=this.$id("palletKind").find(".active").attr("data-id"),i=+this.$id("qty").val();n.setItem("PRODUCTION:ISA:LAST_DELIVERY",JSON.stringify({palletKind:t,qty:i})),this.trigger("picked",t,i)}},destroy:function(){this.options.vkb&&this.options.vkb.hide()},getTemplateData:function(){return{palletKinds:i.map(function(e){return{id:e.id,text:e.get("fullName")}})}},afterRender:function(){this.options.embedded&&this.options.vkb.show(this.$id("qty").addClass("is-embedded")[0],this.onVkbValueChange.bind(this));var e=JSON.parse(n.getItem("PRODUCTION:ISA:LAST_DELIVERY")||"{}");this.$id("qty").val(e.qty||8),this.$id("palletKind").find('.btn[data-id="'+e.palletKind+'"]').click(),this.checkQtyValidity()},toggleSubmit:function(){this.$id("submit").prop("disabled",!this.$id("palletKind").find(".active").length)},checkQtyValidity:function(){var t=this.$id("qty"),n=t.val().replace(/[^0-9]+/g,"")||0,i="";n<1?i=e("production","error:min",{min:1}):n>9&&(i=e("production","error:max",{max:9})),t.val(n||"")[0].setCustomValidity(i),this.toggleSubmit()},onVkbValueChange:function(){this.checkQtyValidity()},onDialogShown:function(e){this.closeDialog=e.closeDialog.bind(e),this.$id("qty").focus()},closeDialog:function(){}})}),define("app/production/templates/isa",["underscore","jquery","app/i18n","app/time","app/user","app/core/util/forms"],function(_,$,t,time,user,forms){return function anonymous(locals,escapeFn,include,rethrow){escapeFn=escapeFn||function(e){return void 0==e?"":String(e).replace(_MATCH_HTML,encode_char)};var _ENCODE_HTML_RULES={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&#34;","'":"&#39;"},_MATCH_HTML=/[&<>'"]/g;function encode_char(e){return _ENCODE_HTML_RULES[e]||e}var __output="";function __append(e){void 0!==e&&null!==e&&(__output+=e)}with(locals||{})__append('<div class="production-isa-sections">\n  <div class="production-isa-section">\n    <div class="production-isa-status '),__append(pickupIndicatorColor),__append('">\n      <span class="production-isa-status-label">'),__append(pickupStatusLabel),__append('</span>\n    </div>\n    <button id="'),__append(id("pickup")),__append('" class="btn btn-lg btn-block btn-default production-isa-btn '),__append(pickupActive?"active":""),__append('" '),__append(pickupDisabled?"disabled":""),__append(">\n      "),__append(t("isa:pickup")),__append('\n    </button>\n  </div>\n  <div class="production-isa-section">\n    <div class="production-isa-status '),__append(deliveryIndicatorColor),__append('">\n      <span class="production-isa-status-label">'),__append(deliveryStatusLabel),__append('</span>\n    </div>\n    <div class="dropup">\n      <button id="'),__append(id("deliver")),__append('" class="btn btn-lg btn-block btn-default production-isa-btn '),__append(deliveryActive?"active":""),__append('" '),__append(deliveryDisabled?"disabled":""),__append(">\n        "),selectedPalletKind?(__append("\n        "),__append(t("isa:deliver:specific",{qty:selectedQty,palletKind:selectedPalletKind})),__append("\n        ")):(__append("\n        "),__append(t("isa:deliver")),__append("\n        ")),__append("\n      </button>\n    </div>\n  </div>\n</div>\n");return __output}}),define("app/production/templates/isaCancelDialog",["underscore","jquery","app/i18n","app/time","app/user","app/core/util/forms"],function(_,$,t,time,user,forms){return function anonymous(locals,escapeFn,include,rethrow){escapeFn=escapeFn||function(e){return void 0==e?"":String(e).replace(_MATCH_HTML,encode_char)};var _ENCODE_HTML_RULES={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&#34;","'":"&#39;"},_MATCH_HTML=/[&<>'"]/g;function encode_char(e){return _ENCODE_HTML_RULES[e]||e}var __output="";function __append(e){void 0!==e&&null!==e&&(__output+=e)}with(locals||{})__append('<div class="production-question">\n  '),__append(t("isa:cancel:message",{requestType:requestType})),__append('\n  <div class="form-actions">\n    <button class="btn btn-lg btn-danger dialog-answer" type="button" autofocus data-answer="yes">'),__append(t("isa:cancel:yes")),__append('</button>\n    <button class="btn btn-lg btn-link cancel" type="button">'),__append(t("isa:cancel:no")),__append("</button>\n  </div>\n</div>\n");return __output}}),define("app/production/views/IsaView",["underscore","app/i18n","app/viewport","app/core/View","app/core/views/DialogView","app/data/isaPalletKinds","./IsaPalletDeliveryDialogView","app/production/templates/isa","app/production/templates/isaCancelDialog"],function(e,t,n,i,r,o,a,s,u){"use strict";return i.extend({template:s,localTopics:{"socket.disconnected":"render","isaPalletKinds.synced":"render"},events:{"click #-pickup":function(){var e=this.model.isaRequests.getFirstPickup();if(!e)return this.pickup();"new"===e.get("status")&&this.cancel(e)},"click #-deliver":function(){var e=this.model.isaRequests.getFirstDelivery();if(e)"new"===e.get("status")&&this.cancel(e);else{var t=new a({embedded:this.options.embedded,vkb:this.options.vkb});this.listenTo(t,"picked",function(e,n){t.closeDialog(),this.deliver(e,n)}),n.showDialog(t,this.t("isa:deliver:title"))}}},initialize:function(){var t=this;t.syncing=!1,t.rendered=!1;var n=t.model.isaRequests,i=e.debounce(function(){t.rendered&&t.render()},1);t.listenTo(n,"request",function(){t.syncing=!0,i()}),t.listenTo(n,"error sync",function(){t.syncing=!1,i()}),t.listenTo(n,"add remove change reset",i)},getTemplateData:function(){var e=this.syncing,t=this.socket.isConnected(),n=this.model.isLocked(),i=this.model.isaRequests.getFirstPickup(),r=this.model.isaRequests.getFirstDelivery(),o=!!i,a=!!r,s=!!i&&"accepted"===i.get("status"),u=!!r&&"accepted"===r.get("status"),c=r?r.getQty():0,l=r?r.getFullPalletKind():null;return{pickupIndicatorColor:this.serializeIndicatorColor(i),deliveryIndicatorColor:this.serializeIndicatorColor(r),pickupStatusLabel:this.serializeStatusLabel(i),pickupActive:o,pickupDisabled:!this.rendered||n||e||!t||s,deliveryStatusLabel:this.serializeStatusLabel(r),deliveryActive:a,deliveryDisabled:!this.rendered||n||e||!t||u,selectedQty:c,selectedPalletKind:l}},serializeIndicatorColor:function(e){if(!e||this.model.isLocked())return"grey";switch(e.get("status")){case"new":return"orange";case"accepted":return"green";default:return"grey"}},serializeStatusLabel:function(e){return this.t("isa:status:"+(e?e.get("status"):"idle"))},afterRender:function(){this.rendered=!0},pickup:function(){this.model.isaRequests.pickup(this.model.getSecretKey(),this.showErrorMessage.bind(this,"pickup"))},deliver:function(e,t){this.model.isaRequests.deliver(e,t,this.model.getSecretKey(),this.showErrorMessage.bind(this,"deliver"))},cancel:function(e){var t=this,i=new r({dialogClassName:"production-modal",template:u,nlsDomain:this.model.getNlsDomain(),model:{requestType:e.get("type")}});t.listenTo(i,"answered",function(n){"yes"===n&&t.model.isaRequests.get(e.id)&&t.model.isaRequests.cancel(e.id,t.model.getSecretKey(),t.showErrorMessage.bind(t,"cancel"))}),n.showDialog(i,t.t("isa:cancel:title"))},showErrorMessage:function(e,i){i&&n.msg.show({type:"error",time:5e3,text:t.has("isa",e+":"+i.message)?t("isa",e+":"+i.message):t("isa",e+":failure")})}})}),define("app/production/templates/taktTime",["underscore","jquery","app/i18n","app/time","app/user","app/core/util/forms"],function(_,$,t,time,user,forms){return function anonymous(locals,escapeFn,include,rethrow){escapeFn=escapeFn||function(e){return void 0==e?"":String(e).replace(_MATCH_HTML,encode_char)};var _ENCODE_HTML_RULES={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&#34;","'":"&#39;"},_MATCH_HTML=/[&<>'"]/g;function encode_char(e){return _ENCODE_HTML_RULES[e]||e}var __output="";function __append(e){void 0!==e&&null!==e&&(__output+=e)}with(locals||{})__append('<div>\n  <i id="'),__append(id("smile")),__append('" class="fa fa-smile-o production-taktTime-smile"></i>\n  <button id="'),__append(id("check")),__append('" class="btn btn-lg btn-block btn-default production-taktTime-btn">'),__append(t("taktTime:check:button")),__append("</button>\n</div>\n");return __output}}),define("app/production/views/TaktTimeView",["underscore","app/i18n","app/viewport","app/core/View","./SnCheckerView","app/production/templates/taktTime"],function(e,t,n,i,r,o){"use strict";return i.extend({template:o,events:{"click #-check":function(){n.showDialog(new r({model:this.model}),t("production","taktTime:check:title"))}}})}),define("app/production/templates/spigotChecker",["underscore","jquery","app/i18n","app/time","app/user","app/core/util/forms"],function(_,$,t,time,user,forms){return function anonymous(locals,escapeFn,include,rethrow){escapeFn=escapeFn||function(e){return void 0==e?"":String(e).replace(_MATCH_HTML,encode_char)};var _ENCODE_HTML_RULES={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&#34;","'":"&#39;"},_MATCH_HTML=/[&<>'"]/g;function encode_char(e){return _ENCODE_HTML_RULES[e]||e}var __output="";function __append(e){void 0!==e&&null!==e&&(__output+=e)}with(locals||{})__append('<form class="production-spigotChecker" autocomplete="off">\n  <div class="form-group">\n    <label class="control-label">'),__append(t("spigotChecker:name:label")),__append('</label>\n    <p class="form-control-static">'),__append(escapeFn(component.name)),__append('</p>\n  </div>\n  <div class="form-group">\n    <label for="'),__append(id("nc12")),__append('">'),__append(t("spigotChecker:nc12:label")),__append('</label>\n    <input id="'),__append(id("nc12")),__append('" class="form-control production-spigot-nc12 '),__append(embedded?"is-embedded":""),__append('" type="text" autocomplete="new-password" placeholder="'),__append(t("spigotChecker:nc12:placeholder")),__append('">\n  </div>\n  <div class="form-actions" style="display: flex">\n    <button id="'),__append(id("submit")),__append('" type="submit" class="btn btn-lg btn-primary">'),__append(t("spigotChecker:submit")),__append('</button>\n    <button id="'),__append(id("endWork")),__append('" type="button" class="btn btn-lg btn-warning" style="margin-left: auto">'),__append(t("spigotChecker:endWork")),__append("</button>\n  </div>\n</form>\n");return __output}}),define("app/production/views/SpigotCheckerView",["jquery","app/i18n","app/viewport","app/core/View","app/production/templates/spigotChecker"],function(e,t,n,i,r){"use strict";return i.extend({template:r,dialogClassName:"production-modal production-spigotChecker-modal",events:{submit:function(){return this.checkSpigot(!1),!1},"click #-endWork":function(){this.model.endWork(),this.closeDialog()}},remoteTopics:function(){var e={};return e["production.spigotCheck.scanned."+this.model.prodLine.id]="onSpigotScanned",e},initialize:function(){this.lastKeyPressAt=0,e(window).on("keydown."+this.idPrefix,this.onKeyDown.bind(this)).on("keypress."+this.idPrefix,this.onKeyPress.bind(this))},destroy:function(){e(window).off("."+this.idPrefix)},getTemplateData:function(){return{component:this.options.component,embedded:this.options.embedded}},afterRender:function(){this.notifySpigotCheckRequest()},checkSpigot:function(e){var i=this.$id("submit").prop("disabled",!0),r=this.$id("nc12").val(),o=r.match(/([0-9]{12})/),a=(o?o[1]:"").trim();a.length&&this.model.checkSpigot(this.options.component,a)?(n.msg.show({type:"success",time:3e3,text:t("production","spigotChecker:success")}),this.pubsub.publish("production.spigotCheck.success."+this.model.prodLine.id,{prodLine:this.model.prodLine.id,component:this.options.component,orderNo:this.model.prodShiftOrder.get("orderId"),input:r,nc12:a,source:"spigotChecker"}),this.closeDialog()):(this.$id("nc12")[0].setCustomValidity(t("production","spigotChecker:nc12:invalid")),this.timers.submit=setTimeout(function(){i.prop("disabled",!1).click()},1),e&&this.pubsub.publish("production.spigotCheck.failure."+this.model.prodLine.id,{prodLine:this.model.prodLine.id,component:this.options.component,orderNo:this.model.prodShiftOrder.get("orderId"),input:r,source:"spigotChecker"}))},notifySpigotCheckRequest:function(){clearTimeout(this.timers.notifySpigotCheckRequest),this.timers.notifySpigotCheckRequest=setTimeout(this.notifySpigotCheckRequest.bind(this),5e3),this.pubsub.publish("production.spigotCheck.requested."+this.model.prodLine.id,{prodLine:this.model.prodLine.id,component:this.options.component,orderNo:this.model.prodShiftOrder.get("orderId"),source:"spigotChecker"})},onSpigotScanned:function(e){this.$id("nc12").val(e.nc12)[0].setCustomValidity(""),this.checkSpigot(!0)},onDialogShown:function(e){this.closeDialog=e.closeDialog.bind(e),this.$id("nc12").focus()},closeDialog:function(){},onKeyDown:function(e){if(8===e.keyCode)return this.lastKeyPressAt=Date.now(),this.$id("nc12").val("")[0].setCustomValidity(""),!1},onKeyPress:function(e){if(13===e.keyCode&&this.$id("submit").click(),!(e.keyCode<32||e.keyCode>126)){var t=Date.now(),n=this.$id("nc12");if(n.length){var i=t-this.lastKeyPressAt>333?"":n.val(),r=String.fromCharCode(e.keyCode);n.val(i+r)[0].setCustomValidity("")}return this.lastKeyPressAt=t,!1}}})}),define("app/production/templates/executionTimeline",["underscore","jquery","app/i18n","app/time","app/user","app/core/util/forms"],function(_,$,t,time,user,forms){return function anonymous(locals,escapeFn,include,rethrow){escapeFn=escapeFn||function(e){return void 0==e?"":String(e).replace(_MATCH_HTML,encode_char)};var _ENCODE_HTML_RULES={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&#34;","'":"&#39;"},_MATCH_HTML=/[&<>'"]/g;function encode_char(e){return _ENCODE_HTML_RULES[e]||e}var __output="";function __append(e){void 0!==e&&null!==e&&(__output+=e)}with(locals||{})__append('<div class="production-timeline"></div>\n');return __output}}),define("app/production/templates/executionTimelineItem",["underscore","jquery","app/i18n","app/time","app/user","app/core/util/forms"],function(_,$,t,time,user,forms){return function anonymous(locals,escapeFn,include,rethrow){escapeFn=escapeFn||function(e){return void 0==e?"":String(e).replace(_MATCH_HTML,encode_char)};var _ENCODE_HTML_RULES={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&#34;","'":"&#39;"},_MATCH_HTML=/[&<>'"]/g;function encode_char(e){return _ENCODE_HTML_RULES[e]||e}var __output="";function __append(e){void 0!==e&&null!==e&&(__output+=e)}with(locals||{})__append('<div class="production-timeline-item" data-type="'),__append(type),__append('" data-id="'),__append(id),__append('" data-takt-time="'),__append(taktTime),__append('" style="width: '),__append(width),__append("%; left: "),__append(left),__append('%">\n  <div class="production-timeline-item-inner">\n    '),__append(label),__append("\n  </div>\n</div>\n");return __output}}),define("app/production/templates/executionOrderPopover",["underscore","jquery","app/i18n","app/time","app/user","app/core/util/forms"],function(_,$,t,time,user,forms){return function anonymous(locals,escapeFn,include,rethrow){escapeFn=escapeFn||function(e){return void 0==e?"":String(e).replace(_MATCH_HTML,encode_char)};var _ENCODE_HTML_RULES={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&#34;","'":"&#39;"},_MATCH_HTML=/[&<>'"]/g;function encode_char(e){return _ENCODE_HTML_RULES[e]||e}var __output="";function __append(e){void 0!==e&&null!==e&&(__output+=e)}with(locals||{})__append("<table>\n  <tbody>\n  "),["orderNo","operationNo","quantityDone","workerCount","startedAt","finishedAt"].forEach(function(e){__append("\n  <tr>\n    <th>"),__append(t("execution:order:"+e)),__append("</th>\n    <td>"),__append(escapeFn(order[e])),__append("</td>\n  </tr>\n  ")}),__append("\n  </tbody>\n</table>\n");return __output}}),define("app/production/templates/executionDowntimePopover",["underscore","jquery","app/i18n","app/time","app/user","app/core/util/forms"],function(_,$,t,time,user,forms){return function anonymous(locals,escapeFn,include,rethrow){escapeFn=escapeFn||function(e){return void 0==e?"":String(e).replace(_MATCH_HTML,encode_char)};var _ENCODE_HTML_RULES={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&#34;","'":"&#39;"},_MATCH_HTML=/[&<>'"]/g;function encode_char(e){return _ENCODE_HTML_RULES[e]||e}var __output="";function __append(e){void 0!==e&&null!==e&&(__output+=e)}with(locals||{})__append("<table>\n  <tbody>\n  "),["reason","aor","startedAt","finishedAt"].forEach(function(e){__append("\n  <tr>\n    <th>"),__append(t("execution:downtime:"+e)),__append('</th>\n    <td><span class="production-execution-popover-value">'),__append(escapeFn(downtime[e])),__append("</span></td>\n  </tr>\n  ")}),__append("\n  </tbody>\n</table>\n");return __output}}),define("app/production/views/ExecutionTimelineView",["jquery","app/i18n","app/time","app/core/View","app/core/util/getShiftStartInfo","app/data/downtimeReasons","app/data/aors","app/production/templates/executionTimeline","app/production/templates/executionTimelineItem","app/production/templates/executionOrderPopover","app/production/templates/executionDowntimePopover"],function(e,t,n,i,r,o,a,s,u,c,l){"use strict";return i.extend({template:s,events:{'click .production-timeline-item[data-type="order"]':function(e){if(""===document.getSelection().toString()){var t=this.model.get(this.orderProp)[e.currentTarget.dataset.id];this.model.trigger("newOrderRequested",t)}}},initialize:function(){this.orderProp=this.options.type+"Orders",this.downtimeProp=this.options.type+"Downtimes",this.listenTo(this.model,"change:"+this.orderProp,this.renderOrders),this.listenTo(this.model,"change:"+this.downtimeProp,this.renderDowntimes),"done"===this.options.type&&(this.listenTo(this.model,"change:lastOrder",this.updateLastItem.bind(this,"order")),this.listenTo(this.model,"change:lastDowntime",this.updateLastItem.bind(this,"downtime")))},afterRender:function(){var e=this;e.$el.popover({container:"body",selector:".production-timeline-item",trigger:"hover",placement:"auto top",html:!0,className:"production-execution-popover",content:function(){return"order"===this.dataset.type?e.renderOrderPopover(this.dataset.id):"downtime"===this.dataset.type?e.renderDowntimePopover(this.dataset.id):void 0}}),e.renderOrders(),e.renderDowntimes(),e.scheduleExtendLastItems()},renderOrders:function(){this.renderItems("order")},renderDowntimes:function(){this.renderItems("downtime")},renderItems:function(e){var t=this,n=t.model.get(t[e+"Prop"])||[],i="";if(n.length){var r=t.prodShift.get("date").getTime(),o=r+288e5,a=Date.now();n.forEach(function(n,s){n.startedAt<r||n.startedAt>=o||(i+=t.renderItem(e,n,s,r,a))})}t.$el.find('.production-timeline-item[data-type="'+e+'"]').remove(),t.$el.append(i),t.scheduleExtendLastItems()},renderItem:function(e,n,i,o,a){o||(o=r(n.startedAt).startTime),a||(a=Date.now());var s=n.startedAt,c=((n.finishedAt||a)-s)/288e5*100,l=(s-o)/288e5*100;return u({type:e,id:i,label:t("production","execution:"+e+":label",n),taktTime:n.taktTime||"na",width:c,left:l})},updateLastItem:function(e){var t=this.model.get(this[e+"Prop"])||[],n=t.length-1;if(-1!==n){var i=t[n];this.$('.production-timeline-item[data-type="'+e+'"][data-id="'+n+'"]').replaceWith(this.renderItem(e,i,n))}},scheduleExtendLastItems:function(){"done"===this.options.type&&(clearTimeout(this.timers.extendLastItems),this.timers.extendLastItems=setTimeout(this.extendLastItems.bind(this),6e3))},extendLastItems:function(){this.extendLastItem("order"),this.extendLastItem("downtime"),this.scheduleExtendLastItems()},extendLastItem:function(e){var t=this.model.get(this[e+"Prop"])||[],n=t.length-1,i=t[n];if(i&&!i.finishedAt){var r=this.$('.production-timeline-item[data-type="'+e+'"][data-id="'+n+'"]');if(r.length){var o=(Date.now()-i.startedAt)/288e5*100;r[0].style.width=o+"%"}}},renderOrderPopover:function(e){var t=this.model.get(this.orderProp)[e];return t?this.renderPartialHtml(c,{order:{orderNo:t.orderId,operationNo:t.operationNo,quantityDone:(t.quantityDone||0).toLocaleString(),workerCount:(t.workerCount||0).toLocaleString(),startedAt:n.format(t.startedAt,"HH:mm:ss"),finishedAt:t.finishedAt?n.format(t.finishedAt,"HH:mm:ss"):"-"}}):void 0},renderDowntimePopover:function(e){var t=this.model.get(this.downtimeProp)[e],i=o.get(t.reason),r=a.get(t.aor);return t?this.renderPartialHtml(l,{downtime:{reason:i?i.getLabel():t.reason,aor:r?r.getLabel():r.reason,startedAt:n.format(t.startedAt,"HH:mm:ss"),finishedAt:t.finishedAt?n.format(t.finishedAt,"HH:mm:ss"):"-"}}):void 0}})}),define("app/production/templates/execution",["underscore","jquery","app/i18n","app/time","app/user","app/core/util/forms"],function(_,$,t,time,user,forms){return function anonymous(locals,escapeFn,include,rethrow){escapeFn=escapeFn||function(e){return void 0==e?"":String(e).replace(_MATCH_HTML,encode_char)};var _ENCODE_HTML_RULES={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&#34;","'":"&#39;"},_MATCH_HTML=/[&<>'"]/g;function encode_char(e){return _ENCODE_HTML_RULES[e]||e}var __output="";function __append(e){void 0!==e&&null!==e&&(__output+=e)}with(locals||{})__append('<div class="production-execution">\n  <div class="production-execution-labels">\n    <div class="production-execution-label">'),__append(t("execution:todo")),__append('</div>\n    <div class="production-execution-label">'),__append(t("execution:done")),__append('</div>\n  </div>\n  <div class="production-execution-timelines">\n    <div id="'),__append(id("todo")),__append('" class="production-execution-todo"></div>\n    <div id="'),__append(id("done")),__append('" class="production-execution-done"></div>\n    <div id="'),__append(id("legend")),__append('" class="production-execution-legend">\n      <div class="production-execution-legend-h">1</div>\n      <div class="production-execution-legend-h">2</div>\n      <div class="production-execution-legend-h">3</div>\n      <div class="production-execution-legend-h">4</div>\n      <div class="production-execution-legend-h">5</div>\n      <div class="production-execution-legend-h">6</div>\n      <div class="production-execution-legend-h">7</div>\n      <div class="production-execution-legend-h">8</div>\n      <div id="'),__append(id("time")),__append('" class="production-execution-legend-time hidden" style="left: 50%">00:00:00<br></div>\n    </div>\n  </div>\n</div>\n');return __output}}),define("app/production/views/ExecutionView",["app/core/View","./ExecutionTimelineView","app/production/templates/execution"],function(e,t,n){"use strict";return e.extend({template:n,initialize:function(){this.listenTo(this.model.execution,"newOrderRequested",function(e){this.model.trigger("newOrderRequested",e)}),this.todoView=new t({type:"todo",model:this.model.execution,prodShift:this.model}),this.doneView=new t({type:"done",model:this.model.execution,prodShift:this.model}),this.setView("#-todo",this.todoView),this.setView("#-done",this.doneView)}})}),function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define("autolinker",t):(e=e||self).Autolinker=t()}(this,function(){"use strict";function e(e,t){if(Array.prototype.indexOf)return e.indexOf(t);for(var n=0,i=e.length;n<i;n++)if(e[n]===t)return n;return-1}function t(e,t){for(var n=e.length-1;n>=0;n--)!0===t(e[n])&&e.splice(n,1)}var n=function(){function t(e){void 0===e&&(e={}),this.tagName="",this.attrs={},this.innerHTML="",this.whitespaceRegex=/\s+/,this.tagName=e.tagName||"",this.attrs=e.attrs||{},this.innerHTML=e.innerHtml||e.innerHTML||""}return t.prototype.setTagName=function(e){return this.tagName=e,this},t.prototype.getTagName=function(){return this.tagName||""},t.prototype.setAttr=function(e,t){return this.getAttrs()[e]=t,this},t.prototype.getAttr=function(e){return this.getAttrs()[e]},t.prototype.setAttrs=function(e){return Object.assign(this.getAttrs(),e),this},t.prototype.getAttrs=function(){return this.attrs||(this.attrs={})},t.prototype.setClass=function(e){return this.setAttr("class",e)},t.prototype.addClass=function(t){for(var n,i=this.getClass(),r=this.whitespaceRegex,o=i?i.split(r):[],a=t.split(r);n=a.shift();)-1===e(o,n)&&o.push(n);return this.getAttrs().class=o.join(" "),this},t.prototype.removeClass=function(t){for(var n,i=this.getClass(),r=this.whitespaceRegex,o=i?i.split(r):[],a=t.split(r);o.length&&(n=a.shift());){var s=e(o,n);-1!==s&&o.splice(s,1)}return this.getAttrs().class=o.join(" "),this},t.prototype.getClass=function(){return this.getAttrs().class||""},t.prototype.hasClass=function(e){return-1!==(" "+this.getClass()+" ").indexOf(" "+e+" ")},t.prototype.setInnerHTML=function(e){return this.innerHTML=e,this},t.prototype.setInnerHtml=function(e){return this.setInnerHTML(e)},t.prototype.getInnerHTML=function(){return this.innerHTML||""},t.prototype.getInnerHtml=function(){return this.getInnerHTML()},t.prototype.toAnchorString=function(){var e=this.getTagName(),t=this.buildAttrsStr();return["<",e,t=t?" "+t:"",">",this.getInnerHtml(),"</",e,">"].join("")},t.prototype.buildAttrsStr=function(){if(!this.attrs)return"";var e=this.getAttrs(),t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(n+'="'+e[n]+'"');return t.join(" ")},t}();var i,r,o,a,s,u,c=function(){function e(e){void 0===e&&(e={}),this.newWindow=!1,this.truncate={},this.className="",this.newWindow=e.newWindow||!1,this.truncate=e.truncate||{},this.className=e.className||""}return e.prototype.build=function(e){return new n({tagName:"a",attrs:this.createAttrs(e),innerHtml:this.processAnchorText(e.getAnchorText())})},e.prototype.createAttrs=function(e){var t={href:e.getAnchorHref()},n=this.createCssClass(e);return n&&(t.class=n),this.newWindow&&(t.target="_blank",t.rel="noopener noreferrer"),this.truncate&&this.truncate.length&&this.truncate.length<e.getAnchorText().length&&(t.title=e.getAnchorHref()),t},e.prototype.createCssClass=function(e){var t=this.className;if(t){for(var n=[t],i=e.getCssClassSuffixes(),r=0,o=i.length;r<o;r++)n.push(t+"-"+i[r]);return n.join(" ")}return""},e.prototype.processAnchorText=function(e){return e=this.doTruncate(e)},e.prototype.doTruncate=function(e){var t=this.truncate;if(!t||!t.length)return e;var n=t.length,i=t.location;return"smart"===i?function(e,t,n){var i,r;null==n?(n="&hellip;",r=3,i=8):(r=n.length,i=n.length);var o=function(e){var t="";return e.scheme&&e.host&&(t+=e.scheme+"://"),e.host&&(t+=e.host),e.path&&(t+="/"+e.path),e.query&&(t+="?"+e.query),e.fragment&&(t+="#"+e.fragment),t},a=function(e,t){var i=t/2,r=Math.ceil(i),o=-1*Math.floor(i),a="";return o<0&&(a=e.substr(o)),e.substr(0,r)+n+a};if(e.length<=t)return e;var s=t-r,u=function(e){var t={},n=e,i=n.match(/^([a-z]+):\/\//i);return i&&(t.scheme=i[1],n=n.substr(i[0].length)),(i=n.match(/^(.*?)(?=(\?|#|\/|$))/i))&&(t.host=i[1],n=n.substr(i[0].length)),(i=n.match(/^\/(.*?)(?=(\?|#|$))/i))&&(t.path=i[1],n=n.substr(i[0].length)),(i=n.match(/^\?(.*?)(?=(#|$))/i))&&(t.query=i[1],n=n.substr(i[0].length)),(i=n.match(/^#(.*?)$/i))&&(t.fragment=i[1]),t}(e);if(u.query){var c=u.query.match(/^(.*?)(?=(\?|\#))(.*?)$/i);c&&(u.query=u.query.substr(0,c[1].length),e=o(u))}if(e.length<=t)return e;if(u.host&&(u.host=u.host.replace(/^www\./,""),e=o(u)),e.length<=t)return e;var l="";if(u.host&&(l+=u.host),l.length>=s)return u.host.length==t?(u.host.substr(0,t-r)+n).substr(0,s+i):a(l,s).substr(0,s+i);var d="";if(u.path&&(d+="/"+u.path),u.query&&(d+="?"+u.query),d){if((l+d).length>=s)return(l+d).length==t?(l+d).substr(0,t):(l+a(d,s-l.length)).substr(0,s+i);l+=d}if(u.fragment){var p="#"+u.fragment;if((l+p).length>=s)return(l+p).length==t?(l+p).substr(0,t):(l+a(p,s-l.length)).substr(0,s+i);l+=p}if(u.scheme&&u.host){var f=u.scheme+"://";if((l+f).length<s)return(f+l).substr(0,t)}if(l.length<=t)return l;var h="";return s>0&&(h=l.substr(-1*Math.floor(s/2))),(l.substr(0,Math.ceil(s/2))+n+h).substr(0,s+i)}(e,n):"middle"===i?function(e,t,n){if(e.length<=t)return e;var i,r;null==n?(n="&hellip;",i=8,r=3):(i=n.length,r=n.length);var o=t-r,a="";return o>0&&(a=e.substr(-1*Math.floor(o/2))),(e.substr(0,Math.ceil(o/2))+n+a).substr(0,o+i)}(e,n):function(e,t,n){return function(e,t,n){var i;return e.length>t&&(null==n?(n="&hellip;",i=3):i=n.length,e=e.substring(0,t-i)+n),e}(e,t,n)}(e,n)},e}(),l=function(){function e(e){this.offset=0,this.text="",this.offset=e.offset,this.text=e.text}return e.prototype.getOffset=function(){return this.offset},e.prototype.getText=function(){return this.text},e}(),d=(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),p=function(e){function t(t){var n=e.call(this,t)||this;return n.comment="",n.comment=t.comment,n}return d(t,e),t.prototype.getType=function(){return"comment"},t.prototype.getComment=function(){return this.comment},t}(l),f=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),h=function(e){function t(t){var n=e.call(this,t)||this;return n.tagName="",n.closing=!1,n.tagName=t.tagName,n.closing=t.closing,n}return f(t,e),t.prototype.getType=function(){return"element"},t.prototype.getTagName=function(){return this.tagName},t.prototype.isClosing=function(){return this.closing},t}(l),m=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),g=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return m(t,e),t.prototype.getType=function(){return"entity"},t}(l),v=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),y=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return v(t,e),t.prototype.getType=function(){return"text"},t}(l),_=(r=/[0-9a-zA-Z][0-9a-zA-Z:]*/,o=/[^\s"'>\/=\x00-\x1F\x7F]+/,s="(?:\\s*?=\\s*?"+(a=/(?:"[^"]*?"|'[^']*?'|[^'"=<>`\s]+)/).source+")?",u=function(e){return"(?=("+o.source+"))\\"+e+s},new RegExp(["(?:","<(!DOCTYPE)","(?:","\\s+","(?:",u(2),"|",a.source+")",")*",">",")","|","(?:","<(/)?","(?:",/!--([\s\S]+?)--/.source,"|","(?:","("+r.source+")","\\s*/?",")","|","(?:","("+r.source+")","\\s+","(?:","(?:\\s+|\\b)",u(7),")*","\\s*/?",")",")",">",")"].join(""),"gi")),b=/(&nbsp;|&#160;|&lt;|&#60;|&gt;|&#62;|&quot;|&#34;|&#39;)/gi,w=function(){function e(){}return e.prototype.parse=function(e){for(var t,n,i=0,r=[];null!==(t=_.exec(e));){var o=t[0],a=t[4],s=t[1]||t[5]||t[6],u=!!t[3],c=t.index,l=e.substring(i,c);l&&(n=this.parseTextAndEntityNodes(i,l),r.push.apply(r,n)),a?r.push(this.createCommentNode(c,o,a)):r.push(this.createElementNode(c,o,s,u)),i=c+o.length}if(i<e.length){var d=e.substring(i);d&&(n=this.parseTextAndEntityNodes(i,d)).forEach(function(e){return r.push(e)})}return r},e.prototype.parseTextAndEntityNodes=function(e,t){for(var n=[],i=function(e,t){if(!t.global)throw new Error("`splitRegex` must have the 'g' flag set");for(var n,i=[],r=0;n=t.exec(e);)i.push(e.substring(r,n.index)),i.push(n[0]),r=n.index+n[0].length;return i.push(e.substring(r)),i}(t,b),r=0,o=i.length;r<o;r+=2){var a=i[r],s=i[r+1];a&&(n.push(this.createTextNode(e,a)),e+=a.length),s&&(n.push(this.createEntityNode(e,s)),e+=s.length)}return n},e.prototype.createCommentNode=function(e,t,n){return new p({offset:e,text:t,comment:n.trim()})},e.prototype.createElementNode=function(e,t,n,i){return new h({offset:e,text:t,tagName:n.toLowerCase(),closing:i})},e.prototype.createEntityNode=function(e,t){return new g({offset:e,text:t})},e.prototype.createTextNode=function(e,t){return new y({offset:e,text:t})},e}(),A=function(){function e(e){this.__jsduckDummyDocProp=null,this.matchedText="",this.offset=0,this.tagBuilder=e.tagBuilder,this.matchedText=e.matchedText,this.offset=e.offset}return e.prototype.getMatchedText=function(){return this.matchedText},e.prototype.setOffset=function(e){this.offset=e},e.prototype.getOffset=function(){return this.offset},e.prototype.getCssClassSuffixes=function(){return[this.getType()]},e.prototype.buildTag=function(){return this.tagBuilder.build(this)},e}(),k=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),E=function(e){function t(t){var n=e.call(this,t)||this;return n.email="",n.email=t.email,n}return k(t,e),t.prototype.getType=function(){return"email"},t.prototype.getEmail=function(){return this.email},t.prototype.getAnchorHref=function(){return"mailto:"+this.email},t.prototype.getAnchorText=function(){return this.email},t}(A),T=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),S=function(e){function t(t){var n=e.call(this,t)||this;return n.serviceName="",n.hashtag="",n.serviceName=t.serviceName,n.hashtag=t.hashtag,n}return T(t,e),t.prototype.getType=function(){return"hashtag"},t.prototype.getServiceName=function(){return this.serviceName},t.prototype.getHashtag=function(){return this.hashtag},t.prototype.getAnchorHref=function(){var e=this.serviceName,t=this.hashtag;switch(e){case"twitter":return"https://twitter.com/hashtag/"+t;case"facebook":return"https://www.facebook.com/hashtag/"+t;case"instagram":return"https://instagram.com/explore/tags/"+t;default:throw new Error("Unknown service name to point hashtag to: "+e)}},t.prototype.getAnchorText=function(){return"#"+this.hashtag},t}(A),C=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),R=function(e){function t(t){var n=e.call(this,t)||this;return n.serviceName="twitter",n.mention="",n.mention=t.mention,n.serviceName=t.serviceName,n}return C(t,e),t.prototype.getType=function(){return"mention"},t.prototype.getMention=function(){return this.mention},t.prototype.getServiceName=function(){return this.serviceName},t.prototype.getAnchorHref=function(){switch(this.serviceName){case"twitter":return"https://twitter.com/"+this.mention;case"instagram":return"https://instagram.com/"+this.mention;case"soundcloud":return"https://soundcloud.com/"+this.mention;default:throw new Error("Unknown service name to point mention to: "+this.serviceName)}},t.prototype.getAnchorText=function(){return"@"+this.mention},t.prototype.getCssClassSuffixes=function(){var t=e.prototype.getCssClassSuffixes.call(this),n=this.getServiceName();return n&&t.push(n),t},t}(A),P=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),N=function(e){function t(t){var n=e.call(this,t)||this;return n.number="",n.plusSign=!1,n.number=t.number,n.plusSign=t.plusSign,n}return P(t,e),t.prototype.getType=function(){return"phone"},t.prototype.getPhoneNumber=function(){return this.number},t.prototype.getNumber=function(){return this.getPhoneNumber()},t.prototype.getAnchorHref=function(){return"tel:"+(this.plusSign?"+":"")+this.number},t.prototype.getAnchorText=function(){return this.matchedText},t}(A),O=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),D=function(e){function t(t){var n=e.call(this,t)||this;return n.url="",n.urlMatchType="scheme",n.protocolUrlMatch=!1,n.protocolRelativeMatch=!1,n.stripPrefix={scheme:!0,www:!0},n.stripTrailingSlash=!0,n.decodePercentEncoding=!0,n.schemePrefixRegex=/^(https?:\/\/)?/i,n.wwwPrefixRegex=/^(https?:\/\/)?(www\.)?/i,n.protocolRelativeRegex=/^\/\//,n.protocolPrepended=!1,n.urlMatchType=t.urlMatchType,n.url=t.url,n.protocolUrlMatch=t.protocolUrlMatch,n.protocolRelativeMatch=t.protocolRelativeMatch,n.stripPrefix=t.stripPrefix,n.stripTrailingSlash=t.stripTrailingSlash,n.decodePercentEncoding=t.decodePercentEncoding,n}return O(t,e),t.prototype.getType=function(){return"url"},t.prototype.getUrlMatchType=function(){return this.urlMatchType},t.prototype.getUrl=function(){var e=this.url;return this.protocolRelativeMatch||this.protocolUrlMatch||this.protocolPrepended||(e=this.url="http://"+e,this.protocolPrepended=!0),e},t.prototype.getAnchorHref=function(){return this.getUrl().replace(/&amp;/g,"&")},t.prototype.getAnchorText=function(){var e=this.getMatchedText();return this.protocolRelativeMatch&&(e=this.stripProtocolRelativePrefix(e)),this.stripPrefix.scheme&&(e=this.stripSchemePrefix(e)),this.stripPrefix.www&&(e=this.stripWwwPrefix(e)),this.stripTrailingSlash&&(e=this.removeTrailingSlash(e)),this.decodePercentEncoding&&(e=this.removePercentEncoding(e)),e},t.prototype.stripSchemePrefix=function(e){return e.replace(this.schemePrefixRegex,"")},t.prototype.stripWwwPrefix=function(e){return e.replace(this.wwwPrefixRegex,"$1")},t.prototype.stripProtocolRelativePrefix=function(e){return e.replace(this.protocolRelativeRegex,"")},t.prototype.removeTrailingSlash=function(e){return"/"===e.charAt(e.length-1)&&(e=e.slice(0,-1)),e},t.prototype.removePercentEncoding=function(e){var t=e.replace(/%22/gi,"&quot;").replace(/%26/gi,"&amp;").replace(/%27/gi,"&#39;").replace(/%3C/gi,"&lt;").replace(/%3E/gi,"&gt;");try{return decodeURIComponent(t)}catch(e){return t}},t}(A),I=function(){return function(e){this.__jsduckDummyDocProp=null,this.tagBuilder=e.tagBuilder}}(),z=/A-Za-z\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0561-\u0587\u05D0-\u05EA\u05F0-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u08A0-\u08B4\u08B6-\u08BD\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16F1-\u16F8\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1877\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C88\u1CE9-\u1CEC\u1CEE-\u1CF1\u1CF5\u1CF6\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2183\u2184\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005\u3006\u3031-\u3035\u303B\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312D\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FD5\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6E5\uA717-\uA71F\uA722-\uA788\uA78B-\uA7AE\uA7B0-\uA7B7\uA7F7-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB65\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC/.source,x=z+/\u0300-\u036F\u0483-\u0489\u0591-\u05BD\u05BF\u05C1\u05C2\u05C4\u05C5\u05C7\u0610-\u061A\u064B-\u065F\u0670\u06D6-\u06DC\u06DF-\u06E4\u06E7\u06E8\u06EA-\u06ED\u0711\u0730-\u074A\u07A6-\u07B0\u07EB-\u07F3\u0816-\u0819\u081B-\u0823\u0825-\u0827\u0829-\u082D\u0859-\u085B\u08D4-\u08E1\u08E3-\u0903\u093A-\u093C\u093E-\u094F\u0951-\u0957\u0962\u0963\u0981-\u0983\u09BC\u09BE-\u09C4\u09C7\u09C8\u09CB-\u09CD\u09D7\u09E2\u09E3\u0A01-\u0A03\u0A3C\u0A3E-\u0A42\u0A47\u0A48\u0A4B-\u0A4D\u0A51\u0A70\u0A71\u0A75\u0A81-\u0A83\u0ABC\u0ABE-\u0AC5\u0AC7-\u0AC9\u0ACB-\u0ACD\u0AE2\u0AE3\u0B01-\u0B03\u0B3C\u0B3E-\u0B44\u0B47\u0B48\u0B4B-\u0B4D\u0B56\u0B57\u0B62\u0B63\u0B82\u0BBE-\u0BC2\u0BC6-\u0BC8\u0BCA-\u0BCD\u0BD7\u0C00-\u0C03\u0C3E-\u0C44\u0C46-\u0C48\u0C4A-\u0C4D\u0C55\u0C56\u0C62\u0C63\u0C81-\u0C83\u0CBC\u0CBE-\u0CC4\u0CC6-\u0CC8\u0CCA-\u0CCD\u0CD5\u0CD6\u0CE2\u0CE3\u0D01-\u0D03\u0D3E-\u0D44\u0D46-\u0D48\u0D4A-\u0D4D\u0D57\u0D62\u0D63\u0D82\u0D83\u0DCA\u0DCF-\u0DD4\u0DD6\u0DD8-\u0DDF\u0DF2\u0DF3\u0E31\u0E34-\u0E3A\u0E47-\u0E4E\u0EB1\u0EB4-\u0EB9\u0EBB\u0EBC\u0EC8-\u0ECD\u0F18\u0F19\u0F35\u0F37\u0F39\u0F3E\u0F3F\u0F71-\u0F84\u0F86\u0F87\u0F8D-\u0F97\u0F99-\u0FBC\u0FC6\u102B-\u103E\u1056-\u1059\u105E-\u1060\u1062-\u1064\u1067-\u106D\u1071-\u1074\u1082-\u108D\u108F\u109A-\u109D\u135D-\u135F\u1712-\u1714\u1732-\u1734\u1752\u1753\u1772\u1773\u17B4-\u17D3\u17DD\u180B-\u180D\u1885\u1886\u18A9\u1920-\u192B\u1930-\u193B\u1A17-\u1A1B\u1A55-\u1A5E\u1A60-\u1A7C\u1A7F\u1AB0-\u1ABE\u1B00-\u1B04\u1B34-\u1B44\u1B6B-\u1B73\u1B80-\u1B82\u1BA1-\u1BAD\u1BE6-\u1BF3\u1C24-\u1C37\u1CD0-\u1CD2\u1CD4-\u1CE8\u1CED\u1CF2-\u1CF4\u1CF8\u1CF9\u1DC0-\u1DF5\u1DFB-\u1DFF\u20D0-\u20F0\u2CEF-\u2CF1\u2D7F\u2DE0-\u2DFF\u302A-\u302F\u3099\u309A\uA66F-\uA672\uA674-\uA67D\uA69E\uA69F\uA6F0\uA6F1\uA802\uA806\uA80B\uA823-\uA827\uA880\uA881\uA8B4-\uA8C5\uA8E0-\uA8F1\uA926-\uA92D\uA947-\uA953\uA980-\uA983\uA9B3-\uA9C0\uA9E5\uAA29-\uAA36\uAA43\uAA4C\uAA4D\uAA7B-\uAA7D\uAAB0\uAAB2-\uAAB4\uAAB7\uAAB8\uAABE\uAABF\uAAC1\uAAEB-\uAAEF\uAAF5\uAAF6\uABE3-\uABEA\uABEC\uABED\uFB1E\uFE00-\uFE0F\uFE20-\uFE2F/.source,L=/0-9\u0660-\u0669\u06F0-\u06F9\u07C0-\u07C9\u0966-\u096F\u09E6-\u09EF\u0A66-\u0A6F\u0AE6-\u0AEF\u0B66-\u0B6F\u0BE6-\u0BEF\u0C66-\u0C6F\u0CE6-\u0CEF\u0D66-\u0D6F\u0DE6-\u0DEF\u0E50-\u0E59\u0ED0-\u0ED9\u0F20-\u0F29\u1040-\u1049\u1090-\u1099\u17E0-\u17E9\u1810-\u1819\u1946-\u194F\u19D0-\u19D9\u1A80-\u1A89\u1A90-\u1A99\u1B50-\u1B59\u1BB0-\u1BB9\u1C40-\u1C49\u1C50-\u1C59\uA620-\uA629\uA8D0-\uA8D9\uA900-\uA909\uA9D0-\uA9D9\uA9F0-\uA9F9\uAA50-\uAA59\uABF0-\uABF9\uFF10-\uFF19/.source,M=x+L,F=x+L,V="(?:["+L+"]{1,3}\\.){3}["+L+"]{1,3}",j="["+F+"](?:["+F+"\\-]{0,61}["+F+"])?",B=function(e){return"(?=("+j+"))\\"+e},q=function(e){return"(?:"+B(e)+"(?:\\."+B(e+1)+"){0,126}|"+V+")"},U=/(?:xn--vermgensberatung-pwb|xn--vermgensberater-ctb|xn--clchc0ea0b2g2a9gcd|xn--w4r85el8fhu5dnra|northwesternmutual|travelersinsurance|vermögensberatung|xn--3oq18vl8pn36a|xn--5su34j936bgsg|xn--bck1b9a5dre4c|xn--mgbai9azgqp6j|xn--mgberp4a5d4ar|xn--xkc2dl3a5ee0h|vermögensberater|xn--fzys8d69uvgm|xn--mgba7c0bbn0a|xn--xkc2al3hye2a|americanexpress|kerryproperties|sandvikcoromant|xn--i1b6b1a6a2e|xn--kcrx77d1x4a|xn--lgbbat1ad8j|xn--mgba3a4f16a|xn--mgbaakc7dvf|xn--mgbc0a9azcg|xn--nqv7fs00ema|afamilycompany|americanfamily|bananarepublic|cancerresearch|cookingchannel|kerrylogistics|weatherchannel|xn--54b7fta0cc|xn--6qq986b3xl|xn--80aqecdr1a|xn--b4w605ferd|xn--fiq228c5hs|xn--h2breg3eve|xn--jlq61u9w7b|xn--mgba3a3ejt|xn--mgbaam7a8h|xn--mgbayh7gpa|xn--mgbb9fbpob|xn--mgbbh1a71e|xn--mgbca7dzdo|xn--mgbi4ecexp|xn--mgbx4cd0ab|xn--rvc1e0am3e|international|lifeinsurance|spreadbetting|travelchannel|wolterskluwer|xn--eckvdtc9d|xn--fpcrj9c3d|xn--fzc2c9e2c|xn--h2brj9c8c|xn--tiq49xqyj|xn--yfro4i67o|xn--ygbi2ammx|construction|lplfinancial|scholarships|versicherung|xn--3e0b707e|xn--45br5cyl|xn--80adxhks|xn--80asehdb|xn--8y0a063a|xn--gckr3f0f|xn--mgb9awbf|xn--mgbab2bd|xn--mgbgu82a|xn--mgbpl2fh|xn--mgbt3dhd|xn--mk1bu44c|xn--ngbc5azd|xn--ngbe9e0a|xn--ogbpf8fl|xn--qcka1pmc|accountants|barclaycard|blackfriday|blockbuster|bridgestone|calvinklein|contractors|creditunion|engineering|enterprises|foodnetwork|investments|kerryhotels|lamborghini|motorcycles|olayangroup|photography|playstation|productions|progressive|redumbrella|rightathome|williamhill|xn--11b4c3d|xn--1ck2e1b|xn--1qqw23a|xn--2scrj9c|xn--3bst00m|xn--3ds443g|xn--3hcrj9c|xn--42c2d9a|xn--45brj9c|xn--55qw42g|xn--6frz82g|xn--80ao21a|xn--9krt00a|xn--cck2b3b|xn--czr694b|xn--d1acj3b|xn--efvy88h|xn--estv75g|xn--fct429k|xn--fjq720a|xn--flw351e|xn--g2xx48c|xn--gecrj9c|xn--gk3at1e|xn--h2brj9c|xn--hxt814e|xn--imr513n|xn--j6w193g|xn--jvr189m|xn--kprw13d|xn--kpry57d|xn--kpu716f|xn--mgbbh1a|xn--mgbtx2b|xn--mix891f|xn--nyqy26a|xn--otu796d|xn--pbt977c|xn--pgbs0dh|xn--q9jyb4c|xn--rhqv96g|xn--rovu88b|xn--s9brj9c|xn--ses554g|xn--t60b56a|xn--vuq861b|xn--w4rs40l|xn--xhq521b|xn--zfr164b|சிங்கப்பூர்|accountant|apartments|associates|basketball|bnpparibas|boehringer|capitalone|consulting|creditcard|cuisinella|eurovision|extraspace|foundation|healthcare|immobilien|industries|management|mitsubishi|nationwide|newholland|nextdirect|onyourside|properties|protection|prudential|realestate|republican|restaurant|schaeffler|swiftcover|tatamotors|technology|telefonica|university|vistaprint|vlaanderen|volkswagen|xn--30rr7y|xn--3pxu8k|xn--45q11c|xn--4gbrim|xn--55qx5d|xn--5tzm5g|xn--80aswg|xn--90a3ac|xn--9dbq2a|xn--9et52u|xn--c2br7g|xn--cg4bki|xn--czrs0t|xn--czru2d|xn--fiq64b|xn--fiqs8s|xn--fiqz9s|xn--io0a7i|xn--kput3i|xn--mxtq1m|xn--o3cw4h|xn--pssy2u|xn--unup4y|xn--wgbh1c|xn--wgbl6a|xn--y9a3aq|accenture|alfaromeo|allfinanz|amsterdam|analytics|aquarelle|barcelona|bloomberg|christmas|community|directory|education|equipment|fairwinds|financial|firestone|fresenius|frontdoor|fujixerox|furniture|goldpoint|hisamitsu|homedepot|homegoods|homesense|honeywell|institute|insurance|kuokgroup|ladbrokes|lancaster|landrover|lifestyle|marketing|marshalls|melbourne|microsoft|panasonic|passagens|pramerica|richardli|scjohnson|shangrila|solutions|statebank|statefarm|stockholm|travelers|vacations|xn--90ais|xn--c1avg|xn--d1alf|xn--e1a4c|xn--fhbei|xn--j1aef|xn--j1amh|xn--l1acc|xn--ngbrx|xn--nqv7f|xn--p1acf|xn--tckwe|xn--vhquv|yodobashi|abudhabi|airforce|allstate|attorney|barclays|barefoot|bargains|baseball|boutique|bradesco|broadway|brussels|budapest|builders|business|capetown|catering|catholic|chrysler|cipriani|cityeats|cleaning|clinique|clothing|commbank|computer|delivery|deloitte|democrat|diamonds|discount|discover|download|engineer|ericsson|esurance|etisalat|everbank|exchange|feedback|fidelity|firmdale|football|frontier|goodyear|grainger|graphics|guardian|hdfcbank|helsinki|holdings|hospital|infiniti|ipiranga|istanbul|jpmorgan|lighting|lundbeck|marriott|maserati|mckinsey|memorial|merckmsd|mortgage|movistar|observer|partners|pharmacy|pictures|plumbing|property|redstone|reliance|saarland|samsclub|security|services|shopping|showtime|softbank|software|stcgroup|supplies|symantec|training|uconnect|vanguard|ventures|verisign|woodside|xn--90ae|xn--node|xn--p1ai|xn--qxam|yokohama|السعودية|abogado|academy|agakhan|alibaba|android|athleta|auction|audible|auspost|avianca|banamex|bauhaus|bentley|bestbuy|booking|brother|bugatti|capital|caravan|careers|cartier|channel|charity|chintai|citadel|clubmed|college|cologne|comcast|company|compare|contact|cooking|corsica|country|coupons|courses|cricket|cruises|dentist|digital|domains|exposed|express|farmers|fashion|ferrari|ferrero|finance|fishing|fitness|flights|florist|flowers|forsale|frogans|fujitsu|gallery|genting|godaddy|grocery|guitars|hamburg|hangout|hitachi|holiday|hosting|hoteles|hotmail|hyundai|iselect|ismaili|jewelry|juniper|kitchen|komatsu|lacaixa|lancome|lanxess|lasalle|latrobe|leclerc|liaison|limited|lincoln|markets|metlife|monster|netbank|netflix|network|neustar|okinawa|oldnavy|organic|origins|philips|pioneer|politie|realtor|recipes|rentals|reviews|rexroth|samsung|sandvik|schmidt|schwarz|science|shiksha|shriram|singles|staples|starhub|storage|support|surgery|systems|temasek|theater|theatre|tickets|tiffany|toshiba|trading|walmart|wanggou|watches|weather|website|wedding|whoswho|windows|winners|xfinity|yamaxun|youtube|zuerich|католик|اتصالات|الجزائر|العليان|پاکستان|كاثوليك|موبايلي|இந்தியா|abarth|abbott|abbvie|active|africa|agency|airbus|airtel|alipay|alsace|alstom|anquan|aramco|author|bayern|beauty|berlin|bharti|blanco|bostik|boston|broker|camera|career|caseih|casino|center|chanel|chrome|church|circle|claims|clinic|coffee|comsec|condos|coupon|credit|cruise|dating|datsun|dealer|degree|dental|design|direct|doctor|dunlop|dupont|durban|emerck|energy|estate|events|expert|family|flickr|futbol|gallup|garden|george|giving|global|google|gratis|health|hermes|hiphop|hockey|hotels|hughes|imamat|insure|intuit|jaguar|joburg|juegos|kaufen|kinder|kindle|kosher|lancia|latino|lawyer|lefrak|living|locker|london|luxury|madrid|maison|makeup|market|mattel|mobile|mobily|monash|mormon|moscow|museum|mutual|nagoya|natura|nissan|nissay|norton|nowruz|office|olayan|online|oracle|orange|otsuka|pfizer|photos|physio|piaget|pictet|quebec|racing|realty|reisen|repair|report|review|rocher|rogers|ryukyu|safety|sakura|sanofi|school|schule|search|secure|select|shouji|soccer|social|stream|studio|supply|suzuki|swatch|sydney|taipei|taobao|target|tattoo|tennis|tienda|tjmaxx|tkmaxx|toyota|travel|unicom|viajes|viking|villas|virgin|vision|voting|voyage|vuelos|walter|warman|webcam|xihuan|yachts|yandex|zappos|москва|онлайн|ابوظبي|ارامكو|الاردن|المغرب|امارات|فلسطين|مليسيا|भारतम्|இலங்கை|ファッション|actor|adult|aetna|amfam|amica|apple|archi|audio|autos|azure|baidu|beats|bible|bingo|black|boats|bosch|build|canon|cards|chase|cheap|cisco|citic|click|cloud|coach|codes|crown|cymru|dabur|dance|deals|delta|dodge|drive|dubai|earth|edeka|email|epost|epson|faith|fedex|final|forex|forum|gallo|games|gifts|gives|glade|glass|globo|gmail|green|gripe|group|gucci|guide|homes|honda|horse|house|hyatt|ikano|intel|irish|iveco|jetzt|koeln|kyoto|lamer|lease|legal|lexus|lilly|linde|lipsy|lixil|loans|locus|lotte|lotto|lupin|macys|mango|media|miami|money|mopar|movie|nadex|nexus|nikon|ninja|nokia|nowtv|omega|osaka|paris|parts|party|phone|photo|pizza|place|poker|praxi|press|prime|promo|quest|radio|rehab|reise|ricoh|rocks|rodeo|rugby|salon|sener|seven|sharp|shell|shoes|skype|sling|smart|smile|solar|space|sport|stada|store|study|style|sucks|swiss|tatar|tires|tirol|tmall|today|tokyo|tools|toray|total|tours|trade|trust|tunes|tushu|ubank|vegas|video|vodka|volvo|wales|watch|weber|weibo|works|world|xerox|yahoo|zippo|ایران|بازار|بھارت|سودان|سورية|همراه|भारोत|संगठन|বাংলা|భారత్|ഭാരതം|嘉里大酒店|aarp|able|adac|aero|aigo|akdn|ally|amex|arab|army|arpa|arte|asda|asia|audi|auto|baby|band|bank|bbva|beer|best|bike|bing|blog|blue|bofa|bond|book|buzz|cafe|call|camp|care|cars|casa|case|cash|cbre|cern|chat|citi|city|club|cool|coop|cyou|data|date|dclk|deal|dell|desi|diet|dish|docs|doha|duck|duns|dvag|erni|fage|fail|fans|farm|fast|fiat|fido|film|fire|fish|flir|food|ford|free|fund|game|gbiz|gent|ggee|gift|gmbh|gold|golf|goog|guge|guru|hair|haus|hdfc|help|here|hgtv|host|hsbc|icbc|ieee|imdb|immo|info|itau|java|jeep|jobs|jprs|kddi|kiwi|kpmg|kred|land|lego|lgbt|lidl|life|like|limo|link|live|loan|loft|love|ltda|luxe|maif|meet|meme|menu|mini|mint|mobi|moda|moto|name|navy|news|next|nico|nike|ollo|open|page|pars|pccw|pics|ping|pink|play|plus|pohl|porn|post|prod|prof|qpon|raid|read|reit|rent|rest|rich|rmit|room|rsvp|ruhr|safe|sale|sarl|save|saxo|scor|scot|seat|seek|sexy|shaw|shia|shop|show|silk|sina|site|skin|sncf|sohu|song|sony|spot|star|surf|talk|taxi|team|tech|teva|tiaa|tips|town|toys|tube|vana|visa|viva|vivo|vote|voto|wang|weir|wien|wiki|wine|work|xbox|yoga|zara|zero|zone|дети|сайт|بارت|بيتك|ڀارت|تونس|شبكة|عراق|عمان|موقع|भारत|ভারত|ভাৰত|ਭਾਰਤ|ભારત|ଭାରତ|ಭಾರತ|ලංකා|グーグル|クラウド|ポイント|大众汽车|组织机构|電訊盈科|香格里拉|aaa|abb|abc|aco|ads|aeg|afl|aig|anz|aol|app|art|aws|axa|bar|bbc|bbt|bcg|bcn|bet|bid|bio|biz|bms|bmw|bnl|bom|boo|bot|box|buy|bzh|cab|cal|cam|car|cat|cba|cbn|cbs|ceb|ceo|cfa|cfd|com|crs|csc|dad|day|dds|dev|dhl|diy|dnp|dog|dot|dtv|dvr|eat|eco|edu|esq|eus|fan|fit|fly|foo|fox|frl|ftr|fun|fyi|gal|gap|gdn|gea|gle|gmo|gmx|goo|gop|got|gov|hbo|hiv|hkt|hot|how|ibm|ice|icu|ifm|inc|ing|ink|int|ist|itv|jcb|jcp|jio|jll|jmp|jnj|jot|joy|kfh|kia|kim|kpn|krd|lat|law|lds|llc|lol|lpl|ltd|man|map|mba|med|men|mil|mit|mlb|mls|mma|moe|moi|mom|mov|msd|mtn|mtr|nab|nba|nec|net|new|nfl|ngo|nhk|now|nra|nrw|ntt|nyc|obi|off|one|ong|onl|ooo|org|ott|ovh|pay|pet|phd|pid|pin|pnc|pro|pru|pub|pwc|qvc|red|ren|ril|rio|rip|run|rwe|sap|sas|sbi|sbs|sca|scb|ses|sew|sex|sfr|ski|sky|soy|srl|srt|stc|tab|tax|tci|tdk|tel|thd|tjx|top|trv|tui|tvs|ubs|uno|uol|ups|vet|vig|vin|vip|wed|win|wme|wow|wtc|wtf|xin|xxx|xyz|you|yun|zip|бел|ком|қаз|мкд|мон|орг|рус|срб|укр|հայ|קום|عرب|قطر|كوم|مصر|कॉम|नेट|คอม|ไทย|ストア|セール|みんな|中文网|天主教|我爱你|新加坡|淡马锡|诺基亚|飞利浦|ac|ad|ae|af|ag|ai|al|am|ao|aq|ar|as|at|au|aw|ax|az|ba|bb|bd|be|bf|bg|bh|bi|bj|bm|bn|bo|br|bs|bt|bv|bw|by|bz|ca|cc|cd|cf|cg|ch|ci|ck|cl|cm|cn|co|cr|cu|cv|cw|cx|cy|cz|de|dj|dk|dm|do|dz|ec|ee|eg|er|es|et|eu|fi|fj|fk|fm|fo|fr|ga|gb|gd|ge|gf|gg|gh|gi|gl|gm|gn|gp|gq|gr|gs|gt|gu|gw|gy|hk|hm|hn|hr|ht|hu|id|ie|il|im|in|io|iq|ir|is|it|je|jm|jo|jp|ke|kg|kh|ki|km|kn|kp|kr|kw|ky|kz|la|lb|lc|li|lk|lr|ls|lt|lu|lv|ly|ma|mc|md|me|mg|mh|mk|ml|mm|mn|mo|mp|mq|mr|ms|mt|mu|mv|mw|mx|my|mz|na|nc|ne|nf|ng|ni|nl|no|np|nr|nu|nz|om|pa|pe|pf|pg|ph|pk|pl|pm|pn|pr|ps|pt|pw|py|qa|re|ro|rs|ru|rw|sa|sb|sc|sd|se|sg|sh|si|sj|sk|sl|sm|sn|so|sr|st|su|sv|sx|sy|sz|tc|td|tf|tg|th|tj|tk|tl|tm|tn|to|tr|tt|tv|tw|tz|ua|ug|uk|us|uy|uz|va|vc|ve|vg|vi|vn|vu|wf|ws|ye|yt|za|zm|zw|ελ|бг|ею|рф|გე|닷넷|닷컴|삼성|한국|コム|世界|中信|中国|中國|企业|佛山|信息|健康|八卦|公司|公益|台湾|台灣|商城|商店|商标|嘉里|在线|大拿|娱乐|家電|工行|广东|微博|慈善|手机|手表|招聘|政务|政府|新闻|时尚|書籍|机构|游戏|澳門|点看|珠宝|移动|网址|网店|网站|网络|联通|谷歌|购物|通販|集团|食品|餐厅|香港)/,H=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),G=function(e){function t(){var t,n,i=null!==e&&e.apply(this,arguments)||this;return i.matcherRegex=(t=F+"!#$%&'*+\\-\\/=?^_`{|}~",n=new RegExp("(?:["+t+"](?:["+t+']|\\.(?!\\.|@))*|\\"['+(t+'\\s"(),:;<>@\\[\\]')+'.]+\\")@'),new RegExp([n.source,q(1),"\\.",U.source].join(""),"gi")),i}return H(t,e),t.prototype.parseMatches=function(e){for(var t,n=this.matcherRegex,i=this.tagBuilder,r=[];null!==(t=n.exec(e));){var o=t[0];r.push(new E({tagBuilder:i,matchedText:o,offset:t.index,email:o}))}return r},t}(I),W=function(){function e(){}return e.isValid=function(e,t){return!(t&&!this.isValidUriScheme(t)||this.urlMatchDoesNotHaveProtocolOrDot(e,t)||this.urlMatchDoesNotHaveAtLeastOneWordChar(e,t)&&!this.isValidIpAddress(e)||this.containsMultipleDots(e))},e.isValidIpAddress=function(e){var t=new RegExp(this.hasFullProtocolRegex.source+this.ipRegex.source);return null!==e.match(t)},e.containsMultipleDots=function(e){var t=e;return this.hasFullProtocolRegex.test(e)&&(t=e.split("://")[1]),t.split("/")[0].indexOf("..")>-1},e.isValidUriScheme=function(e){var t=e.match(this.uriSchemeRegex),n=t&&t[0].toLowerCase();return"javascript:"!==n&&"vbscript:"!==n},e.urlMatchDoesNotHaveProtocolOrDot=function(e,t){return!(!e||t&&this.hasFullProtocolRegex.test(t)||-1!==e.indexOf("."))},e.urlMatchDoesNotHaveAtLeastOneWordChar=function(e,t){return!(!e||!t)&&!this.hasWordCharAfterProtocolRegex.test(e)},e.hasFullProtocolRegex=/^[A-Za-z][-.+A-Za-z0-9]*:\/\//,e.uriSchemeRegex=/^[A-Za-z][-.+A-Za-z0-9]*:/,e.hasWordCharAfterProtocolRegex=new RegExp(":[^\\s]*?["+z+"]"),e.ipRegex=/[0-9][0-9]?[0-9]?\.[0-9][0-9]?[0-9]?\.[0-9][0-9]?[0-9]?\.[0-9][0-9]?[0-9]?(:[0-9]*)?\/?$/,e}(),$=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),Y=function(e){function t(t){var n,i=e.call(this,t)||this;return i.stripPrefix={scheme:!0,www:!0},i.stripTrailingSlash=!0,i.decodePercentEncoding=!0,i.matcherRegex=(n=new RegExp("[/?#](?:["+F+"\\-+&@#/%=~_()|'$*\\[\\]?!:,.;✓]*["+F+"\\-+&@#/%=~_()|'$*\\[\\]✓])?"),new RegExp(["(?:","(",/(?:[A-Za-z][-.+A-Za-z0-9]{0,63}:(?![A-Za-z][-.+A-Za-z0-9]{0,63}:\/\/)(?!\d+\/?)(?:\/\/)?)/.source,q(2),")","|","(","(//)?",/(?:www\.)/.source,q(6),")","|","(","(//)?",q(10)+"\\.",U.source,"(?![-"+M+"])",")",")","(?::[0-9]+)?","(?:"+n.source+")?"].join(""),"gi")),i.wordCharRegExp=new RegExp("["+F+"]"),i.openParensRe=/\(/g,i.closeParensRe=/\)/g,i.stripPrefix=t.stripPrefix,i.stripTrailingSlash=t.stripTrailingSlash,i.decodePercentEncoding=t.decodePercentEncoding,i}return $(t,e),t.prototype.parseMatches=function(e){for(var t,n=this.matcherRegex,i=this.stripPrefix,r=this.stripTrailingSlash,o=this.decodePercentEncoding,a=this.tagBuilder,s=[];null!==(t=n.exec(e));){var u=t[0],c=t[1],l=t[4],d=t[5],p=t[9],f=t.index,h=d||p,m=e.charAt(f-1);if(W.isValid(u,c)&&!(f>0&&"@"===m||f>0&&h&&this.wordCharRegExp.test(m))){if(/\?$/.test(u)&&(u=u.substr(0,u.length-1)),this.matchHasUnbalancedClosingParen(u))u=u.substr(0,u.length-1);else{var g=this.matchHasInvalidCharAfterTld(u,c);g>-1&&(u=u.substr(0,g))}var v=c?"scheme":l?"www":"tld",y=!!c;s.push(new D({tagBuilder:a,matchedText:u,offset:f,urlMatchType:v,url:u,protocolUrlMatch:y,protocolRelativeMatch:!!h,stripPrefix:i,stripTrailingSlash:r,decodePercentEncoding:o}))}}return s},t.prototype.matchHasUnbalancedClosingParen=function(e){if(")"===e.charAt(e.length-1)){var t=e.match(this.openParensRe),n=e.match(this.closeParensRe);if((t&&t.length||0)<(n&&n.length||0))return!0}return!1},t.prototype.matchHasInvalidCharAfterTld=function(e,t){if(!e)return-1;var n=0;t&&(n=e.indexOf(":"),e=e.slice(n));var i=new RegExp("^((.?//)?[-."+F+"]*[-"+F+"]\\.[-"+F+"]+)").exec(e);return null===i?-1:(n+=i[1].length,e=e.slice(i[1].length),/^[^-.A-Za-z0-9:\/?#]/.test(e)?n:-1)},t}(I),Q=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),K=function(e){function t(t){var n=e.call(this,t)||this;return n.serviceName="twitter",n.matcherRegex=new RegExp("#[_"+F+"]{1,139}(?![_"+F+"])","g"),n.nonWordCharRegex=new RegExp("[^"+F+"]"),n.serviceName=t.serviceName,n}return Q(t,e),t.prototype.parseMatches=function(e){for(var t,n=this.matcherRegex,i=this.nonWordCharRegex,r=this.serviceName,o=this.tagBuilder,a=[];null!==(t=n.exec(e));){var s=t.index,u=e.charAt(s-1);if(0===s||i.test(u)){var c=t[0],l=t[0].slice(1);a.push(new S({tagBuilder:o,matchedText:c,offset:s,serviceName:r,hashtag:l}))}}return a},t}(I),Z=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),J=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.matcherRegex=/(?:(?:(?:(\+)?\d{1,3}[-\040.]?)?\(?\d{3}\)?[-\040.]?\d{3}[-\040.]?\d{4})|(?:(\+)(?:9[976]\d|8[987530]\d|6[987]\d|5[90]\d|42\d|3[875]\d|2[98654321]\d|9[8543210]|8[6421]|6[6543210]|5[87654321]|4[987654310]|3[9643210]|2[70]|7|1)[-\040.]?(?:\d[-\040.]?){6,12}\d+))([,;]+[0-9]+#?)*/g,t}return Z(t,e),t.prototype.parseMatches=function(e){for(var t,n=this.matcherRegex,i=this.tagBuilder,r=[];null!==(t=n.exec(e));){var o=t[0],a=o.replace(/[^0-9,;#]/g,""),s=!(!t[1]&&!t[2]),u=0==t.index?"":e.substr(t.index-1,1),c=e.substr(t.index+o.length,1),l=!u.match(/\d/)&&!c.match(/\d/);this.testMatch(t[3])&&this.testMatch(o)&&l&&r.push(new N({tagBuilder:i,matchedText:o,offset:t.index,number:a,plusSign:s}))}return r},t.prototype.testMatch=function(e){return/\D/.test(e)},t}(I),X=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),ee=function(e){function t(t){var n=e.call(this,t)||this;return n.serviceName="twitter",n.matcherRegexes={twitter:new RegExp("@[_"+F+"]{1,50}(?![_"+F+"])","g"),instagram:new RegExp("@[_."+F+"]{1,30}(?![_"+F+"])","g"),soundcloud:new RegExp("@[-_."+F+"]{1,50}(?![-_"+F+"])","g")},n.nonWordCharRegex=new RegExp("[^"+F+"]"),n.serviceName=t.serviceName,n}return X(t,e),t.prototype.parseMatches=function(e){var t,n=this.serviceName,i=this.matcherRegexes[this.serviceName],r=this.nonWordCharRegex,o=this.tagBuilder,a=[];if(!i)return a;for(;null!==(t=i.exec(e));){var s=t.index,u=e.charAt(s-1);if(0===s||r.test(u)){var c=t[0].replace(/\.+$/g,""),l=c.slice(1);a.push(new R({tagBuilder:o,matchedText:c,offset:s,serviceName:n,mention:l}))}}return a},t}(I);return function(){function e(t){void 0===t&&(t={}),this.version=e.version,this.urls={},this.email=!0,this.phone=!0,this.hashtag=!1,this.mention=!1,this.newWindow=!0,this.stripPrefix={scheme:!0,www:!0},this.stripTrailingSlash=!0,this.decodePercentEncoding=!0,this.truncate={length:0,location:"end"},this.className="",this.replaceFn=null,this.context=void 0,this.htmlParser=new w,this.matchers=null,this.tagBuilder=null,this.urls=this.normalizeUrlsCfg(t.urls),this.email="boolean"==typeof t.email?t.email:this.email,this.phone="boolean"==typeof t.phone?t.phone:this.phone,this.hashtag=t.hashtag||this.hashtag,this.mention=t.mention||this.mention,this.newWindow="boolean"==typeof t.newWindow?t.newWindow:this.newWindow,this.stripPrefix=this.normalizeStripPrefixCfg(t.stripPrefix),this.stripTrailingSlash="boolean"==typeof t.stripTrailingSlash?t.stripTrailingSlash:this.stripTrailingSlash,this.decodePercentEncoding="boolean"==typeof t.decodePercentEncoding?t.decodePercentEncoding:this.decodePercentEncoding;var n=this.mention;if(!1!==n&&"twitter"!==n&&"instagram"!==n&&"soundcloud"!==n)throw new Error("invalid `mention` cfg - see docs");var i=this.hashtag;if(!1!==i&&"twitter"!==i&&"facebook"!==i&&"instagram"!==i)throw new Error("invalid `hashtag` cfg - see docs");this.truncate=this.normalizeTruncateCfg(t.truncate),this.className=t.className||this.className,this.replaceFn=t.replaceFn||this.replaceFn,this.context=t.context||this}return e.link=function(t,n){return new e(n).link(t)},e.parse=function(t,n){return new e(n).parse(t)},e.prototype.normalizeUrlsCfg=function(e){return null==e&&(e=!0),"boolean"==typeof e?{schemeMatches:e,wwwMatches:e,tldMatches:e}:{schemeMatches:"boolean"!=typeof e.schemeMatches||e.schemeMatches,wwwMatches:"boolean"!=typeof e.wwwMatches||e.wwwMatches,tldMatches:"boolean"!=typeof e.tldMatches||e.tldMatches}},e.prototype.normalizeStripPrefixCfg=function(e){return null==e&&(e=!0),"boolean"==typeof e?{scheme:e,www:e}:{scheme:"boolean"!=typeof e.scheme||e.scheme,www:"boolean"!=typeof e.www||e.www}},e.prototype.normalizeTruncateCfg=function(e){return"number"==typeof e?{length:e,location:"end"}:function(e,t){for(var n in t)t.hasOwnProperty(n)&&void 0===e[n]&&(e[n]=t[n]);return e}(e||{},{length:Number.POSITIVE_INFINITY,location:"end"})},e.prototype.parse=function(e){for(var t=this.htmlParser.parse(e),n=["a","style","script"],i=0,r=[],o=0,a=t.length;o<a;o++){var s=t[o],u=s.getType();if("element"===u&&-1!==n.indexOf(s.getTagName()))s.isClosing()?i=Math.max(i-1,0):i++;else if("text"===u&&0===i){var c=this.parseText(s.getText(),s.getOffset());r.push.apply(r,c)}}return r=this.compactMatches(r),r=this.removeUnwantedMatches(r)},e.prototype.compactMatches=function(e){e.sort(function(e,t){return e.getOffset()-t.getOffset()});for(var t=0;t<e.length-1;t++){var n=e[t],i=n.getOffset(),r=n.getMatchedText().length,o=i+r;if(t+1<e.length){if(e[t+1].getOffset()===i){var a=e[t+1].getMatchedText().length>r?t:t+1;e.splice(a,1);continue}e[t+1].getOffset()<o&&e.splice(t+1,1)}}return e},e.prototype.removeUnwantedMatches=function(e){return this.hashtag||t(e,function(e){return"hashtag"===e.getType()}),this.email||t(e,function(e){return"email"===e.getType()}),this.phone||t(e,function(e){return"phone"===e.getType()}),this.mention||t(e,function(e){return"mention"===e.getType()}),this.urls.schemeMatches||t(e,function(e){return"url"===e.getType()&&"scheme"===e.getUrlMatchType()}),this.urls.wwwMatches||t(e,function(e){return"url"===e.getType()&&"www"===e.getUrlMatchType()}),this.urls.tldMatches||t(e,function(e){return"url"===e.getType()&&"tld"===e.getUrlMatchType()}),e},e.prototype.parseText=function(e,t){void 0===t&&(t=0),t=t||0;for(var n=this.getMatchers(),i=[],r=0,o=n.length;r<o;r++){for(var a=n[r].parseMatches(e),s=0,u=a.length;s<u;s++)a[s].setOffset(t+a[s].getOffset());i.push.apply(i,a)}return i},e.prototype.link=function(e){if(!e)return"";for(var t=this.parse(e),n=[],i=0,r=0,o=t.length;r<o;r++){var a=t[r];n.push(e.substring(i,a.getOffset())),n.push(this.createMatchReturnVal(a)),i=a.getOffset()+a.getMatchedText().length}return n.push(e.substring(i)),n.join("")},e.prototype.createMatchReturnVal=function(e){var t;return this.replaceFn&&(t=this.replaceFn.call(this.context,e)),"string"==typeof t?t:!1===t?e.getMatchedText():t instanceof n?t.toAnchorString():e.buildTag().toAnchorString()},e.prototype.getMatchers=function(){if(this.matchers)return this.matchers;var e=this.getTagBuilder(),t=[new K({tagBuilder:e,serviceName:this.hashtag}),new G({tagBuilder:e}),new J({tagBuilder:e}),new ee({tagBuilder:e,serviceName:this.mention}),new Y({tagBuilder:e,stripPrefix:this.stripPrefix,stripTrailingSlash:this.stripTrailingSlash,decodePercentEncoding:this.decodePercentEncoding})];return this.matchers=t},e.prototype.getTagBuilder=function(){var e=this.tagBuilder;return e||(e=this.tagBuilder=new c({newWindow:this.newWindow,truncate:this.truncate,className:this.className})),e},e.version="2.2.1",e.AnchorTagBuilder=c,e.HtmlTag=n,e.matcher={Email:G,Hashtag:K,Matcher:I,Mention:ee,Phone:J,Url:Y},e.match={Email:E,Hashtag:S,Match:A,Mention:R,Phone:N,Url:D},e}()}),define("app/core/util/autolinker",["underscore","autolinker","app/i18n"],function(e,t,n){"use strict";var i=/(.)??(#[0-9]+|[0-9]{15}|0*[0-9]{12}|[0-9]{9}|[A-Z]{3}[0-9]{3}[A-Z]{1})(.)??/g,r=null;function o(e){return r||(r=new t({urls:{schemeMatches:!0,wwwMatches:!0,tldMatches:!0},email:!0,phone:!1,mention:!1,hashtag:!1,stripPrefix:!0,stripTrailingSlash:!0,newWindow:!0,truncate:{length:0,location:"end"},className:"",replaceFn:function(e){var t=e.buildTag();if("url"===e.getType()&&-1!==e.getUrl().indexOf(window.location.host)){var n=t.innerHTML.split("?");n.length>1&&n[1].length&&(t.innerHTML=n[0]+"?&hellip;"),delete t.attrs.rel}else t.innerHTML.length>=60&&(t.innerHTML=t.innerHTML.substring(0,50)+"&hellip;");return t}})),r.link(e)}return{autolinkText:o,autolinkMessage:function(t,r){return t=(t||"").trim().replace(/\n{3,}/,"\n\n"),t=(t=o(e.escape(t)).replace(/👤/g,'<i class="fa fa-user"></i>')).replace(i,function(e,t,i,o){var a;if("/"===t)return e;if(void 0===t&&(t=""),void 0===o&&(o=""),i=i.replace(/^0+/,""),/^#[0-9]+$/.test(i)&&i.length<9?(a="entry",i=i.substring(1),t+="#"):a=15===i.length?"document":9===i.length?"order":"product",!a)return e;var s=r&&r.nlsDomain,u="autolink:"+a;return t+'<a class="autolink" title="'+(s&&n.has(s,u)?n(s,u):n("core",u))+'" data-type="'+a+'" data-id="'+i.toUpperCase()+'">'+i+"</a>"+o})}}}),define("app/data/colorFactory",[],function(){"use strict";var e=["#2f7ed8","#0d233a","#8bbc21","#910000","#1aadce","#492970","#f28f43","#77a1e5","#c42525","#a6c96a","#aaff00","#00aaff","#ffaa00","#00ffaa","#aa00ff","#ff00aa","#4572A7","#AA4643","#89A54E","#80699B","#3D96AE","#DB843D","#92A8CD","#A47D7C","#B5CA92","#666666","#809FFF","#9F80FF","#DF80FF","#FF80DF","#FF809F","#FF9F80","#FFDF80","#DFFF80","#9FFF80","#80FF9F","#80FFDF","#80DFFF","#4271FF","#0544FF","#FFD042","#FFC105","#3366FF","#6633FF","#CC33FF","#FF33CC","#FF3366","#FF6633","#FFCC33","#CCFF33","#66FF33","#33FF66","#33FFCC","#33CCFF","#003DF5","#002EB8","#F5B800","#B88A00","#0039E6","#3900E6","#AC00E6","#E600AC","#E60039","#E63900","#E6AC00","#ACE600","#39E600","#00E639","#00E6AC","#00ACE6","#245BFF","#6188FF","#FFC824","#FFD761"],t={};return{setColors:function(n,i){void 0===t[n]&&(t[n]={free:i.concat(e),assigned:{}})},getColor:function(n,i){return void 0===t[n]&&(t[n]={free:[].concat(e),assigned:{}}),"string"==typeof(n=t[n]).assigned[i]?n.assigned[i]:(n.assigned[i]=n.free.length?n.free.shift():"#"+(16777216+16777215*Math.random()).toString(16).substr(1,6),n.assigned[i])}}}),define("app/orderStatuses/util/renderOrderStatusLabel",["app/core/util/colorLabel","app/data/orderStatuses"],function(e,t){"use strict";return function(n){if("string"==typeof n){var i=t.get(n);n=i?i.attributes:{_id:n,label:n,color:"#999999"}}return e({className:"orderStatus",label:n._id,title:n.label,color:n.color})}}),define("app/wmes-fap-categories/Category",["require","../i18n","../core/Model","../data/orgUnits","../data/prodFunctions","app/core/templates/userInfo"],function(e,t,n,i,r,o){"use strict";return n.extend({urlRoot:"/fap/categories",clientUrlRoot:"#fap/categories",topicPrefix:"fap.categories",privilegePrefix:"FAP",nlsDomain:"wmes-fap-categories",labelAttribute:"name",defaults:{active:!0,planners:!1},serialize:function(){var n=this.toJSON(),a=e("app/wmes-fap-entries/dictionaries"),s=a&&a.categories.get(n.etoCategory);return n.active=t("core","BOOL:"+n.active),n.planners=t("core","BOOL:"+n.planners),n.etoCategory=s?s.getLabel():""===n.etoCategory?t("core","BOOL:true"):null===n.etoCategory?t("core","BOOL:false"):n.etoCategory,n.users=(n.users||[]).map(function(e){return o({userInfo:e})}),n.notifications=(n.notifications||[]).map(function(e){return{subdivisions:e.subdivisions.map(function(e){var t=i.getByTypeAndId("subdivision",e);if(!t)return e;var n=i.getParent(t);return(n?n.getLabel():"?")+" \\ "+t.getLabel()}),prodFunctions:e.prodFunctions.map(function(e){var t=r.get(e);return t?t.getLabel():e})}}),n}})}),define("app/wmes-fap-categories/CategoryCollection",["../core/Collection","./Category"],function(e,t){"use strict";return e.extend({model:t,rqlQuery:"sort(name)",comparator:"name"})}),define("app/wmes-fap-subCategories/SubCategory",["require","../i18n","../core/Model","../data/orgUnits","../data/prodFunctions","app/core/templates/userInfo"],function(e,t,n,i,r,o){"use strict";return n.extend({urlRoot:"/fap/subCategories",clientUrlRoot:"#fap/subCategories",topicPrefix:"fap.subCategories",privilegePrefix:"FAP",nlsDomain:"wmes-fap-subCategories",labelAttribute:"name",defaults:{active:!0,planners:!1},serialize:function(){var n=this.toJSON(),a=e("app/wmes-fap-entries/dictionaries"),s=a&&a.subCategories.get(n.etoCategory),u=a&&a.categories.get(n.parent);return n.active=t("core","BOOL:"+n.active),n.planners=t("core","BOOL:"+n.planners),u&&(n.parent=u.getLabel(),n.reqFields&&n.reqFields.enabled||(n.reqFields=u.get("reqFields")||{})),n.etoCategory=s?s.getLabel():""===n.etoCategory?t("core","BOOL:true"):null===n.etoCategory?t("core","BOOL:false"):n.etoCategory,n.users=(n.users||[]).map(function(e){return o({userInfo:e})}),n.notifications=(n.notifications||[]).map(function(e){return{subdivisions:e.subdivisions.map(function(e){var t=i.getByTypeAndId("subdivision",e);if(!t)return e;var n=i.getParent(t);return(n?n.getLabel():"?")+" \\ "+t.getLabel()}),prodFunctions:e.prodFunctions.map(function(e){var t=r.get(e);return t?t.getLabel():e})}}),n}})}),define("app/wmes-fap-subCategories/SubCategoryCollection",["require","../core/Collection","./SubCategory"],function(e,t,n){"use strict";return t.extend({model:n,rqlQuery:"sort(parent,name)",comparator:function(t,n){var i=t.attributes.parent,r=n.attributes.parent;if(i===r)return t.attributes.name.localeCompare(n.attributes.name,void 0,{numeric:!0,ignorePunctuation:!0});var o=e("app/wmes-fap-entries/dictionaries");if(o){var a=o.categories.get(i),s=o.categories.get(r);a&&(i=a.getLabel()),s&&(r=s.getLabel())}return i.localeCompare(r,void 0,{numeric:!0,ignorePunctuation:!0})}})}),define("app/wmes-fap-entries/Setting",["../settings/Setting"],function(e){"use strict";return e.extend({urlRoot:"/fap/settings",nlsDomain:"wmes-fap-entries"})}),define("app/wmes-fap-entries/SettingCollection",["underscore","app/user","app/settings/SettingCollection","./Setting"],function(e,t,n,i){"use strict";return n.extend({model:i,idPrefix:"fap.",topicSuffix:"fap.**",prepareValue:function(e,t){return/Functions$/.test(e)?Array.isArray(t)?t:"string"==typeof t?t.split(","):[]:/quickUsers$/.test(e)?t:void 0},prepareFormValue:function(e,t){return/quickUsers$/.test(e)?Array.isArray(t)?t.map(function(e){return e.id}).join(","):"":t},canChangeCategory:function(){return e.includes(this.getValue("categoryFunctions"),t.data.prodFunction)}})}),define("app/wmes-fap-entries/dictionaries",["jquery","../broker","../pubsub","../user","../wmes-fap-categories/CategoryCollection","../wmes-fap-subCategories/SubCategoryCollection","./SettingCollection"],function(e,t,n,i,r,o,a){"use strict";var s={category:"categories",subCategory:"subCategories"},u=null,c=null,l=null,d={statuses:["pending","started","finished"],subdivisionTypes:["assembly","press","wh"],reqFields:["orderNo","lines","componentCode"],categories:new r,subCategories:new o,settings:new a,loaded:!1,load:function(){return null!==c&&(clearTimeout(c),c=null),d.loaded?e.Deferred().resolve():null!==u?u:((u=e.ajax({url:"/fap/dictionaries"})).done(function(e){d.loaded=!0,p(e)}),u.fail(f),u.always(function(){u=null}),l=n.sandbox(),Object.keys(s).forEach(function(e){l.subscribe("fap."+s[e]+".**",h)}),d.settings.setUpPubsub(l),u)},unload:function(){null!==c&&clearTimeout(c),c=setTimeout(f,3e4)},getLabel:function(e,t){if("string"==typeof e&&(e=this.forProperty(e)||d[e]),!e||Array.isArray(e))return t;var n=e.get(t);return n?n.getLabel():t},forProperty:function(e){return this[s[e]]||null},bind:function(e){var t=this;return e.on("beforeLoad",function(e,n){n.push(t.load())}),e.on("afterRender",t.load.bind(t)),e.once("remove",t.unload.bind(t)),e}};function p(e){Object.keys(s).forEach(function(t){var n=s[t];d[n].reset(e?e[n]:[])}),d.settings.reset(e?e.settings:[])}function f(){c=null,null!==l&&(l.destroy(),l=null),d.loaded=!1,p()}function h(e,n){var i=n.split("."),r=d[i[1]];if(r){switch(i[2]){case"added":r.add(e.model);break;case"edited":var o=r.get(e.model._id);o&&o.set(e.model);break;case"deleted":r.remove(r.get(e.model._id))}t.publish(n,e)}}return d}),define("app/wmes-fap-entries/templates/levelIndicator",["underscore","jquery","app/i18n","app/time","app/user","app/core/util/forms"],function(_,$,t,time,user,forms){return function anonymous(locals,escapeFn,include,rethrow){escapeFn=escapeFn||function(e){return void 0==e?"":String(e).replace(_MATCH_HTML,encode_char)};var _ENCODE_HTML_RULES={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&#34;","'":"&#39;"},_MATCH_HTML=/[&<>'"]/g;function encode_char(e){return _ENCODE_HTML_RULES[e]||e}var __output="";function __append(e){void 0!==e&&null!==e&&(__output+=e)}with(locals||{}){__append('<div class="fap-levelIndicator-outer '),__append(canIncrease?"fap-levelIndicator-can-increase":""),__append(" "),__append(canManage?"fap-levelIndicator-can-manage":""),__append('">\n  ');for(var i=1;i<=4;++i){__append("\n  ");var title="";(canManage||canIncrease&&i===level+1)&&(title=t("wmes-fap-entries","levelIndicator:title",{level:i})),__append('\n  <div class="fap-levelIndicator-inner '),__append(i<=level?"is-selected":"is-unselected"),__append('" title="'),__append(title),__append('" data-level="'),__append(i),__append('">'),__append(i),__append("</div>\n  ")}__append('\n  <div class="fap-levelIndicator-label">'),__append(t("wmes-fap-entries","levelIndicator:label")),__append("</div>\n</div>\n")}return __output}}),define("app/wmes-fap-entries/Entry",["underscore","jquery","../i18n","../time","../user","../socket","../core/Model","../core/util/autolinker","../data/colorFactory","../orderStatuses/util/renderOrderStatusLabel","./dictionaries","app/core/templates/userInfo","app/wmes-fap-entries/templates/levelIndicator"],function(e,t,n,i,r,o,a,s,u,c,l,d,p){"use strict";var f={pending:"danger",started:"info",analyzing:"warning",finished:"success"},h={image:"fa-file-image-o",text:"fa-file-text-o",audio:"fa-audio-o",video:"fa-video-o","application/octet-stream":"fa-file-archive-o","application/x-zip-compressed":"fa-file-archive-o","application/x-7z-compressed":"fa-file-archive-o","application/x-rar-compressed":"fa-file-archive-o","application/pdf":"fa-file-pdf-o","application/json":"fa-file-code-o","application/msword":"fa-file-word-o","application/vnd.openxmlformats-officedocument.wordprocessingml.document":"fa-file-word-o","application/vnd.ms-excel":"fa-file-excel-o","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":"fa-file-excel-o","application/vnd.ms-powerpoint":"fa-file-powerpoint-o","application/vnd.openxmlformats-officedocument.presentationml.presentation":"fa-file-powerpoint-o"};return u.setColors("fap/users",["#0af","#5cb85c","#fa0","#a0f","#f0a","#f00","#ff0","#9ff"]),a.extend({urlRoot:"/fap/entries",clientUrlRoot:"#fap/entries",topicPrefix:"fap.entries",privilegePrefix:"FAP",nlsDomain:"wmes-fap-entries",labelAttribute:"rid",defaults:function(){return{subdivisionType:"assembly"}},initialize:function(){this.serialized=null,this.on("change",function(){this.serialized=null})},isObserver:function(){return e.some(this.get("observers"),function(e){return e.user.id===r.data._id})},serialize:function(){if(this.serialized)return this.serialized;var e=this.toJSON();e.createdAt=i.format(e.createdAt,"L HH:mm");var t=l.categories.get(e.category);t&&(e.category=t.getLabel());var r=l.subCategories.get(e.subCategory);return r&&(e.subCategory=r.getLabel()),e.subCategory||(e.subCategory="-"),e.divisions=e.divisions?e.divisions.join("; "):"",e.lines=e.lines?e.lines.join("; "):"",e.assessment=n(this.nlsDomain,"assessment:"+e.assessment),e.analyzing="pending"!==e.status&&e.analysisNeed&&!e.analysisDone,e.analysisDone=e.analysisNeed?n("core","BOOL:"+e.analysisDone):"-",e.analysisNeed=n("core","BOOL:"+e.analysisNeed),e.orderNo||(e.orderNo="-",e.nc12="-",e.productName="-",e.mrp="-",e.qtyTodo="-",e.qtyDone="-"),e.lines||(e.lines="-",e.divisions="-"),e.subdivisionType=n(this.nlsDomain,"subdivisionType:"+e.subdivisionType),e.componentCode||(e.componentCode="-"),e.componentName||(e.componentName="-"),e.observer=this.serializeObserver(),Array.isArray(e.orderStatus)&&e.orderStatus.length?e.orderStatus=e.orderStatus.map(c).join(""):e.orderStatus="-",this.serialized=e},serializeRow:function(){if(this.serialized)return this.serialized;var t=this.serialize();t.className=f[t.analyzing?"analyzing":t.status],t.observer.changes.any&&(t.className+=" fap-is-unseen");var n=t.category;return"-"!==t.subCategory&&(n=t.subCategory),t.category='<span class="fap-list-category">'+e.escape(n)+"</span>",t.problem='<span class="fap-list-problem">'+e.escape(t.problem)+"</span>",t.lines='<span class="fap-list-lines">'+e.escape(t.lines)+"</span>","-"!==t.componentCode&&(t.nc12=t.componentCode,t.productName=t.componentName),t.levelIndicator=p({level:t.level,canIncrease:!1,canManage:!1}),this.serialized=t},serializeDetails:function(){if(this.serialized)return this.serialized;var e=this.serialize();switch(e.auth=this.serializeAuth(),e.problem=this.serializeText(e.problem),e.solution=this.serializeText(e.solution||"-"),e.solver=e.solver?e.solver.label:"",e.solutionSteps=this.serializeText(e.solutionSteps||"-"),e.empty={solution:"-"===e.solution},e.multiline={problem:-1!==e.problem.indexOf("\n"),solution:-1!==e.solution.indexOf("\n"),solutionSteps:-1!==e.solutionSteps.indexOf("\n")},e.mainAnalyzer=e.analyzers&&e.analyzers.length?e.analyzers[0].label:"-",e.analyzers=e.analyzers&&e.analyzers.length>1?e.analyzers.slice(1).map(function(e){return e.label}).join("; "):"-",e.chat=this.serializeChat(),e.attachments=(e.attachments||[]).map(this.serializeAttachment,this),e.observers=this.serializeObservers(),e.message={type:"",text:""},e.status){case"pending":e.message.type="error",e.message.text=n(this.nlsDomain,"message:pending");break;case"started":e.message.type=e.analyzing?"warning":"info",e.message.text=n(this.nlsDomain,"message:started:"+e.analyzing);break;case"finished":e.message.type=e.analyzing?"warning":"success",e.message.text=n(this.nlsDomain,"message:finished:"+e.analyzing)}return e.levelIndicator=p({level:e.level,canIncrease:e.auth.level,canManage:e.auth.manage}),this.serialized=e},updateAuth:function(){this.serialized&&(this.serialized.auth=this.serializeAuth())},serializeAuth:function(){var t=r.isLoggedIn(),n=r.isAllowedTo("FAP:MANAGE"),i=r.isAllowedTo("FN:manager"),o=r.isAllowedTo("FN:process-engineer","FN:process-engineer-NPI"),a=r.isAllowedTo("FN:warehouse-process-engineer"),s=r.isAllowedTo("FN:designer","FN:designer_eto"),u=r.isAllowedTo("FN:master"),c=r.isAllowedTo("FN:leader"),d=r.isAllowedTo("FN:whman","FN:wh"),p=this.get("analyzers")||[],f=e.some(p,function(e){return r.data._id===e.id}),h=f&&p[0].id===r.data._id,m=this.get("status"),g="pending"===m,v="started"===m,y="finished"===m,_=this.get("analysisNeed"),b=this.get("analysisDone"),w=!g&&_&&!b&&(n||o||u),A=n||o||a||s||u||c||d,k=l.settings.canChangeCategory();return{delete:this.canDelete(),manage:n,comment:t,attachments:t,observers:t,restart:n,status:A,level:!y&&(A||i),solution:A,problem:v&&A,category:n||k,subCategory:n||k,subdivisionType:A,componentCode:v&&(n||o),orderNo:v&&(n||o),lines:v&&(n||o),assessment:!g&&(n||o||u),analysisNeed:!g&&(n||o||u),analysisDone:!g&&_&&(n||o||u),mainAnalyzer:w,analyzers:(p.length||w)&&!g&&_&&!b&&(n||o||u||h),why5:!g&&_&&!b&&(A||f),solutionSteps:!g&&_&&!b&&(A||f)}},serializeObserver:function(){var t=e.assign({user:r.getInfo(),role:"viewer",func:r.data.prodFunction||null,lastSeenAt:Date.now(),notify:!1,changes:{}},e.find(this.get("observers"),function(e){return e.user.id===r.data._id}));t.lastSeenAt=Date.parse(t.lastSeenAt||0);var n=Object.keys(t.changes).length>0;return t.changes.any=t.notify||n,t.changes.all=t.notify&&!n,t},serializeChat:function(){var e=this,t={};(e.get("attachments")||[]).forEach(function(e){t[e._id]=!0});var o=e.get("createdAt"),a=i.getMoment(o),s=e.get("owner"),c=s.id===r.data._id,l=[{user:{id:s.id,label:d({userInfo:s,noIp:!0}),self:c},color:c?"transparent":u.getColor("fap/users",s.id),lines:[{time:a.format("LLLL"),text:n(e.nlsDomain,"history:added",{day:a.day(),ddd:a.format("ddd"),date:a.format("D MMMM YYYY"),time:a.format("HH:mm:ss")})}]}];return(e.get("changes")||[]).forEach(function(n){if(n.user){var i=!!n.comment,r=!!n.data.attachments&&!n.data.attachments[0]&&!!n.data.attachments[1],o=!!n.data.status,a=!!n.data.analysisNeed||!!n.data.analysisDone,s=!!n.data.level;(i||r||o||a||s)&&e.serializeChatMessage(n,l,t)}}),l},serializeChatMessage:function(t,o,a){var s,c=this,l=o&&o[o.length-1],p="<time>"+i.format(t.date,"HH:mm:ss")+"</time>",f=i.format(t.date,"dddd, LL LTS"),h=[];if(t.comment){var m=this.serializeText(t.comment);h.push({time:f,text:p+'<span class="fap-chat-line-text">'+m+"</span>"})}if(t.data.status&&(s="?","finished"===t.data.status[1]&&(s=(s=Date.parse(t.date)-Date.parse(this.get("createdAt")))>0?i.toString(s/1e3):"?"),h.push({time:f,text:n(this.nlsDomain,"chat:status:"+t.data.status.join(":"),{duration:s})})),t.data.analysisNeed&&t.data.analysisNeed[1]&&h.push({time:f,text:n(this.nlsDomain,"chat:analysis:started")}),t.data.analysisDone&&t.data.analysisDone[1]&&(s=(s=Date.parse(t.date)-Date.parse(this.get("analysisStartedAt")))>0?i.toString(s/1e3):"?",h.push({time:f,text:n(this.nlsDomain,"chat:analysis:finished",{duration:s})})),t.data.level){var g=t.data.level[1]>t.data.level[0]?"up":"down";h.push({time:f,text:n(this.nlsDomain,"chat:level:"+g,{level:t.data.level[1]})})}var v=t.data.attachments;if(v&&!v[0]&&v[1]){var y=n(c.nlsDomain,"autolink:attachment");t.data.attachments[1].forEach(function(t){if(!a||a[t._id]){var n=c.serializeAttachment(t);h.push({time:f,text:'<span class="fap-chat-attachment" title="'+y+'" data-attachment-id="'+t._id+'"><i class="fa '+n.icon+'"></i><a>'+e.escape(n.label)+"</a></span>"})}})}if(l&&l.user.id===t.user.id)return l.lines.push.apply(l.lines,h),l;var _=t.user.id===r.data._id,b={user:{id:t.user.id,label:d({userInfo:t.user,noIp:!0}),self:_},color:_?"transparent":u.getColor("fap/users",t.user.id),lines:h};return o&&b.lines.length&&o.push(b),b},serializeText:function(e){return s.autolinkMessage(e,this)},serializeObservers:function(){var e=this,t=r.isAllowedTo("FAP:MANAGE");return e.get("observers").map(function(n){var i=n.user.id===r.data._id;return{_id:n.user.id,label:d({userInfo:n.user,noIp:!0}),color:i?"#000":u.getColor("fap/users",n.user.id),lastSeenAt:n.lastSeenAt?Date.parse(n.lastSeenAt):0,online:i||!!e.attributes.presence[n.user.id],canUnsubscribe:i||t}}).sort(function(e,t){return t.lastSeenAt-e.lastSeenAt})},serializeAttachment:function(e){var t=e.type.split("/")[0];return{_id:e._id,icon:h[e.type]||h[t]||"fa-file-o",preview:"image"===t,label:e.name,menu:r.isAllowedTo("FAP:MANAGE","FN:master","FN:leader","FN:process-engineer","FN:process-engineer-NPI")||e.user&&e.user.id===r.data._id}},canDelete:function(){return r.isAllowedTo(this.privilegePrefix+":MANAGE")},change:function(e,t,n){void 0===n&&(n=this.get(e));var i={};i[e]=[n,t],this.multiChange(i,!0)},multiChange:function(e,t){var n=this,i={date:new Date,user:r.getInfo(),data:{},comment:""},o={};Object.keys(e).forEach(function(r){var a,s;t?(a=e[r][0],s=e[r][1]):(a=n.get(r),s=e[r]),JSON.stringify(s)!==JSON.stringify(a)&&(i.data[r]=[a,s],o[r]=s)}),Object.keys(e).length&&!Object.keys(o).length||(r.isLoggedIn()&&!this.isObserver()&&(i.data.subscribers||(i.data.subscribers=[null,[]]),i.data.subscribers[0]||i.data.subscribers[1].push({id:r.data._id,label:r.getLabel()})),n.handleChange(i),n.update(o))},update:function(e){var n=this,i=t.ajax({method:"PATCH",url:"/fap/entries/"+n.id,data:JSON.stringify({socketId:o.getId(),userLabel:r.getLabel(),data:e})});return i.fail(function(){n.fetch()}),i},handlePresence:function(e,t){var n=this.attributes.presence||{};void 0===n[e]&&(n[e]=!1),n[e]!==t&&(n[e]=t,this.trigger("change:presence",this,n,{userId:e,online:t}),this.serialized&&(this.serialized.observers=this.serializeObservers()))},handleChange:function(t,n){var i=this,o={};!t.comment.length&&e.isEmpty(t.data)||(o.changes=i.get("changes").concat(t)),Object.keys(t.data).forEach(function(e){var n=e.split("$")[0],r=t.data[e],a=i.propChangeHandlers[n];1===a?o[n]=r[1]:a&&a.call(i.propChangeHandlers,o,i,r,t)});var a={};(o.observers||[]).concat(i.get("observers")).forEach(function(e){e&&e.user&&(a[e.user.id]=e)}),a=e.values(a);var s=e.findIndex(a,function(e){return e.user.id===r.data._id});if(-1!==s){var u=a[s];if(t.user.id===r.data._id){if(!1===u.notify&&!Object.keys(o).length)return;a[s]=e.defaults({lastSeenAt:t.date,notify:!1,changes:{}},u),o.observers=a}else n&&n[r.data._id]&&(a[s]=e.defaults({lastSeenAt:t.date,notify:!0,changes:n[r.data._id]},u),o.observers=a)}i.set(o)},propChangeHandlers:{subscribers:function(e,t,n){var i=e.observers||t.get("observers");null===n[0]?this.addObservers(e,t,i,n[1]):null===n[1]&&this.removeObservers(e,t,i,n[0])},addObservers:function(e,t,n,i){var r={};n.forEach(function(e){r[e.user.id]=!0});var o=[].concat(n);i.forEach(function(e){r[e.id]||(o.push({lastSeenAt:new Date,notify:!1,changes:{},user:e}),r[e.id]=!0)}),e.observers=o},removeObservers:function(e,t,n,i){var r={};i.forEach(function(e){r[e.id]=!0}),e.observers=n.filter(function(e){return!r[e.user.id]})},attachments:function(e,t,n){var i=t.get("attachments");null===n[0]?this.addAttachments(e,t,i,n[1]):null===n[1]?this.removeAttachments(e,t,i,n[0]):this.editAttachments(e,t,i,n[1])},addAttachments:function(e,t,n,i){var r={};n.forEach(function(e){r[e._id]=!0});var o=[].concat(n);i.forEach(function(e){r[e._id]||(o.push(e),r[e.id]=!0)}),e.attachments=o},removeAttachments:function(e,t,n,i){var r={};i.forEach(function(e){r[e._id]=!0}),e.attachments=n.filter(function(e){return!r[e._id]})},editAttachments:function(e,t,n,i){var r={};i.forEach(function(e){r[e._id]=e}),e.attachments=n.map(function(e){return r[e._id]||e})},unsubscribed:function(t,n,i,r){var o=e.clone(n.get("unsubscribed"));i[1]?o[r.user.id]=!0:delete o[r.user.id],t.unsubscribed=o},status:1,level:1,startedAt:1,finishedAt:1,problem:1,solution:1,solver:1,category:1,subCategory:1,divisions:1,lines:1,why5:1,solutionSteps:1,assessment:1,analysisNeed:1,analysisDone:1,analysisStartedAt:1,analysisFinishedAt:1,orderNo:1,orderStatus:1,mrp:1,nc12:1,productName:1,qtyTodo:1,qtyDone:1,analyzers:1,subdivisionType:1,componentCode:1,componentName:1}},{AUTH_PROPS:{status:!0,analysisNeed:!0,analysisDone:!0,analyzers:!0}})}),define("app/core/templates/jumpAction",["underscore","jquery","app/i18n","app/time","app/user","app/core/util/forms"],function(_,$,t,time,user,forms){return function anonymous(locals,escapeFn,include,rethrow){escapeFn=escapeFn||function(e){return void 0==e?"":String(e).replace(_MATCH_HTML,encode_char)};var _ENCODE_HTML_RULES={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&#34;","'":"&#39;"},_MATCH_HTML=/[&<>'"]/g;function encode_char(e){return _ENCODE_HTML_RULES[e]||e}var __output="";function __append(e){void 0!==e&&null!==e&&(__output+=e)}with(locals||{})__append('<form class="page-actions-jump" title="'),__append(title),__append('" style="width: '),__append(width),__append('px">\n  <div class="input-group">\n    <input name="phrase" type="text" autocomplete="new-password" class="form-control" placeholder="'),__append(placeholder),__append('" required pattern="'),__append(pattern),__append('">\n    <span class="input-group-btn">\n      <button class="btn btn-default" type="submit"><i class="fa fa-search"></i></button>\n    </span>\n  </div>\n</form>\n');return __output}}),define("app/core/templates/exportAction",["underscore","jquery","app/i18n","app/time","app/user","app/core/util/forms"],function(_,$,t,time,user,forms){return function anonymous(locals,escapeFn,include,rethrow){escapeFn=escapeFn||function(e){return void 0==e?"":String(e).replace(_MATCH_HTML,encode_char)};var _ENCODE_HTML_RULES={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&#34;","'":"&#39;"},_MATCH_HTML=/[&<>'"]/g;function encode_char(e){return _ENCODE_HTML_RULES[e]||e}var __output="";function __append(e){void 0!==e&&null!==e&&(__output+=e)}with(locals||{})1===formats.length?(__append('\n<a class="page-actions-export btn btn-'),__append(type),__append(" "),__append(disabled?"disabled":""),__append('" href="'),__append(escapeFn(formats[0].href)),__append('"><i class="fa fa-download"></i><span>'),__append(label),__append("</span></a>\n")):(__append('\n<div class="page-actions-export btn-group">\n  <button type="button" class="btn btn-'),__append(type),__append(' dropdown-toggle" data-toggle="dropdown" '),__append(disabled?"disabled":""),__append('>\n    <i class="fa fa-download"></i><span>'),__append(label),__append('</span> <span class="caret"></span>\n  </button>\n  <ul class="dropdown-menu dropdown-menu-right">\n    '),_.forEach(formats,function(e){__append('\n    <li><a data-export-type="'),__append(e.type),__append('" href="'),__append(escapeFn(e.href)),__append('">'),__append(t("core","PAGE_ACTION:export:"+e.type)),__append("</a></li>\n    ")}),__append("\n  </ul>\n</div>\n")),__append("\n");return __output}}),define("app/core/util/pageActions",["underscore","jquery","app/i18n","app/viewport","../views/ActionFormView","app/core/templates/jumpAction","app/core/templates/exportAction"],function(e,t,n,i,r,o,a){"use strict";function s(e,t,n,i){if(!1===n)return null;var r=t.model||t.constructor,o=r.can&&(r.can[e]||r.can.manage);return o?o.bind(r,t,e):n||t.getPrivilegePrefix()+":"+(i||"MANAGE")}function u(e,r){r||(r=i.msg.show({type:"warning",text:n("core","MSG:EXPORTING"),sticky:!0}));var o=t.ajax({url:e});return o.fail(function(){i.msg.hide(r,!0),i.msg.show({type:"error",time:2500,text:n("core","MSG:EXPORTING_FAILURE")})}),o.done(function(e){i.msg.hide(r),window.open("/express/exports/"+e)}),o}function c(e,t,i){var r=e.getNlsDomain();return n.bound(n.has(r,t)?r:"core",t,i)}return{add:function(e,t){return{id:"add",label:c(e,"PAGE_ACTION:add"),icon:"plus",href:e.genClientUrl("add"),privileges:s("add",e,t)}},edit:function(e,t){return{id:"edit",label:c(e,"PAGE_ACTION:edit"),icon:"edit",href:e.genClientUrl("edit"),privileges:s("edit",e,t)}},delete:function(t,n,i){return i||(i={}),{id:"delete",label:c(t,"PAGE_ACTION:delete"),icon:"times",href:t.genClientUrl("delete"),privileges:s("delete",t,n),callback:function(n){n&&0!==n.button||(n&&n.preventDefault(),r.showDeleteDialog(e.defaults({model:t},i)))}}},export:function(n,i,r,o){var l={layout:n,page:i,collection:r||i&&i.collection||null,privileges:o,maxCount:6e4};1===arguments.length&&e.assign(l,n);var d=function(){var t,n=(t=l.collection).paginationData?t.paginationData.get("totalCount"):t.length,i=e.result(l.collection,"url"),r=i.indexOf("?");-1===r?i+=";export.${format}?"+l.collection.rqlQuery:i=i.substring(0,r)+";export.${format}"+i.substring(r);var o=[{type:"csv",href:i.replace("${format}","csv")}];return window.XLSX_EXPORT&&n<l.maxCount/2&&o.push({type:"xlsx",href:i.replace("${format}","xlsx")}),(l.template||a)({type:n>=l.maxCount/2?"danger":n>=l.maxCount/4?"warning":"default",formats:o,disabled:n>=l.maxCount||0===n,label:l.label||c(l.collection,"PAGE_ACTION:export")})};return l.page.listenTo(l.collection,"sync",function(){l.layout.$(".page-actions-export").replaceWith(d()),p(l.layout.$(".page-actions-export"))}),{id:"export",template:d,privileges:s("view",l.collection,l.privileges,"VIEW"),callback:l.callback,afterRender:p};function p(e){!function(e){var t=e.find(".page-actions-export");t.hasClass("btn-group")&&(t=t.find('a[data-export-type="csv"]'));if(!t.length)return;var n=t.prop("href");t.prop("href","javascript:void(0)"),t.on("click",function(e){e.preventDefault(),window.open(n)})}(e),function(e){var n=e.find('a[data-export-type="xlsx"]');if(!n.length)return;n.each(function(){var e=t(this),n=e.prop("href");e.prop("href","javascript:void(0)"),e.on("click",function(e){e.preventDefault(),u(n)})})}(e)}},exportXlsx:u,jump:function(t,n,r){return r=e.assign({mode:"rid",pattern:"^ *[0-9]+ *$",autoFocus:!window.IS_MOBILE,width:150,browse:!1},r),{id:"jump",template:function(){return o({title:r.title||c(n,"PAGE_ACTION:jump:title"),placeholder:r.placeholder||c(n,"PAGE_ACTION:jump:placeholder"),autoFocus:r.autoFocus,pattern:r.pattern,width:r.width})},afterRender:function(o){var a=o.find("form");a.submit(function(t,n,r,o){var a=r[0].phrase;if(a.readOnly)return!1;var s=o.prepareId?o.prepareId(a.value):a.value;a.readOnly=!0;var u=r.find(".fa").removeClass("fa-search").addClass("fa-spinner fa-spin"),l=t.ajax("rid"===o.mode?{url:e.result(n,"url")+";rid",data:{rid:s}}:{method:"GET",url:e.result(n,"url")+"/"+s+"?select(rid)"});return l.done(function(e){var i=s;"rid"===o.mode?i=e:e._id?i=e._id:e.rid&&(i=e.rid),t.broker.publish("router.navigate",{url:n.genClientUrl()+"/"+i,trigger:!0})}),l.fail(function(){i.msg.show({type:"error",time:2e3,text:c(n,"MSG:jump:404",{rid:s})}),u.removeClass("fa-spinner fa-spin").addClass("fa-search"),a.readOnly=!1,a.select()}),!1}.bind(null,t,n,a,r))}}}}}),define("app/core/util/onModelDeleted",["app/i18n","app/viewport"],function(e,t){"use strict";return function(n,i,r,o){var a=r?r.model:null;(o||a&&a._id===i.id)&&(n.subscribe("router.executing").setLimit(1).on("message",function(){var n=i.getNlsDomain();t.msg.show({type:"warning",time:5e3,text:e(e.has(n,"MSG:DELETED")?n:"core","MSG:DELETED",{label:i.getLabel()})})}),n.publish("router.navigate",{url:i.genClientUrl("base"),trigger:!0,replace:!0}))}}),define("app/core/views/DetailsView",["underscore","app/i18n","../View","../util/onModelDeleted"],function(e,t,n,i){"use strict";return n.extend({remoteTopics:function(){var e={},t=this.model.getTopicPrefix();return e[t+".edited"]="onModelEdited",e[t+".deleted"]="onModelDeleted",e},initialize:function(){n.prototype.initialize.apply(this,arguments),this.once("afterRender",function(){this.listenTo(this.model,"change",this.onModelChanged)})},serialize:function(){var i=this.model.getNlsDomain();return e.assign(n.prototype.serialize.apply(this,arguments),{panelTitle:t(t.has(i,"PANEL:TITLE:details")?i:"core","PANEL:TITLE:details"),model:this.serializeDetails(this.model)})},serializeDetails:function(e){return"function"==typeof e.serializeDetails?e.serializeDetails():"function"==typeof e.serialize?e.serialize():e.toJSON()},editModel:function(e){this.model.set(e)},onModelEdited:function(e){var t=this.model.parse?this.model.parse(e.model):e.model;t&&t._id===this.model.id&&this.editModel(t)},onModelDeleted:function(e){i(this.broker,this.model,e)},onModelChanged:function(){this.render()}})}),define("app/core/pages/createPageBreadcrumbs",["underscore","app/i18n","app/data/localStorage"],function(e,t,n){"use strict";function i(e,n){return t.bound(t.has(e,n)?e:"core",n)}return function(t,r){var o=t.modelProperty?t[t.modelProperty]:t.model||t.collection,a=o.getNlsDomain();if(r=Array.isArray(r)?r.map(function(e){return"string"==typeof e?{label:":"===e[0]?i(a,"BREADCRUMB"+e):e}:("string"==typeof e.label&&":"===e.label[0]&&(e.label=i(a,"BREADCRUMB"+e.label)),e)}):[],!1!==t.browseBreadcrumb){var s=r.length?o.genClientUrl("base"):null;if(s){var u=window.location.origin+window.location.pathname+s,c=e.find(JSON.parse(n.getItem("WMES_RECENT_LOCATIONS")||"[]"),function(e){if(0!==e.href.indexOf(u))return!1;var t=e.href.charAt(u.length);return""===t||"?"===t});if(c){var l=c.href.split("?")[1];l&&(-1===s.indexOf("?")?s+="?"+l:s+="&"+l)}}r.unshift({label:i(a,e.result(t,"browseBreadcrumb")||"BREADCRUMB:browse"),href:s})}if(!0===t.baseBreadcrumb)r.unshift(i(a,"BREADCRUMB:base"));else if(t.baseBreadcrumb){var d=e.result(t,"baseBreadcrumb");Array.isArray(d)?r.unshift.apply(r,d):r.unshift({label:i(a,"BREADCRUMB:base"),href:String(d)})}return r}}),define("app/core/pages/DetailsPage",["app/i18n","../util/bindLoadingMessage","../util/pageActions","../View","../views/DetailsView","./createPageBreadcrumbs"],function(e,t,n,i,r,o){"use strict";return i.extend({layoutName:"page",pageId:"details",modelProperty:"model",baseBreadcrumb:!1,breadcrumbs:function(){var t=this[this.modelProperty];return o(this,[t.getLabel()||e.bound(t.getNlsDomain(),"BREADCRUMB:details")])},actions:function(){var e=this[this.modelProperty];return[n.edit(e,e.privilegePrefix+":MANAGE"),n.delete(e,e.privilegePrefix+":MANAGE")]},initialize:function(){this.defineModels(),this.defineViews()},defineModels:function(){this[this.modelProperty]=t(this.options.model,this)},defineViews:function(){this.view=new(this.getViewClass())(this.getViewOptions())},load:function(e){var t=this[this.modelProperty];return t.isSynced&&t.isSynced()?e():e(t.fetch(this.fetchOptions))},getViewClass:function(){return this.DetailsView||r},getViewOptions:function(){var e={model:this[this.modelProperty]};return"function"==typeof this.detailsTemplate&&(e.template=this.detailsTemplate),"function"==typeof this.serializeDetails&&(e.serializeDetails=this.serializeDetails),e}})}),define("app/core/util/isElementInView",["jquery"],function(e){"use strict";var t=e(window);return function(n,i){var r=t.scrollTop(),o=r+t.height(),a=e(n),s=a.offset().top,u=i&&i.height||a.height(),c=i.bottom||s+u;return i&&!0===i.fullyInView?r<s&&o>c:s<=o&&c>=r}}),function(){var e=["direction","boxSizing","width","height","overflowX","overflowY","borderTopWidth","borderRightWidth","borderBottomWidth","borderLeftWidth","borderStyle","paddingTop","paddingRight","paddingBottom","paddingLeft","fontStyle","fontVariant","fontWeight","fontStretch","fontSize","fontSizeAdjust","lineHeight","fontFamily","textAlign","textTransform","textIndent","textDecoration","letterSpacing","wordSpacing","tabSize","MozTabSize"],t="undefined"!=typeof window,n=t&&null!=window.mozInnerScreenX;function i(i,r,o){if(!t)throw new Error("textarea-caret-position#getCaretCoordinates should only be called in a browser");var a=o&&o.debug||!1;if(a){var s=document.querySelector("#input-textarea-caret-position-mirror-div");s&&s.parentNode.removeChild(s)}var u=document.createElement("div");u.id="input-textarea-caret-position-mirror-div",document.body.appendChild(u);var c=u.style,l=window.getComputedStyle?window.getComputedStyle(i):i.currentStyle,d="INPUT"===i.nodeName;c.whiteSpace="pre-wrap",d||(c.wordWrap="break-word"),c.position="absolute",a||(c.visibility="hidden"),e.forEach(function(e){if(d&&"lineHeight"===e)if("border-box"===l.boxSizing){var t=parseInt(l.height),n=parseInt(l.paddingTop)+parseInt(l.paddingBottom)+parseInt(l.borderTopWidth)+parseInt(l.borderBottomWidth),i=n+parseInt(l.lineHeight);c.lineHeight=t>i?t-n+"px":t===i?l.lineHeight:0}else c.lineHeight=l.height;else c[e]=l[e]}),n?i.scrollHeight>parseInt(l.height)&&(c.overflowY="scroll"):c.overflow="hidden",u.textContent=i.value.substring(0,r),d&&(u.textContent=u.textContent.replace(/\s/g," "));var p=document.createElement("span");p.textContent=i.value.substring(r)||".",u.appendChild(p);var f={top:p.offsetTop+parseInt(l.borderTopWidth),left:p.offsetLeft+parseInt(l.borderLeftWidth),height:parseInt(l.lineHeight)};return i.scrollLeft&&(f.left=f.left-i.scrollLeft),i.scrollHeight&&(f.top=f.top-i.scrollTop),a?p.style.backgroundColor="#aaa":document.body.removeChild(u),f}"undefined"!=typeof module&&void 0!==module.exports?module.exports=i:t&&(window.getCaretCoordinates=i)}(),define("getCaretCoordinates",function(e){return function(){return e.getCaretCoordinates}}(this)),define("app/wmes-fap-entries/templates/chat",["underscore","jquery","app/i18n","app/time","app/user","app/core/util/forms"],function(_,$,t,time,user,forms){return function anonymous(locals,escapeFn,include,rethrow){escapeFn=escapeFn||function(e){return void 0==e?"":String(e).replace(_MATCH_HTML,encode_char)};var _ENCODE_HTML_RULES={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&#34;","'":"&#39;"},_MATCH_HTML=/[&<>'"]/g;function encode_char(e){return _ENCODE_HTML_RULES[e]||e}var __output="";function __append(e){void 0!==e&&null!==e&&(__output+=e)}with(locals||{})__append('<div class="fap-chat">\n  <div class="fap-chat-title">'),__append(t("chat:title")),__append('</div>\n  <div id="'),__append(id("messages")),__append('" class="fap-chat-messages">\n    '),model.chat.forEach(function(e){__append("\n    "),__append(renderMessage({message:e})),__append("\n    ")}),__append('\n  </div>\n  <form class="fap-chat-form">\n    <textarea id="'),__append(id("send")),__append('" class="form-control fap-chat-send" rows="1" placeholder="'),__append(t("chat:send")),__append('"></textarea>\n    <button id="'),__append(id("submit")),__append('" class="btn btn-primary fap-chat-submit" type="button">\n      <i class="fa fa-comment"></i><span>'),__append(t("chat:submit")),__append('</span><kbd>Shift+Enter</kbd>\n    </button>\n    <div id="'),__append(id("new")),__append('" class="fap-chat-new-outer hidden">\n      <span class="fap-chat-new-inner">'),__append(t("chat:new")),__append("</span>\n    </div>\n  </form>\n</div>\n");return __output}}),define("app/wmes-fap-entries/templates/chatMessage",["underscore","jquery","app/i18n","app/time","app/user","app/core/util/forms"],function(_,$,t,time,user,forms){return function anonymous(locals,escapeFn,include,rethrow){escapeFn=escapeFn||function(e){return void 0==e?"":String(e).replace(_MATCH_HTML,encode_char)};var _ENCODE_HTML_RULES={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&#34;","'":"&#39;"},_MATCH_HTML=/[&<>'"]/g;function encode_char(e){return _ENCODE_HTML_RULES[e]||e}var __output="";function __append(e){void 0!==e&&null!==e&&(__output+=e)}with(locals||{})__append('<div class="fap-chat-message '),__append(message.user.self?"fap-is-self":""),__append('" data-user-id="'),__append(message.user.id),__append('">\n  <div class="fap-chat-user">'),__append(message.user.label),__append('</div>\n  <div class="fap-chat-lines" style="border-color: '),__append(message.color),__append('">\n    '),message.lines.forEach(function(e){__append('\n    <div class="fap-chat-line" title="'),__append(e.time),__append('">'),__append(e.text),__append("</div>\n    ")}),__append("\n  </div>\n</div>\n");return __output}}),define("app/wmes-fap-entries/views/ChatView",["underscore","jquery","getCaretCoordinates","app/user","app/core/View","app/core/util/transliterate","app/planning/util/contextMenu","app/wmes-fap-entries/templates/chat","app/wmes-fap-entries/templates/chatMessage"],function(e,t,n,i,r,o,a,s,u){"use strict";return r.extend({template:s,events:{"keydown #-send":function(e){var t=e.originalEvent.key;if("Tab"===t)return this.showUserAutocomplete(),!1;if(this.removeAutocompleteUser(t))return!1;var n="Enter"===t,i=n||" "===t,r=""===e.target.value.trim();return i&&r?(this.toggleMultiLine(),!1):this.multiLine||!n||!e.shiftKey||r?this.multiLine&&n&&e.shiftKey?(this.send(),!1):this.multiLine||!n||e.shiftKey?void 0:(this.send(),!1):void this.toggleMultiLine(!0)},"input #-send":function(){this.resizeSend()},"click #-new":function(){var e=this.$id("messages");this.$id("new").addClass("hidden"),e.animate({scrollTop:e[0].scrollHeight},"fast")},"click .fap-chat-attachment":function(e){this.model.trigger("focusAttachment",e.currentTarget.dataset.attachmentId)},"click #-submit":function(){this.send()}},initialize:function(){this.chatScrollTop=-1,this.multiLine=!1,this.listenTo(this.model,"change:changes",this.onChange)},getTemplateData:function(){return{model:this.model.serializeDetails(),renderMessage:u}},afterRender:function(){var e=this.$id("messages");e.length&&(e[0].scrollTop=-1===this.chatScrollTop?9999999:this.chatScrollTop,e.on("scroll",this.onScroll.bind(this))),this.toggleMultiLine(this.multiLine)},toggleMultiLine:function(e){this.multiLine="boolean"==typeof e?e:!this.multiLine,this.$el.toggleClass("fap-chat-multiLine",this.multiLine),this.multiLine&&(this.$id("submit")[0].style.marginLeft=this.$id("submit").outerWidth()/2*-1+"px")},send:function(){var e=this.$id("send"),t=e.val().trim(),n={};e.val(""),this.toggleMultiLine(!1),this.resizeSend(),i.isLoggedIn()&&!this.model.isObserver()&&(n.subscribers=[null,[{id:i.data._id,label:i.getLabel()}]]),this.model.handleChange({date:new Date,user:i.getInfo(),data:n,comment:t}),this.model.update({comment:t})},onChange:function(){if(this.isRendered()){var t=e.last(this.model.get("changes"));t&&t.user&&this.handleChange(t)}},handleChange:function(e){e.data.attachments&&!e.data.attachments[1]&&this.removeAttachments(e.data.attachments[0]);var n=this.model.serializeChatMessage(e);if(n.lines.length){var r=this.$id("messages"),o=this.$(r[0].lastElementChild),a=this.isScrolledToBottom();if(o[0].dataset.userId===e.user.id){var s=o.find(".fap-chat-lines");n.lines.forEach(function(e){t('<div class="fap-chat-line"></div>').attr("title",e.time).html(e.text).appendTo(s)})}else this.renderPartial(u,{message:n}).appendTo(r);a?r[0].scrollTop=r[0].scrollHeight:i.data._id!==e.user.id&&this.$id("new").removeClass("hidden")}},removeAttachments:function(e){var t=this;e.forEach(function(e){t.$('.fap-chat-attachment[data-attachment-id="'+e._id+'"]').css("text-decoration","line-through")})},showUserAutocomplete:function(){for(var e=this,t=e.$id("send")[0],r=t.selectionEnd,s=r-1,u=/^[^a-zA-Z0-9]$/,c=" ",l="";;){if((l=o(t.value.charAt(s)))===c)return;if(0===l.length){s=0;break}if("\udc64"!==l&&u.test(l))break;--s}for(;;){if((l=o(t.value.charAt(r)))===c)return;if(0===l.length){r=t.value.length;break}if(u.test(l))break;++r}var d=t.value.substring(0,s),p=t.value.substring(r),f=o(t.value.substring(s,r)).toUpperCase().replace(/[^A-Z0-9]+/g,"");d.length&&!/[<\[{(\s]$/.test(d.charAt(d.length-1))&&(d+=" "),p.length&&!/^[!?,.>\]})\s]/.test(o(p.charAt(0)))&&(p=" "+p);for(var h=[],m=0===f.length,g={},v=999,y=e.model.get("changes"),_=y.length-1;_>=0;--_){var b=y[_];b.comment&&(g[b.user.id]=v--)}if(e.model.get("observers").forEach(function(n){if(n.user.id!==i.data._id){var r=o(n.user.label).toUpperCase().replace(/[^A-Z0-9]+/g,""),a=m?-1:r.indexOf(f);(m||-1!==a)&&h.push({label:n.user.label,handler:function(n){var i=d+"👤"+n.replace(/\s+/g,c);0===p.length&&(i+=" ");t.value=i+p,t.setSelectionRange(i.length,i.length),e.resizeSend()}.bind(null,n.user.label),score:(g[n.user.id]||0)+(m?0:0===a?100:0)})}}),0!==h.length)if(1!==h.length){h.sort(function(e,t){return e.score===t.score?e.label.localeCompare(t.label,void 0,{numeric:!0,ignorePunctuation:!0}):t.score-e.score}),h.length>10&&(h=h.slice(0,10)).push({disabled:!0,label:"..."});var w=e.$(".fap-chat-form").position(),A=n(t,t.selectionEnd),k=w.top+A.top+A.height,E=w.left+A.left;a.show(e,k,E,{menu:h}),e.broker.subscribe("planning.contextMenu.hidden").setLimit(1).on("message",function(){e.$id("send").focus()})}else h[0].handler()},removeAutocompleteUser:function(e){if("Backspace"!==e&&"Delete"!==e)return!1;var t=this.$id("send")[0],n=t.value,i=t.selectionStart,r=t.selectionEnd;i===r&&("Backspace"===e&&i>0?i-=1:"Delete"===e&&(r+=1));for(var a=/^[^a-zA-Z0-9\u00a0]$/,s=i;s>=0;--s){var u=o(n.charAt(s));if("\udc64"===u){i=s-1;break}if(a.test(u))break}for(var c=r;c>=0;--c){var l=o(n.charAt(c));if("\udc64"===l){for(;r<n.length;++r){var d=o(n.charAt(r));if("\udc64"!==d&&a.test(d))break}break}if(a.test(l))break}return t.value=n.substring(0,i)+n.substring(r),t.setSelectionRange(i,i),this.resizeSend(),!0},isScrolledToBottom:function(){var e=this.$id("messages")[0];return Math.abs(e.scrollHeight-e.scrollTop-e.clientHeight)<5},resizeSend:function(){var e=this.$id("messages"),t=this.$id("send"),n=t[0].offsetHeight,i=parseInt(t.css("minHeight"),10);t.outerHeight(i);var r=!1,o=Math.max(i,t[0].scrollHeight);o>215&&(r=!0,o=215);var a=o-n;e.css("height",563-o),t.outerHeight(o).toggleClass("fap-chat-send-scroll",r),a<0&&this.isScrolledToBottom()||(e[0].scrollTop+=o-n)},onScroll:function(e){this.chatScrollTop=e.target.scrollTop,this.isScrolledToBottom()&&this.$id("new").addClass("hidden")},onResize:function(){this.resizeSend()}})}),define("app/wmes-fap-entries/templates/observers",["underscore","jquery","app/i18n","app/time","app/user","app/core/util/forms"],function(_,$,t,time,user,forms){return function anonymous(locals,escapeFn,include,rethrow){escapeFn=escapeFn||function(e){return void 0==e?"":String(e).replace(_MATCH_HTML,encode_char)};var _ENCODE_HTML_RULES={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&#34;","'":"&#39;"},_MATCH_HTML=/[&<>'"]/g;function encode_char(e){return _ENCODE_HTML_RULES[e]||e}var __output="";function __append(e){void 0!==e&&null!==e&&(__output+=e)}with(locals||{})__append('<div class="fap-observers fap-details-panel '),__append(showMessage?"fap-details-panel-message-show":""),__append('">\n  <div class="fap-details-panel-hd">'),__append(t("PROPERTY:observers")),__append('</div>\n  <div class="fap-details-panel-message message message-inline message-warning">Dodatkowe osoby zostaną automatycznie dodane po eskalacji zgłoszenia.</div>\n  <div class="fap-details-panel-bd fap-details-list">\n    '),observers.forEach(function(e){__append('\n    <div class="fap-observer fap-details-list-item '),__append(e.online?"fap-is-online":""),__append('" data-observer-id="'),__append(e._id),__append('">\n      <span class="fap-details-list-icon" style="color: '),__append(e.color),__append('">\n        <i class="fa fa-user"></i>\n      </span>\n      <span class="fap-details-list-label">'),__append(e.label),__append("</span>\n    </div>\n    ")}),__append('\n    <div style="border-top: 1px solid #ddd">&nbsp;</div>\n  </div>\n  <div class="fap-details-panel-ft" style="display: flex">\n    <input id="'),__append(id("observer")),__append('" type="text">\n    <div id="'),__append(id("quickAdd")),__append('" class="btn-group">\n      <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown" style="margin-left: -1px"><i class="fa fa-plus"></i></button>\n      <ul class="dropdown-menu"></ul>\n    </div>\n  </div>\n</div>\n');return __output}}),define("app/wmes-fap-entries/views/ObserversView",["underscore","app/viewport","app/core/View","app/users/util/setUpUserSelect2","../dictionaries","app/wmes-fap-entries/templates/observers"],function(e,t,n,i,r,o){"use strict";return n.extend({template:o,events:{"change #-observer":function(){var e=this.$id("observer"),t=i.getUserInfo(e);e.select2("data",null),this.addObserver(t)},"click a[data-quick-add]":function(e){e.preventDefault();var t=e.currentTarget.dataset.quickAdd,n=r.settings.getValue("quickUsers",[]).find(function(e){return e._id===t});n.funcs.length?this.loadQuickUsers(n):n.users.length&&this.addQuickUsers(n.users)}},initialize:function(){this.once("afterRender",function(){this.listenTo(this.model,"change:observers",e.debounce(this.onObserversChanged.bind(this),1)),this.listenTo(this.model,"change:presence",this.onPresenceChanged),this.listenTo(this.model,"change:level",this.toggleMessage),this.listenTo(r.settings,"change:value",this.onSettingChanged)})},getTemplateData:function(){return{showMessage:this.isMessageVisible(),observers:this.model.serializeDetails().observers}},afterRender:function(){var e=this.$id("observer"),t=this.model.serializeDetails().auth.observers;i(e,{width:"100%",noPersonnelId:!0,placeholder:this.t("observers:placeholder"+(t?"":":auth"))}),t||(e.select2("enable",!1),this.$id("quickAdd").find(".btn").prop("disabled",!0)),this.updateQuickAdd()},loadQuickUsers:function(e){var n=this;t.msg.loading();var i=n.ajax({url:"/users?select(firstName,lastName,login)&prodFunction=in=("+e.funcs.join(",")+")&limit(100)"});i.fail(function(){t.msg.loadingFailed()}),i.done(function(i){t.msg.loaded();var r={};e.users.forEach(function(e){r[e.id]=e}),(i.collection||[]).forEach(function(e){r[e._id]={id:e._id,label:e.lastName||e.firstName?(e.lastName+" "+e.firstName).trim():e.name||e.login||e._id}}),n.addQuickUsers(Object.values(r))})},addQuickUsers:function(e){var t={};this.model.get("observers").forEach(function(e){t[e.user.id]=!0});var n={};e.forEach(function(e){t[e.id]||n[e.id]||(n[e.id]=e)}),(n=Object.values(n)).length&&this.model.change("subscribers",n,null)},addObserver:function(t){if(!e.some(this.model.get("observers"),function(e){return e.user.id===t.id})){var n=[t];this.model.change("subscribers",n,null)}this.timers.focus=setTimeout(this.focusObserver.bind(this,t.id),1)},focusObserver:function(e){var t=this,n=t.$('.fap-observer[data-observer-id="'+e+'"]');n.length&&(n[0].scrollIntoViewIfNeeded?n[0].scrollIntoViewIfNeeded():n[0].scrollIntoView(),t.$(".highlight").removeClass("highlight"),clearTimeout(this.timers.highlight),this.timers.highlight=setTimeout(function(){(n=t.$('.fap-observer[data-observer-id="'+e+'"]')).addClass("highlight"),t.timers.highlight=setTimeout(function(){n.removeClass("highlight")},1100)},100))},hideUserInfoPopover:function(){this.$(".userInfoPopover").prev().popover("destroy")},isMessageVisible:function(){var e=this.model.serializeDetails();return 0===e.level&&1===e.observers.length},toggleMessage:function(){this.$el.toggleClass("fap-details-panel-message-show",this.isMessageVisible())},updateQuickAdd:function(){var t={};this.model.serializeDetails().observers.forEach(function(e){t[e._id]=!0});var n="";r.settings.getValue("quickUsers",[]).forEach(function(t){n+='<li><a href="#" data-quick-add="'+t._id+'">'+e.escape(t.label)+"</a></li>"}),this.$id("quickAdd").find("ul").html(n),this.$id("quickAdd").find(".btn").prop("disabled",!n.length)},onObserversChanged:function(){var e=this.renderPartial(o,{showMessage:!1,observers:this.model.serializeObservers()}).find(".fap-details-panel-bd");this.$(".fap-details-panel-bd").replaceWith(e),e.on("scroll",this.hideUserInfoPopover.bind(this)),this.toggleMessage(),this.updateQuickAdd()},onPresenceChanged:function(e,t,n){this.$('.fap-observer[data-observer-id="'+n.userId+'"]').toggleClass("fap-is-online",n.online)},onSettingChanged:function(e){/quickUsers$/.test(e.id)&&this.updateQuickAdd()}})}),define("app/wmes-fap-entries/templates/attachments",["underscore","jquery","app/i18n","app/time","app/user","app/core/util/forms"],function(_,$,t,time,user,forms){return function anonymous(locals,escapeFn,include,rethrow){escapeFn=escapeFn||function(e){return void 0==e?"":String(e).replace(_MATCH_HTML,encode_char)};var _ENCODE_HTML_RULES={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&#34;","'":"&#39;"},_MATCH_HTML=/[&<>'"]/g;function encode_char(e){return _ENCODE_HTML_RULES[e]||e}var __output="";function __append(e){void 0!==e&&null!==e&&(__output+=e)}with(locals||{})__append('<div class="fap-attachments fap-details-panel">\n  <div class="fap-details-panel-hd">\n    '),__append(t("PROPERTY:attachments")),__append('\n    <button id="'),__append(id("upload")),__append('" type="button" class="btn btn-link" title="'),__append(helpers.t("attachments:upload")),__append('"><i class="fa fa-upload"></i></button>\n    <input id="'),__append(id("files")),__append('" type="file" multiple tabindex="-1">\n  </div>\n  <div id="'),__append(id("attachments")),__append('" class="fap-details-panel-bd fap-details-list">\n    <div style="border-top: 1px solid #ddd">&nbsp;</div>\n  </div>\n  <div id="'),__append(id("preview")),__append('" class="fap-attachment-preview hidden">\n    <span class="fap-attachment-preview-label"></span>\n    <img class="fap-attachment-preview-image">\n  </div>\n</div>\n');return __output}}),define("app/wmes-fap-entries/templates/attachment",["underscore","jquery","app/i18n","app/time","app/user","app/core/util/forms"],function(_,$,t,time,user,forms){return function anonymous(locals,escapeFn,include,rethrow){escapeFn=escapeFn||function(e){return void 0==e?"":String(e).replace(_MATCH_HTML,encode_char)};var _ENCODE_HTML_RULES={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&#34;","'":"&#39;"},_MATCH_HTML=/[&<>'"]/g;function encode_char(e){return _ENCODE_HTML_RULES[e]||e}var __output="";function __append(e){void 0!==e&&null!==e&&(__output+=e)}with(locals||{})__append('<div class="fap-attachment fap-details-list-item" data-attachment-id="'),__append(attachment._id),__append('" data-preview="'),__append(attachment.preview?"1":"0"),__append('">\n  <span class="fap-details-list-icon">\n    <i class="fa '),__append(uploaded?attachment.icon:"fa-spinner fa-spin"),__append('"></i>\n  </span>\n  '),uploaded?(__append('\n  <a class="fap-details-list-label" href="/fap/entries/'),__append(entryId),__append("/attachments/"),__append(attachment._id),__append('" target="_blank">'),__append(escapeFn(attachment.label)),__append("</a>\n  ")):(__append('\n  <span class="fap-details-list-label">'),__append(escapeFn(attachment.label)),__append("</span>\n  ")),__append('\n  <button class="fap-details-list-action" type="button" data-action="'),__append(uploaded?"showMenu":"removeUpload"),__append('" '),__append(uploaded&&!attachment.menu?"disabled":""),__append('><i class="fa '),__append(uploaded?"fa-wrench":"fa-times"),__append('"></i></button>\n</div>');return __output}}),define("app/wmes-fap-entries/views/AttachmentsView",["underscore","jquery","app/user","app/viewport","app/core/View","app/core/util/uuid","app/planning/util/contextMenu","app/wmes-fap-entries/templates/attachments","app/wmes-fap-entries/templates/attachment"],function(e,t,n,i,r,o,a,s,u){"use strict";return r.extend({template:s,events:{'mouseenter .fap-attachment[data-preview="1"]':function(e){this.showPreview(e.currentTarget.dataset.attachmentId)},"mouseleave .fap-attachment":function(){this.hidePreview()},mouseleave:function(){this.hidePreview()},'click [data-action="removeUpload"]':function(e){var t=this.$(e.target).closest(".fap-attachment")[0].dataset.attachmentId,n=this.model;return n.uploading&&n.uploading.upload._id===t?(n.uploading.abort(),n.uploading=null):(n.uploadQueue=n.uploadQueue.filter(function(e){return e._id!==t}),n.uploadedFiles=n.uploadedFiles.filter(function(e){return e._id!==t})),this.removeAttachment(t),!1},'click [data-action="showMenu"]':function(e){var t=this.$(e.target).closest(".fap-attachment"),i=this.findAttachment(t[0].dataset.attachmentId),r=[{icon:"fa-edit",label:this.t("attachments:menu:rename"),handler:this.handleRenameAttachment.bind(this,i._id)}];return(n.isAllowedTo("FAP:MANAGE")||i.user&&i.user.id===n.data._id)&&r.push({icon:"fa-times",label:this.t("attachments:menu:remove"),handler:this.handleRemoveAttachment.bind(this,i._id)}),a.show(this,e.pageY,e.pageX,r),!1},"click #-upload":function(){this.$id("files").click()},"change #-files":function(e){e.target.files.length&&this.upload(e.target.files)}},initialize:function(){var n=this.model;n.uploadQueue||(n.uploadQueue=[],n.uploading=null,n.uploadedFiles=[]),this.listenTo(n,"focusAttachment",this.focusAttachment),this.listenTo(n,"change:attachments",e.debounce(this.renderAttachments.bind(this),1)),t(window).on("keydown."+this.idPrefix,this.onKeyDown.bind(this)).on("paste."+this.idPrefix,this.onPaste.bind(this))},destroy:function(){t(document.body).off("."+this.idPrefix),t(window).off("."+this.idPrefix)},afterRender:function(){this.$(".fap-details-panel-bd").on("scroll",this.hideEditor.bind(this)),this.$id("upload").toggleClass("hidden",!this.model.serializeDetails().auth.attachments),this.setUpDnd(),this.renderAttachments()},setUpDnd:function(){var e=this,n="drag dragstart dragend dragover dragenter dragleave drop".split(" ").map(function(t){return t+"."+e.idPrefix}).join(" ");t(document.body).on(n,e.onDrag.bind(e)).on("drop."+e.idPrefix,e.onDrop.bind(e))},renderAttachments:function(){var e=this,t=e.$id("attachments"),n=t.children().last();t.find(".fap-attachment").remove(),e.model.serializeDetails().attachments.forEach(function(t){e.renderAttachment(t,!0).insertBefore(n)}),e.model.uploadedFiles.forEach(function(t){e.renderAttachment(t,!0).insertBefore(n)}),e.model.uploading&&e.renderAttachment(e.model.uploading.upload,!1).insertBefore(n),e.model.uploadQueue.forEach(function(t){e.renderAttachment(t,!1).insertBefore(n)}),e.attachmentToRename&&(e.handleRenameAttachment(e.attachmentToRename),e.attachmentToRename=null)},renderAttachment:function(e,t){return this.renderPartial(u,{entryId:this.model.id,uploaded:t,attachment:e})},findAttachment:function(t){var n=this.model,i=e.findWhere(n.get("attachments"),{_id:t});if(i)return i;if(n.uploading&&n.uploading.upload._id===t)return n.uploading.upload;for(var r=0;r<n.uploadedFiles.length;++r)if(n.uploadedFiles[r]._id===t)return n.uploadedFiles[r];for(var o=0;o<n.uploadQueue.length;++o)if(n.uploadQueue[o]._id===t)return n.uploadQueue[o];return null},showPreview:function(e){var t=this.findAttachment(e);if(t){var n=this.$id("preview").removeClass("hidden").attr("data-attachment-id",e);n.find("span").text(t.name),n.find("img").prop("src",t.src||"/fap/entries/"+this.model.id+"/attachments/"+e)}},hidePreview:function(e){e&&this.$id("preview").attr("data-attachment-id")!==e||this.$id("preview").addClass("hidden")},focusAttachment:function(e){var t=this.$('.fap-attachment[data-attachment-id="'+e+'"]');t.length&&(t[0].scrollIntoViewIfNeeded?t[0].scrollIntoViewIfNeeded():t[0].scrollIntoView(),this.$(".highlight").removeClass("highlight"),clearTimeout(this.timers.highlight),t.addClass("highlight"),this.timers.highlight=setTimeout(function(){t.removeClass("highlight")},1100),"1"===t[0].dataset.preview&&this.showPreview(e))},onKeyDown:function(e){"Escape"===e.originalEvent.key&&this.hidePreview()},onPaste:function(e){var t=e.originalEvent.clipboardData;t&&t.files&&t.files.length&&t.items.length===t.files.length&&this.upload(t.files,!0)},onDrag:function(e){e.preventDefault(),e.stopPropagation()},onDrop:function(e){var t=e.originalEvent.dataTransfer;return t&&t.files&&t.files.length&&this.upload(t.files,!1),!1},upload:function(t,n){var r=this;if(r.model.serializeDetails().auth.attachments){var a=r.model,s={};(a.get("attachments")||[]).forEach(function(e){s[e.name+e.size]=!0}),a.uploading&&(s[a.uploading.upload.name+a.uploading.upload.file.size]=!0),a.uploadQueue.forEach(function(e){s[e.name+e.file.size]=!0}),a.uploadedFiles.forEach(function(e){s[e.name+e.file.size]=!0});var u=Array.prototype.slice.call(t).filter(function(e){return!s[e.name+e.size]&&(s[e.name+e.size]=!0,!0)});if(u.length){if((a.uploading?1:0)+a.uploadQueue.length+a.uploadedFiles.length+u.length>5)return i.msg.show({type:"warning",time:2500,text:r.t("upload:tooMany",{max:5})}),!1;var c=r.$id("attachments").children().last();u.forEach(function(t){a.uploadQueue.push({_id:o(),type:t.type,name:t.name,file:t,src:0===t.type.indexOf("image/")?URL.createObjectURL(t):null,rename:n&&1===u.length&&0===t.type.indexOf("image/")}),r.renderAttachment(r.model.serializeAttachment(e.last(a.uploadQueue)),!1).insertBefore(c)}),a.uploading||r.uploadNext()}}else i.msg.show({type:"warning",time:2500,text:r.t("upload:auth")})},uploadNext:function(){var e=this,t=e.model,n=t.uploadQueue.shift();if(!n)return e.saveUploads();e.$id("submit").prop("disabled",!0);var r=e.$id("attachments"),o=new FormData;o.append("file",n.file),t.uploading=e.ajax({type:"POST",url:"/fap/entries;upload",data:o,processData:!1,contentType:!1}),t.uploading.upload=n,t.uploading.fail(function(){e.removeAttachment(n._id),"abort"!==t.uploading.statusText&&i.msg.show({type:"error",time:2500,text:e.t("upload:failure",{file:n.file.name})})}),t.uploading.done(function(e){r.find('[data-attachment-id="'+n._id+'"]').find(".fa-spin").removeClass("fa-spin"),n.hash=e,t.uploadedFiles.push(n)}),t.uploading.always(function(){t.uploading=null,e.uploadNext()})},removeAttachment:function(e){this.hidePreview(e),this.$id("attachments").find('[data-attachment-id="'+e+'"]').remove()},saveUploads:function(){var e=this;if(e.model.uploadedFiles.length){var t=(new Date).toISOString(),i=n.getInfo(),r=e.model.uploadedFiles.map(function(n){return n.rename&&(e.attachmentToRename=n.hash),{_id:n.hash,date:t,user:i,type:n.file.type,size:n.file.size,name:n.name}});e.model.uploadedFiles=[],e.model.change("attachments",r,null)}},hideEditor:function(){this.$(".fap-editor").length&&this.model.trigger("editor:hide")},handleRenameAttachment:function(e){this.model.trigger("editor:show",this.$('[data-attachment-id="'+e+'"]'),"attachment")},handleRemoveAttachment:function(e){var t=[this.findAttachment(e)];this.model.handleChange({date:new Date,user:n.getInfo(),data:{attachments:[t,null]},comment:""}),this.model.update({attachments:t})}})}),define("app/notifications",["underscore","jquery","app/broker","app/i18n"],function(e,t,n,i){"use strict";var r=null,o=window.Notification,a=window.SERVICE_WORKER?window.navigator.serviceWorker:null,s={},u={userAction:function(e){s[e.userAction]&&s[e.userAction](e)}};function c(){d({action:"getClientId"},function(e,t){if(e)return/No active/.test(e.message)?setTimeout(l,3e3):setTimeout(c,3e3),console.error("Failed to get the client ID: %s",e.message);r=t.clientId})}function l(){window.navigator.serviceWorker.register(window.SERVICE_WORKER).then(function(){console.log("[sw] Registered!"),setTimeout(c,100)}).catch(function(e){console.error("[sw] Failed to register:",e),setTimeout(l,5e3)})}function d(e,t){var n=setTimeout(i.bind(null,new Error("Timeout.")),e.timeout||1e3);function i(e,i){null!==n&&(clearTimeout(n),n=null,t(e,i))}a.ready.then(function(t){if(!t.active)return"development"===window.ENV&&console.log("[sw] Inactive registration:",t),i(new Error("No active registration!"));var n=new MessageChannel;n.port1.onmessage=function(e){i(e.data.error,e.data.result)},t.active.postMessage(e,[n.port2])})}return o&&a&&(a.addEventListener("message",function(e){var t=e.data&&e.data.action&&e.data.action.split(".")||[];"notifications"===t[0]&&u[t[1]]&&u[t[1]](e.data)}),c()),window.notifications={messageHandlers:u,userActions:s,renderRequest:function(){a&&o&&"granted"!==o.permission&&"denied"!==o.permission&&a.ready.then(function(){var e=t('<div class="message message-inline message-warning notifications-request"></div>').append("<p>"+i("core","notifications:request:message")+"</p>");e.on("click",function(){"default"===o.permission?o.requestPermission().then(function(t){"granted"===t?window.location.reload():"default"!==t&&e.remove()}):e.remove()}),t(".bd").prepend(e)})},show:function(e){return o&&"granted"===o.permission?(e.data||(e.data={}),new Promise(function(t,n){if(!e.scoreClient)return i();function i(){a.ready.then(function(i){if(!i.active)return n(new Error("No active SW."));i.showNotification(e.title,e).then(t,n)}).catch(n)}d({action:"getClients",filter:null},function(o,a){if(o)return n(o);if(!a.length)return i();var s=a.map(function(t){return{clientId:t._id,score:e.scoreClient(t)}});return s.sort(function(e,t){return t.score-e.score}),s[s.length-1].score<0?t(null):s[0].clientId!==r?t(null):(e.data.bestClientId=s[0].clientId,void i())})})):Promise.reject(new Error("Unsupported or disabled."))},close:function(t){if(!a)return Promise.reject(new Error("Unsupported."));a.ready.then(function(e){return e.getNotifications()}).then(function(n){n.forEach(function(n){if(Array.isArray(t)&&t.length){if(n.tag){var i=n.tag.split(" ");e.every(t,function(e){return i.includes(e)})&&n.close()}}else n.close()})}).catch(function(e){console.error("[notifications] Failed to close.",{tags:t,error:e})})}}}),function(e,t){"function"==typeof define&&define.amd?define("form2js",t):e.form2js=t()}(this,function(){"use strict";function e(e,i,r){var o=n(e,i,r);return o.length>0?o:t(e,i,r)}function t(e,t,i){for(var r=[],o=e.firstChild;o;)r=r.concat(n(o,t,i)),o=o.nextSibling;return r}function n(e,n,r){var o,a,s,u=function(e,t){return e.name&&""!=e.name?e.name:t&&e.id&&""!=e.id?e.id:""}(e,r);return(o=n&&n(e))&&o.name?s=[o]:""!=u&&e.nodeName.match(/INPUT|TEXTAREA/i)?s=[{name:u,value:a=i(e)}]:""!=u&&e.nodeName.match(/SELECT/i)?(a=i(e),s=[{name:u.replace(/\[\]$/,""),value:a}]):s=t(e,n,r),s}function i(e){if(e.disabled)return null;switch(e.nodeName){case"INPUT":case"TEXTAREA":switch(e.type.toLowerCase()){case"radio":if(e.checked&&"false"===e.value)return!1;case"checkbox":if(e.checked&&"true"===e.value)return!0;if(!e.checked&&"true"===e.value)return!1;if(e.checked)return e.value;break;case"button":case"reset":case"submit":case"image":return"";default:return e.value}break;case"SELECT":return function(e){var t,n,i,r=[];if(!e.multiple)return e.value;for(t=e.getElementsByTagName("option"),n=0,i=t.length;n<i;n++)t[n].selected&&r.push(t[n].value);return r}(e)}return null}return function(t,n,i,r,o){void 0!==i&&null!=i||(i=!0),void 0!==n&&null!=n||(n="."),arguments.length<5&&(o=!1);var a,s=[],u=0;if((t="string"==typeof t?document.getElementById(t):t).constructor==Array||"undefined"!=typeof NodeList&&t.constructor==NodeList)for(;a=t[u++];)s=s.concat(e(a,r,o));else s=e(t,r,o);return function(e,t,n){var i,r,o,a,s,u,c,l,d,p,f,h,m,g={},v={};for(i=0;i<e.length;i++)if(s=e[i].value,!t||""!==s&&null!==s){for(h=e[i].name,m=h.split(n),u=[],c=g,l="",r=0;r<m.length;r++)if((f=m[r].split("][")).length>1)for(o=0;o<f.length;o++)if(0==o?f[o]=f[o]+"]":o==f.length-1?f[o]="["+f[o]:f[o]="["+f[o]+"]",p=f[o].match(/([a-z_]+)?\[([a-z_][a-z0-9_]+?)\]/i))for(a=1;a<p.length;a++)p[a]&&u.push(p[a]);else u.push(f[o]);else u=u.concat(f);for(r=0;r<u.length;r++)(f=u[r]).indexOf("[]")>-1&&r==u.length-1?(d=f.substr(0,f.indexOf("[")),l+=d,c[d]||(c[d]=[]),c[d].push(s)):f.indexOf("[")>-1?(d=f.substr(0,f.indexOf("[")),p=f.replace(/(^([a-z_]+)?\[)|(\]$)/gi,""),v[l+="_"+d+"_"+p]||(v[l]={}),""==d||c[d]||(c[d]=[]),r==u.length-1?""==d?(c.push(s),v[l][p]=c[c.length-1]):(c[d].push(s),v[l][p]=c[d][c[d].length-1]):v[l][p]||(/^[a-z_]+\[?/i.test(u[r+1])?c[d].push({}):c[d].push([]),v[l][p]=c[d][c[d].length-1]),c=v[l][p]):(l+=f,r<u.length-1?(c[f]||(c[f]={}),c=c[f]):c[f]=s)}return g}(s,i,n)}}),function(e,t){"function"==typeof define&&define.amd?define("js2form",t):e.js2form=t()}(this,function(){"use strict";var e=/^\[\d+?\]/,t=/^[a-zA-Z_][a-zA-Z_0-9]*/,n=/\[[0-9]+?\]$/,i=/(.*)(\[)([0-9]*)(\])$/,r=/\[([0-9]+)\]\[([0-9]+)\]/g,o=/INPUT|TEXTAREA/i;function a(e,t){var n,i,r;if(e instanceof Array)for(i=0;i<e.length;i++)String(e[i].value)==String(t)&&(e[i].checked=!0);else if(o.test(e.nodeName)&&"file"!==e.type)e.value=t;else if(/SELECT/i.test(e.nodeName))for(i=0,r=(n=e.getElementsByTagName("option")).length;i<r;i++)if(n[i].value==t){if(n[i].selected=!0,e.multiple)break}else e.multiple||(n[i].selected=!1)}function s(e,t,n){var o,a,s,u,c,l=[],d=e.split(t);for(e=e.replace(r,"[$1].[$2]"),c=0;c<d.length;c++)o=d[c],l.push(o),null!=o.match(i)&&(s=(a=l.join(t)).replace(i,"$3"),void 0===n[a=a.replace(i,"$1")]&&(n[a]={lastIndex:-1,indexes:{}}),""!=s&&void 0!==n[a].indexes[s]||(n[a].lastIndex++,n[a].indexes[s]=n[a].lastIndex),u=n[a].indexes[s],l[l.length-1]=o.replace(i,"$1$2"+u+"$4"));return a=(a=l.join(t)).replace("].[","][")}function u(e,t){var n,i,r=[];if(1==arguments.length&&(t=0),null==e)r=[{name:"",value:null}];else if("string"==typeof e||"number"==typeof e||"date"==typeof e||"boolean"==typeof e)r=[{name:"",value:e}];else if(e instanceof Array)for(n=0;n<e.length;n++)i="["+n+"]",r=r.concat(c(e[n],i,t+1));else for(n in e)i=n,r=r.concat(c(e[n],i,t+1));return r}function c(n,i,r){var o,a,s,c=[],l=u(n,r+1);for(a=0;a<l.length;a++)o=i,e.test(l[a].name)?o+=l[a].name:t.test(l[a].name)&&(o+="."+l[a].name),s={name:o,value:l[a].value},c.push(s);return c}return function(e,t,i,r,o,c){var l,d;arguments.length<3&&(i="."),arguments.length,arguments.length<5&&(o=!1),l=u(t),d=function e(t,i,r,o,a){arguments.length<4&&(o={});for(var u,c,l,d,p,f,h,m={},g=t.firstChild;g;){if(u="",g.name&&""!=g.name?u=g.name:i&&g.id&&""!=g.id&&(u=g.id),""==u){var v=e(g,i,r,o,a);for(l in v)if(void 0===m[l])m[l]=v[l];else for(d=0;d<v[l].length;d++)m[l].push(v[l][d])}else if(/SELECT/i.test(g.nodeName))for(p=0,h=g.getElementsByTagName("option"),f=h.length;p<f;p++)a&&(h[p].selected=!1),c=(c=s(u,r,o)).replace(n,"[]"),m[c]=g;else/INPUT/i.test(g.nodeName)&&/CHECKBOX|RADIO/i.test(g.type)?(a&&(g.checked=!1),c=(c=s(u,r,o)).replace(n,"[]"),m[c]||(m[c]=[]),m[c].push(g)):(a&&(g.value=""),c=s(u,r,o),m[c]=g);g=g.nextSibling}return m}(e,o,i,{},!1!==c);for(var p=0;p<l.length;p++){var f=l[p].name,h=l[p].value;void 0!==d[f]?a(d[f],h):void 0!==d[f.replace(n,"[]")]&&a(d[f.replace(n,"[]")],h)}}}),define("app/core/views/FormView",["underscore","form2js","js2form","app/viewport","../Model","../View"],function(e,t,n,i,r,o){"use strict";return o.extend({events:{submit:"submitForm"},$errorMessage:null,updateOnChange:!0,initialize:function(){var e=this;e.$errorMessage=null,e.model||(e.model=new r),e.once("afterRender",function(){e.listenTo(e.model,"change",function(){e.updateOnChange&&n(e.el,e.serializeToForm(!0),".",null,!1,!1)})})},destroy:function(){this.hideErrorMessage()},serialize:function(){var t=this.options;return e.assign(o.prototype.serialize.apply(this,arguments),{editMode:!!t.editMode,formMethod:t.formMethod,formAction:t.formAction,formActionText:t.formActionText,panelTitleText:t.panelTitleText,model:this.serializeModel()})},afterRender:function(){n(this.el,this.serializeToForm(!1))},serializeModel:function(){return this.model.toJSON()},serializeToForm:function(e){return this.model.serializeForm?this.model.serializeForm():this.model.toJSON()},serializeForm:function(e){return e},getFormData:function(){return this.serializeForm(t(this.el))},getSubmitButtons:function(){var e=this.$(".form-actions");return e.length||(e=this.$(".panel-footer")),e.find(".btn:not(.cancel)")},submitForm:function(e){if(this.hideErrorMessage(),!this.el.checkValidity()&&!1!==e)return!1;var t=this.getFormData();if(!this.checkValidity(t))return this.handleInvalidity(t),!1;var n=this.getSubmitButtons().prop("disabled",!0);return this.submitRequest(n,t),!1},submitRequest:function(e,t){var n=this.request(t);n.done(this.handleSuccess.bind(this)),n.fail(this.handleFailure.bind(this)),n.always(function(){e.prop("disabled",!1)})},request:function(e){return this.promised(this.model.save(e,this.getSaveOptions()))},checkValidity:function(e){return!!e},handleInvalidity:function(){},handleSuccess:function(){"function"==typeof this.options.done?this.options.done(!0):this.broker&&this.broker.publish("router.navigate",{url:this.model.genClientUrl(),trigger:!0})},handleFailure:function(e){this.showErrorMessage(this.getFailureText(e))},getFailureText:function(){return this.options.failureText||this.t("core","MSG:SAVING_FAILURE")},showErrorMessage:function(e){return this.hideErrorMessage(),this.$errorMessage=i.msg.show({type:"error",time:3e3,text:e}),!1},hideErrorMessage:function(){null!==this.$errorMessage&&(i.msg.hide(this.$errorMessage),this.$errorMessage=null)},getSaveOptions:function(){return{wait:!0}}})}),define("app/wmes-fap-entries/templates/addForm",["underscore","jquery","app/i18n","app/time","app/user","app/core/util/forms"],function(_,$,t,time,user,forms){return function anonymous(locals,escapeFn,include,rethrow){escapeFn=escapeFn||function(e){return void 0==e?"":String(e).replace(_MATCH_HTML,encode_char)};var _ENCODE_HTML_RULES={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&#34;","'":"&#39;"},_MATCH_HTML=/[&<>'"]/g;function encode_char(e){return _ENCODE_HTML_RULES[e]||e}var __output="";function __append(e){void 0!==e&&null!==e&&(__output+=e)}with(locals||{})__append('<form class="fap-addForm">\n  <div class="form-group">\n    <label class="control-label">'),__append(helpers.t("PROPERTY:subdivisionType")),__append("</label>\n    <br>\n    "),subdivisionTypes.forEach(function(e){__append('\n    <div class="radio-inline">\n      <label>\n        <input type="radio" name="subdivisionType" value="'),__append(e),__append('" required>\n        '),__append(helpers.t("subdivisionType:"+e)),__append("\n      </label>\n    </div>\n    ")}),__append("\n  </div>\n  "),user.isLoggedIn()||(__append('\n  <div class="form-group has-required-select2">\n    <label for="'),__append(idPrefix),__append('-owner" class="control-label is-required">'),__append(helpers.t("PROPERTY:owner")),__append('</label>\n    <input id="'),__append(idPrefix),__append('-owner" name="owner" required>\n  </div>\n  ')),__append('\n  <div style="display: flex">\n    <div class="form-group" style="margin-right: 15px">\n      <label for="'),__append(idPrefix),__append('-orderNo" class="control-label">'),__append(helpers.t("PROPERTY:orderNo")),__append('</label>\n      <input id="'),__append(idPrefix),__append('-orderNo" name="orderNo" class="form-control text-mono" maxlength="9" pattern="^[0-9]{9}$" style="width: 110px">\n    </div>\n    <div class="form-group">\n      <label for="'),__append(idPrefix),__append('-lines" class="control-label">'),__append(helpers.t("PROPERTY:lines")),__append('</label>\n      <input id="'),__append(idPrefix),__append('-lines" name="lines" style="width: 300px">\n    </div>\n  </div>\n  <div style="display: flex">\n    <div class="form-group" style="margin-right: 15px">\n      <label for="'),__append(idPrefix),__append('-componentCode" class="control-label">'),__append(helpers.t("PROPERTY:componentCode")),__append('</label>\n      <input id="'),__append(idPrefix),__append('-componentCode" name="componentCode" class="form-control text-mono" placeholder="12NC" maxlength="12" pattern="^[0-9]{1,12}$" style="width: 110px">\n    </div>\n    <div class="form-group">\n      <label class="control-label">'),__append(helpers.t("PROPERTY:componentName")),__append('</label>\n      <p id="'),__append(idPrefix),__append('-componentName" class="form-control-static fap-addForm-componentName">-</p>\n    </div>\n  </div>\n  <div class="form-group has-required-select2">\n    <div style="display: flex">\n      <label for="'),__append(idPrefix),__append('-category" class="control-label is-required">'),__append(helpers.t("PROPERTY:category")),__append('</label>\n      <i id="'),__append(idPrefix),__append('-category-notifications" class="fa fa-group fap-addForm-notifications"></i>\n    </div>\n    <input id="'),__append(idPrefix),__append('-category" name="category" required>\n  </div>\n  <div class="form-group">\n    <div style="display: flex">\n      <label for="'),__append(idPrefix),__append('-subCategory" class="control-label">'),__append(helpers.t("PROPERTY:subCategory")),__append('</label>\n      <i id="'),__append(idPrefix),__append('-subCategory-notifications" class="fa fa-group fap-addForm-notifications"></i>\n    </div>\n    <input id="'),__append(idPrefix),__append('-subCategory" name="subCategory">\n  </div>\n  <div class="form-group">\n    <div style="display: flex">\n      <label for="'),__append(idPrefix),__append('-problem" class="control-label is-required">'),__append(helpers.t("PROPERTY:problem")),__append('</label>\n      <div id="'),__append(idPrefix),__append('-copy" class="fap-addForm-copy" title="'),__append(helpers.t("addForm:copy:title")),__append('">\n        <i class="fa fa-copy"></i>\n      </div>\n    </div>\n    <textarea id="'),__append(idPrefix),__append('-problem" name="problem" class="form-control text-mono" rows="4" required style="resize: none"></textarea>\n  </div>\n  <div class="form-group has-required-select2">\n    <label for="'),__append(idPrefix),__append('-subdivisions" class="control-label is-required">'),__append(helpers.t("addForm:subdivisions")),__append('</label>\n    <input id="'),__append(idPrefix),__append('-subdivisions" name="subdivisions" required>\n  </div>\n  <div class="form-group" style="margin-bottom: 12px">\n    <label class="control-label">'),__append(helpers.t("PROPERTY:attachments")),__append('</label>\n    <ul id="'),__append(idPrefix),__append('-uploads" class="fap-addForm-uploads">\n      <li>'),__append(helpers.t("upload:drop")),__append('</li>\n    </ul>\n  </div>\n  <div class="form-group">\n    <button id="'),__append(idPrefix),__append('-submit" type="submit" class="btn btn-primary">'),__append(helpers.t("addForm:submit")),__append('</button>\n    <button id="'),__append(idPrefix),__append('-cancel" type="button" class="btn btn-link">'),__append(helpers.t("addForm:cancel")),__append("</button>\n  </div>\n</form>\n");return __output}}),define("app/wmes-fap-entries/templates/addFormUpload",["underscore","jquery","app/i18n","app/time","app/user","app/core/util/forms"],function(_,$,t,time,user,forms){return function anonymous(locals,escapeFn,include,rethrow){escapeFn=escapeFn||function(e){return void 0==e?"":String(e).replace(_MATCH_HTML,encode_char)};var _ENCODE_HTML_RULES={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&#34;","'":"&#39;"},_MATCH_HTML=/[&<>'"]/g;function encode_char(e){return _ENCODE_HTML_RULES[e]||e}var __output="";function __append(e){void 0!==e&&null!==e&&(__output+=e)}with(locals||{})__append('<li class="fap-addForm-upload" data-upload-id="'),__append(upload._id),__append('">\n  <a class="fap-addForm-upload-icon" href="#" data-action="removeUpload"><i class="fa '),__append(uploaded?"fa-times":"fa-spinner fa-spin"),__append('"></i></a>\n  <span class="fap-addForm-upload-name">'),__append(escapeFn(upload.name)),__append("</span>\n</li>\n");return __output}}),define("app/wmes-fap-entries/templates/notificationsPopover",["underscore","jquery","app/i18n","app/time","app/user","app/core/util/forms"],function(_,$,t,time,user,forms){return function anonymous(locals,escapeFn,include,rethrow){escapeFn=escapeFn||function(e){return void 0==e?"":String(e).replace(_MATCH_HTML,encode_char)};var _ENCODE_HTML_RULES={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&#34;","'":"&#39;"},_MATCH_HTML=/[&<>'"]/g;function encode_char(e){return _ENCODE_HTML_RULES[e]||e}var __output="";function __append(e){void 0!==e&&null!==e&&(__output+=e)}with(locals||{})__append('<table class="table table-condensed">\n  <thead>\n  <tr>\n    <th class="is-min">'),__append(helpers.t("addForm:notifications:subdivisions")),__append("</th>\n    <th>"),__append(helpers.t("addForm:notifications:prodFunctions")),__append("</th>\n  </tr>\n  </thead>\n  <tbody>\n  "),notifications.forEach(function(e){__append("\n    <tr>\n      <td>"),__append(e.subdivisions.join(",<br>")),__append("</td>\n      <td>"),__append(e.prodFunctions.join(",<br>")),__append("</td>\n    </tr>\n  ")}),__append("\n  </tbody>\n</table>\n");return __output}}),define("app/wmes-fap-entries/views/AddFormView",["underscore","jquery","app/user","app/viewport","app/core/views/FormView","app/core/util/uuid","app/core/util/idAndLabel","app/data/orgUnits","app/users/util/setUpUserSelect2","../dictionaries","../Entry","app/wmes-fap-entries/templates/addForm","app/wmes-fap-entries/templates/addFormUpload","app/wmes-fap-entries/templates/notificationsPopover"],function(e,t,n,i,r,o,a,s,u,c,l,d,p,f){"use strict";return r.extend({template:d,events:e.assign({"click #-cancel":function(){this.trigger("cancel")},'click a[data-action="removeUpload"]':function(e){var t=this.$(e.target).closest(".fap-addForm-upload")[0].dataset.uploadId,n=this.model;return n.uploading&&n.uploading.upload._id===t?(n.uploading.abort(),n.uploading=null):(n.uploadQueue=n.uploadQueue.filter(function(e){return e._id!==t}),n.uploadedFiles=n.uploadedFiles.filter(function(e){return e._id!==t})),this.removeUpload(t),!1},"change #-category":function(e){var t=e.target;this.model.attributes[t.name]=t.value,this.saveInputFocus(t),this.updateNotifications("category"),this.toggleRequiredFields(),this.setUpSubCategorySelect2(),this.updateEtoCategory("category")},"change #-subCategory":function(e){var t=e.target;this.model.attributes[t.name]=t.value.length?t.value:null,this.updateNotifications("subCategory"),this.updateEtoCategory("subCategory"),this.toggleRequiredFields()},"change #-lines, #-subdivisions":function(e){var t=e.target;this.model.attributes[t.name]=t.value.length?t.value.split(","):[],this.saveInputFocus(t)},"input #-orderNo, #-problem":function(e){this.model.attributes[e.target.name]=e.target.value.trim(),e.target.setCustomValidity(""),this.saveInputFocus(e.target),"orderNo"===e.target.name&&9===e.target.value.length&&this.validateOrder()},"input #-componentCode":function(e){this.model.attributes[e.target.name]=e.target.value.trim(),e.target.setCustomValidity(""),this.saveInputFocus(e.target),this.validateComponent()},"focus input, textarea":function(e){this.saveInputFocus(e.target)},"blur input, textarea":function(e){this.saveInputFocus(e.target)},'change [name="subdivisionType"]':function(){this.model.attributes.subdivisionType=this.$('[name="subdivisionType"]:checked').val(),this.toggleRequiredFields()},"change #-orderNo":function(){this.validateOrder()},"change #-componentCode":function(){this.validateComponent()},"click .fap-addForm-upload-name":function(e){this.showUploadNameEditor(this.$(e.target).closest(".fap-addForm-upload")[0].dataset.uploadId)},"click #-copy":function(){this.copyLastEntry()}},r.prototype.events),initialize:function(){r.prototype.initialize.apply(this,arguments),this.reloadLock=n.lockReload();var e=this.model;e.uploadQueue||(e.uploadQueue=[],e.uploading=null,e.uploadedFiles=[]),this.listenTo(c.categories,"reset change",this.setUpCategorySelect2)},destroy:function(){r.prototype.destroy.apply(this,arguments),this.model.focusedInput&&this.saveInputFocus(this.$id(this.model.focusedInput.name)[0]),t(".fap-addForm-backdrop").remove(),n.unlockReload(this.reloadLock),c.unload()},afterRender:function(){var e=this;r.prototype.afterRender.apply(e,arguments),c.load();var n=t(".fap-addForm-backdrop");n.length||(n=t('<div class="fap-addForm-backdrop"></div>').appendTo("body").on("click",function(){e.trigger("cancel")})),e.$id("lines").select2({dropdownCssClass:"fap-addForm-select2",multiple:!0,allowClear:!0,placeholder:" ",data:s.getActiveByType("prodLine").map(a)}),e.renderUploads(),e.setUpCategorySelect2(),e.setUpSubCategorySelect2(),e.setUpSubdivisionsSelect2(),e.setUpOwnerSelect2(),e.setUpDnd(e.$el),e.setUpDnd(n),e.updateNotifications(),e.updateComponentName(),e.toggleRequiredFields(),e.focusInput()},toggleRequiredFields:function(){var t={orderNo:!1,lines:!1,componentCode:!1},n=this.model.get("subdivisionType"),i=c.categories.get(this.model.get("category")),r=c.subCategories.get(this.model.get("subCategory"));if(i&&e.assign(t,(i.get("reqFields")||{})[n]),r){var o=r.get("reqFields")||{};o.enabled&&e.assign(t,o[n])}this.$id("orderNo").prop("required",t.orderNo).closest(".form-group").find(".control-label").toggleClass("is-required",t.orderNo),this.$id("lines").prop("required",t.lines).closest(".form-group").toggleClass("has-required-select2",t.lines).find(".control-label").toggleClass("is-required",t.lines),this.$id("componentCode").prop("required",t.componentCode).closest(".form-group").find(".control-label").toggleClass("is-required",t.componentCode)},renderUploads:function(){var e=this,n=e.$id("uploads");e.model.uploadedFiles.forEach(function(t){e.renderUpload(t,!0).appendTo(n)}),e.model.uploading&&e.renderUpload(e.model.uploading.upload,!1).appendTo(n),e.model.uploadQueue.forEach(function(t){e.renderUpload(t,!1).appendTo(n)}),n[0].childElementCount>1&&n[0].firstElementChild.classList.add("hidden"),n.popover({placement:"left",trigger:"hover",container:n.parent()[0],selector:".fap-addForm-upload",html:!0,content:function(){if(!e.$el.hasClass("fap-addForm-editing")){var t=this.dataset.uploadId,n=e.findUpload(t);if(n&&n.img)return n.img}},template:function(e){return t(e).addClass("fap-addForm-upload-popover").attr("data-upload-id",this.dataset.uploadId)}})},renderUpload:function(e,t){return this.renderPartial(p,{uploaded:t,upload:e})},setUpCategorySelect2:function(){this.$id("category").select2({dropdownCssClass:"fap-addForm-select2",data:c.categories.where({active:!0}).map(a)})},setUpSubCategorySelect2:function(){var e=this.$id("category").val(),t=c.subCategories.where({active:!0,parent:e}).map(a),n=this.$id("subCategory");n.select2("val",""),1===t.length&&n.val(t[0].id),n.select2({allowClear:!1,placeholder:" ",dropdownCssClass:"fap-addForm-select2",data:t});var i=t.length>0;n.select2("enable",i).prop("required",i).closest(".form-group").toggleClass("has-required-select2",i).find(".control-label").toggleClass("is-required",i)},setUpSubdivisionsSelect2:function(){this.$id("subdivisions").select2({dropdownCssClass:"fap-addForm-select2",placeholder:" ",allowClear:!0,multiple:!0,data:s.getActiveByType("division").map(function(e){var t=e.getLabel();return{text:t,children:s.getChildren(e).filter(function(e){return!e.get("deactivatedAt")}).map(function(e){return{id:e.id,text:e.getLabel(),divisionText:t}})}}),formatSelection:function(e,t,n){return n(e.divisionText+" \\ "+e.text)}})},setUpOwnerSelect2:function(){var e=this.$id("owner");e.length&&u(e,{view:this,noPersonnelId:!0,width:"100%",dropdownCssClass:"fap-addForm-select2"})},setUpDnd:function(e){e.on("drag dragstart dragend dragover dragenter dragleave drop",function(e){e.preventDefault(),e.stopPropagation()}).on("drop",this.onDrop.bind(this))},onDrop:function(t){var n=t.originalEvent.dataTransfer;if(!n||!n.files||!n.files.length)return!1;var r=this,a=r.model,s=Array.prototype.slice.call(n.files);return(a.uploading?1:0)+a.uploadQueue.length+a.uploadedFiles.length+s.length>5?(i.msg.show({type:"warning",time:2500,text:r.t("upload:tooMany",{max:5})}),!1):(s.forEach(function(t){var n=null;0===t.type.indexOf("image/")&&((n=new Image).src=URL.createObjectURL(t)),a.uploadQueue.push({_id:o(),file:t,name:t.name,img:n});var i=r.$id("uploads");i[0].firstElementChild.classList.add("hidden"),r.renderUpload(e.last(a.uploadQueue),!1).appendTo(i)}),a.uploading||r.uploadNext(),!1)},uploadNext:function(){var e=this,t=e.model,n=t.uploadQueue.shift();if(n){e.$id("submit").prop("disabled",!0);var r=e.$id("uploads"),o=new FormData;o.append("file",n.file),t.uploading=e.ajax({type:"POST",url:"/fap/entries;upload",data:o,processData:!1,contentType:!1}),t.uploading.upload=n,t.uploading.fail(function(){e.removeUpload(n._id),"abort"!==t.uploading.statusText&&i.msg.show({type:"error",time:2500,text:e.t("upload:failure",{file:n.file.name})})}),t.uploading.done(function(e){r.find('[data-upload-id="'+n._id+'"]').find(".fa-spinner").removeClass("fa-spinner fa-spin").addClass("fa-times"),n.hash=e,t.uploadedFiles.push(n)}),t.uploading.always(function(){t.uploading=null,e.uploadNext()})}else e.$id("submit").prop("disabled",!1)},removeUpload:function(e){var t=this.$id("uploads");t.find('[data-upload-id="'+e+'"]').remove(),this.$('.popover[data-upload-id="'+e+'"]').remove(),1===t[0].childElementCount&&t[0].firstElementChild.classList.remove("hidden")},saveInputFocus:function(e){if(e){var t=this.$(e).closest(".select2-container");t.length&&(e=t.next()[0]),this.model.focusedInput={name:e.name,selectionStart:e.selectionStart,selectionEnd:e.selectionEnd}}},focusInput:function(){if(!this.model.focusedInput){var e=this.$id("owner");return e.length||(e=this.$id("orderNo")),void e.focus()}var t=this.$id(this.model.focusedInput.name)[0];if(t){if("TEXTAREA"===t.tagName){var n=t.value;t.value=n.substring(0,this.model.focusedInput.selectionEnd),t.scrollTop=t.scrollHeight,t.value=n}t.setSelectionRange&&t.setSelectionRange(this.model.focusedInput.selectionStart,this.model.focusedInput.selectionEnd);var i=this.$(t);i.prev().hasClass("select2-container")?i.select2("focus"):t.focus()}else this.$id("orderNo").focus()},updateEtoCategory:function(e){if(!e)return this.updateEtoCategory("category"),void this.updateEtoCategory("subCategory");var t=this.$id(e),n=c.forProperty(e),i=n.get(t.val()),r=this.model.validatedOrder;if(i&&null!==i.get("etoCategory")&&r){var o=i.get("etoCategory");if(""===o){if(r.eto)return void this.resolveSubdivisions();var a=n.find(function(e){return e.get("etoCategory")===i.id});return a?void t.select2("val",a.id).trigger("change"):void this.resolveSubdivisions()}if(r.eto){var s=n.get(o);s?t.select2("val",s.id).trigger("change"):this.resolveSubdivisions()}else this.resolveSubdivisions()}else this.resolveSubdivisions()},resolveSubdivisions:function(){var e=this,t=e.$id("orderNo").val(),n=c.categories.get(e.$id("category").val()),i=c.subCategories.get(e.$id("subCategory").val());e.resolveSubdivisionsReq&&(e.resolveSubdivisionsReq.abort(),e.resolveSubdivisionsReq=null),e.timers.resolveSubdivisions&&clearTimeout(e.timers.resolveSubdivisions),e.$id("subdivisions").select2("val",""),n&&(e.timers.resolveSubdivisions=setTimeout(function(){e.timers.resolveSubdivisions=null;var r=e.resolveSubdivisionsReq=e.ajax({method:"POST",url:"/fap/entries;resolve-participants",data:JSON.stringify({orderNo:t,category:n.id,subCategory:i?i.id:null})});r.done(function(t){t.subdivisions&&e.$id("subdivisions").select2("val",t.subdivisions)}),r.always(function(){r===e.resolveSubdivisionsReq&&(e.resolveSubdivisionsReq=null)})},30))},updateNotifications:function(e){if(!e)return this.updateNotifications("category"),void this.updateNotifications("subCategory");var n=c.forProperty(e).get(this.$id(e).val()),i=n&&n.get("notifications")||[],r=this.$id(e+"-notifications");i.length?r.removeClass("hidden").popover({placement:"bottom",trigger:"hover",html:!0,content:this.renderPartial(f,{notifications:n.serialize().notifications}),template:function(e){return t(e).addClass("fap-addForm-notifications-popover")}}):r.addClass("hidden")},validateOrder:function(){var e=this,t=e.$id("orderNo"),n=t.val();if(/^[0-9]{9}$/.test(n)&&"000000000"!==n&&(!e.model.validatedOrder||e.model.validatedOrder.orderNo!==n)){e.model.validatedOrder={orderNo:n};var i=e.ajax({method:"POST",url:"/fap/entries;validate-order?order="+n});i.fail(function(){404===i.status&&t[0].setCustomValidity(e.t("addForm:orderNo:notFound"))}),i.done(function(t){e.model.validatedOrder=t,e.$id("lines").select2("val",t.lines).trigger("change"),e.updateEtoCategory()})}},validateComponent:function(){var e=this,t=e.$id("componentCode").val();if(/^[0-9]{12}$/.test(t)&&"000000000000"!==t&&(!e.model.validatedComponent||e.model.validatedComponent._id!==t)){e.model.validatedComponent={_id:t},e.model.attributes.componentName="";var n=e.ajax({method:"POST",url:"/fap/entries;validate-component?nc12="+t});n.fail(function(){e.$id("componentName").text("")}),n.done(function(t){e.model.validatedComponent=t,e.model.attributes.componentCode=t._id,e.model.attributes.componentName=t.name,e.updateComponentName()})}},updateComponentName:function(){this.$id("componentName").text(this.model.get("componentName")||"-")},findUpload:function(e){var t=this.model;if(t.uploading&&t.uploading.upload._id===e)return t.uploading.upload;for(var n=0;n<t.uploadedFiles.length;++n)if(t.uploadedFiles[n]._id===e)return t.uploadedFiles[n];for(var i=0;i<t.uploadQueue.length;++i)if(t.uploadQueue[i]._id===e)return t.uploadQueue[i];return null},showUploadNameEditor:function(e){var n=this,i=n.$id("uploads").find('[data-upload-id="'+e+'"]'),r=n.findUpload(e),o=t('<input type="text" class="form-control fap-addForm-upload-input">').val(r.name);function a(){o.remove(),n.$el.removeClass("fap-addForm-editing")}n.$el.addClass("fap-addForm-editing"),o.on("blur",function(){!function(){var e=o.val().trim();if(!e.length)return;/\.[a-zA-Z0-9]{1,}$/.test(e)||(e+="."+r.name.split(".").pop());r.name=e,i.find(".fap-addForm-upload-name").text(e)}(),a()}),o.on("keydown",function(e){return"Escape"===e.key?(a(),!1):"Enter"===e.key?(e.target.blur(),!1):void 0}),o.appendTo(i).focus()},getTemplateData:function(){return{subdivisionTypes:c.subdivisionTypes}},serializeToForm:function(){var e=this.model.toJSON();return Array.isArray(e.lines)&&(e.lines=e.lines.join(",")),Array.isArray(e.subdivisions)&&(e.subdivisions=e.subdivisions.join(",")),e},serializeForm:function(e){var t=this.$id("owner").select2("data");return t&&(e.owner={id:t.id,label:t.text}),e.lines=(e.lines||"").split(",").filter(function(e){return!!e.length}),e.subdivisions=(e.subdivisions||"").split(",").filter(function(e){return!!e.length}),e.divisions=[],e.lines.forEach(function(t){var n=s.getAllForProdLine(t).division;n&&-1===e.divisions.indexOf(n)&&e.divisions.push(n)}),e.files=this.model.uploadedFiles.map(function(e){return{_id:e.hash,name:e.name}}),e},getFailureText:function(){return this.t("core","FORM:ERROR:addFailure")},copyLastEntry:function(){var e=this,t=e.$id("copy").find(".fa");if(!t.hasClass("fa-spin")){t.removeClass("fa-copy").addClass("fa-spinner fa-spin");var r=e.ajax({url:"/fap/entries?limit(1)&sort(-createdAt)&select(category,subCategory,problem)&observers.user.id="+n.data._id+"&creator.id="+n.data._id});r.done(function(t){if(!t.totalCount)return i.msg.show({type:"warning",time:2500,text:e.t("addForm:copy:notFound")});e.$id("category").select2("val",t.collection[0].category).trigger("change"),e.$id("subCategory").select2("val",t.collection[0].subCategory).trigger("change"),e.$id("problem").val(t.collection[0].problem).trigger("input").focus()}),r.fail(function(){i.msg.show({type:"error",time:2500,text:e.t("addForm:copy:failure")})}),r.done(function(){t.removeClass("fa-spinner fa-spin").addClass("fa-copy")})}}})}),define("app/wmes-fap-entries/templates/navbar",["underscore","jquery","app/i18n","app/time","app/user","app/core/util/forms"],function(_,$,t,time,user,forms){return function anonymous(locals,escapeFn,include,rethrow){escapeFn=escapeFn||function(e){return void 0==e?"":String(e).replace(_MATCH_HTML,encode_char)};var _ENCODE_HTML_RULES={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&#34;","'":"&#39;"},_MATCH_HTML=/[&<>'"]/g;function encode_char(e){return _ENCODE_HTML_RULES[e]||e}var __output="";function __append(e){void 0!==e&&null!==e&&(__output+=e)}with(locals||{})__append('<div class="navbar-right fap-navbar">\n  <div class="fap-navbarBtn">\n    <a id="'),__append(id("unseen")),__append('" href="#fap/entries?exclude(changes)&sort(-createdAt)&limit(-1337)&observers.user.id=unseen" class="btn btn-warning fap-navbarBtn-unseen" title="'),__append(t("navbar:unseen")),__append('">?</a>\n    <div class="dropdown">\n      <button id="'),__append(id("menu")),__append('" type="button" class="btn btn-warning dropdown-toggle" data-toggle="dropdown">'),__append(t("navbar:button")),__append('</button>\n      <ul class="dropdown-menu dropdown-menu-left">\n        '),browseEntriesLinks.forEach(function(e){__append('\n        <li class="navbar-with-button"><a href="#fap/entries?exclude(changes)&sort(-createdAt)&limit(-1337)'),__append(e.rql),__append('">'),__append(t("navbar:"+e.label)),__append('</a><button class="btn btn-default" data-href="#fap/entries?exclude(changes)&sort(-createdAt)&limit(-1337)&observers.user.id='),__append(user.data._id),__append(e.rql),__append('" title="'),__append(t("navbar:mine")),__append('"><i class="fa fa-user"></i></button></li>\n        ')}),__append('\n        <li><a href="#fap/reports/count">'),__append(t("navbar:reports:count")),__append("</a>\n        "),user.isAllowedTo("FAP:MANAGE")&&(__append('\n        <li class="divider"></li>\n        <li class="dropdown-header">'),__append(t("navbar:dictionaries")),__append('\n          <li><a href="#fap/categories">'),__append(t("navbar:categories")),__append('</a>\n          <li><a href="#fap/subCategories">'),__append(t("navbar:subCategories")),__append('</a>\n          <li><a href="#fap/settings">'),__append(t("navbar:settings")),__append("</a>\n        ")),__append('\n      </ul>\n    </div>\n    <button id="'),__append(id("add")),__append('" type="button" class="btn btn-warning fap-navbarBtn-add" title="'),__append(t("navbar:add")),__append('"><i class="fa fa-plus"></i></button>\n    <div id="'),__append(id("addForm")),__append('"></div>\n  </div>\n</div>\n');return __output}}),define("app/wmes-fap-entries/templates/navbarItem",["underscore","jquery","app/i18n","app/time","app/user","app/core/util/forms"],function(_,$,t,time,user,forms){return function anonymous(locals,escapeFn,include,rethrow){escapeFn=escapeFn||function(e){return void 0==e?"":String(e).replace(_MATCH_HTML,encode_char)};var _ENCODE_HTML_RULES={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&#34;","'":"&#39;"},_MATCH_HTML=/[&<>'"]/g;function encode_char(e){return _ENCODE_HTML_RULES[e]||e}var __output="";function __append(e){void 0!==e&&null!==e&&(__output+=e)}with(locals||{})__append('<li data-online data-module="wmes-fap" class="dropdown">\n  <a class="dropdown-toggle" data-toggle="dropdown">\n    '),__append(t("wmes-fap-entries","navbar:button")),__append('\n    <b class="caret"></b>\n  </a>\n  <ul class="dropdown-menu">\n    <li data-privilege="USER" class="navbar-with-button"><a href="#fap/entries?exclude(changes)&sort(-createdAt)&limit(-1337)">'),__append(t("wmes-fap-entries","navbar:all")),__append('</a><button type="button" class="btn btn-default" data-action="addFap"><i class="fa fa-plus"></i></button></li>\n    <li data-privilege="USER"><a href="#fap/entries?exclude(changes)&sort(-createdAt)&limit(-1337)&status=in=(pending,started)">'),__append(t("wmes-fap-entries","navbar:open")),__append('</a></li>\n    <li data-privilege="USER"><a href="#fap/entries?exclude(changes)&sort(-createdAt)&limit(-1337)&observers.user.id=mine">'),__append(t("wmes-fap-entries","navbar:mine")),__append('</a></li>\n    <li data-privilege="USER"><a href="#fap/entries?exclude(changes)&sort(-createdAt)&limit(-1337)&observers.user.id=unseen">'),__append(t("wmes-fap-entries","navbar:unseen")),__append('</a></li>\n    <li data-privilege="USER"><a href="#fap/reports/count">'),__append(t("wmes-fap-entries","navbar:reports:count")),__append('</a>\n    <li class="divider"></li>\n    <li class="dropdown-header">'),__append(t("wmes-fap-entries","navbar:dictionaries")),__append('\n    <li data-privilege="FAP:MANAGE"><a href="#fap/categories">'),__append(t("wmes-fap-entries","navbar:categories")),__append("</a>\n  </ul>\n");return __output}}),define("app/wmes-fap-entries/views/NavbarView",["underscore","jquery","app/broker","app/user","app/viewport","app/notifications","app/core/View","../Entry","./AddFormView","app/wmes-fap-entries/templates/navbar","app/wmes-fap-entries/templates/navbarItem"],function(e,t,n,i,r,o,a,s,u,c,l){"use strict";return a.extend({template:c,events:{"click #-add":function(){if(this.$(".fap-addForm").length)return this.hideAddForm();clearTimeout(this.timers.resetNewEntry),this.timers.resetNewEntry=null,this.toggleAddForm(!0);var e=new u({model:this.model});this.listenTo(e,"cancel",this.hideAddForm),this.setView("#-addForm",e).render()},"click #-unseen":function(){if(this.unseenEntries&&1===this.unseenEntries.length)return this.broker.publish("router.navigate",{url:"/#fap/entries/"+this.unseenEntries[0],trigger:!0,replace:!1}),!1}},initialize:function(){var e=this;e.model=new s({subdivisionType:"assembly"}),e.listenTo(e.model,"sync",function(){e.hideAddForm(),e.timers.resetModel=setTimeout(e.resetEntry.bind(e),1)}),t(window).on("keydown."+e.idPrefix,e.onKeyDown.bind(e))},destroy:function(){t(window).off("."+this.idPrefix)},getTemplateData:function(){return{browseEntriesLinks:[{label:"all",rql:""},{label:"open",rql:"&status=in=(pending,started)"},{label:"pending",rql:"&status=in=(pending)"},{label:"started",rql:"&status=in=(started)"},{label:"finished",rql:"&status=in=(finished)"},{label:"analysis",rql:"&analysisNeed=true&analysisDone=false"}]}},afterRender:function(){this.setUpUnseen(),i.isLoggedIn()?this.$(".fap-addForm").length&&this.toggleAddForm(!0):this.$el.addClass("hidden")},setUpUnseen:function(){var e="fap.entries.notifications."+i.data._id;this.notifications&&this.notifications.topic!==e&&(this.notifications.cancel(),this.notifications=null),this.reloadUnseen(),i.isLoggedIn()&&(this.notifications||(this.notifications=this.pubsub.subscribe("fap.entries.notifications."+i.data._id,this.onNotification.bind(this))))},reloadUnseen:function(){var e=this;e.unseenEntries=[],e.$(".fap-navbarBtn-unseen").addClass("disabled").text("?"),e.req&&(e.req.abort(),e.req=null),i.isLoggedIn()&&(e.req=e.ajax({url:"/fap/entries;unseen"}),e.req.done(function(t){e.unseenEntries=t,e.toggleUnseen()}),e.req.always(function(){e.req=null}))},toggleUnseen:function(){this.$(".fap-navbarBtn-unseen").toggleClass("disabled",0===this.unseenEntries.length).text(this.unseenEntries.length)},toggleAddForm:function(e){var t=this.$id("add").find(".fa");this.$el.toggleClass("fap-navbar-adding",e),this.$id("menu").prop("disabled",e),e?t.removeClass("fa-plus").addClass("fa-times"):t.removeClass("fa-times").addClass("fa-plus")},hideAddForm:function(){var e=this;e.$(".fap-addForm").length&&(e.removeView("#-addForm"),e.toggleAddForm(!1),e.timers.resetNewEntry=setTimeout(function(){e.model.clear()},3e5))},resetEntry:function(){var e=this.model;delete e.focusedInput,delete e.uploadQueue,delete e.uploading,delete e.uploadedFiles,delete e.validatedOrder,delete e.validatedComponent,e.clear(),e.set(e.defaults())},onKeyDown:function(e){r.currentDialog||("Escape"===e.key?this.hideAddForm():"F1"===e.key&&(e.preventDefault(),this.$id("add").click()))},onNotification:function(e){e.added&&this.handleAddedEntry(e.added),e.changed&&this.handleChangedEntry(e.changed),e.removed&&this.handleRemovedEntries(e.removed),e.seen&&this.handleSeenEntries(e.seen)},handleAddedEntry:function(e){this.unseenEntries.push(e._id),this.toggleUnseen(),this.showAddedNotification(e)},handleChangedEntry:function(e){this.unseenEntries&&(-1===this.unseenEntries.indexOf(e._id)&&(this.unseenEntries.push(e._id),this.toggleUnseen()),e.comment&&!e.unsubscribed&&this.showChangedNotification(e))},handleRemovedEntries:function(e){this.handleSeenEntries(e)},handleSeenEntries:function(e){if(this.unseenEntries||this.unseenEntries.length){this.broker.publish("fap.entries.seen",{seenEntries:e});var t={};e.forEach(function(e){t[e]=!0,o.close(["wmes-fap",e])}),this.unseenEntries=this.unseenEntries.filter(function(e){return!t[e]}),this.toggleUnseen()}},showAddedNotification:function(t){o.show({tag:"wmes-fap "+t._id,title:this.t("notifications:added:title",{rid:t.rid,category:t.category}),body:t.owner+": "+t.problem,data:{onClick:{open:"/#fap/entries/"+t._id}},scoreClient:function(e){var t=e.focused?1:0;return e.url.includes("#fap/entries")?t+=1e4:e.url.includes("#fap")&&(t+=1e3),t}}).catch(e.noop)},showChangedNotification:function(t){o.show({tag:"wmes-fap "+t._id,title:this.t("notifications:changed:title",{rid:t.rid}),body:t.updater+": "+t.comment,actions:[{action:"reply",title:this.t("notifications:changed:reply"),type:"text",placeholder:this.t("notifications:changed:placeholder")}],data:{onClick:{open:"/#fap/entries/"+t._id},onAction:{reply:{act:{action:"wmesFapComment",data:{entryId:t._id}}}}},scoreClient:function(e){var n=e.focused?1:0;if(e.url.includes("#fap/entries/"+t._id)){if(e.focused)return-1;n+=1e5}else e.url.includes("#fap/entries")?n+=1e4:e.url.includes("#fap")&&(n+=1e3);return n}}).catch(e.noop)}},{appNavbarView:null,setUp:function(){if(!window.MODULES||-1!==window.MODULES.indexOf("wmes-fap")){var e=this,i=null;n.subscribe("navbar.render",function(n){var o=(e.appNavbarView=n.view).$el.find(".navbar-nav").first().children().first(),a=t(l({}));a.insertAfter(o),a.find('[data-action="addFap"]').on("click",function(){var e=new u({model:i.model});e.on("cancel",function(){r.closeDialog()}),e.listenToOnce(i.model,"sync",function(){r.closeDialog()}),r.showDialog(e)})}),n.subscribe("navbar.rendered",function(t){var n=t.view;n.$el.find(".fap-navbar").length||(i=new e,n.insertView(".navbar-collapse",i).render())})}}})}),define("app/wmes-fap-entries/templates/details",["underscore","jquery","app/i18n","app/time","app/user","app/core/util/forms"],function(_,$,t,time,user,forms){return function anonymous(locals,escapeFn,include,rethrow){escapeFn=escapeFn||function(e){return void 0==e?"":String(e).replace(_MATCH_HTML,encode_char)};var _ENCODE_HTML_RULES={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&#34;","'":"&#39;"},_MATCH_HTML=/[&<>'"]/g;function encode_char(e){return _ENCODE_HTML_RULES[e]||e}var __output="";function __append(e){void 0!==e&&null!==e&&(__output+=e)}with(locals||{}){__append('<div class="fap-details">\n  <div class="fap-details-hd">\n    <div id="'),__append(idPrefix),__append('-message" class="message message-inline message-'),__append(model.message.type),__append('">\n      '),__append(model.message.text),__append('\n    </div>\n    <div id="'),__append(idPrefix),__append('-levelIndicator">\n      '),__append(model.levelIndicator),__append("\n    </div>\n    "),statusAction&&(__append('\n    <button id="'),__append(idPrefix),__append('-statusAction" class="btn btn-'),__append(statusAction.type),__append('">\n      '),__append(statusAction.label),__append("\n    </button>\n    ")),__append('\n  </div>\n  <div class="fap-props">\n    <div class="fap-prop" data-prop="category">\n      <div class="fap-prop-name">'),__append(t("PROPERTY:category")),__append('</div>\n      <div class="fap-prop-value">'),__append(escapeFn(model.category)),__append('</div>\n    </div>\n    <div class="fap-prop" data-prop="subCategory">\n      <div class="fap-prop-name">'),__append(t("PROPERTY:subCategory")),__append('</div>\n      <div class="fap-prop-value">'),__append(escapeFn(model.subCategory)),__append('</div>\n    </div>\n    <div class="fap-prop fap-is-textarea '),__append(model.multiline.problem?"fap-is-multiline":""),__append('" data-prop="problem">\n      <div class="fap-prop-name">'),__append(t("PROPERTY:problem")),__append('</div>\n      <div class="fap-prop-value">'),__append(model.problem),__append('</div>\n    </div>\n  </div>\n  <div class="fap-prop-separator"></div>\n  <div class="fap-props">\n    <div class="fap-prop" data-prop="orderNo">\n      <div class="fap-prop-name">'),__append(t("PROPERTY:orderNo")),__append('</div>\n      <div class="fap-prop-value text-mono">\n        '),"-"!==model.orderNo?(__append('\n        <a class="autolink" data-type="order" data-id="'),__append(model.orderNo),__append('">'),__append(model.orderNo),__append("</a>\n        ")):__append("\n        -\n        "),__append('\n      </div>\n    </div>\n    <div class="fap-prop" data-prop="nc12">\n      <div class="fap-prop-name">'),__append(t("PROPERTY:nc12")),__append('</div>\n      <div class="fap-prop-value text-mono">'),__append(escapeFn(model.nc12)),__append('</div>\n    </div>\n    <div class="fap-prop" data-prop="productName">\n      <div class="fap-prop-name">'),__append(t("PROPERTY:productName")),__append('</div>\n      <div class="fap-prop-value text-mono">'),__append(escapeFn(model.productName)),__append('</div>\n    </div>\n  </div>\n  <div class="fap-prop-separator"></div>\n  <div class="fap-props">\n    <div class="fap-prop" data-prop="qty">\n      <div class="fap-prop-name">'),__append(t("PROPERTY:qty")),__append('</div>\n      <div class="fap-prop-value">\n        <span class="text-mono" data-prop="qtyDone">'),__append(model.qtyDone),__append('</span>\n        /\n        <span class="text-mono" data-prop="qtyTodo">'),__append(model.qtyTodo),__append('</span>\n      </div>\n    </div>\n    <div class="fap-prop" data-prop="mrp">\n      <div class="fap-prop-name">'),__append(t("PROPERTY:mrp")),__append('</div>\n      <div class="fap-prop-value text-mono">'),__append(escapeFn(model.mrp)),__append('</div>\n    </div>\n    <div class="fap-prop" data-prop="divisions">\n      <div class="fap-prop-name">'),__append(t("PROPERTY:divisions")),__append('</div>\n      <div class="fap-prop-value">'),__append(escapeFn(model.divisions)),__append('</div>\n    </div>\n    <div class="fap-prop" data-prop="lines">\n      <div class="fap-prop-name">'),__append(t("PROPERTY:lines")),__append('</div>\n      <div class="fap-prop-value">'),__append(escapeFn(model.lines)),__append('</div>\n    </div>\n  </div>\n  <div class="fap-prop-separator"></div>\n  <div class="fap-props">\n    <div class="fap-prop" data-prop="orderStatus">\n      <div class="fap-prop-name">'),__append(t("PROPERTY:orderStatus")),__append('</div>\n      <div class="fap-prop-value">'),__append(model.orderStatus),__append('</div>\n    </div>\n  </div>\n  <div class="fap-prop-separator"></div>\n  <div class="fap-props">\n    <div class="fap-prop" data-prop="subdivisionType">\n      <div class="fap-prop-name">'),__append(t("PROPERTY:subdivisionType")),__append('</div>\n      <div class="fap-prop-value">'),__append(model.subdivisionType),__append('</div>\n    </div>\n    <div class="fap-prop" data-prop="componentCode">\n      <div class="fap-prop-name">'),__append(t("PROPERTY:componentCode")),__append('</div>\n      <div class="fap-prop-value text-mono">'),__append(escapeFn(model.componentCode)),__append('</div>\n    </div>\n    <div class="fap-prop" data-prop="componentName">\n      <div class="fap-prop-name">'),__append(t("PROPERTY:componentName")),__append('</div>\n      <div class="fap-prop-value text-mono">'),__append(escapeFn(model.componentName)),__append('</div>\n    </div>\n  </div>\n  <div class="fap-prop-separator"></div>\n  <div class="fap-chatAndAside">\n    <div id="'),__append(idPrefix),__append('-chat" class="fap-chat-container"></div>\n    <div id="'),__append(idPrefix),__append('-observersAndAttachments" class="fap-observersAndAttachments"></div>\n  </div>\n  <div class="fap-props">\n    <div class="fap-prop fap-is-textarea '),__append(model.multiline.solution?"fap-is-multiline":""),__append(" "),__append(model.empty.solution?"":"fap-is-success"),__append('" data-prop="solution" style="flex: 1 1 auto">\n      <div class="fap-prop-name">\n        '),__append(t("PROPERTY:solution")),__append('\n        <i class="fa fa-user" title="'),__append(escapeFn(model.solver)),__append('"></i>\n      </div>\n      <div class="fap-prop-value">'),__append(model.solution),__append('</div>\n    </div>\n  </div>\n  <div class="fap-prop-separator"></div>\n  <div class="fap-analysis">\n    <div class="fap-analysis-header">'),__append(t("assessment:header")),__append('</div>\n    <div class="fap-prop-separator"></div>\n    <div class="fap-props fap-prop-assessment">\n      <div class="fap-prop" data-prop="assessment">\n        <div class="fap-prop-name">'),__append(t("PROPERTY:assessment")),__append('</div>\n        <div class="fap-prop-value">'),__append(model.assessment),__append('</div>\n      </div>\n      <div class="fap-prop" data-prop="analysisNeed">\n        <div class="fap-prop-name">'),__append(t("PROPERTY:analysisNeed")),__append('</div>\n        <div class="fap-prop-value">'),__append(model.analysisNeed),__append('</div>\n      </div>\n      <div class="fap-prop" data-prop="analysisDone">\n        <div class="fap-prop-name">'),__append(t("PROPERTY:analysisDone")),__append('</div>\n        <div class="fap-prop-value">'),__append(model.analysisDone),__append('</div>\n      </div>\n    </div>\n    <div class="fap-prop-separator"></div>\n    <div class="fap-props">\n      <div class="fap-prop" data-prop="mainAnalyzer" style="flex: 1 1 auto">\n        <div class="fap-prop-name">'),__append(t("PROPERTY:mainAnalyzer")),__append('</div>\n        <div class="fap-prop-value">'),__append(model.mainAnalyzer),__append('</div>\n      </div>\n      <div class="fap-prop" data-prop="analyzers" style="flex: 2 1 auto">\n        <div class="fap-prop-name">'),__append(t("PROPERTY:analyzers")),__append('</div>\n        <div class="fap-prop-value">'),__append(model.analyzers),__append('</div>\n      </div>\n    </div>\n    <div class="fap-prop-separator"></div>\n    <div class="fap-props '),__append(4===model.level?"":"hidden"),__append('">\n      <div class="fap-prop" data-prop="why5" style="flex: 1 1 auto">\n        <div class="fap-prop-name">'),__append(t("PROPERTY:why5")),__append('</div>\n        <div class="fap-prop-value">\n          ');for(var i=0;i<5;++i)__append('\n            <div class="fap-analysis-why" data-why-index="'),__append(i),__append('">\n              <div class="fap-analysis-why-label">'),__append(t("PROPERTY:why")),__append('</div>\n              <div class="fap-analysis-why-value">'),__append(model.why5[i]||""),__append("</div>\n            </div>\n          ");__append('\n        </div>\n      </div>\n    </div>\n    <div class="fap-prop-separator '),__append(4===model.level?"":"hidden"),__append('"></div>\n    <div class="fap-props">\n      <div class="fap-prop fap-is-textarea '),__append(model.multiline.solutionSteps?"fap-is-multiline":""),__append('" data-prop="solutionSteps" style="flex: 1 1 auto">\n        <div class="fap-prop-name">'),__append(t("PROPERTY:solutionSteps")),__append('</div>\n        <div class="fap-prop-value">'),__append(model.solutionSteps),__append('</div>\n      </div>\n    </div>\n  </div>\n  <div class="fap-prop-separator" style="margin-top: 15px"></div>\n</div>\n')}return __output}}),define("app/wmes-fap-entries/views/DetailsView",["underscore","jquery","app/user","app/viewport","app/core/View","app/core/util/idAndLabel","app/core/util/isElementInView","app/data/orgUnits","app/users/util/setUpUserSelect2","app/planning/util/contextMenu","../dictionaries","../Entry","./ChatView","./ObserversView","./AttachmentsView","./NavbarView","app/wmes-fap-entries/templates/details"],function(e,t,n,i,r,o,a,s,u,c,l,d,p,f,h,m,g){"use strict";return r.extend({template:g,events:{"click #-statusAction":function(e){e.currentTarget.classList.contains("btn-info")?this.start():e.currentTarget.classList.contains("btn-success")&&this.finish()},"click .fap-levelIndicator-inner":function(e){var t=this.model.serializeDetails(),n=+e.currentTarget.dataset.level;n!==t.level&&(t.auth.manage||t.auth.level&&n===t.level+1)&&this.model.change("level",n)},"click .fap-editable-toggle":function(e){var t=this.$(e.target).closest(".fap-prop");this.showEditor(t,t[0].dataset.prop)},"mouseup .autolink":function(e){var i=e.currentTarget.dataset.id;if(1===e.button)switch(e.currentTarget.dataset.type){case"order":window.open("/#orders/"+i);break;case"product":window.open("/r/nc12/"+i);break;case"document":n.isAllowedTo("DOCUMENTS:VIEW")?window.open("/#orderDocuments/tree?file="+i):window.open("/orderDocuments/"+i)}else m.appNavbarView?this.showAutolinkMenu(e):t(".navbar-search-phrase").first().val(i).focus();return!1}},initialize:function(){var e=this.model;this.setView("#-chat",new p({model:e})),this.insertView("#-observersAndAttachments",new f({model:e})),this.insertView("#-observersAndAttachments",new h({model:e})),this.listenTo(e,"change",this.update),this.listenTo(e,"editor:show",this.showEditor),this.listenTo(e,"editor:hide",this.hideEditor),this.listenTo(l.settings,"change reset",this.onSettingChange),t(window).on("keydown."+this.idPrefix,this.onKeyDown.bind(this))},destroy:function(){t(window).off("."+this.idPrefix)},getTemplateData:function(){return{statusAction:this.serializeStatusAction(),model:this.model.serializeDetails()}},serializeStatusAction:function(){var e=this.model.serializeDetails().auth,t=this.model.get("status");if("finished"===t){if(e.restart)return{type:"info",label:this.t("PAGE_ACTION:restart")}}else if(e.status)return"pending"===t?{type:"info",label:this.t("PAGE_ACTION:start")}:{type:"success",label:this.t("PAGE_ACTION:finish")};return null},afterRender:function(){this.updateAuth(),this.updateUnseen()},update:function(){var e=this;e.isRendered()&&(Object.keys(e.model.changed).forEach(function(t){d.AUTH_PROPS[t]&&(cancelAnimationFrame(e.timers.auth),e.timers.auth=requestAnimationFrame(e.updateAuth.bind(e)));var n=e.resolveUpdater(t);n&&(cancelAnimationFrame(e.timers[t]),e.timers[t]=requestAnimationFrame(n.bind(e)))}),cancelAnimationFrame(e.timers.unseen),e.timers.unseen=requestAnimationFrame(e.updateUnseen.bind(e)))},resolveUpdater:function(e){switch(e){case"status":return this.updateStatus;case"level":return this.updateLevel;case"why5":return this.updateWhy5;case"analysisNeed":case"analysisDone":return this.updateAnalysis;case"solver":return this.updateSolver;case"problem":case"solution":case"solutionSteps":return this.updateMultiline.bind(this,e);case"qtyTodo":case"qtyDone":return this.updateQty;case"orderNo":return this.updateOrderNo;case"analyzers":return this.updateAnalyzers;case"category":case"subCategory":case"mrp":case"nc12":case"productName":case"divisions":case"lines":case"assessment":case"mainAnalyzer":case"subdivisionType":case"componentCode":case"componentName":case"orderStatus":return this.updateProp.bind(this,e)}},updateAuth:function(){var e=this;if(e.isRendered()){var t=e.model.serializeDetails();Object.keys(t.auth).forEach(function(n){var i=e.$('.fap-prop[data-prop="'+n+'"]');i.length&&(i.toggleClass("fap-is-editable",t.auth[n]),i.find(".fap-editable-toggle").length||i.find(".fap-prop-name").append('<i class="fa fa-edit fap-editable-toggle"></i>'))})}},updateUnseen:function(){var e=this,t=e.model.serializeDetails().observer.changes;e.$el.removeClass("fap-is-unseen").find(".fap-is-unseen").removeClass("fap-is-unseen"),t.any&&Object.keys(t).forEach(function(n){switch(n){case"any":break;case"all":e.$el.toggleClass("fap-is-unseen",t[n]);break;case"observers":case"subscribers":case"subscribers$added":case"subscribers$removed":e.$(".fap-observers").addClass("fap-is-unseen");break;case"attachments":e.$(".fap-attachments").addClass("fap-is-unseen");break;case"comment":e.$(".fap-chat").addClass("fap-is-unseen");break;case"status":e.$id("message").addClass("fap-is-unseen");break;default:e.$('.fap-prop[data-prop="'+n+'"]').addClass("fap-is-unseen")}})},updateText:function(e,n,i){i||(i=".fap-prop-value");for(var r=e instanceof t?e.find(i)[0]:e;r.childNodes.length&&(!r.childNodes[0].classList||!r.childNodes[0].classList.contains("fap-editor"));)r.removeChild(r.childNodes[0]);this.$(r).closest(i).prepend(n)},updateProp:function(e){var t=this.$('.fap-prop[data-prop="'+e+'"]');t.length&&this.updateText(t,this.model.serializeDetails()[e])},updateQty:function(){var e=this.$('.fap-prop[data-prop="qty"]'),t=this.model.serializeDetails();this.updateText(e.find('[data-prop="qtyDone"]')[0],t.qtyDone,'[data-prop="qtyDone"]'),this.updateText(e.find('[data-prop="qtyTodo"]')[0],t.qtyTodo,'[data-prop="qtyTodo"]')},updateOrderNo:function(){for(var e,t=this.$('.fap-prop[data-prop="orderNo"]').find(".fap-prop-value"),n=this.model.serializeDetails();t[0].firstChild&&"div"!==t[0].firstChild.nodeName;)t[0].removeChild(t[0].firstChild);e="-"===n.orderNo?"-":'<a class="autolink" data-type="order" data-id="'+n.orderNo+'">'+n.orderNo+"</a>",t.prepend(e)},updateAnalyzers:function(){this.updateProp("mainAnalyzer"),this.updateProp("analyzers")},updateStatus:function(){this.updateMessage();var e=this.serializeStatusAction();e&&this.$id("statusAction").removeClass("btn-info btn-success").addClass("btn-"+e.type).text(e.label)},updateLevel:function(){this.$id("levelIndicator").html(this.model.serializeDetails().levelIndicator),this.toggleWhy5()},updateMessage:function(){var e=this.model.serializeDetails();this.$id("message").attr("class","message message-inline message-"+e.message.type).text(e.message.text)},updateMultiline:function(e){var t=this.model.serializeDetails(),n=this.$('.fap-prop[data-prop="'+e+'"]');n.toggleClass("fap-is-multiline",t.multiline[e]).toggleClass("fap-is-success",!1===t.empty[e]),this.updateText(n,t[e])},updateSolver:function(){var e=this.model.serializeDetails();this.$('.fap-prop[data-prop="solution"]').find(".fa-user").attr("title",e.solver)},updateWhy5:function(){var e=this,t=e.model.get("why5");e.$(".fap-analysis-why-value").each(function(n){e.updateText(this,t[n]||"",".fap-analysis-why-value")})},toggleWhy5:function(){var e=4!==this.model.get("level");this.$('.fap-prop[data-prop="why5"]').parent().toggleClass("hidden",e).next().toggleClass("hidden",e)},updateAnalysis:function(){this.updateProp("analysisNeed"),this.updateProp("analysisDone"),this.updateMessage()},showEditor:function(e,t){this.hideEditor(),this.editors[t]&&(e.addClass("fap-is-editing"),this.editors[t].call(this,e),this.trigger("editor:shown",t))},hideEditor:function(){var e=this,t=e.$(".fap-editor");t.find(".select2-container").each(function(){e.$(this.nextElementSibling).select2("destroy")}),t.remove();var n=e.$(".fap-is-editing").removeClass("fap-is-editing").attr("data-prop");e.trigger("editor:hidden",n)},showAutolinkMenu:function(e){if(m.appNavbarView){for(var t=m.appNavbarView.renderSearchResults(m.appNavbarView.parseSearchPhrase(e.currentTarget.dataset.id));t.length;){var n=t.children().last();if(!n.hasClass("dropdown-header")&&!n.hasClass("divider"))break;n.remove()}var i=[],r=0;t.children().each(function(){r>1||(this.classList.contains("navbar-search-result")?i.push({label:this.textContent,href:this.querySelector("a").href,handler:function(){window.open(this.href)}}):(r+=1)>1||(this.classList.contains("dropdown-header")?i.push(this.textContent):this.classList.contains("divider")&&i.push("-")))}),c.show(this,e.pageY,e.pageX,i)}},finish:function(){""===this.model.get("solution").trim()?(this.showEditor(this.$('.fap-is-editable[data-prop="solution"]'),"solution"),this.once("editor:hidden",function(){""!==this.model.get("solution").trim()&&window.scrollTo({top:0,left:0,behavior:"smooth"})})):this.model.multiChange({status:"finished",finishedAt:new Date})},start:function(){this.model.multiChange({status:"started",startedAt:new Date,finishedAt:null})},onKeyDown:function(e){"Escape"===e.originalEvent.key&&this.hideEditor()},onSettingChange:function(){this.model.updateAuth(),this.updateAuth()},editors:{textArea:function(e,n,i){var r=this,o=e[0].dataset.prop,s=r.model.get(o),u=t('<form class="fap-editor"></form>'),c=t('<textarea class="form-control"></textarea>').val(s).prop("required",n),l=t('<button class="btn btn-primary btn-lg"><i class="fa fa-check"></i></button>');c.on("keydown",function(e){if("Enter"===e.key&&e.shiftKey)return l.click(),!1}),u.on("submit",function(){var t=c.val().trim();return t!==s&&(i?r.model.multiChange(i(t,s,o,e)):r.model.change(o,t)),r.hideEditor(),!1}),u.append(c).append(l).appendTo(e.find(".fap-prop-value"));var d=e[0].offsetTop,p=d-u.offset().top+u.outerHeight(!0);a(e,{fullyInView:!0,height:p})?c.focus():t("html, body").stop(!0,!1).animate({scrollTop:d},function(){c.focus()})},select:function(n,i,r){var o=this,a=n[0].dataset.prop,s=o.model.get(a),u=t('<form class="fap-editor"></form>'),c=t('<select class="form-control"></select>'),l=t('<button class="btn btn-primary"><i class="fa fa-check"></i></button>');u.on("submit",function(){var e=c.val();return r?o.model.multiChange(r(e,s,a,n)):o.model.change(a,e),o.hideEditor(),!1}),c.html(i.map(function(t){return'<option value="'+t.id+'">'+e.escape(t.text)+"</option>"}).join("")),c.val(s),u.append(c).append(l).appendTo(n.find(".fap-prop-value")),c.focus()},problem:function(e){this.editors.textArea.call(this,e,!0)},solution:function(e){this.editors.textArea.call(this,e,!1,function(e){return{solution:e,solver:e.trim().length?n.getInfo():null}})},solutionSteps:function(e){this.editors.textArea.call(this,e,!1)},category:function(e){var t=this,n=t.model.get("category"),i=l.categories.filter(function(e){return e.id===n||e.get("active")}).map(function(e){return{id:e.id,text:e.getLabel()}}),r=t.$('.fap-prop[data-prop="subCategory"]').addClass("fap-is-editing");t.editors.subCategory.call(t,r,n),t.editors.select.call(t,e,i,function(e){var t=r.find(".form-control").val();return{category:e,subCategory:"null"===t?null:t}}),e.find(".form-control").on("change",function(){r.find(".fap-editor").remove(),t.editors.subCategory.call(t,r,this.value)})},subCategory:function(e,t){t||(t=this.model.get("category"));var n=this.model.get("subCategory"),i=l.subCategories.filter(function(e){return e.get("parent")===t&&(e.id===n||e.get("active"))}).map(function(e){return{id:e.id,text:e.getLabel()}});i.length||i.unshift({id:null,text:""}),this.editors.select.call(this,e,i,function(e){return{category:t,subCategory:"null"===e?null:e}})},subdivisionType:function(e){var t=this,n=l.subdivisionTypes.map(function(e){return{id:e,text:t.t("subdivisionType:"+e)}});t.editors.select.call(t,e,n)},lines:function(e){var n=this,i={divisions:[].concat(n.model.get("divisions")).sort(c),lines:[].concat(n.model.get("lines")).sort(c)},r=t('<form class="fap-editor"></form>'),a=t("<input>"),u=t('<button class="btn btn-primary"><i class="fa fa-check"></i></button>');function c(e,t){return e.localeCompare(t,void 0,{numeric:!0,ignorePunctuation:!0})}r.on("submit",function(){var e={divisions:[],lines:a.val().split(",").sort(c)};return e.lines.forEach(function(t){var n=s.getAllForProdLine(t).division;n&&-1===e.divisions.indexOf(n)&&e.divisions.push(n)}),e.divisions.sort(c),e.lines.length>0&&JSON.stringify(e)!==JSON.stringify(i)&&n.model.multiChange(e),n.hideEditor(),!1}),a.val(i.lines.join(",")),r.append(a).append(u).appendTo(e.find(".fap-prop-value")),a.select2({dropdownCssClass:"fap-editor-select2",width:"100%",multiple:!0,allowClear:!0,placeholder:" ",data:s.getActiveByType("prodLine").map(o)}),a.focus()},why5:function(e){var n=this,i=[].concat(n.model.get("why5"));e.find(".fap-analysis-why").each(function(r){var o=n.$(this),a=t('<form class="fap-editor"></form>'),s=t('<input class="form-control">').val(i[r]||""),u=t('<button class="btn btn-primary" tabindex="-1"><i class="fa fa-check"></i></button>');a.on("submit",function(){return function(){var t=e.find(".form-control").map(function(){return this.value.trim()}).get(),r=n.model.get("why5"),o=[],a=!1;t.forEach(function(e,t){e===(i[t]||"")?o.push(r[t]||""):(o.push(e),a=!0)}),a&&n.model.change("why5",o);n.hideEditor()}(),!1}),a.append(s).append(u).appendTo(o.find(".fap-analysis-why-value"))}),e.find(".form-control").first().focus()},assessment:function(e){var n=this,i=this.model.get("assessment"),r=t('<form class="fap-editor"></form>');["unspecified","effective","ineffective","repeatable"].forEach(function(e){t('<button type="button" class="btn btn-lg btn-default"></button>').toggleClass("active",i===e).val(e).text(n.t("assessment:"+e)).appendTo(r)}),r.on("click",".btn",function(e){var t=e.currentTarget.value;t!==i&&n.model.change("assessment",t),n.hideEditor()}),r.appendTo(e.find(".fap-prop-value"))},yesNo:function(e,n){var i=this,r=e[0].dataset.prop,o=this.model.get(r),a=t('<form class="fap-editor fap-editor-yesNo"></form>');["true","false"].forEach(function(e){t('<button type="button" class="btn btn-lg btn-default"></button>').toggleClass("active",String(o)===e).val(e).text(i.t("core","BOOL:"+e)).appendTo(a)}),a.on("click",".btn",function(t){var a="true"===t.currentTarget.value;a!==o&&(n?i.model.multiChange(n(a,o,r,e)):i.model.change(r,a)),i.hideEditor()}),a.appendTo(e.find(".fap-prop-value"))},analysisNeed:function(e){this.editors.yesNo.call(this,e,function(e){return{analysisNeed:e,analysisDone:!1,analysisStartedAt:e?new Date:null,analysisFinishedAt:null}})},analysisDone:function(e){this.editors.yesNo.call(this,e,function(e){return{analysisDone:e,analysisFinishedAt:e?new Date:null}})},attachment:function(n){var i=this,r=n[0].dataset.attachmentId,o=e.findWhere(i.model.get("attachments"),{_id:r});n[0].scrollIntoView();var a=n[0].getBoundingClientRect(),s=t('<form class="fap-editor fap-attachments-editor"></form>').css({top:n.offset().top+"px",left:a.left+"px",width:a.width+"px"}),u=t('<input class="form-control" type="text">').prop("id",this.idPrefix+"-attachmentEditor").val(o.name),c=t('<button class="btn btn-primary"><i class="fa fa-check"></i></button>');s.on("submit",function(){var e=JSON.parse(JSON.stringify(o));e.name=u.val().trim();var t=o.name.split(".").pop();return new RegExp("\\."+t+"$","i").test(e.name)||(e.name+="."+t),e.name!==o.name&&i.model.change("attachments",[e],[o]),i.hideEditor(),!1}),s.append(u).append(c).appendTo(this.el),u.focus()},orderNo:function(e){var n=this,r=n.model.get("orderNo"),o=t('<form class="fap-editor"></form>'),a=t('<input class="form-control" type="text" pattern="^[0-9]{9}$" maxlength="9">'),u=t('<button class="btn btn-primary"><i class="fa fa-check"></i></button>');a.on("input",function(){a[0].setCustomValidity("")}),o.on("submit",function(){var e=a.val();if(e===r)return n.hideEditor(),!1;if(""===e)return n.model.multiChange({orderNo:"",mrp:"",nc12:"",productName:"",qtyTodo:0,qtyDone:0,divisions:[],lines:[]}),n.hideEditor(),!1;a.prop("disabled",!0),u.prop("disabled",!0);var t=n.ajax({method:"POST",url:"/fap/entries;validate-order?order="+e});return t.fail(function(){"abort"!==t.statusText&&(a.prop("disabled",!1),u.prop("disabled",!1),404===t.status?(a[0].setCustomValidity(n.t("orderNo:404")),u.click()):i.msg.show({type:"error",time:2500,text:n.t("orderNo:failure")}))}),t.done(function(e){e.divisions=[],e.lines.forEach(function(t){var n=s.getAllForProdLine(t).division;n&&-1===e.divisions.indexOf(n)&&e.divisions.push(n)}),e.divisions.sort(function(e,t){return e.localeCompare(t,void 0,{numeric:!0,ignorePunctuation:!0})}),n.model.multiChange(e),n.hideEditor()}),!1}),a.val(r),o.append(a).append(u).appendTo(e.find(".fap-prop-value")),a.focus()},analyzers:function(e){var n,i,r=this,o=r.$('.fap-prop[data-prop="mainAnalyzer"]'),a=r.$('.fap-prop[data-prop="analyzers"]'),s=[].concat(r.model.get("analyzers")),c=t('<form class="fap-editor"></form>').append("<input>").append('<button class="btn btn-primary"><i class="fa fa-check"></i></button>'),l=c.clone();function d(){if(i){var e=n?n.val():s;i.select2("enable",0!==e.length)}}function p(){o.removeClass("fap-is-editing"),a.removeClass("fap-is-editing");var e=[],t={},u=!0;if(n){var c=n.select2("data");c&&e.push({id:c.id,label:c.text})}else s.length?e.push(s[0]):u=!1;return e.length&&(t[e[0].id]=!0,i&&i.select2("data").forEach(function(n){t[n.id]||(e.push({id:n.id,label:n.text}),t[n.id]=!0)})),u&&function(e){var t=r.model.get("analyzers"),n=t.length?t[0].id:null,i=t.slice(1).map(function(e){return e.id}).sort().join(","),o=e.length?e[0].id:null,a=e.slice(1).map(function(e){return e.id}).sort().join(",");return o!==n||a!==i}(e)&&r.model.change("analyzers",e),r.hideEditor(),!1}o.hasClass("fap-is-editable")&&(o.addClass("fap-is-editing"),n=c.on("submit",p).appendTo(o.find(".fap-prop-value")).find("input").val(s.length?s[0].id:"").on("change",d),u(n,{view:r,dropdownCssClass:"fap-editor-select2",width:"100%",noPersonnelId:!0})),a.hasClass("fap-is-editable")&&(a.addClass("fap-is-editing"),i=l.on("submit",p).appendTo(a.find(".fap-prop-value")).find("input").val(s.length>1?s.slice(1).map(function(e){return e.id}).join(","):""),u(i,{view:r,dropdownCssClass:"fap-editor-select2",width:"100%",multiple:!0,noPersonnelId:!0})),d(),e.find(".select2-container").next().select2("focus")},mainAnalyzer:function(){this.editors.analyzers.apply(this,arguments)},componentCode:function(e){var n=this,r=n.model.get("componentCode"),o=t('<form class="fap-editor"></form>'),a=t('<input class="form-control" type="text" pattern="^[0-9]{12}$" maxlength="12">'),s=t('<button class="btn btn-primary"><i class="fa fa-check"></i></button>');a.on("input",function(){a[0].setCustomValidity("")}),o.on("submit",function(){var e=a.val();if(e===r)return n.hideEditor(),!1;if(""===e)return n.model.multiChange({componentCode:"",componentName:""}),n.hideEditor(),!1;a.prop("disabled",!0),s.prop("disabled",!0);var t=n.ajax({method:"POST",url:"/fap/entries;validate-component?nc12="+e});return t.fail(function(){if("abort"!==t.statusText){if(404!==t.status)return a.prop("disabled",!1),s.prop("disabled",!1),void i.msg.show({type:"error",time:2500,text:n.t("componentCode:failure")});n.model.multiChange({componentCode:e,componentName:""}),n.hideEditor()}}),t.done(function(e){n.model.multiChange({componentCode:e._id,componentName:e.name}),n.hideEditor()}),!1}),a.val(r),o.append(a).append(s).appendTo(e.find(".fap-prop-value")),a.focus()}}})}),define("app/nls/wmes-fap-entries",["app/nls/locale/en"],function(e){var t={lc:{pl:function(t){return e(t)},en:function(t){return e(t)}},c:function(e,t){if(!e)throw new Error("MessageFormat: Data required for '"+t+"'.")},n:function(e,t,n){if(isNaN(e[t]))throw new Error("MessageFormat: '"+t+"' isn't a number.");return e[t]-(n||0)},v:function(e,n){return t.c(e,n),e[n]},p:function(e,n,i,r,o){return t.c(e,n),e[n]in o?o[e[n]]:(n=t.lc[r](e[n]-i))in o?o[n]:o.other},s:function(e,n,i){return t.c(e,n),e[n]in i?i[e[n]]:i.other}};return{root:{"BREADCRUMB:base":function(e){return"FAP"},"BREADCRUMB:browse":function(e){return"FAP"},"BREADCRUMB:settings":function(e){return"Settings"},"BREADCRUMB:history":function(e){return"Changelog"},"BREADCRUMB:reports:count":function(e){return"Report"},"PAGE_ACTION:settings":function(e){return"Settings"},"PAGE_ACTION:jump:title":function(e){return"Jump to entry by ID"},"PAGE_ACTION:jump:placeholder":function(e){return"Entry ID"},"PAGE_ACTION:start":function(e){return"Start entry"},"PAGE_ACTION:finish":function(e){return"Finish entry"},"PAGE_ACTION:restart":function(e){return"Restart entry"},"PAGE_ACTION:markAsSeen":function(e){return"Mark as seen"},"PAGE_ACTION:subscribe":function(e){return"Turn on notifications"},"PAGE_ACTION:unsubscribe":function(e){return"Turn off notifications"},"PAGE_ACTION:history":function(e){return"Changelog"},"markAsSeen:listAction":function(e){return"Mark as seen"},"markAsSeen:noComment":function(e){return"Changes without comments"},"markAsSeen:finished":function(e){return"Finished"},"markAsSeen:dayOld":function(e){return"Older than a day"},"markAsSeen:weekOld":function(e){return"Older than a week"},"markAsSeen:all":function(e){return"All"},"PANEL:TITLE:changes":function(e){return"History"},"LIST:COLUMN:name":function(e){return"Product/component name"},"PROPERTY:rid":function(e){return"ID"},"PROPERTY:createdAt":function(e){return"Created at"},"PROPERTY:owner":function(e){return"Owner"},"PROPERTY:status":function(e){return"Status"},"PROPERTY:level":function(e){return"Level"},"PROPERTY:order":function(e){return"Order/12NC"},"PROPERTY:orderNo":function(e){return"Order no"},"PROPERTY:nc12":function(e){return"12NC"},"PROPERTY:mrp":function(e){return"MRP"},"PROPERTY:productName":function(e){return"Product name"},"PROPERTY:category":function(e){return"Category"},"PROPERTY:subCategory":function(e){return"Subcategory"},"PROPERTY:problem":function(e){return"Problem"},"PROPERTY:divisions":function(e){return"Division"},"PROPERTY:lines":function(e){return"Line"},"PROPERTY:qty":function(e){return"Quantity"},"PROPERTY:qtyTodo":function(e){return"Quantity todo"},"PROPERTY:qtyDone":function(e){return"Quantity done"},"PROPERTY:attachments":function(e){return"Attachments"},"PROPERTY:observers":function(e){return"Participants"},"PROPERTY:assessment":function(e){return"Assessment"},"PROPERTY:analysisNeed":function(e){return"Analysis needed"},"PROPERTY:analysisDone":function(e){return"Analysis done"},"PROPERTY:mainAnalyzer":function(e){return"Person responsible"},"PROPERTY:analyzers":function(e){return"People involved in the analysis"},"PROPERTY:why5":function(e){return"Problem cause"},"PROPERTY:why":function(e){return"Why?"},"PROPERTY:solution":function(e){return"Solution"},"PROPERTY:solutionSteps":function(e){return"Solution steps"},"PROPERTY:limit":function(e){return"Limit"},"PROPERTY:search":function(e){return"Text"},"PROPERTY:subdivisionType":function(e){return"Subdivision"},"PROPERTY:componentCode":function(e){return"Component"},"PROPERTY:componentName":function(e){return"Component name"},"PROPERTY:startedAt":function(e){return"Started at"},"PROPERTY:finishedAt":function(e){return"Finished at"},"PROPERTY:analysisStartedAt":function(e){return"Analysis started at"},"PROPERTY:analysisFinishedAt":function(e){return"Analysis finished at"},"PROPERTY:orderStatus":function(e){return"Current order status"},"levelIndicator:label":function(e){return"Entry escalation level"},"levelIndicator:title":function(e){return"Escalte entry to level "+t.v(e,"level")},"subdivisionType:unspecified":function(e){return"Unspecified"},"subdivisionType:assembly":function(e){return"Assembly"},"subdivisionType:press":function(e){return"Press"},"subdivisionType:wh":function(e){return"Warehouse"},"status:pending":function(e){return"Pending"},"status:started":function(e){return"Started"},"status:finished":function(e){return"Finished"},"assessment:header":function(e){return"Structural solution to the problem"},"assessment:unspecified":function(e){return"Unspecified"},"assessment:effective":function(e){return"Effective"},"assessment:ineffective":function(e){return"Ineffective"},"assessment:repeatable":function(e){return"Repeatable"},"message:pending":function(e){return"Entry awaits verification."},"message:started:true":function(e){return"Problem is being analyzed."},"message:started:false":function(e){return"Problem is being solved."},"message:finished:true":function(e){return"Entry is finished, but the analysis is still in progress."},"message:finished:false":function(e){return"Entry is finished."},"filter:user:mine":function(e){return"My entries"},"filter:user:mine:title":function(e){return"You are one of the participants"},"filter:user:unseen":function(e){return"Unread entries"},"filter:user:unseen:title":function(e){return"You are one of the participants in entries changed since your last visit"},"filter:user:others":function(e){return"Participant"},"filter:user:others:title":function(e){return"The specified user is one of the participants"},"filter:user:active":function(e){return"Active participant"},"filter:user:active:title":function(e){return"The specified user made a change in the entry"},"filter:user:creator":function(e){return"Creator"},"filter:user:creator:title":function(e){return"The specified user created the entry"},"filter:status:specific":function(e){return"Status"},"filter:status:analysis":function(e){return"Analysis"},"filter:submit":function(e){return"Filter"},"history:added":function(e){return"<i>Entry created at "+t.v(e,"time")+" on "+t.v(e,"ddd")+", "+t.v(e,"date")+".</i>"},"settings:tab:general":function(e){return"General"},"settings:general:pendingFunctions":function(e){return"Functions requiring verification"},"settings:general:pendingFunctions:help":function(e){return"Entries added by a user without assigned Function or with a Function from the following list will be added with the <em>Pending</em> status and will have to be verified by a leader."},"settings:general:categoryFunctions":function(e){return"Functions allowing category changes"},"settings:general:quickUsers":function(e){return"Users available in the quick add menu"},"quickUsers:add":function(e){return"Add new option"},"quickUsers:submit":function(e){return"Save"},"quickUsers:label":function(e){return"Label"},"quickUsers:funcs":function(e){return"Functions"},"quickUsers:users":function(e){return"Users"},"navbar:dictionaries":function(e){return"Dictionaries"},"navbar:categories":function(e){return"Categories"},"navbar:subCategories":function(e){return"Subcategories"},"navbar:settings":function(e){return"Settings"},"navbar:button":function(e){return"FAP"},"navbar:unseen":function(e){return"Unread"},"navbar:add":function(e){return"Add a new FAP"},"navbar:all":function(e){return"All"},"navbar:open":function(e){return"Open"},"navbar:pending":function(e){return"Pending"},"navbar:started":function(e){return"Started"},"navbar:finished":function(e){return"Finished"},"navbar:analysis":function(e){return"Analyzed"},"navbar:mine":function(e){return"Mine"},"navbar:reports:count":function(e){return"Report"},"addForm:subdivisions":function(e){return"Notified subdivisions"},"addForm:submit":function(e){return"Add entry"},"addForm:cancel":function(e){return"Cancel"},"addForm:orderNo:notFound":function(e){return"Order not found."},"addForm:componentCode:notFound":function(e){return"Component not found."},"addForm:notifications:subdivisions":function(e){return"Subdivisions"},"addForm:notifications:prodFunctions":function(e){return"Functions"},"addForm:copy:title":function(e){return"Copy category and problem from your last entry."},"addForm:copy:failure":function(e){return"Failed to copy the last entry."},"addForm:copy:notFound":function(e){return"You don't have any entries yet."},"upload:drop":function(e){return"Drop here any files you want to attach to the entry."},"upload:tooMany":function(e){return"You can attach at most "+t.v(e,"max")+" "+t.p(e,"max",0,"en",{one:"file",other:"files"})+"."},"upload:auth":function(e){return"Log in to add files."},"upload:failure":function(e){return"Failed to upload file: "+t.v(e,"file")},"chat:title":function(e){return"Chat"},"chat:submit":function(e){return"Send message"},"chat:send":function(e){return"Send message"},"chat:send:auth":function(e){return"Log in to send a message"},"chat:new":function(e){return"Click here to see new messages..."},"chat:status:pending:started":function(e){return"<i>Entry accepted.</i>"},"chat:status:started:finished":function(e){return"<i>Entry finished in "+t.v(e,"duration")+".</i>"},"chat:status:finished:started":function(e){return"<i>Entry restarted.</i>"},"chat:status:pending:finished":function(e){return"<i>Entry finished.</i>"},"chat:level:up":function(e){return"<i>Escalated the entry to level "+t.v(e,"level")+".</i>"},"chat:level:down":function(e){return"<i>De-escalated the entry to level "+t.v(e,"level")+".</i>"},"autolink:attachment":function(e){return"Attachment"},"autolink:product":function(e){return"12NC"},"autolink:document":function(e){return"15NC"},"autolink:order":function(e){return"Order no"},"autolink:entry":function(e){return"Entry"},"observers:message":function(e){return"Additional users will be automatically added after entry escalation."},"observers:placeholder":function(e){return"Add by last name or personnel ID..."},"observers:placeholder:auth":function(e){return"Log in to add a new participant..."},"attachments:upload":function(e){return"Add attachments"},"attachments:menu:rename":function(e){return"Change name"},"attachments:menu:remove":function(e){return"Remove file"},"orderNo:404":function(e){return"Order not found."},"orderNo:failure":function(e){return"Order validation failed."},"componentCode:404":function(e){return"Component not found."},"componentCode:failure":function(e){return"Component validation failed."},"notifications:added:title":function(e){return"New FAP entry: "+t.v(e,"rid")+" ("+t.v(e,"category")+")"},"notifications:changed:title":function(e){return"Changed FAP: "+t.v(e,"rid")},"notifications:changed:placeholder":function(e){return"Reply..."},"notifications:changed:reply":function(e){return"Send reply"},"report:title:count":function(e){return"Entry count"},"report:title:duration":function(e){return"Average entry duration [h]"},"report:title:owner":function(e){return"Entry count by owners"},"report:title:solver":function(e){return"Entry count by solvers"},"report:title:status":function(e){return"Entry count by statuses"},"report:title:level":function(e){return"Entry count by levels"},"report:title:category":function(e){return"Entry count by categories"},"report:title:subCategory":function(e){return"Entry count by subcategories"},"report:title:subdivisionType":function(e){return"Entry count by subdivisions"},"report:title:division":function(e){return"Entry count by divisions"},"report:title:mrp":function(e){return"Entry count by MRP"},"report:title:assessment":function(e){return"Entry count by assessment"},"report:title:shift":function(e){return"Entry count by production shift"},"report:title:hour":function(e){return"Entry count by creation hour"},"report:series:entry":function(e){return"Entry"},"report:series:analysis":function(e){return"Analysis"},"report:series:total":function(e){return"Total"},"report:filenames:count":function(e){return"FAP_Count"},"report:filenames:duration":function(e){return"FAP_Duration"},"report:filenames:owner":function(e){return"FAP_CountByOwners"},"report:filenames:solver":function(e){return"FAP_CountBySolvers"},"report:filenames:status":function(e){return"FAP_CountByStatuses"},"report:filenames:level":function(e){return"FAP_CountByLevels"},"report:filenames:category":function(e){return"FAP_CountByCategories"},"report:filenames:subCategory":function(e){return"FAP_CountBySubCategories"},"report:filenames:subdivisionType":function(e){return"FAP_CountBySubdivisions"},"report:filenames:division":function(e){return"FAP_CountByDivisions"},"report:filenames:mrp":function(e){return"FAP_CountByMRP"},"report:filenames:assessment":function(e){return"FAP_CountByAssessment"},"report:filenames:shift":function(e){return"FAP_CountByShift"},"report:filenames:hour":function(e){return"FAP_CountByHour"}},pl:!0}}),define("app/nls/pl/wmes-fap-entries",["app/nls/locale/pl"],function(e){var t={lc:{pl:function(t){return e(t)},en:function(t){return e(t)}},c:function(e,t){if(!e)throw new Error("MessageFormat: Data required for '"+t+"'.")},n:function(e,t,n){if(isNaN(e[t]))throw new Error("MessageFormat: '"+t+"' isn't a number.");return e[t]-(n||0)},v:function(e,n){return t.c(e,n),e[n]},p:function(e,n,i,r,o){return t.c(e,n),e[n]in o?o[e[n]]:(n=t.lc[r](e[n]-i))in o?o[n]:o.other},s:function(e,n,i){return t.c(e,n),e[n]in i?i[e[n]]:i.other}};return{"BREADCRUMB:base":function(e){return"FAP"},"BREADCRUMB:browse":function(e){return"FAP"},"BREADCRUMB:settings":function(e){return"Ustawienia"},"BREADCRUMB:history":function(e){return"Historia zmian"},"BREADCRUMB:reports:count":function(e){return"Raport"},"PAGE_ACTION:settings":function(e){return"Ustawienia"},"PAGE_ACTION:jump:title":function(e){return"Skocz do zgłoszenia po ID"},"PAGE_ACTION:jump:placeholder":function(e){return"ID zgłoszenia"},"PAGE_ACTION:start":function(e){return"Rozpocznij zgłoszenie"},"PAGE_ACTION:finish":function(e){return"Zakończ zgłoszenie"},"PAGE_ACTION:restart":function(e){return"Wznów zgłoszenie"},"PAGE_ACTION:markAsSeen":function(e){return"Oznacz jako przeczytane"},"PAGE_ACTION:subscribe":function(e){return"Włącz powiadomienia"},"PAGE_ACTION:unsubscribe":function(e){return"Wyłącz powiadomienia"},"PAGE_ACTION:history":function(e){return"Historia zmian"},"markAsSeen:listAction":function(e){return"Oznacz jako przeczytane"},"markAsSeen:success":function(e){return t.p(e,"count",0,"pl",{0:"Wszystkie zgłoszenia przeczytane!",one:"Oznaczono jedno zgłoszenie.",few:"Oznaczono "+t.v(e,"count")+" zgłoszenia.",other:"Oznaczono "+t.v(e,"count")+" zgłoszeń."})},"markAsSeen:failure":function(e){return"Oznaczanie zgłoszeń nie powiodło się."},"markAsSeen:noComment":function(e){return"Zmiany bez komentarzy"},"markAsSeen:finished":function(e){return"Zakończone"},"markAsSeen:dayOld":function(e){return"Starsze niż dzień"},"markAsSeen:weekOld":function(e){return"Starsze niż tydzień"},"markAsSeen:all":function(e){return"Wszystkie"},"PANEL:TITLE:changes":function(e){return"Historia zmian"},"LIST:COLUMN:name":function(e){return"Nazwa wyrobu/komponentu"},"PROPERTY:rid":function(e){return"ID"},"PROPERTY:createdAt":function(e){return"Czas zgłoszenia"},"PROPERTY:owner":function(e){return"Zgłaszający"},"PROPERTY:status":function(e){return"Status"},"PROPERTY:level":function(e){return"Poziom"},"PROPERTY:order":function(e){return"Zlecenie/12NC"},"PROPERTY:orderNo":function(e){return"Nr zlecenia"},"PROPERTY:nc12":function(e){return"12NC"},"PROPERTY:mrp":function(e){return"MRP"},"PROPERTY:productName":function(e){return"Nazwa wyrobu"},"PROPERTY:category":function(e){return"Kategoria"},"PROPERTY:subCategory":function(e){return"Podkategoria"},"PROPERTY:problem":function(e){return"Opis problemu"},"PROPERTY:uploads":function(e){return"Załączniki"},"PROPERTY:divisions":function(e){return"Wydział"},"PROPERTY:lines":function(e){return"Linia"},"PROPERTY:qty":function(e){return"Ilość"},"PROPERTY:qtyTodo":function(e){return"Ilość do zrobienia"},"PROPERTY:qtyDone":function(e){return"Ilość zrobiona"},"PROPERTY:attachments":function(e){return"Załączniki"},"PROPERTY:observers":function(e){return"Uczestnicy"},"PROPERTY:assessment":function(e){return"Ocena kroków gaszących"},"PROPERTY:analysisNeed":function(e){return"Potrzebna dalsza analiza"},"PROPERTY:analysisDone":function(e){return"Analiza zakończona"},"PROPERTY:mainAnalyzer":function(e){return"Osoba odpowiedzialna"},"PROPERTY:analyzers":function(e){return"Osoby biorące udział w analizie"},"PROPERTY:why5":function(e){return"Przyczyna problemu"},"PROPERTY:why":function(e){return"Dlaczego?"},"PROPERTY:solution":function(e){return"Opis rozwiązania problemu"},"PROPERTY:solutionSteps":function(e){return"Opis kroków rozwiązujących problem"},"PROPERTY:limit":function(e){return"Limit"},"PROPERTY:search":function(e){return"Tekst"},"PROPERTY:subdivisionType":function(e){return"Dział"},"PROPERTY:componentCode":function(e){return"Komponent"},"PROPERTY:componentName":function(e){return"Nazwa komponentu"},"PROPERTY:startedAt":function(e){return"Czas rozpoczęcia zgłoszenia"},"PROPERTY:finishedAt":function(e){return"Czas zakończenia zgłoszenia"},"PROPERTY:analysisStartedAt":function(e){return"Czas rozpoczęcia analizy"},"PROPERTY:analysisFinishedAt":function(e){return"Czas zakończenia analizy"},"PROPERTY:orderStatus":function(e){return"Aktualny status zlecenia"},"levelIndicator:label":function(e){return"Poziom eskalacji zgłoszenia"},"levelIndicator:title":function(e){return"Eskaluj zgłoszenie na poziom "+t.v(e,"level")},"subdivisionType:unspecified":function(e){return"Nieokreślony"},"subdivisionType:assembly":function(e){return"Montaż"},"subdivisionType:press":function(e){return"Tłocznia"},"subdivisionType:wh":function(e){return"Magazyn"},"status:pending":function(e){return"Oczekujące"},"status:started":function(e){return"Rozpoczęte"},"status:finished":function(e){return"Zakończone"},"assessment:header":function(e){return"Strukturalne rozwiązanie problemu"},"assessment:unspecified":function(e){return"Nieokreślona"},"assessment:effective":function(e){return"Skuteczne"},"assessment:ineffective":function(e){return"Nieskuteczne"},"assessment:repeatable":function(e){return"Powtarzają się"},"division:unspecified":function(e){return"Nieokreślony"},"mrp:unspecified":function(e){return"Nieokreślone"},"message:pending":function(e){return"Zgłoszenie czeka na weryfikację."},"message:started:true":function(e){return"Problem jest analizowany."},"message:started:false":function(e){return"Problem jest w trakcie rozwiązywania."},"message:finished:true":function(e){return"Zgłoszenie zostało zakończone, ale analiza nadal trwa."},"message:finished:false":function(e){return"Zgłoszenie zostało zakończone."},"filter:user:mine":function(e){return"Moje zgłoszenia"},"filter:user:mine:title":function(e){return"Znajdujesz się na liście uczestników zgłoszenia"},"filter:user:unseen":function(e){return"Nieprzeczytane zgłoszenia"},"filter:user:unseen:title":function(e){return"Znajdujesz się na liście uczestników zgłoszeń, w których dokonano zmian od Twojej ostatniej wizyty"},"filter:user:others":function(e){return"Uczestnik zgłoszenia"},"filter:user:others:title":function(e){return"Wybrany użytkownik znajduje się na liście uczestników zgłoszenia"},"filter:user:active":function(e){return"Aktywny uczestnik"},"filter:user:active:title":function(e){return"Wybrany użytkownik dokonał zmian w zgłoszeniu"},"filter:user:creator":function(e){return"Zgłaszający"},"filter:user:creator:title":function(e){return"Wybrany użytkownik dodał zgłoszenie"},"filter:status:specific":function(e){return"Status"},"filter:status:analysis":function(e){return"Analiza"},"filter:submit":function(e){return"Filtruj"},"history:added":function(e){return"<i>Utworzono zgłoszenie o "+t.v(e,"time")+" "+t.s(e,"day",{7:"w niedzielę",6:"w sobotę",3:"w środę",2:"we wtorek",other:"w "+t.v(e,"ddd")})+", "+t.v(e,"date")+".</i>"},"settings:tab:general":function(e){return"Ogólne"},"settings:general:pendingFunctions":function(e){return"Funkcje wymagające zatwierdzenia"},"settings:general:pendingFunctions:help":function(e){return"Zgłoszenia dodane przez użytkownika bez przypisanej funkcji lub z przypisaną jedną z poniższych funkcji zostaną dodane ze statusem <em>Oczekujące</em> i będą musiały być zatwierdzone przez lidera."},"settings:general:categoryFunctions":function(e){return"Funkcje zmiany kategorii"},"settings:general:quickUsers":function(e){return"Użytkownicy dostępni w menu szybkiego dodawania"},"quickUsers:add":function(e){return"Dodaj nową pozycję"},"quickUsers:submit":function(e){return"Zapisz"},"quickUsers:label":function(e){return"Etykieta"},"quickUsers:funcs":function(e){return"Funkcje"},"quickUsers:users":function(e){return"Użytkownicy"},"navbar:dictionaries":function(e){return"Słowniki"},"navbar:categories":function(e){return"Kategorie"},"navbar:subCategories":function(e){return"Podkategorie"},"navbar:settings":function(e){return"Ustawienia"},"navbar:button":function(e){return"FAP"},"navbar:unseen":function(e){return"Nieprzeczytane"},"navbar:add":function(e){return"Dodaj FAP"},"navbar:all":function(e){return"Wszystkie"},"navbar:open":function(e){return"Otwarte"},"navbar:pending":function(e){return"Oczekujące"},"navbar:started":function(e){return"Rozpoczęte"},"navbar:finished":function(e){return"Zakończone"},"navbar:analysis":function(e){return"Analizowane"},"navbar:mine":function(e){return"Moje"},"navbar:reports:count":function(e){return"Raport"},"addForm:subdivisions":function(e){return"Powiadomione działy"},"addForm:submit":function(e){return"Dodaj zgłoszenie"},"addForm:cancel":function(e){return"Anuluj"},"addForm:orderNo:notFound":function(e){return"Podane zlecenie nie istnieje."},"addForm:componentCode:notFound":function(e){return"Podany komponent nie istnieje."},"addForm:notifications:subdivisions":function(e){return"Działy"},"addForm:notifications:prodFunctions":function(e){return"Funkcje"},"addForm:copy:title":function(e){return"Kopiuj kategorię i problem z Twojego ostatniego zgłoszenia."},"addForm:copy:failure":function(e){return"Kopiowanie ostatniego zgłoszenia nie powiodło się."},"addForm:copy:notFound":function(e){return"Nie znaleziono żadnych pasujących zgłoszeń."},"upload:drop":function(e){return"Upuść tutaj pliki jakie chcesz dodać do tego zgłoszenia."},"upload:tooMany":function(e){return"Możesz załączyć maksymalnie "+t.v(e,"max")+" "+t.p(e,"max",0,"pl",{few:"pliki",one:"plik",other:"plików"})+"."},"upload:auth":function(e){return"Zaloguj się, aby dodawać pliki."},"upload:failure":function(e){return"Nie udało się załadować pliku: "+t.v(e,"file")},"chat:title":function(e){return"Czat"},"chat:submit":function(e){return"Wyślij wiadomość"},"chat:send":function(e){return"Wyślij wiadomość"},"chat:send:auth":function(e){return"Zaloguj się, aby wysłać wiadomość"},"chat:new":function(e){return"Kliknij tutaj, aby zobaczyć nowe wiadomości..."},"chat:status:pending:started":function(e){return"<i>Zaakceptowano zgłoszenie.</i>"},"chat:status:started:finished":function(e){return"<i>Zakończono zgłoszenie w "+t.v(e,"duration")+".</i>"},"chat:status:finished:started":function(e){return"<i>Wznowiono zgłoszenie.</i>"},"chat:status:pending:finished":function(e){return"<i>Zakończono zgłoszenie.</i>"},"chat:analysis:started":function(e){return"<i>Rozpoczęto analizę.</i>"},"chat:analysis:finished":function(e){return"<i>Zakończono analizę w "+t.v(e,"duration")+".</i>"},"chat:level:up":function(e){return"<i>Wyeskalowano zgłoszenie do poziomu "+t.v(e,"level")+".</i>"},"chat:level:down":function(e){return"<i>Deeskalowano zgłoszenie do poziomu "+t.v(e,"level")+".</i>"},"autolink:attachment":function(e){return"Załącznik"},"autolink:product":function(e){return"12NC"},"autolink:document":function(e){return"15NC"},"autolink:order":function(e){return"Nr zlecenia"},"autolink:entry":function(e){return"Zgłoszenie"},"observers:message":function(e){return"Dodatkowe osoby zostaną automatycznie dodane wg kategorii po eskalacji zgłoszenia."},"observers:placeholder":function(e){return"Dodaj po nazwisku lub nr kadrowym..."},"observers:placeholder:auth":function(e){return"Zaloguj się, aby dodać nową osobę..."},"attachments:upload":function(e){return"Dodaj załączniki"},"attachments:menu:rename":function(e){return"Zmień nazwę"},"attachments:menu:remove":function(e){return"Usuń plik"},"orderNo:404":function(e){return"Zlecenie nie istnieje."},"orderNo:failure":function(e){return"Sprawdzanie zlecenia nie powiodło się."},"componentCode:404":function(e){return"Komponent nie istnieje."},"componentCode:failure":function(e){return"Sprawdzanie komponentu nie powiodło się."},"notifications:added:title":function(e){return"Nowy FAP: "+t.v(e,"rid")+" ("+t.v(e,"category")+")"},"notifications:changed:title":function(e){return"Zmieniony FAP: "+t.v(e,"rid")},"notifications:changed:placeholder":function(e){return"Odpowiedź..."},"notifications:changed:reply":function(e){return"Wyślij odpowiedź"},"report:title:count":function(e){return"Ilość zgłoszeń"},"report:title:duration":function(e){return"Średni czas trwania zgłoszeń [h]"},"report:title:owner":function(e){return"Ilość zgłoszeń wg osób zgłaszających"},"report:title:solver":function(e){return"Ilość zgłoszeń wg osób rozwiązujących"},"report:title:status":function(e){return"Ilość zgłoszeń wg statusów"},"report:title:level":function(e){return"Ilość zgłoszeń wg poziomów"},"report:title:category":function(e){return"Ilość zgłoszeń wg kategorii"},"report:title:subCategory":function(e){return"Ilość zgłoszeń wg podkategorii"},"report:title:subdivisionType":function(e){return"Ilość zgłoszeń wg działów"},"report:title:division":function(e){return"Ilość zgłoszeń wg wydziałów"},"report:title:mrp":function(e){return"Ilość zgłoszeń wg MRP"},"report:title:assessment":function(e){return"Ilość zgłoszeń wg oceny kroków gaszących"},"report:title:shift":function(e){return"Ilość zgłoszeń wg zmiany produkcyjnej"},"report:title:hour":function(e){return"Ilość zgłoszeń wg godziny zgłoszenia"},"report:series:entry":function(e){return"Zgłoszenia"},"report:series:analysis":function(e){return"Analizy"},"report:series:total":function(e){return"Suma"},"report:series:unspecified":function(e){return"Suma"},"report:filenames:count":function(e){return"FAP_Ilosc"},"report:filenames:duration":function(e){return"FAP_CzasTrwania"},"report:filenames:owner":function(e){return"FAP_IloscWgZglaszajacych"},"report:filenames:solver":function(e){return"FAP_IloscWgRozwiazujacych"},"report:filenames:status":function(e){return"FAP_IloscWgStatusow"},"report:filenames:level":function(e){return"FAP_IloscWgPoziomow"},"report:filenames:category":function(e){return"FAP_IloscWgKategorii"},"report:filenames:subCategory":function(e){return"FAP_IloscWgPodKategorii"},"report:filenames:subdivisionType":function(e){return"FAP_IloscWgDzialow"},"report:filenames:division":function(e){return"FAP_IloscWgWydzialow"},"report:filenames:mrp":function(e){return"FAP_IloscWgMRP"},"report:filenames:assessment":function(e){return"FAP_IloscWgOceny"},"report:filenames:shift":function(e){return"FAP_IloscWgZmiany"},"report:filenames:hour":function(e){return"FAP_IloscWgGodziny"}}}),define("app/wmes-fap-entries/pages/DetailsPage",["underscore","jquery","app/socket","app/user","app/core/pages/DetailsPage","app/core/util/onModelDeleted","app/core/util/pageActions","../dictionaries","../views/DetailsView","i18n!app/nls/wmes-fap-entries"],function(e,t,n,i,r,o,a,s,u){"use strict";return r.extend({DetailsView:u,remoteTopicsAfterSync:!0,remoteTopics:function(){var e={"fap.entries.deleted":"onDeleted"};return e["fap.entries.updated."+this.model.id]="onUpdated",e["fap.entries.presence."+this.model.id]="onPresence",e},localTopics:{"socket.connected":"join","fap.entries.seen":function(t){var n=this.model.id;e.some(t.seenEntries,function(e){return e===n})&&this.model.handleChange({date:new Date,user:i.getInfo(),data:{},comment:""})}},actions:function(){var e=[],t=this.model.serializeDetails(),n=t.auth;return e.push({icon:"eye",label:this.t("PAGE_ACTION:markAsSeen"),callback:this.markAsSeen.bind(this),disabled:!t.observer.notify}),"viewer"!==t.observer.role&&(this.model.get("unsubscribed")[i.data._id]?e.push({icon:"bell-o",label:this.t("PAGE_ACTION:subscribe"),callback:this.subscribe.bind(this)}):e.push({icon:"bell-slash-o",label:this.t("PAGE_ACTION:unsubscribe"),callback:this.unsubscribe.bind(this)})),e.push({icon:"calendar",label:this.t("PAGE_ACTION:history"),href:this.model.genClientUrl("history")}),n.delete&&e.push(a.delete(this.model,!1)),e},initialize:function(){var n=this;r.prototype.initialize.apply(n,arguments);var i=n.model;n.listenTo(i,"updateFailure",function(){i.fetch()});var o=24!==i.id.length;n.listenToOnce(i,"sync",function(){n.listenTo(i,"sync",n.render),o&&n.broker.publish("router.navigate",{url:i.genClientUrl(),replace:!0,trigger:!1})}),n.listenTo(i,"change:observers change:unsubscribed",e.debounce(n.updateActions.bind(n),1)),n.listenTo(i,"change",n.scheduleMarkAsSeen.bind(n)),t(window).on("focus."+n.idPrefix,n.onFocus.bind(n))},setUpLayout:function(e){this.layout=e},destroy:function(){t(window).off("."+this.idPrefix),this.leave(),s.unload()},load:function(e){var n=this;if(s.loaded)return e(n.model.fetch());var i=t.Deferred();return s.load().then(function(){return n.model.fetch()}).done(function(){i.resolve()}).fail(function(){i.reject()}),e(i.promise())},afterRender:function(){r.prototype.afterRender.apply(this,arguments),s.load(),this.join()},join:function(){this.socket.emit("fap.entries.join",this.model.id)},leave:function(){this.socket.emit("fap.entries.leave",this.model.id)},subscribe:function(){this.model.change("unsubscribed",!1,!0)},unsubscribe:function(){this.model.change("unsubscribed",!0,!1)},markAsSeen:function(){this.model.serializeDetails().observer.notify&&this.model.multiChange({})},scheduleMarkAsSeen:function(){var e=this;e.timers&&(clearTimeout(e.timers.markAsSeen),e.timers.markAsSeen=setTimeout(function(){document.hasFocus()&&e.markAsSeen()},1e4))},updateActions:function(){this.layout&&this.layout.setActions(this.actions,this)},onDeleted:function(e){o(this.broker,this.model,e)},onUpdated:function(t){var i=t.change;if(n.getId()===t.socketId){var r={};if(Object.keys(i.data).forEach(function(e){/^subscribers/.test(e)&&(r[e]=i.data[e])}),e.isEmpty(r))return;i.data=r,i.comment=""}this.model.handleChange(i,t.notify)},onPresence:function(e){this.model.handlePresence(e.userId,e.presence)},onFocus:function(){this.scheduleMarkAsSeen()}})}),define("app/production/templates/sequence",["underscore","jquery","app/i18n","app/time","app/user","app/core/util/forms"],function(_,$,t,time,user,forms){return function anonymous(locals,escapeFn,include,rethrow){escapeFn=escapeFn||function(e){return void 0==e?"":String(e).replace(_MATCH_HTML,encode_char)};var _ENCODE_HTML_RULES={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&#34;","'":"&#39;"},_MATCH_HTML=/[&<>'"]/g;function encode_char(e){return _ENCODE_HTML_RULES[e]||e}var __output="";function __append(e){void 0!==e&&null!==e&&(__output+=e)}with(locals||{})__append('<div class="list production-sequence-list">\n  <div class="table-responsive">\n    <table class="table table-bordered table-hover table-condensed table-striped">\n      <thead>\n      <tr>\n        <th class="is-min">'),__append(t("sequence:shift")),__append('</th>\n        <th class="is-min">'),__append(t("sequence:order")),__append('</th>\n        <th class="is-min">'),__append(t("sequence:name")),__append('</th>\n        <th colspan="3">'),__append(t("sequence:quantity")),__append("</th>\n        <th>"),__append(t("sequence:faps")),__append("</th>\n      </tr>\n      </thead>\n      <tbody>\n      "),rows.length||(__append('\n      <tr>\n        <td colspan="7">'),__append(t("sequence:empty")),__append("</td>\n      </tr>\n      ")),__append("\n      "),rows.forEach(function(e,t){__append('\n      <tr class="'),__append(e.className),__append('">\n        <td class="is-min">'),__append(e.shift),__append('</td>\n        <td class="is-min">\n          <a href="javascript:void(0)" data-order="'),__append(t),__append('">'),__append(e.order),__append('</a>\n        </td>\n        <td class="is-min">'),__append(e.name),__append('</td>\n        <td class="is-min text-right" style="border-right: none">'),__append(e.quantityDone),__append('</td>\n        <td class="is-min" style="border-left: none; border-right: none">/</td>\n        <td class="is-min text-right" style="border-left: none">'),__append(e.quantityTodo),__append("</td>\n        <td>\n          "),e.faps.forEach(function(e,t){__append("\n          "),t>0&&__append("▪"),__append('\n          <a href="javascript:void(0)" title="'),__append(escapeFn(e.problem)),__append('" data-fap="'),__append(e._id),__append('" style="text-decoration: '),__append("finished"===e.status?"line-through":"none"),__append('">'),__append(e.rid),__append("</a>\n          ")}),__append("\n        </td>\n      </tr>\n      ")}),__append("\n      </tbody>\n    </table>\n  </div>\n</div>\n");return __output}}),define("app/production/views/SequenceView",["underscore","jquery","app/viewport","app/core/View","app/wmes-fap-entries/Entry","app/wmes-fap-entries/pages/DetailsPage","app/production/templates/sequence"],function(e,t,n,i,r,o,a){"use strict";return i.extend({template:a,events:{"click a[data-order]":function(e){var t=this.model.execution.get("todoOrders")[e.currentTarget.dataset.order];this.model.trigger("newOrderRequested",t)},"click a[data-fap]":function(e){n.msg.loading();var i=new o({dialogClassName:"production-fapEntry-dialog",model:new r({_id:e.currentTarget.dataset.fap})});i.load(t.when).fail(function(){n.msg.loadingFailed()}).done(function(){n.msg.loaded(),i.setView(i.view),n.showDialog(i)})}},remoteTopics:function(){var e={};return this.model.prodLine&&(e["old.wh.problems."+this.model.prodLine.id+".*"]="onWhProblem",e["production.fapEntries.updated"]="onFapUpdated"),e},initialize:function(){this.scheduleRender=e.debounce(this.render.bind(this),1),this.once("afterRender",function(){this.listenTo(this.model.execution,"change",this.scheduleRender),this.listenTo(this.model.prodShiftOrder,"change",this.scheduleRender)})},getTemplateData:function(){return{rows:this.serializeRows()}},serializeRows:function(){var e=this,t=e.model.prodShiftOrder.get("orderId")+e.model.prodShiftOrder.get("operationNo"),n=e.model.execution.get("whProblems")||[],i={};(e.model.execution.get("doneOrders")||[]).forEach(function(e){var t=e.orderId+e.operationNo;i[t]||(i[t]=0),i[t]+=e.quantityDone});var r={},o=(e.model.execution.get("todoOrders")||[]).map(function(o){var a=o.orderId+o.operationNo,s=o.quantityDone,u=0;i[a]>=s?(u=s,i[a]-=s):(u=i[a]||0,i[a]=0),i[a]||delete i[a];var c={className:"default",shift:e.t("core","SHIFT:"+o.shift),order:o.orderId,name:o.productName,quantityDone:u,quantityTodo:s,faps:o.fapEntries};return a===t?c.className="info":u>=s?c.className="success":-1!==n.indexOf(o.orderId)?c.className="danger":u&&(c.className="warning"),r[a]=c,c});return Object.keys(i).forEach(function(e){r[e]&&(r[e].quantityDone+=i[e])}),o},afterRender:function(){var e=this.$(".info");e.length||(e=this.$(".default").first()),e.length&&(this.$(".table-responsive")[0].scrollTop=e[0].offsetTop)},onWhProblem:function(e){if(e.order&&null!==e.state){var t=this.model.execution.get("whProblems")||[];e.state?this.model.execution.set("whProblems",t.concat([e.order])):this.model.execution.set("whProblems",t.filter(function(t){return t!==e.order}))}else this.reloadWhProblems()},reloadWhProblems:function(){var e=this;e.reloadReq||(e.reloadReq=e.ajax({url:"/old/wh/orders?select(order)&status=problem&lines._id="+encodeURIComponent(this.model.prodLine.id)}),e.reloadReq.done(function(t){var n={};(t.collection||[]).forEach(function(e){n[e.order]=1}),e.model.execution.set({whProblems:Object.keys(n)})}),e.reloadReq.always(function(){e.reloadReq=null}))},onFapUpdated:function(e){(e.added||[]).forEach(this.addFapEntry,this),(e.deleted||[]).forEach(this.deleteFapEntry,this),(e.updated||[]).forEach(this.updateFapEntry,this)},addFapEntry:function(e){var t=!1;(this.model.execution.get("todoOrders")||[]).forEach(function(n){n.orderId===e.orderNo&&(n.fapEntries.push(e),t=!0)}),t&&this.scheduleRender()},deleteFapEntry:function(e){var t=!1;(this.model.execution.get("todoOrders")||[]).forEach(function(n){var i=n.fapEntries.length;n.fapEntries=n.fapEntries.filter(function(t){return t._id!==e._id}),t=t||i!==n.fapEntries.length}),t&&this.scheduleRender()},updateFapEntry:function(e){var t=!1;(this.model.execution.get("todoOrders")||[]).forEach(function(n){n.fapEntries.forEach(function(n){n._id===e._id&&(Object.assign(n,e),t=!0)})}),t&&this.scheduleRender()}})}),define("app/production/templates/productionPage",["underscore","jquery","app/i18n","app/time","app/user","app/core/util/forms"],function(_,$,t,time,user,forms){return function anonymous(locals,escapeFn,include,rethrow){escapeFn=escapeFn||function(e){return void 0==e?"":String(e).replace(_MATCH_HTML,encode_char)};var _ENCODE_HTML_RULES={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&#34;","'":"&#39;"},_MATCH_HTML=/[&<>'"]/g;function encode_char(e){return _ENCODE_HTML_RULES[e]||e}var __output="";function __append(e){void 0!==e&&null!==e&&(__output+=e)}with(locals||{})__append('<div class="production is-'),__append(locked?"locked":"unlocked"),__append(" "),__append(state?"is-"+state:""),__append(" "),__append(mechOrder?"is-mechOrder":""),__append(' hidden">\n  <div id="'),__append(id("controls")),__append('"></div>\n  <div id="'),__append(id("header")),__append('"></div>\n  <div id="'),__append(id("data")),__append('"></div>\n  <div id="'),__append(id("execution")),__append('"></div>\n  <div class="production-ft">\n    <div class="production-sequence">\n      <h2 id="'),__append(id("sequence-header")),__append('" class="production-sectionHeader">'),__append(t("section:sequence")),__append('</h2>\n      <div id="'),__append(id("sequence")),__append('"></div>\n    </div>\n    <div class="production-taktTime">\n      <h2 class="production-sectionHeader">'),__append(t("section:taktTime")),__append('</h2>\n      <div id="'),__append(id("taktTime")),__append('"></div>\n    </div>\n    <div class="production-quantities">\n      <h2 class="production-sectionHeader">'),__append(t("section:quantities")),__append('</h2>\n      <div id="'),__append(id("quantities")),__append('"></div>\n    </div>\n    <div class="production-isa">\n      <h2 class="production-sectionHeader">'),__append(t("isa:header")),__append('</h2>\n      <div id="'),__append(id("isa")),__append('"></div>\n    </div>\n  </div>\n  <div class="production-ft">\n    <div class="production-downtimes">\n      <h2 id="'),__append(id("downtimes-header")),__append('" class="production-sectionHeader">'),__append(t("section:downtimes")),__append('</h2>\n      <div id="'),__append(id("downtimes")),__append('"></div>\n    </div>\n  </div>\n  <div id="'),__append(id("currentDowntime")),__append('" class="production-currentDowntime hidden">\n    <div id="'),__append(id("currentDowntime-message")),__append('" class="production-currentDowntime-message">\n      <div id="'),__append(id("currentDowntime-reason")),__append('"></div>\n      <div id="'),__append(id("currentDowntime-aor")),__append('" class="production-currentDowntime-aor"></div>\n      <div id="'),__append(id("currentDowntime-duration")),__append('" class="production-currentDowntime-duration"></div>\n      <div id="'),__append(id("currentDowntime-elapsedTime")),__append('"></div>\n    </div>\n  </div>\n  <div id="'),__append(id("vkb")),__append('"></div>\n  <div id="'),__append(id("message")),__append('" class="production-message hidden">\n    <div id="'),__append(id("message-outer")),__append('" class="production-message-outer">\n      <div id="'),__append(id("message-inner")),__append('" class="production-message-inner"></div>\n    </div>\n  </div>\n</div>\n');return __output}}),define("app/production/templates/duplicateWarning",["underscore","jquery","app/i18n","app/time","app/user","app/core/util/forms"],function(_,$,t,time,user,forms){return function anonymous(locals,escapeFn,include,rethrow){escapeFn=escapeFn||function(e){return void 0==e?"":String(e).replace(_MATCH_HTML,encode_char)};var _ENCODE_HTML_RULES={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&#34;","'":"&#39;"},_MATCH_HTML=/[&<>'"]/g;function encode_char(e){return _ENCODE_HTML_RULES[e]||e}var __output="";function __append(e){void 0!==e&&null!==e&&(__output+=e)}with(locals||{})__append('<div class="production-duplicate">\n  <h1>'),__append(t("duplicate:title")),__append("</h1>\n  <p>"),__append(t("duplicate:message")),__append('</p>\n  <p><button onclick="window.location.reload()" type="button" class="btn btn-primary btn-lg">'),__append(t("duplicate:button")),__append("</button></p>\n</div>\n");return __output}}),define("app/production/pages/ProductionPage",["underscore","jquery","app/time","app/user","app/i18n","app/viewport","app/updater/index","app/core/View","app/core/util/embedded","app/data/prodLog","app/data/aors","app/data/downtimeReasons","app/data/dictionaries","app/prodShifts/ProdShift","app/prodDowntimes/ProdDowntime","app/isa/IsaRequest","../snManager","../views/VkbView","../views/ProductionControlsView","../views/ProductionHeaderView","../views/ProductionDataView","../views/ProdDowntimeListView","../views/ProductionQuantitiesView","../views/IsaView","../views/TaktTimeView","../views/SpigotCheckerView","../views/ExecutionView","../views/SequenceView","app/production/templates/productionPage","app/production/templates/duplicateWarning"],function(e,t,n,i,r,o,a,s,u,c,l,d,p,f,h,m,g,v,y,_,b,w,A,k,E,T,S,C,R,P){"use strict";var N=u.isEnabled();return s.extend({template:R,layoutName:"blank",remoteTopics:function(){var e={},t=this.model.prodLine.id;return t&&(e["production.messageRequested."+t]="onMessageRequested",e["production.autoDowntimes."+this.model.get("subdivision")]="onSubdivisionAutoDowntime",e["production.autoDowntimes."+t]="onLineAutoDowntime",e["production.taktTime.snChecked."+t]="onSnChecked",e["isa.requests.created."+t+".**"]="onIsaRequestUpdated",e["isa.requests.updated."+t+".**"]="onIsaRequestUpdated",e["orders.updated.*"]="onOrderUpdated"),e},localTopics:{"socket.connected":function(){this.joinProduction()},"socket.disconnected":function(){this.leaveProduction()},"updater.frontendReloading":function(){this.model.saveLocalData()},"router.dispatching":function(e){e.path!=="/production/"+this.model.prodLine.id&&this.leaveProduction()},"production.locked":"onProductionLocked","production.duplicateDetected":"onDuplicateDetected"},events:{"click #-currentDowntime":function(){var e=this.model.prodDowntimes.findFirstUnfinished();e&&this.downtimesView.showEditDialog(e.id)},focusin:function(){clearTimeout(this.timers.blur),this.timers.blur=setTimeout(function(){document.body.classList.contains("modal-open")||document.activeElement.classList.contains("form-control")||document.activeElement.blur()},5e3)},"click #-message":"hideMessage"},breadcrumbs:function(){return[this.t("breadcrumbs:base"),this.model.getLabel()]},initialize:function(){i.getLabel=r.bound("production","userLabel"),this.delayProductionJoin=this.delayProductionJoin.bind(this),this.onBeforeUnload=this.onBeforeUnload.bind(this),this.onWindowResize=e.debounce(this.onWindowResize.bind(this),33),this.layout=null,this.shiftEditedSub=null,this.qtyDoneSub=null,this.productionJoined=0,this.enableProdLog=!1,this.pendingIsaChanges=[],a.disableViews(),this.defineViews(),this.defineBindings(),t(window).on("resize."+this.idPrefix,this.onWindowResize).on("beforeunload."+this.idPrefix,this.onBeforeUnload),N&&t(window).on("contextmenu."+this.idPrefix,function(e){e.preventDefault()}),g.bind(this)},setUpLayout:function(e){this.layout=e},destroy:function(){t(document.body).removeClass("is-production is-embedded"),t(".modal").addClass("fade"),this.layout=null,this.shiftEditedSub=null,t(window).off("."+this.idPrefix),this.model.stopShiftChangeMonitor(),a.enableViews(),c.disable()},getTemplateData:function(){return{locked:this.model.isLocked(),state:this.model.get("state"),mechOrder:!!this.model.prodShiftOrder.get("mechOrder"),showBottomControls:N}},load:function(e){var n=this,i=t.Deferred(),r=t.Deferred();return i.done(function(){n.timers.readLocalData=setTimeout(function(){n.timers.readLocalData=null,n.model.readLocalData()},1)}),i.fail(function(){document.body.innerHTML=P()}),i.always(function(){"rejected"===i.state()?(n.enableProdLog=!1,r.reject()):(n.enableProdLog=!0,r.resolve())}),c.enable(i),e(r.promise())},defineViews:function(){var e=this.model;this.vkbView=new v,this.controlsView=new y({model:e,embedded:N,vkb:this.vkbView}),this.headerView=new _({model:e,embedded:N,vkb:this.vkbView}),this.dataView=new b({model:e,embedded:N,vkb:this.vkbView}),this.downtimesView=new w({model:e,embedded:N,vkb:this.vkbView}),this.taktTimeView=new E({model:e}),this.quantitiesView=new A({model:e,embedded:N,vkb:this.vkbView}),this.isaView=new k({model:e,embedded:N,vkb:this.vkbView}),this.sequenceView=new C({model:e}),this.executionView=new S({model:e}),this.setView("#-controls",this.controlsView),this.setView("#-header",this.headerView),this.setView("#-data",this.dataView),this.setView("#-execution",this.executionView),this.setView("#-sequence",this.sequenceView),this.setView("#-downtimes",this.downtimesView),this.setView("#-taktTime",this.taktTimeView),this.setView("#-quantities",this.quantitiesView),this.setView("#-isa",this.isaView),N&&this.setView("#-vkb",this.vkbView)},defineBindings:function(){var t=this,n=t.model;t.listenTo(n,"locked",function(){t.$el.removeClass("is-unlocked").addClass("is-locked"),t.leaveProduction()}),t.listenTo(n,"unlocked",function(){t.$el.removeClass("is-locked").addClass("is-unlocked"),t.joinProduction()}),t.listenTo(n,"change:state",function(){null!==t.layout&&t.layout.setBreadcrumbs(t.breadcrumbs,t),t.$el.removeClass("is-idle is-working is-downtime").addClass("is-"+n.get("state")),t.checkSpigot(),t.updateCurrentDowntime()}),t.listenTo(n,"change:shift",function(){o.closeAllDialogs(),t.$el.hasClass("hidden")?t.$el.removeClass("hidden"):n.get("shift")&&o.msg.show({type:"info",time:2e3,text:r("production","msg:shiftChange")})}),t.listenTo(n,"change:_id",function(){t.subscribeForShiftChanges(),t.productionJoined&&(n.execution.clear(),t.timers.loadOrderQueue=setTimeout(t.loadOrderQueue.bind(t),e.random(666,6666)))}),t.listenTo(n.prodShiftOrder,"change:orderId",function(){t.subscribeForQuantityDoneChanges(0===t.productionJoined)}),t.listenTo(n.prodDowntimes,"change:finishedAt",function(){t.updateCurrentDowntime()}),t.listenTo(n,"second",function(){t.updateCurrentDowntime()}),t.listenTo(n,"orderCorrected",function(){t.checkSpigot()}),t.listenTo(n,"message:show",function(e){t.onMessageRequested({message:e})}),t.listenTo(n.prodShiftOrder,"change:mechOrder",function(){t.$el.toggleClass("is-mechOrder",n.prodShiftOrder.isMechOrder())}),t.listenTo(n.settings,"reset change",this.toggleTaktTimeView),t.listenTo(t.downtimesView,"corroborated",function(){n.saveLocalData()}),t.socket.on("production.locked",function(){t.broker.publish(t.broker,"production.locked")})},beforeRender:function(){this.enableProdLog&&(c.enable(),this.enableProdLog=!1)},afterRender:function(){t(document.body).addClass("is-production").toggleClass("is-embedded",N),t(".modal.fade").removeClass("fade"),this.toggleTaktTimeView(),this.socket.isConnected()&&this.joinProduction(),this.updateCurrentDowntime(),(this.model.isLocked()||this.model.id)&&this.$el.removeClass("hidden"),N&&window.parent.postMessage({type:"ready",app:"operator"},"*"),u.render(this),this.model.isLocked()&&this.controlsView.unlock()},onBeforeUnload:function(){if(!(this.model.isLocked()||N||(c.disable(),this.model.isIdle()||a.isFrontendReloading())))return this.timers.enableProdLog=setTimeout(c.enable.bind(c),1e3),this.model.isDowntime()?r("production","unload:downtime"):r("production","unload:order")},onWindowResize:function(){this.adjustCurrentDowntimeBox()},onProductionLocked:function(e){e.prodLine===this.model.prodLine.id&&e.secretKey===this.model.getSecretKey()&&(this.model.setSecretKey(null),o.msg.show({time:5e3,type:"warning",text:r("production","msg:locked")}),this.$el.removeClass("hidden"))},onDuplicateDetected:function(){this.remove(),document.body.innerHTML=P()},onIsaRequestUpdated:function(e){this.pendingIsaChanges?this.pendingIsaChanges.push(e):this.applyIsaChange(e)},onOrderUpdated:function(e){var t=this.model.prodShiftOrder;if(e._id===t.get("orderId")){var n=e.change.newValues.qtyMax;void 0!==n&&t.trigger("qtyMaxChanged",n)}},applyIsaChange:function(e){e=m.parse(e);var t=this.model.isaRequests,n=t.get(e._id);n?n.set(e):(t.add(e),n=t.get(e._id)),n.isCompleted()&&t.remove(n)},joinProduction:function(){var t=this,n=t.model;if(t.timers.joinProduction&&(clearTimeout(t.timers.joinProduction),delete t.timers.joinProduction),!t.productionJoined&&!n.isLocked()&&t.socket.isConnected()){if(c.isSyncing())return t.broker.subscribe("production.synced",t.delayProductionJoin).setLimit(1);if(!n.id)return t.listenToOnce(n,"change:_id",t.delayProductionJoin);var i=window.WMES_CLIENT&&window.WMES_CLIENT.config||{};if(!i.line||!i.station||n.prodLine.id===i.line&&n.prodLine.station===i.station){this.pendingIsaChanges||(this.pendingIsaChanges=[]);var r=n.prodDowntimes.findFirstUnfinished(),o={prodLineId:n.prodLine.id,prodShiftId:n.id,prodShiftOrderId:n.prodShiftOrder.id||null,prodDowntimeId:r?r.id:null,orderNo:n.prodShiftOrder.get("orderId")||null,operationNo:n.prodShiftOrder.get("operationNo")||null,dictionaries:{},orderQueue:!0};e.forEach(p,function(e,t){/^[A-Z0-9_]+$/.test(t)||(o.dictionaries[t]=e.updatedAt)}),this.socket.emit("production.join",o,function(i){i&&(i.totalQuantityDone&&n.prodShiftOrder.set("totalQuantityDone",i.totalQuantityDone),i.plannedQuantities&&(i.actualQuantities?n.updateQuantities(i.plannedQuantities,i.actualQuantities):n.updatePlannedQuantities(i.plannedQuantities)),i.prodDowntimes&&n.prodDowntimes.refresh(i.prodDowntimes),i.settings&&n.settings.reset(i.settings),i.isaRequests&&(n.isaRequests.reset(i.isaRequests.map(function(e){return m.parse(e)})),t.pendingIsaChanges&&(t.pendingIsaChanges.forEach(t.applyIsaChange,t),t.pendingIsaChanges=null)),e.isEmpty(i.orderQueue)||n.setNextOrder(i.orderQueue),n.execution.set("whProblems",i.whProblems||[]),e.isEmpty(i.execution)||n.execution.set(i.execution),e.forEach(i.dictionaries,function(e,t){p[t].reset(e)}))}),this.productionJoined=Date.now()}else t.lock()}},leaveProduction:function(){this.productionJoined&&(this.socket.isConnected()&&this.socket.emit("production.leave",this.model.prodLine.id),this.productionJoined=0)},delayProductionJoin:function(){var e=this;e.timers.joinProduction&&clearTimeout(e.timers.joinProduction),e.timers.joinProduction=setTimeout(function(){e.timers.joinProduction=null,e.joinProduction()},333)},lock:function(){this.model.setSecretKey(null),window.location.reload()},subscribeForShiftChanges:function(){this.shiftEditedSub&&(this.shiftEditedSub.cancel(),this.shiftEditedSub=null);var e=this.model;e.id&&(this.shiftEditedSub=this.pubsub.subscribe("production.edited.shift."+e.id,function(t){e.set(t)}))},subscribeForQuantityDoneChanges:function(e){this.qtyDoneSub&&(this.qtyDoneSub.cancel(),this.qtyDoneSub=null);var t=this.model.prodShiftOrder,n=t.get("orderId");n&&(this.qtyDoneSub=this.pubsub.subscribe("orders.quantityDone."+n,function(e){t.set("totalQuantityDone",e.qtyDone)}),e||this.ajax({url:"/orders?_id="+n+"&select(qtyDone)&limit(1)"}).done(function(e){if(e.collection&&e.collection.length){var n=e.collection[0];n&&n._id===t.get("orderId")&&t.set("totalQuantityDone",n.qtyDone)}}))},loadOrderQueue:function(){var e=this;e.productionJoined&&e.model.id&&e.ajax({url:"/production/planExecution/"+e.model.id}).done(function(t){e.model.setNextOrder(t.orderQueue),e.model.execution.set(t.execution)})},checkSpigot:function(){var e=this.model,t=e.prodShiftOrder.get("spigot")||null,n=e.getSpigotComponent();if(n){var i=e.getSpigotInsertComponent();if(i&&(n=i),t&&t.forceCheck)this.showSpigotDialog(n);else if("downtime"===e.get("state")&&!t&&e.isSpigotLine()){var r=e.prodDowntimes.findFirstUnfinished();if(r){var o=e.settings.getValue("rearmDowntimeReason");r.get("reason")===o&&n&&this.showSpigotDialog(n)}else window.WMES_LOG_BROWSER_ERROR&&window.WMES_LOG_BROWSER_ERROR("Spigot downtime without downtime?!? "+localStorage.getItem(e.getDataStorageKey()))}}},showSpigotDialog:function(e){var t=new T({model:this.model,component:e,embedded:N});this.broker.subscribe("viewport.dialog.hidden").setLimit(1).setFilter(function(e){return e===t}).on("message",this.checkSpigot.bind(this)),o.showDialog(t,r("production","spigotChecker:title"))},adjustCurrentDowntimeBox:function(){var e=this.$id("sequence-header"),t=e.offset();if(t){var n=this.$id("currentDowntime"),i=this.$id("currentDowntime-message").css("margin-top","");n.css({top:t.top+e.outerHeight()+1+"px",left:t.left+"px",width:e.width()+"px"}),i.css("margin-top",(n.outerHeight()-i.outerHeight())/2+"px")}},updateCurrentDowntime:function(){var e,t,i,o,a=this.$id("currentDowntime"),s=this.incomingAutoDowntime,u=this.model.prodDowntimes.findFirstUnfinished();if(u)a.removeClass("is-incoming"),e=u.getReasonLabel(),t=u.getAorLabel(),i=u.getDurationString(null,!0),o=(u.get("auto")||{d:0}).d;else{if(!s)return void a.addClass("hidden");s.remainingTime=s.startingAt-Date.now(),e=(e=d.get(s.reason))?e.getLabel():null,t=(t=l.get(this.model.getDefaultAor()))?t.getLabel():null,i=r("production","autoDowntimes:remainingTime",{time:n.toString(s.remainingTime/1e3,!1,!1)}),o=s.duration,a.addClass("is-incoming")}e&&t?(this.$id("currentDowntime-reason").text(e),this.$id("currentDowntime-aor").text(t),this.$id("currentDowntime-elapsedTime").text(i),o>0?this.$id("currentDowntime-duration").text(n.toString(60*o)).removeClass("hidden"):this.$id("currentDowntime-duration").addClass("hidden"),a.removeClass("hidden"),this.adjustCurrentDowntimeBox(),s&&s.remainingTime<-1e3&&(this.incomingAutoDowntime=null,this.model.startTimedAutoDowntime(s.reason,s.duration)),o>0&&u&&u.get("auto")&&u.getDuration()>=60*o*1e3&&this.model.endDowntime()):a.addClass("hidden")},onSubdivisionAutoDowntime:function(e){this.onAutoDowntime(e,"subdivision")},onLineAutoDowntime:function(e){this.onAutoDowntime(e,"prodLine")},onAutoDowntime:function(e,t){!this.productionJoined||"subdivision"===t&&this.model.settings.getAutoDowntimes(this.model.prodLine.id).length>0||!this.model.shouldStartTimedAutoDowntime(e.reason)||(-1===e.remainingTime?(this.incomingAutoDowntime=null,this.model.startTimedAutoDowntime(e.reason,e.duration)):(e.startingAt=Date.now()+e.remainingTime,this.incomingAutoDowntime=e,this.updateCurrentDowntime()))},createCheckSn:function(e,t,n){var i,r=this.model,o=r.get("state"),a=c.create(r,"checkSerialNumber",e),s=r.prodShiftOrder.getTaktTime(),u=r.prodShiftOrder.get("orderId");"000000000"===e.orderNo&&(e.orderNo=u),e.sapTaktTime="number"==typeof s?s:0,g.contains(e._id)?i="ALREADY_USED":g.isExtraPsnEnabled()?a=g.createDynamicLogEntry(e):"working"!==o?i="INVALID_STATE:"+o:e.orderNo!==u&&(this.socket.isConnected()?a=g.createDynamicLogEntry(e):i="INVALID_ORDER"),i?(a.data.error=i,c.record(r,a),g.showMessage(e,"error",i),n(i)):n(null,a,t)},onSnChecked:function(e){e&&"SUCCESS"===e.result&&e.instanceId!==window.INSTANCE_ID&&this.model.updateTaktTime(e)},toggleTaktTimeView:function(e){e&&e.id&&!/taktTime/.test(e.id)||this.$(".production-taktTime").toggleClass("hidden",!this.model.isTaktTimeEnabled()||!this.model.settings.showSmiley())},onMessageRequested:function(e){this.showMessage(e.message)},showMessage:function(e){var t=r.has("production","message:"+e.code)?r("production","message:"+e.code,e):e.text;if(t){this.timers.hideMessage&&(clearTimeout(this.timers.hideMessage),this.timers.hideMessage=null),e.time>=0&&(this.timers.hideMessage=setTimeout(this.hideMessage.bind(this),e.time||6e4));var n=this.$id("message");n.data("message")&&this.model.trigger("message:hidden",n.data("message"));var i=this.$id("message-outer");i.css("marginTop",""),this.$id("message-inner").html(t),n.data("message",e).attr("data-type",e.type||"info").removeClass("hidden"),i.css("marginTop",i.outerHeight()/2*-1+"px"),document.body.click(),this.model.trigger("message:shown",e)}},hideMessage:function(){this.timers.hideMessage&&(clearTimeout(this.timers.hideMessage),this.timers.hideMessage=null);var e=this.$id("message"),t=e.data("message");e.removeData("message").addClass("hidden"),t&&this.model.trigger("message:hidden",t)}})}),define("app/nls/isa",["app/nls/locale/en"],function(e){var t={lc:{pl:function(t){return e(t)},en:function(t){return e(t)}},c:function(e,t){if(!e)throw new Error("MessageFormat: Data required for '"+t+"'.")},n:function(e,t,n){if(isNaN(e[t]))throw new Error("MessageFormat: '"+t+"' isn't a number.");return e[t]-(n||0)},v:function(e,n){return t.c(e,n),e[n]},p:function(e,n,i,r,o){return t.c(e,n),e[n]in o?o[e[n]]:(n=t.lc[r](e[n]-i))in o?o[n]:o.other},s:function(e,n,i){return t.c(e,n),e[n]in i?i[e[n]]:i.other}};return{root:{"BREADCRUMB:base":function(e){return"ISA"},"BREADCRUMB:events":function(e){return"Events"},"BREADCRUMB:requests":function(e){return"Requests"},"actions:shiftPersonnel":function(e){return"Change available personnel"},"actions:responderFilter":function(e){return"Filter by warehouseman"},"actions:toggleFullscreen":function(e){return"Toggle fullscreen mode"},"actions:toggleHotkeys":function(e){return"Toggle hotkeys visibility"},"actions:showRequests":function(e){return"Show requests"},"actions:collapseEvents":function(e){return"Hide events"},"requests:header":function(e){return"To do"},"requests:empty":function(e){return"There is no requests to do."},"responses:header":function(e){return"In progress"},"responses:empty":function(e){return"There is no requests in progress."},"lineState:header:pickup":function(e){return"pallet pickup"},"lineState:header:delivery":function(e){return"<em>"+t.v(e,"palletKindFull")+"</em> delivery"},"lineState:division":function(e){return"Division"},"lineState:prodFlow":function(e){return"Flow"},"lineState:workCenter":function(e){return"WorkCenter"},"lineState:prodLine":function(e){return"Line"},"lineState:time":function(e){return"Time"},"lineState:whman":function(e){return"Warehouseman"},"pickup:failure":function(e){return"Failed to start the pickup request."},"pickup:LOCKED":function(e){return"Cannot create a new request so soon after the last one!"},"deliver:failure":function(e){return"Failed to start the delivery request."},"deliver:LOCKED":function(e){return"Cannot create a new request so soon after the last one!"},"cancel:action":function(e){return"Cancel request"},"cancel:title":function(e){return"Request cancel"},"cancel:message":function(e){return"Are you sure you want to cancel the request?"},"cancel:yes":function(e){return"Cancel request"},"cancel:no":function(e){return"No, do not cancel"},"cancel:failure":function(e){return"Failed to cancel the request."},"cancel:LOCKED":function(e){return"Cannot cancel a request so soon after it was created!"},"accept:action":function(e){return"Accept request"},"accept:failure":function(e){return"Failed to accept the request."},"accept:UNKNOWN_RESPONDER":function(e){return"Failed to accept the request: unknown user."},"accept:INVALID_RESPONDER":function(e){return"Failed to accept the request: invalid user."},"finish:action":function(e){return"Finish request"},"finish:failure":function(e){return"Failed to finish the request."},"shiftPersonnel:title":function(e){return"Available personnel"},"shiftPersonnel:message":function(e){return"Select warehousemen working on the current work shift:"},"shiftPersonnel:submit":function(e){return"Save personnel"},"shiftPersonnel:msg:failure":function(e){return"Failed to save the available personnel."},"shiftPersonnel:msg:success":function(e){return"Work shift personnel was saved!"},"responderPicker:empty":function(e){return"Shift personnel is not set!"},"events:header":function(e){return"Events"},"events:time":function(e){return"Time"},"events:line":function(e){return"Line"},"events:user":function(e){return"User"},"events:action":function(e){return"Action"},"events:pickupRequested":function(e){return"Pickup requested."},"events:deliveryRequested":function(e){return"Delivery of "+t.v(e,"palletKind->label")+" x"+t.v(e,"qty")+" requested."},"events:requestCancelled":function(e){return"Request cancelled."},"events:requestAccepted":function(e){return"Request accepted by "+t.v(e,"responder->label")+"."},"events:requestFinished":function(e){return"Request finished."},"events:shiftPersonnelUpdated":function(e){return"Work shift personnel changed."},"events:filter":function(e){return"Filter events"},"events:type:pickupRequested":function(e){return"Pickup request"},"events:type:deliveryRequested":function(e){return"Delivery request"},"events:type:requestCancelled":function(e){return"Request cancel"},"events:type:requestAccepted":function(e){return"Request accept"},"events:type:requestFinished":function(e){return"Request finish"},"events:type:shiftPersonnelUpdated":function(e){return"Work shift personnel change"},"requests:filter":function(e){return"Filter requests"},"requests:line":function(e){return"Line"},"requests:type":function(e){return"Type"},"requests:type:pickup":function(e){return"Pickup"},"requests:type:delivery":function(e){return"Delivery of <em>"+t.v(e,"palletKind")+"</em> x"+t.v(e,"qty")},"requests:status":function(e){return"Status"},"requests:status:new":function(e){return"New"},"requests:status:accepted":function(e){return"Accepted"},"requests:status:finished":function(e){return"Finished"},"requests:status:cancelled":function(e){return"Cancelled"},"requests:request":function(e){return"Request"},"requests:response":function(e){return"Response"},"requests:finish":function(e){return"Finish"},"requests:requester":function(e){return"Requester"},"requests:requestedAt":function(e){return"Requested at"},"requests:responder":function(e){return"Warehouseman"},"requests:respondedAt":function(e){return"Accepted at"},"requests:finisher":function(e){return"Finisher"},"requests:finishedAt":function(e){return"Finished at"},"requests:duration":function(e){return"Duration"},"requests:date+user":function(e){return"on "+t.v(e,"date")+" by "+t.v(e,"user")},"requests:time+user":function(e){return"at "+t.v(e,"time")+" by "+t.v(e,"user")},"hotkeys:shiftLeft+n:kbd":function(e){return"Left SHIFT+Number"},"hotkeys:shiftLeft+n:lbl":function(e){return"Accept request"},"hotkeys:altLeft+n:kbd":function(e){return"Left ALT+Number"},"hotkeys:altLeft+n:lbl":function(e){return"Finish request"},"hotkeys:shiftRight+n:kbd":function(e){return"Right SHIFT+Number"},"hotkeys:shiftRight+n:lbl":function(e){return"Cancel To do request"},"hotkeys:altRight+n:kbd":function(e){return"Right ALT+Number"},"hotkeys:altRight+n:lbl":function(e){return"Cancel In progress request"},"hotkeys:p:kbd":function(e){return"P"},"hotkeys:p:lbl":function(e){return"Personnel"},"hotkeys:f:kbd":function(e){return"F"},"hotkeys:f:lbl":function(e){return"Filter"},"msg:whmanNotFound":function(e){return"Warehouseman not found:<br>"+t.v(e,"personnelId")},"msg:noAction":function(e){return"No action for warehouseman:<br>"+t.v(e,"whman")},"msg:accept:failure":function(e){return"Failed to accept the request."},"msg:accept:header":function(e){return t.s(e,"requestType",{delivery:"Pallet delivery",other:"Pallet pickup"})},"msg:finish:failure":function(e){return"Failed to finish the request."},"msg:finish:success":function(e){return"Finish a "+t.s(e,"type",{delivery:"delivery to",other:"pickup from"})+"<br>"+t.v(e,"line")}},pl:!0}}),define("app/nls/pl/isa",["app/nls/locale/pl"],function(e){var t={lc:{pl:function(t){return e(t)},en:function(t){return e(t)}},c:function(e,t){if(!e)throw new Error("MessageFormat: Data required for '"+t+"'.")},n:function(e,t,n){if(isNaN(e[t]))throw new Error("MessageFormat: '"+t+"' isn't a number.");return e[t]-(n||0)},v:function(e,n){return t.c(e,n),e[n]},p:function(e,n,i,r,o){return t.c(e,n),e[n]in o?o[e[n]]:(n=t.lc[r](e[n]-i))in o?o[n]:o.other},s:function(e,n,i){return t.c(e,n),e[n]in i?i[e[n]]:i.other}};return{"BREADCRUMB:base":function(e){return"Pola odkładcze"},"BREADCRUMB:events":function(e){return"Zdarzenia"},"BREADCRUMB:requests":function(e){return"Żądania"},"actions:shiftPersonnel":function(e){return"Zmień personel"},"actions:responderFilter":function(e){return"Filtruj wg magazyniera"},"actions:toggleFullscreen":function(e){return"Przełącz tryb pełnoekranowy"},"actions:toggleHotkeys":function(e){return"Przełącz wyświetlanie skrótów klawiszowych"},"actions:showRequests":function(e){return"Pokaż żądania"},"actions:collapseEvents":function(e){return"Ukryj zdarzenia"},"requests:header":function(e){return"Do realizacji"},"requests:empty":function(e){return"Nie ma żadnych żądań do realizacji."},"responses:header":function(e){return"W realizacji"},"responses:empty":function(e){return"Nie ma żadnych żądań w realizacji."},"lineState:header:pickup":function(e){return"odbiór palety"},"lineState:header:delivery":function(e){return"dostawa <small>"+t.v(e,"qty")+"x</small> <small>"+t.v(e,"palletKindFull")+"</small>"},"lineState:division":function(e){return"Wydział"},"lineState:prodFlow":function(e){return"Przepływ"},"lineState:workCenter":function(e){return"WorkCenter"},"lineState:prodLine":function(e){return"Linia"},"lineState:time":function(e){return"Czas"},"lineState:whman":function(e){return"Magazynier"},"pickup:failure":function(e){return"Nie udało się rozpocząć odbioru palety."},"pickup:LOCKED":function(e){return"Nie można rozpocząć nowego żądania tak szybko po zakończeniu porzedniego!"},"deliver:failure":function(e){return"Nie udało się rozpocząć dostawy palety."},"deliver:LOCKED":function(e){return"Nie można rozpocząć nowego żądania tak szybko po zakończeniu porzedniego!"},"cancel:action":function(e){return"Anuluj żądanie"},"cancel:title":function(e){return"Anulowanie żądania"},"cancel:message":function(e){return"Czy na pewno chcesz anulować wybrane żądanie?"},"cancel:yes":function(e){return"Anuluj żądanie"},"cancel:no":function(e){return"Nie anuluj żądania"},"cancel:failure":function(e){return"Nie udało się anulować żądania."},"cancel:LOCKED":function(e){return"Nie można anulować żądania tak szybko po jego utworzeniu!"},"accept:action":function(e){return"Akceptuj żądanie"},"accept:failure":function(e){return"Nie udało się zaakceptować żądania."},"accept:UNKNOWN_RESPONDER":function(e){return"Nie udało się zaakceptować żądania: nieistniejący użytkownik."},"accept:INVALID_RESPONDER":function(e){return"Nie udało się zaakceptować żądania: nieprawidłowy użytkownik."},"finish:action":function(e){return"Zakończ żądanie"},"finish:failure":function(e){return"Nie udało się zakończyć żądania."},"shiftPersonnel:title":function(e){return"Personel zmiany"},"shiftPersonnel:message":function(e){return"Wybierz magazynierów pracujących na aktualnej zmianie:"},"shiftPersonnel:submit":function(e){return"Zapisz personel"},"shiftPersonnel:msg:failure":function(e){return"Nie udało się zapisać personelu zmiany."},"shiftPersonnel:msg:success":function(e){return"Personel zmiany został zapisany!"},"responderPicker:empty":function(e){return"Nie ustawiono personelu zmiany!"},"events:header":function(e){return"Zdarzenia"},"events:time":function(e){return"Czas"},"events:line":function(e){return"Linia"},"events:user":function(e){return"Użytkownik"},"events:action":function(e){return"Akcja"},"events:pickupRequested":function(e){return"Żądanie odbioru palety."},"events:deliveryRequested":function(e){return"Żądanie dostawy palety "+t.v(e,"palletKind->label")+" x"+t.v(e,"qty")+"."},"events:requestCancelled":function(e){return"Anulowanie żądania."},"events:requestAccepted":function(e){return"Rozpoczęcie realizacji przez "+t.v(e,"responder->label")+"."},"events:requestFinished":function(e){return"Zakończenie realizacji żądania."},"events:shiftPersonnelUpdated":function(e){return"Zmiana personelu."},"events:filter":function(e){return"Filtruj zdarzenia"},"events:type:pickupRequested":function(e){return"Żądanie odbioru"},"events:type:deliveryRequested":function(e){return"Żądanie dostawy"},"events:type:requestCancelled":function(e){return"Anulowanie żądania"},"events:type:requestAccepted":function(e){return"Rozpoczęcie realizacji"},"events:type:requestFinished":function(e){return"Zakończenie realizacji"},"events:type:shiftPersonnelUpdated":function(e){return"Zmiana personelu"},"requests:filter":function(e){return"Filtruj żądania"},"requests:line":function(e){return"Linia"},"requests:type":function(e){return"Typ"},"requests:type:pickup":function(e){return"Odbiór"},"requests:type:delivery":function(e){return"Dostawa <em>"+t.v(e,"palletKind")+"</em> x"+t.v(e,"qty")},"requests:status":function(e){return"Status"},"requests:status:new":function(e){return"Nowe"},"requests:status:accepted":function(e){return"Zaakceptowane"},"requests:status:finished":function(e){return"Zakończone"},"requests:status:cancelled":function(e){return"Anulowane"},"requests:request":function(e){return"Żądanie"},"requests:response":function(e){return"Realizacja"},"requests:finish":function(e){return"Zakończenie"},"requests:requester":function(e){return"Rozpoczęte przez"},"requests:requestedAt":function(e){return"Czas rozpoczęcia"},"requests:responder":function(e){return"Magazynier"},"requests:respondedAt":function(e){return"Czas akceptacji"},"requests:finisher":function(e){return"Zakończone przez"},"requests:finishedAt":function(e){return"Czas zakończenia"},"requests:duration":function(e){return"Czas trwania"},"requests:date+user":function(e){return t.v(e,"date")+" przez "+t.v(e,"user")},"requests:time+user":function(e){return"o "+t.v(e,"time")+" przez "+t.v(e,"user")},"hotkeys:shiftLeft+n:kbd":function(e){return"Lewy SHIFT+Liczba"},"hotkeys:shiftLeft+n:lbl":function(e){return"Akceptacja żądania"},"hotkeys:altLeft+n:kbd":function(e){return"Lewy ALT+Liczba"},"hotkeys:altLeft+n:lbl":function(e){return"Zakończenie żądania"},"hotkeys:shiftRight+n:kbd":function(e){return"Prawy SHIFT+Liczba"},"hotkeys:shiftRight+n:lbl":function(e){return"Anulowanie żądania do realizacji"},"hotkeys:altRight+n:kbd":function(e){return"Prawy ALT+Liczba"},"hotkeys:altRight+n:lbl":function(e){return"Anulowanie żądania w realizacji"},"hotkeys:p:kbd":function(e){return"P"},"hotkeys:p:lbl":function(e){return"Personel"},"hotkeys:f:kbd":function(e){return"F"},"hotkeys:f:lbl":function(e){return"Filtr"},"msg:whmanNotFound":function(e){return"Nie znaleziono magazyniera:<br>"+t.v(e,"personnelId")},"msg:noAction":function(e){return"Brak akcji dla magazyniera:<br>"+t.v(e,"whman")},"msg:accept:failure":function(e){return"Nie udało się zaakceptować żądania."},"msg:accept:header":function(e){return t.s(e,"requestType",{delivery:"Dostawa palety",other:"Odbiór palety"})},"msg:finish:failure":function(e){return"Nie udało się zakończyć żądania."},"msg:finish:success":function(e){return"Zakończono żądanie "+t.s(e,"type",{delivery:"dostawy na linię",other:"odbioru z linii"})+"<br>"+t.v(e,"line")}}}),define("app/nls/users",["app/nls/locale/en"],function(e){var t={lc:{pl:function(t){return e(t)},en:function(t){return e(t)}},c:function(e,t){if(!e)throw new Error("MessageFormat: Data required for '"+t+"'.")},n:function(e,t,n){if(isNaN(e[t]))throw new Error("MessageFormat: '"+t+"' isn't a number.");return e[t]-(n||0)},v:function(e,n){return t.c(e,n),e[n]},p:function(e,n,i,r,o){return t.c(e,n),e[n]in o?o[e[n]]:(n=t.lc[r](e[n]-i))in o?o[n]:o.other},s:function(e,n,i){return t.c(e,n),e[n]in i?i[e[n]]:i.other}};return{root:{"BREADCRUMB:browse":function(e){return"Users"},"BREADCRUMB:myAccount":function(e){return"My account"},"BREADCRUMB:settings":function(e){return"Settings"},"BREADCRUMB:logIn":function(e){return"Log in form"},"MSG:SYNCED":function(e){return"Users were synchronized successfully."},"MSG:SYNC_FAILURE":function(e){return"Failed to synchronize the users."},"PAGE_ACTION:editAccount":function(e){return"Edit account"},"PAGE_ACTION:sync":function(e){return"Synchronize with the AC database"},"PAGE_ACTION:settings":function(e){return"Settings"},"PAGE_ACTION:anonymize":function(e){return"Anonymize"},"PANEL:TITLE:details:basic":function(e){return"Basic information"},"PANEL:TITLE:details:contact":function(e){return"Contact information"},"PANEL:TITLE:details:extra":function(e){return"Additional information"},"PANEL:TITLE:details:privileges":function(e){return"Privileges"},"filter:submit":function(e){return"Filter"},"PROPERTY:login":function(e){return"Login"},"PROPERTY:password":function(e){return"Password"},"PROPERTY:newPassword":function(e){return"New password"},"PROPERTY:password2":function(e){return"Confirm password"},"PROPERTY:email":function(e){return"E-mail address"},"PROPERTY:privileges":function(e){return"Privileges"},"PROPERTY:prodFunction":function(e){return"Production function"},"PROPERTY:aors":function(e){return"Areas of responsibility"},"PROPERTY:company":function(e){return"Companies"},"PROPERTY:workplace":function(e){return"Workplace"},"PROPERTY:division":function(e){return"Division (prod.)"},"PROPERTY:personnelId":function(e){return"Personnel ID"},"PROPERTY:card":function(e){return"Card no"},"PROPERTY:cardUid":function(e){return"Card ID"},"PROPERTY:name":function(e){return"Name"},"PROPERTY:firstName":function(e){return"First name"},"PROPERTY:lastName":function(e){return"Last name"},"PROPERTY:registerDate":function(e){return"Register date"},"PROPERTY:jobTitle":function(e){return"Job title"},"PROPERTY:active":function(e){return"Account active?"},"PROPERTY:orgUnit":function(e){return"Org. unit"},"PROPERTY:prodOrgUnit":function(e){return"Org. unit (prod.)"},"PROPERTY:oshOrgUnit":function(e){return"Org. unit (react)"},"PROPERTY:vendor":function(e){return"Vendor"},"PROPERTY:gender":function(e){return"Gender"},"PROPERTY:mobile":function(e){return"Mobile phone numbers"},"PROPERTY:mrps":function(e){return"My MRPs"},"PROPERTY:notifications":function(e){return"Notifications"},"PROPERTY:apiKey":function(e){return"API key"},"PROPERTY:oshWorkplace":function(e){return"Workplace (react)"},"PROPERTY:oshDepartment":function(e){return"Division (react)"},"active:true":function(e){return"Yes"},"active:false":function(e){return"No"},"gender:female":function(e){return"Female"},"gender:male":function(e){return"Male"},"FORM:ERROR:passwordMismatch":function(e){return"The specified password do not match."},"FORM:ERROR:LOGIN_USED":function(e){return"The specified login is already used in another active account."},"FORM:HELP:password":function(e){return"Enter a new password only if you want to change the current password."},"FORM:mobile:from":function(e){return"available from"},"FORM:mobile:to":function(e){return"to"},"FORM:mobile:empty":function(e){return"No mobile numbers defined."},"FORM:mobile:item":function(e){return t.v(e,"number")+" from "+t.v(e,"fromTime")+" to "+t.v(e,"toTime")},"FORM:copyPrivileges:success":function(e){return"Privileges copied to clipboard."},"NO_DATA:aors":function(e){return"All"},"NO_DATA:company":function(e){return"Unspecified"},"NO_DATA:prodFunction":function(e){return"Unspecified"},"NO_DATA:vendor":function(e){return"All"},"DETAILS:mobile:item":function(e){return t.v(e,"number")+" from "+t.v(e,"fromTime")+" to "+t.v(e,"toTime")},"PRIVILEGE:SUPER":function(e){return"Super admin"},"PRIVILEGE:ORDERS:VIEW":function(e){return"Orders: view"},"PRIVILEGE:ORDERS:MANAGE":function(e){return"Orders: manage"},"PRIVILEGE:ORDERS:COMMENT":function(e){return"Orders: comment"},"PRIVILEGE:EVENTS:VIEW":function(e){return"Events: view"},"PRIVILEGE:EVENTS:MANAGE":function(e){return"Events: manage"},"PRIVILEGE:USERS:VIEW":function(e){return"Users: view"},"PRIVILEGE:USERS:MANAGE":function(e){return"Users: manage"},"PRIVILEGE:DICTIONARIES:VIEW":function(e){return"Dictionaries: view"},"PRIVILEGE:DICTIONARIES:MANAGE":function(e){return"Dictionaries: manage"},"PRIVILEGE:FTE:MASTER:VIEW":function(e){return"FTE (production): view"},"PRIVILEGE:FTE:MASTER:MANAGE":function(e){return"FTE (production): manage"},"PRIVILEGE:FTE:MASTER:ALL":function(e){return"FTE (production): all divisions"},"PRIVILEGE:FTE:LEADER:VIEW":function(e){return"FTE (other): view"},"PRIVILEGE:FTE:LEADER:MANAGE":function(e){return"FTE (other): manage"},"PRIVILEGE:FTE:LEADER:ALL":function(e){return"FTE (other): all divisions"},"PRIVILEGE:FTE:WH:VIEW":function(e){return"FTE (warehouse): view"},"PRIVILEGE:FTE:WH:MANAGE":function(e){return"FTE (warehouse): manage"},"PRIVILEGE:FTE:WH:ALL":function(e){return"FTE (warehouse): all divisions"},"PRIVILEGE:HOURLY_PLANS:VIEW":function(e){return"Hourly plans: view"},"PRIVILEGE:HOURLY_PLANS:MANAGE":function(e){return"Hourly plans: manage"},"PRIVILEGE:HOURLY_PLANS:ALL":function(e){return"Hourly plans: all divisions"},"PRIVILEGE:PLANNING:VIEW":function(e){return"Daily plans: view"},"PRIVILEGE:PLANNING:MANAGE":function(e){return"Daily plans: manage"},"PRIVILEGE:PLANNING:PLANNER":function(e){return"Daily plans: planner"},"PRIVILEGE:PLANNING:WHMAN":function(e){return"Daily plans: warehouseman"},"PRIVILEGE:PROD_DOWNTIMES:VIEW":function(e){return"Downtimes: view"},"PRIVILEGE:PROD_DOWNTIMES:MANAGE":function(e){return"Downtimes: corroboration"},"PRIVILEGE:PROD_DOWNTIMES:ALL":function(e){return"Downtimes: all divisions"},"PRIVILEGE:PROD_DOWNTIME_ALERTS:VIEW":function(e){return"Alerts: view"},"PRIVILEGE:PROD_DOWNTIME_ALERTS:MANAGE":function(e){return"Alerts: manage"},"PRIVILEGE:PRESS_WORKSHEETS:VIEW":function(e){return"Worksheets: view"},"PRIVILEGE:PRESS_WORKSHEETS:MANAGE":function(e){return"Worksheets: manage"},"PRIVILEGE:PROD_DATA:VIEW":function(e){return"Production data: view"},"PRIVILEGE:PROD_DATA:VIEW:EFF":function(e){return"Production data: efficiency"},"PRIVILEGE:PROD_DATA:MANAGE":function(e){return"Production data: manage"},"PRIVILEGE:PROD_DATA:MANAGE:SPIGOT_ONLY":function(e){return"Only change lines with spigot"},"PRIVILEGE:PROD_DATA:CHANGES:REQUEST":function(e){return"Production data changes: request"},"PRIVILEGE:PROD_DATA:CHANGES:MANAGE":function(e){return"Production data changes: manage"},"PRIVILEGE:REPORTS:VIEW":function(e){return"Reports: view all"},"PRIVILEGE:REPORTS:MANAGE":function(e){return"Reports: manage"},"PRIVILEGE:REPORTS:1:VIEW":function(e){return"Reports: PROD, EFF, Downtime"},"PRIVILEGE:REPORTS:2:VIEW":function(e){return"Reports: CLIP"},"PRIVILEGE:REPORTS:3:VIEW":function(e){return"Reports: OEE"},"PRIVILEGE:REPORTS:4:VIEW":function(e){return"Reports: Operators"},"PRIVILEGE:REPORTS:5:VIEW":function(e){return"Reports: HR"},"PRIVILEGE:REPORTS:6:VIEW":function(e){return"Reports: Warehouse"},"PRIVILEGE:REPORTS:7:VIEW":function(e){return"Reports: Downtimes in AORs"},"PRIVILEGE:REPORTS:8:VIEW":function(e){return"Reports: Lean"},"PRIVILEGE:REPORTS:9:VIEW":function(e){return"Reports: Planned line utilization"},"PRIVILEGE:REPORTS:REARM:VIEW":function(e){return"Reports: Retooling"},"PRIVILEGE:XICONF:VIEW":function(e){return"Xiconf: view"},"PRIVILEGE:XICONF:MANAGE":function(e){return"Xiconf: manage"},"PRIVILEGE:XICONF:MANAGE:HID_LAMPS":function(e){return"Xiconf: HID lamps: manage"},"PRIVILEGE:XICONF:NOTIFY":function(e){return"Xiconf: notify"},"PRIVILEGE:ICPO:VIEW":function(e){return"ICPO: view"},"PRIVILEGE:ICPO:MANAGE":function(e){return"ICPO: manage"},"PRIVILEGE:PURCHASE_ORDERS:VIEW":function(e){return"Purchase orders: view"},"PRIVILEGE:PURCHASE_ORDERS:MANAGE":function(e){return"Purchase orders: manage"},"PRIVILEGE:FACTORY_LAYOUT:MANAGE":function(e){return"Monitoring: manage"},"PRIVILEGE:VENDOR_NC12S:VIEW":function(e){return"12NC database: view"},"PRIVILEGE:VENDOR_NC12S:MANAGE":function(e){return"12NC database: manage"},"PRIVILEGE:KAIZEN:MANAGE":function(e){return"Near miss: manage"},"PRIVILEGE:KAIZEN:DICTIONARIES:VIEW":function(e){return"React: view dictionaries"},"PRIVILEGE:KAIZEN:DICTIONARIES:MANAGE":function(e){return"React: manage dictionaries"},"PRIVILEGE:SUGGESTIONS:MANAGE":function(e){return"Improvements: manage"},"PRIVILEGE:OSH_AUDITS:MANAGE":function(e){return"OSH audits: manage"},"PRIVILEGE:OSH_TALKS:MANAGE":function(e){return"OSH talks: manage"},"PRIVILEGE:OPERATOR:ACTIVATE":function(e){return"Client activation"},"PRIVILEGE:OPERATOR:ORDER_UNLOCK":function(e){return"WMES Operator: order unlock"},"PRIVILEGE:DOCUMENTS:VIEW":function(e){return"WMES Documents: view"},"PRIVILEGE:DOCUMENTS:MANAGE":function(e){return"WMES Documents: manage"},"PRIVILEGE:DOCUMENTS:ALL":function(e){return"WMES Documents: all subdivisions"},"PRIVILEGE:OPINION_SURVEYS:MANAGE":function(e){return"Opinion surveys: manage"},"PRIVILEGE:ISA:VIEW":function(e){return"ISA: view"},"PRIVILEGE:ISA:MANAGE":function(e){return"ISA: manage"},"PRIVILEGE:ISA:WHMAN":function(e){return"ISA: warehouseman"},"PRIVILEGE:QI:INSPECTOR":function(e){return"QI: inspector"},"PRIVILEGE:QI:SPECIALIST":function(e){return"QI: specialist"},"PRIVILEGE:QI:RESULTS:VIEW":function(e){return"QI: view results"},"PRIVILEGE:QI:RESULTS:MANAGE":function(e){return"QI: manage results"},"PRIVILEGE:QI:DICTIONARIES:VIEW":function(e){return"QI: view dictionaries"},"PRIVILEGE:QI:DICTIONARIES:MANAGE":function(e){return"QI: manage dictionaries"},"PRIVILEGE:PSCS:VIEW":function(e){return"PSCS: view"},"PRIVILEGE:PSCS:MANAGE":function(e){return"PSCS: manage"},"PRIVILEGE:D8:VIEW":function(e){return"QI: view entries"},"PRIVILEGE:D8:MANAGE":function(e){return"QI: manage entries"},"PRIVILEGE:D8:LEADER":function(e){return"QI: leader"},"PRIVILEGE:D8:DICTIONARIES:VIEW":function(e){return"QI: view dictionaries"},"PRIVILEGE:D8:DICTIONARIES:MANAGE":function(e){return"QI: manage dictionaries"},"PRIVILEGE:MOR:MANAGE":function(e){return"Matrix of responsibility: manage"},"PRIVILEGE:MOR:MANAGE:USERS":function(e){return"Matrix of responsibility: edit users"},"PRIVILEGE:PAINT_SHOP:VIEW":function(e){return"Paint shop: view"},"PRIVILEGE:PAINT_SHOP:MANAGE":function(e){return"Paint shop: manage"},"PRIVILEGE:PAINT_SHOP:PAINTER":function(e){return"Paint shop: operator"},"PRIVILEGE:PAINT_SHOP:DROP_ZONES":function(e){return"Paint shop: toggle drop zone"},"PRIVILEGE:DRILLING:VIEW":function(e){return"Drilling: view"},"PRIVILEGE:DRILLING:MANAGE":function(e){return"Drilling: manage"},"PRIVILEGE:DRILLING:DRILLER":function(e){return"Drilling: operator"},"PRIVILEGE:WIRING:VIEW":function(e){return"Wiring: view"},"PRIVILEGE:WIRING:MANAGE":function(e){return"Wiring: manage"},"PRIVILEGE:WIRING:WIRER":function(e){return"Wiring: operator"},"PRIVILEGE:KANBAN:VIEW":function(e){return"Kanban DB: view"},"PRIVILEGE:KANBAN:MANAGE":function(e){return"Kanban DB: manage"},"PRIVILEGE:KANBAN:PRINT":function(e){return"Kanban DB: printing"},"PRIVILEGE:PFEP:VIEW":function(e){return"PFEP DB: view"},"PRIVILEGE:PFEP:MANAGE":function(e){return"PFEP DB: manage"},"PRIVILEGE:TOOLCAL:VIEW":function(e){return"Tool calibration: view"},"PRIVILEGE:TOOLCAL:MANAGE":function(e){return"Tool calibration: manage"},"PRIVILEGE:TOOLCAL:DICTIONARIES:VIEW":function(e){return"Tool calibration: view dictionaries"},"PRIVILEGE:TOOLCAL:DICTIONARIES:MANAGE":function(e){return"Tool calibration: manage dictionaries"},"PRIVILEGE:FAP:MANAGE":function(e){return"FAP: manage"},"PRIVILEGE:WH:VIEW":function(e){return"WH: view"},"PRIVILEGE:WH:MANAGE":function(e){return"WH: manage"},"PRIVILEGE:WH:MANAGE:USERS":function(e){return"WH: manage users"},"PRIVILEGE:WH:MANAGE:CARTS":function(e){return"WH: manage carts"},"PRIVILEGE:WH:SOLVER":function(e){return"WH: problem solving"},"PRIVILEGE:LUMA2:VIEW":function(e){return"Luma2: view"},"PRIVILEGE:LUMA2:MANAGE":function(e){return"Luma2: manage"},"PRIVILEGE:SNF:VIEW":function(e){return"SNF: view"},"PRIVILEGE:SNF:MANAGE":function(e){return"SNF: manage"},"PRIVILEGE:TRW:VIEW":function(e){return"TRW: view"},"PRIVILEGE:TRW:MANAGE":function(e){return"TRW: manage"},"PRIVILEGE:TRW:PROGRAM":function(e){return"TRW: programming"},"PRIVILEGE:GFT:VIEW":function(e){return"GearFlex: view"},"PRIVILEGE:GFT:MANAGE":function(e){return"GearFlex: manage"},"PRIVILEGE:LUCA:VIEW":function(e){return"Luca: view"},"PRIVILEGE:LUCA:MANAGE":function(e){return"Luca: manage"},"PRIVILEGE:WMES:CLIENTS:VIEW":function(e){return"WMES clients: view"},"PRIVILEGE:WMES:CLIENTS:MANAGE":function(e){return"WMES clients: manage"},"PRIVILEGE:CT:MANAGE:ORDER_GROUPS":function(e){return"Cycle time: manage product groups"},"PRIVILEGE:DUMMY_PAINT:VIEW":function(e){return"Dummy paint: view"},"PRIVILEGE:DUMMY_PAINT:MANAGE":function(e){return"Dummy paint: manage"},"PRIVILEGE:DUMMY_PAINT:WORKER":function(e){return"Dummy paint: worker"},"PRIVILEGE:COMP_REL:VIEW":function(e){return"Comp. releases: view"},"PRIVILEGE:COMP_REL:MANAGE":function(e){return"Comp. releases: manage"},"PRIVILEGE:COMP_REL:ADD":function(e){return"Comp. releases: add"},"PRIVILEGE:OSH:COORDINATOR":function(e){return"React > Coordinator"},"PRIVILEGE:OSH:LEADER":function(e){return"React > Leader"},"PRIVILEGE:OSH:OBSERVER":function(e){return"React > Observer"},"PRIVILEGE:OSH:MANAGER":function(e){return"React > Manager"},"PRIVILEGE:OSH:NEAR_MISSES:MANAGE":function(e){return"React > Near miss: manage"},"PRIVILEGE:OSH:KAIZENS:MANAGE":function(e){return"React > Kaizen: manage"},"PRIVILEGE:OSH:ACTIONS:MANAGE":function(e){return"React > Actions: manage"},"PRIVILEGE:OSH:OBSERVATIONS:MANAGE":function(e){return"React > Observations: manage"},"PRIVILEGE:OSH:ACCIDENTS:VIEW":function(e){return"React > Accidents: view"},"PRIVILEGE:OSH:ACCIDENTS:MANAGE":function(e){return"React > Accidents: manage"},"PRIVILEGE:OSH:HR:VIEW":function(e){return"React > HR: view"},"PRIVILEGE:OSH:HR:MANAGE":function(e){return"React > HR: manage"},"PRIVILEGE:OSH:REWARDS:VIEW":function(e){return"React > Rewards: view"},"PRIVILEGE:OSH:REWARDS:MANAGE":function(e){return"React > Rewards: manage"},"PRIVILEGE:OSH:DICTIONARIES:VIEW":function(e){return"React > Dictionaries: view"},"PRIVILEGE:OSH:DICTIONARIES:MANAGE":function(e){return"React > Dictionaries: manage"},"select2:placeholder":function(e){return"Search by last name or personnel ID..."},"select2:users:system":function(e){return"System"},"LOG_IN_FORM:TITLE:LOG_IN":function(e){return"Log in form"},"LOG_IN_FORM:TITLE:RESET":function(e){return"Password reset form"},"LOG_IN_FORM:LABEL:LOGIN":function(e){return"Login"},"LOG_IN_FORM:LABEL:PASSWORD":function(e){return"Password"},"LOG_IN_FORM:LABEL:NEW_PASSWORD":function(e){return"New password"},"LOG_IN_FORM:LABEL:NEW_PASSWORD2":function(e){return"Confirm password"},"LOG_IN_FORM:SUBMIT:LOG_IN":function(e){return"Log in"},"LOG_IN_FORM:SUBMIT:RESET":function(e){return"Reset password"},"LOG_IN_FORM:LINK:LOG_IN":function(e){return"Log in"},"LOG_IN_FORM:LINK:RESET":function(e){return"Forgot your password?"},"LOG_IN_FORM:LINK:OFFICE365":function(e){return"Sign in with "+t.v(e,"OFFICE365_TENANT")},"LOG_IN_FORM:RESET:SUBJECT":function(e){return"["+t.v(e,"APP_NAME")+"] Password reset"},"LOG_IN_FORM:RESET:TEXT":function(e){return"We've received a request to reset your password for the "+t.v(e,"APP_NAME")+" app.\n\nTo change your password, please click this link:\n"+t.v(e,"resetUrl")+"\n\nPassword reset links are valid for only 24 hours. If the link expires, you will need to submit a new request here: "+t.v(e,"appUrl")+"\n\nIf you didn't request a change, please disregard this e-mail and your password will stay the same.\n\nContact your supervisor or an administrator if you need help or have questions.\n\nSincerely, the support team."},"LOG_IN_FORM:RESET:MSG:FAILURE":function(e){return"Failed to reset the password."},"LOG_IN_FORM:RESET:MSG:SUCCESS":function(e){return"Check your e-mail!"},"LOG_IN_FORM:MSG:NOT_FOUND":function(e){return"User not found."},"LOG_IN_FORM:MSG:INVALID_EMAIL":function(e){return"User doesn't have an e-mail address."},"LOG_IN_FORM:MSG:MANY_MATCHES":function(e){return"Found many users matching the specified login!"},"LOG_IN_FORM:UNKNOWN":function(e){return"Unknown login!"},"LOG_IN_FORM:UNSAFE_PASSWORD":function(e){return"<p>You can't log in, because your password is the same as your login or personnel ID.</p><p>Use the form below to set a new password for your account. Before using the new password it must be activated by clicking a link sent to the e-mail address associated with your account/</p><p>In case of any problems, contact your supervisor.</p>"},"LOG_IN_FORM:PASSWORD_MISMATCH":function(e){return"Passwords do not match."},"settings:tab:presence":function(e){return"Access control"},"settings:presence:hardware":function(e){return"Hardware"},"anonymize:title":function(e){return"User anonymization"},"anonymize:message":function(e){return"<p>Are you sure you want to anonymize the chosen user?</p><p>User's account will be deactivated and identification data removed from the database.</p><p><strong>This operation is irreversible!</strong></p>"},"anonymize:yes":function(e){return"Anonymize user"},"anonymize:no":function(e){return"Cancel"},"anonymize:started":function(e){return"User anonymization started..."},"preferences:fap_sms":function(e){return"Always send an SMS about a new FAP entry."},"preferences:fm24_sms":function(e){return"Always send an SMS about a new FM-24 ticket."},"preferences:fm24_email":function(e){return"Always send an e-mail about a new FM-24 ticket."}},pl:!0}}),define("app/nls/pl/users",["app/nls/locale/pl"],function(e){var t={lc:{pl:function(t){return e(t)},en:function(t){return e(t)}},c:function(e,t){if(!e)throw new Error("MessageFormat: Data required for '"+t+"'.")},n:function(e,t,n){if(isNaN(e[t]))throw new Error("MessageFormat: '"+t+"' isn't a number.");return e[t]-(n||0)},v:function(e,n){return t.c(e,n),e[n]},p:function(e,n,i,r,o){return t.c(e,n),e[n]in o?o[e[n]]:(n=t.lc[r](e[n]-i))in o?o[n]:o.other},s:function(e,n,i){return t.c(e,n),e[n]in i?i[e[n]]:i.other}};return{"BREADCRUMB:browse":function(e){return"Użytkownicy"},"BREADCRUMB:myAccount":function(e){return"Moje konto"},"BREADCRUMB:settings":function(e){return"Ustawienia"},"BREADCRUMB:logIn":function(e){return"Logowanie do systemu"},"MSG:SYNCED":function(e){return"Użytkownicy zostali zsynchronizowani."},"MSG:SYNC_FAILURE":function(e){return"Synchronizacja użytkowników nie powiodła się."},"PAGE_ACTION:editAccount":function(e){return"Edytuj konto"},"PAGE_ACTION:sync":function(e){return"Synchronizuj z bazą KD"},"PAGE_ACTION:settings":function(e){return"Ustawienia"},"PAGE_ACTION:anonymize":function(e){return"Anonimizuj"},"PANEL:TITLE:details:basic":function(e){return"Podstawowe informacje"},"PANEL:TITLE:details:contact":function(e){return"Dane kontaktowe"},"PANEL:TITLE:details:extra":function(e){return"Dodatkowe informacje"},"PANEL:TITLE:details:privileges":function(e){return"Uprawnienia"},"PANEL:TITLE:addForm":function(e){return"Formularz dodawania użytkownika"},"PANEL:TITLE:editForm":function(e){return"Formularz edycji użytkownika"},"filter:submit":function(e){return"Filtruj"},"PROPERTY:login":function(e){return"Login"},"PROPERTY:password":function(e){return"Hasło"},"PROPERTY:newPassword":function(e){return"Nowe hasło"},"PROPERTY:password2":function(e){return"Potwierdzenie hasła"},"PROPERTY:email":function(e){return"Adres e-mail"},"PROPERTY:privileges":function(e){return"Uprawnienia"},"PROPERTY:prodFunction":function(e){return"Funkcja na produkcji"},"PROPERTY:aors":function(e){return"Obszary odpowiedzialności"},"PROPERTY:company":function(e){return"Firma"},"PROPERTY:workplace":function(e){return"Zakład"},"PROPERTY:division":function(e){return"Wydział (prod.)"},"PROPERTY:personnelId":function(e){return"Nr kadrowy"},"PROPERTY:card":function(e){return"Nr karty"},"PROPERTY:cardUid":function(e){return"ID karty"},"PROPERTY:name":function(e){return"Imię i nazwisko"},"PROPERTY:firstName":function(e){return"Imię"},"PROPERTY:lastName":function(e){return"Nazwisko"},"PROPERTY:registerDate":function(e){return"Data rejestracji"},"PROPERTY:jobTitle":function(e){return"Stanowisko"},"PROPERTY:active":function(e){return"Konto aktywne?"},"PROPERTY:orgUnit":function(e){return"Jednostka organizacyjna"},"PROPERTY:prodOrgUnit":function(e){return"Jednostka org. (prod.)"},"PROPERTY:oshOrgUnit":function(e){return"Jednostka org. (reaguj)"},"PROPERTY:vendor":function(e){return"Dostawca"},"PROPERTY:gender":function(e){return"Płeć"},"PROPERTY:mobile":function(e){return"Telefony komórkowe"},"PROPERTY:mrps":function(e){return"Moje MRP"},"PROPERTY:notifications":function(e){return"Powiadomienia"},"PROPERTY:apiKey":function(e){return"Klucz API"},"PROPERTY:oshWorkplace":function(e){return"Zakład"},"PROPERTY:oshDepartment":function(e){return"Wydział"},"LIST:COLUMN:active":function(e){return"Aktywny?"},"active:true":function(e){return"Tak"},"active:false":function(e){return"Nie"},"gender:female":function(e){return"Żeńska"},"gender:male":function(e){return"Męska"},"FORM:ERROR:passwordMismatch":function(e){return"Podane hasła nie pasują do siebie."},"FORM:ERROR:LOGIN_USED":function(e){return"Podany login jest już wykorzystany w innym aktywnym koncie."},"FORM:HELP:password":function(e){return"Podaj hasła tylko wtedy, gdy chcesz je zmienić."},"FORM:mobile:from":function(e){return"dostępny od"},"FORM:mobile:to":function(e){return"do"},"FORM:mobile:empty":function(e){return"Brak zdefiniowanych telefonów."},"FORM:mobile:item":function(e){return t.v(e,"number")+" od "+t.v(e,"fromTime")+" do "+t.v(e,"toTime")},"FORM:copyPrivileges:success":function(e){return"Uprawnienia skopiowane."},"NO_DATA:aors":function(e){return"Wszystkie"},"NO_DATA:company":function(e){return"Nieokreślona"},"NO_DATA:prodFunction":function(e){return"Nieokreślona"},"NO_DATA:vendor":function(e){return"Wszyscy"},"DETAILS:mobile:item":function(e){return t.v(e,"number")+" od "+t.v(e,"fromTime")+" do "+t.v(e,"toTime")},"PRIVILEGE:SUPER":function(e){return"Super administrator"},"PRIVILEGE:ORDERS:VIEW":function(e){return"Zlecenia: przeglądanie"},"PRIVILEGE:ORDERS:MANAGE":function(e){return"Zlecenia: zarządzanie"},"PRIVILEGE:ORDERS:COMMENT":function(e){return"Zlecenia: komentowanie"},"PRIVILEGE:EVENTS:VIEW":function(e){return"Zdarzenia: przeglądanie"},"PRIVILEGE:EVENTS:MANAGE":function(e){return"Zdarzenia: zarządzanie"},"PRIVILEGE:USERS:VIEW":function(e){return"Użytkownicy: przeglądanie"},"PRIVILEGE:USERS:MANAGE":function(e){return"Użytkownicy: zarządzanie"},"PRIVILEGE:DICTIONARIES:VIEW":function(e){return"Słowniki: przeglądanie"},"PRIVILEGE:DICTIONARIES:MANAGE":function(e){return"Słowniki: zarządzanie"},"PRIVILEGE:FTE:MASTER:VIEW":function(e){return"FTE (produkcja): przeglądanie"},"PRIVILEGE:FTE:MASTER:MANAGE":function(e){return"FTE (produkcja): zarządzanie"},"PRIVILEGE:FTE:MASTER:ALL":function(e){return"FTE (produkcja): wszystkie wydziały"},"PRIVILEGE:FTE:LEADER:VIEW":function(e){return"FTE (inne): przeglądanie"},"PRIVILEGE:FTE:LEADER:MANAGE":function(e){return"FTE (inne): zarządzanie"},"PRIVILEGE:FTE:LEADER:ALL":function(e){return"FTE (inne): wszystkie wydziały"},"PRIVILEGE:FTE:WH:VIEW":function(e){return"FTE (magazyn): przeglądanie"},"PRIVILEGE:FTE:WH:MANAGE":function(e){return"FTE (magazyn): zarządzanie"},"PRIVILEGE:FTE:WH:ALL":function(e){return"FTE (magazyn): wszystkie wydziały"},"PRIVILEGE:HOURLY_PLANS:VIEW":function(e){return"Plany godzinowe: przeglądanie"},"PRIVILEGE:HOURLY_PLANS:MANAGE":function(e){return"Plany godzinowe: zarządzanie"},"PRIVILEGE:HOURLY_PLANS:ALL":function(e){return"Plany godzinowe: wszystkie wydziały"},"PRIVILEGE:PLANNING:VIEW":function(e){return"Plany dzienne: przeglądanie"},"PRIVILEGE:PLANNING:MANAGE":function(e){return"Plany dzienne: zarządzanie"},"PRIVILEGE:PLANNING:PLANNER":function(e){return"Plany dzienne: planista"},"PRIVILEGE:PLANNING:WHMAN":function(e){return"Plany dzienne: magazynier"},"PRIVILEGE:PROD_DOWNTIMES:VIEW":function(e){return"Przestoje: przeglądanie"},"PRIVILEGE:PROD_DOWNTIMES:MANAGE":function(e){return"Przestoje: potwierdzanie"},"PRIVILEGE:PROD_DOWNTIME_ALERTS:VIEW":function(e){return"Alarmy: przeglądanie"},"PRIVILEGE:PROD_DOWNTIME_ALERTS:MANAGE":function(e){return"Alarmy: zarządzanie"},"PRIVILEGE:PROD_DOWNTIMES:ALL":function(e){return"Przestoje: wszystkie wydziały"},"PRIVILEGE:PRESS_WORKSHEETS:VIEW":function(e){return"Karty pracy: przeglądanie"},"PRIVILEGE:PRESS_WORKSHEETS:MANAGE":function(e){return"Karty pracy: dodawanie"},"PRIVILEGE:PROD_DATA:VIEW":function(e){return"Dane produkcyjne: przeglądanie"},"PRIVILEGE:PROD_DATA:VIEW:EFF":function(e){return"Dane produkcyjne: wydajność"},"PRIVILEGE:PROD_DATA:MANAGE":function(e){return"Dane produkcyjne: zarządzanie"},"PRIVILEGE:PROD_DATA:MANAGE:SPIGOT_ONLY":function(e){return"Tylko zmiana linii ze spigotem"},"PRIVILEGE:PROD_DATA:CHANGES:REQUEST":function(e){return"Dane produkcyjne: żądanie zmian"},"PRIVILEGE:PROD_DATA:CHANGES:MANAGE":function(e){return"Dane produkcyjne: zatwierdzanie zmian"},"PRIVILEGE:REPORTS:VIEW":function(e){return"Raporty: przeglądanie wszystkich"},"PRIVILEGE:REPORTS:MANAGE":function(e){return"Raporty: zarządzanie"},"PRIVILEGE:REPORTS:1:VIEW":function(e){return"Raporty: Wskaźniki"},"PRIVILEGE:REPORTS:2:VIEW":function(e){return"Raporty: CLIP"},"PRIVILEGE:REPORTS:3:VIEW":function(e){return"Raporty: Wykorzystanie zasobów"},"PRIVILEGE:REPORTS:4:VIEW":function(e){return"Raporty: Operatorzy"},"PRIVILEGE:REPORTS:5:VIEW":function(e){return"Raporty: HR"},"PRIVILEGE:REPORTS:6:VIEW":function(e){return"Raporty: Magazyn"},"PRIVILEGE:REPORTS:7:VIEW":function(e){return"Raporty: Przestoje w obszarach"},"PRIVILEGE:REPORTS:8:VIEW":function(e){return"Raporty: Lean"},"PRIVILEGE:REPORTS:9:VIEW":function(e){return"Raporty: Planowane obciążenie linii"},"PRIVILEGE:REPORTS:REARM:VIEW":function(e){return"Raporty: Przezbrojenie"},"PRIVILEGE:XICONF:VIEW":function(e){return"Xiconf: przeglądanie"},"PRIVILEGE:XICONF:MANAGE":function(e){return"Xiconf: zarządzanie"},"PRIVILEGE:XICONF:MANAGE:HID_LAMPS":function(e){return"Xiconf: Oprawy HID: zarządzanie"},"PRIVILEGE:XICONF:NOTIFY":function(e){return"Xiconf: powiadamianie"},"PRIVILEGE:ICPO:VIEW":function(e){return"ICPO: przeglądanie"},"PRIVILEGE:ICPO:MANAGE":function(e){return"ICPO: zarządzanie"},"PRIVILEGE:PURCHASE_ORDERS:VIEW":function(e){return"Zamówienia: przeglądanie"},"PRIVILEGE:PURCHASE_ORDERS:MANAGE":function(e){return"Zamówienia: zarządzanie"},"PRIVILEGE:FACTORY_LAYOUT:MANAGE":function(e){return"Monitoring: zarządzanie"},"PRIVILEGE:VENDOR_NC12S:VIEW":function(e){return"Baza 12NC: przeglądanie"},"PRIVILEGE:VENDOR_NC12S:MANAGE":function(e){return"Baza 12NC: zarządzanie"},"PRIVILEGE:KAIZEN:MANAGE":function(e){return"ZPW: zarządzanie"},"PRIVILEGE:KAIZEN:DICTIONARIES:VIEW":function(e){return"Reaguj: przeglądanie słowników"},"PRIVILEGE:KAIZEN:DICTIONARIES:MANAGE":function(e){return"Reaguj: zarządzanie słownikami"},"PRIVILEGE:SUGGESTIONS:MANAGE":function(e){return"Usprawnienia: zarządzanie"},"PRIVILEGE:OSH_AUDITS:MANAGE":function(e){return"Audyty BHP: zarządzanie"},"PRIVILEGE:OSH_TALKS:MANAGE":function(e){return"Rozmowy BHP: zarządzanie"},"PRIVILEGE:OPERATOR:ACTIVATE":function(e){return"Aktywacja klientów"},"PRIVILEGE:OPERATOR:ORDER_UNLOCK":function(e){return"Operator WMES: odblokowywanie zlecenia"},"PRIVILEGE:DOCUMENTS:VIEW":function(e){return"Dokumenty WMES: przeglądanie"},"PRIVILEGE:DOCUMENTS:MANAGE":function(e){return"Dokumenty WMES: zarządzanie"},"PRIVILEGE:DOCUMENTS:ALL":function(e){return"Dokumenty WMES: wszystkie działy"},"PRIVILEGE:OPINION_SURVEYS:MANAGE":function(e){return"Badanie Opinia: zarządzanie"},"PRIVILEGE:ISA:VIEW":function(e){return"Pola odkładcze: przeglądanie"},"PRIVILEGE:ISA:MANAGE":function(e){return"Pola odkładcze: zarządzanie"},"PRIVILEGE:ISA:WHMAN":function(e){return"Pola odkładcze: magazynier"},"PRIVILEGE:QI:INSPECTOR":function(e){return"Inspekcja Jakości: inspektor"},"PRIVILEGE:QI:SPECIALIST":function(e){return"Inspekcja Jakości: specjalista"},"PRIVILEGE:QI:RESULTS:VIEW":function(e){return"Inspekcja Jakości: przeglądanie wyników"},"PRIVILEGE:QI:RESULTS:MANAGE":function(e){return"Inspekcja Jakości: zarządzanie wynikami"},"PRIVILEGE:QI:DICTIONARIES:VIEW":function(e){return"Inspekcja Jakości: przeglądanie słowników"},"PRIVILEGE:QI:DICTIONARIES:MANAGE":function(e){return"Inspekcja Jakości: zarządzanie słownikami"},"PRIVILEGE:PSCS:VIEW":function(e){return"PSCS: przeglądanie"},"PRIVILEGE:PSCS:MANAGE":function(e){return"PSCS: zarządzanie"},"PRIVILEGE:D8:VIEW":function(e){return"8D: przeglądanie zgłoszeń"},"PRIVILEGE:D8:MANAGE":function(e){return"8D: zarządzanie zgłoszeniami"},"PRIVILEGE:D8:LEADER":function(e){return"8D: lider"},"PRIVILEGE:D8:DICTIONARIES:VIEW":function(e){return"8D: przeglądanie słowników"},"PRIVILEGE:D8:DICTIONARIES:MANAGE":function(e){return"8D: zarządzanie słownikami"},"PRIVILEGE:MOR:MANAGE":function(e){return"Matryca odpowiedzialności: zarządzanie"},"PRIVILEGE:MOR:MANAGE:USERS":function(e){return"Matryca odpowiedzialności: edycja osób"},"PRIVILEGE:PAINT_SHOP:VIEW":function(e){return"Malarnia: przeglądanie"},"PRIVILEGE:PAINT_SHOP:MANAGE":function(e){return"Malarnia: zarządzanie"},"PRIVILEGE:PAINT_SHOP:PAINTER":function(e){return"Malarnia: operator"},"PRIVILEGE:PAINT_SHOP:DROP_ZONES":function(e){return"Malarnia: zmiana drop zone"},"PRIVILEGE:DRILLING:VIEW":function(e){return"Wiercenie: przeglądanie"},"PRIVILEGE:DRILLING:MANAGE":function(e){return"Wiercenie: zarządzanie"},"PRIVILEGE:DRILLING:DRILLER":function(e){return"Wiercenie: operator"},"PRIVILEGE:WIRING:VIEW":function(e){return"Przewody: przeglądanie"},"PRIVILEGE:WIRING:MANAGE":function(e){return"Przewody: zarządzanie"},"PRIVILEGE:WIRING:WIRER":function(e){return"Przewody: operator"},"PRIVILEGE:KANBAN:VIEW":function(e){return"Baza Kanban: przeglądanie"},"PRIVILEGE:KANBAN:MANAGE":function(e){return"Baza Kanban: zarządzanie"},"PRIVILEGE:KANBAN:PRINT":function(e){return"Baza Kanban: drukowanie"},"PRIVILEGE:PFEP:VIEW":function(e){return"Baza PFEP: przeglądanie"},"PRIVILEGE:PFEP:MANAGE":function(e){return"Baza PFEP: zarządzanie"},"PRIVILEGE:TOOLCAL:VIEW":function(e){return"Narzędzia pomiarowe: przeglądanie"},"PRIVILEGE:TOOLCAL:MANAGE":function(e){return"Narzędzia pomiarowe: zarządzanie"},"PRIVILEGE:TOOLCAL:DICTIONARIES:VIEW":function(e){return"Narzędzia pomiarowe: przeglądanie słowników"},"PRIVILEGE:TOOLCAL:DICTIONARIES:MANAGE":function(e){return"Narzędzia pomiarowe: zarządzanie słownikami"},"PRIVILEGE:FAP:MANAGE":function(e){return"FAP: zarządzanie"},"PRIVILEGE:WH:VIEW":function(e){return"Magazyn: przeglądanie"},"PRIVILEGE:WH:MANAGE":function(e){return"Magazyn: zarządzanie"},"PRIVILEGE:WH:MANAGE:USERS":function(e){return"Magazyn: zarządzanie użytkownikami"},"PRIVILEGE:WH:MANAGE:CARTS":function(e){return"Magazyn: zarządzanie wózkami"},"PRIVILEGE:WH:SOLVER":function(e){return"Magazyn: rozwiązywanie problemów"},"PRIVILEGE:LUMA2:VIEW":function(e){return"Luma2: przeglądanie"},"PRIVILEGE:LUMA2:MANAGE":function(e){return"Luma2: zarządzanie"},"PRIVILEGE:SNF:VIEW":function(e){return"SNF: przeglądanie"},"PRIVILEGE:SNF:MANAGE":function(e){return"SNF: zarządzanie"},"PRIVILEGE:TRW:VIEW":function(e){return"TRW: przeglądanie"},"PRIVILEGE:TRW:MANAGE":function(e){return"TRW: zarządzanie"},"PRIVILEGE:TRW:PROGRAM":function(e){return"TRW: programowanie"},"PRIVILEGE:GFT:VIEW":function(e){return"GearFlex: przeglądanie"},"PRIVILEGE:GFT:MANAGE":function(e){return"GearFlex: zarządzanie"},"PRIVILEGE:LUCA:VIEW":function(e){return"Luca: przeglądanie"},"PRIVILEGE:LUCA:MANAGE":function(e){return"Luca: zarządzanie"},"PRIVILEGE:WMES:CLIENTS:VIEW":function(e){return"Klienci WMES: przeglądanie"},"PRIVILEGE:WMES:CLIENTS:MANAGE":function(e){return"Klienci WMES: zarządzanie"},"PRIVILEGE:CT:MANAGE:ORDER_GROUPS":function(e){return"Czas cyklu: zarządzanie grupami wyrobów"},"PRIVILEGE:DUMMY_PAINT:VIEW":function(e){return"Dummy paint: przeglądanie"},"PRIVILEGE:DUMMY_PAINT:MANAGE":function(e){return"Dummy paint: zarządzanie"},"PRIVILEGE:DUMMY_PAINT:WORKER":function(e){return"Dummy paint: instancja SAP GUI"},"PRIVILEGE:COMP_REL:VIEW":function(e){return"Dopuszczenia: przeglądanie"},"PRIVILEGE:COMP_REL:MANAGE":function(e){return"Dopuszczenia: zarządzanie"},"PRIVILEGE:COMP_REL:ADD":function(e){return"Dopuszczenia: dodawanie"},"PRIVILEGE:OSH:COORDINATOR":function(e){return"Reaguj > Koordynator"},"PRIVILEGE:OSH:LEADER":function(e){return"Reaguj > Lider"},"PRIVILEGE:OSH:OBSERVER":function(e){return"Reaguj > Obserwator"},"PRIVILEGE:OSH:MANAGER":function(e){return"Reaguj > Kierownik"},"PRIVILEGE:OSH:NEAR_MISSES:MANAGE":function(e){return"Reaguj > ZPW: zarządzanie"},"PRIVILEGE:OSH:KAIZENS:MANAGE":function(e){return"Reaguj > Kaizen: zarządzanie"},"PRIVILEGE:OSH:ACTIONS:MANAGE":function(e){return"Reaguj > Akcje: zarządzanie"},"PRIVILEGE:OSH:OBSERVATIONS:MANAGE":function(e){return"Reaguj > Obserwacje: zarządzanie"},"PRIVILEGE:OSH:ACCIDENTS:VIEW":function(e){return"Reaguj > Wypadki: przeglądanie"},"PRIVILEGE:OSH:ACCIDENTS:MANAGE":function(e){return"Reaguj > Wypadki: zarządzanie"},"PRIVILEGE:OSH:HR:VIEW":function(e){return"Reaguj > HR: przeglądanie"},"PRIVILEGE:OSH:HR:MANAGE":function(e){return"Reaguj > HR: zarządzanie"},"PRIVILEGE:OSH:REWARDS:VIEW":function(e){return"Reaguj > Wynagrodzenie: przeglądanie"},"PRIVILEGE:OSH:REWARDS:MANAGE":function(e){return"Reaguj > Wynagrodzenie: zarządzanie"},"PRIVILEGE:OSH:DICTIONARIES:VIEW":function(e){return"BHP > Słowniki: przeglądanie"},"PRIVILEGE:OSH:DICTIONARIES:MANAGE":function(e){return"BHP > Słowniki: zarządzanie"},"select2:placeholder":function(e){return"Szukaj po nazwisku lub nr kadrowym..."},"select2:users:system":function(e){return"System"},"LOG_IN_FORM:TITLE:LOG_IN":function(e){return"Logowanie do systemu"},"LOG_IN_FORM:TITLE:RESET":function(e){return"Resetowanie hasła"},"LOG_IN_FORM:LABEL:LOGIN":function(e){return"Login"},"LOG_IN_FORM:LABEL:PASSWORD":function(e){return"Hasło"},"LOG_IN_FORM:LABEL:NEW_PASSWORD":function(e){return"Nowe hasło"},"LOG_IN_FORM:LABEL:NEW_PASSWORD2":function(e){return"Potwierdź nowe hasło"},"LOG_IN_FORM:SUBMIT:LOG_IN":function(e){return"Zaloguj się"},"LOG_IN_FORM:SUBMIT:RESET":function(e){return"Resetuj hasło"},"LOG_IN_FORM:LINK:LOG_IN":function(e){return"Zaloguj się"},"LOG_IN_FORM:LINK:RESET":function(e){return"Zapomniałeś hasła?"},"LOG_IN_FORM:LINK:OFFICE365":function(e){return"Zaloguj się za pomocą konta "+t.v(e,"OFFICE365_TENANT")},"LOG_IN_FORM:RESET:SUBJECT":function(e){return"["+t.v(e,"APP_NAME")+"] Reset hasła"},"LOG_IN_FORM:RESET:TEXT":function(e){return"Otrzymaliśmy żądanie zresetowania hasła do Twojego konta w systemie "+t.v(e,"APP_NAME")+".\n\nAby potwierdzić zmianę hasła, kliknij poniższy odnośnik:\n"+t.v(e,"resetUrl")+"\n\nOdnośnik aktywny będzie tylko przez 24 godziny. Po tym czasie możesz wygenerować nowe żądanie wchodząc do systemu: "+t.v(e,"appUrl")+"\n\nJeżeli nie chcesz zmianiać swojego hasła, zignoruj tego e-maila.\n\nW razie jakichkolwiek problemów skonsultuj się ze swoim przełożonym lub administratorem systemu."},"LOG_IN_FORM:RESET:MSG:FAILURE":function(e){return"Nie udało się zresetować hasła."},"LOG_IN_FORM:RESET:MSG:SUCCESS":function(e){return"Sprawdź swojego e-maila!"},"LOG_IN_FORM:MSG:NOT_FOUND":function(e){return"Użytkownik o podanym loginie nie istnieje."},"LOG_IN_FORM:MSG:INVALID_EMAIL":function(e){return"Użytkownik nie ma ustawionego adresu e-mail."},"LOG_IN_FORM:MSG:MANY_MATCHES":function(e){return"Znaleziono wielu użytkowników pasujących do podanego loginu!"},"LOG_IN_FORM:UNKNOWN":function(e){return"Nierozpoznany login!"},"LOG_IN_FORM:UNSAFE_PASSWORD":function(e){return"<p>Nie możesz się zalogować, ponieważ Twoje hasło jest takie samo jak login lub numer kadrowy.</p><p>Skorzystaj z poniższego formularza, aby ustawić nowe hasło dla Twojego konta. Przed użyciem nowego hasła musisz je aktywować klikając na odnośnik wysłany na adres e-mail przypisany do Twojego konta.</p><p>W razie problemów poinformuj swojego przełożonego.</p>"},"LOG_IN_FORM:PASSWORD_MISMATCH":function(e){return"Podane hasła nie pasują do siebie."},"settings:tab:presence":function(e){return"Kontrola dostępu"},"settings:presence:hardware":function(e){return"Sprzęt"},"anonymize:title":function(e){return"Anonimizacja użytkownika"},"anonymize:message":function(e){return"<p>Czy na pewno chcesz zanonimizować wybranego użytkownika?</p><p>Konto użytkownika zostanie dezaktywowane, a dane identyfikacyjne usunięte z całej bazy danych.</p><p><strong>Ta operacja jest nieodwracalna!</strong></p>"},"anonymize:yes":function(e){return"Anonimizuj użytkownika"},"anonymize:no":function(e){return"Anuluj"},"anonymize:started":function(e){return"Proces anonimizacji rozpoczęty..."},"preferences:fap_sms":function(e){return"Zawsze wysyłaj SMS o nowym zgłoszeniu FAP."},"preferences:fm24_sms":function(e){return"Wysyłaj SMS o nowym zgłoszeniu FM-24."},"preferences:fm24_email":function(e){return"Wysyłaj e-mail o nowym zgłoszeniu FM-24."}}}),define("app/nls/prodSerialNumbers",["app/nls/locale/en"],function(e){return{root:{"BREADCRUMB:browse":function(e){return"Serial numbers"},"filter:submit":function(e){return"Filter"},"PROPERTY:_id":function(e){return"Serial number"},"PROPERTY:scannedAt":function(e){return"Scan time"},"PROPERTY:iptAt":function(e){return"IPT time"},"PROPERTY:prodLine":function(e){return"Line"},"PROPERTY:orderNo":function(e){return"Order"},"PROPERTY:serialNo":function(e){return"Item no"},"PROPERTY:taktTime":function(e){return"Cycle time [s]"},"PROPERTY:iptTaktTime":function(e){return"IPT cycle time [s]"},"PROPERTY:sapTaktTime":function(e){return"Takt time [s]"},"PROPERTY:bom":function(e){return"Components"}},pl:!0}}),define("app/nls/pl/prodSerialNumbers",["app/nls/locale/pl"],function(e){return{"BREADCRUMB:browse":function(e){return"Numery seryjne"},"filter:submit":function(e){return"Filtruj"},"PROPERTY:_id":function(e){return"Nr seryjny"},"PROPERTY:scannedAt":function(e){return"Czas skanowania"},"PROPERTY:iptAt":function(e){return"Czas IPT"},"PROPERTY:prodLine":function(e){return"Linia"},"PROPERTY:orderNo":function(e){return"Zlecenie"},"PROPERTY:serialNo":function(e){return"Nr sztuki"},"PROPERTY:taktTime":function(e){return"Czas cyklu [s]"},"PROPERTY:iptTaktTime":function(e){return"Czas cyklu IPT [s]"},"PROPERTY:sapTaktTime":function(e){return"Czas taktu [s]"},"PROPERTY:bom":function(e){return"Komponenty"}}}),define("app/operator/routes",["../router","../viewport","../data/orgUnits","../data/localStorage","../prodShifts/ProdShift","../production/pages/ProductionPage","i18n!app/nls/production","i18n!app/nls/isa","i18n!app/nls/users","i18n!app/nls/prodSerialNumbers"],function(e,t,n,i,r,o){"use strict";e.map("/",function(){var e=i.getItem(r.LINE_STORAGE_KEY),a=n.getAllForProdLine(e);a.station=+i.getItem(r.STATION_STORAGE_KEY)||0,t.showPage(new o({model:new r(a,{production:!0})}))})}),define("app/wmes-operator-routes",["./operator/routes"],function(){"use strict"}),define("app/nls/core",["app/nls/locale/en"],function(e){var t={lc:{pl:function(t){return e(t)},en:function(t){return e(t)}},c:function(e,t){if(!e)throw new Error("MessageFormat: Data required for '"+t+"'.")},n:function(e,t,n){if(isNaN(e[t]))throw new Error("MessageFormat: '"+t+"' isn't a number.");return e[t]-(n||0)},v:function(e,n){return t.c(e,n),e[n]},p:function(e,n,i,r,o){return t.c(e,n),e[n]in o?o[e[n]]:(n=t.lc[r](e[n]-i))in o?o[n]:o.other},s:function(e,n,i){return t.c(e,n),e[n]in i?i[e[n]]:i.other}};return{root:{APP_NAME:function(e){return"WMES"},TITLE:function(e){return"WMES"},"MSG:LOADING":function(e){return"<i class='fa fa-spinner fa-spin'></i><span>Loading...</span>"},"MSG:LOADING_FAILURE":function(e){return"Loading failed."},"MSG:LOADING_SINGLE_FAILURE":function(e){return"Loading failed."},"MSG:SAVING":function(e){return"<i class='fa fa-spinner fa-spin'></i><span>Saving...</span>"},"MSG:SAVING_FAILURE":function(e){return"Saving failed."},"MSG:EXPORTING":function(e){return"<i class='fa fa-spinner fa-spin'></i><span>Exporting...</span>"},"MSG:EXPORTING_FAILURE":function(e){return"Exporting failed."},"MSG:IMPORTING":function(e){return"<i class='fa fa-spinner fa-spin'></i><span>Importing...</span>"},"MSG:IMPORTING_FAILURE":function(e){return"Importing failed."},"MSG:LOG_OUT:FAILURE":function(e){return"Logging out failed."},"MSG:LOG_OUT:SUCCESS":function(e){return"You are now logged out!"},"MSG:POPUP_BLOCKED":function(e){return"Popup window was blocked."},"MSG:DELETED":function(e){return"Deleted: <em>"+t.v(e,"label")+"</em>."},"PAGE_ACTION:add":function(e){return"Add"},"PAGE_ACTION:edit":function(e){return"Edit"},"PAGE_ACTION:delete":function(e){return"Delete"},"PAGE_ACTION:filter":function(e){return"Filter"},"PAGE_ACTION:print":function(e){return"Print"},"PAGE_ACTION:import":function(e){return"Import"},"PAGE_ACTION:export":function(e){return"Export"},"PAGE_ACTION:export:csv":function(e){return"Export to CSV"},"PAGE_ACTION:export:xlsx":function(e){return"Export to XLSX"},"PAGE_ACTION:jump:title":function(e){return"Jump to details by ID"},"PAGE_ACTION:jump:placeholder":function(e){return"ID"},"LIST:COLUMN:actions":function(e){return"Actions"},"LIST:NO_DATA":function(e){return"No data."},"LIST:NO_DATA:cell":function(e){return""},"LIST:ACTION:viewDetails":function(e){return"View details"},"LIST:ACTION:edit":function(e){return"Edit"},"LIST:ACTION:delete":function(e){return"Delete"},"LIST:ACTION:print":function(e){return"Print"},"BREADCRUMB:addForm":function(e){return"Adding"},"BREADCRUMB:editForm":function(e){return"Editing"},"BREADCRUMB:ACTION_FORM:delete":function(e){return"Deleting"},"ERROR:notify:message":function(e){return"Click here to notify the admin about the error."},"ERROR:notify:placeholder":function(e){return"Comment..."},"ERROR:notify:success":function(e){return"The admin was notified!"},"ERROR:notify:failure":function(e){return"Failed to notify the admin."},"ERROR:notify:subject":function(e){return"["+t.v(e,"APP_NAME")+"] Error "+t.v(e,"code")+" from "+t.v(e,"user")},"ERROR:0:title":function(e){return"Error during loading"},"ERROR:0:message":function(e){return"Unexpected error during the execution of the request. Check whether you have a connection to the network and <a href=# data-reload>reload the page</a>."},"ERROR:400:title":function(e){return"Error 400: bad request"},"ERROR:400:message":function(e){return"The request cannot be fulfilled due to bad syntax."},"ERROR:403:title":function(e){return"Error 403: forbidden"},"ERROR:403:message":function(e){return"You do not have the right privileges to perform the requested action."},"ERROR:404:title":function(e){return"Error 404: not found"},"ERROR:404:message":function(e){return"The requested resource could not be found."},"ERROR:500:title":function(e){return"Error 500: internal server error"},"ERROR:500:message":function(e){return"Server encountered an unexpected condition that prevented it from completing the request."},"PAGINATION:FIRST_PAGE":function(e){return"First page"},"PAGINATION:PREV_PAGE":function(e){return"Previous page"},"PAGINATION:NEXT_PAGE":function(e){return"Next page"},"PAGINATION:LAST_PAGE":function(e){return"Last page"},"BOOL:true":function(e){return"Yes"},"BOOL:false":function(e){return"No"},"BOOL:null":function(e){return"N/A"},"#":function(e){return"No."},GUEST_USER_NAME:function(e){return"Guest"},"NAVBAR:TOGGLE":function(e){return"Show menu"},"NAVBAR:DASHBOARD":function(e){return"Dashboard"},"NAVBAR:EVENTS":function(e){return"Events"},"NAVBAR:ORDERS":function(e){return"Orders"},"NAVBAR:MECH_ORDERS":function(e){return"Mechanical orders"},"NAVBAR:OTHER_ORDERS":function(e){return"Production orders"},"NAVBAR:EMPTY_ORDERS":function(e){return"Empty WMES orders"},"NAVBAR:LINES":function(e){return"Production lines"},"NAVBAR:USERS":function(e){return"Users"},"NAVBAR:MY_ACCOUNT":function(e){return"My account"},"NAVBAR:UI_LOCALE":function(e){return"UI locale"},"NAVBAR:LOCALE_PL":function(e){return"In Polish"},"NAVBAR:LOCALE_US":function(e){return"In English"},"NAVBAR:LOG_IN":function(e){return"Log in"},"NAVBAR:LOG_OUT":function(e){return"Log out"},"NAVBAR:DICTIONARIES":function(e){return"Dictionaries"},"NAVBAR:TOOLS":function(e){return"Tools"},"NAVBAR:ORDER_STATUSES":function(e){return"Order statuses"},"NAVBAR:DELAY_REASONS":function(e){return"Delay reasons"},"NAVBAR:DOWNTIME_REASONS":function(e){return"Downtime reasons"},"NAVBAR:LOSS_REASONS":function(e){return"Loss reasons"},"NAVBAR:AORS":function(e){return"Areas of responsibility"},"NAVBAR:WORK_CENTERS":function(e){return"WorkCenters"},"NAVBAR:COMPANIES":function(e){return"Companies"},"NAVBAR:DIVISIONS":function(e){return"Divisions"},"NAVBAR:SUBDIVISIONS":function(e){return"Subdivisions"},"NAVBAR:MRP_CONTROLLERS":function(e){return"MRP Controllers"},"NAVBAR:PROD_FUNCTIONS":function(e){return"Functions"},"NAVBAR:PROD_FLOWS":function(e){return"Production flows"},"NAVBAR:PROD_TASKS":function(e){return"Production tasks"},"NAVBAR:PROD_LINES":function(e){return"Production lines"},"NAVBAR:PLANNING:main":function(e){return"Planning"},"NAVBAR:PLANNING:plans":function(e){return"Plans"},"NAVBAR:PLANNING:hourly":function(e){return"hourly"},"NAVBAR:PLANNING:daily":function(e){return"daily"},"NAVBAR:PLANNING:drilling":function(e){return"Drilling"},"NAVBAR:PLANNING:wiring":function(e){return"Wiring"},"NAVBAR:PLANNING:paintShop":function(e){return"Paint shop"},"NAVBAR:PLANNING:paintShop:load":function(e){return"Load"},"NAVBAR:PLANNING:wh":function(e){return"Warehouse"},"NAVBAR:PLANNING:wh:old":function(e){return"old"},"NAVBAR:PLANNING:wh:new":function(e){return"new"},"NAVBAR:PLANNING:wh:pickup":function(e){return"Pickup"},"NAVBAR:PLANNING:wh:delivery:components":function(e){return"FIFO delivery"},"NAVBAR:PLANNING:wh:delivery:packaging":function(e){return"Packaging delivery"},"NAVBAR:PLANNING:wh:delivery:ps":function(e){return"Paint-shop delivery"},"NAVBAR:PLANNING:wh:problems":function(e){return"Problems"},"NAVBAR:PLANNING:wh:deliveredOrders":function(e){return"Delivered orders"},"NAVBAR:PLANNING:wh:downtimes":function(e){return"Downtimes"},"NAVBAR:PLANNING:wh:setCarts":function(e){return"Carts"},"NAVBAR:PLANNING:wh:lines":function(e){return"Lines"},"NAVBAR:PLANNING:wh:events":function(e){return"Events"},"NAVBAR:PLANNING:wh:settings":function(e){return"Settings"},"NAVBAR:PLANNING:all":function(e){return"All"},"NAVBAR:PLANNING:-1d":function(e){return"Yesterday"},"NAVBAR:PLANNING:0d":function(e){return"Today"},"NAVBAR:PLANNING:1d":function(e){return"Tomorrow"},"NAVBAR:PLANNING:2d":function(e){return"Day after tomorrow"},"NAVBAR:PLANNING:2d:help":function(e){return"Plan available around 17:00."},"NAVBAR:FTE":function(e){return"FTE"},"NAVBAR:FTE:MASTER":function(e){return"Production"},"NAVBAR:FTE:WH":function(e){return"Warehouse"},"NAVBAR:FTE:LEADER":function(e){return"Other"},"NAVBAR:FTE:SETTINGS":function(e){return"Settings"},"NAVBAR:VIS":function(e){return"Visualization"},"NAVBAR:VIS:STRUCTURE":function(e){return"Org Unit structure"},"NAVBAR:PRESS_WORKSHEETS":function(e){return"Worksheets"},"NAVBAR:REPORTS":function(e){return"Reports"},"NAVBAR:REPORTS:1":function(e){return"PROD, EFF, Downtime"},"NAVBAR:REPORTS:clip":function(e){return"CLIP"},"NAVBAR:REPORTS:3":function(e){return"OEE"},"NAVBAR:REPORTS:4":function(e){return"Operators"},"NAVBAR:REPORTS:5":function(e){return"HR"},"NAVBAR:REPORTS:6":function(e){return"Warehouse"},"NAVBAR:REPORTS:7":function(e){return"Downtimes in AORs"},"NAVBAR:REPORTS:8":function(e){return"Lean"},"NAVBAR:REPORTS:9":function(e){return"Planned line utilization"},"NAVBAR:REPORTS:rearm":function(e){return"Retooling"},"NAVBAR:REPORTS:ct":function(e){return"Cycle Time"},"NAVBAR:REPORTS:ct:pce":function(e){return"PCEs"},"NAVBAR:REPORTS:ct:groups":function(e){return"Product groups"},"NAVBAR:REPORTS:ct:results":function(e){return"Results"},"NAVBAR:PROD":function(e){return"Production"},"NAVBAR:PROD:DATA":function(e){return"Production data"},"NAVBAR:PROD:LOG_ENTRIES":function(e){return"Operation log"},"NAVBAR:PROD:SHIFTS":function(e){return"Shifts"},"NAVBAR:PROD:SHIFT_ORDERS":function(e){return"Orders"},"NAVBAR:PROD:DOWNTIMES":function(e){return"Downtimes"},"NAVBAR:PROD:ALERTS":function(e){return"Alerts"},"NAVBAR:PROD:CHANGE_REQUESTS":function(e){return"Change requests"},"NAVBAR:PROD:SERIAL_NUMBERS":function(e){return"Serial numbers"},"NAVBAR:PROD:SETTINGS":function(e){return"Settings"},"NAVBAR:testing":function(e){return"Testing"},"NAVBAR:xiconf":function(e){return"Xiconf"},"NAVBAR:xiconf:clients":function(e){return"Clients"},"NAVBAR:xiconf:orders":function(e){return"Orders"},"NAVBAR:xiconf:results":function(e){return"Results"},"NAVBAR:xiconf:programs":function(e){return"Programs"},"NAVBAR:xiconf:hidLamps":function(e){return"HID lamps"},"NAVBAR:xiconf:componentWeights":function(e){return"Component weights"},"NAVBAR:snf":function(e){return"SNF"},"NAVBAR:snf:results":function(e){return"Results"},"NAVBAR:snf:programs":function(e){return"Programs"},"NAVBAR:trw":function(e){return"TRW"},"NAVBAR:trw:results":function(e){return"Results"},"NAVBAR:trw:testers":function(e){return"Controllers"},"NAVBAR:trw:bases":function(e){return"Bases"},"NAVBAR:trw:programs":function(e){return"Programs"},"NAVBAR:gft":function(e){return"GearFlex"},"NAVBAR:gft:pcbs":function(e){return"PCBs"},"NAVBAR:gft:testers":function(e){return"Testers"},"NAVBAR:DOCUMENTS":function(e){return"Documentation"},"NAVBAR:DOCUMENTS:TREE":function(e){return"Documents"},"NAVBAR:DOCUMENTS:CLIENTS":function(e){return"Clients"},"NAVBAR:DOCUMENTS:SETTINGS":function(e){return"Settings"},"NAVBAR:DOCUMENTS:CONFIRMATIONS":function(e){return"Confirmations"},"NAVBAR:VENDORS":function(e){return"Vendors"},"NAVBAR:PURCHASE_ORDERS":function(e){return"Purchase orders"},"NAVBAR:MONITORING":function(e){return"Monitoring"},"NAVBAR:MONITORING:LAYOUT":function(e){return"Factory layout"},"NAVBAR:MONITORING:LIST":function(e){return"Production line list"},"NAVBAR:VENDOR_NC12S":function(e){return"12NC database"},"NAVBAR:LICENSES":function(e){return"Licenses"},"NAVBAR:ISA_PALLET_KINDS":function(e){return"Pallet kinds"},"NAVBAR:ISA":function(e){return"Intermediate storage areas"},"NAVBAR:INVALID_ORDERS":function(e){return"Invalid IPT orders"},"NAVBAR:IPT_CHECK":function(e){return"IPT orders checker"},"NAVBAR:SAP_LABOR_TIME_FIXER":function(e){return"Labor Time fixer"},"NAVBAR:PRINTERS":function(e){return"Printers"},"NAVBAR:PKHD_STRATEGIES":function(e){return"Component dist. strategies"},"NAVBAR:kanban":function(e){return"Component DB"},"NAVBAR:pfep":function(e){return"PFEP DB"},"NAVBAR:layout":function(e){return"Layout"},"NAVBAR:toolcal":function(e){return"Tool calibration"},"NAVBAR:luma2":function(e){return"Luma gen. 2"},"NAVBAR:luca":function(e){return"LUCA Pick by Light"},"NAVBAR:logs:browserErrors":function(e){return"Client-side errors"},"NAVBAR:ct":function(e){return"Cycle time"},"NAVBAR:fa":function(e){return"Fixed Assets"},"NAVBAR:dummyPaint":function(e){return"Dummy paint"},"NAVBAR:compRel:entries":function(e){return"Component releases"},"NAVBAR:orderBomMatchers":function(e){return"Component checking"},"NAVBAR:componentLabels":function(e){return"Component labels"},"NAVBAR:orderGroups":function(e){return"Order groups"},"NAVBAR:OPINION:main":function(e){return"Opinion survey"},"NAVBAR:OPINION:current":function(e){return"Current survey"},"NAVBAR:OPINION:report":function(e){return"Report"},"NAVBAR:OPINION:actions":function(e){return"Corrective actions"},"NAVBAR:OPINION:responses":function(e){return"Responses"},"NAVBAR:OPINION:scanning":function(e){return"Scanning"},"NAVBAR:OPINION:scanTemplates":function(e){return"Templates"},"NAVBAR:OPINION:omrResults":function(e){return"Results"},"NAVBAR:OPINION:dictionaries":function(e){return"Dictionaries"},"NAVBAR:OPINION:surveys":function(e){return"Surveys"},"NAVBAR:OPINION:employers":function(e){return"Employers"},"NAVBAR:OPINION:divisions":function(e){return"Divisions"},"NAVBAR:OPINION:questions":function(e){return"Questions"},"NAVBAR:QI:main":function(e){return"Quality Inspection"},"NAVBAR:QI:results":function(e){return"Results"},"NAVBAR:QI:results:all":function(e){return"All"},"NAVBAR:QI:results:good":function(e){return"Compliant"},"NAVBAR:QI:results:bad":function(e){return"Non-compliant"},"NAVBAR:QI:reports":function(e){return"Reports"},"NAVBAR:QI:reports:count":function(e){return"Count"},"NAVBAR:QI:reports:okRatio":function(e){return"% of OK goods"},"NAVBAR:QI:reports:nokRatio":function(e){return"% of NOK goods"},"NAVBAR:QI:reports:outgoingQuality":function(e){return"Outgoing quality"},"NAVBAR:QI:dictionaries":function(e){return"Dictionaries"},"NAVBAR:QI:kinds":function(e){return"Kinds"},"NAVBAR:QI:errorCategories":function(e){return"Error categories"},"NAVBAR:QI:faults":function(e){return"Faults"},"NAVBAR:QI:standards":function(e){return"Standards"},"NAVBAR:SEARCH:help":function(e){return"Search by order no, 12NC or date."},"NAVBAR:SEARCH:empty":function(e){return"No results."},"NAVBAR:SEARCH:fullOrderNo":function(e){return"Order no "+t.v(e,"orderNo")},"NAVBAR:SEARCH:partialOrderNo":function(e){return"Orders no "+t.v(e,"orderNo")+"..."},"NAVBAR:SEARCH:fullNc12":function(e){return"12NC "+t.v(e,"nc12")},"NAVBAR:SEARCH:partialNc12":function(e){return"12NC "+t.v(e,"nc12")+"..."},"NAVBAR:SEARCH:fullNc15":function(e){return"15NC "+t.v(e,"nc15")},"NAVBAR:SEARCH:searchName":function(e){return"Users"},"NAVBAR:SEARCH:sapDetails":function(e){return"details from SAP"},"NAVBAR:SEARCH:xiconfDetails":function(e){return"details from the tests db"},"NAVBAR:SEARCH:xiconfResults":function(e){return"test results"},"NAVBAR:SEARCH:prodShiftOrders":function(e){return"list from production lines"},"NAVBAR:SEARCH:prodShiftOrdersList":function(e){return"orders list from production lines"},"NAVBAR:SEARCH:prodDowntimes":function(e){return"list of downtimes"},"NAVBAR:SEARCH:qiResults":function(e){return"QI results"},"NAVBAR:SEARCH:mechOrders":function(e){return"list of mechanical orders"},"NAVBAR:SEARCH:sapOrders":function(e){return"list of orders from SAP"},"NAVBAR:SEARCH:sapOrdersBom":function(e){return"list of orders from SAP with the component"},"NAVBAR:SEARCH:sapOrdersDoc":function(e){return"list of orders from SAP with the document"},"NAVBAR:SEARCH:sapOrdersStart":function(e){return"list of orders from SAP by start date"},"NAVBAR:SEARCH:sapOrdersFinish":function(e){return"list of orders from SAP by finish date"},"NAVBAR:SEARCH:sapList":function(e){return"list from SAP"},"NAVBAR:SEARCH:xiconfOrders":function(e){return"orders list from the tests db"},"NAVBAR:SEARCH:xiconfList":function(e){return"list from the tests db"},"NAVBAR:SEARCH:worksheetOrders":function(e){return"orders list from worksheets"},"NAVBAR:SEARCH:fte:master":function(e){return"list of FTE (production)"},"NAVBAR:SEARCH:fte:wh":function(e){return"list of FTE (warehouse)"},"NAVBAR:SEARCH:fte:leader":function(e){return"list of FTE (other)"},"NAVBAR:SEARCH:hourlyPlans":function(e){return"list of hourly plans"},"NAVBAR:SEARCH:hourlyPlan":function(e){return"hourly plan"},"NAVBAR:SEARCH:prodShifts":function(e){return"list of production shifts"},"NAVBAR:SEARCH:document":function(e){return"document in the catalog"},"NAVBAR:SEARCH:documentFile":function(e){return"documentation file"},"NAVBAR:SEARCH:entryId":function(e){return"Entry no "+t.v(e,"entryId")},"NAVBAR:SEARCH:kaizenOrders":function(e){return"Near miss"},"NAVBAR:SEARCH:suggestions":function(e){return"Improvement"},"NAVBAR:SEARCH:behaviorObsCards":function(e){return"Observation"},"NAVBAR:SEARCH:minutesForSafetyCards":function(e){return"Minutes"},"NAVBAR:SEARCH:d8":function(e){return"8D"},"NAVBAR:SEARCH:qi":function(e){return"Quality Inspection"},"NAVBAR:SEARCH:plan:prod":function(e){return"production plan"},"NAVBAR:SEARCH:plan:wh":function(e){return"warehouse plan"},"NAVBAR:SEARCH:plan:ps":function(e){return"paint shop plan"},"NAVBAR:SEARCH:fap":function(e){return"FAP"},"NAVBAR:SEARCH:fapEntries":function(e){return"FAP entries"},"NAVBAR:SEARCH:kanbanEntries":function(e){return"kanbans"},"NAVBAR:SEARCH:kanbanComponent":function(e){return"kanban component"},"NAVBAR:SEARCH:cycleTime":function(e){return"cycle time"},"NAVBAR:SEARCH:balancing":function(e){return"balancing"},"NAVBAR:SEARCH:deliveredOrders":function(e){return"delivered orders"},"NAVBAR:SEARCH:dailyPlan":function(e){return"daily plan"},"NAVBAR:SEARCH:whPickup":function(e){return"WH pickup"},"NAVBAR:SEARCH:whEvents":function(e){return"WH events"},"NAVBAR:mor":function(e){return"Matrix of responsibility"},"NAVBAR:KAIZEN:main":function(e){return"Near misses"},"NAVBAR:KAIZEN:moved":function(e){return"Near misses were moved to the React menu!"},"NAVBAR:SUGGESTIONS:main":function(e){return"Improvements"},"NAVBAR:SUGGESTIONS:moved":function(e){return"Improvements were moved to the React menu!"},"NAVBAR:osh1:main":function(e){return"Reaguj"},"NAVBAR:osh1:entries":function(e){return"Entries"},"NAVBAR:osh1:entries:add":function(e){return"Add entry"},"NAVBAR:osh1:entries:mine":function(e){return"My entries"},"NAVBAR:osh1:nearMisses":function(e){return"Near misses"},"NAVBAR:osh1:suggestions":function(e){return"Improvements"},"NAVBAR:osh1:observations":function(e){return"Observations"},"NAVBAR:osh1:observations:print":function(e){return"Printable version"},"NAVBAR:osh1:minutes":function(e){return"Minutes"},"NAVBAR:osh1:talks":function(e){return"OSH talks"},"NAVBAR:osh1:audits":function(e){return"OSH audits"},"NAVBAR:osh1:reports":function(e){return"Reports"},"NAVBAR:osh1:reports:metrics":function(e){return"Metrics"},"NAVBAR:osh1:reports:engagement":function(e){return"Engagement"},"NAVBAR:osh1:reports:reward":function(e){return"Reward"},"NAVBAR:osh1:reports:count:nearMisses":function(e){return"Number of near misses"},"NAVBAR:osh1:reports:count:suggestions":function(e){return"Number of suggestions"},"NAVBAR:osh1:reports:count:observations":function(e){return"Number of observations"},"NAVBAR:osh1:reports:count:minutes":function(e){return"Number of minutes"},"NAVBAR:osh1:reports:count:audits":function(e){return"Number of minutes OSH audits"},"NAVBAR:osh1:reports:count:talks":function(e){return"Number of OSH talks"},"NAVBAR:osh1:reports:summary:nearMisses":function(e){return"Near miss summary"},"NAVBAR:osh1:reports:summary:suggestions":function(e){return"Improvement summary"},"NAVBAR:osh1:dictionaries":function(e){return"Dictionaries"},"NAVBAR:osh1:kaizenSections":function(e){return"Sections"},"NAVBAR:osh1:kaizenAreas":function(e){return"Areas"},"NAVBAR:osh1:kaizenCategories":function(e){return"Categories"},"NAVBAR:osh1:kaizenCauses":function(e){return"Causes"},"NAVBAR:osh1:kaizenRisks":function(e){return"Risks"},"NAVBAR:osh1:kaizenBehaviours":function(e){return"Behaviors"},"NAVBAR:osh1:kaizenProductFamilies":function(e){return"Product families"},"NAVBAR:osh1:kaizenTopics":function(e){return"Talks topics"},"NAVBAR:osh1:kaizenControlCategories":function(e){return"Control categories"},"NAVBAR:osh1:kaizenControlLists":function(e){return"Control lists"},"NAVBAR:osh2:main":function(e){return"React v2"},"NAVBAR:osh2:entries":function(e){return"Entries"},"NAVBAR:osh2:entries:all":function(e){return"All"},"NAVBAR:osh2:entries:open":function(e){return"Open"},"NAVBAR:osh2:entries:mine":function(e){return"Mine"},"NAVBAR:osh2:entries:unseen":function(e){return"Unseen"},"NAVBAR:osh2:entries:todo":function(e){return"Todo"},"NAVBAR:osh2:hr":function(e){return"HR"},"NAVBAR:osh2:dictionaries":function(e){return"Dictionaries"},"NAVBAR:osh2:employments":function(e){return"Employments"},"NAVBAR:osh2:targets":function(e){return"Targets"},"NAVBAR:osh2:brigades":function(e){return"Brigades"},"NAVBAR:osh2:companies":function(e){return"Companies"},"NAVBAR:osh2:divisions":function(e){return"Divisions"},"NAVBAR:osh2:workplaces":function(e){return"Workplaces"},"NAVBAR:osh2:departments":function(e){return"Departments"},"NAVBAR:osh2:buildings":function(e){return"Buildings"},"NAVBAR:osh2:locations":function(e){return"Locations"},"NAVBAR:osh2:stations":function(e){return"Stations"},"NAVBAR:osh2:kinds":function(e){return"Entry kinds"},"NAVBAR:osh2:activityKinds":function(e){return"Activity kinds"},"NAVBAR:osh2:observationKinds":function(e){return"Observation kinds"},"NAVBAR:osh2:observationCategories":function(e){return"Observation categories"},"NAVBAR:osh2:eventCategories":function(e){return"Event categories"},"NAVBAR:osh2:reasonCategories":function(e){return"Reason categories"},"NAVBAR:osh2:rootCauseCategories":function(e){return"Root cause categories"},"NAVBAR:osh2:kaizenCategories":function(e){return"Kaizen categories"},"NAVBAR:osh2:nearMisses":function(e){return"Near misses"},"NAVBAR:osh2:kaizens":function(e){return"Kaizens"},"NAVBAR:osh2:actions":function(e){return"Actions"},"NAVBAR:osh2:observations":function(e){return"Observations"},"NAVBAR:osh2:accidents":function(e){return"Accidents"},"NAVBAR:osh2:reports":function(e){return"Reports"},"NAVBAR:osh2:reports:metrics":function(e){return"Metrics"},"NAVBAR:osh2:reports:engagement":function(e){return"Engagement"},"NAVBAR:osh2:reports:observers":function(e){return"Observers"},"NAVBAR:osh2:reports:rewards":function(e){return"Rewards"},"NAVBAR:osh2:reports:count/nearMiss":function(e){return"Number of near misses"},"NAVBAR:osh2:reports:count/kaizen":function(e){return"Number of kaizens"},"NAVBAR:osh2:reports:count/action":function(e){return"Number of actions"},"NAVBAR:osh2:reports:count/observation":function(e){return"Number of observations"},"NAVBAR:osh2:reports:count/accident":function(e){return"Number of accidents"},"ACTION_FORM:BUTTON":function(e){return"Perform action"},"ACTION_FORM:BUTTON:cancel":function(e){return"Cancel"},"ACTION_FORM:MESSAGE":function(e){return"Are you sure you want to perform the requested action?"},"ACTION_FORM:MESSAGE:failure":function(e){return"Action failed."},"ACTION_FORM:DIALOG_TITLE:delete":function(e){return"Deletion confirmation"},"ACTION_FORM:BUTTON:delete":function(e){return"Delete"},"ACTION_FORM:MESSAGE:delete":function(e){return"Are you sure you want to delete the chosen item?"},"ACTION_FORM:MESSAGE_SPECIFIC:delete":function(e){return"Are you sure you want to delete <em>"+t.v(e,"label")+"</em>?"},"ACTION_FORM:MESSAGE_FAILURE:delete":function(e){return"Deleting failed."},"FORM:ACTION:add":function(e){return"Add"},"FORM:ACTION:edit":function(e){return"Edit"},"FORM:ACTION:save":function(e){return"Save"},"FORM:ERROR:addFailure":function(e){return"Adding failed."},"FORM:ERROR:editFailure":function(e){return"Editing failed."},"ORG_UNIT:division":function(e){return"Division"},"ORG_UNIT:subdivision":function(e){return"Subdivision"},"ORG_UNIT:mrpController":function(e){return"MRP Controller"},"ORG_UNIT:mrpControllers":function(e){return"MRP Controller"},"ORG_UNIT:prodFlow":function(e){return"Production flow"},"ORG_UNIT:workCenter":function(e){return"WorkCenter"},"ORG_UNIT:prodLine":function(e){return"Production line"},SHIFT:function(e){return t.v(e,"date")+", "+t.s(e,"shift",{1:"I",2:"II",3:"III",other:t.v(e,"shift")})},"SHIFT:1":function(e){return"I"},"SHIFT:2":function(e){return"II"},"SHIFT:3":function(e){return"III"},"SHIFT:0":function(e){return"Any"},QUARTER:function(e){return t.v(e,"quarter")+" quarter "+t.v(e,"year")},"QUARTER:1":function(e){return"I"},"QUARTER:2":function(e){return"II"},"QUARTER:3":function(e){return"III"},"QUARTER:4":function(e){return"IV"},"QUARTER:0":function(e){return"Any"},"highcharts:contextButtonTitle":function(e){return"Chart's context menu"},"highcharts:downloadJPEG":function(e){return"Save as JPEG"},"highcharts:downloadPDF":function(e){return"Save as PDF"},"highcharts:downloadPNG":function(e){return"Save as PNG"},"highcharts:downloadSVG":function(e){return"Save as SVG"},"highcharts:downloadCSV":function(e){return"Save as CSV"},"highcharts:printChart":function(e){return"Print the chart"},"highcharts:decimalPoint":function(e){return"."},"highcharts:thousandsSep":function(e){return","},"highcharts:noData":function(e){return"No data."},"highcharts:resetZoom":function(e){return"1:1"},"highcharts:resetZoomTitle":function(e){return"Reset the zoom level to 1:1"},"highcharts:loading":function(e){return"Loading..."},"highcharts:months":function(e){return"January_February_March_April_May_June_July_August_September_October_November_December"},"highcharts:shortMonths":function(e){return"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec"},"highcharts:weekdays":function(e){return"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday"},"dataTables:emptyTable":function(e){return"No data."},"dataTables:loadingRecords":function(e){return"Loading..."},"dataTables:loadingFailed":function(e){return"Loading failed."},"feedback:button:text":function(e){return"Feedback"},"feedback:button:tooltip":function(e){return"Report bugs, notes, opinions or ideas!"},"colorPicker:label":function(e){return"Color"},"filter:date":function(e){return"Date"},"filter:date:from":function(e){return"From"},"filter:date:from:info":function(e){return"Data from 06:00 of the selected day"},"filter:date:to":function(e){return"To"},"filter:date:to:info":function(e){return"Data to 06:00 of the selected day"},"filter:shift":function(e){return"Shift"},"filter:orgUnit":function(e){return"Organizational unit"},"filter:submit":function(e){return"Filter"},"filter:filters":function(e){return"Show additional filters"},"filter:limit":function(e){return"Limit"},"filter:show":function(e){return"Show filter"},"filter:hide":function(e){return"Hide filter"},"placeholder:date":function(e){return"yyyy-mm-dd"},"placeholder:time":function(e){return"--:--"},"placeholder:month":function(e){return"yyyy-mm"},"PRINT_PAGE:FT:PAGE_NO":function(e){return"Page <span class=print-page-no>?</span> of <span class=print-page-count>?</span>"},"PRINT_PAGE:FT:INFO":function(e){return"Printout generated at <span class=print-page-date>?</span> by <span class=print-page-user>?</span>."},"html2pdf:progress":function(e){return"Generating the printout..."},"html2pdf:failure":function(e){return"Printout generation failed."},"html2pdf:printing":function(e){return"Sending the printout to the printer..."},"html2pdf:printing:success":function(e){return"Printout was successfully sent to the printer."},"html2pdf:printing:failure":function(e){return"Sending the printout to the printer failed."},"dateTimeRange:placeholder:date":function(e){return"yyyy-mm-dd"},"dateTimeRange:placeholder:time":function(e){return"hh:mm"},"dateTimeRange:label:date":function(e){return"Date"},"dateTimeRange:label:date+time":function(e){return"Time"},"dateTimeRange:label:month":function(e){return"Date"},"dateTimeRange:+0+1":function(e){return"current"},"dateTimeRange:-1+0":function(e){return"previous"},"dateTimeRange:-2+0":function(e){return"last 2"},"dateTimeRange:-3+0":function(e){return"last 3"},"dateTimeRange:-4+0":function(e){return"last 4"},"dateTimeRange:-6+0":function(e){return"last 6"},"dateTimeRange:-7+0":function(e){return"last 7"},"dateTimeRange:+0+7":function(e){return"next 7"},"dateTimeRange:-14+0":function(e){return"last 14"},"dateTimeRange:-28+0":function(e){return"last 28"},"dateTimeRange:shifts":function(e){return"Shift"},"dateTimeRange:shifts:1":function(e){return"I"},"dateTimeRange:shifts:2":function(e){return"II"},"dateTimeRange:shifts:3":function(e){return"III"},"dateTimeRange:days":function(e){return"Day"},"dateTimeRange:days:+0+1":function(e){return"today"},"dateTimeRange:days:-1+0":function(e){return"yesterday"},"dateTimeRange:days:+1+2":function(e){return"tomorrow"},"dateTimeRange:weeks":function(e){return"Week"},"dateTimeRange:months":function(e){return"Month"},"dateTimeRange:quarters":function(e){return"Quarter"},"dateTimeRange:quarters:1":function(e){return"I"},"dateTimeRange:quarters:2":function(e){return"II"},"dateTimeRange:quarters:3":function(e){return"III"},"dateTimeRange:quarters:4":function(e){return"IV"},"dateTimeRange:years":function(e){return"Year"},"dateTimeRange:help":function(e){return"Hold <kbd>Alt</kbd> while clicking on an option to automatically submit the form."},"embedded:actions:switch":function(e){return"Switch app"},"embedded:actions:refresh":function(e){return"Refresh app"},"embedded:actions:config":function(e){return"Configure"},"embedded:actions:reboot":function(e){return"Reboot"},"embedded:actions:shutdown":function(e){return"Shutdown"},"embedded:actions:resetBrowser":function(e){return"Reset browser"},"embedded:actions:restartBrowser":function(e){return"Restart browser"},"embedded:actions:noKiosk":function(e){return"Turn off kiosk mode"},"embedded:actions:lockUi":function(e){return"Lock UI"},"embedded:apps:operator":function(e){return"Operator"},"embedded:apps:documents":function(e){return"Documents"},"embedded:apps:heff":function(e){return"Hourly efficiency"},"embedded:apps:xiconf":function(e){return"Xiconf"},"embedded:apps:maxos":function(e){return"MAXOS visualization"},"embedded:apps:drilling":function(e){return"Drilling"},"embedded:apps:ps-queue":function(e){return"Paint-shop queue"},"embedded:apps:ps-load":function(e){return"Paint-shop load"},"embedded:apps:isa":function(e){return"ISA"},"embedded:apps:trw":function(e){return"TRW tester"},"embedded:apps:snf":function(e){return"SNF tester"},"embedded:apps:gft":function(e){return"GearFlex tester"},"embedded:apps:wh-pickup":function(e){return"Pickup"},"embedded:apps:wh-delivery-components":function(e){return"FIFO delivery"},"embedded:apps:wh-delivery-packaging":function(e){return"Packaging delivery"},"embedded:apps:wh-delivery-ps":function(e){return"Paint-shop delivery"},"embedded:apps:remote":function(e){return"Remote"},"embedded:reboot:title":function(e){return"Rebooting"},"embedded:reboot:message":function(e){return"Are you sure you want to reboot the computer?"},"embedded:reboot:yes":function(e){return"Reboot"},"embedded:reboot:no":function(e){return"Cancel"},"embedded:shutdown:title":function(e){return"Shutting down"},"embedded:shutdown:message":function(e){return"Are you sure you want to shutdown the computer?"},"embedded:shutdown:yes":function(e){return"Shutdown"},"embedded:shutdown:no":function(e){return"Cancel"},"embedded:lockUi:message":function(e){return"UI locked.<br>Touch here to unlock."},"PANEL:TITLE:details":function(e){return"Details"},"PANEL:TITLE:addForm":function(e){return"Add form"},"PANEL:TITLE:editForm":function(e){return"Edit form"},"lang:pl":function(e){return"Polish (pl)"},"lang:en":function(e){return"English (en)"},labelCopySuffix:function(e){return t.v(e,"label")+" (copy)"},"resultTips:copied":function(e){return"Copied!"}},pl:!0}}),define("app/nls/pl/core",["app/nls/locale/pl"],function(e){var t={lc:{pl:function(t){return e(t)},en:function(t){return e(t)}},c:function(e,t){if(!e)throw new Error("MessageFormat: Data required for '"+t+"'.")},n:function(e,t,n){if(isNaN(e[t]))throw new Error("MessageFormat: '"+t+"' isn't a number.");return e[t]-(n||0)},v:function(e,n){return t.c(e,n),e[n]},p:function(e,n,i,r,o){return t.c(e,n),e[n]in o?o[e[n]]:(n=t.lc[r](e[n]-i))in o?o[n]:o.other},s:function(e,n,i){return t.c(e,n),e[n]in i?i[e[n]]:i.other}};return{APP_NAME:function(e){return"WMES"},TITLE:function(e){return"WMES"},"MSG:LOADING":function(e){return"<i class='fa fa-spinner fa-spin'></i><span>Ładowanie...</span>"},"MSG:LOADING_FAILURE":function(e){return"Ładowanie nie powiodło się."},"MSG:LOADING_SINGLE_FAILURE":function(e){return"Ładowanie nie powiodło się."},"MSG:SAVING":function(e){return"<i class='fa fa-spinner fa-spin'></i><span>Zapisywanie...</span>"},"MSG:SAVING_FAILURE":function(e){return"Zapisywanie nie powiodło się."},"MSG:EXPORTING":function(e){return"<i class='fa fa-spinner fa-spin'></i><span>Eksportowanie...</span>"},"MSG:EXPORTING_FAILURE":function(e){return"Eksportowanie nie powiodło się."},"MSG:IMPORTING":function(e){return"<i class='fa fa-spinner fa-spin'></i><span>Importowanie...</span>"},"MSG:IMPORTING_FAILURE":function(e){return"Importowanie nie powiodło się."},"MSG:LOG_OUT:FAILURE":function(e){return"Wylogowanie nie powiodło się."},"MSG:LOG_OUT:SUCCESS":function(e){return"Zostałeś wylogowany!"},"MSG:POPUP_BLOCKED":function(e){return"Wyskakujące okienko zostało zablokowane."},"MSG:DELETED":function(e){return"Usunięto: <em>"+t.v(e,"label")+"</em>."},"MSG:jump:404":function(e){return"Nie znaleziono: "+t.v(e,"rid")},"PAGE_ACTION:add":function(e){return"Dodaj"},"PAGE_ACTION:edit":function(e){return"Edytuj"},"PAGE_ACTION:delete":function(e){return"Usuń"},"PAGE_ACTION:filter":function(e){return"Filtruj"},"PAGE_ACTION:print":function(e){return"Drukuj"},"PAGE_ACTION:import":function(e){return"Importuj"},"PAGE_ACTION:export":function(e){return"Eksportuj"},"PAGE_ACTION:export:csv":function(e){return"Eksportuj do CSV"},"PAGE_ACTION:export:xlsx":function(e){return"Eksportuj do XLSX"},"PAGE_ACTION:jump:title":function(e){return"Skocz do szczegółów po ID"},"PAGE_ACTION:jump:placeholder":function(e){return"ID"},"LIST:COLUMN:actions":function(e){return"Akcje"},"LIST:NO_DATA":function(e){return"Brak danych."},"LIST:NO_DATA:cell":function(e){return""},"LIST:ACTION:viewDetails":function(e){return"Pokaż szczegóły"},"LIST:ACTION:edit":function(e){return"Edytuj"},"LIST:ACTION:delete":function(e){return"Usuń"},"LIST:ACTION:print":function(e){return"Drukuj"},"BREADCRUMB:addForm":function(e){return"Dodawanie"},"BREADCRUMB:editForm":function(e){return"Edycja"},"BREADCRUMB:ACTION_FORM:delete":function(e){return"Usuwanie"},"ERROR:notify:message":function(e){return"Poinformuj administratora o błędzie"},"ERROR:notify:placeholder":function(e){return"Komentarz..."},"ERROR:notify:success":function(e){return"Administrator został powiadomiony o błędzie!"},"ERROR:notify:failure":function(e){return"Nie udało się powiadomić administratora."},"ERROR:notify:subject":function(e){return"["+t.v(e,"APP_NAME")+"] Błąd "+t.v(e,"code")+" od "+t.v(e,"user")},"ERROR:0:title":function(e){return"Błąd podczas ładowania"},"ERROR:0:message":function(e){return"Nieoczekiwany błąd podczas wykonywania żądania. Sprawdź, czy masz połączenie z siecią i <a href=# data-reload>załaduj ponownie stronę</a>."},"ERROR:400:title":function(e){return"Błąd 400: nieprawidłowe zapytanie"},"ERROR:400:message":function(e){return"Żądanie nie może być obsłużone przez serwer z powodu błędnej składni zapytania."},"ERROR:401:title":function(e){return"Błąd 401: nieautoryzowany dostęp"},"ERROR:401:message":function(e){return"Żądanie wymaga uwierzytelnienia. <a href='#login'>Kliknij tutaj, aby przejść do formularza logowania</a>."},"ERROR:403:title":function(e){return"Błąd 403: zabroniony"},"ERROR:403:message":function(e){return"Nie masz uprawnień do wykonania żądanej akcji."},"ERROR:403:guest:message":function(e){return"Nie masz uprawnień do wykonania żądanej akcji. <a href='#login'>Kliknij tutaj, aby przejść do formularza logowania</a>."},"ERROR:404:title":function(e){return"Błąd 404: nie znaleziono"},"ERROR:404:message":function(e){return"Wybrana strona nigdy nie istniała lub została usunięta."},"ERROR:500:title":function(e){return"Błąd 500: wewnętrzny błąd serwera"},"ERROR:500:message":function(e){return"Serwer napotkał niespodziewane trudności, które uniemożliwiły zrealizowanie żądania."},"ERROR:503:title":function(e){return"Błąd 503: usługa niedostępna"},"ERROR:503:message":function(e){return"Serwer nie jest w stanie w danej chwili zrealizować żądania ze względu na przeciążenie lub przerwę konserwacyjną."},"ERROR:504:title":function(e){return"Błąd 504: przekroczony czas bramy"},"ERROR:504:message":function(e){return"Serwer bramy nie otrzymał w ustalonym czasie odpowiedzi od nadrzędnego serwera."},"PAGINATION:FIRST_PAGE":function(e){return"Pierwsza strona"},"PAGINATION:PREV_PAGE":function(e){return"Poprzednia strona"},"PAGINATION:NEXT_PAGE":function(e){return"Następna strona"},"PAGINATION:LAST_PAGE":function(e){return"Ostatnia strona"},"BOOL:true":function(e){return"Tak"},"BOOL:false":function(e){return"Nie"},"BOOL:null":function(e){return"Nie dotyczy"},"#":function(e){return"Lp."},GUEST_USER_NAME:function(e){return"Gość"},"NAVBAR:TOGGLE":function(e){return"Pokaż menu"},"NAVBAR:DASHBOARD":function(e){return"Pulpit"},"NAVBAR:EVENTS":function(e){return"Zdarzenia"},"NAVBAR:ORDERS":function(e){return"Zlecenia"},"NAVBAR:MECH_ORDERS":function(e){return"Zlecenia mechaniczne"},"NAVBAR:OTHER_ORDERS":function(e){return"Zlecenia produkcyjne"},"NAVBAR:EMPTY_ORDERS":function(e){return"Puste zlecenia WMES"},"NAVBAR:LINES":function(e){return"Linie produkcyjne"},"NAVBAR:USERS":function(e){return"Użytkownicy"},"NAVBAR:MY_ACCOUNT":function(e){return"Moje konto"},"NAVBAR:UI_LOCALE":function(e){return"Lokalizacja UI"},"NAVBAR:LOCALE_PL":function(e){return"Po polsku"},"NAVBAR:LOCALE_US":function(e){return"Po angielsku"},"NAVBAR:LOG_IN":function(e){return"Zaloguj się"},"NAVBAR:LOG_OUT":function(e){return"Wyloguj się"},"NAVBAR:DICTIONARIES":function(e){return"Słowniki"},"NAVBAR:TOOLS":function(e){return"Narzędzia"},"NAVBAR:ORDER_STATUSES":function(e){return"Statusy zleceń"},"NAVBAR:DELAY_REASONS":function(e){return"Powody opóźnień"},"NAVBAR:DOWNTIME_REASONS":function(e){return"Powody przestojów"},"NAVBAR:LOSS_REASONS":function(e){return"Powody strat materiałowych"},"NAVBAR:AORS":function(e){return"Obszary odpowiedzialności"},"NAVBAR:WORK_CENTERS":function(e){return"WorkCentra"},"NAVBAR:COMPANIES":function(e){return"Firmy"},"NAVBAR:DIVISIONS":function(e){return"Wydziały"},"NAVBAR:SUBDIVISIONS":function(e){return"Działy"},"NAVBAR:MRP_CONTROLLERS":function(e){return"Kontrolery MRP"},"NAVBAR:PROD_FUNCTIONS":function(e){return"Funkcje"},"NAVBAR:PROD_FLOWS":function(e){return"Przepływy"},"NAVBAR:PROD_TASKS":function(e){return"Zadania produkcyjne"},"NAVBAR:PROD_LINES":function(e){return"Linie produkcyjne"},"NAVBAR:PLANNING:main":function(e){return"Planowanie"},"NAVBAR:PLANNING:plans":function(e){return"Plany"},"NAVBAR:PLANNING:hourly":function(e){return"godzinowe"},"NAVBAR:PLANNING:daily":function(e){return"dzienne"},"NAVBAR:PLANNING:drilling":function(e){return"Wiercenie"},"NAVBAR:PLANNING:wiring":function(e){return"Przewody"},"NAVBAR:PLANNING:paintShop":function(e){return"Malarnia"},"NAVBAR:PLANNING:paintShop:load":function(e){return"Obciążenie"},"NAVBAR:PLANNING:wh":function(e){return"Magazyn"},"NAVBAR:PLANNING:wh:old":function(e){return"stary"},"NAVBAR:PLANNING:wh:new":function(e){return"nowy"},"NAVBAR:PLANNING:wh:pickup":function(e){return"Kompletacja"},"NAVBAR:PLANNING:wh:delivery:components":function(e){return"Wysyłka FIFO"},"NAVBAR:PLANNING:wh:delivery:packaging":function(e){return"Wysyłka opakowań"},"NAVBAR:PLANNING:wh:delivery:ps":function(e){return"Wysyłka malarnii"},"NAVBAR:PLANNING:wh:problems":function(e){return"Problemy"},"NAVBAR:PLANNING:wh:deliveredOrders":function(e){return"Dostarczone zlecenia"},"NAVBAR:PLANNING:wh:downtimes":function(e){return"Przestoje"},"NAVBAR:PLANNING:wh:setCarts":function(e){return"Wózki"},"NAVBAR:PLANNING:wh:lines":function(e){return"Linie"},"NAVBAR:PLANNING:wh:events":function(e){return"Zdarzenia"},"NAVBAR:PLANNING:wh:settings":function(e){return"Ustawienia"},"NAVBAR:PLANNING:all":function(e){return"Wszystkie"},"NAVBAR:PLANNING:0d":function(e){return"Na dzisiaj"},"NAVBAR:PLANNING:-1d":function(e){return"Na wczoraj"},"NAVBAR:PLANNING:1d":function(e){return"Na jutro"},"NAVBAR:PLANNING:2d":function(e){return"Na pojutrze"},"NAVBAR:PLANNING:2d:help":function(e){return"Plan dostępny około godziny 17:00."},"NAVBAR:FTE":function(e){return"FTE"},"NAVBAR:FTE:MASTER":function(e){return"Produkcja"},"NAVBAR:FTE:WH":function(e){return"Magazyn"},"NAVBAR:FTE:LEADER":function(e){return"Inne"},"NAVBAR:FTE:SETTINGS":function(e){return"Ustawienia"},"NAVBAR:VIS":function(e){return"Wizualizacja"},"NAVBAR:VIS:STRUCTURE":function(e){return"Struktura organizacyjna"},"NAVBAR:PRESS_WORKSHEETS":function(e){return"Karty pracy"},"NAVBAR:REPORTS":function(e){return"Raporty"},"NAVBAR:REPORTS:1":function(e){return"Wskaźniki"},"NAVBAR:REPORTS:clip":function(e){return"CLIP"},"NAVBAR:REPORTS:3":function(e){return"Wykorzystanie zasobów"},"NAVBAR:REPORTS:4":function(e){return"Operatorzy"},"NAVBAR:REPORTS:5":function(e){return"HR"},"NAVBAR:REPORTS:6":function(e){return"Magazyn"},"NAVBAR:REPORTS:7":function(e){return"Przestoje w obszarach"},"NAVBAR:REPORTS:8":function(e){return"Lean"},"NAVBAR:REPORTS:9":function(e){return"Planowane obciążenie linii"},"NAVBAR:REPORTS:rearm":function(e){return"Przezbrojenia"},"NAVBAR:REPORTS:ct":function(e){return"Czas cyklu"},"NAVBAR:REPORTS:ct:pce":function(e){return"Sztuki"},"NAVBAR:REPORTS:ct:groups":function(e){return"Grupy wyrobów"},"NAVBAR:REPORTS:ct:results":function(e){return"Wyniki"},"NAVBAR:PROD":function(e){return"Produkcja"},"NAVBAR:PROD:DATA":function(e){return"Dane produkcyjne"},"NAVBAR:PROD:LOG_ENTRIES":function(e){return"Historia operacji"},"NAVBAR:PROD:SHIFTS":function(e){return"Zmiany"},"NAVBAR:PROD:SHIFT_ORDERS":function(e){return"Zlecenia"},"NAVBAR:PROD:DOWNTIMES":function(e){return"Przestoje"},"NAVBAR:PROD:ALERTS":function(e){return"Alarmy"},"NAVBAR:PROD:CHANGE_REQUESTS":function(e){return"Żądania zmian"},"NAVBAR:PROD:SERIAL_NUMBERS":function(e){return"Numery seryjne"},"NAVBAR:PROD:SETTINGS":function(e){return"Ustawienia"},"NAVBAR:testing":function(e){return"Baza testów"},"NAVBAR:xiconf":function(e){return"Xiconf"},"NAVBAR:xiconf:clients":function(e){return"Klienci"},"NAVBAR:xiconf:orders":function(e){return"Zlecenia"},"NAVBAR:xiconf:results":function(e){return"Wyniki"},"NAVBAR:xiconf:programs":function(e){return"Programy"},"NAVBAR:xiconf:hidLamps":function(e){return"Oprawy HID"},"NAVBAR:xiconf:componentWeights":function(e){return"Wagi komponentów"},"NAVBAR:snf":function(e){return"SNF"},"NAVBAR:snf:results":function(e){return"Wyniki"},"NAVBAR:snf:programs":function(e){return"Programy"},"NAVBAR:trw":function(e){return"TRW"},"NAVBAR:trw:results":function(e){return"Wyniki"},"NAVBAR:trw:testers":function(e){return"Sterowniki"},"NAVBAR:trw:bases":function(e){return"Podstawki"},"NAVBAR:trw:programs":function(e){return"Programy"},"NAVBAR:gft":function(e){return"GearFlex"},"NAVBAR:gft:pcbs":function(e){return"Płytki"},"NAVBAR:gft:testers":function(e){return"Testery"},"NAVBAR:DOCUMENTS":function(e){return"Dokumentacja"},"NAVBAR:DOCUMENTS:TREE":function(e){return"Dokumenty"},"NAVBAR:DOCUMENTS:CLIENTS":function(e){return"Klienci"},"NAVBAR:DOCUMENTS:SETTINGS":function(e){return"Ustawienia"},"NAVBAR:DOCUMENTS:CONFIRMATIONS":function(e){return"Potwierdzenia"},"NAVBAR:VENDORS":function(e){return"Dostawcy"},"NAVBAR:PURCHASE_ORDERS":function(e){return"Zamówienia"},"NAVBAR:MONITORING":function(e){return"Monitoring"},"NAVBAR:MONITORING:LAYOUT":function(e){return"Układ fabryki"},"NAVBAR:MONITORING:LIST":function(e){return"Lista linii produkcyjnych"},"NAVBAR:VENDOR_NC12S":function(e){return"Baza 12NC"},"NAVBAR:LICENSES":function(e){return"Licencje"},"NAVBAR:ISA_PALLET_KINDS":function(e){return"Rodzaje palet"},"NAVBAR:ISA":function(e){return"Pola odkładcze"},"NAVBAR:INVALID_ORDERS":function(e){return"Nieprawidłowe zlecenia IPT"},"NAVBAR:IPT_CHECK":function(e){return"Sprawdzacz zleceń IPT"},"NAVBAR:SAP_LABOR_TIME_FIXER":function(e){return"Sprawdzacz Labor Time"},"NAVBAR:PRINTERS":function(e){return"Drukarki"},"NAVBAR:PKHD_STRATEGIES":function(e){return"Strategie dost. komponentów"},"NAVBAR:kanban":function(e){return"Baza komponentów"},"NAVBAR:pfep":function(e){return"Baza PFEP"},"NAVBAR:layout":function(e){return"Layout"},"NAVBAR:toolcal":function(e){return"Narzędzia pomiarowe"},"NAVBAR:luma2":function(e){return"Luma gen. 2"},"NAVBAR:luca":function(e){return"LUCA Pick by Light"},"NAVBAR:logs:browserErrors":function(e){return"Błędy klientów"},"NAVBAR:ct":function(e){return"Czas cyklu"},"NAVBAR:fa":function(e){return"Środki Trwałe"},"NAVBAR:dummyPaint":function(e){return"Dummy paint"},"NAVBAR:compRel:entries":function(e){return"Dopuszczenia"},"NAVBAR:orderBomMatchers":function(e){return"Sprawdzanie komponentów"},"NAVBAR:componentLabels":function(e){return"Etykiety komponentów"},"NAVBAR:orderGroups":function(e){return"Grupy zleceń"},"NAVBAR:OPINION:main":function(e){return"Badanie Opinia"},"NAVBAR:OPINION:current":function(e){return"Aktualne badanie"},"NAVBAR:OPINION:report":function(e){return"Raport"},"NAVBAR:OPINION:actions":function(e){return"Akcje naprawcze"},"NAVBAR:OPINION:responses":function(e){return"Odpowiedzi"},"NAVBAR:OPINION:scanning":function(e){return"Skanowanie"},"NAVBAR:OPINION:scanTemplates":function(e){return"Szablony"},"NAVBAR:OPINION:omrResults":function(e){return"Wyniki"},"NAVBAR:OPINION:dictionaries":function(e){return"Słowniki"},"NAVBAR:OPINION:surveys":function(e){return"Badania"},"NAVBAR:OPINION:employers":function(e){return"Pracodawcy"},"NAVBAR:OPINION:divisions":function(e){return"Wydziały"},"NAVBAR:OPINION:questions":function(e){return"Pytania"},"NAVBAR:QI:main":function(e){return"Inspekcja Jakości"},"NAVBAR:QI:results":function(e){return"Wyniki"},"NAVBAR:QI:results:all":function(e){return"Wszystkie"},"NAVBAR:QI:results:good":function(e){return"Zgodne"},"NAVBAR:QI:results:bad":function(e){return"Niezgodne"},"NAVBAR:QI:reports":function(e){return"Raporty"},"NAVBAR:QI:reports:count":function(e){return"Ilości"},"NAVBAR:QI:reports:okRatio":function(e){return"% wyrobów zgodnych"},"NAVBAR:QI:reports:nokRatio":function(e){return"Jakość wyrobu gotowego"},"NAVBAR:QI:reports:outgoingQuality":function(e){return"Outgoing quality"},"NAVBAR:QI:dictionaries":function(e){return"Słowniki"},"NAVBAR:QI:kinds":function(e){return"Rodzaje inspekcji"},"NAVBAR:QI:errorCategories":function(e){return"Kategorie błędów"},"NAVBAR:QI:faults":function(e){return"Wady"},"NAVBAR:QI:standards":function(e){return"Standardy"},"NAVBAR:SEARCH:help":function(e){return"Szukaj wg nr zlecenia, 12NC, zgłoszenia lub daty."},"NAVBAR:SEARCH:empty":function(e){return"Brak wyników."},"NAVBAR:SEARCH:fullOrderNo":function(e){return"Zlecenie nr "+t.v(e,"orderNo")},"NAVBAR:SEARCH:partialOrderNo":function(e){return"Zlecenia nr "+t.v(e,"orderNo")+"..."},"NAVBAR:SEARCH:fullNc12":function(e){return"12NC "+t.v(e,"nc12")},"NAVBAR:SEARCH:partialNc12":function(e){return"12NC "+t.v(e,"nc12")+"..."},"NAVBAR:SEARCH:fullNc15":function(e){return"15NC "+t.v(e,"nc15")},"NAVBAR:SEARCH:searchName":function(e){return"Użytkownicy"},"NAVBAR:SEARCH:sapDetails":function(e){return"szczegóły z SAP"},"NAVBAR:SEARCH:xiconfDetails":function(e){return"szczegóły z bazy testów"},"NAVBAR:SEARCH:xiconfResults":function(e){return"wyniki testów"},"NAVBAR:SEARCH:prodShiftOrders":function(e){return"lista z linii produkcyjnych"},"NAVBAR:SEARCH:prodShiftOrdersList":function(e){return"lista zleceń z linii produkcyjnych"},"NAVBAR:SEARCH:prodDowntimes":function(e){return"lista przestojów"},"NAVBAR:SEARCH:qiResults":function(e){return"wyniki inspekcji"},"NAVBAR:SEARCH:mechOrders":function(e){return"lista zleceń mechanicznych"},"NAVBAR:SEARCH:sapOrders":function(e){return"lista zleceń z SAP"},"NAVBAR:SEARCH:sapOrdersBom":function(e){return"lista zleceń z SAP z komponentem"},"NAVBAR:SEARCH:sapOrdersDoc":function(e){return"lista zleceń z SAP z dokumentem"},"NAVBAR:SEARCH:sapOrdersStart":function(e){return"lista zleceń z SAP wg daty startu"},"NAVBAR:SEARCH:sapOrdersFinish":function(e){return"lista zleceń z SAP wg daty ukończenia"},"NAVBAR:SEARCH:sapList":function(e){return"lista z SAP"},"NAVBAR:SEARCH:xiconfOrders":function(e){return"lista zleceń z bazy testów"},"NAVBAR:SEARCH:xiconfList":function(e){return"lista z bazy testów"},"NAVBAR:SEARCH:worksheetOrders":function(e){return"lista zleceń z kart pracy"},"NAVBAR:SEARCH:fte:master":function(e){return"lista FTE (produkcja)"},"NAVBAR:SEARCH:fte:wh":function(e){return"lista FTE (magazyn)"},"NAVBAR:SEARCH:fte:leader":function(e){return"lista FTE (inne)"},"NAVBAR:SEARCH:hourlyPlans":function(e){return"lista planów godzinowych"},"NAVBAR:SEARCH:hourlyPlan":function(e){return"plan godzinowy"},"NAVBAR:SEARCH:prodShifts":function(e){return"lista zmian produkcyjnych"},"NAVBAR:SEARCH:document":function(e){return"dokument w katalogu"},"NAVBAR:SEARCH:documentFile":function(e){return"plik dokumentacji"},"NAVBAR:SEARCH:entryId":function(e){return"Zgłoszenie nr "+t.v(e,"entryId")},"NAVBAR:SEARCH:kaizenOrders":function(e){return"ZPW"},"NAVBAR:SEARCH:suggestions":function(e){return"Usprawnienie"},"NAVBAR:SEARCH:behaviorObsCards":function(e){return"Obserwacje"},"NAVBAR:SEARCH:minutesForSafetyCards":function(e){return"Minutki"},"NAVBAR:SEARCH:d8":function(e){return"8D"},"NAVBAR:SEARCH:qi":function(e){return"Inspekcja Jakości"},"NAVBAR:SEARCH:plan:prod":function(e){return"plan produkcji"},"NAVBAR:SEARCH:plan:wh":function(e){return"plan magazynu"},"NAVBAR:SEARCH:plan:ps":function(e){return"plan malarnii"},"NAVBAR:SEARCH:fap":function(e){return"FAP"},"NAVBAR:SEARCH:fapEntries":function(e){return"zgłoszenia FAP"},"NAVBAR:SEARCH:kanbanEntries":function(e){return"kanbany"},"NAVBAR:SEARCH:kanbanComponent":function(e){return"komponent kanban"},"NAVBAR:SEARCH:cycleTime":function(e){return"czas cyklu"},"NAVBAR:SEARCH:balancing":function(e){return"balansowanie"},"NAVBAR:SEARCH:deliveredOrders":function(e){return"dostarczone zlecenia"},"NAVBAR:SEARCH:dailyPlan":function(e){return"plan dzienny"},"NAVBAR:SEARCH:whPickup":function(e){return"kompletacja magazynu"},"NAVBAR:SEARCH:whEvents":function(e){return"zdarzenia magazynu"},"NAVBAR:mor":function(e){return"Matryca odpowiedzialności"},"NAVBAR:KAIZEN:main":function(e){return"ZPW"},"NAVBAR:KAIZEN:moved":function(e){return"ZPW zostały przeniesione do menu Reaguj!"},"NAVBAR:SUGGESTIONS:main":function(e){return"Usprawnienia"},"NAVBAR:SUGGESTIONS:moved":function(e){return"Usprawnienia zostały przeniesione do menu Reaguj!"},"NAVBAR:osh1:main":function(e){return"Reaguj"},"NAVBAR:osh1:entries":function(e){return"Zgłoszenia"},"NAVBAR:osh1:entries:add":function(e){return"Dodaj zgłoszenie"},"NAVBAR:osh1:entries:mine":function(e){return"Moje zgłoszenia"},"NAVBAR:osh1:nearMisses":function(e){return"ZPW"},"NAVBAR:osh1:suggestions":function(e){return"Usprawnienia"},"NAVBAR:osh1:observations":function(e){return"Obserwacje"},"NAVBAR:osh1:observations:print":function(e){return"Wersja do druku"},"NAVBAR:osh1:minutes":function(e){return"Minutki"},"NAVBAR:osh1:talks":function(e){return"Rozmowy o BHP"},"NAVBAR:osh1:audits":function(e){return"Audyty BHP"},"NAVBAR:osh1:reports":function(e){return"Raporty"},"NAVBAR:osh1:reports:metrics":function(e){return"Wskaźniki"},"NAVBAR:osh1:reports:engagement":function(e){return"Zaangażowanie"},"NAVBAR:osh1:reports:reward":function(e){return"Wynagrodzenie"},"NAVBAR:osh1:reports:count:nearMisses":function(e){return"Ilość ZPW"},"NAVBAR:osh1:reports:count:suggestions":function(e){return"Ilość usprawnień"},"NAVBAR:osh1:reports:count:observations":function(e){return"Ilość obserwacji"},"NAVBAR:osh1:reports:count:minutes":function(e){return"Ilość minutek"},"NAVBAR:osh1:reports:count:audits":function(e){return"Ilość audytów BHP"},"NAVBAR:osh1:reports:count:talks":function(e){return"Ilość rozmów o BHP"},"NAVBAR:osh1:reports:summary:nearMisses":function(e){return"Zestawienie ZPW"},"NAVBAR:osh1:reports:summary:suggestions":function(e){return"Zestawienie usprawnień"},"NAVBAR:osh1:dictionaries":function(e){return"Słowniki"},"NAVBAR:osh1:kaizenSections":function(e){return"Działy"},"NAVBAR:osh1:kaizenAreas":function(e){return"Miejsca zdarzeń"},"NAVBAR:osh1:kaizenCategories":function(e){return"Kategorie zgłoszeń"},"NAVBAR:osh1:kaizenCauses":function(e){return"Przyczyny"},"NAVBAR:osh1:kaizenRisks":function(e){return"Rodzaje ryzyka"},"NAVBAR:osh1:kaizenBehaviours":function(e){return"Zachowania"},"NAVBAR:osh1:kaizenProductFamilies":function(e){return"Rodziny produktów"},"NAVBAR:osh1:kaizenTopics":function(e){return"Tematy rozmów"},"NAVBAR:osh1:kaizenControlCategories":function(e){return"Kategorie kontroli"},"NAVBAR:osh1:kaizenControlLists":function(e){return"Listy kontrolne"},"NAVBAR:osh2:main":function(e){return"Reaguj v2"},"NAVBAR:osh2:entries":function(e){return"Zgłoszenia"},"NAVBAR:osh2:entries:all":function(e){return"Wszystkie"},"NAVBAR:osh2:entries:open":function(e){return"Otwarte"},"NAVBAR:osh2:entries:mine":function(e){return"Moje"},"NAVBAR:osh2:entries:unseen":function(e){return"Nieprzeczytane"},"NAVBAR:osh2:entries:todo":function(e){return"Do realizacji"},"NAVBAR:osh2:hr":function(e){return"HR"},"NAVBAR:osh2:dictionaries":function(e){return"Słowniki"},"NAVBAR:osh2:employments":function(e){return"Zatrudnienie"},"NAVBAR:osh2:targets":function(e){return"Cele"},"NAVBAR:osh2:brigades":function(e){return"Brygady"},"NAVBAR:osh2:companies":function(e){return"Firmy"},"NAVBAR:osh2:divisions":function(e){return"Dywizje"},"NAVBAR:osh2:workplaces":function(e){return"Zakłady"},"NAVBAR:osh2:departments":function(e){return"Wydziały"},"NAVBAR:osh2:buildings":function(e){return"Budynki"},"NAVBAR:osh2:locations":function(e){return"Obszary"},"NAVBAR:osh2:stations":function(e){return"Stanowiska"},"NAVBAR:osh2:kinds":function(e){return"Rodzaje zgłoszeń"},"NAVBAR:osh2:activityKinds":function(e){return"Rodzaje aktywności"},"NAVBAR:osh2:observationKinds":function(e){return"Rodzaje kart obserwacji"},"NAVBAR:osh2:observationCategories":function(e){return"Kategorie obserwacji"},"NAVBAR:osh2:eventCategories":function(e){return"Kategorie zdarzeń"},"NAVBAR:osh2:reasonCategories":function(e){return"Kategorie przyczyn zdarzeń"},"NAVBAR:osh2:rootCauseCategories":function(e){return"Kategorie przyczyn źródłowych"},"NAVBAR:osh2:kaizenCategories":function(e){return"Kategorie kaizen"},"NAVBAR:osh2:nearMisses":function(e){return"ZPW"},"NAVBAR:osh2:kaizens":function(e){return"Kaizen"},"NAVBAR:osh2:actions":function(e){return"Akcje"},"NAVBAR:osh2:observations":function(e){return"Obserwacje"},"NAVBAR:osh2:accidents":function(e){return"Wypadki"},"NAVBAR:osh2:reports":function(e){return"Raporty"},"NAVBAR:osh2:reports:metrics":function(e){return"Wskaźniki"},"NAVBAR:osh2:reports:engagement":function(e){return"Zaangażowanie"},"NAVBAR:osh2:reports:observers":function(e){return"Obserwatorzy"},"NAVBAR:osh2:reports:rewards":function(e){return"Wynagrodzenie"},"NAVBAR:osh2:reports:count/nearMiss":function(e){return"Ilość ZPW"},"NAVBAR:osh2:reports:count/kaizen":function(e){return"Ilość kaizenów"},"NAVBAR:osh2:reports:count/action":function(e){return"Ilość akcji"},"NAVBAR:osh2:reports:count/observation":function(e){return"Ilość obserwacji"},"NAVBAR:osh2:reports:count/accident":function(e){return"Ilość wypadków"},"ACTION_FORM:BUTTON":function(e){return"Wykonaj akcję"},"ACTION_FORM:BUTTON:cancel":function(e){return"Anuluj"},"ACTION_FORM:MESSAGE":function(e){return"Czy na pewno chcesz wykonać żądaną akcję?"},"ACTION_FORM:MESSAGE:failure":function(e){return"Wykonywanie akcji nie powiodło się."},"ACTION_FORM:DIALOG_TITLE:delete":function(e){return"Potwierdzenie usunięcia"},"ACTION_FORM:BUTTON:delete":function(e){return"Usuń"},"ACTION_FORM:MESSAGE:delete":function(e){return"Czy na pewno chcesz bezpowrotnie usunąć wybraną pozycję?"},"ACTION_FORM:MESSAGE_SPECIFIC:delete":function(e){return"Czy na pewno chcesz bezpowrotnie usunąć <em>"+t.v(e,"label")+"</em>?"},"ACTION_FORM:MESSAGE_FAILURE:delete":function(e){return"Usuwanie nie powiodło się."},"FORM:ACTION:add":function(e){return"Dodaj"},"FORM:ACTION:edit":function(e){return"Edytuj"},"FORM:ACTION:save":function(e){return"Zapisz"},"FORM:ERROR:addFailure":function(e){return"Dodawanie nie powiodło się."},"FORM:ERROR:editFailure":function(e){return"Edycja nie powiodła się."},"ORG_UNIT:division":function(e){return"Wydział"},"ORG_UNIT:subdivision":function(e){return"Dział"},"ORG_UNIT:mrpController":function(e){return"Kontroler MRP"},"ORG_UNIT:mrpControllers":function(e){return"Kontroler MRP"},"ORG_UNIT:prodFlow":function(e){return"Przepływ"},"ORG_UNIT:workCenter":function(e){return"WorkCenter"},"ORG_UNIT:prodLine":function(e){return"Linia montażowa"},SHIFT:function(e){return t.v(e,"date")+", "+t.s(e,"shift",{1:"I",2:"II",3:"III",other:t.v(e,"shift")})},"SHIFT:1":function(e){return"I"},"SHIFT:2":function(e){return"II"},"SHIFT:3":function(e){return"III"},"SHIFT:0":function(e){return"Dowolna"},QUARTER:function(e){return t.v(e,"quarter")+" kwartał "+t.v(e,"year")},"QUARTER:1":function(e){return"I"},"QUARTER:2":function(e){return"II"},"QUARTER:3":function(e){return"III"},"QUARTER:4":function(e){return"IV"},"QUARTER:0":function(e){return"Dowolny"},"highcharts:contextButtonTitle":function(e){return"Menu kontekstowe wykresu"},"highcharts:downloadJPEG":function(e){return"Zapisz jako JPEG"},"highcharts:downloadPDF":function(e){return"Zapisz jako PDF"},"highcharts:downloadPNG":function(e){return"Zapisz jako PNG"},"highcharts:downloadSVG":function(e){return"Zapisz jako SVG"},"highcharts:downloadCSV":function(e){return"Zapisz jako CSV"},"highcharts:printChart":function(e){return"Drukuj wykres"},"highcharts:decimalPoint":function(e){return","},"highcharts:thousandsSep":function(e){return" "},"highcharts:noData":function(e){return"Brak danych."},"highcharts:resetZoom":function(e){return"1:1"},"highcharts:resetZoomTitle":function(e){return"Zresetuj przybliżenie"},"highcharts:loading":function(e){return"Ładowanie..."},"highcharts:months":function(e){return"Styczeń_Luty_Marzec_Kwiecień_Maj_Czerwiec_Lipiec_Sierpień_Wrzesień_Październik_Listopad_Grudzień"},"highcharts:shortMonths":function(e){return"Sty_Lut_Mar_Kwi_Maj_Cze_Lip_Sie_Wrz_Paź_Lis_Gru"},"highcharts:weekdays":function(e){return"Niedziela_Poniedziałek_Wtorek_Środa_Czwartek_Piątek_Sobota"},"dataTables:emptyTable":function(e){return"Brak danych."},"dataTables:loadingRecords":function(e){return"Ładowanie danych..."},"dataTables:loadingFailed":function(e){return"Ładowanie danych nie powiodło się."},"colorPicker:label":function(e){return"Kolor"},"filter:date":function(e){return"Data"},"filter:date:from":function(e){return"Od"},"filter:date:from:info":function(e){return"Dane od godziny 06:00 wybranego dnia"},"filter:date:to":function(e){return"Do"},"filter:date:to:info":function(e){return"Dane do godziny 06:00 wybranego dnia"},"filter:shift":function(e){return"Zmiana"},"filter:orgUnit":function(e){return"Jednostka organizacyjna"},"filter:submit":function(e){return"Filtruj"},"filter:filters":function(e){return"Pokaż dodatkowe filtry"},"filter:limit":function(e){return"Limit"},"filter:show":function(e){return"Pokaż filtr"},"filter:hide":function(e){return"Ukryj filtr"},"placeholder:date":function(e){return"rrrr-mm-dd"},"placeholder:time":function(e){return"--:--"},"placeholder:month":function(e){return"rrrr-mm"},"PRINT_PAGE:FT:PAGE_NO":function(e){return"Strona <span class=print-page-no>?</span> z <span class=print-page-count>?</span>"},"PRINT_PAGE:FT:INFO":function(e){return"Wydruk wygenerowany <span class=print-page-date>?</span> przez użytkownika <span class=print-page-user>?</span>."},"html2pdf:progress":function(e){return"Generowanie wydruku..."},"html2pdf:failure":function(e){return"Generowanie wydruku nie powiodło się."},"html2pdf:printing":function(e){return"Wysyłanie wydruku na drukarkę..."},"html2pdf:printing:success":function(e){return"Wydruk został wysłany na wybraną drukarkę."},"html2pdf:printing:failure":function(e){return"Wysyłanie wydruku na wybraną drukarkę nie powiodło się."},"dateTimeRange:placeholder:date":function(e){return"rrrr-mm-dd"},"dateTimeRange:placeholder:time":function(e){return"gg:mm"},"dateTimeRange:label:date":function(e){return"Data"},"dateTimeRange:label:date+time":function(e){return"Czas"},"dateTimeRange:label:month":function(e){return"Data"},"dateTimeRange:+0+1":function(e){return"aktualny"},"dateTimeRange:-1+0":function(e){return"poprzedni"},"dateTimeRange:-2+0":function(e){return"ostatnie 2"},"dateTimeRange:-3+0":function(e){return"ostatnie 3"},"dateTimeRange:-4+0":function(e){return"ostatnie 4"},"dateTimeRange:-6+0":function(e){return"ostatnie 6"},"dateTimeRange:-7+0":function(e){return"ostatnie 7"},"dateTimeRange:+0+7":function(e){return"następne 7"},"dateTimeRange:-14+0":function(e){return"ostatnie 14"},"dateTimeRange:-28+0":function(e){return"ostatnie 28"},"dateTimeRange:shifts":function(e){return"Zmiana"},"dateTimeRange:shifts:+0+1":function(e){return"aktualna"},"dateTimeRange:shifts:-1+0":function(e){return"poprzednia"},"dateTimeRange:shifts:1":function(e){return"I"},"dateTimeRange:shifts:2":function(e){return"II"},"dateTimeRange:shifts:3":function(e){return"III"},"dateTimeRange:days":function(e){return"Dzień"},"dateTimeRange:days:+0+1":function(e){return"dzisiaj"},"dateTimeRange:days:-1+0":function(e){return"wczoraj"},"dateTimeRange:days:+1+2":function(e){return"jutro"},"dateTimeRange:weeks":function(e){return"Tydzień"},"dateTimeRange:months":function(e){return"Miesiąc"},"dateTimeRange:quarters":function(e){return"Kwartał"},"dateTimeRange:quarters:1":function(e){return"I"},"dateTimeRange:quarters:2":function(e){return"II"},"dateTimeRange:quarters:3":function(e){return"III"},"dateTimeRange:quarters:4":function(e){return"IV"},"dateTimeRange:years":function(e){return"Rok"},"dateTimeRange:help":function(e){return"Przytrzymaj <kbd>Alt</kbd> wybierając opcję, aby jednocześnie wysłać formularz."},"embedded:actions:switch":function(e){return"Zmień aplikację"},"embedded:actions:refresh":function(e){return"Odśwież aplikację"},"embedded:actions:config":function(e){return"Konfiguruj"},"embedded:actions:reboot":function(e){return"Uruchom ponownie komputer"},"embedded:actions:shutdown":function(e){return"Wyłącz komputer"},"embedded:actions:resetBrowser":function(e){return"Resetuj przeglądarkę"},"embedded:actions:restartBrowser":function(e){return"Uruchom ponownie przeglądarkę"},"embedded:actions:noKiosk":function(e){return"Wyłącz tryb kiosku"},"embedded:actions:lockUi":function(e){return"Zablokuj interfejs"},"embedded:apps:operator":function(e){return"Formatka operatora"},"embedded:apps:documents":function(e){return"Dokumentacja"},"embedded:apps:heff":function(e){return"Wydajność godzinowa"},"embedded:apps:xiconf":function(e){return"Xiconf"},"embedded:apps:maxos":function(e){return"Wizualizacja MAXOS"},"embedded:apps:drilling":function(e){return"Wiercenie"},"embedded:apps:ps-queue":function(e){return"Kolejka malarnii"},"embedded:apps:ps-load":function(e){return"Obciążenie malarnii"},"embedded:apps:isa":function(e){return"Pola odkładcze"},"embedded:apps:trw":function(e){return"Tester TRW"},"embedded:apps:snf":function(e){return"Tester SNF"},"embedded:apps:gft":function(e){return"Tester GearFlex"},"embedded:apps:wh-pickup":function(e){return"Kompletacja"},"embedded:apps:wh-delivery-components":function(e){return"Wysyłka FIFO"},"embedded:apps:wh-delivery-packaging":function(e){return"Wysyłka opakowań"},"embedded:apps:wh-delivery-ps":function(e){return"Wysyłka malarnii"},"embedded:apps:remote":function(e){return"Zdalna"},"embedded:reboot:title":function(e){return"Ponowne uruchamianie komputera"},"embedded:reboot:message":function(e){return"Czy na pewno chcesz ponownie uruchomić komputer?"},"embedded:reboot:yes":function(e){return"Uruchom ponownie"},"embedded:reboot:no":function(e){return"Anuluj"},"embedded:shutdown:title":function(e){return"Wyłączanie komputera"},"embedded:shutdown:message":function(e){return"Czy na pewno chcesz wyłączyć komputer?"},"embedded:shutdown:yes":function(e){return"Wyłącz komputer"},"embedded:shutdown:no":function(e){return"Anuluj"},"embedded:lockUi:message":function(e){return"Interfejs zablokowany.<br>Dotknij tutaj, aby odblokować."},"PANEL:TITLE:details":function(e){return"Szczegóły"},"PANEL:TITLE:addForm":function(e){return"Formularz dodawania"},"PANEL:TITLE:editForm":function(e){return"Formularz edycji"},"notifications:request:message":function(e){return"Kliknij tutaj, aby włączyć powiadomienia w przeglądarce."},"lang:pl":function(e){return"Polski (pl)"},"lang:en":function(e){return"Angielski (en)"},labelCopySuffix:function(e){return t.v(e,"label")+" (kopia)"},"resultTips:copied":function(e){return"Skopiowano!"}}}),function(){"use strict";function e(){require(["domReady","jquery","backbone","backbone.layout","moment","app/monkeyPatch","app/broker","app/i18n","app/socket","app/router","app/viewport","app/updater/index","app/data/loadedModules","app/core/layouts/BlankLayout","app/time","app/wmes-operator-routes","bootstrap","moment-lang/"+window.appLocale,"select2-lang/"+window.appLocale,"i18n!app/nls/core"],t)}function t(e,t,n,i,r,o,a,s,u,c,l,d,p,f){var h=a.sandbox();function m(){h.destroy(),h=a.sandbox(),a.subscribe("i18n.reloaded",function(e){localStorage.setItem("LOCALE",e.newLocale),window.location.reload()}),"function"==typeof window.onPageShown&&a.subscribe("viewport.page.shown",window.onPageShown).setLimit(1),e(function(){h.subscribe("viewport.page.shown",g).setLimit(1),window.ENV&&document.body.classList.add("is-"+window.ENV+"-env"),n.history.start({root:"/",hashChange:!0,pushState:!1})})}function g(){null!==h&&(h.destroy(),h=null),t("#app-loading").remove(),t("body").removeClass("is-loading")}u.connect(),r.locale(window.appLocale),t.ajaxSetup({dataType:"json",accepts:{json:"application/json",text:"text/plain"},contentType:"application/json"}),i.configure({manage:!0,el:!1,keep:!0}),l.registerLayout("blank",function(){return new f}),l.setDefaultLayout("blank"),a.subscribe("page.titleChanged",function(e){e.unshift(s("core","TITLE")),document.title=e.reverse().join(" < ")}),navigator.onLine?(h.subscribe("socket.connected",function(){h.subscribe("user.reloaded",m)}),h.subscribe("socket.connectFailed",m)):m()}window.WMES_APP_ID="operator",window.requireApp=function(){window.IS_LINUX&&window.parent!==window?require(["app/data/localStorage"],function(t){t.start(e)}):e()}}(),define("wmes-operator",function(){}),function(e){"use strict";if("function"==typeof define&&define.amd)return define("select2-lang/en",["jquery","select2"],e);e(window.jQuery)}(function(e){"use strict";var t={formatNoMatches:function(){return"No matches found."},formatInputTooShort:function(e,t){var n=t-e.length;return"Please enter "+n+" more character"+(1===n?"":"s")},formatInputTooLong:function(e,t){var n=e.length-t;return"Please delete "+n+" character"+(1===n?"":"s")},formatSelectionTooBig:function(e){return"You can only select "+e+" item"+(1===e?"":"s")},formatLoadMore:function(){return"Loading more results..."},formatSearching:function(){return"Searching..."}};return e.extend(e.fn.select2.defaults,t),t}),function(e){"use strict";if("function"==typeof define&&define.amd)return define("select2-lang/pl",["jquery","select2"],e);e(window.jQuery)}(function(e){"use strict";function t(e,t){return 1===e?"":e%100>1&&e%100<5||e%100>20&&e%10>1&&e%10<5?t:"ów"}var n={formatNoMatches:function(){return"Brak wyników."},formatInputTooShort:function(e,n){var i=n-e.length;return"Wpisz jeszcze "+i+" znak"+t(i,"i")+"."},formatInputTooLong:function(e,n){var i=e.length-n;return"Wpisana fraza jest za długa o "+i+" znak"+t(i,"i")+"."},formatSelectionTooBig:function(e){return"Możesz zaznaczyć najwyżej "+e+" element"+t(e,"y")+"."},formatLoadMore:function(){return"Ładowanie kolejnych wyników..."},formatSearching:function(){return"Szukanie..."}};return e.extend(e.fn.select2.defaults,n),n}),function(e){"function"==typeof define&&define.amd?define("moment-lang/en",["moment"],e):"object"==typeof exports?module.exports=e(require("../moment")):e(window.moment)}(function(e){return e}),function(e,t){"object"==typeof exports&&"undefined"!=typeof module&&"function"==typeof require?t(require("../moment")):"function"==typeof define&&define.amd?define("moment-lang/pl",["../moment"],t):t(e.moment)}(this,function(e){"use strict";var t="styczeń_luty_marzec_kwiecień_maj_czerwiec_lipiec_sierpień_wrzesień_październik_listopad_grudzień".split("_"),n="stycznia_lutego_marca_kwietnia_maja_czerwca_lipca_sierpnia_września_października_listopada_grudnia".split("_");function i(e){return e%10<5&&e%10>1&&~~(e/10)%10!=1}function r(e,t,n){var r=e+" ";switch(n){case"m":return t?"minuta":"minutę";case"mm":return r+(i(e)?"minuty":"minut");case"h":return t?"godzina":"godzinę";case"hh":return r+(i(e)?"godziny":"godzin");case"MM":return r+(i(e)?"miesiące":"miesięcy");case"yy":return r+(i(e)?"lata":"lat")}}return e.defineLocale("pl",{months:function(e,i){return""===i?"("+n[e.month()]+"|"+t[e.month()]+")":/D MMMM/.test(i)?n[e.month()]:t[e.month()]},monthsShort:"sty_lut_mar_kwi_maj_cze_lip_sie_wrz_paź_lis_gru".split("_"),weekdays:"niedziela_poniedziałek_wtorek_środa_czwartek_piątek_sobota".split("_"),weekdaysShort:"ndz_pon_wt_śr_czw_pt_sob".split("_"),weekdaysMin:"Nd_Pn_Wt_Śr_Cz_Pt_So".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},calendar:{sameDay:"[Dziś o] LT",nextDay:"[Jutro o] LT",nextWeek:"[W] dddd [o] LT",lastDay:"[Wczoraj o] LT",lastWeek:function(){switch(this.day()){case 0:return"[W zeszłą niedzielę o] LT";case 3:return"[W zeszłą środę o] LT";case 6:return"[W zeszłą sobotę o] LT";default:return"[W zeszły] dddd [o] LT"}},sameElse:"L"},relativeTime:{future:"za %s",past:"%s temu",s:"kilka sekund",m:r,mm:r,h:r,hh:r,d:"1 dzień",dd:"%d dni",M:"miesiąc",MM:r,y:"rok",yy:r},ordinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}})}),function(e){var t=document,n="appendChild",i="styleSheet",r=t.createElement("style");r.type="text/css",t.getElementsByTagName("head")[0][n](r),r[i]?r[i].cssText=e:r[n](t.createTextNode(e))}(".orders-commentPopover{position:absolute;top:0;left:-1000px;z-index:1042;display:flex;background:#fff;border:1px solid rgba(0,0,0,.15);box-shadow:0 6px 12px rgba(0,0,0,.175)}.orders-commentPopover .form-control{width:300px;height:54px}");