// Part of <http://miracle.systems/p/walkner-wmes> licensed under <CC BY-NC-SA 4.0>

define(["app/time","app/core/views/FilterView","app/core/util/idAndLabel","app/users/util/setUpUserSelect2","app/opinionSurveys/dictionaries","app/opinionSurveyResponses/templates/filter"],function(e,i,r,s,t,a){"use strict";return i.extend({template:a,defaultFormData:function(){return{survey:"",division:"",superior:"",employer:""}},termToForm:{survey:function(e,i,r){r[e]=i.args[1]},division:function(e,i,r){r[e]="in"===i.name?i.args[1].join(","):i.args[1]},superior:"division",employer:"division"},afterRender:function(){i.prototype.afterRender.call(this),this.$id("survey").select2({width:175,allowClear:!0,placeholder:" ",minimumResultsForSearch:-1,data:this.model.opinionSurveys.map(r)}),this.$id("division").select2({width:225,multiple:!0,allowClear:!0,data:t.divisions.map(r)}),this.$id("employer").select2({width:200,multiple:!0,allowClear:!0,data:t.employers.map(r)}),s(this.$id("superior"),{width:500,multiple:!0,view:this})},serializeFormToQuery:function(e){var i=this.$id("survey").val();i.length&&e.push({name:"eq",args:["survey",i]}),["division","employer","superior"].forEach(function(i){var r=this.$id(i).val().split(",");r.length>1?e.push({name:"in",args:[i,r]}):""!==r[0]&&e.push({name:"eq",args:[i,r[0]]})},this)}})});