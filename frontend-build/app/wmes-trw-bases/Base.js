define(["underscore","../core/Model"],function(t,e){"use strict";return e.extend({urlRoot:"/trw/bases",clientUrlRoot:"#trw/bases",topicPrefix:"trw.bases",privilegePrefix:"TRW",nlsDomain:"wmes-trw-bases",labelAttribute:"name",defaults:function(){return{clusters:[]}},url:function(){var t=e.prototype.url.apply(this,arguments);return this.isNew()?t:t+"?populate(tester)"},serialize:function(){var t=this.toJSON();return t.tester&&t.tester.name&&(t.tester=t.tester.name),t},serializeForm:function(){var t=this.toJSON();return t.tester&&t.tester._id&&(t.tester=t.tester._id),t},updateCluster:function(e){var r,s=this.get("clusters"),i=t.findIndex(s,function(t){return t._id===e._id}),n=s[i]||null;-1!==i?(r=[].concat(s))[i]=e:r=s.concat(e),this.attributes.clusters=r,this.trigger("change:clusters",this,r,{action:"updateOne",oldCluster:n,newCluster:e}),this.trigger("change",this)},deleteCluster:function(e){var r=this.get("clusters"),s=t.without(r,e);s.length!==r.length&&this.set("clusters",s,{action:"deleteOne",cluster:e})},updateIo:function(t){var e=this.get("clusters");e.length&&(e.forEach(function(e){e.rows.forEach(function(e){e.forEach(function(e){e.io=e.io.filter(function(e){return!!t[e]})})})}),this.trigger("change:clusters",this,e,{action:"updateIo"}),this.trigger("change",this))}})});