define(["require","app/time","app/user","app/core/Model","app/core/util/sortByProps"],function(e,t,i,r,o){"use strict";return r.extend({urlRoot:"/osh/targets",clientUrlRoot:"#osh/targets",topicPrefix:"osh.targets",privilegePrefix:"OSH:HR",nlsDomain:"wmes-osh-targets",getLabel:function(){return t.utc.format(this.id,"MMMM YYYY")},parse:function(e){return e._id=t.utc.format(e._id,"YYYY-MM-DD"),e},serialize:function(){const e=this.toJSON();return e.month=t.utc.format(e._id,"MMMM YYYY"),e},serializeRow:function(){return this.serialize()},serializeDetails:function(){const e=this.serialize();return e.orgUnits=this.serializeOrgUnits().sort(o(["divisionLabel","workplaceLabel","departmentLabel"])),e},serializeOrgUnits:function(){const t=e("app/wmes-osh-common/dictionaries");return(this.get("orgUnits")||[]).map(e=>({type:e.department?"department":e.workplace?"workplace":e.division?"division":"overall",key:`d${e.division}w${e.workplace}d${e.department}`,division:e.division,divisionLabel:t.getLabel("divisions",e.division),workplace:e.workplace,workplaceLabel:t.getLabel("workplaces",e.workplace),department:e.department,departmentLabel:t.getLabel("departments",e.department),targets:e.targets}))}},{canDelete:function(){return i.isAllowedTo("SUPER")}})});