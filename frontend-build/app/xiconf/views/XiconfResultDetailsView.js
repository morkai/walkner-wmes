// Copyright (c) 2014, ≈Åukasz Walukiewicz <lukasz@walukiewicz.eu>. Some Rights Reserved.
// Licensed under CC BY-NC-SA 4.0 <http://creativecommons.org/licenses/by-nc-sa/4.0/>.
// Part of the walkner-wmes project <http://lukasz.walukiewicz.eu/p/walkner-wmes>

define(["underscore","highlight","app/core/View","app/xiconf/templates/details"],function(t,e,i,a){return i.extend({template:a,events:{"click .history-tabs a":function(t){t.preventDefault();var e=this.$(t.target).tab("show").parent().attr("data-tab");this.broker.publish("router.navigate",{url:this.model.genClientUrl()+"?tab="+e,trigger:!1,replace:!0})},"shown.bs.tab":function(t){"feature"===t.target.parentNode.dataset.tab&&this.highlightFeature()}},initialize:function(){this.featureHighlighted=!1,this.listenTo(this.model,"change",t.after(2,this.render.bind(this)))},serialize:function(){return{idPrefix:this.idPrefix,model:this.model.toJSON(),log:this.model.getDecoratedLog()}},beforeRender:function(){this.featureHighlighted=!1},afterRender:function(){this.$('.nav-tabs > li[data-tab="'+(this.options.tab||"log")+'"] > a').tab("show")},highlightFeature:function(){this.featureHighlighted||(this.model.hasFeatureData()&&e.highlightBlock(this.$id("feature").find("code")[0]),this.featureHighlighted=!0)}})});