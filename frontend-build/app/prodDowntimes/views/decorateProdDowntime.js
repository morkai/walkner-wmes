define(["app/time","app/i18n","app/user","app/data/aors","app/data/subdivisions","app/data/mrpControllers","app/data/prodFlows","app/data/prodLines","app/data/downtimeReasons","app/data/views/renderOrgUnitPath","app/core/templates/userInfo"],function(e,t,n,r,i,o,a,s,l,u,d){return function(o){var c=o.toJSON();c.statusClassName=o.getCssClassName(),c.className=c.statusClassName,c.reasonComment&&c.reasonComment.trim().length&&(c.className+=" is-withReasonComment");var p=r.get(c.aor);c.aor=p?p.getLabel():c.aor;var f=s.get(c.prodLine);f&&(c.prodLine=f.getLabel(),c.prodLinePath=u(f,!1,!1));var m=l.get(c.reason);if(c.reason=m?m.getLabel():c.reason,c.startedAt&&c.finishedAt){var h=Date.parse(c.startedAt),v=Date.parse(c.finishedAt),g=Math.round((v-h)/1e3);c.duration=e.toString(g)}else c.duration="-";c.startedAt=e.format(c.startedAt,"YYYY-MM-DD HH:mm:ss"),c.finishedAt=c.finishedAt?e.format(c.finishedAt,"YYYY-MM-DD HH:mm:ss"):t("prodDowntimes","NO_DATA:finishedAt"),c.corroboratedAt=e.format(c.corroboratedAt,"YYYY-MM-DD HH:mm:ss")||"-",c.order=c.prodShiftOrder?c.orderId+"; "+c.operationNo:t("prodDowntimes","NO_DATA:order"),n.isAllowedTo("PROD_DATA:VIEW")&&c.prodShiftOrder&&(c.order='<a href="#prodShiftOrders/'+c.prodShiftOrder+'">'+c.order+"</a>"),c.date=c.date?e.format(c.date,"YYYY-MM-DD"):"?",c.shift=c.shift?t("core","SHIFT:"+c.shift):"?",c.prodShiftText=c.date+", "+c.shift,n.isAllowedTo("PROD_DATA:VIEW")&&c.prodShiftText&&(c.prodShiftText='<a href="#prodShifts/'+c.prodShift+'">'+c.prodShiftText+"</a>"),c.masterInfo=d({userInfo:c.master}),c.leaderInfo=d({userInfo:c.leader}),c.operatorInfo=d({userInfo:c.operator}),c.creatorInfo=d({userInfo:c.creator}),c.corroboratorInfo=d({userInfo:c.corroborator});var w=i.get(c.subdivision),b=a.get(c.prodFlow);return c.subdivision=w?w.getLabel():"?",c.prodFlow=b?b.getLabel():"?",c.mrpControllers=Array.isArray(c.mrpControllers)&&c.mrpControllers.length?c.mrpControllers.join("; "):"?",c}});