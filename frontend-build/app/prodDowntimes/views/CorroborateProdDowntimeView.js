define(["underscore","app/i18n","app/time","app/user","app/viewport","app/core/View","./decorateProdDowntime","app/prodDowntimes/templates/corroborate"],function(e,t,i,o,r,n,s,a){return n.extend({template:a,events:{"click .btn-success":function(){this.corroborate("confirmed")},"click .btn-danger":function(){this.corroborate("rejected")}},initialize:function(){this.idPrefix=e.uniqueId("cpdv"),this.listenTo(this.model,"change:finishedAt",function(){this.$(".prodDowntimes-corroborate-finishedAt").text(i.format(this.model.get("finishedAt"),"YYYY-MM-DD HH:mm:ss"))})},serialize:function(){return{idPrefix:this.idPrefix,model:s(this.model),cancelUrl:this.options.cancelUrl||"#"}},corroborate:function(e){var i=this.$id("decisionComment"),n=this.$(".btn-success").attr("disabled",!0),s=this.$(".btn-danger").attr("disabled",!0),a="confirmed"===e?n:s;a.prepend('<i class="fa fa-spinner fa-spin"></i> ');var d={_id:this.model.id,corroborator:o.getInfo(),status:e,decisionComment:i.val().trim()};this.socket.emit("prodDowntimes.corroborate",d,function(e){e&&(r.msg.show({type:"error",time:5e3,text:t("prodDowntimes","corroborate:msg:failure")}),n.attr("disabled",!1),s.attr("disabled",!1)),a.find(".fa-spinner").remove()})}})});