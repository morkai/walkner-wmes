define(["../broker","../time","../router","../viewport","../user","./pages/DrillingPage","i18n!app/nls/wmes-drilling"],function(e,a,r,t,i,n){"use strict";var s=i.auth("LOCAL","DRILLING:VIEW"),d=i.auth("DRILLING:MANAGE");r.map("/drilling/:date",s,function(r){"current"===r.params.date&&(r.params.date="0d"),/^-?[0-9]+d$/.test(r.params.date)&&(r.params.date=a.getMoment().subtract(a.getMoment().hours()<6?1:0,"days").startOf("day").add(+r.params.date.replace("d",""),"days").format("YYYY-MM-DD"),e.publish("router.navigate",{url:"/drilling/"+r.params.date,replace:!0,trigger:!1})),t.showPage(new n({date:r.params.date,selectedMrp:r.query.mrp,fullscreen:void 0!==r.query.fullscreen}))}),r.map("/drilling;settings",d,function(e){t.loadPage(["app/wmes-drilling/pages/DrillingSettingsPage"],function(a){return new a({initialTab:e.query.tab})})})});