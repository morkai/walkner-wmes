define(["../broker","../time","../router","../viewport","../user"],function(e,a,r,t,i){"use strict";var n=i.auth("LOCAL","DRILLING:VIEW"),s=i.auth("DRILLING:MANAGE");r.map("/drilling/:date",n,function(r){"current"===r.params.date&&(r.params.date="0d"),/^-?[0-9]+d$/.test(r.params.date)&&(r.params.date=a.getMoment().subtract(a.getMoment().hours()<6?1:0,"days").startOf("day").add(+r.params.date.replace("d",""),"days").format("YYYY-MM-DD"),e.publish("router.navigate",{url:"/drilling/"+r.params.date,replace:!0,trigger:!1})),t.loadPage(["app/wmes-drilling/pages/DrillingPage","css!app/wmes-drilling/assets/main","i18n!app/nls/wmes-drilling"],function(e){return new e({date:r.params.date,selectedMrp:r.query.mrp,fullscreen:void 0!==r.query.fullscreen})})}),r.map("/drilling;settings",s,function(e){t.loadPage(["app/wmes-drilling/pages/DrillingSettingsPage","i18n!app/nls/wmes-drilling"],function(a){return new a({initialTab:e.query.tab})})})});