// Part of <https://miracle.systems/p/walkner-wmes> licensed under <CC BY-NC-SA 4.0>

define(["../core/Model"],function(n){"use strict";return n.extend({urlRoot:"/kanban/printQueues",clientUrlRoot:"#kanban/printQueues",topicPrefix:"kanban.printQueues",privilegePrefix:"KANBAN",nlsDomain:"kanbanPrintQueues",serialize:function(){var n=this.toJSON();return n.shortId=n._id.substr(0,4)+"..."+n._id.substr(-4),n.lines={},n.kanbans={},n.jobCount={total:n.jobs.length,completed:0,pending:0,printing:0,failure:0,success:0,ignored:0},n.layoutCount={kk:0,empty:0,full:0,wh:0,desc:0},n.jobs.forEach(function(t){n.lines[t.line]=1,n.jobCount[t.status]+=1,t.shortId=t._id.substr(0,4)+"..."+t._id.substr(-4),t.kanbanIds=[],t.kanbans.forEach(function(s){for(s=s.toString(),n.kanbans[s]=1;s.length<5;)s=" "+s;t.kanbanIds.push(s)}),t.kanbanIds=t.kanbanIds.join(" "),t.layoutCount={kk:0,empty:0,full:0,wh:0,desc:0},t.layouts.forEach(function(s){n.layoutCount[s]+=t.kanbans.length,t.layoutCount[s]+=t.kanbans.length})}),n.lines=Object.keys(n.lines),n.kanbans=Object.keys(n.kanbans),n.jobCount.completed=n.jobCount.ignored+n.jobCount.success,n.jobCount.printing?n.status="printing":n.jobCount.completed===n.jobCount.total?n.status="success":n.jobCount.failure?n.status="failure":n.status="pending",n}})});