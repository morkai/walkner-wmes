define(["underscore","jquery","app/viewport","app/core/views/FormView","app/core/templates/colorPicker","app/wmes-trw-programs/templates/messageForm","bootstrap-colorpicker"],function(e,t,o,r,n,i){"use strict";return r.extend({nlsDomain:"wmes-trw-programs",template:i,updateOnChange:!1,events:e.assign({"change [name$=Color]":"updateColorPicker"},r.prototype.events),destroy:function(){this.$(".colorpicker-component").colorpicker("destroy")},getTemplateData:function(){return e.assign(r.prototype.getTemplateData.call(this),{renderColorPicker:n})},afterRender:function(){var e=this;r.prototype.afterRender.apply(e,arguments);var o=t(".modal");e.$('input[name$="Color"]').each(function(){e.$(this).parent().colorpicker({container:o})})},onDialogShown:function(){this.$id("steps").focus()},serializeToForm:function(){var e=this.model.toJSON();return e.steps=e.steps.join(", "),e},serializeForm:function(e){return e.text=(e.text||"").trim().replace(/ {2,}/g," "),e.steps=(e.steps||"").split(/[^0-9]+/).filter(function(e){return!!e}).map(function(e){return+e}),["top","left","width","height","fontSize","borderWidth"].forEach(function(t){var o=parseInt(e[t],10);e[t]=isNaN(o)?null:o}),["fontColor","bgColor","borderColor"].forEach(function(t){e[t]=/^#[0-9a-fA-F]{6}$/.test(e[t])?e[t].toUpperCase():null}),e},submitRequest:function(e,t){this.model.set(t),o.closeDialog()},updateColorPicker:function(e){e.originalEvent&&this.$(e.target).closest(".colorpicker-component").colorpicker("setValue",e.target.value)}})});