define(["underscore"],function(n){"use strict";var s=72;return function(t,h,r){r=n.assign({html:!0},r);var u=[],e=t.laborTimes;h.length&&(e=e.filter(function(n){var s=null===n.deps?"__NULL__":n.deps;return-1!==h.indexOf(s)}));var a=e.length-1;return e.forEach(function(n,t){!function(n,t,h){t||u.push("\n");r.html&&u.push('<span class="hljs-comment">');u.push("* "+n.row),n.item&&u.push(" | "+n.item);n.nc12&&u.push(" | "+n.nc12);n.deps&&u.push(" | "+n.deps);var e=n.description;e&&(e.length>s-7&&(e=e.substring(0,s-12)+"..."),u.push("\n* "+e));r.html&&u.push("</span>");u.push("\n$SELF.LABOR_TIME = $SELF.LABOR_TIME + "),r.html&&u.push('<span class="hljs-number">');u.push(Math.round(1e3*n.value)/1e3),r.html&&u.push("</span>");var a=Object.keys(n.conditions),i=a.length-1;a.forEach(function(t,h){!function(n,t,h,e){if(0!==t.length){if(u.push("\n"),!Array.isArray(t))return u.push(p(n,h,!1,r.html)),u.push(function(n){var s=n.charAt(0),t="=";if("<"===s||">"===s){var h=n.match(/^([<>][>=]?)(.*?)$/);t=h[1],n=h[2].trim()}return t+" "+l(n)}(t)),void(e&&u.push(")"));var a=p(n,h,!0,r.html),i=p(n,h,!0,!1),c=t.length-1;t.forEach(function(n,t){var h=t===c?")":", ";i.length+n.length+h.length>s&&(u.push(a+"\n"),a=i="         "),a+=l(n)+h,i+=n+h}),u.push(a),e&&(i.length>=s-1&&u.push("\n     "),u.push(")"))}}(t,n.conditions[t],0===h,h===i)}),h||u.push(",")}(n,0===t,t===a)}),u.join("");function p(n,s,t,h){var r="";return h?(r+=s?'     <span class="hljs-keyword">IF</span> (':'     <span class="hljs-keyword">AND</span> ',r+='<span class="hljs-symbol">'+n+"</span> ",t&&(r+='<span class="hljs-keyword">IN</span> (')):(r+=s?"     IF (":"     AND ",r+=n+" ",t&&(r+=" IN (")),r}function l(n){return r.html?'<span class="hljs-'+(/^[0-9]+(\.[0-9]+)?$/.test(n)?"number":"string")+'">'+n+"</span>":n}}});