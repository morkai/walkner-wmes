define(["underscore","app/data/orgUnits","app/settings/views/SettingsView","app/factoryLayout/templates/settings"],function(t,e,i,s){"use strict";return i.extend({clientUrl:"#factoryLayout;settings",defaultTab:"blacklist",template:s,localTopics:{"divisions.synced":"render","subdivisions.synced":"render"},events:t.assign({'change input[name^="factoryLayout.blacklist"]':function(t){this.updateSetting(t.target.name,t.target.value)}},i.prototype.events),serialize:function(){var s=this.settings;return t.assign(i.prototype.serialize.call(this),{divisions:t.map(e.getAllByType("division"),function(t){var e="factoryLayout."+t.id+".color",i=s.get(e);return{property:e,label:t.getLabel(),color:i?i.get("value"):"#FFFFFF"}})})},afterRender:function(){i.prototype.afterRender.call(this),this.setUpBlacklistSelect2("division"),this.setUpBlacklistSelect2("subdivision"),this.setUpBlacklistSelect2("mrpController"),this.setUpBlacklistSelect2("prodFlow"),this.setUpBlacklistSelect2("workCenter"),this.setUpBlacklistSelect2("prodLine")},setUpBlacklistSelect2:function(t){this.$id("blacklist-"+t).select2({multiple:!0,data:e.getAllByType(t).map(function(e){return{id:e.id,text:("subdivision"===t?e.get("division")+" > ":"")+e.getLabel()}})})},updateSettingField:function(t){if(/blacklist/.test(t.id))return this.$('input[name="'+t.id+'"]').select2("val",t.getValue())}})});