// Copyright (c) 2014, ≈Åukasz Walukiewicz <lukasz@walukiewicz.eu>. Some Rights Reserved.
// Licensed under CC BY-NC-SA 4.0 <http://creativecommons.org/licenses/by-nc-sa/4.0/>.
// Part of the walkner-wmes project <http://lukasz.walukiewicz.eu/p/walkner-wmes>

define(["underscore","../user","../core/Model","../data/orgUnits"],function(t,e,i,n){return i.extend({defaults:function(){return{orgUnitType:null,orgUnitIds:null,statuses:["online","offline"],states:["idle","working","downtime"]}},serializeToString:function(){var t=this.attributes;return"statuses="+t.statuses+"&states="+t.states+"&orgUnitType="+t.orgUnitType+"&orgUnitIds="+t.orgUnitIds.map(encodeURIComponent)},isVisible:function(t){var e=this.attributes;return-1!==e.statuses.indexOf(t.get("online")?"online":"offline")&&-1!==e.states.indexOf(t.get("state")||"idle")&&n.containsProdLine(e.orgUnitType,e.orgUnitIds,t.id)},save:function(){localStorage.setItem("ProdLineStateDisplayOptions",JSON.stringify(this.attributes))}},{readLocalStorage:function(){},fromQuery:function(i){var n={orgUnitType:i.orgUnitType,orgUnitIds:i.orgUnitIds?i.orgUnitIds.split(","):void 0,statuses:i.statuses?i.statuses.split(","):void 0,states:i.states?i.states.split(","):void 0},s=localStorage.getItem("ProdLineStateDisplayOptions");return s&&t.defaults(n,JSON.parse(s)),n.orgUnitType||(e.data.orgUnitType?(n.orgUnitType=e.data.orgUnitType,n.orgUnitIds=[e.data.orgUnitId]):(n.orgUnitType="prodLine",n.orgUnitIds=[])),new this(n)}})});