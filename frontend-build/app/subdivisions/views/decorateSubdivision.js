// Part of <http://miracle.systems/p/walkner-wmes> licensed under <CC BY-NC-SA 4.0>

define(["underscore","app/i18n","app/data/aors","app/data/downtimeReasons","app/data/divisions","app/data/views/renderOrgUnitPath"],function(n,a,t,e,o,i){"use strict";return function(r,s){var u=r.toJSON();u.division=i(o.get(u.division),!0,!1),u.type=a("subdivisions","TYPE:"+u.type),u.prodTaskTags=u.prodTaskTags&&u.prodTaskTags.length?u.prodTaskTags.join("; "):null;var p=t.get(u.aor);return u.aor=p?p.getLabel():"-",u.autoDowntimes=n.map(u.autoDowntimes,function(n){var a=e.get(n.reason);return a?{reason:a.getLabel(),when:n.when}:null}).filter(function(n){return!!n}),s!==!0&&(u.autoDowntimes=0===u.autoDowntimes.length?"-":u.autoDowntimes.map(function(n){return n.reason}).join("; ")),u}});