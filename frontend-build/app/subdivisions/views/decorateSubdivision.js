// Part of <http://miracle.systems/p/walkner-wmes> licensed under <CC BY-NC-SA 4.0>

define(["underscore","app/i18n","app/data/aors","app/data/downtimeReasons","app/data/divisions","app/data/views/renderOrgUnitPath"],function(n,t,a,e,o,i){"use strict";return function(r,s){var u=r.toJSON();u.division=i(o.get(u.division),!0,!1),u.type=t("subdivisions","TYPE:"+u.type),u.prodTaskTags=u.prodTaskTags&&u.prodTaskTags.length?u.prodTaskTags.join("; "):null;var p=a.get(u.aor);return u.aor=p?p.getLabel():"-",u.autoDowntimes=n.map(u.autoDowntimes,function(n){var t=e.get(n.reason);return t?{reason:t.getLabel(),when:n.when,time:(n.time||[]).map(function(n){return(n.h<10?"0":"")+n.h+":"+(n.m<10?"0":"")+n.m}).join(", ")}:null}).filter(function(n){return!!n}),s!==!0&&(u.autoDowntimes=0===u.autoDowntimes.length?"-":u.autoDowntimes.map(function(n){return n.reason}).join("; ")),u}});