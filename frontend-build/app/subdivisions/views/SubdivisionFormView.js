// Copyright (c) 2014, ≈Åukasz Walukiewicz <lukasz@walukiewicz.eu>. Some Rights Reserved.
// Licensed under CC BY-NC-SA 4.0 <http://creativecommons.org/licenses/by-nc-sa/4.0/>.
// Part of the walkner-wmes project <http://lukasz.walukiewicz.eu/p/walkner-wmes>

define(["app/data/aors","app/data/views/OrgUnitDropdownsView","app/core/views/FormView","app/subdivisions/templates/form"],function(t,e,i,o){return i.extend({template:o,initialize:function(){i.prototype.initialize.call(this),this.orgUnitDropdownsView=new e({orgUnit:e.ORG_UNIT.DIVISION}),this.setView(".orgUnitDropdowns-container",this.orgUnitDropdownsView)},afterRender:function(){i.prototype.afterRender.call(this),this.listenToOnce(this.orgUnitDropdownsView,"afterRender",function(){this.orgUnitDropdownsView.selectValue(this.model).focus()}),this.$id("prodTaskTags").select2({tags:this.model.allTags||[],tokenSeparators:[","]}),this.$id("aor").select2({allowClear:!0,data:t.map(function(t){return{id:t.id,text:t.getLabel()}})})},serializeToForm:function(){var t=this.model.toJSON();return t.prodTaskTags=t.prodTaskTags?t.prodTaskTags.join(","):"",t},serializeForm:function(e){return e.prodTaskTags="string"==typeof e.prodTaskTags?e.prodTaskTags.split(","):[],e.aor=t.get(e.aor)?e.aor:null,e}})});