define(["underscore","app/i18n","app/core/views/ListView","app/behaviorObsCards/templates/detailsRow"],function(i,e,s,t){"use strict";return s.extend({className:"is-clickable",events:i.assign({"click .behaviorObsCards-list-expander":function(i){var e=i.currentTarget;return e.classList.contains("is-enabled")&&this.toggleDetails(e.parentNode.dataset.id,e.dataset.id),!1},"click .is-filter":function(i){this.trigger("showFilter",i.currentTarget.dataset.columnId)}},s.prototype.events),serializeColumns:function(){if(this.options.simple)return[{id:"rid",className:"is-min is-number"},{id:"date",className:"is-min"},{id:"section",className:"is-min"},{id:"line"}];var i=function(i,e){return'<span class="behaviorObsCards-list-text">'+e+"</span>"},e=function(i,e){return{className:["behaviorObsCards-list-expander","is-"+(i[e.id]?"enabled":"disabled")]}};return[{id:"rid",className:"is-min is-number",thClassName:"is-filter"},{id:"date",className:"is-min",thClassName:"is-filter"},{id:"observer",className:"is-min",thClassName:"is-filter"},{id:"section",className:"is-min",thClassName:"is-filter"},{id:"line",className:"is-min",thClassName:"is-filter"},{id:"position",className:"is-min",tdDecorator:i},{id:"observation",tdAttrs:e,tdDecorator:i},{id:"risk",tdAttrs:e,tdDecorator:i},{id:"hardBehavior",thClassName:"is-filter",tdAttrs:e,tdDecorator:i},{id:"hardCondition",thClassName:"is-filter",tdAttrs:e,tdDecorator:i}]},serializeActions:function(){var i=this.collection;return this.options.simple?null:function(e){var t=i.get(e._id),a=[s.actions.viewDetails(t)];return t.canEdit()&&a.push(s.actions.edit(t)),t.canDelete()&&a.push(s.actions.delete(t)),a}},toggleDetails:function(i,e){var s=this.$('.list-item[data-id="'+i+'"]'),t=this.$(".is-expanded");this.collapseDetails(t),s[0]===t[0]&&t.attr("data-expanded-column-id")===e||this.expandDetails(s,e)},collapseDetails:function(i){i.removeClass("is-expanded").next().remove()},expandDetails:function(i,e){var s=this.collection.get(i.attr("data-id")),a="observation"===e?"observations":"risk"===e?"risks":"difficulties",r={columnId:e,model:{}};r.model[a]=s.get(a),this.renderPartial(t,r).insertAfter(i),i.addClass("is-expanded").attr("data-expanded-column-id",e)}})});