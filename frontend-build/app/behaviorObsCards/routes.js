define(["underscore","../broker","../router","../viewport","../user","../core/util/showDeleteFormPage"],function(a,r,e,s,i,o){"use strict";var t="i18n!app/nls/behaviorObsCards",n=i.auth();e.map("/behaviorObsCardCountReport",n,function(a){s.loadPage(["app/behaviorObsCards/BehaviorObsCardCountReport","app/behaviorObsCards/pages/BehaviorObsCardCountReportPage","i18n!app/nls/reports",t],function(r,e){return new e({model:r.fromQuery(a.query)})})}),e.map("/behaviorObsCards",n,function(a){s.loadPage(["app/behaviorObsCards/BehaviorObsCardCollection","app/behaviorObsCards/pages/BehaviorObsCardListPage",t],function(r,e){return new e({collection:new r(null,{rqlQuery:a.rql})})})}),e.map("/behaviorObsCards/:id",n,function(a){s.loadPage(["app/behaviorObsCards/BehaviorObsCard","app/behaviorObsCards/pages/BehaviorObsCardDetailsPage",t],function(r,e){return new e({model:new r({_id:a.params.id})})})}),e.map("/behaviorObsCards;add",n,function(e){s.loadPage(["app/behaviorObsCards/BehaviorObsCard","app/behaviorObsCards/pages/BehaviorObsCardAddFormPage",t],function(s,o){var t={observer:i.getInfo()};try{a.assign(t,JSON.parse(localStorage.getItem("BOC_LAST")))}catch(a){}finally{localStorage.removeItem("BOC_LAST")}return e.query.nearMiss?(t.nearMiss=+e.query.nearMiss,r.publish("router.navigate",{url:"/behaviorObsCards;add",trigger:!1,replace:!0})):e.query.suggestion&&(t.suggestion=+e.query.suggestion,r.publish("router.navigate",{url:"/behaviorObsCards;add",trigger:!1,replace:!0})),new o({model:new s(t)})})}),e.map("/behaviorObsCards/:id;edit",n,function(e){s.loadPage(["app/behaviorObsCards/BehaviorObsCard","app/behaviorObsCards/pages/BehaviorObsCardEditFormPage",t],function(s,i){var o=new s({_id:e.params.id}),t={};try{a.assign(t,JSON.parse(localStorage.getItem("BOC_LAST")))}catch(a){}finally{localStorage.removeItem("BOC_LAST")}e.query.nearMiss?(t.nearMiss=+e.query.nearMiss,r.publish("router.navigate",{url:"/behaviorObsCards/"+e.params.id+";edit",trigger:!1,replace:!0})):e.query.suggestion&&(t.suggestion=+e.query.suggestion,r.publish("router.navigate",{url:"/behaviorObsCards/"+e.params.id+";edit",trigger:!1,replace:!0}));var n=new i({model:o});return t._id===e.params.id&&n.listenToOnce(o,"sync",function(){a.assign(o.attributes,t)}),n})}),e.map("/behaviorObsCards/:id;delete",n,a.partial(o,"app/behaviorObsCards/BehaviorObsCard",a,a,{baseBreadcrumb:!0}))});