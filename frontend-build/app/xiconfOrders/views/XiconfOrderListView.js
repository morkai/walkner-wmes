// Part of <http://miracle.systems/p/walkner-wmes> licensed under <CC BY-NC-SA 4.0>

define(["underscore","app/i18n","app/time","app/user","app/core/views/ListView"],function(e,t,i,a,n){"use strict";return n.extend({className:"is-colored is-clickable",remoteTopics:{"xiconf.orders.**":"refreshCollection"},columns:[{id:"orderNo",className:"is-min"},{id:"nc12",className:"is-min"},{id:"quantity",className:"is-min"},{id:"reqDate",className:"is-min"},{id:"startedAt",className:"is-min"},{id:"duration",className:"is-min"},"name"],serializeActions:function(){return null},serializeRows:function(){function e(e){return t?'<a href="#orders/'+e.id+'">'+e.id+"</a>":e.id}var t=a.isAllowedTo("ORDERS:VIEW");return this.collection.map(function(t){var a=t.get("quantityDone")||0,n=t.get("quantityTodo")||0,s=Date.parse(t.get("startedAt"))||0,r=Date.parse(t.get("finishedAt"))||Date.now(),o=s?(r-s)/1e3:null;return{_id:t.id,className:"xiconfOrders-list-item "+t.getStatusClassName(),orderNo:e(t),nc12:t.get("nc12")[0],name:t.get("name"),quantity:a.toLocaleString()+"/"+n.toLocaleString(),reqDate:i.format(t.get("reqDate"),"YYYY-MM-DD"),startedAt:s?i.format(s,"YYYY-MM-DD HH:mm:ss"):null,duration:null!==o?i.toString(o):null}})}})});