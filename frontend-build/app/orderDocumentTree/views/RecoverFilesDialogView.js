// Part of <http://miracle.systems/p/walkner-wmes> licensed under <CC BY-NC-SA 4.0>

define(["underscore","jquery","app/i18n","app/time","app/viewport","app/core/View","app/orderDocumentTree/templates/recoverFilesDialog"],function(e,i,r,t,n,o,s){"use strict";return o.extend({template:s,events:{submit:function(){var e=this.$id("submit").prop("disabled",!0),i=e.find(".fa-spinner").removeClass("hidden"),t=this.model.tree.recoverFiles(this.model.files,"1"===this.$('input[name="remove"]:checked').val());return t.fail(function(){n.msg.show({type:"error",time:3e3,text:r("orderDocumentTree","recoverFiles:msg:failure")})}),t.done(function(){n.msg.show({type:"success",time:2e3,text:r("orderDocumentTree","recoverFiles:msg:success")})}),t.done(n.closeDialog),t.always(function(){i.addClass("hidden"),e.prop("disabled",!1)}),!1},'change input[name="remove"]':function(e){this.$id("submit").removeClass("btn-primary btn-danger").addClass("1"===e.currentTarget.value?"btn-danger":"btn-primary")}},serialize:function(){var i=this.model.tree;return{idPrefix:this.idPrefix,showRemoveOption:e.any(this.model.files,function(r){return e.every(r.get("oldFolders"),function(e){return!i.folders.get(e)})})}},onDialogShown:function(e){this.closeDialog=e.closeDialog.bind(e)},closeDialog:function(){}})});