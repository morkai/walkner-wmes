// Part of <http://miracle.systems/p/walkner-wmes> licensed under <CC BY-NC-SA 4.0>

define(["underscore","jquery","app/i18n","app/time","app/viewport","app/core/View","app/orderDocumentTree/templates/unlinkFilesDialog"],function(e,i,n,t,s,o,r){"use strict";return o.extend({template:r,events:{submit:function(){var e=this.$id("submit").prop("disabled",!0),i=e.find(".fa-spinner").removeClass("hidden"),t=this.model.tree.unlinkFiles(this.model.files,this.model.folder,"1"===this.$('input[name="remove"]:checked').val());return t.fail(function(){s.msg.show({type:"error",time:3e3,text:n("orderDocumentTree","unlinkFiles:msg:failure")})}),t.done(function(){s.msg.show({type:"success",time:2e3,text:n("orderDocumentTree","unlinkFiles:msg:success")})}),t.done(s.closeDialog),t.always(function(){i.addClass("hidden"),e.prop("disabled",!1)}),!1},'change input[name="remove"]':function(e){this.$id("submit").removeClass("btn-primary btn-danger").addClass("1"===e.currentTarget.value?"btn-danger":"btn-primary")}},serialize:function(){return{idPrefix:this.idPrefix,showRemoveOption:e.any(this.model.files,function(e){return 1===e.get("folders").length})}},onDialogShown:function(e){this.closeDialog=e.closeDialog.bind(e)},closeDialog:function(){}})});