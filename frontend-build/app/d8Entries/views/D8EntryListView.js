define(["underscore","app/i18n","app/core/views/ListView"],function(t,e,i){"use strict";function s(t,e,i,s){var a=t.observer;return a&&a.notify&&a.changes&&(a.changes[i||e.id]||a.changes[s])?{className:["is-changed"]}:{}}return i.extend({className:"d8Entries-list is-clickable",serializeColumns:function(){var e=t.partial(s,t,t,"strips");return[{id:"rid",className:"is-min is-number"},{id:"status",valueProperty:"statusText",className:"is-min",tdAttrs:s},{id:"entrySource",className:"is-min",tdAttrs:s},{id:"stripNos",className:"is-min",tdAttrs:e,label:this.t("PROPERTY:strips.no")},{id:"stripFamilies",className:"is-min",tdAttrs:e,label:this.t("PROPERTY:strips.family")},{id:"subject",tdAttrs:s},{id:"problemSource",tdAttrs:s},{id:"team",tdAttrs:t.partial(s,t,t,"owner","members")},{id:"crsRegisterDate",className:"is-min",tdAttrs:s,label:this.t("LIST:crsRegisterDate")},{id:"d5PlannedCloseDate",className:"is-min",tdAttrs:s,label:this.t("LIST:d5PlannedCloseDate")},{id:"d5CloseDate",className:"is-min",tdAttrs:s,label:this.t("LIST:d5CloseDate")},{id:"d8CloseDate",className:"is-min",tdAttrs:s,label:this.t("LIST:d8CloseDate")}]},serializeActions:function(){var t=this,e=t.collection;return function(s){var a=e.get(s._id),r=a.get("attachment"),n=[i.actions.viewDetails(a),{id:"download",icon:"download",label:t.t("LIST:ACTION:download"),href:r?"/d8/"+a.id+"/attachments/"+r._id+"?download=1":"/",disabled:!!r}];return a.canEdit()&&n.push(i.actions.edit(a)),a.canDelete()&&n.push(i.actions.delete(a)),n}},afterRender:function(){i.prototype.afterRender.call(this);var t=this;this.$el.popover({selector:".list-item > td",container:this.el,trigger:"hover",placement:"auto right",html:!0,content:function(){var e=t.collection.get(this.parentNode.dataset.id);return"team"===this.dataset.id?t.serializeTeamPopoverContent(e):"subject"===this.dataset.id?t.serializeSubjectPopoverContent(e):void 0}})},serializeTeamPopoverContent:function(t){var e=t.get("team");if(!(e.length<=1)){for(var i='<ul class="d8Entries-list-team">',s=0;s<e.length;++s)i+="<li>"+e[s].rendered;return i+="</ul>"}},serializeSubjectPopoverContent:function(e){var i=e.get("problemDescription");if(!t.isEmpty(i))return i}})});