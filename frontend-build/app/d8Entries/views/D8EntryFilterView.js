define(["underscore","app/time","app/core/views/FilterView","app/core/util/forms/dateTimeRange","app/users/util/setUpUserSelect2","app/d8Entries/dictionaries","app/d8Entries/templates/filter"],function(e,r,s,t,n,a,u){"use strict";return s.extend({template:u,events:e.assign({"click a[data-date-time-range]":t.handleRangeEvent,'change input[name="userType"]':"toggleUserSelect2","keyup select":function(e){if(27===e.keyCode)return e.target.selectedIndex=-1,!1},"dblclick select":function(e){e.target.selectedIndex=-1}},s.prototype.events),defaultFormData:function(){return{status:[].concat(a.statuses),area:null,entrySource:null,problemSource:null,userType:"others",user:null}},termToForm:{crsRegisterDate:t.rqlToForm,area:function(e,r,s){s[e]=r.args[1]},"owner.id":function(e,r,s){s.userType="owner",s.user=r.args[1]},"observers.user.id":function(e,r,s){"mine"===r.args[1]?(s.userType="mine",s.user=null):"unseen"===r.args[1]?(s.userType="unseen",s.user=null):(s.userType="others",s.user=r.args[1])},status:"area",entrySource:"area",problemSource:"area"},serialize:function(){return e.assign(s.prototype.serialize.call(this),{statuses:a.statuses,areas:a.areas.toJSON(),entrySources:a.entrySources.toJSON(),problemSources:a.problemSources.toJSON()})},serializeFormToQuery:function(e){var r=this.$('input[name="userType"]:checked').val(),s=this.$id("user").val();t.formToRql(this,e),"mine"===r||"unseen"===r?e.push({name:"eq",args:["observers.user.id",r]}):s&&e.push({name:"eq",args:["owner"===r?"owner.id":"observers.user.id",s]}),["entrySource","problemSource","area","status"].forEach(function(r){var s=this.$id(r).val();s&&e.push({name:"eq",args:[r,s]})},this)},afterRender:function(){s.prototype.afterRender.call(this),n(this.$id("user"),{view:this}),this.toggleUserSelect2()},toggleUserSelect2:function(){var e=this.$('input[name="userType"]:checked').val();this.$id("user").select2("enable","others"===e||"owner"===e)}})});