define(["underscore","jquery","app/i18n","app/time","app/core/View","app/mrpControllers/util/setUpMrpSelect2","app/wh/templates/planFilter","app/core/util/ExpandableSelect"],function(e,t,a,s,n,i,p){"use strict";return n.extend({template:p,events:{"input #-date":"changeFilter","change #-date":"changeFilter","change #-whStatuses":"changeFilter","change #-psStatuses":"changeFilter","change #-from":"changeFilter","change #-to":"changeFilter","click #-useDarkerTheme":function(){this.plan.displayOptions.toggleDarkerThemeUse()}},initialize:function(){var e=this.plan,t=e.displayOptions;this.listenTo(e,"change:loading",this.onLoadingChanged),this.listenTo(e,"change:_id",this.onDateChanged),this.listenTo(t,"change:minDate change:maxDate",this.onMinMaxDateChanged),this.listenTo(t,"change:useDarkerTheme",this.updateToggles)},destroy:function(){this.$(".is-expandable").expandableSelect("destroy")},getTemplateData:function(){var e=this.plan,t=e.displayOptions;return{date:e.id,minDate:t.get("minDate"),maxDate:t.get("maxDate"),whStatuses:t.get("whStatuses"),psStatuses:t.get("psStatuses"),from:t.get("from"),to:t.get("to"),useDarkerTheme:t.isDarkerThemeUsed()}},afterRender:function(){this.$(".is-expandable").expandableSelect()},updateToggles:function(){this.$id("useDarkerTheme").toggleClass("active",this.plan.displayOptions.isDarkerThemeUsed())},changeFilter:function(){var t=this,a=t.$id("whStatuses"),s=t.$id("psStatuses"),n=t.$id("date").val(),i={whStatuses:a.val(),psStatuses:s.val(),from:t.$id("from").val()||"06:00",to:t.$id("to").val()||"06:00"};i.whStatuses&&i.whStatuses.length!==a[0].options.length||(i.whStatuses=[]),i.psStatuses&&i.psStatuses.length!==s[0].options.length||(i.psStatuses=[]);var p={};["whStatuses","psStatuses","from","to"].forEach(function(a){e.isEqual(i[a],t.plan.displayOptions.get(a))||(p[a]=i[a])}),e.isEmpty(p)||t.plan.displayOptions.set(p),/^[0-9]{4}-[0-9]{2}-[0-9]{2}$/.test(n)&&n!==t.plan.id&&t.plan.set("_id",n)},onLoadingChanged:function(){var e=this,t=e.plan.get("loading");["date","whStatuses","psStatuses","from","to"].forEach(function(a){e.$id(a).prop("disabled",t)})},onDateChanged:function(){this.$id("date").val(this.plan.id)},onMinMaxDateChanged:function(){this.$id("date").prop("min",this.plan.displayOptions.get("minDate")).prop("max",this.plan.displayOptions.get("maxDate"))}})});