// Part of <https://miracle.systems/p/walkner-wmes> licensed under <CC BY-NC-SA 4.0>

define(["underscore","jquery","app/i18n","app/time","app/core/View","app/mrpControllers/util/setUpMrpSelect2","app/wh/templates/planFilter"],function(e,t,a,i,n,s,p){"use strict";return n.extend({template:p,events:{"input #-date":"changeFilter","change #-date":"changeFilter","click #-useDarkerTheme":function(){this.plan.displayOptions.toggleDarkerThemeUse()}},initialize:function(){var e=this.plan,t=e.displayOptions;this.listenTo(e,"change:loading",this.onLoadingChanged),this.listenTo(e,"change:_id",this.onDateChanged),this.listenTo(t,"change:minDate change:maxDate",this.onMinMaxDateChanged),this.listenTo(t,"change:useDarkerTheme",this.updateToggles)},getTemplateData:function(){var e=this.plan,t=e.displayOptions;return{date:e.id,minDate:t.get("minDate"),maxDate:t.get("maxDate"),useDarkerTheme:t.isDarkerThemeUsed()}},updateToggles:function(){this.$id("useDarkerTheme").toggleClass("active",this.plan.displayOptions.isDarkerThemeUsed())},changeFilter:function(){var e=this.$id("date").val();/^[0-9]{4}-[0-9]{2}-[0-9]{2}$/.test(e)&&e!==this.plan.id&&this.plan.set("_id",e)},onLoadingChanged:function(){var e=this.plan.get("loading");this.$id("date").prop("disabled",e)},onDateChanged:function(){this.$id("date").val(this.plan.id)},onMinMaxDateChanged:function(){this.$id("date").prop("min",this.plan.displayOptions.get("minDate")).prop("max",this.plan.displayOptions.get("maxDate"))}})});