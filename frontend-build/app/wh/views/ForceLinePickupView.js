define(["underscore","app/core/View","app/core/util/formatResultWithDescription","app/data/orgUnits","app/wh/templates/pickup/forceLine"],function(e,t,i,r,n){"use strict";return t.extend({template:n,nlsDomain:"wh",events:{submit:function(){return this.trigger("picked",{forceLine:this.$id("forceLine").val(),redirLine:this.$id("redirLine").val(),forceDelivery:this.$id("forceDelivery").prop("checked"),card:this.$id("card").val().trim()}),!1}},getTemplateData:function(){return{card:this.model.personnelId}},afterRender:function(){this.$id("forceLine").select2({width:"100%",data:this.model.whLines.map(function(e){var t=r.getByTypeAndId("prodLine",e.id);return{id:e.id,text:e.id,description:t?t.get("description"):""}}).sort(function(e,t){return e.text.localeCompare(t.text,void 0,{numeric:!0,ignorePunctuation:!0})}),formatResult:i.bind(null,"text","description")}),this.$id("redirLine").select2({width:"100%",allowClear:!0,data:r.getActiveByType("prodLine").filter(function(e){var t=r.getSubdivisionFor(e);return!!t&&"assembly"===t.get("type")}).map(function(e){return{id:e.id,text:e.id,description:e.get("description")}}).sort(function(e,t){return e.text.localeCompare(t.text,void 0,{numeric:!0,ignorePunctuation:!0})}),formatResult:i.bind(null,"text","description")})},getCard:function(){return this.$id("card").val().trim()},setCard:function(e){this.getCard()===e?this.$id("submit").click():this.$id("card").val(e)}})});