define(["app/time","app/user","app/core/Model","app/core/templates/userInfo","app/wmes-osh-common/dictionaries"],function(e,r,t,a,o){"use strict";return t.extend({urlRoot:"/osh/rewards",clientUrlRoot:"#osh/rewards",topicPrefix:"osh.rewards",privilegePrefix:"OSH:REWARDS",nlsDomain:"wmes-osh-rewards",labelAttribute:"rid",serialize:function(){const r=this.toJSON();if(r.paid&&(r.className="success"),"observation"===r.type){const t=r.rid.match(/^O-([0-9]{4})-M000([0-9]{2})$/),a=e.utc.getMoment(`${t[1]}-${t[2]}-01`,"YYYY-MM-DD"),o="#osh/observations?exclude(changes)&sort(-date)&limit(-1337)"+`&date=ge=${a.valueOf()}`+`&date=lt=${a.add(1,"months").valueOf()}`+`&creator.id=${r.creator.id}`;r.rid=`<a href="${o}">${r.rid}</a>`}else"kaizen"===r.type&&(r.rid=`<a href="#osh/kaizens/${r.rid}">${r.rid}</a>`);return r.recipient=a(r.recipient,{noIp:!0}),r.creator=a(r.creator),r.payer=a(r.payer),r.createdAt=e.format(r.createdAt,"L LT"),r.paidAt=r.paidAt?e.format(r.paidAt,"L LT"):"",r.amount=o.currencyFormatter.format(r.amount),r}},{can:{viewAll:function(){return r.isAllowedTo("OSH:REWARDS:VIEW")||o.isCoordinator()}}})});