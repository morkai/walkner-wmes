define(["underscore","../i18n","../time","../user","../core/Model","./dictionaries"],function(t,e,i,r,s,n){"use strict";return s.extend({urlRoot:"/toolcal/tools",clientUrlRoot:"#toolcal/tools",topicPrefix:"toolcal.tools",privilegePrefix:"TOOLCAL",nlsDomain:"wmes-toolcal-tools",labelAttribute:"rid",defaults:function(){return{status:"in-use",interval:3,intervalUnit:"month"}},serialize:function(){var t=this.toJSON();return t.type=n.types.getLabel(t.type)||"-",t.status=e(this.nlsDomain,"status:"+t.status),t.users=t.users.map(function(t){return t.label}),t.lastDate=i.format(t.lastDate,"L"),t.nextDate=i.format(t.nextDate,"L"),t},isOwner:function(){return t.some(this.attributes.users,function(t){return t.id===r.data._id})},canEdit:function(){return!!r.isAllowedTo(this.privilegePrefix+":MANAGE")||"retired"!==this.get("status")&&this.isOwner()},canDelete:function(){return r.isAllowedTo(this.privilegePrefix+":MANAGE")}})});