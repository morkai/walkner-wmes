define(["app/i18n","app/user","app/core/util/bindLoadingMessage","app/core/util/pageActions","app/core/View","../FteLeaderEntryCollection","../FteWhEntry","../views/FteLeaderEntryListView","../views/FteEntryFilterView","app/core/templates/listPage"],function(e,t,i,n,l,o,r,s,c,a){"use strict";return l.extend({template:a,layoutName:"page",pageId:"fteLeaderEntryList",breadcrumbs:function(){return[e.bound("fte","BREADCRUMB:"+this.collection.TYPE+":browse")]},actions:function(i){var l=this;return[{label:e.bound("fte","PAGE_ACTION:add"),href:l.collection.genClientUrl("add"),icon:"plus",privileges:function(){return t.isAllowedTo(l.collection.getPrivilegePrefix()+":MANAGE","PROD_DATA:MANAGE")}},n.export({layout:i,page:l,collection:l.collection,maxCount:5840}),{label:e.bound("fte","PAGE_ACTION:settings"),icon:"cogs",privileges:"PROD_DATA:MANAGE",href:"#fte;settings?tab=structure"}]},initialize:function(){this.defineModels(),this.defineViews(),this.setView(".filter-container",this.filterView),this.setView(".list-container",this.listView)},defineModels:function(){this.collection=i(this.collection,this)},defineViews:function(){var e=this;e.filterView=new c({model:{rqlQuery:e.collection.rqlQuery},divisionFilter:function(t){return!!t&&("wh"===e.collection.TYPE?t.id===r.WH_DIVISION:"prod"!==t.get("type")&&t.id!==r.WH_DIVISION)}}),e.listView=new s({collection:e.collection}),e.listenTo(e.filterView,"filterChanged",this.refreshList)},load:function(e){return e(this.collection.fetch({reset:!0}))},refreshList:function(e){this.collection.rqlQuery=e,this.listView.refreshCollectionNow(),this.broker.publish("router.navigate",{url:this.collection.genClientUrl()+"?"+e,trigger:!1,replace:!0})}})});