define(["moment","../data/subdivisions","../data/views/renderOrgUnitPath","../core/Model"],function(t,e,i,n){return n.extend({urlRoot:"/fte/leader",clientUrlRoot:"#fte/leader",topicPrefix:"fte.leader",privilegePrefix:"FTE:LEADER",nlsDomain:"fte",defaults:{subdivision:null,date:null,shift:null,fteDiv:null,tasks:null,locked:!1,createdAt:null,creatorId:null,creatorLabel:null,updatedAt:null,updaterId:null,updaterLabel:null},serializeWithTotals:function(){var n=this.serializeCompanies(),a=e.get(this.get("subdivision"));return{subdivision:a?i(a,!1,!1):"?",date:t(this.get("date")).format("LL"),shift:this.get("shift"),total:n.reduce(function(t,e){return t+e.total},0),companies:n,divisions:this.get("fteDiv")||[],tasks:this.serializeTasks(),locked:!!this.get("locked")}},serializeCompanies:function(){var t=this.get("tasks");return t.length?t[0].companies.map(function(e,i){return e.total=t.reduce(function(t,e){return Array.isArray(e.companies[i].count)?e.companies[i].count.forEach(function(e){t+=e.value}):t+=e.companies[i].count,t},0),e}):[]},serializeTasks:function(){return this.get("tasks").map(function(t){return t.total=t.companies.reduce(function(t,e){return Array.isArray(e.count)?e.count.forEach(function(e){t+=e.value}):t+=e.count,t},0),t})}})});