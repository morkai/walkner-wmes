// Part of <https://miracle.systems/p/walkner-wmes> licensed under <CC BY-NC-SA 4.0>

define(["app/user","app/data/prodLines","app/core/views/FilterView","app/core/util/fixTimeRange","app/prodLogEntries/templates/filter"],function(e,t,r,i,a){"use strict";return r.extend({template:a,defaultFormData:{createdAt:"",prodLine:null,type:null},termToForm:{createdAt:function(e,t,r){i.toFormData(r,t,"date+time")},prodLine:function(e,t,r){r[e]=t.args[1]},type:"prodLine"},afterRender:function(){r.prototype.afterRender.call(this),this.$id("prodLine").select2({width:"275px",allowClear:!0,data:this.getApplicableProdLines()}),this.$id("type").select2({width:"275px",allowClear:!0})},getApplicableProdLines:function(){return t.getForCurrentUser().map(function(e){return{id:e.id,text:e.getLabel()}})},serializeFormToQuery:function(e){var t=i.fromView(this,{defaultTime:"06:00"}),r=this.$id("prodLine").val(),a=this.$id("type").val();r&&r.length&&e.push({name:"eq",args:["prodLine",r]}),a&&a.length&&e.push({name:"eq",args:["type",a]}),t.from&&e.push({name:"ge",args:["createdAt",t.from]}),t.to&&e.push({name:"le",args:["createdAt",t.to]})}})});