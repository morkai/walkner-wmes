// Part of <https://miracle.systems/p/walkner-wmes> licensed under <CC BY-NC-SA 4.0>

define(["underscore","app/data/orgUnits","app/core/util/idAndLabel","app/core/views/FormView","app/kanbanContainers/templates/form"],function(t,i,e,a,n){"use strict";return a.extend({template:n,events:t.assign({"input #-_id":"validateId"},a.prototype.events),initialize:function(){a.prototype.initialize.apply(this,arguments),this.validateId=t.debounce(this.validateId.bind(this),500)},afterRender:function(){a.prototype.afterRender.apply(this,arguments),this.options.editMode?(this.$id("_id").prop("readonly",!0),this.$id("name").focus()):this.$id("_id").focus()},validateId:function(){var t=this,i=t.$id("_id"),e=t.ajax({method:"HEAD",url:"/kanban/containers/"+i.val()});e.fail(function(){i[0].setCustomValidity("")}),e.done(function(){i[0].setCustomValidity(200===e.status?t.t("FORM:ERROR:alreadyExists"):"")})}})});