// Copyright (c) 2014, ≈Åukasz Walukiewicz <lukasz@walukiewicz.eu>. Some Rights Reserved.
// Licensed under CC BY-NC-SA 4.0 <http://creativecommons.org/licenses/by-nc-sa/4.0/>.
// Part of the walkner-wmes project <http://lukasz.walukiewicz.eu/p/walkner-wmes>

define(["../router","../viewport","../user","../core/util/showDeleteFormPage","./User","i18n!app/nls/users"],function(e,a,r,s,i){"use strict";var n=r.auth("USERS:VIEW"),o=r.auth("USERS:MANAGE");e.map("/users",n,function(e){a.loadPage(["app/users/pages/UserListPage"],function(a){return new a({rql:e.rql})})}),e.map("/users/:id",function(e,a,s){e.params.id===r.data._id?s():n(e,a,s)},function(e){a.loadPage(["app/core/pages/DetailsPage","app/users/views/UserDetailsView"],function(a,r){return new a({DetailsView:r,model:new i({_id:e.params.id})})})}),e.map("/users;add",o,function(){a.loadPage(["app/core/pages/AddFormPage","app/users/views/UserFormView"],function(e,a){return new e({FormView:a,model:new i})})}),e.map("/users/:id;edit",o,function(e){a.loadPage(["app/core/pages/EditFormPage","app/users/views/UserFormView"],function(a,r){return new a({FormView:r,model:new i({_id:e.params.id})})})}),e.map("/users/:id;delete",o,s.bind(null,i))});