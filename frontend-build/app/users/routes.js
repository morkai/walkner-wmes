// Copyright (c) 2014, ≈Åukasz Walukiewicz <lukasz@walukiewicz.eu>. Some Rights Reserved.
// Licensed under CC BY-NC-SA 4.0 <http://creativecommons.org/licenses/by-nc-sa/4.0/>.
// Part of the walkner-wmes project <http://lukasz.walukiewicz.eu/p/walkner-wmes>

define(["../i18n","../router","../viewport","../user","../core/View","../core/util/showDeleteFormPage","../core/views/LogInFormView","./User","i18n!app/nls/users"],function(e,r,a,s,i,n,o,u){"use strict";var p=s.auth("USERS:VIEW"),t=s.auth("USERS:MANAGE");r.map("/login",function(){a.showPage(new i({pageId:"logInForm",layoutName:"page",view:new o,breadcrumbs:[e.bound("users","breadcrumbs:logIn")]}))}),r.map("/users",p,function(e){a.loadPage(["app/users/pages/UserListPage"],function(r){return new r({rql:e.rql})})}),r.map("/users/:id",function(e,r,a){e.params.id===s.data._id?a():p(e,r,a)},function(e){a.loadPage(["app/core/pages/DetailsPage","app/users/views/UserDetailsView"],function(r,a){return new r({DetailsView:a,model:new u({_id:e.params.id})})})}),r.map("/users;add",t,function(){a.loadPage(["app/core/pages/AddFormPage","app/users/views/UserFormView"],function(e,r){return new e({FormView:r,model:new u})})}),r.map("/users/:id;edit",t,function(e){a.loadPage(["app/core/pages/EditFormPage","app/users/views/UserFormView"],function(r,a){return new r({FormView:a,model:new u({_id:e.params.id})})})}),r.map("/users/:id;delete",t,n.bind(null,u))});