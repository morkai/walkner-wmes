// Copyright (c) 2014, ≈Åukasz Walukiewicz <lukasz@walukiewicz.eu>. Some Rights Reserved.
// Licensed under CC BY-NC-SA 4.0 <http://creativecommons.org/licenses/by-nc-sa/4.0/>.
// Part of the walkner-wmes project <http://lukasz.walukiewicz.eu/p/walkner-wmes>

define(["../i18n","../router","../viewport","../user","../core/View","../core/util/showDeleteFormPage","../core/views/LogInFormView","./User","i18n!app/nls/users"],function(e,a,r,n,s,i,o,u){"use strict";var d=n.auth("USERS:VIEW"),t=n.auth("USERS:MANAGE");a.map("/login",function(){r.showPage(new s({pageId:"logInForm",layoutName:"page",view:new o,breadcrumbs:[e.bound("users","breadcrumbs:logIn")]}))}),a.map("/users",d,function(e){r.loadPage(["app/users/pages/UserListPage"],function(a){return new a({rql:e.rql})})}),a.map("/users/:id",function(e,a,r){e.params.id===n.data._id?r():d(e,a,r)},function(e){r.loadPage(["app/users/pages/UserDetailsPage"],function(a){return new a({model:new u({_id:e.params.id})})})}),a.map("/users;add",t,function(){r.loadPage(["app/core/pages/AddFormPage","app/users/views/UserFormView"],function(e,a){return new e({FormView:a,model:new u})})}),a.map("/users/:id;edit",function(e,a,r){e.params.id===n.data._id?r():t(e,a,r)},function(e){r.loadPage(["app/users/pages/UserEditFormPage"],function(a){return new a({model:new u({_id:e.params.id})})})}),a.map("/users/:id;delete",t,i.bind(null,u))});