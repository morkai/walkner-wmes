define(["../i18n","../broker","../router","../viewport","../user","../core/View","../core/util/showDeleteFormPage","./User","./UserCollection","./pages/LogInFormPage","./util/userInfoPopover","i18n!app/nls/users"],function(e,n,a,r,u,i,s,t,o,p){"use strict";var d=u.auth("USERS:VIEW"),l=u.auth("USERS:MANAGE");a.map("/login",function(e){n.publish("router.navigate",{url:"/",replace:!0,trigger:!1}),r.showPage(new p({model:{unknown:e.query.unknown}}))}),a.map("/users;settings",u.auth("USERS:MANAGE"),function(e){r.loadPage(["app/users/pages/SettingsPage"],function(n){return new n({initialTab:e.query.tab})})}),a.map("/users",d,function(e){r.loadPage(["app/users/pages/ListPage"],function(n){return new n({collection:new o(null,{rqlQuery:e.rql})})})}),a.map("/users/:id",function(e,n,a){e.params.id===u.data._id?a():d(e,n,a)},function(e){r.loadPage(["app/users/pages/DetailsPage"],function(n){return new n({model:new t({_id:e.params.id})})})}),a.map("/account",function(){r.loadPage(["app/users/pages/DetailsPage"],function(e){return new e({model:new t({_id:u.data._id})})})}),a.map("/users;add",l,function(){r.loadPage(["app/users/pages/AddFormPage"],function(e){return new e({model:new t})})}),a.map("/users/:id;edit",function(e,n,a){e.params.id===u.data._id?a():l(e,n,a)},function(e){r.loadPage(["app/users/pages/EditFormPage"],function(n){return new n({model:new t({_id:e.params.id})})})}),a.map("/users/:id;delete",l,s.bind(null,t))});