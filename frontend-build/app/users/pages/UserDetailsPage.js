define(["app/user","app/viewport","app/core/util/pageActions","app/core/pages/DetailsPage","app/core/views/DialogView","app/data/loadedModules","../views/UserDetailsView","app/users/templates/anonymizeDialog"],function(e,i,t,n,o,a,s,l){"use strict";return n.extend({DetailsView:s,breadcrumbs:function(){return e.isAllowedTo("USERS:VIEW")?n.prototype.breadcrumbs.call(this):[this.t("BREADCRUMB:myAccount")]},actions:function(){var i=this.model,n=[];return e.isAllowedTo("USERS:MANAGE")?(n.push(t.edit(i,!1),t.delete(i,!1)),e.isAllowedTo("SUPER")&&n.push({label:this.t("PAGE_ACTION:anonymize"),icon:"user-secret",callback:this.handleAnonymizeAction.bind(this)})):e.data._id===i.id&&n.push({label:this.t("PAGE_ACTION:editAccount"),icon:"edit",href:i.genClientUrl("edit")}),n},initialize:function(){n.prototype.initialize.apply(this,arguments),a.isLoaded("wmes-osh")&&require("app/wmes-osh-common/dictionaries").bind(this)},handleAnonymizeAction:function(){var e=this,t=new o({template:l,model:{nlsDomain:e.model.getNlsDomain()}});e.listenToOnce(t,"answered",function(t){"yes"===t&&(e.ajax({method:"POST",url:"/users/"+e.model.id+"/anonymize"}),i.msg.show({type:"warning",time:3e3,text:e.t("anonymize:started")}))}),i.showDialog(t,e.t("anonymize:title"))}})});