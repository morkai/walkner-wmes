define(["underscore","app/user","app/data/loadedModules","app/data/prodFunctions","app/data/companies","app/data/privileges","app/core/util/idAndLabel","app/core/views/FilterView","app/users/util/setUpUserSelect2","app/users/templates/filter"],function(e,a,i,r,t,n,p,s,o,l){"use strict";return s.extend({template:l,termToForm:{personnelId:function(e,a,i){i[e]=this.unescapeRegExp(a.args[1])},prodFunction:function(e,a,i){i[e]=a.args[1]},company:"prodFunction",login:"personnelId",searchName:"personnelId"},getTemplateData:function(){return{prodFunctions:i.isLoaded("prodFunctions")?r.map(p):[],companies:i.isLoaded("companies")?t.map(p):[],privileges:a.isAllowedTo("USERS:MANAGE")?n:[]}},afterRender:function(){s.prototype.afterRender.apply(this,arguments),this.$id("company").select2({width:"150px",allowClear:!0}),this.$id("prodFunction").select2({width:"250px",allowClear:!0}),this.$id("privileges").select2({width:"250px",allowClear:!0})},serializeFormToQuery:function(e){var a=o.transliterate(this.$id("searchName").val());a.length&&e.push({name:"regex",args:["searchName","^"+a]}),this.serializeRegexTerm(e,"personnelId",null,void 0,!1,!0),this.serializeRegexTerm(e,"login",null,null,!0,!0),["company","prodFunction","privileges"].forEach(a=>{var i=this.$id(a).val()||"";i.length&&e.push({name:"eq",args:[a,i]})})}})});