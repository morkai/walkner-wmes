define(["require","underscore","app/user","app/data/loadedModules","app/data/prodFunctions","app/data/companies","app/data/privileges","app/core/util/idAndLabel","app/core/views/FilterView","app/users/util/setUpUserSelect2","app/users/templates/filter"],function(e,i,t,a,r,s,n,o,p,l,d){"use strict";return p.extend({template:d,termToForm:{personnelId:function(e,i,t){t[e]=this.unescapeRegExp(i.args[1]).replace(/^\^/,"")},prodFunction:function(e,i,t){t[e]=i.args[1]},company:"prodFunction",login:"personnelId",searchName:"personnelId"},initialize:function(){if(p.prototype.initialize.apply(this,arguments),a.isLoaded("wmes-osh")){const i=e("app/wmes-osh-common/views/OrgUnitPickerFilterView");this.setView("#-orgUnit",new i({filterView:this,emptyLabel:this.t("PROPERTY:orgUnit"),orgUnitTerms:{oshDivision:"division",oshWorkplace:"workplace",oshDepartment:"department"},orgUnitTypes:["division","workplace","department"]}))}},getTemplateData:function(){return{prodFunctions:a.isLoaded("prodFunctions")?r.map(o):[],companies:a.isLoaded("companies")?s.map(o):[],privileges:t.isAllowedTo("USERS:MANAGE")?n:[],orgUnit:a.isLoaded("wmes-osh")}},afterRender:function(){p.prototype.afterRender.apply(this,arguments),this.$id("company").select2({width:"150px",allowClear:!0}),this.$id("prodFunction").select2({width:"250px",allowClear:!0}),this.$id("privileges").select2({width:"250px",allowClear:!0})},serializeFormToQuery:function(e){var i=l.transliterate(this.$id("searchName").val());i.length&&e.push({name:"regex",args:["searchName","^"+i]}),this.serializeRegexTerm(e,"personnelId",null,void 0,!1,!0),this.serializeRegexTerm(e,"login",null,null,!0,!0),["company","prodFunction","privileges"].forEach(i=>{var t=this.$id(i).val()||"";t.length&&e.push({name:"eq",args:[i,t]})})}})});