// Part of <http://miracle.systems/p/walkner-wmes> licensed under <CC BY-NC-SA 4.0>

define(["../core/Collection","./VisNodePosition"],function(t,e){"use strict";return t.extend({model:e,subscribe:function(t){t.subscribe("vis.nodePositions.updated",this.onUpdated.bind(this))},getPosition:function(t){var e=this.get(t);return e?{fixed:!0,x:e.get("x"),y:e.get("y")}:{fixed:!1,x:0,y:0}},update:function(t,i,n){var s=this,d=s.get(t)||new e({_id:t,x:null,y:null});if(d.same(i,n))return null;s.add(d);var o=d.attributes,u=d.save({x:i,y:n});return u.fail(function(){d.set(o)}),u},onUpdated:function(t){this.add(t,{merge:!0})}})});