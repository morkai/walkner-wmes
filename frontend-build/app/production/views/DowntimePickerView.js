define(["underscore","jquery","app/i18n","app/viewport","app/data/aors","app/data/downtimeReasons","app/core/View","app/production/templates/downtimePicker"],function(e,t,n,r,i,o,a,s){return a.extend({template:s,events:{"keypress .select2-container":function(e){13===e.which&&(e.preventDefault(),this.$el.submit())},"keypress textarea":function(e){13===e.which&&""===e.target.value.trim()&&(e.preventDefault(),this.$el.submit())},submit:function(e){e.preventDefault(),this.handlePick()}},initialize:function(){this.idPrefix=e.uniqueId("downtimePicker")},serialize:function(){return{idPrefix:this.idPrefix}},afterRender:function(){this.setUpReasonSelect2(),this.setUpAorSelect2(),this.$id("reason").select2("focus")},onDialogShown:function(){this.$id("reason").select2("focus")},setUpReasonSelect2:function(){var e=this,t=this.$id("reason");t.select2({dropdownCssClass:"production-dropdown",openOnEnter:null,data:o.map(function(e){return{id:e.id,text:e.id+" - "+e.get("label")}}).sort(function(e,t){return e.id.localeCompare(t.id)})}),t.on("change",function(){t.select2("val")&&e.$id("aor").select2("focus")})},setUpAorSelect2:function(){var e=this,t=this.$id("aor");t.select2({dropdownCssClass:"production-dropdown",openOnEnter:null,data:i.map(function(e){return{id:e.id,text:e.get("name")}})}),t.on("change",function(){t.select2("val")&&e.$id("reasonComment").select()})},handlePick:function(){var e=this.$id("reason").select2("val"),t=this.$id("aor").select2("val"),i=this.$id("reasonComment").val();return e?t?(this.trigger("downtimePicked",{reason:e,reasonComment:i,aor:t}),void 0):(this.$id("aor").select2("focus"),r.msg.show({type:"error",time:2e3,text:n("production","downtimePicker:msg:emptyAor")})):(this.$id("reason").select2("focus"),r.msg.show({type:"error",time:2e3,text:n("production","downtimePicker:msg:emptyReason")}))}})});