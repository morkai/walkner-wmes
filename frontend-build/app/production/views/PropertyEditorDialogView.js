define(["jquery","app/i18n","app/core/View","app/production/templates/propertyEditorDialog"],function(t,i,e,n){"use strict";return e.extend({template:n,dialogClassName:"production-modal",events:{"focus #-value":function(t){this.options.vkb&&this.options.vkb.show(t.target,this.onVkbValueChange)},"input #-value":"checkMinMaxValidity","blur #-value":"checkMinMaxValidity",submit:function(t){t.preventDefault();var i=this.parseInt("value");i!==this.options.getValue()&&this.options.setValue(i),this.closeDialog()}},initialize:function(){this.onVkbValueChange=this.onVkbValueChange.bind(this)},destroy:function(){this.options.vkb&&this.options.vkb.hide()},getTemplateData:function(){return{property:this.options.property,value:this.options.value,min:this.options.min||0,max:this.options.max}},onDialogShown:function(t){this.closeDialog=t.closeDialog.bind(t),this.$id("value").select()},closeDialog:function(){},parseInt:function(t){var i=parseInt(this.$id(t).val(),10);return isNaN(i)||i<0?0:i},onVkbValueChange:function(t){this.checkMinMaxValidity({target:t})},checkMinMaxValidity:function(t){var e=t.target,n=parseInt(e.getAttribute("max"),10);if(!isNaN(n)){var a=parseInt(e.getAttribute("min"),10)||0,o=parseInt(e.value,10)||0,s="";o<a?s=i("production","error:min",{min:a}):o>n&&(s=i("production","error:max",{max:n})),e.setCustomValidity(s)}}})});