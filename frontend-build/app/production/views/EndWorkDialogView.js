define(["underscore","app/i18n","app/core/View","app/production/templates/endWorkDialog"],function(e,t,i,n){return i.extend({template:n,dialogClassName:"production-modal",events:{submit:function(e){e.preventDefault();var t=this.$(".btn-warning")[0];if(!t.disabled){t.disabled=!0;var i=this.parseInt("quantitiesDone"),n=this.parseInt("quantityDone"),o=this.parseInt("workerCount");this.model.changeCurrentQuantitiesDone(i),n!==this.model.prodShiftOrder.get("quantityDone")&&this.model.changeQuantityDone(n),o!==this.model.prodShiftOrder.get("workerCount")&&this.model.changeWorkerCount(o),this.model.endWork(),this.closeDialog()}}},initialize:function(){this.idPrefix=e.uniqueId("endWorkDialog")},serialize:function(){return{idPrefix:this.idPrefix,downtime:this.model.isDowntime(),hourRange:this.model.getCurrentQuantityDoneHourRange(),quantitiesDone:this.model.getQuantityDoneInCurrentHour(),quantityDone:this.model.prodShiftOrder.get("quantityDone")||0,workerCount:this.model.prodShiftOrder.getWorkerCountForEdit(),maxQuantitiesDone:this.model.getMaxQuantitiesDone(),maxQuantityDone:this.model.prodShiftOrder.getMaxQuantityDone(),maxWorkerCount:this.model.prodShiftOrder.getMaxWorkerCount()}},onDialogShown:function(e){this.closeDialog=e.closeDialog.bind(e)},closeDialog:function(){},parseInt:function(e){var t=parseInt(this.$id(e).val(),10);return isNaN(t)||0>t?0:t}})});