// Copyright (c) 2014, ≈Åukasz Walukiewicz <lukasz@walukiewicz.eu>. Some Rights Reserved.
// Licensed under CC BY-NC-SA 4.0 <http://creativecommons.org/licenses/by-nc-sa/4.0/>.
// Part of the walkner-wmes project <http://lukasz.walukiewicz.eu/p/walkner-wmes>

define(["app/i18n","app/user","app/viewport","app/core/View","app/production/templates/controls","./UnlockDialogView","./LockDialogView"],function(o,n,t,c,s,e,i){var l={"socket.connected":"#5BB75B","socket.disconnected":"#DA4F49","socket.connectFailed":"#DA4F49","socket.connecting":"#F0AD4E"};return c.extend({template:s,localTopics:{"socket.*":function(o,n){var t=l[n];t&&this.$syncControl.css("color",t)},"production.syncing":function(){this.$syncControl.addClass("fa-spin")},"production.synced":function(){this.$syncControl.removeClass("fa-spin")}},events:{"click a.production-controls-lock":"lock","click a.production-controls-unlock":"unlock","mouseover a.production-controls-lock":function(o){this.$(o.target).removeClass("fa-unlock").addClass("fa-lock")},"mouseout a.production-controls-lock":function(o){this.$(o.target).removeClass("fa-lock").addClass("fa-unlock")},"mouseover a.production-controls-unlock":function(o){this.$(o.target).removeClass("fa-lock").addClass("fa-unlock")},"mouseout a.production-controls-unlock":function(o){this.$(o.target).removeClass("fa-unlock").addClass("fa-lock")}},afterRender:function(){this.$syncControl=this.$(".production-controls-sync"),this.$syncControl.css("color",l[this.socket.isConnected()?"socket.connected":"socket.disconnected"])},unlock:function(){return this.socket.isConnected()?void(this.model.isLocked()&&t.showDialog(new e({model:this.model}),o("production","unlockDialog:title:unlock"))):t.msg.show({type:"warning",time:2e3,text:o("production","controls:msg:sync:noConnection")})},lock:function(){return this.socket.isConnected()?void(this.model.isLocked()||t.showDialog(new i({model:this.model}),o("production","unlockDialog:title:lock"))):t.msg.show({type:"warning",time:2e3,text:o("production","controls:msg:sync:noConnection")})}})});