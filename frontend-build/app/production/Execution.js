define(["underscore","app/core/Model"],function(e,t){"use strict";return t.extend({nlsDomain:"production",initialize:function(e,t){this.prodLineId=t.prodLineId},url:function(){return"/production/planExecution/"+this.prodLineId+"?queue=0"},parse:function(e){return e.execution},startDowntime:function(e){var t=this.get("doneDowntimes")||[],i=this.serializeDowntime(e),n=t.concat(i);this.set("doneDowntimes",n)},updateDowntime:function(t){var i=this.get("doneDowntimes")||[],n=i[i.length-1];n&&(e.assign(n,this.serializeDowntime(t)),this.trigger("change:lastDowntime",n))},startOrder:function(e){var t=this.get("doneOrders")||[],i=this.serializeOrder(e),n=t.concat(i);this.set("doneOrders",n)},updateOrder:function(t){var i=this.get("doneOrders")||[],n=i[i.length-1];n&&(e.assign(n,this.serializeOrder(t)),this.trigger("change:lastOrder",n))},serializeDowntime:function(e){var t=e.get("finishedAt");return{shift:e.get("shift"),reason:e.get("reason"),aor:e.get("aor"),startedAt:e.get("startedAt").getTime(),finishedAt:t?t.getTime():0}},serializeOrder:function(e){var t=e.get("finishedAt");return{shift:e.get("shift"),orderId:e.get("orderId"),operationNo:e.get("operationNo"),quantityDone:e.get("quantityDone"),workerCount:e.get("workerCount"),startedAt:e.get("startedAt").getTime(),finishedAt:t?t.getTime():0,taktTime:e.get("avgTaktTime")&&e.get("sapTaktTime")?e.isTaktTimeOk()?"ok":"nok":"na"}}})});