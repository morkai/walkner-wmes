// Part of <https://miracle.systems/p/walkner-wmes> licensed under <CC BY-NC-SA 4.0>

define(["jquery","app/core/views/FormView","../tags","app/printers/templates/form"],function(e,t,n,r){"use strict";return t.extend({template:r,afterRender:function(){t.prototype.afterRender.call(this),this.options.editMode?(this.$id("name").attr("readonly",!0),this.$id("label").focus()):this.loadSystemPrinters(),this.$id("tags").select2({width:"100%",placeholder:" ",allowClear:!0,multiple:!0,data:n.toSelect2()})},loadSystemPrinters:function(){var e=this;e.$id("name").prop("readonly",!0),e.ajax({url:"/printing/systemPrinters"}).done(function(t){e.$id("name").prop("readonly",!1).removeClass("form-control").select2({width:"100%",placeholder:" ",data:t.collection.map(function(e){return{id:e.name,text:e.comment.trim()&&e.name!==e.comment?e.comment+" ("+e.name+")":e.name}})})})},serializeToForm:function(){var e=this.model.toJSON();return e.tags=(e.tags||[]).join(","),e},serializeForm:function(e){return e.tags=(e.tags||"").split(",").filter(function(e){return e.length>0}),e.special||(e.special=""),e}})});