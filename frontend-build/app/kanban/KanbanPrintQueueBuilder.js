define(["underscore","jquery","../core/util/uuid","../core/Collection","../core/Model","../data/localStorage","./layouts"],function(t,i,e,n,o,s,r){"use strict";return n.extend({model:o,paginate:!1,initialize:function(t,i){this.layouts=i&&i.layouts||[].concat(r),this.on("add remove change reset",this.store)},store:function(){s.setItem("WMES_KANBAN_BUILDER_ENTRIES",JSON.stringify(this.toJSON()))},addFromEntries:function(t){var i=this,n={},o=[];i.forEach(function(t){n[t.get("ccn")]=!0}),t.forEach(function(t){if(!n[t._id]){var s={_id:e(),ccn:t._id,lines:t.lines};i.add(s,{multi:!0}),o.push(s._id)}}),i.trigger("multiAdd",o)},addFromEntry:function(t){var i=this.findWhere({ccn:t._id});i?this.trigger("focus",i):this.add({_id:e(),ccn:t._id,lines:t.lines})},toggleLayout:function(t,i){void 0===i&&(i=-1===this.layouts.indexOf(t)),i?-1===this.layouts.indexOf(t)&&this.layouts.push(t):this.layouts=this.layouts.filter(function(i){return i!==t}),s.setItem("WMES_KANBAN_BUILDER_LAYOUTS",JSON.stringify(this.layouts)),this.trigger("change:layouts",t,i)}},{fromLocalStorage:function(){return new this(JSON.parse(s.getItem("WMES_KANBAN_BUILDER_ENTRIES")||"[]"),{layouts:JSON.parse(s.getItem("WMES_KANBAN_BUILDER_LAYOUTS")||"null")})}})});