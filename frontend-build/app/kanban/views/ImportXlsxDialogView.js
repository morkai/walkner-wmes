// Part of <https://miracle.systems/p/walkner-wmes> licensed under <CC BY-NC-SA 4.0>

define(["app/i18n","app/viewport","app/core/View","app/kanban/templates/importXlsx"],function(t,a,e,n){"use strict";return e.extend({template:n,events:{submit:"upload"},getTemplateData:function(){return{what:this.model.what}},onDialogShown:function(t){this.closeDialog=t.closeDialog.bind(t)},closeDialog:function(){},upload:function(e){e.preventDefault();var n=this,o=n.$("[type=submit]").attr("disabled",!0),i=new FormData(n.el),l=n.ajax({type:"POST",url:"/kanban/import/"+n.model.what,data:i,processData:!1,contentType:!1});l.then(function(){n.closeDialog()}),l.fail(function(){a.msg.show({type:"error",time:2500,text:t("kanban","msg:import:failure")})}),l.always(function(){o.attr("disabled",!1)})}})});