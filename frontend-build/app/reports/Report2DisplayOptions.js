define(["underscore","../core/Model"],function(n,e){"use strict";var t=["clipOrderCount","clipProductionCount","clipEndToEndCount","clipProduction","clipEndToEnd"];return e.extend({defaults:function(){var n={series:{},extremes:"none",maxClipOrderCount:null,maxClipPercent:null};return t.forEach(function(e){n.series[e]=!0}),n},initialize:function(n,e){if(!e.settings)throw new Error("settings option is required!");this.settings=e.settings},isSeriesVisible:function(n){return!!this.get("series")[n]},updateExtremes:function(n){var e={maxClipOrderCount:null,maxClipPercent:null},t=this.get("extremes");if("none"===t)return this.set(e);for(var i=this.get("series"),r="siblings"===t?1:0,o=n.length;r<o;++r){var s=n[r].get("maxClip");e.maxClipOrderCount=Math.max(e.maxClipOrderCount,i.clipOrderCount?s.orderCount:0,i.clipProductionCount?s.productionCount:0,i.clipEndToEndCount?s.endToEndCount:0),e.maxClipPercent=Math.max(e.maxClipPercent,i.clipProduction?s.production:0,i.clipEndToEnd?s.endToEnd:0)}this.set(e)},serializeToString:function(){var n=this.get("extremes"),e=this.get("series"),i=["none"===n?0:"siblings"===n?1:2,""];return t.forEach(function(n){i[1]+=e[n]?1:0}),i.join("&")}},{fromString:function(n,e){var i=n.split("&");if(2!==i.length)return new this(null,e);var r={extremes:"2"===i[0]?"parent":"1"===i[0]?"siblings":"none",series:{}},o=function(n,e){for(;n.length<e;)n="0"+n;return n}(i[1],t.length);return t.forEach(function(n,e){"1"===o[e]&&(r.series[n]=!0)}),new this(r,e)}})});