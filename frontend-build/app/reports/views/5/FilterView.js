define(["underscore","app/time","app/core/views/FilterView","app/core/util/fixTimeRange","app/reports/util/prepareDateRange","app/reports/templates/5/filter"],function(t,e,r,o,i,n){"use strict";return r.extend({template:n,events:t.extend({},r.prototype.events,{"click a[data-range]":function(t){var e=i(t.target);this.$id("from").val(e.fromMoment.format("YYYY-MM-DD")),this.$id("to").val(e.toMoment.format("YYYY-MM-DD")),this.$('.btn[data-interval="'+e.interval+'"]:not(.active)').click(),this.$el.submit()},"click #-showDisplayOptions":function(){this.trigger("showDisplayOptions")}}),afterRender:function(){r.prototype.afterRender.call(this),this.toggleButtonGroup("interval"),this.toggleButtonGroup("weekends")},serializeQueryToForm:function(){var t=this.model;return{interval:t.get("interval"),weekends:t.get("weekends")?"1":"0",from:e.format(Number(t.get("from")),"YYYY-MM-DD"),to:e.format(Number(t.get("to")),"YYYY-MM-DD")}},changeFilter:function(){var t={rnd:Math.random(),from:null,to:null,interval:this.getButtonGroupValue("interval"),weekends:this.getButtonGroupValue("weekends")},r=o.fromView(this);t.from=r.from||this.getFromTimeByInterval(t.interval).valueOf(),t.to=r.to||Date.now(),this.$id("from").val(e.format(t.from,"YYYY-MM-DD")),this.$id("to").val(e.format(t.to,"YYYY-MM-DD")),this.model.set(t)},getFromTimeByInterval:function(t){var r=e.getMoment().minutes(0).seconds(0).milliseconds(0);switch(t){case"month":return r.date(1).hours(6).valueOf();case"week":return r.day(1).hours(6).valueOf();default:return r.hour(6).valueOf()}}})});