define(["jquery","underscore","js2form","app/core/View","app/data/aors","app/data/downtimeReasons","app/reports/templates/1/displayOptions","app/core/util/ExpandableSelect"],function(e,t,s,i,n,a,o){"use strict";return i.extend({template:o,events:{submit:function(e){e.preventDefault()},"change #-series":function(e){this.updateSelection("series",e.target)},"change #-references":function(e){this.updateSelection("references",e.target,!0)},"change #-aors":function(e){this.updateSelection("aors",e.target)},"change #-reasons":function(e){this.updateSelection("reasons",e.target)},"change [name=extremes]":function(){this.model.set("extremes",this.$("[name=extremes]:checked").val())},"click #-showFilter":function(){this.trigger("showFilter")},"click #-skipEmpty":function(){this.model.set("skipEmpty",!this.model.get("skipEmpty"))}},initialize:function(){this.listenTo(this.model,"change:skipEmpty",this.toggleSkipEmpty)},destroy:function(){this.$(".is-expandable").expandableSelect("destroy")},getTemplateData:function(){return{aors:n.map(function(e){return{id:e.id,label:e.getLabel()}}),reasons:a.map(function(e){return{id:e.id,label:e.id+": "+e.getLabel()}})}},beforeRender:function(){this.$(".is-expandable").expandableSelect("destroy")},afterRender:function(){s(this.el,this.serializeFormData()),this.$(".is-expandable").expandableSelect(),this.$("[name=extremes]:checked").closest(".btn").addClass("active"),this.toggleSkipEmpty()},serializeFormData:function(){return{series:Object.keys(this.model.get("series")),extremes:this.model.get("extremes"),references:Object.keys(this.model.get("references")),aors:Object.keys(this.model.get("aors")),reasons:Object.keys(this.model.get("reasons"))}},updateSelection:function(e,t,s){var i,n,a={};if(0===t.selectedOptions.length&&!0!==s)for(i=0,n=t.length;i<n;++i)t[i].selected=!0;for(i=0,n=t.length;i<n;++i)a[t[i].value]=t[i].selected;this.model.set(e,a)},shown:function(){this.$id("series").focus()},toggleSkipEmpty:function(){this.$id("skipEmpty").toggleClass("active",this.model.get("skipEmpty"))}})});