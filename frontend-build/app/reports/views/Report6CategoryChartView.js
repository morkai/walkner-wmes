// Copyright (c) 2014, ≈Åukasz Walukiewicz <lukasz@walukiewicz.eu>. Some Rights Reserved.
// Licensed under CC BY-NC-SA 4.0 <http://creativecommons.org/licenses/by-nc-sa/4.0/>.
// Part of the walkner-wmes project <http://lukasz.walukiewicz.eu/p/walkner-wmes>

define(["app/i18n","app/highcharts","./Report6ChartView"],function(t,e,i){"use strict";return i.extend({className:"reports-6-category",kind:"category",createChart:function(){var t=this.serializeChartData(),i="qty"===this.options.unit,a=this.settings?this.settings.getColor(i?"quantityDone":"warehouse"):null;this.chart=new e.Chart({chart:{renderTo:this.el},exporting:{filename:this.getExportFilename()},title:{text:this.getChartTitle()},noData:{},xAxis:{type:"category"},yAxis:{title:!1,min:0},tooltip:{shared:!0,valueDecimals:i?0:1},legend:!1,plotOptions:{line:{lineWidth:2,states:{hover:{lineWidth:2}},marker:this.getMarkerStyles(t.length)}},series:[{id:this.options.unit,name:this.getSeriesName(),color:a,borderWidth:0,type:"column",data:t}]})},updateChart:function(){var t=this.serializeChartData(),e=this.getMarkerStyles(t.length),i=this.chart;i.series[0].update({marker:e},!1),i.series[0].setData(t,!1),i.redraw(!1)},serializeChartData:function(){return this.model.getCategoryData(this.options.type)},getSeriesName:function(){var e="wh:";return"qty"===this.options.unit?e+="qty":(e+="fte","week"===this.model.query.get("interval")&&(e+=":avg")),t("reports",e)},onIntervalChange:function(){this.chart&&this.chart.series[0].update({name:this.getSeriesName()},!1)}})});