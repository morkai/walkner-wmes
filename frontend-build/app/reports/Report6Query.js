// Copyright (c) 2014, ≈Åukasz Walukiewicz <lukasz@walukiewicz.eu>. Some Rights Reserved.
// Licensed under CC BY-NC-SA 4.0 <http://creativecommons.org/licenses/by-nc-sa/4.0/>.
// Part of the walkner-wmes project <http://lukasz.walukiewicz.eu/p/walkner-wmes>

define(["underscore","../time","../core/Model"],function(t,e,r){return r.extend({defaults:{from:null,to:null,interval:"shift",parent:null},reset:function(e){e.from&&(e.from=+e.from),e.to&&(e.to=+e.to),this.set(t.defaults(e,this.defaults),{reset:!0})},serializeToObject:function(){return{from:this.get("from"),to:this.get("to"),interval:this.get("interval"),parent:this.get("parent")}},serializeToString:function(t){var e="",r=this.attributes;return r.interval&&(e+="&interval="+r.interval),r.from&&r.to&&(e+="&from="+encodeURIComponent(r.from),e+="&to="+encodeURIComponent(r.to)),t?e+="&parent="+t:void 0===t&&r.parent&&(e+="&parent="+r.parent),e.substr(1)}},{fromQuery:function(t){var r=this,n={};return t.from&&t.to?(n.from=parseInt(t.from,10),n.to=parseInt(t.to,10)):(n.from=e.getMoment().subtract(1,"days").hours(6).startOf("hour").valueOf(),n.to=e.getMoment().hours(6).startOf("hour").valueOf()),t.interval&&(n.interval=t.interval),t.parent&&(n.parent=t.parent),new r(n)}})});