define(["app/i18n","app/viewport","app/core/Collection","app/core/util/pageActions","./DrillingReportPage","../Report1Query","../Report1DisplayOptions","../views/1/HeaderView","../views/1/FilterView","../views/1/DisplayOptionsView","../views/1/ChartsView"],function(t,e,i,r,s,o,n,p,l,a,h){"use strict";return s.extend({rootBreadcrumbKey:"BREADCRUMB:1",pageId:"report1",actions:function(e){var i=s.prototype.actions.call(this);return i.unshift(r.export({layout:e,page:this,collection:this.exportCollection,privilege:!1,label:t("reports","PAGE_ACTION:1:export"),callback:this.onExportClick.bind(this)})),i},initialize:function(){s.prototype.initialize.apply(this,arguments),this.exportCollection=new i(null,{url:"/reports/1"}),this.exportCollection.rqlQuery=this.query,this.exportCollection.length=1},createQuery:function(){return o.fromQuery(this.options.query)},createDisplayOptions:function(){var t={settings:this.settings};return"string"==typeof this.options.displayOptions?n.fromString(this.options.displayOptions,t):new n(this.options.displayOptions,t)},createHeaderView:function(){return new p({model:this.query,displayOptions:this.displayOptions})},createFilterView:function(){return new l({model:this.query})},createDisplayOptionsView:function(){return new a({model:this.displayOptions})},createChartsView:function(t,e){return new h({model:t,settings:this.settings,displayOptions:this.displayOptions,skipRenderCharts:!!e})},afterRender:function(){s.prototype.afterRender.call(this),this.scheduleAutoRefresh()},onQueryChange:function(){s.prototype.onQueryChange.apply(this,arguments),this.exportCollection.trigger("sync")},refresh:function(){s.prototype.refresh.call(this),this.scheduleAutoRefresh()},scheduleAutoRefresh:function(){clearTimeout(this.timers.autoRefresh),this.query.isAutoMode()&&(this.timers.autoRefresh=setTimeout(this.refresh.bind(this),24e4))},onExportClick:function(){if(this.reports[0].isEmpty())return e.msg.show({type:"warning",time:3e3,text:t("reports","MSG:1:export:empty")}),!1}})});