define(["underscore","jquery","moment","app/i18n","app/data/divisions","app/core/View","../Report1","../Report1Query","../views/Report1FilterView","../views/Report1ChartsView","app/reports/templates/report1Page"],function(e,t,n,r,i,o,a,s,l,d,u){return o.extend({layoutName:"page",pageId:"report1",template:u,breadcrumbs:[r.bound("reports","BREADCRUMBS:report1")],initialize:function(){this.defineModels(),this.defineViews(),this.setView(".filter-container",this.filterView),this.insertView(".reports-1-charts-container",this.overallReportCharts),this.divisionReportCharts.forEach(function(e){this.insertView(".reports-1-charts-container",e)},this)},defineModels:function(){this.query=new s(this.options.query),this.listenTo(this.query,"change",this.refreshReports);var e={query:this.query};this.overallReport=new a(null,e),this.divisionReports=i.filter(function(e){return"prod"===e.get("type")}).map(function(t){return new a({orgUnitType:"division",orgUnit:t},e)})},defineViews:function(){this.filterView=new l({model:this.query}),this.overallReportCharts=new d({model:this.overallReport}),this.divisionReportCharts=this.divisionReports.map(function(e){return new d({model:e})})},refreshReports:function(){this.broker.publish("router.navigate",{url:this.overallReport.url()+"?"+this.query.serializeToString(),replace:!0,trigger:!1}),this.promised(this.overallReport.fetch()),this.divisionReports.forEach(function(e){this.promised(e.fetch())},this)}})});