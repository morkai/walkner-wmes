define(["underscore","jquery","app/i18n","app/core/View","../Report3","../Report3Query","../views/Report3FilterView","../views/Report3TableSummaryView","../views/Report3OeeChartView","../views/Report3DowntimeChartView","app/reports/templates/report3Page"],function(e,t,i,r,s,o,n,h,a,u,p){return r.extend({layoutName:"page",pageId:"report3",template:p,breadcrumbs:[i.bound("reports","BREADCRUMBS:3")],initialize:function(){this.defineModels(),this.defineViews(),this.setView(".filter-container",this.filterView),this.setView(".reports-3-tableSummary-container",this.tableSummaryView),this.setView(".reports-3-oeeChart-container",this.oeeChartView),this.setView(".reports-3-downtimeChart-container",this.downtimeChartView)},defineModels:function(){this.query=o.fromRqlQuery(this.options.query),this.report=new s(null,{query:this.query}),this.listenTo(this.query,"change",this.onQueryChange),this.listenTo(this.query,"change:divisions change:subdivisionType",e.debounce(this.recalcSummaries,1)),this.listenTo(this.query,"change:prodLines",this.report.calcChartSummary.bind(this.report))},defineViews:function(){this.filterView=new n({model:this.query}),this.tableSummaryView=new h({model:this.report}),this.oeeChartView=new a({model:this.report}),this.downtimeChartView=new u({model:this.report})},load:function(e){return e(this.report.fetch())},onQueryChange:function(e,t){this.broker.publish("router.navigate",{url:this.report.url()+"?"+this.query.serializeToString(),replace:!0,trigger:!1}),t&&t.reset&&this.promised(this.report.fetch())},recalcSummaries:function(){this.report.calcTableSummary(),this.report.calcChartSummary()}})});