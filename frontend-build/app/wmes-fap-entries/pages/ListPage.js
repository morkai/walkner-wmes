define(["app/i18n","app/viewport","app/notifications","app/core/pages/FilteredListPage","app/core/util/pageActions","../dictionaries","../views/FilterView","../views/ListView","app/wmes-fap-entries/templates/markAsSeenAction"],function(e,t,i,n,r,s,a,o,c){"use strict";return n.extend({FilterView:a,ListView:o,actions:function(e){var t=this;return[r.jump(t,t.collection),{template:c,afterRender:function(e){e.find("a[data-filter]").on("click",t.markAsSeen.bind(t))}},r.export(e,t,t.collection,!1),{label:t.t("PAGE_ACTION:settings"),icon:"cogs",privileges:"FAP:MANAGE",href:"#fap/settings"}]},load:function(e){return e(s.load(),this.collection.fetch({reset:!0}))},destroy:function(){n.prototype.destroy.call(this),s.unload()},afterRender:function(){n.prototype.afterRender.call(this),s.load(),i.renderRequest(this)},markAsSeen:function(e){var i=this,n=i.ajax({method:"POST",url:"/fap/entries;seen",data:JSON.stringify({filter:e.currentTarget.dataset.filter})});n.fail(function(){t.msg.show({type:"error",time:3e3,text:i.t("markAsSeen:failure")})}),n.done(function(e){t.msg.show({type:"success",time:2500,text:i.t("markAsSeen:success",{count:e.length})})})}})});