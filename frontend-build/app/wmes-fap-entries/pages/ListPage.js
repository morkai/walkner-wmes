define(["jquery","app/i18n","app/viewport","app/notifications","app/core/pages/FilteredListPage","app/core/util/pageActions","../dictionaries","../views/FilterView","../views/ListView","app/wmes-fap-entries/templates/markAsSeenAction"],function(e,t,i,n,r,s,a,o,c,l){"use strict";return r.extend({FilterView:o,ListView:c,actions:function(e){var t=this;return[s.jump(t,t.collection),{template:l,afterRender:function(e){e.find("a[data-filter]").on("click",t.markAsSeen.bind(t))}},s.export(e,t,t.collection,!1),{label:t.t("PAGE_ACTION:settings"),icon:"cogs",privileges:"FAP:MANAGE",href:"#fap/settings"}]},load:function(e){return e(a.load(),this.collection.fetch({reset:!0}))},destroy:function(){r.prototype.destroy.call(this),a.unload()},afterRender:function(){r.prototype.afterRender.call(this),a.load(),n.renderRequest(this)},markAsSeen:function(e){var t=this,n=t.ajax({method:"POST",url:"/fap/entries;seen",data:JSON.stringify({filter:e.currentTarget.dataset.filter})});n.fail(function(){i.msg.show({type:"error",time:3e3,text:t.t("markAsSeen:failure")})}),n.done(function(e){i.msg.show({type:"success",time:2500,text:t.t("markAsSeen:success",{count:e.length})})})}})});