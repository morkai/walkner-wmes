define(["jquery","app/broker","app/user","app/core/View","../Entry","./AddFormView","app/wmes-fap-entries/templates/navbar"],function(e,t,i,n,d,r,s){"use strict";return n.extend({template:s,events:{"click #-add":function(){if(this.$(".fap-addForm").length)return this.hideAddForm();clearTimeout(this.timers.resetNewEntry),this.timers.resetNewEntry=null,this.toggleAddForm(!0);var e=new r({model:this.model});this.listenTo(e,"cancel",this.hideAddForm),this.setView("#-addForm",e).render()}},initialize:function(){var t=this;t.model=new d,t.listenTo(t.model,"sync",function(){t.hideAddForm(),t.timers.resetModel=setTimeout(t.resetEntry.bind(t),1)}),e(window).on("keydown."+t.idPrefix,t.onKeyDown.bind(t))},destroy:function(){e(window).off("."+this.idPrefix)},getTemplateData:function(){return{browseEntriesLinks:[{label:"all",rql:""},{label:"open",rql:"&status=in=(pending,started)"},{label:"pending",rql:"&status=in=(pending)"},{label:"started",rql:"&status=in=(started)"},{label:"finished",rql:"&status=in=(finished)"},{label:"analysis",rql:"&analysisNeed=true&analysisDone=false"}]}},afterRender:function(){this.$(".fap-addForm").length&&this.toggleAddForm(!0)},toggleAddForm:function(e){var t=this.$id("add").find(".fa");this.$el.toggleClass("fap-navbar-adding",e),this.$id("menu").prop("disabled",e),e?t.removeClass("fa-plus").addClass("fa-times"):t.removeClass("fa-times").addClass("fa-plus")},hideAddForm:function(){var e=this;e.$(".fap-addForm").length&&(e.removeView("#-addForm"),e.toggleAddForm(!1),e.timers.resetNewEntry=setTimeout(function(){e.model.clear()},3e5))},resetEntry:function(){var e=this.model;delete e.focusedInput,delete e.uploadQueue,delete e.uploading,delete e.uploadedFiles,delete e.validatedOrder,e.clear()},onKeyDown:function(e){"Escape"===e.originalEvent.key&&this.hideAddForm()}},{setUp:function(){if(!window.MODULES||-1!==window.MODULES.indexOf("wmes-fap")){var e=this;t.subscribe("navbar.rendered",function(t){var i=t.view;if(!i.$el.find(".fap-navbar").length){var n=new e;i.insertView(".navbar-collapse",n).render()}})}}})});