// Part of <https://miracle.systems/p/walkner-wmes> licensed under <CC BY-NC-SA 4.0>

define(["../time","../data/prodLines","../core/Collection","../core/util/matchesEquals","../core/util/matchesProdLine","../orgUnits/util/limitOrgUnits","./ProdShiftOrder"],function(r,t,e,o,i,s,n){"use strict";return e.extend({model:n,rqlQuery:function(t){var e=[{name:"ge",args:["startedAt",r.getMoment().subtract(1,"months").valueOf()]}];return s(e,{divisionType:"prod"}),t.Query.fromObject({fields:{creator:0,losses:0,"orderData.bom":0,"orderData.documents":0},sort:{startedAt:-1},limit:20,selector:{name:"and",args:e}})},hasOrMatches:function(r){return!!this.get(r._id)||i(this.rqlQuery,r.prodLine)&&o(this.rqlQuery,"orderId",r.orderId)&&o(this.rqlQuery,"operationNo",r.operationNo)&&o(this.rqlQuery,"shift",r.shift)}})});