define(["underscore","app/user","app/viewport","app/core/views/ListView","app/data/prodLines","app/orgUnits/util/renderOrgUnitPath"],function(e,t,i,s,r,a){"use strict";return s.extend({className:"is-clickable is-colored",refreshDelay:6e3,remoteTopics:{"prodShiftOrders.created.*":"refreshIfMatches","prodShiftOrders.updated.*":"refreshIfMatches","prodShiftOrders.deleted.*":"refreshIfMatches"},events:e.assign({"click .is-filter":function(e){this.trigger("showFilter",e.currentTarget.dataset.columnId)}},s.prototype.events),serializeColumns:function(){return[{id:"mrpControllers",titleProperty:"mrpControllersText",className:"is-overflow w100",thClassName:"is-filter"},{id:"prodFlow",className:"is-overflow w250",thClassName:"is-filter"},{id:"prodLine",className:"is-overflow w100",thClassName:"is-filter"},{id:"orderId",className:"is-min",thClassName:"is-filter"},{id:"product",className:"is-overflow w350",thClassName:"is-filter"},{id:"operation",titleProperty:"operationName",className:"is-overflow w225"},{id:"prodShift",className:"is-min",width:"105px",thClassName:"is-filter"},{id:"startedAt",className:"is-min",thClassName:"is-filter"},{id:"duration",className:"is-min"},{id:"quantityDone",className:"is-min is-number"},{id:"workerCount",className:"is-min is-number"},t.isAllowedTo("PROD_DATA:VIEW:EFF")?{id:"efficiency",className:"is-min is-number"}:null,"-"]},serializeRow:function(e){return e.serializeRow({orgUnits:!0})},serializeActions:function(){var e=this.collection;return function(t){return[s.actions.viewDetails(e.get(t._id))]}},afterRender:function(){s.prototype.afterRender.call(this);var e=this;this.$('.list-item > td[data-id="prodLine"]').popover({container:this.el,trigger:"hover",placement:"auto right",html:!0,content:function(){var t=a(r.get(e.$(this).text().trim()),!1,!1);return t?t.split(" \\ ").join("<br>\\ "):"?"}})},refreshIfMatches:function(e,t){this.collection.hasOrMatches(e)&&(this.isQuantityDoneMessage(t,e)||this.refreshCollection())},isQuantityDoneMessage:function(t,i){return!!/updated/.test(t)&&(/updated/.test(t)&&e.isNumber(i.quantityDone)&&e.isNumber(i.totalQuantity)&&e.isNumber(i.avgTaktTime)&&e.isNumber(i.lastTaktTime))}})});