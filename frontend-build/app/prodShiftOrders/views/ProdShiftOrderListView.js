// Copyright (c) 2014, ≈Åukasz Walukiewicz <lukasz@walukiewicz.eu>. Some Rights Reserved.
// Licensed under CC BY-NC-SA 4.0 <http://creativecommons.org/licenses/by-nc-sa/4.0/>.
// Part of the walkner-wmes project <http://lukasz.walukiewicz.eu/p/walkner-wmes>

define(["underscore","app/i18n","app/user","app/viewport","app/core/views/ListView","app/data/prodLines","app/data/views/renderOrgUnitPath","./decorateProdShiftOrder"],function(e,t,r,i,o,n,s,a){return o.extend({remoteTopics:{"prodShiftOrders.created.*":"refreshIfMatches","prodShiftOrders.updated.*":"refreshIfMatches","prodShiftOrders.deleted.*":"refreshIfMatches"},columns:["mrpControllers","prodFlow","prodLine","order","operation","prodShift","startedAt","duration","quantityDone","workerCount"],serializeRows:function(){return this.collection.map(function(e){return a(e,{orgUnits:!0})})},serializeActions:function(){var e=this.collection;return function(t){return[o.actions.viewDetails(e.get(t._id))]}},afterRender:function(){o.prototype.afterRender.call(this);var e=this;this.$('.list-item > td[data-id="prodLine"]').popover({container:this.el,trigger:"hover",placement:"auto right",html:!0,content:function(){var t=s(n.get(e.$(this).text().trim()),!1,!1);return t?t.split(" \\ ").join("<br>\\ "):"?"}})},refreshIfMatches:function(e){this.collection.hasOrMatches(e)&&this.refreshCollection()}})});