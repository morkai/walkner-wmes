define(["underscore","app/user","app/viewport","app/core/views/ListView","app/data/prodLines","app/orgUnits/util/renderOrgUnitPath"],function(e,i,t,r,s,n){"use strict";return r.extend({className:"is-clickable is-colored",refreshDelay:6e3,remoteTopics:{"prodShiftOrders.created.*":"refreshIfMatches","prodShiftOrders.updated.*":"refreshIfMatches","prodShiftOrders.deleted.*":"refreshIfMatches"},serializeColumns:function(){return[{id:"mrpControllers",className:"is-min"},"prodFlow",{id:"prodLine",className:"is-min"},"order","operation",{id:"prodShift",className:"is-min"},{id:"startedAt",className:"is-min"},{id:"duration",className:"is-min"},{id:"quantityDone",className:"is-min"},{id:"workerCount",className:"is-min"},i.isAllowedTo("PROD_DATA:VIEW:EFF")?{id:"efficiency",className:"is-min"}:null]},serializeRow:function(e){return e.serializeRow({orgUnits:!0})},serializeActions:function(){var e=this.collection;return function(i){return[r.actions.viewDetails(e.get(i._id))]}},afterRender:function(){r.prototype.afterRender.call(this);var e=this;this.$('.list-item > td[data-id="prodLine"]').popover({container:this.el,trigger:"hover",placement:"auto right",html:!0,content:function(){var i=n(s.get(e.$(this).text().trim()),!1,!1);return i?i.split(" \\ ").join("<br>\\ "):"?"}})},refreshIfMatches:function(e,i){this.collection.hasOrMatches(e)&&(this.isQuantityDoneMessage(i,e)||this.refreshCollection())},isQuantityDoneMessage:function(i,t){return!!/updated/.test(i)&&(/updated/.test(i)&&e.isNumber(t.quantityDone)&&e.isNumber(t.totalQuantity)&&e.isNumber(t.avgTaktTime)&&e.isNumber(t.lastTaktTime))}})});