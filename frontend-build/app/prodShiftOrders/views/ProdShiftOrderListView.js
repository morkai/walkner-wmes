// Part of <http://miracle.systems/p/walkner-wmes> licensed under <CC BY-NC-SA 4.0>

define(["app/user","app/viewport","app/core/views/ListView","app/data/prodLines","app/data/views/renderOrgUnitPath"],function(e,i,t,r,s){"use strict";return t.extend({className:"is-clickable is-colored",remoteTopics:{"prodShiftOrders.created.*":"refreshIfMatches","prodShiftOrders.updated.*":"refreshIfMatches","prodShiftOrders.deleted.*":"refreshIfMatches"},serializeColumns:function(){var i=[{id:"mrpControllers",className:"is-min"},"prodFlow",{id:"prodLine",className:"is-min"},"order","operation",{id:"prodShift",className:"is-min"},{id:"startedAt",className:"is-min"},{id:"duration",className:"is-min"},{id:"quantityDone",className:"is-min"},{id:"workerCount",className:"is-min"}];return e.isAllowedTo("PROD_DATA:VIEW")&&i.push({id:"efficiency",className:"is-min"}),i},serializeRow:function(e){return e.serializeRow({orgUnits:!0})},serializeActions:function(){var e=this.collection;return function(i){return[t.actions.viewDetails(e.get(i._id))]}},afterRender:function(){t.prototype.afterRender.call(this);var e=this;this.$('.list-item > td[data-id="prodLine"]').popover({container:this.el,trigger:"hover",placement:"auto right",html:!0,content:function(){var i=s(r.get(e.$(this).text().trim()),!1,!1);return i?i.split(" \\ ").join("<br>\\ "):"?"}})},refreshIfMatches:function(e){this.collection.hasOrMatches(e)&&this.refreshCollection()}})});