// Part of <https://miracle.systems/p/walkner-wmes> licensed under <CC BY-NC-SA 4.0>

define(["jquery","app/i18n","app/user","app/core/View","app/mor/views/MorView"],function(i,e,t,n,o){"use strict";return n.extend({pageId:"mor",layoutName:"page",title:e.bound("mor","BREADCRUMBS:base"),actions:function(){var n=this,o=t.isAllowedTo.bind(t,"MOR:MANAGE","FN:manager");return[{label:e.bound("mor","PAGE_ACTION:addSection"),icon:"plus",privileges:"MOR:MANAGE",className:function(){return"mor-action-addSection "+(n.editing?"":"hidden")},callback:function(){n.view.addSection()}},{label:e.bound("mor","PAGE_ACTION:editMode"),icon:"edit",privileges:o,className:function(){return n.editing?"active":""},callback:function(e){var t=e.currentTarget.querySelector(".btn");t.classList.toggle("active"),n.el.classList.toggle("is-editing"),n.editing=n.el.classList.contains("is-editing"),i(".mor-action-addSection").toggleClass("hidden",!n.editing),n.view.toggleEditing(n.editing)}},{label:e.bound("mor","PAGE_ACTION:settings"),icon:"cogs",privileges:"MOR:MANAGE",href:"#mor;settings"}]},initialize:function(){this.editing=!1,this.view=new o({model:this.model})},load:function(i){return i(this.model.fetch())}})});