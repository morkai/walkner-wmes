define(["app/user","app/viewport","app/core/views/ListView","./FormView"],function(e,i,t,n){"use strict";return t.extend({localTopics:{"socket.connected":"refreshCollectionNow"},remoteTopics:function(){var e={};return e[this.collection.getTopicPrefix()+".updated"]="onUpdated",e},events:Object.assign({"click .action-edit":function(e){var t=this.collection.get(this.$(e.currentTarget).closest(".list-item")[0].dataset.id),s=new n({model:t});i.showDialog(s,this.t("FORM:edit:title"))}},t.prototype.events),columns:[{id:"line",className:"is-min",tdClassName:"text-fixed"},{id:"sapOrder",className:"is-min"},{id:"qty",className:"is-min text-right",tdClassName:"text-right"},{id:"pceTime",className:"is-min"},{id:"date",className:"is-min"},{id:"set",className:"is-min"},"-"],actions:function(){var i=this,t=e.isAllowedTo("WH:MANAGE");return function(){return t?[{id:"edit",icon:"edit",label:i.t("core","LIST:ACTION:edit")}]:[]}},initialize:function(){t.prototype.initialize.apply(this,arguments),this.once("afterRender",function(){this.listenTo(this.collection,"change",this.render)})},onUpdated:function(e){var i=this,t=!1,n=i.collection.getLineFilter(),s=i.collection.getSapOrderFilter();(e.added||[]).forEach(function(e){e.line!==n&&e.sapOrder!==s||(t=!0)}),(e.updated||[]).forEach(function(e){var o=i.collection.get(e._id);o?o.set(e):e.line!==n&&e.sapOrder!==s||(t=!0)}),t&&i.refreshCollection()}})});