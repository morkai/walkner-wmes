var PAGE_NUMBERS=4,PAGE_DOTS_VISIBLE=!1,PAGE_FIRST_LAST_VISIBLE=!1,PAGE_NEXT_PREV_VISIBLE=!1;Viewer.TEMPLATE='<div class="viewer-container"><div class="viewer-canvas"></div><div class="viewer-footer"><div class="viewer-title"></div><ul class="viewer-toolbar"><li id="bomToggle" title="Pokaż komponenty">BOM</li><li id="lockUi" title="Zablokuj interfejs"><span class="fa fa-lock"></span></li><li id="pdf" title="Pokaż oryginalny plik PDF"><span class="fa fa-file-pdf-o"></span></li><li class="viewer-zoom-in" data-viewer-action="zoom-in" title="Powiększ"><span class="fa fa-plus"></span></li><li class="viewer-zoom-out" data-viewer-action="zoom-out" title="Pomniejsz"><span class="fa fa-minus"></span></li><li class="viewer-one-to-one" data-viewer-action="one-to-one" title="Dopasuj do strony">1:1</li><li class="viewer-reset" data-viewer-action="reset" title="Resetuj widok">0</li><li class="viewer-rotate-right" data-viewer-action="rotate-right" title="Obróć w prawo"><span class="fa fa-rotate-right"></span></li><li class="viewer-flip-horizontal" data-viewer-action="flip-horizontal" title="Odwróć poziomo"><span class="fa fa-arrows-h"></span></li><li class="viewer-flip-vertical" data-viewer-action="flip-vertical" title="Odwróć pionowo"><span class="fa fa-arrows-v"></span></li>',PAGE_COUNT>1&&(PAGE_COUNT>9&&(Viewer.TEMPLATE+='<li id="first" title="Pierwsza strona">1</li>'),Viewer.TEMPLATE+='<li class="viewer-prev" data-viewer-action="prev" title="Poprzednia strona"><span class="fa fa-chevron-left"></span></li><li class="viewer-next" data-viewer-action="next" title="Następna strona"><span class="fa fa-chevron-right"></span></li>',PAGE_COUNT>9&&(Viewer.TEMPLATE+='<li id="jump" title="Skocz do strony">...</li>')),Viewer.TEMPLATE+='</ul><div class="viewer-navbar"><ul class="viewer-list"></ul></div></div><div class="viewer-tooltip"></div><div class="viewer-button" data-action="mix"></div><div class="viewer-player"></div></div>';var adjustMarksTimer=null,adjustViewportAfterMarks=!1,componentLabel=null,viewer=new Viewer(document.getElementById("images"),{button:!1,keyboard:!1,navbar:!1,title:!1,tooltip:!1,backdrop:!1,initialViewIndex:parseInt(sessionStorage.getItem("PAGE_"+(NC15||"")),10)||0,toolbar:{},toggleOnDblclick:!1,switchable:!1,view:function(e){var t=document.getElementById("jumpForm");t&&t.classList.add("hidden"),NC15&&sessionStorage.setItem("PAGE_"+NC15,e.detail.index),renderPages(e.detail.index)},rendering:function(){document.getElementById("marks").style.display="none";var e=document.getElementById("componentLabel");e&&(e.style.display="none")},rendered:function(){clearTimeout(adjustMarksTimer),adjustMarksTimer=setTimeout(adjustMarks,200),!window.ready&&window.parent.WMES_DOCS_BOM_MARKS&&document.querySelector(".viewer-canvas > img").addEventListener("click",showComponentLabel),window.ready=!0}});function renderPages(e){if(1!==PAGE_COUNT){var t=serializePages(e+1),a=document.getElementById("pages"),i="";t.pages.forEach(function(e){i+='<li data-page="'+e.no+'" class="'+(e.active?"is-active":"")+'">'+e.no+"</li>"}),a.innerHTML=i}}function serializePages(e){var t=PAGE_COUNT,a=PAGE_NUMBERS;PAGE_DOTS_VISIBLE&&(a+=1);var i=e,n=i+a,s=!0,o=!1;i-a<1?i=1:(i-=a,o=PAGE_DOTS_VISIBLE&&1!==i),o&&(i+=1),n>t&&(n=t,s=!1),e<a+1?(n+=a+1-e)>t&&(n=t):e>t-a&&(i-=a-(t-e))<1&&(i=1);var r=PAGE_DOTS_VISIBLE&&s&&n!==t;return r&&(n-=1),1===i&&(o=!1),{pageCount:t,page:e,visible:t>1,firstLastLinksVisible:PAGE_FIRST_LAST_VISIBLE,prevNextLinksVisible:PAGE_NEXT_PREV_VISIBLE,leftDotsVisible:o,rightDotsVisible:r,firstPageLinkAvailable:e>1,lastPageLinkAvailable:e<t,prevPageLinkAvailable:e>1,nextPageLinkAvailable:e<t,pages:generatePages(i,n,e)}}function generatePages(e,t,a){for(var i=[],n=e;n<=t;++n)i.push({no:n,active:n===a});return i}function showMarks(e,t){var a=!1,i=viewer.index+1;document.getElementById("marks").innerHTML=e.map(function(e){return a||e.p!==i||(a=!0),'<div class="mark" style="display: none" data-x="'+(e.x-3)+'" data-y="'+e.y+'" data-w="'+(e.w+6)+'" data-h="'+e.h+'" data-p="'+e.p+'"></div>'}).join("\n"),adjustViewportAfterMarks=!0,t?(t-=1)===viewer.index?adjustMarks():viewer.view(t):a?adjustMarks():e.length&&viewer.view(e[0].p-1)}function adjustMarks(){var e=document.getElementById("marks");viewer.image&&(e.style.cssText=viewer.image.style.cssText);for(var t=e.querySelectorAll(".mark"),a=0;a<t.length;++a)adjustMark(t[a]);adjustComponentLabel(),adjustViewportAfterMarks&&(adjustViewportAfterMarks=!1,adjustViewport())}function adjustMark(e){var t=viewer.imageData.ratio,a=2*e.dataset.w*t,i=2*e.dataset.h*t,n=2*e.dataset.y*t-i,s=2*e.dataset.x*t;e.style.display=+e.dataset.p===viewer.index+1?"":"none",e.style.width=a+"px",e.style.height=i+"px",e.style.top=n+"px",e.style.left=s+"px"}function adjustViewport(){for(var e=document.querySelectorAll(".mark"),t=0,a=Number.MAX_VALUE,i=0,n=Number.MAX_VALUE,s=0,o=0;o<e.length;++o){var r=e[o];if("none"!==r.style.display){var l=r.getBoundingClientRect();t+=l.top>=0&&l.left>=0&&l.bottom<=window.innerHeight&&l.right<=window.innerWidth?1:0;var d=parseInt(r.style.top,10),c=parseInt(r.style.left,10);a=Math.min(a,d),i=Math.max(i,d+l.height),n=Math.min(n,c),s=Math.max(s,c+l.width)}}var v=viewer.imageData.ratio;if(!(viewer.imageData.ratio>=.4&&t===e.length)){a-=20*v,i+=20*v,n-=20*v,s+=20*v;var m=(s/=v)-(n/=v),w=(i/=v)-(a/=v),p=Math.min(window.innerWidth/m,window.innerHeight/w,1),u=n*p,g=a*p,E=m*p,f=w*p,L=window.innerWidth/2-E/2+0,y=window.innerHeight/2-f/2+0;viewer.zoomTo(p,!1),viewer.moveTo(L-u,y-g)}}function toggleBom(e){var t=document.getElementById("bomToggle");"boolean"!=typeof e?t.classList.contains("is-loading")||t.classList.contains("is-error")||(t.classList.add("is-loading"),t.innerHTML='<i class="fa fa-spinner fa-spin"></i>',e=!t.classList.contains("is-active"),window.parent.WMES_DOCS_BOM_TOGGLE(e,function(e){e&&(t.classList.add("is-error"),setTimeout(function(){t.classList.remove("is-error")},3e3)),t.classList.remove("is-loading"),t.classList.toggle("is-active",window.parent.WMES_DOCS_BOM_ACTIVE()),t.innerHTML="BOM"})):t.classList.toggle("is-active",e)}function showComponentLabel(e){var t=document.getElementById("componentLabel");t||((t=document.createElement("div")).setAttribute("id","componentLabel"),document.body.appendChild(t));var a=viewer.imageData.ratio,i=e.offsetX/2/a,n=e.offsetY/2/a;window.parent.WMES_DOCS_BOM_MARKS(function(e,s){e&&(s=[]);const o=s.map(e=>{var t=Number.MAX_SAFE_INTEGER;if(e.p===viewer.index+1){var a=e.x-3+(e.w+6)/2,s=e.y-e.h/2,o=i-a,r=n-s;t=Math.sqrt(o*o+r*r)}return{mark:e,distance:t}});o.sort((e,t)=>e.distance-t.distance);var r=o[0].mark,l=r.w*a/2+25;if(o[0].distance>l)return componentLabel=null,void(t.style.display="none");var d=r.label;/wire.*?L-?[0-9]{1,4}/i.test(d)&&(d=d.match(/L-?([0-9]{1,4})/)[1]+"mm"),t.innerHTML=d,componentLabel=r,adjustComponentLabel()})}function adjustComponentLabel(){var e=document.getElementById("componentLabel");if(componentLabel&&e){var t=viewer.imageData.ratio,a=document.querySelector(".viewer-canvas > img"),i=parseInt(a.style.marginLeft,10)+2*componentLabel.x*t,n=parseInt(a.style.marginTop,10)+2*componentLabel.y*t;e.style.left=i+"px",e.style.top=n+"px",e.style.fontSize=Math.min(28,Math.max(14,2*componentLabel.h*t))+"px",e.style.display="";var s=e.getBoundingClientRect();e.style.marginLeft=(componentLabel.w+6)*t+s.width/2*-1+"px"}}window.addEventListener("contextmenu",function(e){e.preventDefault()}),window.addEventListener("touchstart",function(e){e.touches&&e.touches.length>1&&e.preventDefault()},{passive:!1}),window.addEventListener("load",function(){viewer.show(),Array.isArray(window.HIDDEN_BUTTONS)&&window.HIDDEN_BUTTONS.forEach(function(e){document.getElementById(e).classList.add("hidden")});var e=document.getElementById("first"),t=document.getElementById("jump"),a=document.getElementById("jumpForm"),i=document.getElementById("pages");document.getElementById("pdf").addEventListener("click",function(){var e=window.location.href;window.location.href=e+(-1===e.indexOf("?")?"?":"&")+"pdf=1"});var n=document.getElementById("lockUi");window.parent.WMES_DOCS_LOCK_UI?n.addEventListener("click",function(){window.parent.WMES_DOCS_LOCK_UI()}):n.style.display="none",e&&e.addEventListener("click",function(){viewer.view(0)}),t&&t.addEventListener("click",function(){document.getElementById("pageNo").value=viewer.index+1+" / "+PAGE_COUNT,document.getElementById("pageNo").dataset.value="",document.getElementById("jumpForm").classList.toggle("hidden")}),i&&i.addEventListener("click",function(e){e.target.dataset.page&&viewer.view(+e.target.dataset.page-1)}),a&&(a.addEventListener("click",function(e){var t=e.target.dataset.key;if(t){var a=document.getElementById("pageNo");"BACKSPACE"===t?(a.value="? / "+PAGE_COUNT,a.dataset.value=""):(a.dataset.value+=t,a.value=a.dataset.value+" / "+PAGE_COUNT)}}),a.addEventListener("submit",function(e){e.preventDefault(),e.target.classList.add("hidden");var t=document.getElementById("pageNo"),a=parseInt(t.value,10);isNaN(a)||(a<1?a=1:a>PAGE_COUNT&&(a=PAGE_COUNT),viewer.view(a-1))}));var s=document.getElementById("bomToggle");window.parent.WMES_DOCS_BOM_TOGGLE?(s.addEventListener("click",function(){toggleBom()}),toggleBom(window.parent.WMES_DOCS_BOM_ACTIVE())):s.style.display="none"});