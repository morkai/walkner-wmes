define(["underscore","moment","select2","app/broker"],function(e,t,n,i){function r(e,t,n){try{return u[e][t](n)}catch(r){if(u[e]&&u[e][t])throw r;return i.publish("i18n.missingKey",{domain:e,key:t}),t}}function s(e,t,n){u[e]=t,"string"==typeof n&&c.push(n),i.publish("i18n.registered",{domain:e,keys:t,moduleId:n})}function o(s,o){var a="en";e.isObject(r.config)&&(a=r.config.locale,r.config.locale=s),c.forEach(require.undef);var l=[].concat(c);"en"!==s&&l.unshift("moment-lang/"+s),l.unshift("select2-lang/"+s),require(l,function(){t.lang(s),n.lang(s),i.publish("i18n.reloaded",{oldLocale:a,newLocale:s}),e.isFunction(o)&&o()})}function a(e,t,n){function i(){return r(e,t,n)}return i.toString=i,i}function l(e,t){return"undefined"!=typeof u[e]&&"function"==typeof u[e][t]}var u={},c=[];return r.config=null,r.translate=r,r.register=s,r.reload=o,r.bound=a,r.has=l,window.i18n=r,r});