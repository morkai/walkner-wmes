define(["underscore","moment","select2","app/broker"],function(n,e,i,o){function t(n,e,i){try{return a[n][e](i)}catch(t){if(a[n]&&a[n][e])throw t;return o.publish("i18n.missingKey",{domain:n,key:e}),e}}function r(n,e,i){a[n]=e,"string"==typeof i&&l.push(i),o.publish("i18n.registered",{domain:n,keys:e,moduleId:i})}function u(r,u){var c="en";n.isObject(t.config)&&(c=t.config.locale,t.config.locale=r),l.forEach(require.undef);var f=[].concat(l);"en"!==r&&f.unshift("moment-lang/"+r),f.unshift("select2-lang/"+r),require(f,function(){e.lang(r),i.lang(r),o.publish("i18n.reloaded",{oldLocale:c,newLocale:r}),n.isFunction(u)&&u()})}function c(n,e,i){function o(){return t(n,e,i)}return o.toString=o,o}function f(n,e){return"undefined"!=typeof a[n]&&"function"==typeof a[n][e]}var a={},l=[];return t.config=null,t.translate=t,t.register=r,t.reload=u,t.bound=c,t.has=f,window.i18n=t,t});