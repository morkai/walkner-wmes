define(["app/core/views/FormView","app/data/prodFunctions","app/users/util/setUpUserSelect2","app/wmes-compRel-entries/dictionaries","app/wmes-compRel-funcs/templates/form"],function(e,t,i,s,n){"use strict";return e.extend({template:n,initialize:function(){e.prototype.initialize.apply(this,arguments),this.once("afterRender",function(){this.listenTo(t,"change",this.setUpFuncsSelect2),this.listenTo(s.funcs,"change",this.setUpFuncsSelect2)})},serializeModel:function(){return{name:this.model.getLabel()}},serializeToForm:function(){var e=this.model.toJSON();return e.users="",e},serializeForm:function(e){return e.users=i.getUserInfo(this.$id("users")),e},afterRender:function(){e.prototype.afterRender.apply(this,arguments),this.setUpFuncsSelect2(),this.setUpUsersSelect2()},setUpFuncsSelect2:function(){var e=this.$id("_id").val(),i=t.map(function(t){var i=!!s.funcs.get(t.id);return i&&e===t.id&&(e=""),{id:t.id,text:t.getLabel(),disabled:i}});this.$id("_id").val(e).select2({data:i})},setUpUsersSelect2:function(){i(this.$id("users"),{noPersonnelId:!0,multiple:!0}).select2("data",this.model.get("users").map(function(e){return{id:e.id,text:e.label}}))}})});