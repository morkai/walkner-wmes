define(["app/time","app/viewport","app/core/pages/FilteredListPage","app/core/util/pageActions","app/wmes-osh-common/dictionaries","app/wmes-osh-common/templates/list/markAsSeenAction"],function(t,e,i,n,s,o){"use strict";return i.extend({nlsDomain:"wmes-osh-common",actions:function(e){return[n.jump(this,this.collection,{mode:"id",pattern:`^s*${this.collection.model.RID_PREFIX}?-?([0-9]{4}-)?[0-9]{1,6}$s*`,prepareId:e=>{const i=e.trim().match(/([0-9]{4}-)?([0-9]{1,6})$/),n=(i[1]||t.format(Date.now(),"YYYY")).replace(/[^0-9]/,"");return`${this.collection.model.RID_PREFIX}-${n}-${i[2].padStart(6,"0")}`}}),{template:()=>this.renderPartialHtml(o),afterRender:t=>{t.find("a[data-filter]").on("click",this.markAsSeen.bind(this))}},n.export(e,this,this.collection),n.add(this.collection)]},initialize:function(){i.prototype.initialize.apply(this,arguments),s.bind(this)},markAsSeen:function(t){var i=this,n=i.ajax({method:"POST",url:this.collection.genUrl("mark-as-seen"),data:JSON.stringify({filter:t.currentTarget.dataset.filter})});n.fail(function(){e.msg.show({type:"error",time:2500,text:i.t("markAsSeen:failure")})}),n.done(function(t){e.msg.show({type:"success",time:2e3,text:i.t("markAsSeen:success",{count:t.length})})})}})});