define(["require","app/i18n","app/time","app/core/Model","app/core/templates/userInfo","app/wmes-osh-common/Entry"],function(e,t,s,n,i,r){"use strict";return n.extend({idAttribute:"rid",getModelType:function(){return e("app/wmes-osh-common/dictionaries").PREFIX_TO_TYPE[this.get("rid").charAt(0)]},getRelation:function(){return{_id:this.get("_id"),rid:this.get("rid"),type:this.getModelType()}},handleUpdate:function(e){const t=this.constructor,s={};Object.keys(e.data).forEach(n=>{const i=r.changeHandlers[n],o=e.data[n][0],a=e.data[n][1];if(i){const c={prop:n,newData:s,newValue:a,oldValue:o,change:e,Model:t,model:this};"string"==typeof i?r.changeHandlers[i](c):i(c)}else s[n]=a}),this.set(s)},serialize:function(){const s=e("app/wmes-osh-common/dictionaries"),n=this.toJSON();return n.creator=i(n.creator,{noIp:!0}),n.status=t("wmes-osh-common",`status:${n.status}`),n.url=`#osh/${s.TYPE_TO_MODULE[this.getModelType()]}/${this.get("_id")}`,n},serializePopover:function(){const e=this.serialize();return e.createdAt=e.createdAt?s.format(e.createdAt,"LLLL"):"",e.implementers=e.implementers?e.implementers.map(e=>i(e,{noIp:!0})):[],e},serializeRow:function(){const e=this.serialize();return e.className=r.STATUS_TO_CLASS[this.get("status")],e.createdAt=e.createdAt?s.format(e.createdAt,"L LT"):"",e.implementers&&e.implementers.length?e.implementers=i(e.implementers[0],{noIp:!0})+(e.implementers.length>1?` +${e.implementers.length-1}`:""):e.implementers="",e}})});