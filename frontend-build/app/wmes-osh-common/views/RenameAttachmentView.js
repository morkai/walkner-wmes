define(["app/viewport","app/core/views/FormView","app/wmes-osh-common/templates/attachments/rename"],function(e,t,a){"use strict";return t.extend({nlsDomain:"wmes-osh-common",template:a,getTemplateData:function(){return{attachment:this.attachment}},serializeToForm:function(){return{newName:this.attachment.name}},serializeForm:function(e){const t=this.attachment.name.toLowerCase().match(/\.([A-Za-z0-9]{1,10})$/);return t&&!e.newName.trim().toLowerCase().endsWith(t[1])&&(e.newName.endsWith(".")||(e.newName+="."),e.newName+=t[1]),e},onDialogShown:function(){this.$id("newName").focus()},request:function(t){return e.msg.saving(),this.ajax({method:"PUT",url:this.model.url(),data:JSON.stringify({attachments:{edited:[{_id:this.attachment._id,name:t.newName}]}})})},handleFailure:function(){e.msg.saved(),t.prototype.handleFailure.apply(this,arguments)},handleSuccess:function(){e.msg.saved(),e.closeDialog()}})});