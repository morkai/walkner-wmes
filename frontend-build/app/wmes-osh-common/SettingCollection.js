define(["app/i18n","app/core/util/transliterate","app/settings/SettingCollection","./Setting"],function(e,r,t,n){"use strict";return t.extend({model:n,idPrefix:"osh.",topicSuffix:"osh.**",prepareValue:function(e,r){return e.includes("rewards.ignoredUsers")?Array.isArray(r)?r:[]:e.includes("rewards.companies")?this.parseRewardsCompaniesValue(r):e.includes("rewards")?Math.round(100*this.prepareFloatValue(r,0,1e3,0))/100:void 0},prepareFormValue:function(e,r){return e.includes("rewards.ignoredUsers")?r.map(e=>e.id).join(","):e.includes("rewards.companies")?this.prepareRewardsCompaniesValue(r):r},prepareRewardsCompaniesValue:function(e){return(e||[]).map(e=>`${e.text}: ${e.patterns.join("; ")}`).join("\n")},parseRewardsCompaniesValue:function(e){let t=null;const n=(e||"").split("\n").map(e=>{const n=e.split(":"),i=n.shift().trim(),s=n.join(":").split(";").map(e=>e.trim()).filter(e=>!!e);if(!i)return null;const a={id:r(i).toUpperCase().replace(/[^A-Z0-9_]+/g,"_"),text:i,patterns:s};return a.patterns.some(e=>"*"===e)&&(t=a),a}).filter(e=>!!e&&e!==t);return t||(t={id:"",text:"Inne",patterns:["*"]}),t.id="OTHER",n.push(t),n}})});