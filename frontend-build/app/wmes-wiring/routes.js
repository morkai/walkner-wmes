define(["../broker","../time","../router","../viewport","../user"],function(a,e,t,r,s){"use strict";var i=s.auth("LOCAL","WIRING:VIEW"),n=s.auth("WIRING:MANAGE");t.map("/wiring/:date",i,function(t){"current"===t.params.date&&(t.params.date="0d"),/^-?[0-9]+d$/.test(t.params.date)&&(t.params.date=e.getMoment().subtract(e.getMoment().hours()<6?1:0,"days").startOf("day").add(+t.params.date.replace("d",""),"days").format("YYYY-MM-DD"),a.publish("router.navigate",{url:"/wiring/"+t.params.date,replace:!0,trigger:!1})),r.loadPage(["app/wmes-wiring/pages/WiringPage","css!app/wmes-wiring/assets/main","i18n!app/nls/wmes-wiring"],function(a){return new a({date:t.params.date,mrp:t.query.mrp||"all",status:t.query.status?t.query.status.split(","):[],fullscreen:void 0!==t.query.fullscreen})})}),t.map("/wiring;settings",n,function(a){r.loadPage(["app/wmes-wiring/pages/WiringSettingsPage","i18n!app/nls/wmes-wiring"],function(e){return new e({initialTab:a.query.tab})})})});