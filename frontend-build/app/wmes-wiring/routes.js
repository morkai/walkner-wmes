define(["../broker","../time","../router","../viewport","../user"],function(a,e,r,t,s){"use strict";var i=s.auth("LOCAL","WIRING:VIEW"),n=s.auth("WIRING:MANAGE");r.map("/wiring/:date",i,function(r){"current"===r.params.date&&(r.params.date="0d"),/^-?[0-9]+d$/.test(r.params.date)&&(r.params.date=e.getMoment().subtract(e.getMoment().hours()<6?1:0,"days").startOf("day").add(+r.params.date.replace("d",""),"days").format("YYYY-MM-DD"),a.publish("router.navigate",{url:"/wiring/"+r.params.date,replace:!0,trigger:!1})),t.loadPage(["app/wmes-wiring/pages/WiringPage","css!app/wmes-wiring/assets/main","i18n!app/nls/wmes-wiring"],function(a){return new a({date:r.params.date,mrp:r.query.mrp||"all",status:r.query.status?r.query.status.split(","):[],order:r.query.order||"",fullscreen:void 0!==r.query.fullscreen})})}),r.map("/wiring;settings",n,function(a){t.loadPage(["app/wmes-wiring/pages/WiringSettingsPage","i18n!app/nls/wmes-wiring"],function(e){return new e({initialTab:a.query.tab})})})});