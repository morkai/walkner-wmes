define(["underscore","app/wmes-osh-common/ResolutionCollection","app/wmes-osh-common/pages/DetailsPage","../views/RootCausesView","../views/SolutionView","../views/ResolutionsView","app/wmes-osh-actions/templates/details/page","app/wmes-osh-actions/templates/details/props"],function(e,t,s,i,o,n,l,p){"use strict";return s.extend({template:l,propsTemplate:p,initialize:function(){s.prototype.initialize.apply(this,arguments),this.once("afterRender",()=>{this.listenTo(this.model,"change:resolutions",this.resolutions.fetch.bind(this.resolutions,{reset:!0}))})},remoteTopics:function(){const e=s.prototype.remoteTopics.apply(this,arguments);return e[`${this.model.getTopicPrefix()}.relations.${this.model.id}`]="onRelationsUpdated",e},defineModels:function(){s.prototype.defineModels.apply(this,arguments),this.resolutions=new t(null,{parent:this.model})},defineViews:function(){s.prototype.defineViews.apply(this,arguments),this.rootCausesView=new i({model:this.model}),this.solutionView=new o({model:this.model}),this.resolutionsView=new n({model:this.model,resolutions:this.resolutions}),this.setView("#-rootCauses",this.rootCausesView),this.setView("#-solution",this.solutionView),this.setView("#-resolutions",this.resolutionsView)},load:function(e){return e(this.model.fetch(),this.resolutions.fetch({reset:!0}))},onRelationsUpdated:function({relation:e,change:t}){const s=this.resolutions.get(e.rid);s&&s.handleUpdate(t)}})});