// Part of <https://miracle.systems/p/walkner-wmes> licensed under <CC BY-NC-SA 4.0>

define(["app/i18n","app/time","app/core/Model","app/orders/util/resolveProductName"],function(r,e,o,t){"use strict";return o.extend({urlRoot:"/invalidOrders",clientUrlRoot:"#invalidOrders",topicPrefix:"orders.invalid",privilegePrefix:"ORDERS",nlsDomain:"invalidOrders",serialize:function(){var o=this.toJSON();if(o.className="ignored"===o.status?"warning":"resolved"===o.status?"success":"danger",o.orderNo='<a href="#orders/'+o._id+'">'+o._id+"</a>",o.order){o.nc12=o.order.nc12,o.productName=t(o.order),o.qty=(o.order.qtyDone.total?o.order.qtyDone.total:"0")+"/"+o.order.qty;var i=e.getMoment(o.order.startDate);if(o.startDate=i.format("L"),"invalid"===o.status){var a=i.diff(Date.now(),"hours");a<12?o.className+=" invalidOrders-veryLate":a<24&&(o.className+=" invalidOrders-late")}}return o.problem=r("invalidOrders","problem:"+o.problem),window.IPT_ORDER_CHECK_URL&&(o.problem='<a href="'+window.IPT_ORDER_CHECK_URL.replace("${order}",o._id)+'">'+o.problem+"</a>"),o.solution&&(o.solution=r("invalidOrders","solution:"+o.solution)),o.iptStatus===o.iptComment&&(o.iptComment=""),o}})});