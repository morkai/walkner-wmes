// Part of <https://miracle.systems/p/walkner-wmes> licensed under <CC BY-NC-SA 4.0>

define(["underscore","app/i18n","app/user","app/core/views/ListView","app/core/views/ActionFormView"],function(i,e,t,s,o){"use strict";return s.extend({className:"is-colored",remoteTopics:{"orders.invalid.synced":"refreshCollection","orders.invalid.ignored":function(i){this.collection.toggleSelection(i.model._id,!1),this.refreshCollectionNow()}},events:i.assign({"click .action-select":function(i){return this.collection.toggleSelection(this.$(i.target).closest("tr").attr("data-id")),!1},"click .action-ignore":function(i){return o.showDialog({model:this.collection.get(this.$(i.target).closest("tr").attr("data-id")),actionKey:"ignore",formMethod:"DELETE",formActionSeverity:"warning"}),!1}},s.prototype.events),initialize:function(){s.prototype.initialize.apply(this,arguments),this.listenTo(this.collection,"selected",this.onSelected)},columns:[{id:"orderNo",className:"is-min"},{id:"nc12",className:"is-min"},{id:"productName",className:"is-min"},{id:"mrp",className:"is-min"},{id:"qty",className:"is-min is-number"},{id:"startDate",className:"is-min"},{id:"problem",className:"is-min"},{id:"solution",className:"is-min"},{id:"iptStatus"},{id:"iptComment"}],serializeActions:function(){var i=this;return function(s){var o=i.collection.get(s._id);if("invalid"!==o.get("status"))return[];var n=[{id:"select",icon:"check-square-o",label:e("invalidOrders","LIST:ACTION:select"),className:i.collection.selected[o.id]?"active":""}];return t.isAllowedTo("ORDERS:MANAGE")&&n.push({id:"ignore",icon:"ban",label:e("invalidOrders","LIST:ACTION:ignore")}),n}},onSelected:function(i,e){(i?this.$row(i):this.$el).find(".action-select").toggleClass("active",e)}})});