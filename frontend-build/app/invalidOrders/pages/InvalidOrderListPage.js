define(["underscore","app/i18n","app/user","app/core/pages/FilteredListPage","app/core/views/ActionFormView","../views/InvalidOrderFilterView","../views/InvalidOrderListView"],function(e,i,t,o,n,l,s){"use strict";return o.extend({FilterView:l,ListView:s,actions:function(){var t=this;return[{label:i.bound("invalidOrders","PAGE_ACTION:check"),icon:"question",privileges:"ORDERS:MANAGE",callback:t.showCheckDialog.bind(t)},{id:"-notify",icon:"envelope-o",label:i("invalidOrders","PAGE_ACTION:notify"),className:function(){return e.isEmpty(t.collection.selected)?"disabled":""},callback:t.showNotifyDialog.bind(t)},{label:i.bound("invalidOrders","PAGE_ACTION:settings"),icon:"cogs",privileges:"ORDERS:MANAGE",href:"#orders;settings?tab=iptChecker"}]},initialize:function(){o.prototype.initialize.apply(this,arguments),this.listenTo(this.collection,"selected",this.onSelected)},createFilterView:function(){return new l({model:{rqlQuery:this.collection.rqlQuery}})},showCheckDialog:function(){n.showDialog({model:this.collection,formAction:"/invalidOrders;checkOrders",actionKey:"check",formMethod:"POST",formActionSeverity:"primary"})},showNotifyDialog:function(){var t=e.keys(this.collection.selected);if(t.length){var o=n.showDialog({model:this.collection,formAction:"/invalidOrders;notifyUsers",actionKey:"notify",formMethod:"POST",formActionSeverity:"primary",messageText:i("invalidOrders","ACTION_FORM:MESSAGE_SPECIFIC:notify",{orders:t.join(", ")}),requestData:{orders:t}});this.listenTo(o,"success",function(){this.collection.toggleSelection(null,!1)})}},onSelected:function(){this.$id("notify").toggleClass("disabled",e.isEmpty(this.collection.selected))}})});