define(["./divisions","./subdivisions","./mrpControllers","./prodFlows","./workCenters","./prodLines"],function(e,t,i,n,r,o){function s(e,t,i){return e.filter(function(e){var n=e.get(t);return n?Array.isArray(n)?-1!==n.indexOf(i.id):n===i.id:!1})}var a={division:"subdivision",subdivision:"mrpController",mrpController:"prodFlow",prodFlow:"workCenter",workCenter:"prodLine",prodLine:null},l={prodLine:"workCenter",workCenter:"prodFlow",prodFlow:"mrpController",mrpController:"subdivision",subdivision:"division",division:null},c={division:e,subdivision:t,mrpController:i,prodFlow:n,workCenter:r,prodLine:o};return{getProdFlowsForSubdivision:function(e){return"string"==typeof e&&(e=t.get(e)),e?n.filter(function(t){return t.getSubdivision()===e}):[]},getAllDivisions:function(){return e.models},getAllForProdLine:function(s){"string"==typeof s&&(s=o.get(s));var a={division:null,subdivision:null,mrpControllers:null,prodFlow:null,workCenter:null,prodLine:null};if(!s)return a;a.prodLine=s.id;var l=r.get(s.get("workCenter"));if(!l)return a;a.workCenter=l.id;var c=n.get(l.get("prodFlow"));if(!c)return a;a.prodFlow=c.id;var u=c.get("mrpController");if(!Array.isArray(u)||!u.length)return a;if(a.mrpControllers=u,u=i.get(u[0]),!u)return a;var p=t.get(u.get("subdivision"));if(!p)return a;a.subdivision=p.id;var d=e.get(p.get("division"));return d?(a.division=d.id,a):a},getType:function(s){if(s.constructor===o.model)return"prodLine";if(s.constructor===r.model)return"workCenter";if(s.constructor===n.model)return"prodFlow";if(s.constructor===i.model)return"mrpController";if(s.constructor===t.model)return"subdivision";if(s.constructor===e.model)return"division";throw new Error("Unknown org unit type!")},getChildType:function(e){return a[e]||"division"},getChildren:function(e){var t=this.getType(e),i=this.getChildType(t),n=c[i];return n?s(n,t,e):[]},getByTypeAndId:function(e,t){var i=c[e];return i?i.get(t)||null:null},getParent:function(e){var t=this.getType(e),i=l[t],n=e.get(i);return!n||Array.isArray(n)&&!n.length?null:this.getByTypeAndId(i,Array.isArray(n)?n[0]:n)},RELATION_TYPES:{SIBLINGS:"siblings",TYPES:"types",CHILD:"child",DIFFERENT_CHILD:"differentChild",PARENT:"parent",DIFFERENT_PARENT:"differentParent",UNRELATED:"unrelated"},getRelationType:function(e,t,i,n){if(null===e&&"division"===i)return this.RELATION_TYPES.CHILD;if("division"===e&&null===i)return this.RELATION_TYPES.PARENT;var r=this.getByTypeAndId(e,t),o=this.getByTypeAndId(i,n);return e===i?this.getParent(r)===this.getParent(o)?this.RELATION_TYPES.SIBLINGS:this.RELATION_TYPES.TYPES:a[e]===i?this.getParent(o)===r?this.RELATION_TYPES.CHILD:this.RELATION_TYPES.DIFFERENT_PARENT:l[e]===i?this.getParent(r)===o?this.RELATION_TYPES.PARENT:this.RELATION_TYPES.DIFFERENT_CHILD:this.RELATION_TYPES.UNRELATED}}});