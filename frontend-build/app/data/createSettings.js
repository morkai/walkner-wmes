define(["app/pubsub","app/core/util/bindLoadingMessage"],function(n,e){"use strict";return function(u){var t=null,i=null,l=null;function r(){l=null,null!==i&&(t.destroy(),t=null,i=null)}return{bind:function(n,u){return n.settings=e(this.acquire(u),n),n.on("beforeLoad",function(e,u){u.unshift(n.settings.fetchIfEmpty())}),n.once("afterRender",this.acquire.bind(this,null)),n.once("remove",this.release.bind(this)),n.settings},acquire:function(e){return null!==l&&(clearTimeout(l),l=null),null===i&&(e||(e={}),e.pubsub=t=n.sandbox(),e.paginate=!1,i=new u(null,e)),i},release:function(){null!==l&&clearTimeout(l),l=setTimeout(r,3e4)}}}});