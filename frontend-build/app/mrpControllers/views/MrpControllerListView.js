// Part of <https://miracle.systems/p/walkner-wmes> licensed under <CC BY-NC-SA 4.0>

define(["app/i18n","app/user","app/time","app/orgUnits/util/renderOrgUnitPath","app/core/views/ListView"],function(i,t,e,a,s){"use strict";function n(i){return"-"===i.deactivatedAt?"":'class="is-deleted"'}return s.extend({deactivatedVisible:!1,columns:[{id:"subdivision",className:"is-min"},{id:"_id",className:"is-min"},{id:"inout",className:"is-min"},{id:"description",tdAttrs:n},{id:"deactivatedAt",className:"is-min"},{id:"replacedBy",className:"is-min"}],serializeActions:function(){var i=this.collection,e=i.getNlsDomain();return function(a){var n=i.get(a._id),d=!n.get("deactivatedAt")||t.data.super,c=[];return c.push(s.actions.viewDetails(n,e)),d&&t.isAllowedTo(n.getPrivilegePrefix()+":MANAGE")&&c.push(s.actions.edit(n,e),s.actions.delete(n,e)),c}},serializeRows:function(){var t=this.deactivatedVisible;return this.collection.filter(function(i){return t||!i.get("deactivatedAt")}).map(function(t){var s=t.toJSON();return s.className=s.deactivatedAt?"is-deactivated":"",s.subdivision=a(t,!0),s.deactivatedAt=s.deactivatedAt?e.format(s.deactivatedAt,"LL"):"-",s.inout=i("mrpControllers","inout:"+s.inout),s.replacedBy=s.replacedBy||"-",s})},toggleDeactivated:function(i){this.deactivatedVisible=i,this.render()}})});