define(["app/user","app/core/views/FilterView","app/users/util/setUpUserSelect2","app/wmes-osh-common/dictionaries","app/wmes-osh-common/views/OrgUnitPickerFilterView","app/wmes-osh-reports/templates/rewards/filter"],function(e,t,i,s,n,a){"use strict";return t.extend({template:a,events:Object.assign({'change input[name="mode"]':function(){this.toggleMode()},'change select[name="status"]':function(){this.toggleDate()}},t.prototype.events),termToForm:{division:(e,t,i)=>{i.mode="orgUnit"},workplace:"division",department:"division",status:(e,t,i)=>{i[e]=t.args[1]},paidAt:"status",employee:(e,t,i)=>{i[e]=t.args[1],i.mode="employee"}},initialize:function(){t.prototype.initialize.apply(this,arguments),this.canViewAll()&&(this.orgUnitPickerView=new n({filterView:this,emptyLabel:this.t("wmes-osh-reports","filter:orgUnit"),orgUnitTypes:["division","workplace","department"],labelInput:{name:"mode",value:"orgUnit"}}),this.setView("#-orgUnit",this.orgUnitPickerView))},serializeFormToQuery:function(t){const i=this.$id("status").val();if(t.push({name:"eq",args:["status",i]}),"paid"===i){const e=this.$id("paidAt").val();e&&t.push({name:"eq",args:["paidAt",e]})}const s=this.$('input[name="mode"]:checked').val();if("orgUnit"!==s)if(this.canViewAll()){const e=this.$id(s).val();e&&t.push({name:"eq",args:[s,e]})}else t.push({name:"eq",args:[s,e.data._id]})},getTemplateData:function(){return{showOrgUnitFilter:this.canViewAll()}},afterRender:function(){t.prototype.afterRender.call(this),i(this.$id("employee"),{view:this,width:"300px"}),this.toggleMode(),this.toggleDate()},toggleMode:function(){const t=this.$('input[name="mode"]:checked').val();if(t)if(this.canViewAll())this.orgUnitPickerView.toggle("orgUnit"===t),this.$id("employee").select2("enable","employee"===t);else{const t=i.userToData(Object.assign({},e.data));this.$id("employee").select2("data",t).select2("enable",!1)}else this.$('input[name="mode"]').first().click()},toggleDate:function(){const e="paid"!==this.$('select[name="status"]').val();this.$id("paidAtGroup").toggleClass("hidden",e),e&&this.$id("paidAt").val("")},canViewAll:function(){return e.isAllowedTo("OSH:REWARDS:VIEW")||s.isCoordinator()}})});