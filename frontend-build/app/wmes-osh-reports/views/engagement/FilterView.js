define(["app/core/views/FilterView","app/core/util/forms/dateTimeRange","app/users/util/setUpUserSelect2","app/wmes-osh-common/dictionaries","app/wmes-osh-common/views/OrgUnitPickerFilterView","app/wmes-osh-reports/templates/engagement/filter","app/core/util/ExpandableSelect"],function(e,t,i,n,o,r){"use strict";return e.extend({template:r,events:Object.assign({"click a[data-date-time-range]":t.handleRangeEvent,'change input[name="mode"]':function(){this.toggleMode()}},e.prototype.events),termToForm:{date:t.rqlToForm,division:(e,t,i)=>{i.mode="orgUnit"},workplace:"division",department:"division",leader:(e,t,i)=>{i[e]=t.args[1],i.mode="leader"}},initialize:function(){e.prototype.initialize.apply(this,arguments),this.orgUnitPickerView=new o({filterView:this,emptyLabel:this.t("wmes-osh-reports","filter:orgUnit"),orgUnitTypes:["division","workplace","department"],labelInput:{name:"mode",value:"orgUnit"}}),this.setView("#-orgUnit",this.orgUnitPickerView)},serializeFormToQuery:function(e){t.formToRql(this,e),["leader"].forEach(t=>{const i=this.$id(t);let n=i.val();n&&n.length&&!i.prop("disabled")&&("string"==typeof n&&(n=n.split(",")),"SELECT"===i[0].tagName&&i[0].options.length===n.length||(1===(n=n.map(e=>/^[0-9]+$/.test(e)?parseInt(e,10):e)).length?e.push({name:"eq",args:[t,n[0]]}):e.push({name:"in",args:[t,n]})))})},afterRender:function(){e.prototype.afterRender.call(this),i(this.$id("leader"),{view:this,width:"300px"}),this.toggleMode()},toggleMode:function(){const e=this.$('input[name="mode"]:checked').val();e?(this.orgUnitPickerView.toggle("orgUnit"===e),this.$id("leader").select2("enable","leader"===e)):this.$('input[name="mode"]').first().click()}})});