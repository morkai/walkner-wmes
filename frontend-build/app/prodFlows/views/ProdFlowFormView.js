define(["app/time","app/orgUnits/views/OrgUnitDropdownsView","app/orgUnits/util/changeWarning","app/core/views/FormView","app/prodFlows/templates/form"],function(t,e,i,o,r){"use strict";return o.extend({template:r,initialize:function(){o.prototype.initialize.call(this),this.orgUnitDropdownsView=new e({orgUnit:e.ORG_UNIT.MRP_CONTROLLER,multiple:!0,required:!0}),this.setView(".orgUnitDropdowns-container",this.orgUnitDropdownsView)},afterRender:function(){o.prototype.afterRender.call(this);var t=!this.options.editMode,e=this.orgUnitDropdownsView;this.listenToOnce(e,"afterRender",function(){e.selectValue(this.model).focus(),e.$id("division").select2("enable",t),e.$id("subdivision").select2("enable",t)}),i(this)},serializeToForm:function(){var e=o.prototype.serializeToForm.call(this);return e.deactivatedAt&&(e.deactivatedAt=t.format(e.deactivatedAt,"YYYY-MM-DD")),e},serializeForm:function(e){var i=t.getMoment(e.deactivatedAt||null);return e.deactivatedAt=i.isValid()?i.toISOString():null,e.mrpController="string"==typeof e.mrpController?e.mrpController.split(","):[],e}})});