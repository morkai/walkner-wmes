define(["app/user","app/core/views/ListView","app/data/prodLines","app/orgUnits/util/renderOrgUnitPath"],function(e,i,t,s){"use strict";return i.extend({className:"prodShifts-list is-clickable is-colored",remoteTopics:{"prodShifts.created.*":"refreshIfMatches","prodShifts.updated.*":"refreshIfMatches","prodShifts.deleted.*":"refreshIfMatches"},serializeColumns:function(){return[{id:"mrpControllers",className:"is-min"},{id:"prodFlow",className:"is-min"},{id:"prodLine",className:"is-min"},{id:"date",className:"is-min"},{id:"shift",className:"is-min"},{id:"totalQuantityDone",className:"is-min is-number"},e.isAllowedTo("PROD_DATA:VIEW:EFF")?{id:"efficiency",className:"is-min is-number"}:null,{id:"fill",label:"&nbsp;"}]},serializeActions:function(){var e=this.collection;return function(t){return[i.actions.viewDetails(e.get(t._id))]}},afterRender:function(){i.prototype.afterRender.call(this);var e=this;this.$('.list-item > td[data-id="prodLine"]').popover({container:this.el,trigger:"hover",placement:"auto right",html:!0,content:function(){return s(t.get(e.$(this).text().trim()),!1,!1).split(" \\ ").join("<br>\\ ")}})},refreshIfMatches:function(e,i){if(this.collection.hasOrMatches(e))if(this.isQuantityDoneMessage(i,e)){var t=this.collection.get(e._id);t&&t.set("quantitiesDone",e.quantitiesDone)}else this.refreshCollection()},isQuantityDoneMessage:function(e,i){return/updated/.test(e)&&Array.isArray(i.quantitiesDone)&&2===Object.keys(i).length}})});