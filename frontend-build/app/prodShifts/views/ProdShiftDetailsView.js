define(["underscore","app/core/views/DetailsView","app/data/downtimeReasons","app/prodShiftOrders/ProdShiftOrder","app/prodShifts/ProdShift","app/prodShifts/templates/details"],function(e,i,t,n,s,a){"use strict";return i.extend({template:a,remoteTopics:{},initialize:function(){i.prototype.initialize.apply(this,arguments),this.panelType=this.options.panelType||"primary",this.prodShiftOrders&&this.prodDowntimes&&this.once("afterRender",function(){var i=e.debounce(this.updateDetails.bind(this),1);this.listenTo(this.prodShiftOrders,"reset add remove change",i),this.listenTo(this.prodDowntimes,"reset add remove change",i)})},getTemplateData:function(){return{panelType:this.panelType,efficiency:this.calcEfficiency()}},updateDetails:function(){this.updateEfficiency()},updatePanelType:function(e){this.$el.removeClass("panel-"+this.panelType).addClass("panel-"+e),this.panelType=e},updateEfficiency:function(){var e=this.calcEfficiency();this.$('div[data-prop="efficiency"] > .prop-value').text(e>=0?e+"%":""),clearTimeout(this.timers.updateEfficiency),this.timers.updateEfficiency=setTimeout(this.updateEfficiency.bind(this),3e4)},calcEfficiency:function(){return s.calcEfficiency(this.prodShiftOrders,this.prodDowntimes)}})});