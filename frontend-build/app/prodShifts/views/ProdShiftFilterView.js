// Part of <https://miracle.systems/p/walkner-wmes> licensed under <CC BY-NC-SA 4.0>

define(["underscore","jquery","select2","app/user","app/data/mrpControllers","app/core/views/FilterView","app/core/util/fixTimeRange","app/orgUnits/views/OrgUnitPickerView","app/users/ownMrps","app/mrpControllers/util/setUpMrpSelect2","app/prodShifts/templates/filter"],function(e,t,r,i,s,a,p,n,o,l,u){"use strict";return a.extend({template:u,events:e.assign({},o.events,a.prototype.events),defaultFormData:{date:"",shift:0,orderMrp:""},termToForm:{date:function(e,t,r){p.toFormData(r,t,"date")},shift:function(e,t,r){r[e]=t.args[1]},orderMrp:function(e,t,r){r[e]=Array.isArray(t.args[1])?t.args[1].join(","):""}},initialize:function(){a.prototype.initialize.apply(this,arguments),this.setView("#"+this.idPrefix+"-orgUnit",new n({filterView:this}))},serialize:function(){return e.assign(a.prototype.serialize.apply(this,arguments),{showOwnMrps:o.hasAny()})},afterRender:function(){a.prototype.afterRender.apply(this,arguments),this.toggleButtonGroup("shift"),l(this.$id("orderMrp"))},serializeFormToQuery:function(e){var t=p.fromView(this),r=parseInt(this.$('input[name="shift"]:checked').val(),10),i=this.$id("orderMrp").val();r&&e.push({name:"eq",args:["shift",r]}),t.from&&e.push({name:"ge",args:["date",t.from]}),t.to&&e.push({name:"le",args:["date",t.to]}),i&&i.length&&e.push({name:"in",args:["orderMrp",i.split(",")]})}})});