// Part of <https://miracle.systems/p/walkner-wmes> licensed under <CC BY-NC-SA 4.0>

define(["jquery","../core/Collection","./PaintShopDropZone"],function(t,e,i){"use strict";return e.extend({model:i,paginate:!1,initialize:function(t,e){this.date=e&&e.date},url:function(){return"/paintShop/dropZones?"+(this.date?"_id.date="+this.date:"")},parse:function(t){return(t.collection||[]).map(i.parse)},setDate:function(t){this.date=t},toggle:function(t){return this.update(t,!this.getState(t))},update:function(e,i){return t.ajax({method:"POST",url:"/paintShop/dropZones/"+this.date+"/"+e,data:JSON.stringify({state:i})})},updated:function(t){if(!this.date||t._id.date===this.date){var e=i.id(t),n=this.get(e);n?n.set("state",t.state):this.add(i.parse(t)),this.trigger("updated",this.get(e))}},getState:function(t){var e=this.get(this.date+"~"+t);return!!e&&e.get("state")}},{forDate:function(t){return new this(null,{date:t})}})});