define(["../broker","../time","../router","../viewport","../user","./pages/PaintShopPage","i18n!app/nls/paintShop","i18n!app/nls/wh"],function(a,t,e,n,p,i){"use strict";var r=p.auth("PAINT_SHOP:VIEW"),o=p.auth("LOCAL","PAINT_SHOP:VIEW"),s=p.auth("PAINT_SHOP:MANAGE");e.map("/paintShop/:date",o,function(e){"current"===e.params.date&&(e.params.date="0d"),/^-?[0-9]+d$/.test(e.params.date)&&(e.params.date=t.getMoment().subtract(t.getMoment().hours()<6?1:0,"days").startOf("day").add(+e.params.date.replace("d",""),"days").format("YYYY-MM-DD"),a.publish("router.navigate",{url:"/paintShop/"+e.params.date,replace:!0,trigger:!1})),n.showPage(new i({date:e.params.date,selectedMrp:e.query.mrp,selectedPaint:e.query.paint,fullscreen:void 0!==e.query.fullscreen}))}),e.map("/paintShop/paints",r,function(a){n.loadPage(["app/paintShopPaints/PaintShopPaintCollection","app/paintShopPaints/pages/PaintShopPaintListPage"],function(t,e){return new e({date:a.query.date,collection:new t(null,{rqlQuery:a.rql})})})}),e.map("/paintShop/load",r,function(a){n.loadPage(["app/paintShop/pages/PaintShopLoadPage"],function(t){return new t({query:a.query})})}),e.map("/paintShop;settings",s,function(a){n.loadPage(["app/paintShop/pages/PaintShopSettingsPage"],function(t){return new t({initialTab:a.query.tab})})})});