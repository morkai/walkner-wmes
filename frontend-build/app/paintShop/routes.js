// Part of <https://miracle.systems/p/walkner-wmes> licensed under <CC BY-NC-SA 4.0>

define(["../broker","../time","../router","../viewport","../user","./pages/PaintShopPage","i18n!app/nls/paintShop"],function(a,e,t,r,p,n){"use strict";t.map("/paintShop/:date",p.auth("LOCAL","PAINT_SHOP:VIEW"),function(t){return"paints"===t.params.date?void r.loadPage(["app/paintShopPaints/PaintShopPaintCollection","app/paintShopPaints/pages/PaintShopPaintListPage"],function(a,e){return new e({collection:new a(null,{rqlQuery:t.rql})})}):("current"===t.params.date&&(t.params.date="0d"),/^-?[0-9]+d$/.test(t.params.date)&&(t.params.date=e.getMoment().subtract(e.getMoment().hours()<6?1:0,"days").startOf("day").add(+t.params.date.replace("d",""),"days").format("YYYY-MM-DD"),a.publish("router.navigate",{url:"/paintShop/"+t.params.date,replace:!0,trigger:!1})),void r.showPage(new n({date:t.params.date,selectedMrp:t.query.mrp,fullscreen:void 0!==t.query.fullscreen})))})});