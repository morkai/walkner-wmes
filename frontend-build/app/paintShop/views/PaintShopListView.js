// Part of <https://miracle.systems/p/walkner-wmes> licensed under <CC BY-NC-SA 4.0>

define(["jquery","app/i18n","app/viewport","app/core/View","app/paintShop/templates/list"],function(t,i,e,s,n){"use strict";return s.extend({template:n,events:{"mousedown .paintShop-list-item":function(t){this.lastClickEvent=t},"mouseup .paintShop-list-item":function(t){var i=this.lastClickEvent;i&&((window.parent===window||0===t.button&&i.offsetY===t.offsetY&&i.offsetX===t.offsetX&&i.screenX===t.screenX&&i.screenY===t.screenY)&&this.handleItemClick(t.currentTarget.dataset.orderId),this.lastClickEvent=null)}},initialize:function(){this.lastClickEvent=null,this.listenTo(this.model,"reset",this.render),this.listenTo(this.model,"change",this.onChange)},serialize:function(){return{idPrefix:this.idPrefix,showTimes:this.options.showTimes,orders:this.serializeOrders()}},serializeOrders:function(){var t=[],i=this.options.filter||function(){return!0},e=this.options.sort;return this.model.serializeGroups(i).forEach(function(i){i.orders.forEach(function(i){t.push(i)})}),e&&t.sort(e),t},$item:function(t){return this.$('.paintShop-list-item[data-order-id="'+t+'"]')},handleItemClick:function(t){t&&this.model.trigger("focus",t)},onChange:function(t){var i=this.$item(t.id);return this.options.filter?void((i.length||this.options.filter(t.serialize()))&&this.render()):void i.attr("data-status",t.get("status"))}})});