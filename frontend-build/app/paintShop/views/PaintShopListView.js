// Part of <https://miracle.systems/p/walkner-wmes> licensed under <CC BY-NC-SA 4.0>

define(["jquery","app/i18n","app/viewport","app/core/View","app/paintShop/templates/list"],function(t,e,i,s,n){"use strict";return s.extend({template:n,events:{"mousedown .paintShop-list-item":function(t){this.lastClickEvent=t},"mouseup .paintShop-list-item":function(t){var e=this.lastClickEvent;e&&0===t.button&&((window.parent===window||e.offsetY===t.offsetY&&e.offsetX===t.offsetX&&e.screenX===t.screenX&&e.screenY===t.screenY)&&this.handleItemClick(t.currentTarget.dataset.orderId),this.lastClickEvent=null)}},initialize:function(){this.lastClickEvent=null,this.listenTo(this.model,"reset",this.render),this.listenTo(this.model,"change",this.onChange),this.listenTo(this.model,"mrpSelected",this.onMrpSelected)},serialize:function(){return{idPrefix:this.idPrefix,showTimes:this.options.showTimes,orders:this.serializeOrders()}},serializeOrders:function(){var t=[],e=this.options.filter||function(){return!0},i=this.options.sort;return this.model.serializeGroups(e).forEach(function(e){e.orders.forEach(function(e){t.push(e)})}),i&&t.sort(i),t},$item:function(t){return this.$('.paintShop-list-item[data-order-id="'+t+'"]')},handleItemClick:function(t){t&&this.model.trigger("focus",t)},onChange:function(t){var e=this.$item(t.id);return this.options.filter?void((e.length||this.options.filter(t.serialize()))&&this.render()):void e.attr("data-status",t.get("status"))},onMrpSelected:function(){var t=this.model.selectedMrp;this.$(".paintShop-list-item").each(function(){this.style.display="all"===t||this.dataset.mrp===t?"":"none"})}})});