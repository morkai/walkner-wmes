// Part of <https://miracle.systems/p/walkner-wmes> licensed under <CC BY-NC-SA 4.0>

define(["app/i18n","app/time","app/core/View","app/core/util/getShiftStartInfo","app/paintShop/templates/datePicker"],function(t,i,a,e,n){"use strict";return a.extend({template:n,dialogClassName:"paintShop-datePicker-dialog",events:{"focus [data-vkb]":function(t){this.options.vkb&&this.options.vkb.show(t.target,this.onVkbValueChange)},"click .btn[data-days]":function(t){var i=e(Date.now()).moment.add(+t.currentTarget.dataset.days,"days");this.$id("day").val(i.format("DD")),this.$id("month").val(i.format("MM")),this.$id("year").val(i.format("YYYY")),this.options.vkb&&this.options.vkb.hide()},submit:function(){return this.trigger("picked",this.getMoment().format("YYYY-MM-DD")),!1}},initialize:function(){this.onVkbValueChange=this.onVkbValueChange.bind(this)},destroy:function(){this.options.vkb&&this.options.vkb.hide()},serialize:function(){var t=i.getMoment(this.model.date,"YYYY-MM-DD");return{idPrefix:this.idPrefix,day:t.format("DD"),month:t.format("MM"),year:t.format("YYYY")}},getMoment:function(){var t=this.$id("day").val(),a=this.$id("month").val(),e=this.$id("year").val(),n=e+"-"+a+"-"+t;return i.getMoment(n,"YYYY-MM-DD")},onVkbValueChange:function(){var i=this.getMoment();this.$id("day")[0].setCustomValidity(i.isValid()?"":t("paintShop","datePicker:invalid"))}})});