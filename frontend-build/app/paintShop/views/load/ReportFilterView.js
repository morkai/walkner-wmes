define(["js2form","app/time","app/core/View","app/core/util/getShiftStartInfo","app/core/util/buttonGroup","app/core/util/forms/dateTimeRange","app/paintShop/templates/load/reportFilter"],function(t,e,i,a,r,o,n){"use strict";return i.extend({template:n,events:{"click a[data-date-time-range]":o.handleRangeEvent,submit:function(){return this.changeFilter(),!1},'change input[name="interval"]':function(){this.toggleBucketSize()}},afterRender:function(){t(this.el,this.serializeFormData()),r.toggle(this.$id("interval")),this.toggleBucketSize()},serializeFormData:function(){var t=this.model,i=+t.get("from"),a=+t.get("to");return{interval:t.get("interval"),bucketSize:t.get("bucketSize"),"from-date":i?e.format(i,"YYYY-MM-DD"):"","to-date":a?e.format(a,"YYYY-MM-DD"):""}},changeFilter:function(){var t=o.serialize(this),i={from:t.from?t.from.valueOf():0,to:t.to?t.to.valueOf():0,interval:this.getInterval(),bucketSize:parseInt(this.$id("bucketSize").val(),10)||5};i.from&&i.to&&i.to<=i.from&&(i.to=e.getMoment(i.from).add(1,"none"===i.interval?"day":i.interval).valueOf()),i.from&&this.$id("from-date").val(e.format(i.from,"YYYY-MM-DD")),i.to&&this.$id("to-date").val(e.format(i.to,"YYYY-MM-DD")),this.model.set(i),this.model.trigger("filtered")},getInterval:function(){return r.getValue(this.$id("interval"))},toggleBucketSize:function(){this.$id("bucketSize").prop("disabled","min"!==this.getInterval())}})});