define(["underscore","../broker","../router","../viewport","../user","../core/util/showDeleteFormPage","../data/localStorage"],function(e,a,r,t,s,n,i){"use strict";var o="css!app/minutesForSafetyCards/assets/main",u="i18n!app/nls/minutesForSafetyCards",d=s.auth();r.map("/minutesForSafetyCardCountReport",d,function(e){t.loadPage(["app/minutesForSafetyCards/MinutesForSafetyCardCountReport","app/minutesForSafetyCards/pages/MinutesForSafetyCardCountReportPage",o,"i18n!app/nls/reports",u],function(a,r){return new r({model:a.fromQuery(e.query)})})}),r.map("/minutesForSafetyCards",d,function(e){t.loadPage(["app/minutesForSafetyCards/MinutesForSafetyCardCollection","app/minutesForSafetyCards/pages/MinutesForSafetyCardListPage",o,u],function(a,r){return new r({collection:new a(null,{rqlQuery:e.rql})})})}),r.map("/minutesForSafetyCards/:id",d,function(e){t.loadPage(["app/minutesForSafetyCards/MinutesForSafetyCard","app/minutesForSafetyCards/pages/MinutesForSafetyCardDetailsPage",o,u],function(a,r){return new r({model:new a({_id:e.params.id})})})}),r.map("/minutesForSafetyCards;add",d,function(r){t.loadPage(["app/minutesForSafetyCards/MinutesForSafetyCard","app/minutesForSafetyCards/pages/MinutesForSafetyCardAddFormPage",o,u],function(t,n){var o={owner:s.getInfo()};try{e.assign(o,JSON.parse(i.getItem("MFS_LAST")))}catch(e){}finally{i.removeItem("MFS_LAST")}return r.query.nearMiss?(o.nearMiss=+r.query.nearMiss,a.publish("router.navigate",{url:"/minutesForSafetyCards;add",trigger:!1,replace:!0})):r.query.suggestion&&(o.suggestion=+r.query.suggestion,a.publish("router.navigate",{url:"/minutesForSafetyCards;add",trigger:!1,replace:!0})),new n({model:new t(o)})})}),r.map("/minutesForSafetyCards/:id;edit",d,function(r){t.loadPage(["app/minutesForSafetyCards/MinutesForSafetyCard","app/minutesForSafetyCards/pages/MinutesForSafetyCardEditFormPage",o,u],function(t,s){var n=new t({_id:r.params.id}),o={};try{e.assign(o,JSON.parse(i.getItem("MFS_LAST")))}catch(e){}finally{i.removeItem("MFS_LAST")}r.query.nearMiss?(o.nearMiss=+r.query.nearMiss,a.publish("router.navigate",{url:"/minutesForSafetyCards/"+r.params.id+";edit",trigger:!1,replace:!0})):r.query.suggestion&&(o.suggestion=+r.query.suggestion,a.publish("router.navigate",{url:"/minutesForSafetyCards/"+r.params.id+";edit",trigger:!1,replace:!0}));var u=new s({model:n});return o._id===r.params.id&&u.listenToOnce(n,"sync",function(){e.assign(n.attributes,o)}),u})}),r.map("/minutesForSafetyCards/:id;delete",d,e.partial(n,"app/minutesForSafetyCards/MinutesForSafetyCard",e,e,{baseBreadcrumb:!0}))});