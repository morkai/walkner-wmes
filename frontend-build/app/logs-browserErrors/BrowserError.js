define(["underscore","../time","../core/Model","app/core/templates/userInfo"],function(r,e,s,o){"use strict";function t(r){var e=r.match(/^(.*?)(?: \()?(https?:\/\/.*?)(\/.*?):([0-9]+):([0-9]+)/);return e?{stack:r,fn:e[1],host:e[2],file:e[3],line:+e[4],col:+e[5]}:{stack:r,fn:r,host:"",file:"",line:"",col:""}}return s.extend({urlRoot:"/logs/browserErrors",clientUrlRoot:"#logs/browserErrors",topicPrefix:"logs.browserErrors",privilegePrefix:"LOGS",nlsDomain:"logs-browserErrors",serialize:function(){var r=this.toJSON();return r.time=e.format(r.time,"L, HH:mm:ss"),r.user=o({userInfo:r.user}),r.stack=r.error.stack.map(t),r.source=r.stack[0].file,r.location=r.browser.location.match(/[a-z](\/.*?)$/)[1],r.error=r.error.message,r.appId=r.headers["x-wmes-app"],r},serializeRow:function(){var e=this.serialize();return e.className=e.resolved?"success":"",e.location='<span class="logs-list-location">'+r.escape(e.location)+"</span>",e.error='<span class="logs-list-error">'+r.escape(e.error)+"</span>",e},serializeDetails:function(){return this.toJSON()}},{parseStack:t})});