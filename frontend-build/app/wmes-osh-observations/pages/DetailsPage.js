define(["underscore","app/core/Collection","app/wmes-osh-common/pages/DetailsPage","../ResolutionCollection","../views/ObservationsView","app/wmes-osh-observations/templates/details/page","app/wmes-osh-observations/templates/details/props"],function(e,o,t,i,s,n,r){"use strict";return t.extend({template:n,propsTemplate:r,initialize:function(){t.prototype.initialize.apply(this,arguments),this.once("afterRender",()=>{this.listenTo(this.model,"change:behaviors change:workConditions",e.debounce(this.resolutions.fetch.bind(this.resolutions,{reset:!0}),1))})},remoteTopics:function(){const e=t.prototype.remoteTopics.apply(this,arguments);return e[`${this.model.getTopicPrefix()}.relations.${this.model.id}`]="onRelationsUpdated",e},defineModels:function(){t.prototype.defineModels.apply(this,arguments),this.resolutions=new i(null,{observation:this.model})},defineViews:function(){t.prototype.defineViews.apply(this,arguments),this.behaviorsView=new s({property:"behaviors",model:this.model,resolutions:this.resolutions}),this.workConditionsView=new s({property:"workConditions",model:this.model,resolutions:this.resolutions}),this.setView("#-behaviors",this.behaviorsView),this.setView("#-workConditions",this.workConditionsView)},load:function(e){return e(this.model.fetch(),this.resolutions.fetch({reset:!0}))},onRelationsUpdated:function({relation:e,change:o}){const t=this.resolutions.get(e.rid);t&&t.handleUpdate(o)}})});