define(["underscore","app/core/View","app/wmes-osh-common/dictionaries","app/wmes-osh-observations/templates/details/observations"],function(e,t,i,n){"use strict";return t.extend({template:n,initialize:function(){t.prototype.initialize.apply(this,arguments),this.once("afterRender",()=>{this.listenTo(this.model,`change:${this.options.property}`,e.debounce(this.render,1)),this.listenTo(this.model,"seen",this.onSeen)})},getTemplateData:function(){const e=this.model.getObserver();return{property:this.options.property,observations:this.serializeObservations(),unseen:e.notify&&(e.changes.all||e.changes[this.options.property])}},serializeObservations:function(){return this.model.get(this.property).map(function(e){if(e.resolution._id){const t=new(0,i.TYPE_TO_MODEL[e.resolution.type])({_id:e.resolution._id,rid:e.resolution.rid});e.resolution.url=t.genClientUrl()}return e})},onSeen:function(){this.$(".osh-unseen").removeClass("osh-unseen")}})});