// Copyright (c) 2014, ≈Åukasz Walukiewicz <lukasz@walukiewicz.eu>. Some Rights Reserved.
// Licensed under CC BY-NC-SA 4.0 <http://creativecommons.org/licenses/by-nc-sa/4.0/>.
// Part of the walkner-wmes project <http://lukasz.walukiewicz.eu/p/walkner-wmes>

define(["app/time","app/data/views/OrgUnitDropdownsView","app/core/views/FormView","app/workCenters/templates/form"],function(t,e,i,o){"use strict";return i.extend({template:o,initialize:function(){i.prototype.initialize.call(this),this.orgUnitDropdownsView=new e({orgUnit:e.ORG_UNIT.PROD_FLOW}),this.setView(".orgUnitDropdowns-container",this.orgUnitDropdownsView)},afterRender:function(){i.prototype.afterRender.call(this);var t=this.options.editMode;t&&this.$id("_id").attr("readonly",!0);var e=this.orgUnitDropdownsView;this.listenToOnce(e,"afterRender",function(){e.selectValue(this.model).focus(),e.$id("division").select2("enable",!t),e.$id("subdivision").select2("enable",!t)})},serializeToForm:function(){var e=i.prototype.serializeToForm.call(this);return e.deactivatedAt&&(e.deactivatedAt=t.format(e.deactivatedAt,"YYYY-MM-DD")),e},serializeForm:function(e){var i=t.getMoment(e.deactivatedAt||null);return e.deactivatedAt=i.isValid()?i.toISOString():null,e.prodFlow?e.mrpController=null:e.prodFlow=null,e}})});