define(["../time","../i18n","../core/Model","../data/orderStatuses","./util/resolveProductName","./OperationCollection","./DocumentCollection","./ComponentCollection","app/orderStatuses/util/renderOrderStatusLabel"],function(t,e,o,n,a,r,s,i,u){"use strict";var l=["startDate","finishDate","scheduledStartDate","scheduledFinishDate"],d=["sapCreatedAt","createdAt","updatedAt"];return o.extend({urlRoot:"/orders",clientUrlRoot:"#orders",topicPrefix:"orders",privilegePrefix:"ORDERS",nlsDomain:"orders",labelAttribute:"_id",parse:function(t,e){return(t=o.prototype.parse.call(this,t,e)).operations=new r(t.operations),t.documents=new s(t.documents),t.bom=new i(t.bom),t},toJSON:function(){var t=o.prototype.toJSON.call(this);return t.operations=t.operations?t.operations.toJSON():[],Array.isArray(t.documents)||(t.documents=t.documents&&t.documents.toJSON?t.documents.toJSON():[]),Array.isArray(t.bom)||(t.bom=t.bom&&t.bom.toJSON?t.bom.toJSON():[]),t},serialize:function(o){var r=this.toJSON();r.productName=a(r),l.forEach(function(e){r[e]&&(r[e+"Text"]=t.format(r[e],"LL"))}),d.forEach(function(e){r[e]&&(r[e+"Text"]=t.format(r[e],"LLL"))}),r.unit||(r.unit="PCE"),r.qtyMax||(r.qtyMax=r.qty),r.qty&&(r.qtyUnit=r.qty+" "+r.unit),r.qtyMax&&(r.qtyMaxUnit=r.qtyMax+" "+r.unit),r.qtyDone&&(r.qtyDoneUnit=(r.qtyDone.total||0)+" "+r.unit),r.qtys="",r.qtyDone&&r.qtyDone.total>=0&&(r.qtys+=r.qtyDone.total),r.qty&&(r.qtys.length&&(r.qtys+="/"),r.qtys+=r.qty),r.statusLabels=n.findAndFill(r.statuses).map(u).join(" ");var s=o&&o.delayReasons&&o.delayReasons.get(r.delayReason),i=r.m4;if(r.delayReason=s?s.getLabel():null,i&&(r.m4=e("orders","m4:"+i),r.delayReason)){var y=s.get("drm");y&&(r.m4+=" ("+y+")")}return r.psStatus=r.psStatus&&"unknown"!==r.psStatus?e("orders","psStatus:"+r.psStatus):null,r}})});