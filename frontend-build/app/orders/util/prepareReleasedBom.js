define(["app/time","app/core/templates/userInfo","app/core/util/decimalSeparator"],function(e,o,n){"use strict";return function(r,a){var s=[],t={},c={},m=!1,d=[];return(a||[]).forEach(function(e){e.newComponents.forEach(function(e){c[e._id]||(c[e._id]=[])}),0===e.oldComponents.length&&d.push(e),e.oldComponents.forEach(function(o){t[o._id]||(t[o._id]=[]),t[o._id].push(e),e.newComponents.forEach(function(n){c[n._id].push({compRel:e,oldComponent:o})})})}),(r||[]).forEach(function(r){if(r.attributes&&(r=r.toJSON()),r.nc12){var a=r.qty.toString().split(".");r.qty=[a[0].toString(),a[1]?n+a[1]:""],s.push(r);var d=t[r.nc12];if(d)return m=!0,r.rowClassName="danger",void d.forEach(function(n){n.newComponents.forEach(function(a){s.push({compRel:!0,rowClassName:"success",orderNo:r.orderNo,mrp:r.mrp,nc12:a._id,name:a.name,releasedAt:e.format(n.releasedAt,"L HH:mm"),releasedBy:o({userInfo:n.releasedBy,noIp:!0})})})});var p=c[r.nc12];p&&(m=!0,r.rowClassName="success",p.forEach(function(n){var a=n.compRel;r.releasedAt=e.format(a.releasedAt,"L HH:mm"),r.releasedBy=o({userInfo:a.releasedBy,noIp:!0}),s.push({compRel:!0,rowClassName:"danger",orderNo:r.orderNo,mrp:r.mrp,nc12:n.oldComponent._id,name:n.oldComponent.name})}))}}),d.length&&(m=!0,d.forEach(o=>{o.newComponents.forEach(n=>{s.unshift({compRel:!0,rowClassName:"success",orderNo:"",mrp:"",nc12:n._id,name:n.name,releasedAt:e.format(o.releasedAt,"L HH:mm"),releasedBy:o.releasedBy.label})})})),{colored:m,components:s}}});