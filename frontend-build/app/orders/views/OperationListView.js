// Part of <http://miracle.systems/p/walkner-wmes> licensed under <CC BY-NC-SA 4.0>

define(["underscore","app/core/View","app/orders/templates/operationList"],function(e,t,i){"use strict";function n(e,t){e[t]&&e[t].toLocaleString&&(e[t]=e[t].toLocaleString())}return t.extend({template:i,serialize:function(){var t={};return e.forEach(this.options.summedTimes,function(e,i){t[i]=(Math.round(1e3*e)/1e3).toLocaleString()}),{operations:this.model.get("operations").toJSON().map(function(e){return n(e,"machineSetupTime"),n(e,"laborSetupTime"),n(e,"machineTime"),n(e,"laborTime"),n(e,"sapMachineSetupTime"),n(e,"sapLaborSetupTime"),n(e,"sapMachineTime"),n(e,"sapLaborTime"),e}).sort(function(e,t){return e.no-t.no}),highlighted:this.options.highlighted,summedTimes:t}},afterRender:function(){this.listenToOnce(this.model,"change:operations",this.render)}})});