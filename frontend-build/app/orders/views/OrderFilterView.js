define(["underscore","app/core/util/idAndLabel","app/core/util/forms/dateTimeRange","app/core/views/FilterView","app/data/orderStatuses","app/mrpControllers/util/setUpMrpSelect2","app/orders/templates/filter"],function(t,e,s,i,a,n,r){"use strict";return i.extend({template:r,events:t.assign({"click a[data-date-time-range]":s.handleRangeEvent},i.prototype.events),defaultFormData:{id:"",idType:"_id",mrp:"",statusesIn:"",statusesNin:""},filterList:["mrp","delayReason","statusesIn","statusesNin","limit"],filterMap:{_id:"id",nc12:"id"},termToForm:{scheduledStartDate:s.rqlToForm,_id:function(t,e,s){s.id=Array.isArray(e.args[1])?e.args[1].join(" "):e.args[1],s.idType=t},nc12:"_id","bom.nc12":"_id","documents.nc15":"_id",mrp:function(t,e,s){s[t]=e.args[1].join(",")},delayReason:function(t,e,s){s[t]=e.args[1]},statuses:function(t,e,s){s["all"===e.name?"statusesIn":"statusesNin"]=e.args[1].join(",")}},afterRender:function(){i.prototype.afterRender.call(this),n(this.$id("mrp"),{own:!0,view:this}),this.$id("delayReason").select2({width:"250px",allowClear:!0,placeholder:" ",data:this.delayReasons.map(e)}),this.$id("statusesIn").select2({width:"200px",multiple:!0,data:a.map(e)}),this.$id("statusesNin").select2({width:"200px",multiple:!0,data:a.map(e)})},serializeFormToQuery:function(t){var e=this.$id("id").val().trim().toUpperCase().split(/[^A-Z0-9]+/).filter(function(t){return/^([A-Z0-9]{7}|[0-9]{9}|[0-9]{12}|[0-9]{15})$/.test(t)}),i=this.$('input[name="idType"]:checked').val(),a=this.$id("mrp").val(),n=this.$id("delayReason").val(),r=this.$id("statusesIn").val(),l=this.$id("statusesNin").val();s.formToRql(this,t),e.length&&t.push({name:"in",args:[i,e]}),a.length&&t.push({name:"in",args:["mrp",a.split(",")]}),n.length&&t.push({name:"eq",args:["delayReason",n]}),r.length&&t.push({name:"all",args:["statuses",r.split(",")]}),l.length&&t.push({name:"nin",args:["statuses",l.split(",")]})},showFilter:function(t){return"statuses"===t?(this.showFilter("statusesNin"),void this.showFilter("statusesIn")):"_id"===t||"nc12"===t?(this.$('input[name="idType"][value="'+t+'"]').click(),void this.$id("id").focus()):void i.prototype.showFilter.apply(this,arguments)}})});