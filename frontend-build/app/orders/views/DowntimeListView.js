define(["app/time","app/core/View","app/core/util/embedded","app/prodDowntimes/views/ProdDowntimeListView","app/orders/templates/downtimeList","i18n!app/nls/prodDowntimes"],function(e,t,i,n,o){"use strict";return t.extend({template:o,initialize:function(){this.insertView(".orders-downtimes",new n({collection:this.collection,simple:!0,shiftColumn:!0,autoRefresh:!i.isEnabled(),orderId:this.model.id})),this.once("afterRender",function(){this.listenTo(this.collection,"reset change",this.onChange)})},getTemplateData:function(){return{empty:0===this.collection.length}},afterRender:function(){this.updateTotals()},updateTotals:function(){var t=[],i={},n=Date.now();this.collection.forEach(function(e){var t=e.get("prodLine"),o=Date.parse(e.get("startedAt")),s=(Date.parse(e.get("finishedAt"))||n)-o;i[t]||(i[t]=0),i[t]+=s}),Object.keys(i).forEach(function(n){t.push(n+": "+e.toString(i[n]/1e3))}),this.$id("totals").text(t.join(" | "))},onChange:function(){this.updateTotals(),this.$el.toggleClass("hidden",0===this.collection.length),this.model.trigger("panelToggle")}})});