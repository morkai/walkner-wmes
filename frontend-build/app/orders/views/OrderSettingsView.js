define(["underscore","app/settings/views/SettingsView","app/orders/templates/settings"],function(e,t,s){"use strict";return t.extend({clientUrl:"#orders;settings",template:s,events:e.assign({"change input[data-setting]":function(e){this.updateSetting(e.target.name,e.target.value)}},t.prototype.events),afterRender:function(){t.prototype.afterRender.apply(this,arguments),this.setUpMrps("documents-excludedMrps","orders.documents.excludedMrps"),this.setUpMrps("iptChecker-mrps","orders.iptChecker.mrps")},setUpMrps:function(e,t){this.$id(e).select2({width:"100%",allowClear:!0,multiple:!0,data:[],formatNoMatches:null,minimumResultsForSearch:1,dropdownCssClass:"hidden",tokenizer:function(e,t,s){var i=e,r={};return t.forEach(function(e){r[e.id]=!0}),(e.match(/[A-Z0-9]{3}/gi)||[]).forEach(function(e){i=i.replace(e,""),e=e.toUpperCase(),r[e]||(s({id:e,text:e}),r[e]=!0)}),e===i?null:i.replace(/\s+/," ").trim()}}),this.updateSettingField(this.settings.get(t))},shouldAutoUpdateSettingField:function(e){return!/mrps$/i.test(e.id)},updateSettingField:function(e){if(e&&/mrps$/i.test(e.id)){var t=e.getValue().map(function(e){return{id:e,text:e}});this.$id(e.id.replace("orders.","").replace(".","-")).select2("data",t)}}})});