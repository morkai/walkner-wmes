// Part of <https://miracle.systems/p/walkner-wmes> licensed under <CC BY-NC-SA 4.0>

define(["underscore","app/settings/views/SettingsView","app/orders/templates/settings"],function(e,t,r){"use strict";return t.extend({clientUrl:"#orders;settings",template:r,events:e.extend({"change input[data-setting]":function(e){this.updateSetting(e.target.name,e.target.value)}},t.prototype.events),afterRender:function(){t.prototype.afterRender.apply(this,arguments),this.setUpIptCheckerMrps()},setUpIptCheckerMrps:function(){this.$id("iptChecker-mrps").select2({width:"100%",allowClear:!0,multiple:!0,data:[],formatNoMatches:null,minimumResultsForSearch:1,dropdownCssClass:"hidden",tokenizer:function(e,t,r){var i=e,n={};return t.forEach(function(e){n[e.id]=!0}),(e.match(/[A-Z0-9]{3}/gi)||[]).forEach(function(e){i=i.replace(e,""),e=e.toUpperCase(),n[e]||(r({id:e,text:e}),n[e]=!0)}),e===i?null:i.replace(/\s+/," ").trim()}}),this.updateSettingField(this.settings.get("orders.iptChecker.mrps"))},shouldAutoUpdateSettingField:function(e){return"orders.iptChecker.mrps"!==e.id},updateSettingField:function(e){e&&"orders.iptChecker.mrps"===e.id&&this.$id("iptChecker-mrps").select2("data",e.getValue().map(function(e){return{id:e,text:e}}))}})});