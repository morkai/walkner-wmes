define(["app/i18n","app/time","app/core/Model","app/planning/util/shift"],function(t,e,i,a){"use strict";return i.extend({urlRoot:"/old/wh/lines",clientUrlRoot:"#wh/lines",topicPrefix:"old.wh.lines",privilegePrefix:"WH",nlsDomain:"wh-lines",defaults:function(){return{pickup:{started:{sets:0,qty:0,time:0},finished:{sets:0,qty:0,time:0},total:{sets:0,qty:0,time:0}},available:{qty:0,time:0},redirLine:null,nextShiftAt:null,startedPlan:null,working:!1,mrps:[]}},serialize:function(){return this.toJSON()},serializeRow:function(t){var i=t&&t.currentPlan||a.getPlanDate(Date.now(),!0).valueOf(),n=this.serialize();return n.nextShiftAt=this.serializeNextShiftAt(),n.startedPlan&&""!==n.startedPlan?Date.parse(n.startedPlan)<i?n.startedPlan="<i>"+e.utc.format(i,"L")+"</i>":n.startedPlan=e.utc.format(n.startedPlan,"L"):n.startedPlan="",n},serializeNextShiftAt:function(){var i=this.get("nextShiftAt");if(i){var n=a.getPlanDate(i,!1).format("L"),r=a.getPlanDate(Date.now(),!0).format("L"),l=e.utc.format(i,"LTS"),s=a.getShiftNoFromStartTime(l);i=s?n===r?t("core","SHIFT:"+s):t("core","SHIFT",{date:n,shift:s}):n===r?l:n+", "+l}else i="";return i}})});