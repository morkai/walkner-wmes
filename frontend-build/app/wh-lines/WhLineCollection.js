define(["underscore","app/user","app/core/Collection","app/core/util/getShiftStartInfo","./WhLine"],function(e,n,t,r,i){"use strict";var d=["pickup","components","packaging","redirLine"];return t.extend({model:i,rqlQuery:"sort(_id)&limit(0)",comparator:function(e,n){return e.id.localeCompare(n.id,void 0,{numeric:!0,ignorePunctuation:!0})},handleUpdate:function(n){var t=this,r=!1;return n.added&&t.add(n.added,{merge:!0}),n.deleted&&n.deleted.forEach(function(e){t.remove(e._id)}),n.updated&&n.updated.forEach(function(n){var i=t.get(n._id);i?i.set(n):!r&&e.intersection(Object.keys(n),d).length&&(r=!0)}),r?t.fetch():null}},{can:{manage:function(){return n.isAllowedTo("WH:MANAGE","PLANNING:MANAGE","PLANNING:PLANNER")},redir:function(){return this.manage()}}})});