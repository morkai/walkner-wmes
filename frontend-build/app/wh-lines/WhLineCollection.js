define(["underscore","app/user","app/core/Collection","app/core/util/getShiftStartInfo","./WhLine"],function(e,t,n,r,i){"use strict";var d=["pickup","components","packaging","redirLine"];return n.extend({model:i,rqlQuery:"sort(_id)&limit(0)",comparator:function(e,t){return e.id.localeCompare(t.id,void 0,{numeric:!0,ignorePunctuation:!0})},handleUpdate:function(t){var n=this,r=!1;return t.added&&n.add(t.added,{merge:!0}),t.deleted&&t.deleted.forEach(function(e){n.remove(e._id)}),t.updated&&t.updated.forEach(function(t){var i=n.get(t._id);i?i.set(t):!r&&e.intersection(Object.keys(t),d).length&&(r=!0)}),r?n.fetch():null}},{can:{redir:function(){return t.isAllowedTo("WH:MANAGE","PLANNING:MANAGE","PLANNING:PLANNER")}}})});