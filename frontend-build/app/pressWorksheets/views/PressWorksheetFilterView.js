define(["underscore","app/time","app/core/views/FilterView","app/core/util/forms/dateTimeRange","app/users/util/setUpUserSelect2","app/orgUnits/views/OrgUnitPickerView","app/pressWorksheets/templates/filter"],function(e,t,i,s,r,n,a){"use strict";return i.extend({template:a,events:e.assign({"click a[data-date-time-range]":s.handleRangeEvent},i.prototype.events),defaultFormData:function(){return{shift:0,type:"any",mine:!1,userType:"operators",user:{id:null,text:null}}},termToForm:{date:s.rqlToForm,shift:function(e,t,i){i[e]=t.args[1]},divisions:function(e,t,i){i.divisions="in"===t.name?t.args[1]:[t.args[1]]},"master.id":function(e,t,i){i.userType=e.split(".")[0],i.user.id=t.args[1],null===i.user.text&&(i.user.text=t.args[1])},user:function(e,t,i){i.user.text=t.args[1]},type:"shift",mine:"shift","operator.id":"master.id","operators.id":"master.id"},initialize:function(){i.prototype.initialize.apply(this,arguments),this.setView("#-orgUnit",new n({subdivisionFilter:["press","paintShop"],orgUnitLabels:{prodLine:this.t("pressWorksheets","filter:machine")},orgUnitTerms:{divisions:"division",prodLines:"prodLine"},orgUnitTypes:["division","prodLine"],filterView:this}))},afterRender:function(){i.prototype.afterRender.call(this),this.toggleButtonGroup("shift"),this.toggleButtonGroup("type"),this.toggleButtonGroup("mine"),r(this.$id("user")).select2("data",null===this.formData.user.id?null:this.formData.user)},serializeFormToQuery:function(e){var t=parseInt(this.$("input[name=shift]:checked").val(),10),i=this.$("input[name=type]:checked").val(),r=this.$("input[name=mine]:checked").val(),n=this.$("input[name=userType]:checked").val(),a=this.$id("user").select2("data");s.formToRql(this,e),0!==t&&e.push({name:"eq",args:["shift",t]}),"any"!==i&&e.push({name:"eq",args:["type",i]}),a&&(e.push({name:"eq",args:[n+".id",a.id]}),e.push({name:"eq",args:["user",a.text]})),r&&e.push({name:"eq",args:["mine",1]})}})});