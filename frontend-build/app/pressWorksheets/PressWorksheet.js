// Copyright (c) 2014, ≈Åukasz Walukiewicz <lukasz@walukiewicz.eu>. Some Rights Reserved.
// Licensed under CC BY-NC-SA 4.0 <http://creativecommons.org/licenses/by-nc-sa/4.0/>.
// Part of the walkner-wmes project <http://lukasz.walukiewicz.eu/p/walkner-wmes>

define(["../i18n","../time","../core/Model"],function(e,t,r){function o(e){return e&&e.label?e.label:null}return r.extend({urlRoot:"/pressWorksheets",clientUrlRoot:"#pressWorksheets",topicPrefix:"pressWorksheets",privilegePrefix:"PRESS_WORKSHEETS",nlsDomain:"pressWorksheets",labelAttribute:"rid",defaults:function(){return{rid:null,date:t.format("YYYY-MM-DD"),shift:1,type:"mech",startedAt:null,finishedAt:null,master:null,operator:null,operators:null,orders:null,createdAt:null,creator:null}},serialize:function(){var r=this.toJSON();return r.date=t.format(r.date,"YYYY-MM-DD"),r.shift=e("core","SHIFT:"+r.shift),r.master=o(r.master),r.operator=o(r.operator),r.operators=(r.operators||[]).map(o).filter(function(e){return!!e}),r.creator=o(r.creator),r.createdAt=r.createdAt?t.format(r.createdAt,"LLLL"):null,"paintShop"===r.type&&r.orders&&(r.orders=r.orders.map(function(e){return e.startedAt=t.getMoment(e.startedAt).format("HH:mm:ss"),e.finishedAt=t.getMoment(e.finishedAt).format("HH:mm:ss"),e})),r.type=e("pressWorksheets","PROPERTY:type:"+r.type),r}})});