// Copyright (c) 2014, ≈Åukasz Walukiewicz <lukasz@walukiewicz.eu>. Some Rights Reserved.
// Licensed under CC BY-NC-SA 4.0 <http://creativecommons.org/licenses/by-nc-sa/4.0/>.
// Part of the walkner-wmes project <http://lukasz.walukiewicz.eu/p/walkner-wmes>

define(["../i18n","../time","../core/Model","../core/util/getShiftStartInfo"],function(e,r,t,o){function s(e){return e&&e.label?e.label:null}return t.extend({urlRoot:"/pressWorksheets",clientUrlRoot:"#pressWorksheets",topicPrefix:"pressWorksheets",privilegePrefix:"PRESS_WORKSHEETS",nlsDomain:"pressWorksheets",labelAttribute:"rid",defaults:function(){var e=o(Date.now());return{rid:null,date:r.format(e.moment.valueOf(),"YYYY-MM-DD"),shift:e.shift,type:"mech",divisions:[],prodLines:[],startedAt:null,finishedAt:null,master:null,operator:null,operators:null,orders:null,createdAt:null,creator:null}},serialize:function(){var t=this.toJSON();return t.date=r.format(t.date,"YYYY-MM-DD"),t.shift=e("core","SHIFT:"+t.shift),t.master=s(t.master),t.operator=s(t.operator),t.operators=(t.operators||[]).map(s).filter(function(e){return!!e}),t.creator=s(t.creator),t.createdAt=t.createdAt?r.format(t.createdAt,"LLLL"):null,"paintShop"===t.type&&t.orders&&(t.orders=t.orders.map(function(e){return e.startedAt=r.getMoment(e.startedAt).format("HH:mm:ss"),e.finishedAt=r.getMoment(e.finishedAt).format("HH:mm:ss"),e})),Array.isArray(t.divisions)&&(t.divisions=t.divisions.join("; ")),Array.isArray(t.prodLines)&&(t.prodLines=t.prodLines.join("; ")),t.type=e("pressWorksheets","PROPERTY:type:"+t.type),t}})});