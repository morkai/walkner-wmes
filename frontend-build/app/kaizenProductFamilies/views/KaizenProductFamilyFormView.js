define(["app/core/views/FormView","app/core/util/idAndLabel","app/data/prodFunctions","app/kaizenOrders/dictionaries","app/mrpControllers/util/setUpMrpSelect2","app/kaizenProductFamilies/templates/form","app/kaizenProductFamilies/templates/formCoordSection"],function(t,i,e,o,n,r,c){"use strict";return t.extend({template:r,events:Object.assign({'click [data-action="addCoordSection"]':function(){this.addCoordSection({section:null,funcs:[],mor:"none"})},'click [data-action="removeCoordSection"]':function(t){var i=this.$(t.target).closest("tr");i.find('input[tabindex="-1"]').select2("destroy"),i.remove()}},t.prototype.events),initialize:function(){t.prototype.initialize.call(this),this.coordSectionI=0},afterRender:function(){t.prototype.afterRender.call(this),this.options.editMode&&(this.$id("_id").prop("readonly",!0),this.$id("name").focus()),n(this.$id("mrps"),{width:"100%"}),(this.model.get("coordSections")||[]).forEach(this.addCoordSection,this)},serializeToForm:function(){var t=this.model.toJSON();return t.mrps=(t.mrps||[]).join(","),t},serializeForm:function(t){return t.mrps=(t.mrps||"").split(",").filter(function(t){return!!t.length}),t.coordSections=(t.coordSections||[]).filter(function(t){return!!t.section}).map(function(t){var i=(t.funcs||"").split(",").filter(function(t){return!!t});return{section:t.section,funcs:i,mor:i.length?t.mor:"none"}}),t},addCoordSection:function(t){var n=this.renderPartial(c,{i:this.coordSectionI++,coordSection:t});this.$id("coordSections").append(n),n.find('input[name$=".section"]').select2({width:"300px",data:o.sections.map(i)}),n.find('input[name$=".funcs"]').select2({width:"525px",multiple:!0,data:e.map(i)})}})});