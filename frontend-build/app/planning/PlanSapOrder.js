// Part of <https://miracle.systems/p/walkner-wmes> licensed under <CC BY-NC-SA 4.0>

define(["underscore","../i18n","../time","../core/Model"],function(t,e,n,i){"use strict";function r(e){if(!e)return"";if(!e.text.replace(/[^A-Za-z0-9]+/g,"").length)return"";var n=t.escape(e.text.trim()),i=o[e.source];return i&&(n='<i class="fa '+i+'"></i> '+n),n}var o={ps:"fa-paint-brush",wh:"fa-truck"};return i.extend({getActualOrderData:function(){var t=this.pick(["quantityTodo","statuses"]);return t.quantityDone=this.getQuantityDone(),t},getCommentWithIcon:function(){return r(t.last(this.get("comments")))},getDropZone:function(){var i=this.get("whDropZone"),r=this.get("whTime");return t.isEmpty(i)?"":e("planning","orders:dropZone",{group:t.escape(i),time:n.utc.format(r,"HH:mm")})},getQuantityDone:function(){var t=this.get("quantityDone"),e=this.collection&&this.collection.plan?this.collection.plan.orders.get(this.id).get("operation"):null;return e?t.byOperation[e.no]||0:t.total}},{formatCommentWithIcon:r})});