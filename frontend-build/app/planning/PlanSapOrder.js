define(["underscore","../i18n","../time","../core/Model"],function(t,e,n,i){"use strict";var r={ps:"fa-paint-brush",wh:"fa-truck"};function o(e){if(!e)return"";if(!e.text.replace(/[^A-Za-z0-9]+/g,"").length)return"";var n=t.escape(e.text.trim()),i=r[e.source];return i&&(n='<i class="fa '+i+'"></i> '+n),n}return i.extend({getActualOrderData:function(){var t=this.pick(["quantityTodo","statuses","priority"]);return t.quantityDone=this.getQuantityDone(),t},getCommentWithIcon:function(){return o(t.last(this.get("comments")))},getDropZone:function(){var i=this.get("whDropZone"),r=this.get("whTime");return t.isEmpty(i)?"":e("planning","orders:dropZone",{group:t.escape(i),time:n.utc.format(r,"HH:mm")})},getQuantityDone:function(){var t=this.get("quantityDone"),e=null;if(this.collection&&this.collection.plan){var n=this.collection.plan.orders.get(this.id);n&&(e=n.get("operation"))}return e?t.byOperation[e.no]||0:t.total}},{formatCommentWithIcon:o})});