define(["underscore","../time","../core/Model","../data/localStorage"],function(t,e,s,r){"use strict";return s.extend({defaults:function(){return{minDate:"2017-01-01",maxDate:e.utc.getMoment().startOf("day").add(1,"days").format("YYYY-MM-DD"),division:null,mrps:[],lines:[],orders:[],sets:[],whStatuses:[],psStatuses:[],distStatuses:[],printOrderTimes:!1,useLatestOrderData:!0,useDarkerTheme:!1,wrapLists:!0,lineOrdersList:!1,from:"06:00",to:"06:00",activeMrps:{}}},initialize:function(t,e){this.storageKey=e&&e.storageKey||"PLANNING:DISPLAY_OPTIONS",this.on("change",this.saveToLocalStorage)},saveToLocalStorage:function(){r.setItem(this.storageKey,JSON.stringify(this.attributes))},readFromLocalStorage:function(){this.set(JSON.parse(r.getItem(this.storageKey)||"{}"))},isOrderTimePrinted:function(){return this.attributes.printOrderTimes},togglePrintOrderTime:function(){this.set("printOrderTimes",!this.attributes.printOrderTimes)},isLatestOrderDataUsed:function(){return!0},toggleLatestOrderDataUse:function(){this.set("useLatestOrderData",!this.attributes.useLatestOrderData)},isDarkerThemeUsed:function(){return this.attributes.useDarkerTheme},toggleDarkerThemeUse:function(){this.set("useDarkerTheme",!this.attributes.useDarkerTheme)},isListWrappingEnabled:function(){return!0},toggleListWrapping:function(){this.set("wrapLists",!this.attributes.wrapLists)},isLineOrdersListEnabled:function(){return this.attributes.lineOrdersList},toggleLineOrdersList:function(){this.set("lineOrdersList",!this.attributes.lineOrdersList)},getStartTimeRange:function(t){var s=e.utc.getMoment(t+" "+this.get("from"),"YYYY-MM-DD HH:mm"),r=e.utc.getMoment(t+" "+this.get("to"),"YYYY-MM-DD HH:mm");return s.hours()<6&&s.add(1,"days"),(r.hours()<6||6===r.hours()&&0===r.minutes())&&r.add(1,"days"),{from:s.valueOf(),to:r.valueOf()}}},{fromLocalStorage:function(t,e){var s=new this(null,e);return s.readFromLocalStorage(),t.division&&s.set("division",t.division),["mrps","lines","orders","sets","whStatuses","psStatuses","distStatuses"].forEach(function(e){var r=t[e];Array.isArray(r)&&("sets"===e&&(r=r.map(function(t){return+t})),s.set(e,r))}),["from","to"].forEach(function(e){s.set(e,t[e]||"06:00")}),s}})});