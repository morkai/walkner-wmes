// Part of <https://miracle.systems/p/walkner-wmes> licensed under <CC BY-NC-SA 4.0>

define(["../core/Collection","./PlanMrp"],function(e,t){"use strict";return e.extend({model:t,initialize:function(e,t){this.plan=t&&t.plan},reset:function(t,n){return t||(t=this.createModelsFromSettings()),e.prototype.reset.call(this,t,n)},createModelsFromSettings:function(){var e=this.plan,n=e.displayOptions.get("mrps"),r=e.displayOptions.get("exclude"),i=e.orders.getGroupedByMrp(),s=e.lines.getGroupedByMrp();return e.settings.getDefinedMrpIds().filter(function(e){return 0===n.length||(r?-1===n.indexOf(e):-1!==n.indexOf(e))}).map(function(e){return new t({_id:e,orders:i[e]||[],lines:s[e]||[]})})}})});