define(["../user","../core/Collection","./PlanMrp"],function(e,t,n){"use strict";return t.extend({model:n,initialize:function(e,t){this.plan=t&&t.plan,this.lockedMrps=null,this.lockedLines=null},reset:function(e,n){return e||(e=this.createModelsFromSettings()),t.prototype.reset.call(this,e,n)},createModelsFromSettings:function(){var t=this.plan,i=t.displayOptions.get("division"),r=t.displayOptions.get("activeMrps"),s=[].concat(t.displayOptions.get("mrps")),o=!1;i&&r[i]?s=r[i]:"1"===s[0]?s.shift():"0"===s[0]?(o=!0,s.shift()):"wh"===s[0]?(o=!0,s=t.settings.global.getValue("wh.ignoredMrps",[])):"mine"===s[0]&&(s=e.data.mrps||[]);var l=t.orders.getGroupedByMrp(),p=t.lines.getGroupedByMrp();return t.settings.getDefinedMrpIds().filter(function(e){return 0===s.length||(o?-1===s.indexOf(e):-1!==s.indexOf(e))}).map(function(e){return new n({_id:e,orders:l[e]||[],lines:p[e]||[]})})}})});