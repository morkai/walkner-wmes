// Copyright (c) 2014, ≈Åukasz Walukiewicz <lukasz@walukiewicz.eu>. Some Rights Reserved.
// Licensed under CC BY-NC-SA 4.0 <http://creativecommons.org/licenses/by-nc-sa/4.0/>.
// Part of the walkner-wmes project <http://lukasz.walukiewicz.eu/p/walkner-wmes>

define(["app/i18n","app/user","app/core/util/bindLoadingMessage","app/core/View","app/orders/Order","app/orders/views/OrderDetailsView","../views/XiconfProgramOrderDetailsView","app/xiconfProgramOrders/templates/detailsPage"],function(e,r,i,t,o,a,s,n){return t.extend({template:n,layoutName:"page",remoteTopics:function(){function e(){this.promised(this.model.fetch())}var r={};return r["xiconf.orders.synced"]=e,r["xiconf.orders."+this.model.id+".*"]=e,r},breadcrumbs:function(){return[{label:e.bound("xiconfProgramOrders","BREADCRUMBS:browse"),href:this.model.genClientUrl("base")},this.model.id]},initialize:function(){this.parentOrder=new o(this.model.id),this.programOrder=i(this.model,this),this.parentOrderDetailsView=new a({panelTitle:e("xiconfProgramOrders","PANEL:TITLE:details:parentOrder"),linkOrderNo:r.isAllowedTo("ORDERS:VIEW"),model:this.parentOrder}),this.programOrderDetailsView=new s({model:this.model}),this.setView(".xiconfProgramOrders-parentOrderDetailsContainer",this.parentOrderDetailsView),this.setView(".xiconfProgramOrders-programOrderDetailsContainer",this.programOrderDetailsView)},load:function(e){var r=this,i=this.programOrder.fetch();return i.done(function(){r.parentOrder.set(r.programOrder.get("parentOrder"))}),e(i)}})});