define(["underscore","../i18n","../time","../core/Model"],function(t,n,s,e){"use strict";return e.extend({urlRoot:"/suggestions/reports/reward",nlsDomain:"suggestions",defaults:function(){return{month:null,sections:[],users:[]}},fetch:function(n){return t.isObject(n)||(n={}),n.data=t.assign(n.data||{},t.pick(this.attributes,["month","sections"])),n.data.sections=n.data.sections.join(","),e.prototype.fetch.call(this,n)},genClientUrl:function(){return"/suggestionRewardReport?month="+this.get("month")+"&sections="+this.get("sections")},parse:function(t){return t.users.forEach(function(n){n.total=n.finished+n.kom,n.sections=n.sections.map(function(n){return t.sections[n]||n})}),{users:t.users}},serializeToCsv:function(){var n=["name;finished;kotm;total;sections"];return t.forEach(this.get("users"),function(t){n.push('"'+t.name+'";'+t.finished+";"+t.kom+";"+t.total+';"'+t.sections.join(",")+'"')}),n.join("\r\n")}},{fromQuery:function(n){return new this({month:n.month||s.getMoment().startOf("month").subtract(1,"months").format("YYYY-MM"),sections:t.isEmpty(n.sections)?[]:n.sections.split(",")})}})});