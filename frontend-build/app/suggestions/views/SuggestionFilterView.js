define(["underscore","app/time","app/core/views/FilterView","app/core/util/forms/dateTimeRange","app/users/util/setUpUserSelect2","app/kaizenOrders/dictionaries","app/suggestions/templates/filter","app/core/util/ExpandableSelect"],function(e,t,s,r,a,i,n){"use strict";return s.extend({template:n,events:e.assign({"click a[data-date-time-range]":r.handleRangeEvent,'change input[name="userType"]':"toggleUserSelect2","keyup select":function(e){if(27===e.keyCode)return e.target.selectedIndex=-1,!1},"dblclick select":function(e){e.target.selectedIndex=-1}},s.prototype.events),defaultFormData:function(){return{status:[],section:[],categories:[],productFamily:[],userType:"others",user:null}},termToForm:{date:r.rqlToForm,"owners.id":function(e,t,s){s.userType="owner",s.user=t.args[1]},"observers.user.id":function(e,t,s){"mine"===t.args[1]?(s.userType="mine",s.user=null):"unseen"===t.args[1]?(s.userType="unseen",s.user=null):(s.userType="others",s.user=t.args[1])},status:function(e,t,s){s[e]="in"===t.name?t.args[1]:[t.args[1]]},categories:"status",section:"status",area:"status",productFamily:"status"},serialize:function(){return e.assign(s.prototype.serialize.call(this),{statuses:i.statuses,sections:i.sections.toJSON(),areas:i.areas.toJSON(),categories:e.invoke(i.categories.inSuggestion(),"toJSON"),productFamilies:i.productFamilies.toJSON()})},serializeFormToQuery:function(t){var s=this.$('input[name="userType"]:checked').val(),a=this.$id("user").val();r.formToRql(this,t),"mine"===s||"unseen"===s?t.push({name:"eq",args:["observers.user.id",s]}):a&&t.push({name:"eq",args:["owner"===s?"owners.id":"observers.user.id",a]}),["status","categories","section","area","productFamily"].forEach(function(s){var r=(this.$id(s).val()||[]).filter(function(t){return!e.isEmpty(t)});1===r.length?t.push({name:"eq",args:[s,r[0]]}):r.length&&t.push({name:"in",args:[s,r]})},this)},afterRender:function(){s.prototype.afterRender.call(this),this.$(".is-expandable").expandableSelect(),a(this.$id("user"),{view:this}),this.toggleUserSelect2()},destroy:function(){s.prototype.destroy.call(this),this.$(".is-expandable").expandableSelect("destroy")},toggleUserSelect2:function(){var e=this.$('input[name="userType"]:checked').val();this.$id("user").select2("enable","others"===e||"owner"===e)}})});