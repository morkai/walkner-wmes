define(["js2form","app/user","app/core/View","app/core/util/idAndLabel","app/users/util/setUpUserSelect2","app/kaizenOrders/dictionaries","app/suggestions/templates/rewardReportFilter","app/core/util/ExpandableSelect"],function(e,t,i,r,n,s,o){"use strict";return i.extend({template:o,events:{submit:function(){return this.changeFilter(),!1}},destroy:function(){this.$(".is-expandable").expandableSelect("destroy")},afterRender:function(){e(this.el,this.serializeFormData()),n(this.$id("confirmer"),{view:this,width:"285px"}),n(this.$id("superior"),{view:this,width:"285px"}).select2("enable",this.canChangeSuperior()),this.$id("sections").select2({width:"350px",allowClear:!0,multiple:!0,data:s.sections.filter(function(e){return e.get("active")}).map(r)}),this.$(".is-expandable").expandableSelect()},serializeFormData:function(){var e=this.model;return{month:e.get("month"),confirmer:e.get("confirmer"),superior:e.get("superior"),sections:e.get("sections").join(",")}},changeFilter:function(){var e={month:this.$id("month").val(),confirmer:this.$id("confirmer").val(),superior:this.$id("superior").val(),sections:this.$id("sections").val().split(",").filter(function(e){return!!e})};this.model.set(e),this.model.trigger("filtered")},canChangeSuperior:function(){return!!t.isAllowedTo("SUGGESTIONS:MANAGE","KAIZEN:DICTIONARIES:MANAGE")||(!!(s.settings.getValue("superiorFuncs")||[]).includes(t.data.prodFunction)||s.sections.some(function(e){return e.get("confirmers").some(function(e){return e.id===t.data._id})}))}})});