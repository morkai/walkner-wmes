define(["app/viewport","app/core/views/FormView","app/suggestions/templates/attachments/edit"],function(t,e,n){"use strict";return e.extend({template:n,getTemplateData:function(){return{attachment:this.attachment,kinds:this.model.getAttachmentKinds()}},serializeToForm:function(){return{name:this.attachment.name,kind:this.attachment.kind||"other"}},serializeForm:function(t){const e=this.attachment.name.toLowerCase().match(/\.([A-Za-z0-9]{1,10})$/);return e&&!t.name.trim().toLowerCase().endsWith(e[1])&&(t.name.endsWith(".")||(t.name+="."),t.name+=e[1]),t},onDialogShown:function(){this.$id("name").focus()},request:function(e){return t.msg.saving(),this.ajax({method:"PUT",url:this.model.url(),data:JSON.stringify({attachments:{edited:[{_id:this.attachment._id,name:e.name,kind:e.kind}]}})})},handleFailure:function(){t.msg.saved(),e.prototype.handleFailure.apply(this,arguments)},handleSuccess:function(){t.msg.saved(),t.closeDialog()}})});