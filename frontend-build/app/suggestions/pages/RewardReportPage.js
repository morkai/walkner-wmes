define(["app/core/View","app/kaizenOrders/dictionaries","../RewardReport","../views/RewardReportFilterView","../views/RewardReportView","app/suggestions/templates/rewardReportPage"],function(e,t,i,r,o,n){"use strict";return e.extend({layoutName:"page",template:n,breadcrumbs:function(){return[this.t("BREADCRUMB:reports:base"),this.t("BREADCRUMB:reports:reward")]},actions:function(){var e=this;return[{label:e.t("reward:export:action"),icon:"download",callback:function(){var t=this.querySelector(".btn");t.disabled=!0;var i=e.ajax({type:"POST",url:"/reports;download?filename="+e.t("reward:export:filename",{date:(e.model.get("month")||"0000-00").replace("-","_")}),contentType:"text/csv",data:e.model.serializeToCsv()});i.done(function(e){window.open("/reports;download?key="+e)}),i.always(function(){t.disabled=!1})}},{label:this.t("PAGE_ACTION:settings"),icon:"cogs",privileges:"KAIZEN:DICTIONARIES:MANAGE",href:"#kaizenOrders;settings?tab=reward"}]},initialize:function(){t.bind(this),this.defineViews(),this.setView("#-filter",this.filterView),this.setView("#-report",this.reportView),this.listenTo(this.model,"filtered",this.onFiltered)},defineViews:function(){this.filterView=new r({model:this.model}),this.reportView=new o({model:this.model})},load:function(e){return e(this.model.fetch())},onFiltered:function(){this.promised(this.model.fetch()),this.broker.publish("router.navigate",{url:this.model.genClientUrl(),trigger:!1,replace:!0})}})});