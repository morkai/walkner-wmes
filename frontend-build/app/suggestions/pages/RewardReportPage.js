define(["app/core/View","../RewardReport","../views/RewardReportFilterView","../views/RewardReportView","app/suggestions/templates/rewardReportPage"],function(e,t,i,r,o){"use strict";return e.extend({layoutName:"page",pageId:"suggestionRewardReport",template:o,breadcrumbs:function(){return[this.t("BREADCRUMB:base"),this.t("BREADCRUMB:reports:reward")]},actions:function(){var e=this;return[{label:e.t("reward:export:action"),icon:"download",callback:function(){var t=this.querySelector(".btn");t.disabled=!0;var i=e.ajax({type:"POST",url:"/reports;download?filename="+e.t("reward:export:filename",{date:(e.model.get("month")||"0000-00").replace("-","_")}),contentType:"text/csv",data:e.model.serializeToCsv()});i.done(function(e){window.open("/reports;download?key="+e)}),i.always(function(){t.disabled=!1})}}]},initialize:function(){this.defineViews(),this.setView("#-filter",this.filterView),this.setView("#-report",this.reportView),this.listenTo(this.model,"filtered",this.onFiltered)},defineViews:function(){this.filterView=new i({model:this.model}),this.reportView=new r({model:this.model})},load:function(e){return e(this.model.fetch())},onFiltered:function(){this.promised(this.model.fetch()),this.broker.publish("router.navigate",{url:this.model.genClientUrl(),trigger:!1,replace:!0})}})});