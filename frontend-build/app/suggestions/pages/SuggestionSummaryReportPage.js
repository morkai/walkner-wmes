// Part of <http://miracle.systems/p/walkner-wmes> licensed under <CC BY-NC-SA 4.0>

define(["app/i18n","app/highcharts","app/core/View","app/kaizenOrders/dictionaries","../SuggestionSummaryReport","../views/SuggestionSummaryReportFilterView","../views/SuggestionTableAndChartView","../views/SuggestionAverageDurationChartView","../views/SuggestionSummaryCountChartView","../views/SuggestionSummaryPerUserChartView","app/suggestions/templates/summaryReportPage"],function(e,t,i,s,o,r,n,a,u,m,g){"use strict";return i.extend({layoutName:"page",template:g,breadcrumbs:[e.bound("suggestions","BREADCRUMBS:base"),e.bound("suggestions","BREADCRUMBS:reports:summary")],initialize:function(){this.setView(".filter-container",new r({model:this.model})),this.setView(".suggestions-report-summary-averageDuration",new a({model:this.model})),this.setView(".suggestions-report-summary-count",new u({model:this.model})),this.setView(".suggestions-report-summary-suggestionOwners",new m({metric:"suggestionOwners",model:this.model})),this.listenTo(this.model,"filtered",this.onFiltered),this.listenTo(this.model,"change:total",this.updateSubtitles)},destroy:function(){s.unload()},load:function(e){return s.loaded?e(this.model.fetch()):s.load().then(this.model.fetch.bind(this.model))},afterRender:function(){s.load(),this.updateSubtitles()},onFiltered:function(){this.promised(this.model.fetch()),this.broker.publish("router.navigate",{url:this.model.genClientUrl(),trigger:!1,replace:!0})},updateSubtitles:function(){var i=this.model.get("total");this.$id("averageDuration").html(e("suggestions","report:subtitle:summary:averageDuration",{averageDuration:t.numberFormat(i.averageDuration,2)})),this.$id("count").html(e("suggestions","report:subtitle:summary:count",i.count))}})});