define(["app/core/View","app/core/util/bindLoadingMessage","app/kaizenOrders/dictionaries","../views/engagement/FilterView","../views/engagement/ChartView","../views/engagement/TablesView","app/suggestions/templates/engagement/page"],function(e,t,i,n,s,o,a){"use strict";return e.extend({layoutName:"page",template:a,breadcrumbs:function(){return[this.t("BREADCRUMB:reports:base"),this.t("BREADCRUMB:reports:engagement")]},actions:function(){const e=this;return[{label:e.t("engagement:export:action"),icon:"download",callback:function(){const t=this.querySelector(".btn");t.disabled=!0;const i=e.ajax({type:"POST",url:`/reports;download?filename=${e.t("engagement:export:filename")}`,contentType:"text/csv",data:e.model.serializeToCsv()});i.done(e=>{window.open(`/reports;download?key=${e}`)}),i.always(function(){t.disabled=!1})}}]},initialize:function(){i.bind(this),t(this.model,this),this.setView("#-filter",new n({model:this.model})),this.setView("#-entriesChart",new s({totals:"entries",model:this.model})),this.setView("#-usersChart",new s({totals:"users",model:this.model})),this.setView("#-tables",new o({model:this.model})),this.listenTo(this.model,"filtered",this.onFiltered)},load:function(e){return e("app/dataTables","datatables-fixedcolumns",this.model.fetch())},onFiltered:function(){this.promised(this.model.fetch()),this.broker.publish("router.navigate",{url:this.model.genClientUrl(),trigger:!1,replace:!0})}})});