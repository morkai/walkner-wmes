// Part of <http://miracle.systems/p/walkner-wmes> licensed under <CC BY-NC-SA 4.0>

define(["underscore","../router","../viewport","../user","../core/util/showDeleteFormPage","./Suggestion"],function(e,n,o,s,t,g){"use strict";var u="i18n!app/nls/suggestions",i=s.auth();n.map("/suggestionCountReport",i,function(e){o.loadPage(["app/suggestions/SuggestionCountReport","app/suggestions/pages/SuggestionCountReportPage","i18n!app/nls/reports",u],function(n,o){return new o({model:new n({from:+e.query.from||void 0,to:+e.query.to||void 0,interval:e.query.interval})})})}),n.map("/suggestionSummaryReport",i,function(e){o.loadPage(["app/suggestions/SuggestionSummaryReport","app/suggestions/pages/SuggestionSummaryReportPage","i18n!app/nls/reports",u],function(n,o){return new o({model:n.fromQuery(e.query)})})}),n.map("/suggestionHelp",function(){o.loadPage(["app/core/View","app/suggestions/templates/help",u],function(e,n){return new e({layoutName:"page",template:n})})}),n.map("/suggestions",i,function(e){o.loadPage(["app/suggestions/SuggestionCollection","app/suggestions/pages/SuggestionListPage",u],function(n,o){return new o({collection:new n(null,{rqlQuery:e.rql})})})}),n.map("/suggestions/:id",i,function(e){o.loadPage(["app/suggestions/pages/SuggestionDetailsPage","app/suggestions/views/SuggestionThankYouView",u],function(n,s){var t=new n({model:new g({_id:e.params.id})});return"you"===e.query.thank&&t.once("afterRender",function(){t.broker.publish("router.navigate",{url:"/suggestions/"+t.model.id,trigger:!1,replace:!0}),o.showDialog(new s)}),t})}),n.map("/suggestions;add",i,function(){o.loadPage(["app/suggestions/pages/SuggestionAddFormPage",u],function(e){return new e({model:new g})})}),n.map("/suggestions/:id;edit",i,function(e){o.loadPage(["app/suggestions/pages/SuggestionEditFormPage",u],function(n){return new n({model:new g({_id:e.params.id})})})}),n.map("/suggestions/:id;delete",i,e.partial(t,g,e,e,{baseBreadcrumb:!0}))});