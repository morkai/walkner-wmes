define(["app/i18n","app/viewport"],function(e,o){"use strict";return function(r,s,n,a){return s.listenTo(r,"request",function(r,s,i){"read"===i.syncMethod&&(!1!==i.showLoadingMessage&&o.msg.loading(),s.done(function(e){!1!==e.showLoadingMessage&&o.msg.loaded()}.bind(i)),s.fail(function(r,s){var i=s.statusText;if("abort"===i)return void(!1!==r.showLoadingMessage&&o.msg.loaded());var d=s.responseJSON;d&&d.error&&(d.error.code?i=d.error.code:d.error.message&&(i=d.error.message));!1!==r.showLoadingMessage&&o.msg.loadingFailed(e(a||"core",n||"MSG:LOADING_FAILURE",{code:i}))}.bind(i)))}),r}});