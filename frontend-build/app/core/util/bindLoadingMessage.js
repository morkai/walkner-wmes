define(["app/i18n","app/viewport"],function(e,t){return function(n,i,a,r){return r||(r=n.nlsDomain?n.nlsDomain:n.model.prototype.nlsDomain?n.model.prototype.nlsDomain:"core"),a||(a=n.model?"MSG:LOADING_FAILURE":"MSG:LOADING_SINGLE_FAILURE"),i.listenTo(n,"request",function(e,n,i){"read"===i.syncMethod&&t.msg.loading()}),i.listenTo(n,"sync",function(e,n,i){"read"===i.syncMethod&&t.msg.loaded()}),i.listenTo(n,"error",function(n,i,s){if("read"===s.syncMethod){var o=i.statusText;if("abort"===o)return t.msg.loaded();var l=i.responseJSON;l&&l.error&&(l.error.code?o=l.error.code:l.error.message&&(o=l.error.message)),t.msg.loadingFailed(e(r,a,{code:o}))}}),n}});