define(["app/i18n","app/viewport"],function(e,o){"use strict";return function(r,n,s,a){return n.listenTo(r,"request",function(r,n,i){"read"===i.syncMethod&&(!1!==i.showLoadingMessage&&o.msg.loading(),n.done(function(e){!1!==e.showLoadingMessage&&o.msg.loaded()}.bind(null,i)),n.fail(function(r,n){var i=n.statusText;if("abort"===i)return void(!1!==r.showLoadingMessage&&o.msg.loaded());var d=n.responseJSON;d&&d.error&&(d.error.code?i=d.error.code:d.error.message&&(i=d.error.message));!1!==r.showLoadingMessage&&o.msg.loadingFailed(e(a||"core",s||"MSG:LOADING_FAILURE",{code:i}))}.bind(null,i)))}),r}});