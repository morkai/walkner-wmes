define(["jquery","app/user","../View","app/core/templates/logInForm"],function(e,t,i,n){return i.extend({template:n,events:{submit:"submitForm","keypress input":function(){this.$submitEl.removeClass("btn-danger").addClass("btn-primary")}},destroy:function(){this.$submitEl=null},afterRender:function(){this.$('input[name="login"]').focus(),this.$submitEl=this.$(".logInForm-submit")},submitForm:function(){if(!this.$submitEl.hasClass("btn-primary"))return!1;var i={login:this.$("[name=login]").val(),password:this.$("[name=password]").val(),socketId:this.socket.getId()};if(0===i.login.length||0===i.password.length)return!1;this.$el.addClass("logInForm-loading"),this.$submitEl.attr("disabled",!0);var n=e.ajax({type:"POST",url:this.el.action,data:JSON.stringify(i)}),r=this;return n.done(function(e){r.$submitEl.removeClass("btn-primary").addClass("btn-success"),t.reload(e)}),n.fail(function(){r.$submitEl.removeClass("btn-primary").addClass("btn-danger"),r.$submitEl.attr("disabled",!1),r.$el.removeClass("logInForm-loading"),r.$("[autofocus]").focus()}),!1}})});