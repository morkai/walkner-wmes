// Copyright (c) 2014, ≈Åukasz Walukiewicz <lukasz@walukiewicz.eu>. Some Rights Reserved.
// Licensed under CC BY-NC-SA 4.0 <http://creativecommons.org/licenses/by-nc-sa/4.0/>.
// Part of the walkner-wmes project <http://lukasz.walukiewicz.eu/p/walkner-wmes>

define(["underscore"],function(e){"use strict";var n={};return n.inherits=function(n,t){e.extend(n,t);var o=function(){this.constructor=n};return o.prototype=t.prototype,n.prototype=new o,n.__super__=t.prototype,n},n.decodeUriComponent=function(e){return decodeURIComponent(e.replace(/\+/g," "))},n.defineSandboxedProperty=function(n,t,o){e.isObject(n._sandboxedProperties)||(n._sandboxedProperties={});var r=n._sandboxedProperties,i=n.options[t];return e.isObject(i)?(r[t]=i,n[t]=i,void delete n.options[t]):(r[t]=null,void Object.defineProperty(n,t,{enumerable:!0,configurable:!0,get:function(){return null===r[t]&&(r[t]=o.sandbox()),r[t]},set:function(e){this[t]=e}}))},n.cleanupSandboxedProperties=function(n){var t=n._sandboxedProperties;if(e.isObject(t)){var o=Object.keys(t);o.forEach(function(n){var o=t[n];o&&e.isFunction(o.destroy)&&o.destroy()}),n._sandboxedProperties=null}},n.subscribeTopics=function(n,t,o,r){if(e.isFunction(o)&&(o=o.call(n)),e.isObject(o)&&e.size(o)){var i=n[t];e.each(o,function(t,o){e.isString(t)&&(t=n[t]),r&&(t=t.bind(n)),i.subscribe(o,t)})}},n.escapeRegExp=function(e){return e.replace(/([.*+?^=!:${}()|\[\]\/\\])/g,"\\$1")},n});