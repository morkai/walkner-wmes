define(["underscore","app/i18n"],function(r,e){"use strict";function n(r,n){return e.bound(e.has(r,n)?r:"core",n)}return function(e,a){var t=e.modelProperty?e[e.modelProperty]:e.model||e.collection,i=t.getNlsDomain();if(a=Array.isArray(a)?a.map(function(r){return"string"==typeof r?{label:":"===r[0]?n(i,"BREADCRUMBS"+r):r}:("string"==typeof r.label&&":"===r.label[0]&&(r.label=n(i,"BREADCRUMBS"+r.label)),r)}):[],!1!==e.browseBreadcrumb){var l=a.length?t.genClientUrl("base"):null;if(l){var o=window.location.origin+window.location.pathname+l,s=r.find(JSON.parse(localStorage.WMES_RECENT_LOCATIONS||"[]"),function(r){if(0!==r.href.indexOf(o))return!1;var e=r.href.charAt(o.length);return""===e||"?"===e});if(s){var f=s.href.split("?")[1];f&&(-1===l.indexOf("?")?l+="?"+f:l+="&"+f)}}a.unshift({label:n(i,r.result(e,"browseBreadcrumb")||"BREADCRUMBS:browse"),href:l})}if(!0===e.baseBreadcrumb)a.unshift(n(i,"BREADCRUMBS:base"));else if(e.baseBreadcrumb){var u=r.result(e,"baseBreadcrumb");Array.isArray(u)?a.unshift.apply(a,u):a.unshift({label:n(i,"BREADCRUMBS:base"),href:String(u)})}return a}});