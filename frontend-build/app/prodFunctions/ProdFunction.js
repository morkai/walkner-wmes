// Copyright (c) 2014, ≈Åukasz Walukiewicz <lukasz@walukiewicz.eu>. Some Rights Reserved.
// Licensed under CC BY-NC-SA 4.0 <http://creativecommons.org/licenses/by-nc-sa/4.0/>.
// Part of the walkner-wmes project <http://lukasz.walukiewicz.eu/p/walkner-wmes>

define(["../i18n","../data/companies","../core/Model","app/core/templates/colorLabel"],function(i,o,e,t){return e.extend({urlRoot:"/prodFunctions",clientUrlRoot:"#prodFunctions",topicPrefix:"prodFunctions",privilegePrefix:"DICTIONARIES",nlsDomain:"prodFunctions",labelAttribute:"label",defaults:function(){return{label:"",fteMasterPosition:-1,direct:!1,dirIndirRatio:100,companies:[],color:"#000000"}},serialize:function(){var e=this.toJSON();return e.label||(e.label=e._id),e.dirIndirRatio=e.direct?e.dirIndirRatio.toLocaleString()+" / "+(100-e.dirIndirRatio).toLocaleString():"-",e.direct=i("prodFunctions","direct:"+e.direct),e.companies=(e.companies||[]).map(function(i){var e=o.get(i);return e?e.getLabel():null}).filter(function(i){return!!i}).join("; "),e.companies.length||(e.companies="-"),e.color=t({color:e.color}),e}})});