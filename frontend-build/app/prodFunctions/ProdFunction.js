// Copyright (c) 2014, ≈Åukasz Walukiewicz <lukasz@walukiewicz.eu>. Some Rights Reserved.
// Licensed under CC BY-NC-SA 4.0 <http://creativecommons.org/licenses/by-nc-sa/4.0/>.
// Part of the walkner-wmes project <http://lukasz.walukiewicz.eu/p/walkner-wmes>

define(["../i18n","../data/companies","../core/Model"],function(i,t,n){return n.extend({urlRoot:"/prodFunctions",clientUrlRoot:"#prodFunctions",topicPrefix:"prodFunctions",privilegePrefix:"DICTIONARIES",nlsDomain:"prodFunctions",labelAttribute:"label",defaults:function(){return{label:"",fteMasterPosition:-1,direct:!1,dirIndirRatio:100,companies:[]}},toJSON:function(){var i=n.prototype.toJSON.call(this);return i.label||(i.label=i._id),i},serialize:function(){var n=this.toJSON();return n.dirIndirRatio=n.direct?n.dirIndirRatio.toLocaleString()+" / "+(100-n.dirIndirRatio).toLocaleString():"-",n.direct=i("prodFunctions","direct:"+n.direct),n.companies=(n.companies||[]).map(function(i){var n=t.get(i);return n?n.getLabel():null}).filter(function(i){return!!i}).join("; "),n.companies.length||(n.companies="-"),n}})});