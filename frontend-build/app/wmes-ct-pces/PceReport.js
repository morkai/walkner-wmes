define(["underscore","app/i18n","app/time","app/core/Model","app/core/Collection"],function(t,r,e,o,s){"use strict";return o.extend({urlRoot:"/ct/reports/pce",nlsDomain:"wmes-ct-pces",defaults:function(){return{from:0,to:0,orders:[],lines:[],report:null}},initialize:function(){this.products=new s,this.orders=new s,this.psos=new s,this.on("change:report",this.onReportChange),this.set("report",{stationCount:0,products:[],orders:[],psos:[]})},onReportChange:function(){var t=this.get("report");this.psos.reset(t.psos),this.orders.reset(t.orders),this.products.reset(t.products)},getStationCount:function(){return this.get("report").stationCount},fetch:function(r){return t.isObject(r)||(r={}),r.data=t.assign(r.data||{},t.pick(this.attributes,["from","to","orders","lines"])),Object.keys(r.data).forEach(function(t){Array.isArray(r.data[t])&&(r.data[t]=r.data[t].join(","))}),o.prototype.fetch.call(this,r)},genClientUrl:function(){return"/ct/reports/pce?from="+(this.get("from")||"")+"&to="+(this.get("to")||"")+"&orders="+(this.get("orders")||"")+"&lines="+(this.get("lines")||"")},parse:function(t){return{report:t}}},{fromQuery:function(r){var e={from:+r.from||0,to:+r.to||0};return["orders","lines"].forEach(function(o){e[o]=t.isEmpty(r[o])?[]:r[o].split(",")}),new this(e)}})});