define(["underscore","js2form","app/time","app/core/View","app/core/util/idAndLabel","app/core/util/forms/dateTimeRange","app/mrpControllers/util/setUpMrpSelect2","app/wmes-ct-pces/templates/resultsReport/filter"],function(i,t,n,e,r,a,o,l){"use strict";return e.extend({template:l,events:{"click a[data-date-time-range]":a.handleRangeEvent,submit:function(){return this.changeFilter(),!1}},initialize:function(){this.listenTo(this.model,"mrpConfigChanged",this.onMrpConfigChanged),this.listenTo(this.settings,"change",this.onSettingChange)},afterRender:function(){t(this.el,this.serializeFormData()),this.updatePlaceholders(),o(this.$id("includedMrps"),{width:"500px",view:this,own:!0})},serializeFormData:function(){var i=this.model.attributes;return{"from-date":i.from?n.format(i.from,"YYYY-MM-DD"):"","to-date":i.to?n.format(i.to,"YYYY-MM-DD"):"",includedMrps:Array.isArray(i.includedMrps)?i.includedMrps.join(","):"",minLineWorkDuration:null==i.minLineWorkDuration?"":i.minLineWorkDuration,minUpphWorkDuration:null==i.minUpphWorkDuration?"":i.minUpphWorkDuration,shiftCount:null==i.shiftCount?"":i.shiftCount,availableWorkDuration:null==i.availableWorkDuration?"":i.availableWorkDuration,minMrpUnbalance:null==i.minMrpUnbalance?"":i.minMrpUnbalance,minMrpEfficiency:null==i.minMrpEfficiency?"":i.minMrpEfficiency}},changeFilter:function(){var t=a.serialize(this),n={from:t.from?t.from.valueOf():0,to:t.to?t.to.valueOf():0,includedMrps:this.$id("includedMrps").val().split(",").filter(function(i){return!!i.length}),minLineWorkDuration:parseFloat(this.$id("minLineWorkDuration").val()),minUpphWorkDuration:parseFloat(this.$id("minUpphWorkDuration").val()),shiftCount:parseInt(this.$id("shiftCount").val(),10),availableWorkDuration:parseFloat(this.$id("availableWorkDuration").val()),minMrpUnbalance:parseInt(this.$id("minMrpUnbalance").val(),10),minMrpEfficiency:parseInt(this.$id("minMrpEfficiency").val(),10)};i.forEach(n,function(i,t){(null==i||isNaN(i)&&!Array.isArray(i))&&(n[t]=null)}),this.model.set(n),this.model.trigger("filtered")},updatePlaceholders:function(){var i=this;i.$("input[placeholder]").each(function(){var t=i.settings.get("ct.reports.results."+this.name);if(t){var n=t.getValue();"number"==typeof n&&(this.placeholder=n.toLocaleString())}})},onSettingChange:function(i){/^ct.reports.results/.test(i.id)&&this.updatePlaceholders()},onMrpConfigChanged:function(){this.$('.btn[type="submit"]').first().focus()}})});