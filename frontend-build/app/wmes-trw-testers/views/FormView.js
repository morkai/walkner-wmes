define(["underscore","app/core/views/FormView","../Tester","app/wmes-trw-testers/templates/form"],function(e,i,t,o){"use strict";return i.extend({template:o,events:e.assign({"click #-addIo":function(){this.addIo()},'click [data-action="removeIo"]':function(e){var i=this.$(e.currentTarget).closest("tr");i.fadeOut("fast",function(){i.remove()})}},i.prototype.events),initialize:function(){i.prototype.initialize.apply(this,arguments),this.ioI=0},afterRender:function(){(this.model.get("io")||[]).forEach(this.addIo,this),i.prototype.afterRender.call(this),this.addIo(),this.options.editMode?(this.$id("_id").prop("readonly",!0),this.$id("name").focus()):this.$id("_id").focus()},serialize:function(){return e.assign(i.prototype.serialize.apply(this,arguments),{ioTypes:t.IO_TYPES})},serializeForm:function(e){return e.io||(e.io=[]),e.io.forEach(function(e){e.name||(e.name=e._id),e.device=parseInt(e.device,10),e.channel=parseInt(e.channel,10)}),e.io=e.io.filter(function(e){return!!e._id&&e.device>=0&&e.channel>=0}),e.io.sort(function(e,i){return e.device===i.device?e.channel-i.channel:e.device-i.device}),e},addIo:function(){var e=this.$id("io");this.ioTemplate||(this.ioTemplate=e.html(),e.html(""));var i=this.ioTemplate.replace(/io\[]/g,"io["+this.ioI+"]");e.append(i),++this.ioI}})});