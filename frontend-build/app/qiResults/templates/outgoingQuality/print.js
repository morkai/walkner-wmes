define(["underscore","jquery","app/i18n","app/time","app/user","app/core/util/forms"],function(_,$,t,time,user,forms){return function anonymous(locals,escapeFn,include,rethrow){escapeFn=escapeFn||function(n){return void 0==n?"":String(n).replace(_MATCH_HTML,encode_char)};var _ENCODE_HTML_RULES={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&#34;","'":"&#39;"},_MATCH_HTML=/[&<>'"]/g;function encode_char(n){return _ENCODE_HTML_RULES[n]||n}var __output="";function __append(n){void 0!==n&&null!==n&&(__output+=n)}with(locals||{})__append('<!DOCTYPE html>\n<html>\n<head>\n  <meta charset="utf-8">\n  <title>Outgoing quality</title>\n  <style>\n    @page {\n      size: A4 landscape;\n      margin: 10mm;\n    }\n    * {\n      margin: 0;\n      padding: 0;\n      box-sizing: border-box;\n    }\n    body {\n      color: #000;\n      text-align: center;\n      font-size: 14px;\n      font-family: Arial, sans-serif;\n      line-height: 1;\n      text-rendering: geometricPrecision;\n    }\n    .page {\n      position: relative;\n      width: 100%;\n    }\n    .page + .page {\n      page-break-before: always;\n    }\n    .title {\n      font-size: 24px;\n      font-weight: bold;\n      text-align: left;\n    }\n    .date {\n      position: absolute;\n      top: 0;\n      right: 0;\n      font-size: 24px;\n      text-align: right;\n    }\n    h3 {\n      font-size: 16px;\n      font-weight: bold;\n      line-height: 1.2;\n    }\n    #where-what {\n      display: flex;\n      justify-content: space-between;\n      margin-top: 25px;\n    }\n    table {\n      margin: auto;\n      border-collapse: collapse;\n      border-spacing: 0;\n      border: 1px solid #ccc;\n    }\n    th, td {\n      padding: 5px 5px;\n      border: 1px solid #ccc;\n    }\n    .text-center {\n      text-align: center;\n    }\n    .text-left {\n      text-align: left;\n    }\n    .text-right {\n      text-align: right;\n    }\n    .is-number {\n      font-family: Consolas, monospace;\n      text-align: right;\n    }\n    .overflow {\n      display: block;\n      white-space: nowrap;\n      overflow: hidden;\n      text-overflow: ellipsis;\n      max-width: 310px;\n    }\n    .small {\n      font-weight: normal;\n      font-size: 12px;\n    }\n    ol {\n      list-style-position: inside;\n    }\n    .legend {\n      position: absolute;\n      text-align: left;\n    }\n    .legend-top {\n      top: -10px;\n      left: 10px;\n    }\n    .legend-bot {\n      top: 30px;\n      right: 10px;\n      align-self: end;\n    }\n    .legend-items {\n      padding: 4px 0;\n      border: 1px solid #ccc;\n    }\n    .legend-item {\n      padding: 4px 8px;\n    }\n    .legend-indicator {\n      display: inline-block;\n      width: 10px;\n      height: 10px;\n      background: #000;\n    }\n    .legend-arrow {\n      width: 0;\n      height: 0;\n      border-left: 8px solid transparent;\n      border-right: 8px solid transparent;\n    }\n    .legend-top .legend-arrow {\n      margin-left: auto;\n      text-align: right;\n      border-bottom: 8px solid #ccc;\n    }\n    .legend-bot .legend-arrow {\n      border-top: 8px solid #ccc;\n    }\n    '),function(){__append(".qi-oql h3 {\n  margin: 20px 0 0 0;\n  text-align: center;\n}\n.qi-oql .row {\n  display: flex;\n  margin-top: 10px;\n}\n.qi-oql-table-container {\n  text-align: center;\n}\n.qi-oql-table-container .table {\n  margin: 0 auto;\n  width: auto;\n}\n.qi-oql-table-ppm td[data-key] {\n  position: relative;\n  cursor: pointer;\n  color: #337ab7;\n}\n.qi-oql-table-ppm td[data-key]:hover {\n  color: #23527c;\n}\n.qi-oql-table-ppm form {\n  position: absolute;\n  top: -2px;\n  left: -1px;\n  display: flex;\n  z-index: 1;\n}\n.qi-oql-table-ppm input {\n  width: 75px;\n}\n\n.qi-oql-prop[data-id] {\n  position: relative;\n}\n.qi-oql-results-editor {\n  display: flex;\n  text-align: left;\n  box-shadow: 0 0 16px #ccc;\n  position: absolute;\n  top: 17px;\n  left: 0;\n}\n.qi-oql-results-editor select {\n  width: 150px;\n}\n\n.qi-oql-results {\n  display: flex;\n}\n.qi-oql-result {\n  flex: 1 1 auto;\n  padding-right: 15px;\n  border-right: 1px solid #ccc;\n}\n.qi-oql-result:last-child {\n  padding-right: 0;\n  border-right: none;\n}\n.qi-oql-result + .qi-oql-result {\n  margin-left: 15px;\n}\n.qi-oql-props {\n  display: flex;\n}\n.qi-oql-props + .qi-oql-props {\n  margin-top: 12px;\n}\n.qi-oql-prop + .qi-oql-prop {\n  margin-left: 15px;\n}\n.qi-oql-prop-name {\n  font-weight: bold;\n}\n.qi-oql-prop-value {\n\n}\n")}.call(this),__append('\n    .qi-oql-results {\n      margin-top: 10px;\n      text-align: left;\n    }\n    .qi-oql-result {\n      flex: 1 1 auto;\n      min-width: 33.3%;\n    }\n    .qi-oql-props {\n      line-height: 1.2;\n    }\n    .qi-oql-props + .qi-oql-props {\n      margin-top: 8px;\n    }\n    .qi-oql-prop + .qi-oql-prop {\n      margin-left: 15px;\n    }\n    .qi-oql-prop-name {\n      margin-bottom: 4px;\n      font-weight: bold;\n    }\n    .qi-oql-prop-value {\n      font-size: 12px;\n      line-height: 1.4;\n    }\n    .text-lines {\n      font-size: 10px;\n    }\n  </style>\n</head>\n<body class="qi-oql-printable">\n<div class="page">\n  <div class="title">'),__append(t("BREADCRUMB:reports:outgoingQuality")),__append('</div>\n  <div class="date">'),__append(week),__append("</div>\n  <div>\n    <h3>"),__append(t("report:oql:title:ppm")),__append('</h3>\n    <img src="data:image/png;base64,'),__append(charts.ppm),__append('" width="1031" height="250">\n    <div style="display: flex; position: relative">\n      <div class="legend legend-top">\n        <div class="legend-arrow"></div>\n        <div class="legend-items">\n          <div class="legend-item">\n            <span class="legend-indicator" style="background: #d9534f"></span>\n            <span class="legend-label">'),__append(t("report:oql:ppmOver")),__append('</span>\n          </div>\n          <div class="legend-item">\n            <span class="legend-indicator" style="background: #5cb85c"></span>\n            <span class="legend-label">'),__append(t("report:oql:ppmUnder")),__append('</span>\n          </div>\n          <div class="legend-item">\n            <span class="legend-indicator" style="background: #f00"></span>\n            <span class="legend-label">'),__append(t("report:oql:target")),__append('</span>\n          </div>\n        </div>\n      </div>\n      <table>\n        <thead>\n        <tr>\n          <th class="text-right"></th>\n          '),tables.ppm.forEach(function(n){__append('\n          <th class="text-center">'),__append(n.week),__append("</th>\n          ")}),__append('\n        </tr>\n        </thead>\n        <tbody>\n        <tr>\n          <th class="text-right">'),__append(t("report:oql:series:oqlTarget")),__append("</th>\n          "),tables.ppm.forEach(function(n){__append('\n          <td class="is-number">'),__append(n.target),__append("</td>\n          ")}),__append('\n        </tr>\n        <tr>\n          <th class="text-right">'),__append(t("report:oql:series:oql")),__append("</th>\n          "),tables.ppm.forEach(function(n){__append('\n          <td class="is-number">'),__append(n.oql),__append("</td>\n          ")}),__append('\n        </tr>\n        </tbody>\n      </table>\n      <div class="legend legend-bot">\n        <div class="legend-items">\n          <div class="legend-item">\n            <span class="legend-indicator" style="background: #337ab7"></span>\n            <span class="legend-label">\n              '),__append(t("report:oql:where")),__append("/"),__append(t("report:oql:what")),__append('\n            </span>\n          </div>\n          <div class="legend-item">\n            <span class="legend-indicator" style="background: #f0ad4e"></span>\n            <span class="legend-label">'),__append(t("report:oql:pareto")),__append('</span>\n          </div>\n          <div class="legend-item">\n            <span class="legend-indicator" style="background: #f00"></span>\n            <span class="legend-label">'),__append(t("report:oql:series:oqlTarget")),__append('</span>\n          </div>\n        </div>\n        <div class="legend-arrow"></div>\n      </div>\n    </div>\n  </div>\n  <div id="where-what">\n    <div>\n      <h3>'),__append(t("report:oql:title:where")),__append('</h3>\n      <img src="data:image/png;base64,'),__append(charts.where),__append('">\n      <table>\n        <thead>\n        <tr>\n          <th class="text-right">'),__append(t("report:oql:"+tables.where.property)),__append("</th>\n          "),tables.where.weeks.forEach(function(n){__append('\n          <th class="text-center">'),__append(n),__append("</th>\n          ")}),__append('\n          <th class="text-center"></th>\n        </tr>\n        </thead>\n        <tbody>\n        '),tables.where.rows.forEach(function(n){__append('\n        <tr>\n          <th class="text-right">\n            <span class="overflow">'),__append(escapeFn(n.label)),__append(': <span class="small">'),__append(escapeFn(n.title)),__append("</span></span>\n          </th>\n          "),n.data.forEach(function(n){__append('\n          <td class="is-number" style="width: 46px">\n            '),n.relative&&(__append("\n            "),__append(n.relative),__append("%\n            ")),__append("\n          </td>\n          ")}),__append('\n          <th class="is-number">'),__append(n.total.relative),__append("%</th>\n        </tr>\n        ")}),__append("\n        </tbody>\n      </table>\n    </div>\n    <div>\n      <h3>"),__append(t("report:oql:title:what")),__append('</h3>\n      <img src="data:image/png;base64,'),__append(charts.what),__append('">\n      <table>\n        <thead>\n        <tr>\n          <th class="text-right">'),__append(t("report:oql:"+tables.what.property)),__append("</th>\n          "),tables.what.weeks.forEach(function(n){__append('\n          <th class="text-center">'),__append(n),__append("</th>\n          ")}),__append('\n          <th class="text-center"></th>\n        </tr>\n        </thead>\n        <tbody>\n        '),tables.what.rows.forEach(function(n){__append('\n        <tr>\n          <th class="text-right">\n            <span class="overflow">'),__append(escapeFn(n.label)),__append(': <span class="small">'),__append(escapeFn(n.title)),__append("</span></span>\n          </th>\n          "),n.data.forEach(function(n){__append('\n          <td class="is-number" style="width: 46px">\n            '),n.relative&&(__append("\n            "),__append(n.relative),__append("%\n            ")),__append("\n          </td>\n          ")}),__append('\n          <th class="is-number">'),__append(n.total.relative),__append("%</th>\n        </tr>\n        ")}),__append("\n        </tbody>\n      </table>\n    </div>\n  </div>\n</div>\n"),results.length&&(__append('\n<div class="page">\n  <div class="title">'),__append(t("BREADCRUMB:reports:outgoingQuality")),__append('</div>\n  <div class="date">'),__append(week),__append("</div>\n  <h3>"),__append(t("report:oql:title:results")),__append("</h3>\n  "),canManage=!1,__append("\n  "),function(){__append('<div class="qi-oql-results">\n  '),results.forEach(function(n){__append('\n  <div class="qi-oql-result" data-id="'),__append(n._id),__append('">\n    <div class="qi-oql-props">\n      <div class="qi-oql-prop" data-id="rid">\n        <div class="qi-oql-prop-name">\n          '),__append(t("PROPERTY:rid")),__append("\n          "),canManage&&__append('\n          <a href="javascript:void(0)" data-action="editResults"><i class="fa fa-edit"></i></a>\n          '),__append('\n        </div>\n        <div class="qi-oql-prop-value">'),__append(n.rid),__append('</div>\n      </div>\n      <div class="qi-oql-prop">\n        <div class="qi-oql-prop-name">'),__append(t("PROPERTY:kpi")),__append('</div>\n        <div class="qi-oql-prop-value">'),__append(escapeFn(n.kpi)),__append('</div>\n      </div>\n      <div class="qi-oql-prop">\n        <div class="qi-oql-prop-name">'),__append(t("PROPERTY:site")),__append('</div>\n        <div class="qi-oql-prop-value">'),__append(escapeFn(n.site)),__append('</div>\n      </div>\n      <div class="qi-oql-prop">\n        <div class="qi-oql-prop-name">'),__append(t("PROPERTY:date")),__append('</div>\n        <div class="qi-oql-prop-value">'),__append(n.date),__append('</div>\n      </div>\n    </div>\n    <div class="qi-oql-props">\n      <div class="qi-oql-prop">\n        <div class="qi-oql-prop-name">'),__append(t("PROPERTY:errorCategory")),__append('</div>\n        <div class="qi-oql-prop-value">'),__append(escapeFn(n.errorCategory)),__append('</div>\n      </div>\n      <div class="qi-oql-prop">\n        <div class="qi-oql-prop-name">'),__append(t("PROPERTY:family")),__append('</div>\n        <div class="qi-oql-prop-value">'),__append(escapeFn(n.family)),__append('</div>\n      </div>\n    </div>\n    <div class="qi-oql-props">\n      <div class="qi-oql-prop">\n        <div class="qi-oql-prop-name">'),__append(t("PROPERTY:concern")),__append('</div>\n        <div class="qi-oql-prop-value">'),__append(escapeFn(n.concern)),__append('</div>\n      </div>\n    </div>\n    <div class="qi-oql-props">\n      <div class="qi-oql-prop">\n        <div class="qi-oql-prop-name">'),__append(t("PROPERTY:problem")),__append('</div>\n        <div class="qi-oql-prop-value text-lines">'),__append(escapeFn(n.problem)),__append("</div>\n      </div>\n    </div>\n    "),n.rootCause.forEach(function(n,e){__append('\n    <div class="qi-oql-props">\n      <div class="qi-oql-prop">\n        <div class="qi-oql-prop-name">'),__append(t("PROPERTY:rootCauseN",{n:e+1})),__append('</div>\n        <div class="qi-oql-prop-value">\n          <ol>\n            '),n.forEach(function(n){__append('\n            <li class="text-lines">'),__append(escapeFn(n)),__append("</li>\n            ")}),__append("\n          </ol>\n        </div>\n      </div>\n    </div>\n    ")}),__append('\n    <div class="qi-oql-props">\n      <div class="qi-oql-prop" data-id="standard">\n        <div class="qi-oql-prop-name">\n          '),__append(t("PROPERTY:standard")),__append("\n          "),canManage&&__append('\n          <a href="javascript:void(0)" data-action="editStandard"><i class="fa fa-edit"></i></a>\n          '),__append('\n        </div>\n        <div class="qi-oql-prop-value">'),__append(escapeFn(n.standard||"-")),__append("</div>\n      </div>\n    </div>\n    "),n.correctiveActions.forEach(function(n,e){__append('\n    <div class="qi-oql-props">\n      <div class="qi-oql-prop">\n        <div class="qi-oql-prop-name">'),__append(t("PROPERTY:correctiveActionN",{n:e+1})),__append('</div>\n        <div class="qi-oql-prop-value text-small">'),__append(n.when||"-"),__append(" | "),__append(n.who.join(", ")||""),__append('</div>\n        <div class="qi-oql-prop-value text-lines">'),__append(escapeFn(n.what)),__append("</div>\n      </div>\n    </div>\n    ")}),__append("\n  </div>\n  ")}),__append("\n</div>\n")}.call(this),__append("\n</div>\n")),__append("\n</body>\n</html>\n");return __output}});