define(["underscore","app/core/View","app/reports/util/formatXAxis","app/qiResults/templates/outgoingQuality/paretoTable"],function(t,e,o,a){"use strict";return e.extend({template:a,initialize:function(){this.listenTo(this.model,"change:groups",this.render)},getTemplateData:function(){var e=this,a=e.options.property,i=[],l=e.model.getTopCount(),r=e.model.get("top")||{qtyNok:0},n=r[a]||[],s=e.model.get("groups")||[];return n.forEach(function(o){if(i.length!==l){var n={_id:o[0],label:o[0],title:e.options.resolveTitle?e.options.resolveTitle(o[0]):"",data:[],total:{absolute:o[1],relative:o[2],total:r.qtyNok}};s.forEach(function(e){var o=t.find(e[a],function(t){return t[0]===n._id});o?n.data.push({absolute:o[1],relative:o[2],total:e.qtyNok}):n.data.push({absolute:0,relative:0,total:e.qtyNok})}),n.data[n.data.length-1].absolute&&(n.data=n.data.slice(-3),i.push(n))}}),{property:a,weeks:s.slice(-1*l).map(function(t){return o(e,{value:t.key})}),rows:i}}})});