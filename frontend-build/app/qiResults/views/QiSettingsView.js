define(["underscore","app/core/util/idAndLabel","app/settings/views/SettingsView","../dictionaries","app/qiResults/templates/settings"],function(t,e,i,a,s){"use strict";return i.extend({clientUrl:"#qi/settings",template:s,events:t.assign({"change input[data-setting]":function(t){this.updateSetting(t.target.name,t.target.value)}},i.prototype.events),afterRender:function(){i.prototype.afterRender.apply(this,arguments),this.setUpDefaultErrorCategories(),this.setUpOqlKinds()},setUpDefaultErrorCategories:function(){this.$id("defaultErrorCategory").select2({width:"100%",allowClear:!0,data:a.errorCategories.map(e)}),this.updateSettingField(this.settings.get("qi.defaultErrorCategory"))},setUpOqlKinds:function(){this.$id("oqlKinds").select2({width:"100%",allowClear:!0,multiple:!0,data:a.kinds.map(e)}),this.updateSettingField(this.settings.get("qi.oqlKinds"))},shouldAutoUpdateSettingField:function(t){var e=this.$('[data-setting="'+t.id+'"]');return!e.length||void 0===e[0].dataset.setting},updateSettingField:function(t){if(t&&("qi.oqlKinds"===t.id&&this.$id("oqlKinds").select2("data",t.getValue().map(function(t){var e=a.kinds.get(t);return{id:t,text:e?e.getLabel():t}})),"qi.defaultErrorCategory"===t.id)){var e=t.getValue(),i=a.errorCategories.get(t.getValue());this.$id("defaultErrorCategory").select2("data",{id:e,text:i?i.getLabel():e})}}})});