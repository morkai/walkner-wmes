define(["underscore","jquery","app/core/views/DetailsView","../dictionaries","app/kaizenOrders/templates/details"],function(t,e,i,n,a){"use strict";var s={100:[12,0,0],"010":[0,12,0],"001":[0,0,12],110:[6,6,0],"011":[0,8,4],101:[6,0,6],111:[4,4,4]};return i.extend({template:a,currentTab:null,events:t.assign({'click a[data-toggle="tab"]':function(t){this.currentTab=t.currentTarget.dataset.tab}},i.prototype.events),serialize:function(){var e=this.model.get("types"),n=t.contains(e,"nearMiss"),a=t.contains(e,"suggestion"),r=t.contains(e,"kaizen"),o=s[(n?"1":"0")+(a?"1":"0")+(r?"1":"0")];return t.assign(i.prototype.serialize.call(this),{multi:!!window.KAIZEN_MULTI||this.model.isMulti(),showNearMissPanel:n,showSuggestionPanel:a,showKaizenPanel:r,nearMissColumnSize:o[0],suggestionColumnSize:o[1],kaizenColumnSize:o[2]})},afterRender:function(){i.prototype.afterRender.call(this);var a=this;this.$(".prop[data-dictionary]").each(function(){var e=n[this.dataset.dictionary].get(a.model.get(this.dataset.property));if(e){var i=e.get("description");t.isEmpty(i)||(this.classList.toggle("has-description",!0),this.dataset.description=i)}}),this.$el.popover({container:this.el,selector:".has-description",placement:function(t,e){if(window.innerWidth<=992)return"top";var i=a.$(e).closest(".panel").parent();return i[0]===i.parent().children().last()[0]?"top":"right"},trigger:"hover",content:function(){return this.dataset.description},template:function(){return e(e.fn.popover.Constructor.DEFAULTS.template).addClass("kaizenOrders-details-popover")}}),this.$('a[data-tab="'+(this.currentTab||this.options.initialTab)+'"]').click()}})});