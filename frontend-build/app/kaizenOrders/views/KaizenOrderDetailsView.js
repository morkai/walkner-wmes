// Copyright (c) 2014, ≈Åukasz Walukiewicz <lukasz@walukiewicz.eu>. Some Rights Reserved.
// Licensed under CC BY-NC-SA 4.0 <http://creativecommons.org/licenses/by-nc-sa/4.0/>.
// Part of the walkner-wmes project <http://lukasz.walukiewicz.eu/p/walkner-wmes>

define(["underscore","app/core/views/DetailsView","../dictionaries","app/kaizenOrders/templates/details"],function(e,t,i,n){"use strict";return t.extend({template:n,serialize:function(){var i=this.model.get("types"),n=e.contains(i,"nearMiss"),s=e.contains(i,"suggestion"),a=e.contains(i,"kaizen"),r=12,o=12;return n&&s&&a?(r=4,o=4):n&&s?(r=6,o=6):a&&(r=8,o=8),e.extend(t.prototype.serialize.call(this),{showNearMissPanel:n,showSuggestionPanel:s,showKaizenPanel:a,nearMissColumnSize:r,suggestionColumnSize:o,kaizenColumnSize:4})},afterRender:function(){t.prototype.afterRender.call(this);var n=this.model;this.$(".prop[data-dictionary]").each(function(){var t=i[this.dataset.dictionary].get(n.get(this.dataset.property));if(t){var s=t.get("description");e.isEmpty(s)||(this.classList.toggle("has-description",!0),this.dataset.description=s)}}),this.$el.popover({container:this.el,selector:".has-description",placement:function(){return window.innerWidth<=992?"top":"right"},trigger:"hover",content:function(){return this.dataset.description}})}})});