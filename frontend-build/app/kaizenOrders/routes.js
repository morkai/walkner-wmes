define(["underscore","../broker","../router","../viewport","../user","../core/util/showDeleteFormPage"],function(e,r,a,n,i,s){"use strict";var t="css!app/kaizenOrders/assets/main",o="i18n!app/nls/kaizenOrders",p=i.auth(),d=i.auth("KAIZEN:DICTIONARIES:MANAGE"),u=i.auth("LOCAL","USER");a.map("/kaizenOrders/reports/count",p,function(e){n.loadPage(["app/kaizenOrders/KaizenOrderReport","app/kaizenOrders/pages/KaizenOrderReportPage","css!app/suggestions/assets/main",t,"i18n!app/nls/reports",o],function(r,a){return new a({model:r.fromQuery(e.query)})})}),a.map("/kaizenOrders/reports/summary",p,function(e){n.loadPage(["app/kaizenOrders/KaizenOrderSummaryReport","app/kaizenOrders/pages/KaizenOrderSummaryReportPage","css!app/suggestions/assets/main",t,"i18n!app/nls/reports","i18n!app/nls/suggestions",o],function(r,a){return new a({model:r.fromQuery(e.query)})})}),a.map("/kaizenOrders/reports/metrics",p,function(e){n.loadPage(["app/kaizenOrders/KaizenMetricsReport","app/kaizenOrders/pages/KaizenMetricsReportPage",t,"i18n!app/nls/reports","i18n!app/nls/suggestions",o],function(r,a){return new a({model:r.fromQuery(e.query)})})}),a.map("/kaizenHelp",function(){n.loadPage(["app/core/View","app/kaizenOrders/templates/help",t,o],function(e,r){return new e({layoutName:"page",template:r})})}),a.map("/kaizenOrders",u,function(e){n.loadPage(["app/kaizenOrders/KaizenOrderCollection","app/kaizenOrders/pages/KaizenOrderListPage",t,o],function(r,a){return new a({collection:new r(null,{rqlQuery:e.rql})})})}),a.map("/kaizenOrders/:id",u,function(e){n.loadPage(["app/kaizenOrders/KaizenOrder","app/kaizenOrders/pages/KaizenOrderDetailsPage","app/kaizenOrders/views/KaizenOrderThankYouView",t,o],function(r,a,i){var s=new a({model:new r({_id:e.params.id}),standalone:!!e.query.standalone});return"you"===e.query.thank&&s.once("afterRender",function(){s.broker.publish("router.navigate",{url:"/kaizenOrders/"+s.model.id,trigger:!1,replace:!0}),n.showDialog(new i({model:s.model}))}),s})}),a.map("/kaizenOrders;add",u,function(a){n.loadPage(["app/kaizenOrders/KaizenOrder","app/kaizenOrders/pages/KaizenOrderAddFormPage",t,o],function(n,i){var s=null;try{s=JSON.parse(decodeURIComponent(atob(a.query.operator)))}catch(e){}var t=!!a.query.standalone,o="WMES_STANDALONE_CLOSE_TIMER";t&&void 0===window[o]&&(clearTimeout(window[o]),window.onblur=function(){clearTimeout(window[o]),window[o]=setTimeout(function(){window.close()},6e4)},window.onfocus=function(){clearTimeout(window[o])});var p={};try{e.assign(p,JSON.parse(sessionStorage.getItem("KO_LAST")))}catch(e){}finally{sessionStorage.removeItem("KO_LAST")}return a.query.suggestion&&(p.relatedSuggestion=+a.query.suggestion,r.publish("router.navigate",{url:"/kaizenOrders;add",trigger:!1,replace:!0})),new i({model:new n(p),standalone:t,operator:s})})}),a.map("/kaizenOrders/:id;edit",p,function(a){n.loadPage(["app/kaizenOrders/KaizenOrder","app/kaizenOrders/pages/KaizenOrderEditFormPage",t,o],function(n,i){var s=new n({_id:a.params.id}),t={};try{e.assign(t,JSON.parse(sessionStorage.getItem("KO_LAST")))}catch(e){}finally{sessionStorage.removeItem("KO_LAST")}a.query.suggestion&&(t.relatedSuggestion=+a.query.suggestion,r.publish("router.navigate",{url:"/kaizenOrders/"+a.params.id+";edit",trigger:!1,replace:!0}));var o=new i({model:s});return t._id===a.params.id&&o.listenToOnce(s,"sync",function(){e.assign(s.attributes,t)}),o})}),a.map("/kaizenOrders/:id;delete",p,e.partial(s,"app/kaizenOrders/KaizenOrder",e,e,{baseBreadcrumb:!0})),a.map("/kaizenOrders;settings",d,function(e){n.loadPage(["app/kaizenOrders/pages/KaizenSettingsPage",o],function(r){return new r({initialTab:e.query.tab})})})});