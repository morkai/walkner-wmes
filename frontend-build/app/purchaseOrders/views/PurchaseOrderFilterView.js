// Copyright (c) 2014, ≈Åukasz Walukiewicz <lukasz@walukiewicz.eu>. Some Rights Reserved.
// Licensed under CC BY-NC-SA 4.0 <http://creativecommons.org/licenses/by-nc-sa/4.0/>.
// Part of the walkner-wmes project <http://lukasz.walukiewicz.eu/p/walkner-wmes>

define(["app/core/views/FilterView","app/core/util/fixTimeRange","app/purchaseOrders/templates/filter"],function(e,t,s){return e.extend({template:s,defaultFormData:{_id:"","items.nc12":"",from:"",to:"",status:["open","closed"]},termToForm:{_id:function(e,t,s){s[e]="string"==typeof t.args[1]?t.args[1].replace(/[^0-9]+/g,""):""},open:function(e,t,s){s.status=[t.args[1]?"open":"closed"]},"items.schedule.date":function(e,s,r){t.toFormData(r,s,"date")},"items.nc12":"_id"},afterRender:function(){e.prototype.afterRender.call(this),this.toggleButtonGroup("status")},serializeFormToQuery:function(e){var s=t.fromView(this),r=this.getStatus();s.from&&e.push({name:"ge",args:["items.schedule.date",s.from]}),s.to&&e.push({name:"le",args:["items.schedule.date",s.to]}),null!==r&&e.push({name:"eq",args:["open",r]}),this.serializeRegexTerm(e,"_id",6),this.serializeRegexTerm(e,"items.nc12",12)},getStatus:function(){var e=this.$('[name="status[]"]'),t=e.filter(":checked");return 0===t.length&&(t=e.prop("checked",!0),this.toggleButtonGroup("status")),2===t.length?null:"open"===t[0].value}})});