define(["app/core/View","app/core/pages/createPageBreadcrumbs","app/core/util/pageActions","app/core/util/bindLoadingMessage","app/wmes-osh-common/dictionaries","../views/PropsView","../views/AttachmentsView","../views/HistoryView","app/wmes-osh-nearMisses/templates/details/page"],function(e,t,i,s,o,n,d,h,a){"use strict";return e.extend({template:a,remoteTopics:function(){return{[`osh.nearMisses.updated.${this.model.id}`]:"onModelUpdated"}},breadcrumbs:function(){return t(this,[this.model.getLabel()])},actions:function(){return[i.edit(this.model),i.delete(this.model)]},initialize:function(){o.bind(this),this.defineModels(),this.defineViews(),this.defineBindings()},defineModels:function(){this.model=s(this.model,this)},defineViews:function(){this.propsView=new n({model:this.model}),this.attachmentsView=new d({model:this.model}),this.historyView=new h({model:this.model}),this.setView("#-props",this.propsView),this.setView("#-attachments",this.attachmentsView),this.setView("#-history",this.historyView)},defineBindings:function(){this.once("afterRender",()=>{this.listenTo(this.model,"change",this.onModelChanged)})},load:function(e){return e(this.model.fetch())},setUpLayout:function(e){this.layout=e},onModelUpdated:function(e){console.log("onModelUpdated",e)},onModelChanged:function(){this.layout&&this.layout.setActions(this.actions,this)}})});