define(function(){var t=/([^:])\/+/g,r=function(r){return r.replace(t,"$1/")},s=/[^\:\/]*:\/\/([^\/])*/,u=/^(\/|data:)/;function n(t){return r(t).split("/").reduce(function(t,r,s){return 0===t.length||".."!==r?t.push(r):t.pop(),t},[]).join("/")}function e(t,r,i){if(r=n(r),i=n(i),t.match(u)||t.match(s))return t;t=n(t);var e=i.match(s),c=r.match(s);return!c||e&&e[1]==c[1]&&e[2]==c[2]?o(a(t,r),i):a(t,r)}function a(t,r){if("./"==t.substr(0,2)&&(t=t.substr(2)),t.match(u)||t.match(s))return t;var n=r.split("/"),i=t.split("/");for(n.pop();curPart=i.shift();)".."==curPart?n.pop():n.push(curPart);return n.join("/")}function o(t,r){var s=r.split("/");for(s.pop(),r=s.join("/")+"/",i=0;r.substr(i,1)==t.substr(i,1);)i++;for(;"/"!=r.substr(i,1);)i--;r=r.substr(i+1),t=t.substr(i+1),s=r.split("/");var u=t.split("/");for(out="";s.shift();)out+="../";for(;curPart=u.shift();)out+=curPart+"/";return out.substr(0,out.length-1)}var c=function(t,r,s){for(var u,n,i=/@import\s*((?:"([^"]*)")|(?:'([^']*)'))|url\s*\(\s*(\s*(?:"([^"]*)")|(?:'([^']*)')|[^\)]*\s*)\s*\)/gi;u=i.exec(t);){var a;a=e(n=u[3]||u[2]||u[5]||u[6]||u[4],r,s);var o=u[5]||u[6]?1:0;t=t.substr(0,i.lastIndex-n.length-o-1)+a+t.substr(i.lastIndex-o-1),i.lastIndex=i.lastIndex+(a.length-n.length)}return t};return c.convertURIBase=e,c.absoluteURI=a,c.relativeURI=o,c});