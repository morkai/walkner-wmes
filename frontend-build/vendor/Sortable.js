!function(t){"use strict";"function"==typeof define&&define.amd?define(t):"undefined"!=typeof module&&void 0!==module.exports?module.exports=t():window.Sortable=t()}(function(){"use strict";var t,e,n,o,i,r,s,a,l,h,c="Sortable"+(new Date).getTime(),f=window,d=f.document,u=f.parseInt,p=!!d.createElement("div").dragDrop,g=!1,v=function(t,e){var n=d.createEvent("Event");return n.initEvent(t,!0,!0),n.item=e,n},m=function(t,e,n){t.dispatchEvent(v(e,n||t))},_="onAdd onUpdate onRemove onStart onEnd onFilter".split(" "),D=function(){},E=[].slice,y=[];function S(t,e){this.el=t,this.options=e=e||{};var n={group:Math.random(),store:null,handle:null,draggable:t.children[0]&&t.children[0].nodeName||(/[uo]l/i.test(t.nodeName)?"li":"*"),ghostClass:"sortable-ghost",ignore:"a, img",filter:null};for(var o in n)e[o]=e[o]||n[o];for(var i in _.forEach(function(n){e[n]=b(this,e[n]||D),T(t,n.substr(2).toLowerCase(),e[n])}),t[c]=e.group,this)"_"===i.charAt(0)&&(this[i]=b(this,this[i]));T(t,"mousedown",this._onTapStart),T(t,"touchstart",this._onTapStart),p&&T(t,"selectstart",this._onTapStart),T(t,"dragover",this._onDragOver),T(t,"dragenter",this._onDragOver),y.push(this._onDragOver),e.store&&this.sort(e.store.get(this))}function b(t,e){var n=E.call(arguments,2);return e.bind?e.bind.apply(e,[t].concat(n)):function(){return e.apply(t,n.concat(E.call(arguments)))}}function w(t,e,n){if("*"===e)return t;if(t){n=n||d;var o=(e=e.split(".")).shift().toUpperCase(),i=new RegExp("\\s("+e.join("|")+")\\s","g");do{if(!(""!==o&&t.nodeName!=o||e.length&&((" "+t.className+" ").match(i)||[]).length!=e.length))return t}while(t!==n&&(t=t.parentNode))}return null}function C(t){t.dataTransfer.dropEffect="move",t.preventDefault()}function T(t,e,n){t.addEventListener(e,n,!1)}function N(t,e,n){t.removeEventListener(e,n,!1)}function x(t,e,n){if(t)if(t.classList)t.classList[n?"add":"remove"](e);else{var o=(" "+t.className+" ").replace(/\s+/g," ").replace(" "+e+" ","");t.className=o+(n?" "+e:"")}}function A(t,e,n){if(t&&t.style){if(void 0===n)return d.defaultView&&d.defaultView.getComputedStyle?n=d.defaultView.getComputedStyle(t,""):t.currentStyle&&(n=t.currentStyle),void 0===e?n:n[e];t.style[e]=n+("string"==typeof n?"":"px")}}function O(t,e,n){if(t){var o=t.getElementsByTagName(e),i=0,r=o.length;if(n)for(;i<r;i++)n(o[i],i);return o}return[]}function Y(t){return t.draggable=!1}function X(){g=!1}function I(t){for(var e=t.tagName+t.className+t.src+t.href+t.textContent,n=e.length,o=0;n--;)o+=e.charCodeAt(n);return o.toString(36)}return S.prototype={constructor:S,_applyEffects:function(){x(t,this.options.ghostClass,!0)},_onTapStart:function(e){var i=e.touches&&e.touches[0],r=(i||e).target,s=this.options,h=this.el,c=s.filter;if("function"==typeof c&&c.call(this,r,this))m(h,"filter",r);else if(c&&(c=c.split(",").filter(function(t){return w(r,t.trim(),h)})).length)m(h,"filter",r);else if(s.handle&&(r=w(r,s.handle,h)),(r=w(r,s.draggable,h))&&"selectstart"==e.type&&"A"!=r.tagName&&"IMG"!=r.tagName&&r.dragDrop(),r&&!t&&r.parentNode===h){l=e,n=this.el,o=(t=r).nextSibling,a=this.options.group,t.draggable=!0,s.ignore.split(",").forEach(function(t){O(r,t.trim(),Y)}),i&&(l={target:r,clientX:i.clientX,clientY:i.clientY},this._onDragStart(l,!0),e.preventDefault()),T(d,"mouseup",this._onDrop),T(d,"touchend",this._onDrop),T(d,"touchcancel",this._onDrop),T(this.el,"dragstart",this._onDragStart),T(this.el,"dragend",this._onDrop),T(d,"dragover",C);try{d.selection?d.selection.empty():window.getSelection().removeAllRanges()}catch(t){}m(t,"start")}},_emulateDragOver:function(){if(h){A(e,"display","none");var t=d.elementFromPoint(h.clientX,h.clientY),n=t,o=this.options.group,i=y.length;if(n)do{if(n[c]===o){for(;i--;)y[i]({clientX:h.clientX,clientY:h.clientY,target:t,rootEl:n});break}t=n}while(n=n.parentNode);A(e,"display","")}},_onTouchMove:function(t){if(l){var n=t.touches[0],o="translate3d("+(n.clientX-l.clientX)+"px,"+(n.clientY-l.clientY)+"px,0)";h=n,A(e,"webkitTransform",o),A(e,"mozTransform",o),A(e,"msTransform",o),A(e,"transform",o),t.preventDefault()}},_onDragStart:function(o,i){var r=o.dataTransfer;if(this._offUpEvents(),i){var s,a=t.getBoundingClientRect(),l=A(t);A(e=t.cloneNode(!0),"top",a.top-u(l.marginTop,10)),A(e,"left",a.left-u(l.marginLeft,10)),A(e,"width",a.width),A(e,"height",a.height),A(e,"opacity","0.8"),A(e,"position","fixed"),A(e,"zIndex","100000"),n.appendChild(e),s=e.getBoundingClientRect(),A(e,"width",2*a.width-s.width),A(e,"height",2*a.height-s.height),T(d,"touchmove",this._onTouchMove),T(d,"touchend",this._onDrop),T(d,"touchcancel",this._onDrop),this._loopId=setInterval(this._emulateDragOver,150)}else r.effectAllowed="move",r.setData("Text",t.textContent),T(d,"drop",this._onDrop);setTimeout(this._applyEffects)},_onDragOver:function(n){if(!g&&a===this.options.group&&(void 0===n.rootEl||n.rootEl===this.el)){var o=this.el,l=w(n.target,this.options.draggable,o);if(0===o.children.length||o.children[0]===e||o===n.target&&function(t,e){var n=t.lastElementChild.getBoundingClientRect();return e.clientY-(n.top+n.height)>5}(o,n))o.appendChild(t);else if(l&&l!==t&&void 0!==l.parentNode[c]){i!==l&&(i=l,r=A(l),s=l.getBoundingClientRect());var h,f=s,d=f.right-f.left,u=f.bottom-f.top,p=/left|right|inline/.test(r.cssFloat+r.display),v=l.offsetWidth>t.offsetWidth,m=l.offsetHeight>t.offsetHeight,_=(p?(n.clientX-f.left)/d:(n.clientY-f.top)/u)>.5,D=l.nextElementSibling;g=!0,setTimeout(X,30),(h=p?l.previousElementSibling===t&&!v||_&&v:D!==t&&!m||_&&m)&&!D?o.appendChild(t):l.parentNode.insertBefore(t,h?D:l)}}},_offUpEvents:function(){N(d,"mouseup",this._onDrop),N(d,"touchmove",this._onTouchMove),N(d,"touchend",this._onDrop),N(d,"touchcancel",this._onDrop)},_onDrop:function(s){clearInterval(this._loopId),N(d,"drop",this._onDrop),N(d,"dragover",C),N(this.el,"dragend",this._onDrop),N(this.el,"dragstart",this._onDragStart),N(this.el,"selectstart",this._onTapStart),this._offUpEvents(),s&&(s.preventDefault(),s.stopPropagation(),e&&e.parentNode.removeChild(e),t&&(Y(t),x(t,this.options.ghostClass,!1),n.contains(t)?t.nextSibling!==o&&m(t,"update"):(m(n,"remove",t),m(t,"add")),m(t,"end")),n=t=e=o=l=h=i=r=a=null,this.options.store&&this.options.store.set(this))},toArray:function(){for(var t,e=[],n=this.el.children,o=0,i=n.length;o<i;o++)t=n[o],e.push(t.getAttribute("data-id")||I(t));return e},sort:function(t){var e={},n=this.el;this.toArray().forEach(function(t,o){e[t]=n.children[o]}),t.forEach(function(t){e[t]&&(n.removeChild(e[t]),n.appendChild(e[t]))})},closest:function(t,e){return w(t,e||this.options.draggable,this.el)},destroy:function(){var t=this.el,e=this.options;_.forEach(function(n){N(t,n.substr(2).toLowerCase(),e[n])}),N(t,"mousedown",this._onTapStart),N(t,"touchstart",this._onTapStart),N(t,"selectstart",this._onTapStart),N(t,"dragover",this._onDragOver),N(t,"dragenter",this._onDragOver),Array.prototype.forEach.call(t.querySelectorAll("[draggable]"),function(t){t.removeAttribute("draggable")}),y.splice(y.indexOf(this._onDragOver),1),this._onDrop(),this.el=null}},S.utils={on:T,off:N,css:A,find:O,bind:b,closest:w,toggleClass:x,createEvent:v,dispatchEvent:m},S.version="0.5.0",S});