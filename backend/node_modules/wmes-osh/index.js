// Part of <https://miracle.systems/p/walkner-wmes> licensed under <CC BY-NC-SA 4.0>

'use strict';

exports.DEFAULT_CONFIG = {
  mongooseId: 'mongoose',
  expressId: 'express',
  userId: 'user',
  settingsId: 'settings'
};

exports.models = [
  require('./models/oshWorkplace'),
  require('./models/oshDivision'),
  require('./models/oshBuilding'),
  require('./models/oshEventCategory'),
  require('./models/oshReasonCategory'),
  require('./models/oshNearMiss')
];

exports.modelPlugins = {
  User: require('./plugins/user')
};

exports.republishTopics = [
  'osh.workplaces.added', 'osh.workplaces.edited', 'osh.workplaces.deleted',
  'osh.divisions.added', 'osh.divisions.edited', 'osh.divisions.deleted',
  'osh.buildings.added', 'osh.buildings.edited', 'osh.buildings.deleted',
  'osh.eventCategories.added', 'osh.eventCategories.edited', 'osh.eventCategories.deleted',
  'osh.reasonCategories.added', 'osh.reasonCategories.edited', 'osh.reasonCategories.deleted'
];

exports.recordTopics = {
  debug: [
    'osh.workplaces.added', 'osh.workplaces.edited',
    'osh.divisions.added', 'osh.divisions.edited',
    'osh.buildings.added', 'osh.buildings.edited',
    'osh.eventCategories.added', 'osh.eventCategories.edited',
    'osh.reasonCategories.added', 'osh.reasonCategories.edited'
  ],
  warning: [
    'osh.workplaces.deleted',
    'osh.divisions.deleted',
    'osh.buildings.deleted',
    'osh.eventCategories.deleted',
    'osh.reasonCategories.deleted'
  ]
};

exports.userPrivileges = [
  'OSH:DICTIONARIES:VIEW', 'OSH:DICTIONARIES:MANAGE'
];

exports.optionalModules = {
  'mongoose user express settings': require('./routes')
};

exports.start = (app, module) =>
{
  module.DICTIONARIES = {
    workplaces: {model: module.OshWorkplace},
    divisions: {model: module.OshDivision},
    buildings: {model: module.OshBuilding},
    eventCategories: {model: module.OshEventCategory},
    reasonCategories: {model: module.OshReasonCategory}
  };
};
