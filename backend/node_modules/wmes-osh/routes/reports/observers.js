// Part of <https://miracle.systems/p/walkner-wmes> licensed under <CC BY-NC-SA 4.0>

'use strict';

const observersReport = require('wmes-osh/reports/observers');

module.exports = (app, {reports}, req, res, next) =>
{
  const options = {
    conditions: req.rql.selector.args
  };

  reports.helpers.generateReport(
    app,
    reports,
    observersReport,
    'wmes-osh/observers',
    req.reportHash,
    options,
    (err, reportJson) =>
    {
      if (err)
      {
        return next(err);
      }

      res.type('json');
      res.send(reportJson);
    }
  );
};
