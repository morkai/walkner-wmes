var navigator_ = _.pick(window.navigator, [
  `cookieEnabled`,
  `deviceMemory`,
  `hardwareConcurrency`,
  `languages`,
  `maxTouchPoints`,
  `onLine`,
  `platform`,
  `userAgent`,
  `vendor`
]);

navigator_.mimeTypes = [];
navigator_.plugins = [];

for (var i = 0; i < window.navigator.mimeTypes.length; ++i)
{
  navigator_.mimeTypes.push(window.navigator.mimeTypes[i].type);
}

for (var i = 0; i < window.navigator.plugins.length; ++i)
{
  navigator_.plugins.push(window.navigator.plugins[i].name);
}

var screen_ = _.pick(window.screen, [
  `availWidth`,
  `availHeight`,
  `availTop`,
  `availLeft`,
  `width`,
  `height`,
  `pixelDepth`,
  `colorDepth`
]);

screen_.innerWidth = window.innerWidth;
screen_.innerHeight = window.innerHeight;
screen_.orientation = {
  type: window.screen.type,
  angle: window.screen.angle
};

var sosEntry = {
  sender: {
    id: user.data._id,
    label: user.getLabel(),
    ip: user.data.ipAddress,
    privileges: user.data.privileges,
    headers: {},
    navigator: navigator_,
    screen: screen_,
    locations: JSON.parse(localStorage.WMES_RECENT_LOCATIONS || `[]`),
    date: {
      locale: new Date().toLocaleString(),
      utc: new Date().toISOString()
    }
  }
};
