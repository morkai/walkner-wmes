// Part of <https://miracle.systems/p/walkner-wmes> licensed under <CC BY-NC-SA 4.0>

'use strict';

exports.name = 'TrwBase';

exports.setUp = (app, mongoose) =>
{
  const clusterSchema = new mongoose.Schema({
    _id: String,
    label: {
      text: String,
      position: String
    },
    top: Number,
    left: Number,
    rows: [{}]
  }, {
    id: false,
    minimize: false
  });

  const baseSchema = new mongoose.Schema({
    name: {
      type: String,
      required: true,
      trim: true
    },
    tester: {
      type: mongoose.Schema.Types.ObjectId,
      ref: 'TrwTester',
      required: true
    },
    clusters: [clusterSchema]
  }, {
    id: false,
    minimize: false
  });

  baseSchema.statics.TOPIC_PREFIX = 'trw.bases';
  baseSchema.statics.DICTIONARY_FIELDS = {name: 1};

  mongoose.model(exports.name, baseSchema);
};
