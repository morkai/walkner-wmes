<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Picklista malarnii set <%- date %>, <%- set %></title>
  <style>
    @page {
      size: A4 portrait;
      margin: 0;
    }
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-size: 3.2mm;
      text-rendering: optimizeLegibility;
      -webkit-text-rendering: optimizeLegibility;
    }
    body {
      font-family: Arial, sans-serif;
      line-height: 1;
    }
    .page {
      width: 210mm;
      height: 296mm;
      padding: 10mm 10mm 10mm 10mm;
      border: 0mm solid #000;
      page-break-inside: avoid;
    }
    .page:first-child {

    }
    .page + .page {
      page-break-before: always;
    }
    #hd {
      display: flex;
      padding-bottom: 4mm;
      margin-bottom: 4mm;
      border-bottom: 0.5mm solid #000;
      overflow: hidden;
    }
    #bd {
      height: 257mm;
      overflow: hidden;
    }
    thead {
      display: table-row-group;
    }
    #title {
      margin-right: 6mm;
      font-size: 9mm;
      white-space: nowrap;
    }
    #props {
      display: flex;
      margin-left: auto;
    }
    .prop + .prop {
      margin-left: 3mm;
    }
    .prop-value {
      margin-top: 1mm;
      font-size: 4mm;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: clip;
      max-width: 72mm;
    }
    #orders {
      width: 100%;
      border-collapse: collapse;
      line-height: 1.4;
    }
    #orders thead td {
      padding-bottom: 1mm;
      font-weight: bold;
    }
    #orders td {
      padding-left: 4mm;
      width: 1mm;
      white-space: nowrap;
    }
    #orders td:first-child {
      padding-left: 0;
    }
    #orders td:last-child {
      width: auto;
    }
    #orders thead td:last-child {
      text-align: right;
    }
    #orders .order-qty {
      text-align: right;
    }
    #orders .order-carts {
      white-space: normal;
      vertical-align: top;
      text-align: right;
    }
    #orders .order-comments td {
      padding: 3mm 0 3mm 0;
      white-space: normal;
      border-bottom: 0.5mm solid #000;
    }
    #orders .order-comments td:empty {
      padding-top: 0;
    }
    #orders .order-comments:last-child td {
      padding-bottom: 0;
      border-bottom: 0;
    }
    .order-comments + .order-line td {
      padding-top: 3mm;
    }
    .is-ignored {
      text-decoration: line-through;
    }
  </style>
</head>
<body>
<div class=page>
  <div id=hd>
    <div id=title>Picklista malarnii</div>
    <div id=props>
      <div class=prop>
        <div class=prop-name>Plan</div>
        <div class=prop-value><%- date %></div>
      </div>
      <div class=prop>
        <div class=prop-name>Set</div>
        <div class=prop-value><%- set %></div>
      </div>
      <div class=prop>
        <div class=prop-name>MRP</div>
        <div class=prop-value><%- mrp %></div>
      </div>
      <div class=prop>
        <div class=prop-name>Kompletujący</div>
        <div class=prop-value><%- user %></div>
      </div>
    </div>
  </div>
  <div id=bd>
    <table id=orders>
      <thead>
      <tr>
        <td>Zlecenie</td>
        <td>12NC</td>
        <td colspan=2>Ilość</td>
        <td>Nazwa</td>
        <td>Wózki:</td>
      </tr>
      <tbody>
      <% orders.forEach((order, orderI) => { %>
        <% order.lines.forEach((line, lineI) => { %>
        <tr class="order-line <%- line.ignored ? 'is-ignored' : '' %>">
          <td class=order-no><%- line.orderNo %></td>
          <td class=order-code><%- line.nc12 %></td>
          <td class=order-qty><%- line.qty %></td>
          <td class=order-unit><%- line.unit %></td>
          <td class=order-name><%= line.name %></td>
          <% if (lineI === 0) { %>
          <td class=order-carts rowspan="<%- order.lines.length %>"><%= order.carts.join(', ') %></td>
          <% } %>
        </tr>
        <% }) %>
        <tr class=order-comments>
          <td colspan=6><%= order.comments.join(' ■ ') %></td>
        </tr>
      <% }) %>
      </tbody>
    </table>
  </div>
</div>
</body>
</html>
