// Part of <https://miracle.systems/p/walkner-wmes> licensed under <CC BY-NC-SA 4.0>

'use strict';

module.exports = async (app, {OldWhEvent: WhEvent}, {data, user, session}) =>
{
  const events = [{
    type: 'setContinued',
    user,
    time: new Date(),
    order: null,
    data: {
      set: data.assignedOrder.set,
      user: data.whUser
    }
  }];
  const {messages} = await WhEvent.record(events, session);

  await session.commitTransaction();

  return {
    response: {
      result: 'continueSet',
      set: data.assignedOrder.set,
      user: data.whUser
    },
    messages
  };
};
