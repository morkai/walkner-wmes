// Part of <https://miracle.systems/p/walkner-wmes> licensed under <CC BY-NC-SA 4.0>

'use strict';

exports.name = 'ComponentLabel';

exports.setUp = (app, mongoose) =>
{
  const componentLabelSchema = new mongoose.Schema({
    operationNo: {
      type: String,
      required: true
    },
    componentCode: {
      type: String,
      required: true
    },
    description: String,
    template: {
      type: String,
      match: /^[A-Za-z0-9]{1,30}$/,
      required: true
    }
  }, {
    id: false
  });

  componentLabelSchema.statics.TOPIC_PREFIX = 'componentLabels';
  componentLabelSchema.statics.BROWSE_LIMIT = 100;

  componentLabelSchema.index({operationNo: 1, componentCode: 1}, {unique: true});
  componentLabelSchema.index({componentCode: 1});

  mongoose.model(exports.name, componentLabelSchema);
};
