// Part of <https://miracle.systems/p/walkner-wmes> licensed under <CC BY-NC-SA 4.0>

'use strict';

const _ = require('lodash');
const printHidLabel = require('../printHidLabel');

module.exports = (app, module, req, res, next) =>
{
  const data = req.body;

  if (!_.isString(data.requestId) || _.isEmpty(data.requestId)
    || !_.isString(data.prodLine) || _.isEmpty(data.prodLine)
    || !/^[0-9]{9}$/.test(data.orderNo)
    || !_.isNumber(data.serialNo) || data.serialNo <= 0 || data.serialNo > 9999)
  {
    return next(app.createError('Invalid input.', 'INPUT', 400));
  }

  printHidLabel(app, module, data, (err) =>
  {
    if (err)
    {
      return next(err);
    }

    res.sendStatus(204);
  });
};
