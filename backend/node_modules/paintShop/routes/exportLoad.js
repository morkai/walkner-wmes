// Part of <https://miracle.systems/p/walkner-wmes> licensed under <CC BY-NC-SA 4.0>

'use strict';

module.exports = (app, module, req, res, next) =>
{
  const {
    express,
    PaintShopLoad
  } = module;

  const options = {
    filename: 'WMES-PAINT_SHOP-LOAD',
    freezeRows: 1,
    freezeColumns: 1,
    columns: {
      time: {type: 'datetime', width: 18},
      cabin: 'integer',
      duration: {type: 'decimal'}
    },
    serializeRow: doc =>
    {
      return {
        time: doc._id.ts,
        cabin: doc._id.c,
        duration: doc.d / 1000
      };
    },
    batchSize: 100,
    model: PaintShopLoad
  };

  express.crud.exportRoute(app, options, req, res, next);
};
