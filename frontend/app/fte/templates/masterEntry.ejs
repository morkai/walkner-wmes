<div>
  <div class="well">
    <div class="fte-property">
      <span class="fte-property-name"><%- t('core', 'ORG_UNIT:subdivision') %></span>
      <span class="fte-property-value"><%- subdivision %></span>
    </div>
    <div class="fte-property">
      <span class="fte-property-name"><%- t('fte', 'property:date') %></span>
      <span class="fte-property-value"><%- date %></span>
    </div>
    <div class="fte-property">
      <span class="fte-property-name"><%- t('fte', 'property:shift') %></span>
      <span class="fte-property-value"><%- t('core', 'SHIFT:' + shift) %></span>
    </div>
  </div>
  <div class="panel panel-primary">
    <div class="panel-heading"><%- t('fte', 'masterEntry:tasksPanel:title' + (editable ? ':editable': '')) %></div>
    <table class="table table-bordered table-condensed table-hover fte-masterEntry">
      <thead>
      <tr>
        <th><%- t('fte', 'masterEntry:column:task') %>
        <th class="even"><%- t('fte', 'masterEntry:column:noPlan') %>
        <th colspan="2"><%- t('fte', 'masterEntry:column:total') %></th>
        <% Object.keys(totalByProdFunction).forEach(function(prodFunctionId, functionIndex) { %>
        <th class="<%- functionIndex % 2 ? '' : 'even' %>" colspan="<%- Object.keys(totalByProdFunction[prodFunctionId].companies).length %>"><%- t('users', 'PROD_FUNCTION:' + prodFunctionId) %></th>
        <% }) %>
      </tr>
      </thead>
      <thead>
      <tr>
        <th>
        <th class="even">
        <th colspan="<%- companyCount %>" class="fte-masterEntry-total"><%- total %>
        <% Object.keys(totalByProdFunction).forEach(function(prodFunctionId, functionIndex) { %>
        <th class="fte-masterEntry-total-prodFunction <%- functionIndex % 2 ? '' : 'even' %>" colspan="<%- Object.keys(totalByProdFunction[prodFunctionId].companies).length %>" class="fte-masterEntry-total-prodFunction" data-functionId="<%- prodFunctionId %>"><%- totalByProdFunction[prodFunctionId].total %>
        <% }) %>
      </tr>
      </thead>
      <thead>
      <tr>
        <th>
        <th class="even">
        <% Object.keys(totalByCompany).forEach(function(companyId) { %>
        <th><%- totalByCompany[companyId].name %>
        <% }) %>
        <% Object.keys(totalByProdFunction).forEach(function(prodFunctionId, functionIndex) { %>
        <% Object.keys(totalByProdFunction[prodFunctionId].companies).forEach(function(companyId) { %>
        <th class="<%- functionIndex % 2 ? '' : 'even' %>"><%= totalByCompany[companyId].name %>
        <% }) %>
        <% }) %>
      </tr>
      </thead>
      <thead>
      <tr>
        <th>
        <th class="even">
        <% Object.keys(totalByCompany).forEach(function(companyId) { %>
        <th class="fte-masterEntry-total-company" data-companyId="<%- companyId %>"><%- totalByCompany[companyId].total %>
        <% }) %>
        <% Object.keys(totalByProdFunction).forEach(function(prodFunctionId, functionIndex) { %>
        <% Object.keys(totalByProdFunction[prodFunctionId].companies).forEach(function(companyId) { %>
        <th class="fte-masterEntry-total-prodFunction-company <%- functionIndex % 2 ? '' : 'even' %>" data-functionId="<%- prodFunctionId %>" data-companyId="<%- companyId %>"><%- totalByProdFunction[prodFunctionId].companies[companyId] %>
        <% }) %>
        <% }) %>
      </tr>
      </thead>
      <tbody>
      <% tasks.forEach(function(task, taskIndex) { %>
      <tr>
        <td>
          <% if (task.type === 'prodFlow') { %>
          <%= task.name %>
          <% } else { %>
          <em><%= task.name %></em>
          <% } %>
        <td class="even <% if (editable) { %>fte-masterEntry-noPlan-container<% } %>">
          <% if (editable) { %>
          <input class="fte-masterEntry-noPlan" type="checkbox" data-taskId="<%- task.id %>" data-task="<%- taskIndex %>" <%- task.noPlan ? 'checked' : '' %>>
          <% } else { %>
          <i class="fa fa-<%- task.noPlan ? 'check' : 'times' %>"></i>
          <% } %>
        </td>
        <% Object.keys(task.totalByCompany).forEach(function(companyId) { %>
        <td class="fte-masterEntry-total-company-task" data-companyId="<%- companyId %>"><%- task.totalByCompany[companyId] %></td>
        <% }) %>
        <% task.functions.forEach(function(prodFunction, functionIndex) { %>
        <% prodFunction.companies.forEach(function(company, companyIndex) { %>
        <td class="<%- functionIndex % 2 ? '' : 'even' %>">
          <% if (editable) { %>
          <input
            class="form-control fte-masterEntry-count"
            type="number"
            min="0"
            max="9999"
            value="<%- company.count %>"
            data-value="<%- company.count %>"
            data-task="<%- taskIndex %>"
            data-function="<%- functionIndex %>"
            data-company="<%- companyIndex %>"
            data-functionId="<%- prodFunction.id %>"
            data-companyId="<%- company.id %>"
            <%- task.noPlan ? 'disabled' : '' %>>
          <% } else { %>
          <%- company.count %>
          <% } %>
        </td>
        <% }) %>
        <% }) %>
      </tr>
      <% }) %>
      </tbody>
    </table>
  </div>
  <div class="panel panel-primary">
    <div class="panel-heading"><%- t('fte', 'masterEntry:absencePanel:title' + (editable ? ':editable': '')) %></div>
    <% if (editable) { %>
    <div class="fte-masterEntry-absence-userFinder-container">
      <input class="fte-masterEntry-absence-userFinder" type="text" data-placeholder="<%- t('fte', 'masterEntry:absence:searchPlaceholder') %>">
    </div>
    <% } %>
    <table class="table table-bordered table-condensed table-hover fte-masterEntry-absence">
      <thead>
      <tr>
        <th><%- t('users', 'PROPERTY:personellId') %>
        <th><%- t('users', 'PROPERTY:name') %>
        <% if (editable) { %>
        <th class="actions"><%- t('core', 'LIST:COLUMN:actions') %></th>
        <% } %>
      </tr>
      </thead>
      <tbody class="fte-masterEntry-absence-noEntries">
      <tr>
        <td colspan="3"><%- t('core', 'LIST:NO_DATA') %>
      <tbody class="fte-masterEntry-absence-entries">
      <% absentUsers.forEach(function(absentUser) { %>
      <%- renderAbsentUserRow({absentUser: absentUser, editable: editable}) %>
      <% }) %>
    </table>
  </div>
</div>
