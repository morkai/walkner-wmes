<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Plan dla linii <%= lines %> na dzień <%- time.utc.format(date, 'LL') %></title>
  <style>
    @page {
      size: A4 portrait;
      margin: 10mm;
    }
    * {
      margin: 0;
      padding: 0;
      line-height: 1;
      box-sizing: border-box;
    }
    body {
      margin: 15px;
      font-family: Verdana, sans-serif;
      font-size: 12px;
      text-rendering: optimizeLegibility;
      color: #000;
      background: #FFF;
      text-align: center;
    }
    .page {
      margin: auto;
      text-align: left;
      width: 21cm;
      padding: 10mm;
    }
    header {
      padding-bottom: 5mm;
      margin-bottom: 5mm;
      font-size: 32px;
      font-weight: bold;
      text-align: left;
      border-bottom: 1px solid #000;
    }
    footer {
      display: flex;
      padding-top: 5mm;
      margin-top: 5mm;
      border-top: 1px solid #000;
      font-size: 10px;
    }
    footer p:first-child {
      margin-bottom: 3px;
    }
    footer > div:first-child {
      flex: 1 1 auto;
    }
    footer > div:last-child {
      flex: 1 1 auto;
      text-align: right;
    }
    .props {
      float: right;
      display: flex;
    }
    .prop {
      margin-left: 5mm;
    }
    .prop > span:first-child {
      display: block;
      margin-bottom: 3px;
      font-size: 16px;
      font-weight: bold;
    }
    .prop > span:last-child {
      display: block;
      font-size: 16px;
      font-weight: normal;
    }
    table {
      width: 100%;
      font-size: 12px;
      border-collapse: collapse;
    }
    th {
      text-align: left;
      padding-right: 10px;
      white-space: nowrap;
    }
    td {
      padding-top: 8px;
      padding-right: 10px;
      white-space: nowrap;
      width: 1%;
    }
    th:last-child,
    td:last-child {
      padding-right: 0;
    }
    .name {
      width: auto;
    }
    .name > span {
      display: block;
      overflow: hidden;
      text-overflow: ellipsis;
      max-width: <%- showTimes ? 340 : 400 %>px;
    }
    .comment {
      width: auto;
    }
    .comment > span {
      display: block;
      overflow: hidden;
      text-overflow: ellipsis;
      max-width: 535px;
      line-height: 12px;
    }
    .is-done td {
      vertical-align: top;
      font-size: 10px;
      line-height: 10px;
      padding-bottom: 2px;
    }
    .is-done .comment {
      padding-bottom: 0;
    }
    .qty,
    .time {
      text-align: right;
    }
    .is-incomplete {
      color: darkorange;
    }
    .is-completed {
      color: green;
    }
    .is-surplus {
      color: #E00;
    }
    .nextShift {
      padding-bottom: 10px;
      border-bottom: 1px solid #000;
    }
    .nextShift + tr > td {
      padding-top: 10px;
    }
    h2 {
      margin-top: 5mm;
      margin-bottom: 5mm;
      padding-bottom: 5mm;
      border-bottom: 1px solid #000;
    }
    .hourlyPlan th {
      padding-left: 10px;
      padding-right: 10px;
      text-align: center;
    }
    .hourlyPlan td {
      padding-left: 10px;
      padding-right: 10px;
      width: 1%;
      text-align: center;
    }
    .hourlyPlan th:first-child,
    .hourlyPlan td:first-child {
      padding-left: 0;
      text-align: left;
    }
    .hourlyPlan th:last-child,
    .hourlyPlan td:last-child {
      width: auto;
      text-align: right;
      font-weight: normal;
    }
    .with-quantityDone th,
    .with-quantityDone td {
      padding-right: 0;
    }
    #info {
      position: fixed;
      top: 0;
      left: 0;
      padding: 7px;
      width: 100%;
      background: #FFD1D1;
      border-bottom: 1px solid #F8ACAC;
      font-size: 28px;
      text-align: center;
    }
    @media print {
      body {
        margin: 0;
      }
      .page {
        width: 100%;
        padding: 0;
      }
      .page + .page {
        page-break-before: always;
      }
      .bd {
        height: 900px;
      }
      #info {
        display: none;
      }
    }
    @font-face {
      font-family: 'wmes-planning';
      src: url('data:application/octet-stream;base64,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') format('woff');
    }
    i[class^="fa-"]:before, [class*=" fa-"]:before {
      font-family: "wmes-planning";
      font-style: normal;
      font-weight: normal;
      speak: none;
      display: inline-block;
      text-decoration: inherit;
      width: 1em;
      margin-right: .2em;
      text-align: center;
      font-variant: normal;
      text-transform: none;
      line-height: 1em;
      margin-left: .2em;
    }
    .fa-star:before { content: '\e800'; }
    .fa-star-o:before { content: '\e801'; }
    .fa-plus:before { content: '\e802'; }
    .fa-thumb-tack:before { content: '\e803'; }
    .fa-truck:before { content: '\e804'; }
    .fa-arrow-right:before { content: '\e805'; }
    .fa-ban:before { content: '\e807'; }
    .fa-star-half-full:before { content: '\f123'; }
    .fa-question-mark:before { content: '\f128'; }
    .fa-exclamation:before { content: '\f12a'; }
    .fa-paint-brush:before { content: '\f1fc'; }
    .fa-hourglass-end:before { content: '\f253'; }

    .planning-mrp-list-property-psStatus[data-ps-status="unknown"] {
      display: none;
    }
    .planning-mrp-list-property-psStatus[data-ps-status="started"] {
      color: #5bc0de;
    }
    .planning-mrp-list-property-psStatus[data-ps-status="partial"] {
      color: #f0ad4e;
    }
    .planning-mrp-list-property-psStatus[data-ps-status="finished"] {
      color: #449d44;
    }
    .planning-mrp-list-property-psStatus[data-ps-status="cancelled"] {
      color: #d9534f;
    }
    .planning-mrp-list-property-whStatus[data-wh-status="unknown"] {
      display: none;
    }
    .planning-mrp-list-property-whStatus[data-wh-status="done"] {
      color: #449d44;
    }
  </style>
</head>
<body>
<div id="info">
  Wciśnij <kbd>Ctrl+P</kbd>, aby rozpocząć drukowanie.
</div>
<% pages.forEach(function(page) { %>
<section class="page">
  <header>
    <div class="props">
      <div class="prop">
        <span>Data:</span>
        <span><%= time.format(date, 'dd, LL') %></span>
      </div>
      <div class="prop">
        <span>MRP:</span>
        <span><%= page.mrp %> %></span>
      </div>
      <div class="prop">
        <span>Linia:</span>
        <span><%= page.line %></span>
      </div>
      <div class="prop">
        <span>Obsada:</span>
        <span><%- page.workerCount %></span>
      </div>
    </div>
    Plan dnia
  </header>
  <section class="bd">
    <% if (page.orders.length) { %>
    <table>
      <thead>
        <th>Lp.</th>
        <th>Nr zlecenia</th>
        <th>12NC</th>
        <th>Wyrób</th>
        <th class="qty">Ilość</th>
        <% if (showTimes) { %>
        <th>Czas</th>
        <% } %>
      </thead>
      <tbody>
      <% page.orders.forEach(function(order) { %>
      <% if (order.nextShift) { %>
      <tr class="nextShift">
        <td colspan="6"></td>
      </tr>
      <% } %>
      <tr class="<%- order.no ? '' : 'is-done' %>">
        <% if (order.no) { %>
        <td class="no"><%- order.no %>.</td>
        <td class="orderNo"><%- order.orderNo %></td>
        <td class="nc12"><%- order.nc12 %></td>
        <td class="name">
          <span>
            <%- order.icons %>
            <%= order.name %>
          </span>
        </td>
        <% } else { %>
        <td class="no">&nbsp;</td>
        <td class="comment" colspan="3">
          <span>
            <%= order.delayReason %>
            <i><%= order.comment %></i>
          </span>
        </td>
        <% } %>
        <td class="qty <%- order.qtyClass || '' %>"><%- order.qtyPlan %>/<%- order.qtyTodo %></td>
        <% if (showTimes) { %>
        <td class="time">
          <% if (order.startAt) { %>
          <%- time.utc.format(order.startAt, 'HH:mm') %>-<%- time.utc.format(order.finishAt, 'HH:mm') %>
          <% } else { %>
          --:--:--
          <% } %>
        </td>
        <% } %>
      </tr>
      <% }) %>
      </tbody>
    </table>
    <% } %>
    <% if (page.hourlyPlan) { %>
    <h2>Plan godzinowy</h2>
    <table class="hourlyPlan <%- done ? 'with-quantityDone' : '' %>">
      <thead>
      <tr>
        <th>Zmiana</th>
        <th>1</th>
        <th>2</th>
        <th>3</th>
        <th>4</th>
        <th>5</th>
        <th>6</th>
        <th>7</th>
        <th>8</th>
        <th>
          <i class="fa fa-star-o"></i> małe&nbsp;&nbsp;
          <i class="fa fa-star-half-full"></i> łatwe&nbsp;&nbsp;
          <i class="fa fa-star"></i> trudne
        </th>
      </tr>
      </thead>
      <tbody>
      <tr>
        <td>I</td>
        <% for (var h = 0; h < 8; ++h) { %>
        <td>
          <% if (page.quantityDone) { %>
          <%- pad(page.quantityDone[h]) %>/<%- page.hourlyPlan[h] %>
          <% } else { %>
          <%- page.hourlyPlan[h] %>
          <% } %>
        </td>
        <% } %>
        <td>
          <% if (done) { %>
          zlecenie nie robione na danej linii i zmianie,
          <% } %>
        </td>
      </tr>
      <tr>
        <td>II</td>
        <% for (var h = 8; h < 16; ++h) { %>
        <td>
          <% if (page.quantityDone) { %>
          <%- pad(page.quantityDone[h]) %>/<%- page.hourlyPlan[h] %>
          <% } else { %>
          <%- page.hourlyPlan[h] %>
          <% } %>
        </td>
        <% } %>
        <td>
          <% if (done) { %>
          <span class="is-incomplete">zlecenie rozpoczęte</span>,
          <span class="is-completed">zlecenie zrobione</span>,
          <% } %>
        </td>
      </tr>
      <tr>
        <td>III</td>
        <% for (var h = 16; h < 24; ++h) { %>
        <td>
          <% if (page.quantityDone) { %>
          <%- pad(page.quantityDone[h]) %>/<%- page.hourlyPlan[h] %>
          <% } else { %>
          <%- page.hourlyPlan[h] %>
          <% } %>
        </td>
        <% } %>
        <td>
          <% if (done) { %>
          <span class="is-surplus">zlecenie z nadwyżką</span>
          <% } %>
        </td>
      </tr>
      </tbody>
    </table>
    <% } %>
  </section>
  <footer>
    <div>
      <p>Plan dla linii <%= page.line %> na dzień <%- time.utc.format(date, 'LL') %>.</p>
      <p>Wydrukowano w <%- time.format(Date.now(), 'LLLL') %> przez <%= user.getLabel() %> za pomocą systemu WMES.</p>
    </div>
    <div>
      Strona <%- page.pageNo %> z <%- page.pageCount %>
    </div>
  </footer>
</section>
<% }) %>
</body>
</html>
