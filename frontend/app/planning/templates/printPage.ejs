<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Plan dla linii <%= lines %> na dzień <%- time.utc.format(date, 'LL') %></title>
  <style>
    @page {
      size: A4 portrait;
      margin: 10mm;
    }
    * {
      margin: 0;
      padding: 0;
      line-height: 1;
      box-sizing: border-box;
    }
    body {
      margin: 15px;
      font-family: Verdana, sans-serif;
      font-size: 12px;
      text-rendering: optimizeLegibility;
      color: #000;
      background: #FFF;
      text-align: center;
    }
    .page {
      margin: auto;
      text-align: left;
      width: 21cm;
      padding: 10mm;
    }
    header {
      padding-bottom: 5mm;
      margin-bottom: 5mm;
      font-size: 32px;
      font-weight: bold;
      text-align: left;
      border-bottom: 1px solid #000;
    }
    footer {
      display: flex;
      padding-top: 5mm;
      margin-top: 5mm;
      border-top: 1px solid #000;
      font-size: 10px;
    }
    footer p:first-child {
      margin-bottom: 3px;
    }
    footer > div:first-child {
      flex: 1 1 auto;
    }
    footer > div:last-child {
      flex: 1 1 auto;
      text-align: right;
    }
    .props {
      float: right;
      display: flex;
    }
    .prop {
      margin-left: 5mm;
    }
    .prop > span:first-child {
      display: block;
      margin-bottom: 3px;
      font-size: 16px;
      font-weight: bold;
    }
    .prop > span:last-child {
      display: block;
      font-size: 16px;
      font-weight: normal;
    }
    table {
      width: 100%;
      font-size: 12px;
      border-collapse: collapse;
    }
    th {
      text-align: left;
      padding-right: 10px;
      white-space: nowrap;
    }
    td {
      padding-top: 8px;
      padding-right: 10px;
      white-space: nowrap;
      width: 1%;
    }
    th:last-child,
    td:last-child {
      padding-right: 0;
    }
    .name {
      width: auto;
    }
    .name > span {
      display: block;
      overflow: hidden;
      text-overflow: ellipsis;
      max-width: <%- showTimes ? 340 : 400 %>px;
    }
    .comment {
      width: auto;
    }
    .comment > span {
      display: block;
      overflow: hidden;
      text-overflow: ellipsis;
      max-width: 535px;
      line-height: 12px;
    }
    .is-done td {
      vertical-align: top;
      font-size: 10px;
      line-height: 10px;
      padding-bottom: 2px;
    }
    .is-done .comment {
      padding-bottom: 0;
    }
    .qty,
    .time {
      text-align: right;
    }
    .is-incomplete {
      color: darkorange;
    }
    .is-completed {
      color: green;
    }
    .is-surplus {
      color: #E00;
    }
    .nextShift {
      padding-bottom: 10px;
      border-bottom: 1px solid #000;
    }
    .nextShift + tr > td {
      padding-top: 10px;
    }
    h2 {
      margin-top: 5mm;
      margin-bottom: 5mm;
      padding-bottom: 5mm;
      border-bottom: 1px solid #000;
    }
    .hourlyPlan th {
      padding-left: 10px;
      padding-right: 10px;
      text-align: center;
    }
    .hourlyPlan td {
      padding-left: 10px;
      padding-right: 10px;
      width: 1%;
      text-align: center;
    }
    .hourlyPlan th:first-child,
    .hourlyPlan td:first-child {
      padding-left: 0;
      text-align: left;
    }
    .hourlyPlan th:last-child,
    .hourlyPlan td:last-child {
      width: auto;
      text-align: right;
      font-weight: normal;
    }
    .with-quantityDone th,
    .with-quantityDone td {
      padding-right: 0;
    }
    #info {
      position: fixed;
      top: 0;
      left: 0;
      padding: 7px;
      width: 100%;
      background: #FFD1D1;
      border-bottom: 1px solid #F8ACAC;
      font-size: 28px;
      text-align: center;
    }
    @media print {
      body {
        margin: 0;
      }
      .page {
        width: 100%;
        padding: 0;
      }
      .page + .page {
        page-break-before: always;
      }
      .bd {
        height: 900px;
      }
      #info {
        display: none;
      }
    }
    @font-face {
      font-family: 'wmes-planning';
      src: url('data:application/octet-stream;base64,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') format('woff'),
      url('data:application/octet-stream;base64,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WCA8WS6xKwEUKy2wPiywNSsjIC5GsAIlRlJYIDxZLrErARQrLbA/LLA2K4ogIDywBCNCijgjIC5GsAIlRlJYIDxZLrErARQrsARDLrArKy2wQCywABawBCWwBCYgLkcjRyNhsAlDKyMgPCAuIzixKwEUKy2wQSyxCAQlQrAAFrAEJbAEJSAuRyNHI2EgsAQjQrAJQysgsGBQWCCwQFFYswIgAyAbswImAxpZQkIjIEewBEOwAmIgsABQWLBAYFlmsAFjYCCwASsgiophILACQ2BkI7ADQ2FkUFiwAkNhG7ADQ2BZsAMlsAJiILAAUFiwQGBZZrABY2GwAiVGYTgjIDwjOBshICBGI0ewASsjYTghWbErARQrLbBCLLA1Ky6xKwEUKy2wQyywNishIyAgPLAEI0IjOLErARQrsARDLrArKy2wRCywABUgR7AAI0KyAAEBFRQTLrAxKi2wRSywABUgR7AAI0KyAAEBFRQTLrAxKi2wRiyxAAEUE7AyKi2wRyywNCotsEgssAAWRSMgLiBGiiNhOLErARQrLbBJLLAII0KwSCstsEossgAAQSstsEsssgABQSstsEwssgEAQSstsE0ssgEBQSstsE4ssgAAQistsE8ssgABQistsFAssgEAQistsFEssgEBQistsFIssgAAPistsFMssgABPistsFQssgEAPistsFUssgEBPistsFYssgAAQCstsFcssgABQCstsFgssgEAQCstsFkssgEBQCstsFossgAAQystsFsssgABQystsFwssgEAQystsF0ssgEBQystsF4ssgAAPystsF8ssgABPystsGAssgEAPystsGEssgEBPystsGIssDcrLrErARQrLbBjLLA3K7A7Ky2wZCywNyuwPCstsGUssAAWsDcrsD0rLbBmLLA4Ky6xKwEUKy2wZyywOCuwOystsGgssDgrsDwrLbBpLLA4K7A9Ky2waiywOSsusSsBFCstsGsssDkrsDsrLbBsLLA5K7A8Ky2wbSywOSuwPSstsG4ssDorLrErARQrLbBvLLA6K7A7Ky2wcCywOiuwPCstsHEssDorsD0rLbByLLMJBAIDRVghGyMhWUIrsAhlsAMkUHiwARUwLQBLuADIUlixAQGOWbABuQgACABjcLEABUKyAAEAKrEABUKzCgIBCCqxAAVCsw4AAQgqsQAGQroCwAABAAkqsQAHQroAQAABAAkqsQMARLEkAYhRWLBAiFixA2REsSYBiFFYugiAAAEEQIhjVFixAwBEWVlZWbMMAgEMKrgB/4WwBI2xAgBEAAA=') format('truetype');
    }
    i[class^="icon-"]:before, [class*=" icon-"]:before {
      font-family: "wmes-planning";
      font-style: normal;
      font-weight: normal;
      speak: none;
      display: inline-block;
      text-decoration: inherit;
      width: 1em;
      margin-right: .2em;
      text-align: center;
      font-variant: normal;
      text-transform: none;
      line-height: 1em;
      margin-left: .2em;
    }
    .icon-hard:before { content: '\e800'; }
    .icon-small:before { content: '\e801'; }
    .icon-easy:before { content: '\f123'; }
  </style>
</head>
<body>
<div id="info">
  Wciśnij <kbd>Ctrl+P</kbd>, aby rozpocząć drukowanie.
</div>
<% pages.forEach(function(page) { %>
<section class="page">
  <header>
    <div class="props">
      <div class="prop">
        <span>Data:</span>
        <span><%= time.format(date, 'dd, LL') %></span>
      </div>
      <div class="prop">
        <span>MRP:</span>
        <span><%= page.mrp %> %></span>
      </div>
      <div class="prop">
        <span>Linia:</span>
        <span><%= page.line %></span>
      </div>
      <div class="prop">
        <span>Obsada:</span>
        <span><%- page.workerCount %></span>
      </div>
    </div>
    Plan dnia
  </header>
  <section class="bd">
    <% if (page.orders.length) { %>
    <table>
      <thead>
        <th>Lp.</th>
        <th>Nr zlecenia</th>
        <th>12NC</th>
        <th>Wyrób</th>
        <th class="qty">Ilość</th>
        <% if (showTimes) { %>
        <th>Czas</th>
        <% } %>
      </thead>
      <tbody>
      <% page.orders.forEach(function(order) { %>
      <% if (order.nextShift) { %>
      <tr class="nextShift">
        <td colspan="6"></td>
      </tr>
      <% } %>
      <tr class="<%- order.no ? '' : 'is-done' %>">
        <% if (order.no) { %>
        <td class="no"><%- order.no %>.</td>
        <td class="orderNo"><%- order.orderNo %></td>
        <td class="nc12"><%- order.nc12 %></td>
        <td class="name"><span><i class="icon-<%- order.kind %>"></i> <%= order.name %></span></td>
        <% } else { %>
        <td class="no">&nbsp;</td>
        <td class="comment" colspan="3">
          <span>
            <%= order.delayReason %>
            <i><%= order.comment %></i>
          </span>
        </td>
        <% } %>
        <td class="qty <%- order.qtyClass || '' %>"><%- order.qtyPlan %>/<%- order.qtyTodo %></td>
        <% if (showTimes) { %>
        <td class="time">
          <% if (order.startAt) { %>
          <%- time.utc.format(order.startAt, 'HH:mm') %>-<%- time.utc.format(order.finishAt, 'HH:mm') %>
          <% } else { %>
          --:--:--
          <% } %>
        </td>
        <% } %>
      </tr>
      <% }) %>
      </tbody>
    </table>
    <% } %>
    <% if (page.hourlyPlan) { %>
    <h2>Plan godzinowy</h2>
    <table class="hourlyPlan <%- done ? 'with-quantityDone' : '' %>">
      <thead>
      <tr>
        <th>Zmiana</th>
        <th>1</th>
        <th>2</th>
        <th>3</th>
        <th>4</th>
        <th>5</th>
        <th>6</th>
        <th>7</th>
        <th>8</th>
        <th>
          <i class="icon-small"></i> małe&nbsp;&nbsp;
          <i class="icon-easy"></i> łatwe&nbsp;&nbsp;
          <i class="icon-hard"></i> trudne
        </th>
      </tr>
      </thead>
      <tbody>
      <tr>
        <td>I</td>
        <% for (var h = 0; h < 8; ++h) { %>
        <td>
          <% if (page.quantityDone) { %>
          <%- pad(page.quantityDone[h]) %>/<%- page.hourlyPlan[h] %>
          <% } else { %>
          <%- page.hourlyPlan[h] %>
          <% } %>
        </td>
        <% } %>
        <td>
          <% if (done) { %>
          zlecenie nie robione na danej linii i zmianie,
          <% } %>
        </td>
      </tr>
      <tr>
        <td>II</td>
        <% for (var h = 8; h < 16; ++h) { %>
        <td>
          <% if (page.quantityDone) { %>
          <%- pad(page.quantityDone[h]) %>/<%- page.hourlyPlan[h] %>
          <% } else { %>
          <%- page.hourlyPlan[h] %>
          <% } %>
        </td>
        <% } %>
        <td>
          <% if (done) { %>
          <span class="is-incomplete">zlecenie rozpoczęte</span>,
          <span class="is-completed">zlecenie zrobione</span>,
          <% } %>
        </td>
      </tr>
      <tr>
        <td>III</td>
        <% for (var h = 16; h < 24; ++h) { %>
        <td>
          <% if (page.quantityDone) { %>
          <%- pad(page.quantityDone[h]) %>/<%- page.hourlyPlan[h] %>
          <% } else { %>
          <%- page.hourlyPlan[h] %>
          <% } %>
        </td>
        <% } %>
        <td>
          <% if (done) { %>
          <span class="is-surplus">zlecenie z nadwyżką</span>
          <% } %>
        </td>
      </tr>
      </tbody>
    </table>
    <% } %>
  </section>
  <footer>
    <div>
      <p>Plan dla linii <%= page.line %> na dzień <%- time.utc.format(date, 'LL') %>.</p>
      <p>Wydrukowano w <%- time.format(Date.now(), 'LLLL') %> przez <%= user.getLabel() %> za pomocą systemu WMES.</p>
    </div>
    <div>
      Strona <%- page.pageNo %> z <%- page.pageCount %>
    </div>
  </footer>
</section>
<% }) %>
</body>
</html>
